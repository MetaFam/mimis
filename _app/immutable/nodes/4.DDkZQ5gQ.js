import{a as h,t as _,c as ie}from"../chunks/disclose-version.DTJswJl7.js";import{af as oe,G as ne,l as R,I as le,aF as ce,Y as S,U as A,W as ue,Q as pe,a7 as L,E as Q,q as V,aA as Y,aG as B,T as P,V as M,aH as fe,d as he,p as ve,a as me,aC as de,s as x,c as v,aI as J,r as c,t as E,i,k as F,f as K}from"../chunks/runtime.Db9iSkkl.js";import{s as H}from"../chunks/render.CB115e8K.js";import{i as W}from"../chunks/if.D-e5qnvH.js";import{e as X,i as Z}from"../chunks/each.DJIQyBkY.js";import{h as _e}from"../chunks/svelte-head.530wIRfY.js";import{s as z}from"../chunks/attributes.DYNwWmbj.js";import{d as ge,e as be}from"../chunks/events.DYNCPIRZ.js";import{b as Te}from"../chunks/misc.DLDFaE-N.js";import{p as Ee}from"../chunks/proxy.DF_hzHoN.js";import{g as Ne,T as ye}from"../chunks/toastify.DfwmuzdJ.js";import{s as Ce}from"../chunks/settings.svelte.DbvFZTk_.js";const D=0,w=1,q=2;function je(e,t,a,m,N){R&&le();var g=e,C=oe(),I=he,o,r,u,p,d=(C?L:Q)(void 0),n=(C?L:Q)(void 0),b=!1;function s(l,f){b=!0,f&&(V(y),Y(y),B(I));try{l===D&&a&&(r?P(r):r=A(()=>a(g))),l===w&&m&&(u?P(u):u=A(()=>m(g,d))),l===q&&N&&(p?P(p):p=A(()=>N(g,n))),l!==D&&r&&M(r,()=>r=null),l!==w&&u&&M(u,()=>u=null),l!==q&&p&&M(p,()=>p=null)}finally{f&&(B(null),Y(null),V(null),fe())}}var y=ne(()=>{if(o!==(o=t())){if(ce(o)){var l=o;b=!1,l.then(f=>{l===o&&(S(d,f),s(w,!0))},f=>{if(l===o)throw S(n,f),s(q,!0),n.v}),R?a&&(r=A(()=>a(g))):ue(()=>{b||s(D,!0)})}else S(d,o),s(w,!1);return()=>o=null}});R&&(g=pe)}const xe=!0,et=Object.freeze(Object.defineProperty({__proto__:null,prerender:xe},Symbol.toStringTag,{value:"Module"})),$e=async e=>{const t=Ne();try{const a=t.session(),m=e.length===0?`
        MATCH (start:Root)-[children:CONTAINS|CONNECTS]->(child)
        RETURN [] as path, children.path as container, child
      `:`
        WITH $elems as pathElems
        MATCH path = (start:Root)-[:CONTAINS|CONNECTS*]->(end)
        MATCH (end)-[children:CONTAINS|CONNECTS]->(child)
        WITH pathElems, path, children, child, [
          rel in relationships(path)
          WHERE NOT isEmpty(rel.path)
          | rel.path
        ] as elements
        WHERE size(elements) = size(pathElems)
        AND ALL(
          i IN range(0, size(pathElems) - 1)
          WHERE (
            pathElems[i] = '*'
            OR elements[i] = pathElems[i]
          )
        )
        RETURN DISTINCT
          elements as path,
          children.path as container,
          child
      `,N=await a.run(m,{elems:e});return await a.close(),N.records}finally{t.close()}},ke=({url:e,cid:t})=>{if(!e&&!t||e&&t)throw new Error("Must provide either `url` xor `cid`.");let a=[];if(e!=null?[,,t,...a]=Array.from(/^(ipfs:\/\/)?([^/]+)(\/.*)?$/.exec(e)??[]):t!=null&&([t,...a]=t.split("/")),t==null)throw new Error("Could not determine `cid`.");return Ce.ipfsPattern.replace("{cid}",t).replace("{path}",`/${a.join("/")}`)};let $=Ee([]),Ae=F(async()=>{try{return await $e($)}catch(e){ye({text:e.message,duration:16e3,close:!0,gravity:"bottom",position:"center",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()}});const He=e=>{e.preventDefault();const t=e.target.elements.chip;ee(t.value),t.value=""},ee=e=>{e=e.trim(),e&&$.push(e)},we=e=>{$.splice(e,1)};var Ie=_('<li class="svelte-ou6ijn"> <button class="svelte-ou6ijn">⨯</button></li>'),Oe=_('<ul id="path" class="svelte-ou6ijn"></ul>'),Re=_('<h2 class="svelte-ou6ijn">No Results</h2>'),Se=_('<h2 class="svelte-ou6ijn"> </h2> <object class="svelte-ou6ijn"><p>Could not display <a target="_blank"> </a>.</p></object>',1),Pe=(e,t,a)=>t(i(a).get("container")),Me=_("<button> </button>"),We=_("<li><!></li>"),ze=_('<ul id="result" class="svelte-ou6ijn"></ul>'),De=_('<h2 class="svelte-ou6ijn">Searching…</h2>'),qe=_('<main class="svelte-ou6ijn"><form><input id="chip" placeholder="Path Element"> <button>Add Path Element</button></form> <!> <section id="result" class="svelte-ou6ijn"><!></section></main>');function tt(e,t){ve(t,!0);var a=qe();_e(o=>{de.title="Mïmis: Search"});var m=v(a),N=v(m);Te(N),J(2),c(m);var g=x(m,2);W(g,()=>$.length>0,o=>{var r=Oe();X(r,21,()=>$,Z,(u,p,d)=>{var n=Ie(),b=v(n),s=x(b);s.__click=()=>we(d),c(n),E(()=>H(b,`${i(p)??""} `)),h(u,n)}),c(r),h(o,r)});var C=x(g,2),I=v(C);je(I,()=>i(Ae),o=>{var r=De();h(o,r)},(o,r)=>{var u=ie(),p=K(u);W(p,()=>!i(r)||i(r).length===0,d=>{var n=Re();h(d,n)},d=>{var n=ze();X(n,21,()=>i(r),Z,(b,s)=>{var y=We(),l=v(y);W(l,()=>i(s).get("child").labels.includes("File"),f=>{var T=Se(),j=K(T);const te=F(()=>{var U;return((U=i(s).get("path"))==null?void 0:U.join("/"))??""}),ae=F(()=>i(s).get("container")??"");var re=v(j);E(()=>H(re,`/${i(te)}/${i(ae)}`)),c(j);var k=x(j,2);E(()=>z(k,"data",ke({cid:i(s).get("child").properties.cid}))),E(()=>z(k,"title",`ipfs://${i(s).get("child").properties.cid}`));var G=v(k),O=x(v(G));E(()=>z(O,"href",`https://w3s.link/ipfs/${i(s).get("child").properties.cid}`));var se=v(O);E(()=>H(se,`ipfs://${i(s).get("child").properties.cid??""}`)),c(O),J(),c(G),c(k),h(f,T)},f=>{var T=Me();T.__click=[Pe,ee,s];var j=v(T,!0);E(()=>H(j,i(s).get("container"))),c(T),h(f,T)}),c(y),h(b,y)}),c(n),h(d,n)}),h(o,u)}),c(C),c(a),be("submit",m,He),h(e,a),me()}ge(["click"]);export{tt as component,et as universal};
