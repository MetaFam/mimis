import"../chunks/CWj6FrbW.js";import{p as N,ag as C,ae as _,f as I,s as c,a as M,d as h,k as p,aG as S,b as T,c as k,ad as z,af as H,r as f}from"../chunks/CHL_XyGH.js";import{d as x}from"../chunks/Cv5ER_U-.js";import{h as O}from"../chunks/DhaZMK9J.js";import{e as P,i as j}from"../chunks/DTqv0tSM.js";import{T as D}from"../chunks/B2cAYdwZ.js";import{v as g,P as R}from"../chunks/BhgOS_kI.js";import{g as w}from"../chunks/Bi109sN7.js";async function G(o){const n=w();o=o.filter(Boolean);const t=o.pop();await Promise.all(o.map(async a=>{const i=n.session();try{await i.run(`
        MATCH (e) WHERE elementId(e) = $equivId
        MATCH (t) WHERE elementId(t) = $targetId
        MERGE (e)-[eq:EQUALS]->(t)
        ON CREATE SET eq.mimis_id = $uuid
        RETURN $uuid
      `,{equivId:a,targetId:t,uuid:g()})}finally{i.close()}}))}async function B({path:o}){const t=w().session();try{const a="MERGE (r:Root) RETURN elementId(r) AS id",{records:[i]}=await t.run(a);let r=i.get("id");const d=[...o];for(;d.length>0;){const E=d.shift(),m=`
        MATCH (base) WHERE elementId(base) = $current
        MERGE (base)-[cont:CONTAINS { path: $elem }]->(node:Spot)
        ON CREATE SET cont.mimis_id = $contUUID
        ON CREATE SET node.mimis_id = $nodeUUID
        RETURN elementId(node) AS id
      `,{records:[u]}=await t.run(m,{current:r,elem:E,contUUID:g(),nodeUUID:g()});r=u.get("id")}return r}finally{t.close()}}var F=(o,n)=>n.push([""]),W=I('<li><label class="svelte-1defoz0"> <!></label></li>'),Q=I('<header><h1>Create Equivalencies</h1></header> <main class="svelte-1defoz0"><button class="svelte-1defoz0"><span>Add From Path</span></button> <ol></ol> <label class="svelte-1defoz0">To: <!></label> <button class="svelte-1defoz0"><span>Mark Equal</span></button></main>',1);function te(o,n){N(n,!0);let t=C(_([""])),a=_([[""]]);const i=S(()=>async()=>{try{const e=a.map(s=>s.filter(Boolean)).filter(s=>s.length>0);if(e.length===0)throw new Error("No `from` paths specified.");if(!p(t).every(Boolean))throw new Error("No `to` path specified.");const l=await Promise.all([...e,p(t)].map(async s=>await B({path:s})));console.debug({dataful:e,to:p(t),nodeIds:l}),await G(l)}catch(e){D({text:`Error: ${e.message}`,duration:12e3,close:!0,gravity:"bottom",position:"center",stopOnFocus:!0,style:{background:"linear-gradient(to right, #b09b22, #969d)"}}).showToast()}});var r=Q();O(e=>{z.title="MÃ¯mis: Equivalancies"});var d=c(M(r),2),E=h(d);E.__click=[F,a];var m=c(E,2);P(m,21,()=>a,j,(e,l,s)=>{var v=W(),b=h(v),y=h(b);y.nodeValue=`From #${s+1}: `;var q=c(y);R(q,{get elements(){return a[s]},set elements(A){a[s]=A}}),f(b),f(v),T(e,v)}),f(m);var u=c(m,2),$=c(h(u));R($,{get elements(){return p(t)},set elements(e){H(t,e,!0)}}),f(u);var U=c(u,2);U.__click=function(...e){var l;(l=p(i))==null||l.apply(this,e)},f(d),T(o,r),k()}x(["click"]);export{te as component};
