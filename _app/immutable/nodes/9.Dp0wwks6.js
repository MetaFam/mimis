const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/CO7MEcO7.js","../chunks/CE1G-McA.js"])))=>i.map(i=>d[i]);
import"../chunks/DsnmJJEf.js";import{Y as zt,h as fn,v as pn,w as vn,f as K,t as B,b as U,aw as C,k as o,az as T,aB as te,p as re,b5 as Be,a as fe,ay as rt,c as ie,d as A,r as D,aA as X,s as M,q as _e,g as he,b8 as gn,ax as qe}from"../chunks/C0lYg4N8.js";import{s as ge,m as mn}from"../chunks/9GzlE_cd.js";import{i as ue}from"../chunks/DJx03HtA.js";import{h as bn}from"../chunks/vHHk0yCJ.js";import{s as Me,e as it,d as at,a as F,r as Kt,f as yn}from"../chunks/CoB6fEAl.js";import{d as Ee,e as pe}from"../chunks/DmKVZe3W.js";import{b as hn,a as kn}from"../chunks/DU8poMv7.js";import{b as G}from"../chunks/C1A0XLvw.js";import{T as wn}from"../chunks/lnCFUhDM.js";import{l as Ot}from"../chunks/8HslT92O.js";import{c as En}from"../chunks/B-VOZDPm.js";import{b as On}from"../chunks/C4K8jg7x.js";import{p as Tn}from"../chunks/BdZBV5Ue.js";import{s as Ie}from"../chunks/B0SWonas.js";import{g as Bt,a as Sn}from"../chunks/M1RXKuGZ.js";import{v as De}from"../chunks/Z36B0dHS.js";import{N as Dn,r as An,i as Pe,a as Ye}from"../chunks/BN8qNu6t.js";import{e as xn}from"../chunks/BznPomiX.js";import{p as J}from"../chunks/DQWNuCS8.js";import{t as Ae}from"../chunks/gq_7AhkF.js";import{_ as In}from"../chunks/PPVm8Dsz.js";import{P as Pn}from"../chunks/DGuOeEMp.js";function _n(e,n,t){zt(()=>{var r=fn(()=>n(e,t?.())||{});if(r?.destroy)return()=>r.destroy()})}function jn(e,n,t,r,i){var a=()=>{r(t[e])};t.addEventListener(n,a),i?pn(()=>{t[e]=i()}):a(),(t===document.body||t===window||t===document)&&vn(()=>{t.removeEventListener(n,a)})}async function Mn(e,n){const r=Bt().session();try{const{records:[i]}=await r.run("MERGE (r:Root) RETURN r.m√Ømid as id");let a=i.get("id");const l=`
      MATCH (elem) WHERE elem.m√Ømid = $currentId
      MERGE (elem)-[tain:CONTAINS {path: $element}]->(next:Spot)
      ON CREATE SET elem.m√Ømid = $elemUUID
      ON CREATE SET tain.m√Ømid = $tainUUID
      RETURN next.m√Ømid as id
    `;for(const m of n){const{records:[g]}=await r.run(l,{currentId:a,element:m,elemUUID:De(),tainUUID:De()});a=g.get("id")}const s=`
      MATCH (path) WHERE path.m√Ømid = $currentId
      OPTIONAL MATCH (path)-[:REPRESENTED_BY]->(sib:N√∂opoint)
      WITH path, sib
      ORDER BY sib.createdAt DESC
      WITH path, collect(sib)[0] as previous
      CREATE (path)-[:REPRESENTED_BY]->(list:List:N√∂opoint {
        m√Ømid: $uuid, createdAt: timestamp()
      })
      WITH list, previous
      FOREACH (_ IN CASE WHEN previous IS NOT NULL THEN [1] ELSE [] END |
        MERGE (list)-[:PREVIOUS]->(previous)
      )
      RETURN list.m√Ømid as id
    `,{records:[u]}=await r.run(s,{currentId:a,uuid:De()});a=u.get("id");const c=`
      MATCH (list) WHERE list.m√Ømid = $currentId
      MERGE (file:IPFS:File {cid: $cid})
      MERGE (point:N√∂opoint)-[:EMBODIED_AS]->(file)
      MERGE (spot:Spot)-[:REPRESENTED_BY]->(point)
      MERGE (item:Spot)-[:CONTAINS {path: $title}]->(spot)
      ON CREATE SET file.createdAt = timestamp()
      ON CREATE SET file.m√Ømid = $uuid
      SET file.type = (
        CASE WHEN file.type IS NULL THEN $type ELSE file.type END
      )
      CREATE (list)-[:ENTRY {order: $order}]->(item)
      RETURN file
    `;for(const m in e){const{cid:g,title:w,type:p}=e[m];await r.run(c,{currentId:a,cid:g,title:w,type:p,order:Number(m)+1,uuid:De()})}}finally{await r.close()}}async function Cn(e){const n=await Dn.get.children(e,{onlyCurrent:!0});if(n.length===0)throw new Error("No results for path.");if(n.length>1)throw new Error(`${n.length} results for path.`);const[{n√∂opoint:t}]=n,r=Bt(),i=r.session();console.debug({n√∂opoint:t});try{const a=`
      MERGE (itemPoint:N√∂opoint)-[:EMBODIED_BY]->(item)
      MATCH (point)-[:REPRESENTED_BY]->(itemPoint)
      WHERE point.m√Ømid = $id
      AND NOT ()-[:PREVIOUS]->(point)
      ORDER BY entry.order
      RETURN DISTINCT entry, item
    `,{records:l}=await i.run(a,{id:t.m√Ømid}),s=An(l);return console.debug({found:s}),Pe(s.map(u=>({title:u.entry.properties.path,type:u.item.properties.type,cid:u.item.properties.cid})))}finally{i.close(),r.close()}}function Rn(e){if(Array.isArray(e))return e}function Nn(e,n){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var r,i,a,l,s=[],u=!0,c=!1;try{if(a=(t=t.call(e)).next,n===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(r=a.call(t)).done)&&(s.push(r.value),s.length!==n);u=!0);}catch(m){c=!0,i=m}finally{try{if(!u&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(c)throw i}}return s}}function Qe(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function qt(e,n){if(e){if(typeof e=="string")return Qe(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Qe(e,n):void 0}}function Ln(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ot(e,n){return Rn(e)||Nn(e,n)||qt(e,n)||Ln()}var $e={},be={},Tt;function Yt(){if(Tt)return be;Tt=1,Object.defineProperty(be,"__esModule",{value:!0}),be.bind=void 0;function e(n,t){var r=t.type,i=t.listener,a=t.options;return n.addEventListener(r,i,a),function(){n.removeEventListener(r,i,a)}}return be.bind=e,be}var se={},St;function Hn(){if(St)return se;St=1;var e=se&&se.__assign||function(){return e=Object.assign||function(a){for(var l,s=1,u=arguments.length;s<u;s++){l=arguments[s];for(var c in l)Object.prototype.hasOwnProperty.call(l,c)&&(a[c]=l[c])}return a},e.apply(this,arguments)};Object.defineProperty(se,"__esModule",{value:!0}),se.bindAll=void 0;var n=Yt();function t(a){if(!(typeof a>"u"))return typeof a=="boolean"?{capture:a}:a}function r(a,l){if(l==null)return a;var s=e(e({},a),{options:e(e({},t(l)),t(a.options))});return s}function i(a,l,s){var u=l.map(function(c){var m=r(c,s);return(0,n.bind)(a,m)});return function(){u.forEach(function(m){return m()})}}return se.bindAll=i,se}var Dt;function Fn(){return Dt||(Dt=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bindAll=e.bind=void 0;var n=Yt();Object.defineProperty(e,"bind",{enumerable:!0,get:function(){return n.bind}});var t=Hn();Object.defineProperty(e,"bindAll",{enumerable:!0,get:function(){return t.bindAll}})})($e)),$e}var ve=Fn(),$t="data-pdnd-honey-pot";function Gt(e){return e instanceof Element&&e.hasAttribute($t)}function Vt(e){var n=document.elementsFromPoint(e.x,e.y),t=ot(n,2),r=t[0],i=t[1];return r?Gt(r)?i??null:r:null}function ke(e){"@babel/helpers - typeof";return ke=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ke(e)}function Un(e,n){if(ke(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var r=t.call(e,n);if(ke(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Wn(e){var n=Un(e,"string");return ke(n)=="symbol"?n:n+""}function Oe(e,n,t){return(n=Wn(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var Xt=2147483647;function At(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function xt(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?At(Object(t),!0).forEach(function(r){Oe(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):At(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var we=2,It=we/2;function zn(e){return{x:Math.floor(e.x),y:Math.floor(e.y)}}function Kn(e){return{x:e.x-It,y:e.y-It}}function Bn(e){return{x:Math.max(e.x,0),y:Math.max(e.y,0)}}function qn(e){return{x:Math.min(e.x,window.innerWidth-we),y:Math.min(e.y,window.innerHeight-we)}}function Pt(e){var n=e.client,t=qn(Bn(Kn(zn(n))));return DOMRect.fromRect({x:t.x,y:t.y,width:we,height:we})}function _t(e){var n=e.clientRect;return{left:"".concat(n.left,"px"),top:"".concat(n.top,"px"),width:"".concat(n.width,"px"),height:"".concat(n.height,"px")}}function Yn(e){var n=e.client,t=e.clientRect;return n.x>=t.x&&n.x<=t.x+t.width&&n.y>=t.y&&n.y<=t.y+t.height}function $n(e){var n=e.initial,t=document.createElement("div");t.setAttribute($t,"true");var r=Pt({client:n});Object.assign(t.style,xt(xt({backgroundColor:"transparent",position:"fixed",padding:0,margin:0,boxSizing:"border-box"},_t({clientRect:r})),{},{pointerEvents:"auto",zIndex:Xt})),document.body.appendChild(t);var i=ve.bind(window,{type:"pointermove",listener:function(l){var s={x:l.clientX,y:l.clientY};r=Pt({client:s}),Object.assign(t.style,_t({clientRect:r}))},options:{capture:!0}});return function(l){var s=l.current;if(i(),Yn({client:s,clientRect:r})){t.remove();return}function u(){c(),t.remove()}var c=ve.bindAll(window,[{type:"pointerdown",listener:u},{type:"pointermove",listener:u},{type:"focusin",listener:u},{type:"focusout",listener:u},{type:"dragstart",listener:u},{type:"dragenter",listener:u},{type:"dragover",listener:u}],{capture:!0})}}function Gn(){var e=null;function n(){return e=null,ve.bind(window,{type:"pointermove",listener:function(i){e={x:i.clientX,y:i.clientY}},options:{capture:!0}})}function t(){var r=null;return function(a){var l=a.eventName,s=a.payload;if(l==="onDragStart"){var u=s.location.initial.input,c=e??{x:u.clientX,y:u.clientY};r=$n({initial:c})}if(l==="onDrop"){var m,g=s.location.current.input;(m=r)===null||m===void 0||m({current:{x:g.clientX,y:g.clientY}}),r=null,e=null}}}return{bindEvents:n,getOnPostDispatch:t}}function Vn(e){if(Array.isArray(e))return Qe(e)}function Xn(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Zn(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zt(e){return Vn(e)||Xn(e)||qt(e)||Zn()}function ce(e){var n=null;return function(){if(!n){for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];var l=e.apply(this,i);n={result:l}}return n.result}}var Qn=ce(function(){return navigator.userAgent.includes("Firefox")}),Te=ce(function(){var n=navigator,t=n.userAgent;return t.includes("AppleWebKit")&&!t.includes("Chrome")}),Je={isLeavingWindow:Symbol("leaving"),isEnteringWindow:Symbol("entering")};function Jn(e){var n=e.dragLeave;return Te()?n.hasOwnProperty(Je.isLeavingWindow):!1}(function(){if(typeof window>"u"||!Te())return;function n(){return{enterCount:0,isOverWindow:!1}}var t=n();function r(){t=n()}ve.bindAll(window,[{type:"dragstart",listener:function(){t.enterCount=0,t.isOverWindow=!0}},{type:"drop",listener:r},{type:"dragend",listener:r},{type:"dragenter",listener:function(a){!t.isOverWindow&&t.enterCount===0&&(a[Je.isEnteringWindow]=!0),t.isOverWindow=!0,t.enterCount++}},{type:"dragleave",listener:function(a){t.enterCount--,t.isOverWindow&&t.enterCount===0&&(a[Je.isLeavingWindow]=!0,t.isOverWindow=!1)}}],{capture:!0})})();function er(e){return"nodeName"in e}function tr(e){return er(e)&&e.ownerDocument!==document}function nr(e){var n=e.dragLeave,t=n.type,r=n.relatedTarget;return t!=="dragleave"?!1:Te()?Jn({dragLeave:n}):r==null?!0:Qn()?tr(r):r instanceof HTMLIFrameElement}function rr(e){var n=e.onDragEnd;return[{type:"pointermove",listener:(function(){var t=0;return function(){if(t<20){t++;return}n()}})()},{type:"pointerdown",listener:n}]}function ye(e){return{altKey:e.altKey,button:e.button,buttons:e.buttons,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var ir=function(n){var t=[],r=null,i=function(){for(var l=arguments.length,s=new Array(l),u=0;u<l;u++)s[u]=arguments[u];t=s,!r&&(r=requestAnimationFrame(function(){r=null,n.apply(void 0,t)}))};return i.cancel=function(){r&&(cancelAnimationFrame(r),r=null)},i},Ge=ir(function(e){return e()}),xe=(function(){var e=null;function n(r){var i=requestAnimationFrame(function(){e=null,r()});e={frameId:i,fn:r}}function t(){e&&(cancelAnimationFrame(e.frameId),e.fn(),e=null)}return{schedule:n,flush:t}})();function ar(e){var n=e.source,t=e.initial,r=e.dispatchEvent,i={dropTargets:[]};function a(s){r(s),i={dropTargets:s.payload.location.current.dropTargets}}var l={start:function(u){var c=u.nativeSetDragImage,m={current:t,previous:i,initial:t};a({eventName:"onGenerateDragPreview",payload:{source:n,location:m,nativeSetDragImage:c}}),xe.schedule(function(){a({eventName:"onDragStart",payload:{source:n,location:m}})})},dragUpdate:function(u){var c=u.current;xe.flush(),Ge.cancel(),a({eventName:"onDropTargetChange",payload:{source:n,location:{initial:t,previous:i,current:c}}})},drag:function(u){var c=u.current;Ge(function(){xe.flush();var m={initial:t,previous:i,current:c};a({eventName:"onDrag",payload:{source:n,location:m}})})},drop:function(u){var c=u.current,m=u.updatedSourcePayload;xe.flush(),Ge.cancel(),a({eventName:"onDrop",payload:{source:m??n,location:{current:c,previous:i,initial:t}}})}};return l}var et={isActive:!1};function Qt(){return!et.isActive}function or(e){return e.dataTransfer?e.dataTransfer.setDragImage.bind(e.dataTransfer):null}function lr(e){var n=e.current,t=e.next;if(n.length!==t.length)return!0;for(var r=0;r<n.length;r++)if(n[r].element!==t[r].element)return!0;return!1}function sr(e){var n=e.event,t=e.dragType,r=e.getDropTargetsOver,i=e.dispatchEvent;if(!Qt())return;var a=ur({event:n,dragType:t,getDropTargetsOver:r});et.isActive=!0;var l={current:a};Ve({event:n,current:a.dropTargets});var s=ar({source:t.payload,dispatchEvent:i,initial:a});function u(p){var d=lr({current:l.current.dropTargets,next:p.dropTargets});l.current=p,d&&s.dragUpdate({current:l.current})}function c(p){var d=ye(p),v=Gt(p.target)?Vt({x:d.clientX,y:d.clientY}):p.target,k=r({target:v,input:d,source:t.payload,current:l.current.dropTargets});k.length&&(p.preventDefault(),Ve({event:p,current:k})),u({dropTargets:k,input:d})}function m(){l.current.dropTargets.length&&u({dropTargets:[],input:l.current.input}),s.drop({current:l.current,updatedSourcePayload:null}),g()}function g(){et.isActive=!1,w()}var w=ve.bindAll(window,[{type:"dragover",listener:function(d){c(d),s.drag({current:l.current})}},{type:"dragenter",listener:c},{type:"dragleave",listener:function(d){nr({dragLeave:d})&&(u({input:l.current.input,dropTargets:[]}),t.startedFrom==="external"&&m())}},{type:"drop",listener:function(d){if(l.current={dropTargets:l.current.dropTargets,input:ye(d)},!l.current.dropTargets.length){m();return}d.preventDefault(),Ve({event:d,current:l.current.dropTargets}),s.drop({current:l.current,updatedSourcePayload:t.type==="external"?t.getDropPayload(d):null}),g()}},{type:"dragend",listener:function(d){l.current={dropTargets:l.current.dropTargets,input:ye(d)},m()}}].concat(Zt(rr({onDragEnd:m}))),{capture:!0});s.start({nativeSetDragImage:or(n)})}function Ve(e){var n,t=e.event,r=e.current,i=(n=r[0])===null||n===void 0?void 0:n.dropEffect;i!=null&&t.dataTransfer&&(t.dataTransfer.dropEffect=i)}function ur(e){var n=e.event,t=e.dragType,r=e.getDropTargetsOver,i=ye(n);if(t.startedFrom==="external")return{input:i,dropTargets:[]};var a=r({input:i,source:t.payload,target:n.target,current:[]});return{input:i,dropTargets:a}}var jt={canStart:Qt,start:sr},tt=new Map;function cr(e){var n=e.typeKey,t=e.mount,r=tt.get(n);if(r)return r.usageCount++,r;var i={typeKey:n,unmount:t(),usageCount:1};return tt.set(n,i),i}function dr(e){var n=cr(e);return function(){n.usageCount--,!(n.usageCount>0)&&(n.unmount(),tt.delete(e.typeKey))}}function Ce(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return function(){n.forEach(function(i){return i()})}}function Jt(e,n){var t=n.attribute,r=n.value;return e.setAttribute(t,r),function(){return e.removeAttribute(t)}}function Mt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function ae(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Mt(Object(t),!0).forEach(function(r){Oe(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Mt(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Xe(e,n){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=fr(e))||n){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,l=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var c=t.next();return l=c.done,c},e:function(c){s=!0,a=c},f:function(){try{l||t.return==null||t.return()}finally{if(s)throw a}}}}function fr(e,n){if(e){if(typeof e=="string")return Ct(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ct(e,n):void 0}}function Ct(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function Ze(e){return e.slice(0).reverse()}function pr(e){var n=e.typeKey,t=e.defaultDropEffect,r=new WeakMap,i="data-drop-target-for-".concat(n),a="[".concat(i,"]");function l(p){return r.set(p.element,p),function(){return r.delete(p.element)}}function s(p){var d=Ce(Jt(p.element,{attribute:i,value:"true"}),l(p));return ce(d)}function u(p){var d,v,k,y,b=p.source,O=p.target,I=p.input,N=p.result,S=N===void 0?[]:N;if(O==null)return S;if(!(O instanceof Element))return O instanceof Node?u({source:b,target:O.parentElement,input:I,result:S}):S;var _=O.closest(a);if(_==null)return S;var j=r.get(_);if(j==null)return S;var L={input:I,source:b,element:j.element};if(j.canDrop&&!j.canDrop(L))return u({source:b,target:j.element.parentElement,input:I,result:S});var z=(d=(v=j.getData)===null||v===void 0?void 0:v.call(j,L))!==null&&d!==void 0?d:{},R=(k=(y=j.getDropEffect)===null||y===void 0?void 0:y.call(j,L))!==null&&k!==void 0?k:t,H={data:z,element:j.element,dropEffect:R,isActiveDueToStickiness:!1};return u({source:b,target:j.element.parentElement,input:I,result:[].concat(Zt(S),[H])})}function c(p){var d=p.eventName,v=p.payload,k=Xe(v.location.current.dropTargets),y;try{for(k.s();!(y=k.n()).done;){var b,O=y.value,I=r.get(O.element),N=ae(ae({},v),{},{self:O});I==null||(b=I[d])===null||b===void 0||b.call(I,N)}}catch(S){k.e(S)}finally{k.f()}}var m={onGenerateDragPreview:c,onDrag:c,onDragStart:c,onDrop:c,onDropTargetChange:function(d){var v=d.payload,k=new Set(v.location.current.dropTargets.map(function(Q){return Q.element})),y=new Set,b=Xe(v.location.previous.dropTargets),O;try{for(b.s();!(O=b.n()).done;){var I,N=O.value;y.add(N.element);var S=r.get(N.element),_=k.has(N.element),j=ae(ae({},v),{},{self:N});if(S==null||(I=S.onDropTargetChange)===null||I===void 0||I.call(S,j),!_){var L;S==null||(L=S.onDragLeave)===null||L===void 0||L.call(S,j)}}}catch(Q){b.e(Q)}finally{b.f()}var z=Xe(v.location.current.dropTargets),R;try{for(z.s();!(R=z.n()).done;){var H,Z,oe=R.value;if(!y.has(oe.element)){var le=ae(ae({},v),{},{self:oe}),q=r.get(oe.element);q==null||(H=q.onDropTargetChange)===null||H===void 0||H.call(q,le),q==null||(Z=q.onDragEnter)===null||Z===void 0||Z.call(q,le)}}}catch(Q){z.e(Q)}finally{z.f()}}};function g(p){m[p.eventName](p)}function w(p){var d=p.source,v=p.target,k=p.input,y=p.current,b=u({source:d,target:v,input:k});if(b.length>=y.length)return b;for(var O=Ze(y),I=Ze(b),N=[],S=0;S<O.length;S++){var _,j=O[S],L=I[S];if(L!=null){N.push(L);continue}var z=N[S-1],R=O[S-1];if(z?.element!==R?.element)break;var H=r.get(j.element);if(!H)break;var Z={input:k,source:d,element:H.element};if(H.canDrop&&!H.canDrop(Z)||!((_=H.getIsSticky)!==null&&_!==void 0&&_.call(H,Z)))break;N.push(ae(ae({},j),{},{isActiveDueToStickiness:!0}))}return Ze(N)}return{dropTargetForConsumers:s,getIsOver:w,dispatchEvent:g}}function vr(e,n){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=gr(e))||n){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,l=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var c=t.next();return l=c.done,c},e:function(c){s=!0,a=c},f:function(){try{l||t.return==null||t.return()}finally{if(s)throw a}}}}function gr(e,n){if(e){if(typeof e=="string")return Rt(e,n);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Rt(e,n):void 0}}function Rt(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function Nt(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function mr(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Nt(Object(t),!0).forEach(function(r){Oe(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Nt(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function br(){var e=new Set,n=null;function t(a){n&&(!a.canMonitor||a.canMonitor(n.canMonitorArgs))&&n.active.add(a)}function r(a){var l=mr({},a);e.add(l),t(l);function s(){e.delete(l),n&&n.active.delete(l)}return ce(s)}function i(a){var l=a.eventName,s=a.payload;if(l==="onGenerateDragPreview"){n={canMonitorArgs:{initial:s.location.initial,source:s.source},active:new Set};var u=vr(e),c;try{for(u.s();!(c=u.n()).done;){var m=c.value;t(m)}}catch(k){u.e(k)}finally{u.f()}}if(n){for(var g=Array.from(n.active),w=0,p=g;w<p.length;w++){var d=p[w];if(n.active.has(d)){var v;(v=d[l])===null||v===void 0||v.call(d,s)}}l==="onDrop"&&(n.active.clear(),n=null)}}return{dispatchEvent:i,monitorForConsumers:r}}function yr(e){var n=e.typeKey,t=e.mount,r=e.dispatchEventToSource,i=e.onPostDispatch,a=e.defaultDropEffect,l=br(),s=pr({typeKey:n,defaultDropEffect:a});function u(g){r?.(g),s.dispatchEvent(g),l.dispatchEvent(g),i?.(g)}function c(g){var w=g.event,p=g.dragType;jt.start({event:w,dragType:p,getDropTargetsOver:s.getIsOver,dispatchEvent:u})}function m(){function g(){var w={canStart:jt.canStart,start:c};return t(w)}return dr({typeKey:n,mount:g})}return{registerUsage:m,dropTarget:s.dropTargetForConsumers,monitor:l.monitorForConsumers}}var en=ce(function(){return navigator.userAgent.toLocaleLowerCase().includes("android")}),hr="pdnd:android-fallback",Lt="text/plain",kr="text/uri-list",wr="application/vnd.pdnd",je=new WeakMap;function Er(e){return je.set(e.element,e),function(){je.delete(e.element)}}var Ht=Gn(),lt=yr({typeKey:"element",defaultDropEffect:"move",mount:function(n){return Ce(Ht.bindEvents(),ve.bind(document,{type:"dragstart",listener:function(r){var i,a,l,s,u,c;if(n.canStart(r)&&!r.defaultPrevented&&r.dataTransfer){var m=r.target;if(m instanceof HTMLElement){var g=je.get(m);if(g){var w=ye(r),p={element:g.element,dragHandle:(i=g.dragHandle)!==null&&i!==void 0?i:null,input:w};if(g.canDrag&&!g.canDrag(p)){r.preventDefault();return}if(g.dragHandle){var d=Vt({x:w.clientX,y:w.clientY});if(!g.dragHandle.contains(d)){r.preventDefault();return}}var v=(a=(l=g.getInitialDataForExternal)===null||l===void 0?void 0:l.call(g,p))!==null&&a!==void 0?a:null;if(v)for(var k=0,y=Object.entries(v);k<y.length;k++){var b=ot(y[k],2),O=b[0],I=b[1];r.dataTransfer.setData(O,I??"")}en()&&!r.dataTransfer.types.includes(Lt)&&!r.dataTransfer.types.includes(kr)&&r.dataTransfer.setData(Lt,hr),r.dataTransfer.setData(wr,"");var N={element:g.element,dragHandle:(s=g.dragHandle)!==null&&s!==void 0?s:null,data:(u=(c=g.getInitialData)===null||c===void 0?void 0:c.call(g,p))!==null&&u!==void 0?u:{}},S={type:"element",payload:N,startedFrom:"internal"};n.start({event:r,dragType:S})}}}}}))},dispatchEventToSource:function(n){var t,r,i=n.eventName,a=n.payload;(t=je.get(a.source.element))===null||t===void 0||(r=t[i])===null||r===void 0||r.call(t,a)},onPostDispatch:Ht.getOnPostDispatch()}),Or=lt.dropTarget,tn=lt.monitor;function Tr(e){var n=Ce(lt.registerUsage(),Er(e),Jt(e.element,{attribute:"draggable",value:"true"}));return ce(n)}function Ft(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),t.push.apply(t,r)}return t}function Ut(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Ft(Object(t),!0).forEach(function(r){Oe(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ft(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}var Sr={top:function(n,t){return Math.abs(t.y-n.top)},right:function(n,t){return Math.abs(n.right-t.x)},bottom:function(n,t){return Math.abs(n.bottom-t.y)},left:function(n,t){return Math.abs(t.x-n.left)}},nn=Symbol("closestEdge");function Dr(e,n){var t,r,i=n.element,a=n.input,l=n.allowedEdges,s={x:a.clientX,y:a.clientY},u=i.getBoundingClientRect(),c=l.map(function(g){return{edge:g,value:Sr[g](u,s)}}),m=(t=(r=c.sort(function(g,w){return g.value-w.value})[0])===null||r===void 0?void 0:r.edge)!==null&&t!==void 0?t:null;return Ut(Ut({},e),{},Oe({},nn,m))}function nt(e){var n;return(n=e[nn])!==null&&n!==void 0?n:null}function Ar(e){var n=e.list,t=e.startIndex,r=e.finishIndex;if(t===-1||r===-1)return Array.from(n);var i=Array.from(n),a=i.splice(t,1),l=ot(a,1),s=l[0];return i.splice(r,0,s),i}function xr(e){var n=e.startIndex,t=e.closestEdgeOfTarget,r=e.indexOfTarget,i=e.axis;if(n===-1||r===-1||n===r)return n;if(t==null)return r;var a=t==="bottom"||i==="horizontal",l=n<r;return l?a?r:r-1:a?r+1:r}function Ir(e){var n=e.list,t=e.startIndex,r=e.closestEdgeOfTarget,i=e.indexOfTarget,a=e.axis;return Ar({list:n,startIndex:t,finishIndex:xr({closestEdgeOfTarget:r,startIndex:t,indexOfTarget:i,axis:a})})}var Pr={large:700};function _r(e){e.animate([{backgroundColor:"var(--ds-background-selected, #E9F2FF)"},{}],{duration:Pr.large,easing:"cubic-bezier(0.25, 0.1, 0.25, 1.0)",iterations:1})}function jr(){return{x:0,y:0}}function Mr(e){var n=e.render,t=e.nativeSetDragImage,r=e.getOffset,i=r===void 0?jr:r,a=document.createElement("div");Object.assign(a.style,{position:"fixed",top:0,left:0,zIndex:Xt,pointerEvents:"none"}),document.body.append(a);var l=n({container:a});queueMicrotask(function(){var c=i({container:a});if(Te()){var m=a.getBoundingClientRect();if(m.width===0)return;a.style.left="-".concat(m.width-1e-4,"px")}t?.(a,c.x,c.y)});function s(){u(),l?.(),document.body.removeChild(a)}var u=tn({onDragStart:s,onDrop:s})}var Cr=ce(function(){return Te()&&"ontouchend"in document}),Rr=function(n){var t=n.container,r=t.getBoundingClientRect();return{x:r.width/2,y:r.height/2}};function Nr(e){return function(t){var r=t.container;if(Cr()||en())return Rr({container:r});Object.assign(r.style,{borderInlineStart:"".concat(e.x," solid transparent"),borderTop:"".concat(e.y," solid transparent")});var i=window.getComputedStyle(r);if(i.direction==="rtl"){var a=r.getBoundingClientRect();return{x:a.width,y:0}}return{x:0,y:0}}}var Lr="Invariant failed";function Hr(e,n){if(!e)throw new Error(Lr)}var Fr=K("<div></div>");function Ur(e,n){let t=J(n,"edge",3,"top"),r=J(n,"gap",3,"0.5rem");const i=2,a=8,l=(i-a)/2,s=`calc(-0.5 * (${r()} + ${i}px))`;var u=Fr();let c;B(m=>{Me(u,1,it(["drop-indicator",`${t()}`]),"svelte-l5wnev"),c=at(u,"",c,m)},[()=>({"--line-thickness":`${i}px`,"--line-offset":s,"--terminal-size":`${a}px`,"--terminal-radius":`${a/2}px`,"--negative-terminal-size":`-${a}px`,"--offset-terminal":`${l}px`,position:"absolute","pointer-events":"none"})]),U(e,u)}class Wr{#t=C(!0);get single(){return o(this.#t)}set single(n){T(this.#t,n,!0)}#n=C(te(new Map));#r=C(te(new Map));#e=C(te(new Map));#i=C(null);debug=Ie.debugging;getSetting(n){return this.#a||this.#o(),o(this.#n).get(n)}setSetting(n,t){return this.debug&&console.debug({setting:{[n.toString()]:t}}),o(this.#n).set(n,t)}#a=!1;#o(){this.#a=!0,this.single=!0}register(n,t){const{itemId:r}=t??{};this.debug&&console.debug({registering:{itemId:r,name:n.name}}),r==null?o(this.#r).set(n.name,n):(o(this.#e).get(r)==null&&o(this.#e).set(r,{}),this.retrieve(n.name,{itemId:r})!=null&&this.debug&&console.warn(`Redefining function: ${n.name} for item: ${r}`),o(this.#e).get(r)[n.name]=n)}retrieve(n,t){const{itemId:r,useActive:i}=t??{};if(n==null&&r==null&&i!=!0)throw new Error("At least one of `name`, `itemId`, or `useActive` required.");const a=i?this.activeId:r;return n==null?(this.debug&&console.debug({retrieving:{itemId:r,useActive:i}}),o(this.#e).get(a)):r==null&&i!=!0?(this.debug&&console.debug({retrieving:{name:n}}),o(this.#r).get(n)):o(this.#e).get(a)?.[n]}retrieveAll(n){return o(this.#e).values().map(t=>t[n]).filter(Boolean)}any(n){const t=this.retrieveAll(n);let r=!1;for(const i of t)if(r||=i(),r)break;return r}all(n){const t=this.retrieveAll(n);let r=!0;for(const i of t)if(r&&=i(),!r)break;return r}set activeId(n){this.debug&&console.debug({activeId:n}),T(this.#i,n,!0)}get activeId(){return o(this.#i)}}const E=new Wr;var zr=K('<img class="svelte-19kijc7"/>'),Kr=K("<audio controls><source/></audio>"),Br=K('<video controls class="svelte-19kijc7"><source/> <track kind="captions"/></video>',2),qr=K(`<object class="svelte-19kijc7"><p>Your browser can't render an <code>&lt;object&gt;</code> of type <q> </q>.</p></object>`);function st(e,n){re(n,!0);const{debug:t}=E;let r=J(n,"content",15);const{cid:i,title:a,type:l}=n.datum;let s=rt(()=>{if(l==null)return"undefined";const[w,p,d]=Array.from(l.match(/^([^/]+)\/(.*)$/)??[]);return t&&console.debug({klass:p,ext:d}),d!=="svg+xml"?p:"object"});var u=Be(),c=fe(u);{var m=w=>{var p=zr();G(p,d=>r(d),()=>r()),B(d=>{F(p,"id",i),F(p,"src",d),F(p,"alt",a)},[()=>Ae({cid:i})]),U(w,p)},g=w=>{var p=Be(),d=fe(p);{var v=y=>{var b=Kr();F(b,"tabindex",-1);var O=A(b);D(b),G(b,I=>r(I),()=>r()),B(I=>{F(b,"id",i),F(O,"src",I),F(O,"type",l)},[()=>Ae({cid:i})]),U(y,b)},k=y=>{var b=Be(),O=fe(b);{var I=S=>{var _=Br();F(_,"tabindex",-1);var j=A(_);X(2),D(_),G(_,L=>r(L),()=>r()),B(L=>{F(_,"id",i),F(j,"src",L),F(j,"type",l)},[()=>Ae({cid:i})]),U(S,_)},N=S=>{var _=qr(),j=A(_),L=M(A(j),3),z=A(L,!0);D(L),X(),D(j),D(_),G(_,R=>r(R),()=>r()),B(R=>{F(_,"id",i),F(_,"data",R),F(_,"title",a),F(_,"type",l),ge(z,l)},[()=>Ae({cid:i})]),U(S,_)};ue(O,S=>{o(s)==="video"?S(I):S(N,!1)},!0)}U(y,b)};ue(d,y=>{o(s)==="audio"?y(v):y(k,!1)},!0)}U(w,p)};ue(c,w=>{o(s)==="image"?w(m):w(g,!1)})}U(e,u),ie()}var Yr=(e,n)=>n()?.close(),$r=(e,n)=>n()?.close(),Gr=(e,n,t)=>{const r=new CustomEvent("datum-delete",{detail:{id:n.datum.id},bubbles:!0});t().dispatchEvent(r)},Vr=K('<dialog><h1> </h1> <button id="x" commandfor="close" class="svelte-8ffply">‚®Ø</button> <form class="svelte-8ffply"><!> <nav class="svelte-8ffply"><button id="cancel" type="button" commandfor="close" class="svelte-8ffply"><u>C</u>ancel</button> <button id="delete" class="svelte-8ffply"><u>R</u>emove</button></nav></form></dialog>');function Xr(e,n){re(n,!0);let t=J(n,"handle",15,null),r=C(null);var i=Vr(),a=A(i),l=A(a);D(a);var s=M(a,2);s.__click=[Yr,t];var u=M(s,2),c=A(u);st(c,{get datum(){return n.datum}});var m=M(c,2),g=A(m);g.__click=[$r,t];var w=M(g,2);w.__click=[Gr,n,t],G(w,p=>T(r,p),()=>o(r)),D(m),D(u),D(i),G(i,p=>t(p),()=>t()),B(()=>ge(l,`Delete ${n.datum.title??""}?`)),pe("open",i,()=>{console.debug({opened:t()}),_e().then(()=>o(r)?.focus())}),pe("submit",u,p=>p.preventDefault()),U(e,i),ie()}Ee(["click"]);var Zr=()=>{},Qr=(e,n,t,r,i,a,l,s)=>{n&&console.debug({"zoom:onkeydown":{"üîë":e.key,isMedia:o(t)instanceof HTMLMediaElement}}),e.stopImmediatePropagation(),["z","Escape"].includes(e.key)?r().close():["Enter","ArrowDown"].includes(e.key)?(o(t)instanceof HTMLMediaElement&&o(t).pause(),i(1)):["ArrowUp"].includes(e.key)?(o(t)instanceof HTMLMediaElement&&o(t).pause(),i(-1)):["ArrowLeft"].includes(e.key)&&o(t)instanceof HTMLMediaElement?a({scale:-30}):["ArrowRight"].includes(e.key)&&o(t)instanceof HTMLMediaElement?a({scale:30}):[" "].includes(e.key)&&o(t)instanceof HTMLMediaElement?o(l)["play|pause"]():["m"].includes(e.key)&&o(t)instanceof HTMLMediaElement?o(l)["(un)?mute"]():["+","="].includes(e.key)?s({factor:1.2}):["-","_"].includes(e.key)?s({factor:.8}):["f"].includes(e.key)&&o(t)instanceof HTMLMediaElement?o(l).fullscreen():/^\d$/.test(e.key)?a({to:Number(e.key)/9-1e-5}):console.debug({"dialog:onkeypress":{"üîë":e.key}})},Jr=K('<dialog class="zoom svelte-1ptnkpr"><h1 class="svelte-1ptnkpr"> </h1> <!></dialog>');function ei(e,n){re(n,!0);let t=J(n,"handle",15,null),r=C(null);const{debug:i}=E;let a;he(()=>{a=In(()=>import("../chunks/CO7MEcO7.js").then(v=>v.h),__vite__mapDeps([0,1]),import.meta.url)});function l({factor:v=1,scale:k=0}){if(!o(r))throw new Error("`content` is null.");const y=getComputedStyle(o(r));let b=Number(y.scale);isNaN(b)&&(b=1);let O=b*v+k;i&&console.debug({zoom:b,factor:v,scale:k,next:O}),o(r).style.scale=String(O),t().style.setProperty("--max-width","auto"),t().style.setProperty("--max-height","auto")}function s({factor:v=1,scale:k=0}){if(!o(r))throw new Error("`content` is null.");if(!(o(r)instanceof HTMLMediaElement))i&&console.warn("`content` is not a media element.");else{const y=o(r).volume;let b=y*v+k;i&&console.debug({volume:y,factor:v,scale:k,next:b})}}function u({factor:v=1,scale:k=0,to:y=null}){if(!o(r))throw new Error("`content` is null.");if(!(o(r)instanceof HTMLMediaElement))i&&console.warn("`content` is not a media element.");else{let b=o(r).currentTime;y!=null&&(y<1?b=y*o(r).duration:b=y);let O=b*v+k;i&&console.debug({time:b,to:y,factor:v,scale:k,next:O}),o(r).currentTime=O}}const c=rt(()=>{const k=Object.fromEntries(["play|pause","(un)?mute","fullscreen"].map(y=>[y,()=>{}]));if(!o(r))i&&console.warn("`content` is null.");else if(!(o(r)instanceof HTMLMediaElement))i&&console.warn("`content` is not a media element.");else{const y=o(r);Object.assign(k,{"play|pause":Ye({condition:()=>y.paused,branch:{if:()=>y.play(),else:()=>y.pause()}}),"(un)?mute":Ye({branch:{if:()=>y.muted=!y.muted}}),fullscreen:Ye({condition:()=>!!document.fullscreenElement,branch:{if:()=>document.exitFullscreen(),else:()=>y.requestFullscreen()}})})}return k});function m(v){let k=t();const y=v>=0;if(Math.abs(v)>0)do k=k.closest("li")?.[y?"previousElementSibling":"nextElementSibling"]?.querySelector(".zoom"),k||(k=t().closest("li")?.parentElement?.[y?"lastElementChild":"firstElementChild"]?.querySelector(".zoom")),v+=y?-1:1;while(Math.abs(v)>0&&k);k&&(t().close(),k.showModal())}he(()=>{const v=new a(t());v.get("pinch").set({enable:!0}),v.on("swiperight",()=>{m(1)}),v.on("swipeleft",()=>{m(-1)}),v.on("panright",()=>{u({scale:2})}),v.on("panleft",()=>{u({scale:-2})}),v.on("panup",()=>{s({scale:20})}),v.on("pandown",()=>{s({scale:-20})}),v.on("pinchin",()=>{l({factor:.8})}),v.on("pinchout",()=>{l({factor:1.2})}),v.on("tap",()=>{o(c)["play/pause"]?.()}),v.on("doubletap",()=>{t().close()})});var g=Jr();g.__click=[Zr],g.__keydown=[Qr,i,r,t,m,u,c,l];var w=A(g),p=A(w,!0);D(w);var d=M(w,2);st(d,{get datum(){return n.datum},get content(){return o(r)},set content(v){T(r,v,!0)}}),D(g),G(g,v=>t(v),()=>t()),B(()=>ge(p,n.datum.title)),U(e,g),ie()}Ee(["click","keydown"]);var ti=(e,n,t,r,i,a)=>{o(n)||(e.preventDefault(),t&&console.debug({"summary:onclick":{"details.open":o(r)?.open,content:o(i),evt:e,"var:open":a()}}))},ni=(e,n)=>{o(n)||e.preventDefault()},ri=K('<form class="svelte-vp13bz"><input name="title"/> <button type="submit">üíæ</button></form>'),ii=K('<details class="svelte-vp13bz"><summary class="svelte-vp13bz"><!></summary> <!></details> <!> <!>',1);function ai(e,n){re(n,!0);const{debug:t}=E;class r extends Error{constructor(){super("Not a media element.")}}let i=J(n,"datum",15,null),a=J(n,"open",15,!1),l=C(null),s=C(null);if(i()==null)throw new Error(" `null` `datum`.");const{id:u,cid:c,title:m,type:g}=i();let w=C(null),p=C(null),d=C(null),v=C(!1);te(m);const{single:k}=E;he(()=>{n.index===0&&o(l)?.focus()});function y(P){const{play:Y=null,pitch:ee=null}=P??{};if(!(o(s)instanceof HTMLMediaElement)){if(ee===!1)return;throw t&&console.debug({rejecting:o(s)}),new r}(o(s).paused||Y===!0)&&Y!==!1?(t&&console.debug({playing:o(s)}),o(s).play()):(t&&console.debug({pausing:o(s)}),o(s).pause())}E.register(y,{itemId:u});function b(P){o(w)&&((!a()||P?.open===!0)&&P?.open!==!1?(t&&console.debug({opening:o(w)}),a(!0)):(t&&console.debug({closing:o(w)}),a(!1),y({play:!1,pitch:!1})))}E.register(b,{itemId:u});function O(){return a()}E.register(O,{itemId:u});function I(){t&&console.debug({zoom:{datum:i(),open:o(d)?.open,modal:o(d)?.matches(":modal")}}),o(d)?.matches(":modal")?o(d)?.close():o(d)?.showModal()}E.register(I,{itemId:u});function N(){o(p)?.showModal()}E.register(N,{itemId:u});function S(){o(l)?.focus()}E.register(S,{itemId:u});function _(P){T(v,P,!0)}E.register(_,{itemId:u});function j(){return o(v)}E.register(j,{itemId:u});function L(P){o(v)&&P.focus()}var z=ii(),R=fe(z),H=A(R);F(H,"tabindex",0),H.__click=[ti,v,t,w,s,a],H.__keydown=[ni,v];var Z=A(H);{var oe=P=>{var Y=ri(),ee=A(Y);Kt(ee),zt(()=>hn(ee,()=>i().title,ne=>i(i().title=ne,!0))),_n(ee,ne=>L?.(ne)),X(2),D(Y),pe("submit",Y,ne=>{ne.preventDefault(),T(v,!1)}),U(P,Y)},le=P=>{var Y=gn();B(ee=>ge(Y,`${i().title??""} ${ee??""}`),[()=>g?.startsWith("video/")?"üé¨":""]),U(P,Y)};ue(Z,P=>{o(v)?P(oe):P(le,!1)})}D(H),G(H,P=>T(l,P),()=>o(l));var q=M(H,2);st(q,{get datum(){return i()},get content(){return o(s)},set content(P){T(s,P,!0)}}),D(R),G(R,P=>T(w,P),()=>o(w));var Q=M(R,2);Xr(Q,{get datum(){return i()},get handle(){return o(p)},set handle(P){T(p,P,!0)}});var Se=M(Q,2);ei(Se,{get datum(){return i()},get handle(){return o(d)},set handle(P){T(d,P,!0)}}),B(()=>{F(R,"name",`file${k?"":`-${n.index+1}`}`),F(R,"id",`deets-${n.index+1}`),F(H,"id",`sum-${n.index+1}`)}),jn("open","toggle",R,a,a),U(e,z),ie()}Ee(["click","keydown"]);var oi=K('<div class="border-solid rounded p-2 bg-white dark:bg-white/25"> </div>');function Wt(e,n){re(n,!0);var t=oi(),r=A(t,!0);D(t),B(()=>ge(r,n.datum.title)),U(e,t),ie()}var li=K("<li><!> <!></li>");function si(e,n){re(n,!0);const{debug:t}=E,r={type:"idle"};let i=J(n,"datum",15,null);if(i()==null)throw new Error("`null` `datum`.");let a=C(null),l=C(te(r)),s=C(!1);he(()=>(Hr(o(a)),Ce(Tr({element:o(a),getInitialData(){return i()},onGenerateDragPreview({nativeSetDragImage:d}){Mr({nativeSetDragImage:d,getOffset:Nr({x:"1rem",y:"0.5rem"}),render({container:v}){Wt!=null&&(T(l,{type:"preview",container:v},!0),mn(Wt,{target:v,props:{datum:i()}}))}})},onDragStart(){T(l,{type:"is-dragging"},!0)},onDrop(){T(l,r,!0)}}),Or({element:o(a),canDrop({source:d}){return d.element===o(a)?!1:n.isDatum(d.data)},getData({input:d}){return i()==null?{}:o(a)==null?i():Dr(i(),{element:o(a),input:d,allowedEdges:["top","bottom"]})},getIsSticky(){return!0},onDragEnter({self:d}){const v=nt(d.data);T(l,{type:"is-dragging-over",closestEdge:v},!0)},onDrag({self:d}){const v=nt(d.data);T(l,{type:"is-dragging-over",closestEdge:v},!0)},onDragLeave(){T(l,r,!0)},onDrop(){T(l,r,!0)}}))));const u=()=>{E.activeId=i()?.id??null};var c=li();c.__focusin=u,c.__click=d=>{u(),E.any("isEditing")||(E.retrieve("focus",{useActive:!0})(),(!d.ctrlKey||!o(s))&&E.retrieve("toggleOpen",{useActive:!0})())};let m;var g=A(c);ai(g,{get index(){return n.index},get datum(){return i()},set datum(d){i(d)},get open(){return o(s)},set open(d){T(s,d,!0)}});var w=M(g,2);{var p=d=>{Ur(d,{get edge(){return o(l).closestEdge},gap:"0.5rem"})};ue(w,d=>{o(l).type==="is-dragging-over"&&o(l).closestEdge&&d(p)})}D(c),G(c,d=>T(a,d),()=>o(a)),B((d,v)=>{F(c,"data-element-id",i()?.id),Me(c,1,d,"svelte-1pymd35"),m=at(c,"",m,v)},[()=>it(n.rowClasses?.(o(l).type)),()=>({"view-transition-name":`item-${i()?.id}`})]),pe("keypress",c,()=>{}),U(e,c),ie()}Ee(["focusin","click"]);var ui=K("<ol></ol>");function ci(e,n){re(n,!0);let t=J(n,"data",31,()=>te([])),r=J(n,"history",27,()=>te([])),i=C(null);const a=s=>n.isDatum?n.isDatum(s):!0;he(()=>tn({canMonitor({source:s}){return a(s.data)},onDrop({location:s,source:u}){const[c]=s.current.dropTargets;if(!c)return;const{data:m}=u,{data:g}=c;if(!a(m)||!a(g))return;const w=b=>t().findIndex(({id:O})=>O===b),p=w(m.id),d=w(g.id);if(d<0||p<0)return;const v=nt(g),k=async()=>{r().push([...t()]);const b={idx:p},O={idx:d};if(o(i)){for(const I of[b,O])I.elem=o(i)?.querySelector(`li:nth-of-type(${I.idx+1})`),I.color=getComputedStyle(I.elem).borderColor;b.elem&&b.color&&O.elem&&O.color&&(b.elem.style.borderColor=b.color,O.elem.style.borderColor=O.color)}t(Ir({list:t(),startIndex:p,indexOfTarget:d,closestEdgeOfTarget:v,axis:"vertical"})),await _e(),b.elem&&b.color&&O.elem&&O.color&&(b.elem.style.borderColor=O.color,O.elem.style.borderColor=b.color)};"startViewTransition"in document?document.startViewTransition(k):k();const y=document.querySelector(`[data-element-id="${m.id}"]`);y instanceof HTMLElement&&_r(y)}}));var l=ui();xn(l,23,t,s=>s.id,(s,u,c)=>{si(s,{get rowClasses(){return n.rowClasses},isDatum:a,get index(){return o(c)},get datum(){return t()[o(c)]},set datum(m){t(t()[o(c)]=m,!0)}})}),D(l),G(l,s=>T(i,s),()=>o(i)),B(s=>Me(l,1,s),[()=>it([...Array.from(n.listClasses??[]),"sortable-list"])]),U(e,l),ie()}var di=K('<dialog><h1>Keyboard & Touch Navigation</h1> <form method="dialog"><button id="close" class="svelte-j05li0">‚®Ø</button> <ul class="svelte-j05li0"><li><kbd>?</kbd>: (Display|Hide) these shortcuts.</li> <li><kbd>‚Üë</kbd> | <kbd>‚Üì</kbd>: Highlight the (previous|next) entry.</li> <li><kbd>enter</kbd>: (Expand|Collapse) the highlighted entry.</li> <li><kbd>e</kbd>: Edit the title of the highlighted entry.</li> <li><kbd>c</kbd>: Copy the highlighted entry to a different list.</li> <li><kbd>x</kbd> / <kbd>delete</kbd> / <kbd>backspace</kbd>: Delete the highlighted entry.</li> <li><kbd>s</kbd> | <kbd>n</kbd>: (Save|Load) the current configuration (to|from) Neo4j.</li> <li><kbd>j</kbd>: Jump to a specific entry number.</li> <li><kbd>m</kbd>, (<kbd>‚Üë</kbd> | <kbd>‚Üì</kbd>), <kbd>enter</kbd>: Move the selected entry (up|down).</li> <li><kbd>d</kbd> | <kbd>l</kbd>: (Down)?Load the congfiguration as JSON5.</li> <li><kbd>p</kbd> | <kbd>b</kbd>: (Publish|Load) a CBOR representation of the list (to|from) IPFS pub/sub.</li> <li><kbd>a</kbd>: Add local files to the list <em>(removing duplicates)</em>.</li> <li><kbd>v</kbd>: View all entries.</li> <li><kbd>h</kbd>: Hide all entries.</li> <li><kbd>u</kbd> | <kbd>r</kbd>: (Un|Re)do the last change.</li> <li><kbd><i>space</i></kbd>: <ul class="svelte-j05li0"><li>If the highlighted entry is collapsed, expand it.</li> <li>If the expanded entry is media, (play|pause) it.</li> <li>If the expanded entry is not media, collapse it.</li></ul></li> <li><kbd>z</kbd>: Zoom in on the highlighted entry: <ul class="svelte-j05li0"><li><kbd>z</kbd> / <kbd>escape</kbd>: Zoom out.</li> <li><kbd>‚Üë</kbd> / <em>swipe</em> <kbd>‚Üë</kbd>: View the previous entry.</li> <li><kbd>‚Üì</kbd> / <em>swipe</em> <kbd>‚Üì</kbd>: View the next entry.</li> <li><em>pan</em> <kbd>‚Üí</kbd> | <em>pan</em> <kbd>‚Üê</kbd>: Seek (forward|back) by 2 seconds.</li> <li><kbd>‚Üí</kbd> | <kbd>‚Üê</kbd>: Seek (forward|back) by ¬Ω minute.</li> <li>(<kbd>‚Üí</kbd> | <kbd>‚Üê</kbd>) ‚â• 2sec: Seek (forward|back) by 7¬Ω% for each additional 1¬Ω second held.</li> <li><kbd>0</kbd>‚Äì<kbd>9</kbd>: Seek to 0‚Äì100% of the way through the media.</li> <li><kbd>ctrl</kbd> ‚ûï (<kbd>‚Üë</kbd> | <kbd>‚Üì</kbd>) / (<em>pan</em>)? (<kbd>‚Üë</kbd> | <kbd>‚Üì</kbd>): (In|De)crease the volume by 75%.</li> <li><kbd>space</kbd>: (Play|Pause) media.</li> <li><kbd>m</kbd>: (Un)?Mute media.</li> <li><kbd>f</kbd>: Toggle fullscreen.</li></ul></li></ul> <ul id="controls" class="svelte-j05li0"><li><button id="ok">OK</button></li></ul></form></dialog>');function fi(e,n){re(n,!0);let t=J(n,"handle",15,null);var r=di();G(r,i=>t(i),()=>t()),U(e,r),ie()}var pi=K('<link rel="icon" class="svelte-k3n1lf"/> <meta name="description" class="svelte-k3n1lf"/>',1),vi=(e,n)=>o(n)?.click(),gi=(e,n,t)=>n(e,t),mi=(e,n)=>o(n)?.click(),bi=K('<span class="svelte-k3n1lf"><section class="svelte-k3n1lf"><p class="svelte-k3n1lf">Loading‚Ä¶</p> <progress class="svelte-k3n1lf"> </progress></section></span>'),yi=K('<span class="svelte-k3n1lf">Add Files</span>'),hi=(e,n,t)=>n(e,t),ki=K('<p class="svelte-k3n1lf">No entries yet.</p>'),wi=K('<header class="svelte-k3n1lf"><h1 class="svelte-k3n1lf">Merge List</h1> <nav class="svelte-k3n1lf"><ul id="controls" class="svelte-k3n1lf"><li class="svelte-k3n1lf"><button id="save" type="button"><span class="svelte-k3n1lf">üñ´</span></button> <dialog open class="svelte-k3n1lf">Save</dialog></li> <li class="svelte-k3n1lf"><button id="load" type="button" class="svelte-k3n1lf"><span class="svelte-k3n1lf">üì•</span></button> <dialog open class="svelte-k3n1lf">Load</dialog></li> <li class="svelte-k3n1lf"><form class="svelte-k3n1lf"><label class="svelte-k3n1lf"><button id="export" type="button" class="svelte-k3n1lf"><span class="svelte-k3n1lf">‚≠±</span></button> <input type="file" accept="*json5,*.json" multiple class="svelte-k3n1lf"/></label></form> <dialog open class="svelte-k3n1lf">Import</dialog></li> <li class="svelte-k3n1lf"><button id="import" type="button" class="svelte-k3n1lf"><span class="svelte-k3n1lf">‚≠≥</span></button> <dialog open class="svelte-k3n1lf">Export</dialog></li> <li class="svelte-k3n1lf"><button id="undo" type="button" class="svelte-k3n1lf"><span class="svelte-k3n1lf">‚Ü∫</span></button> <dialog open class="svelte-k3n1lf">Undo</dialog></li> <li class="svelte-k3n1lf"><button id="shortcuts" type="button" class="pulsing svelte-k3n1lf"><span class="svelte-k3n1lf">‚å®</span></button> <dialog open class="svelte-k3n1lf">Shortcuts</dialog></li> <li class="svelte-k3n1lf"><button id="show" type="button" class="svelte-k3n1lf"><span class="svelte-k3n1lf">‚ü±</span></button> <dialog open class="svelte-k3n1lf">Show All</dialog></li> <li class="svelte-k3n1lf"><button id="hide" type="button" class="svelte-k3n1lf"><span class="svelte-k3n1lf">‚ü∞</span></button> <dialog open class="svelte-k3n1lf">Hide All</dialog></li> <li class="svelte-k3n1lf"><label class="button svelte-k3n1lf" id="single"><input type="checkbox" class="svelte-k3n1lf"/> <span class="svelte-k3n1lf">‚Ö†</span></label> <dialog open class="svelte-k3n1lf">Single<br class="svelte-k3n1lf"/>Visible</dialog></li></ul></nav></header> <main class="svelte-k3n1lf"><!> <form class="svelte-k3n1lf"><label class="svelte-k3n1lf"><button id="add-file" type="button" class="svelte-k3n1lf"><!></button> <input type="file" accept="image/*,video/*,audio/*" multiple class="svelte-k3n1lf"/></label></form> <!> <!></main>',1);function qi(e,n){re(n,!0);const{debug:t}=E;let r=C(te([])),i=Sn(),a=C(!1),l=C(!1),s=C(!1),u=C(te([])),c=C(0),m=0,g=C(null),w=C(null),p=C(null),d=C(te((Tn.params.path?.split("/")??[]).filter(Boolean)));o(d).length===0&&o(d).push("");const v=rt(()=>o(d).filter(f=>f.trim()!=="").length>0),k=(f,h={})=>{wn({text:f,duration:16e3,close:!0,gravity:"bottom",position:"center",stopOnFocus:!0,style:{background:"linear-gradient(to right, #1E396A, #F32587)"},...h}).showToast()};async function y(f){const h={chunker:"rabin",cidVersion:1,progress:V=>{T(c,o(c)+V)},timeout:6e4},x=f.reduce((V,{size:de})=>V+de,0);t&&console.debug({Adding:f,"Total Size":x,options:h});let W=[],$=0;for await(const{cid:V}of i.addAll(f,h))t&&console.debug({"Added Local":{cid:V,file:f[$].name}}),W.push({cid:V.toString(),title:f[$].name.replace(/\.[^.]*$/,""),type:f[$].type}),$++;return Pe(W)}async function b(f){const h=await En();if(!Ie.storachaEmail)throw new Error("No Storacha email specified in settings.");const x=await h.login(Ie.storachaEmail);let W=h.spaces().find(V=>V.name==="M√Ømis");if(W||(W=await h.createSpace("M√Ømis",{account:x})),!W)throw new Error('Couldn‚Äôt find or create space: "M√Ømis".');await h.setCurrentSpace(W.did());const $=await Promise.all(f.map(async V=>({cid:(await h.uploadFile(V,{dedupe:!0})).toString(),title:V.name.replace(/\.[^.]*$/,""),type:V.type})));return Pe($)}async function O(f){try{Array.isArray(f)||(f=[f]);const h=Ie.saveLocal?await y(f):await b(f);t&&console.debug({Added:h});const x=h[0].id,W=o(r).map(({cid:de})=>de),$=h.filter(({cid:de})=>!W.includes(de));t&&console.debug({infos:h,"Unique Entries":$}),T(r,o(r).concat($),!0),await _e(),document.querySelector(`[data-element-id="${x}"] summary`)?.focus()}catch(h){throw console.error({"IPFS Add Error":h}),h.response?.status===0?new Error("Couldn‚Äôt connect to IPFS."):h}}async function I(f){const h=await Promise.all(f.map(async x=>Ot.parse(await x.text())));T(r,Pe(h.flat()),!0)}async function N(f,h){try{f.preventDefault(),T(a,!0);const x=f.currentTarget?.files;if(!x)return;await h.call(h,Array.from(x)),T(s,o(r).length>0)}catch(x){k(x.message)}finally{T(a,!1)}}function S(){try{T(l,!0),console.debug({save:{entries:o(r),path:o(d)}}),Mn(o(r),o(d))}finally{T(l,!1)}}E.register(S);async function _(){try{T(l,!0),T(r,await Cn(o(d)),!0)}finally{T(l,!1)}}E.register(_);function j(){if(o(u).length===0)return;const f=async()=>{const h=o(u).pop();T(r,h,!0),T(s,o(u).length>0),await _e()};"startViewTransition"in document?document.startViewTransition(f):f()}E.register(j);function L(){o(p)?.showModal()}E.register(L);async function z(){E.single=!1;const f=E.retrieveAll("toggleOpen");for(const h of f)h({open:!0})}E.register(z);async function R(){const f=E.retrieveAll("toggleOpen");for(const h of f)h({open:!1})}E.register(R);function H(){o(g)?.click()}E.register(H);function Z(){const f=o(r).map(({id:W,...$})=>$),h=Ot.stringify(f,null,2),x=document.createElement("a");x.href=URL.createObjectURL(new Blob([h],{type:"application/json"})),x.download=`m√Ømis config.${new Date().toISOString()}.json5`,t&&console.debug({Downloading:o(r),href:x.href,name:x.download}),x.style.display="none",document.body.appendChild(x),x.click(),setTimeout(()=>{document.body.removeChild(x),URL.revokeObjectURL(x.href)},100)}E.register(Z);function oe(f,h){const x=f.closest("li"),W=h==="up"?x?.previousElementSibling:x?.nextElementSibling;if(!W)return;W.querySelector("summary")?.focus(),E.retrieve("toggleOpen",{useActive:!0})({open:!0})}var le=wi();bn(f=>{var h=pi();qe.title="M√Ømis: Merge List";var x=fe(h),W=M(x,2);F(W,"content","Ordered list of files to be combined with others in the same namespace."),B(()=>F(x,"href",`${On}/merge%20left.svg`)),U(f,h)}),pe("datum-delete",qe,f=>{const{id:h}=f.detail;o(u).push([...o(r)]),T(r,o(r).filter(x=>x.id!==h),!0)}),pe("keydown",qe,f=>{if(!(E.any("isEditing")||document.activeElement instanceof HTMLInputElement))if(t&&console.debug({"document:onkeypress":{"üóùÔ∏è":f.key,isOpen:E.retrieve("isOpen",{useActive:!0})?.()}}),f.key==="a")o(g)?.click();else if(f.key==="?")L();else if(f.key==="s")S();else if(f.key==="u")j();else if(f.key==="v")z();else if(f.key==="h")R();else if(f.key==="d")Z();else if(f.key==="l")o(w)?.click();else if(f.key==="e")f.stopPropagation(),E.retrieve("setEditing",{useActive:!0})(!0);else if(f.key==="z")E.retrieve("zoom",{useActive:!0})();else if(f.key==="Delete")E.retrieve("remove",{useActive:!0})();else if(f.key==="Escape")E.retrieve("toggleOpen",{useActive:!0})({open:!1});else if(f.key==="Enter")E.retrieve("toggleOpen",{useActive:!0})();else if(f.key===" ")if(f.preventDefault(),E.retrieve("isOpen",{useActive:!0})())try{E.retrieve("togglePlay",{useActive:!0})()}catch{E.retrieve("toggleOpen",{useActive:!0})()}else E.retrieve("toggleOpen",{useActive:!0})();else/^Arrow(Up|Down)$/.test(f.key)&&oe(f.target,f.key.replace(/^Arrow/,"").toLowerCase())});var q=fe(le),Q=M(A(q),2),Se=A(Q),P=A(Se),Y=A(P);Y.__click=S;let ee;X(2),D(P);var ne=M(P,2),ut=A(ne);ut.__click=_,X(2),D(ne);var Re=M(ne,2),ct=A(Re),dt=A(ct),Ne=A(dt);Ne.__click=[vi,w];var ft=M(Ne,2);ft.__change=[gi,N,I],G(ft,f=>T(w,f),()=>o(w)),D(dt),D(ct),X(2),D(Re);var Le=M(Re,2),rn=A(Le);rn.__click=Z,X(2),D(Le);var He=M(Le,2),pt=A(He);pt.__click=j,X(2),D(He);var Fe=M(He,2),an=A(Fe);an.__click=L,X(2),D(Fe);var Ue=M(Fe,2),vt=A(Ue);vt.__click=z,X(2),D(Ue);var We=M(Ue,2),gt=A(We);gt.__click=R,X(2),D(We);var mt=M(We,2),bt=A(mt),ze=A(bt);Kt(ze),at(ze,"",{},{display:"none"}),X(2),D(bt),X(2),D(mt),D(Se),D(Q),D(q);var yt=M(q,2),ht=A(yt);Pn(ht,{get elements(){return o(d)},set elements(f){T(d,f,!0)}});var Ke=M(ht,2),kt=A(Ke),me=A(kt);me.__click=[mi,g];var on=A(me);{var ln=f=>{var h=bi(),x=A(h),W=M(A(x),2);F(W,"max",m);var $=A(W);D(W),D(x),D(h),B(()=>{yn(W,o(c)),ge($,`${o(c)/m*100}%`)}),U(f,h)},sn=f=>{var h=yi();U(f,h)};ue(on,f=>{o(a)?f(ln):f(sn,!1)})}D(me);var wt=M(me,2);wt.__change=[hi,N,O],G(wt,f=>T(g,f),()=>o(g)),D(kt),D(Ke);var Et=M(Ke,2);{var un=f=>{var h=ki();U(f,h)},cn=f=>{ci(f,{get data(){return o(r)},set data(h){T(r,h,!0)},get history(){return o(u)},set history(h){T(u,h,!0)}})};ue(Et,f=>{o(r).length===0?f(un):f(cn,!1)})}var dn=M(Et,2);fi(dn,{get handle(){return o(p)},set handle(f){T(p,f,!0)}}),D(yt),B((f,h,x)=>{Y.disabled=!o(v)||!o(s)||o(l),ee=Me(Y,1,"svelte-k3n1lf",null,ee,f),ut.disabled=!o(v)||o(l),Ne.disabled=o(a),pt.disabled=o(u).length===0||o(l),vt.disabled=h,gt.disabled=x,me.disabled=o(a)},[()=>({saving:o(l)}),()=>o(r).length===0||E.any("isOpen"),()=>o(r).length===0||!E.any("isOpen")]),kn(ze,()=>E.single,f=>E.single=f),U(e,le),ie()}Ee(["click","change"]);export{qi as component};
