var ld=Object.defineProperty;var Ro=t=>{throw TypeError(t)};var fd=(t,e,r)=>e in t?ld(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var m=(t,e,r)=>fd(t,typeof e!="symbol"?e+"":e,r),Fo=(t,e,r)=>e.has(t)||Ro("Cannot "+r);var yt=(t,e,r)=>(Fo(t,e,"read from private field"),r?r.call(t):e.get(t)),Hr=(t,e,r)=>e.has(t)?Ro("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Mr=(t,e,r,n)=>(Fo(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r);import{a as ve,t as Xe,e as dd,c as Ts,d as hd}from"../chunks/CBNtQ0WH.js";import{t as st,p as rr,ag as nt,b as mc,g as W,a7 as ce,c as fe,s as _e,r as ue,a as nr,aH as bc,f as Jr,k as pd,aA as Vo,ae as Zs,aJ as gd}from"../chunks/CmuRJ650.js";import{m as yd,s as Dn}from"../chunks/Psu_3c_t.js";import{i as Zr}from"../chunks/CDlVdVmF.js";import{h as wd}from"../chunks/JTFWKIjv.js";import{s as Ie,a as md}from"../chunks/BHyWXpT-.js";import{d as Ni,e as Xr}from"../chunks/BofLj2om.js";import{p as he}from"../chunks/DIfw8a-t.js";import{T as bd}from"../chunks/COzGs9ai.js";import{g as Ui,c as Xs}from"../chunks/Cpj98o6Y.js";import{e as vd}from"../chunks/BlWq4oID.js";import{s as $i}from"../chunks/G2DR9W9F.js";import{p as Vt}from"../chunks/DW6GwWzK.js";import{c as xd}from"../chunks/BYp38SkC.js";import{b as dr}from"../chunks/CxBqkM6E.js";import{s as Ed}from"../chunks/CIgYLCqT.js";import{p as vc}from"../chunks/Bc6Cz818.js";import{t as En}from"../chunks/9VBTw-GS.js";function xc(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=xc(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Bd(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=xc(t))&&(n&&(n+=" "),n+=e);return n}function _i(t){return typeof t=="object"?Bd(t):t??""}function bt(t,e,r,n){var s=t.__styles??(t.__styles={});s[e]!==r&&(s[e]=r,r==null?t.style.removeProperty(e):t.style.setProperty(e,r,""))}function Sd(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function Ur(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function Ad(t){return new TextEncoder().encode(t)}function kd(t){return new TextDecoder().decode(t)}function Id(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var v=0,p=0,y=0,E=g.length;y!==E&&g[y]===0;)y++,v++;for(var b=(E-y)*u+1>>>0,B=new Uint8Array(b);y!==E;){for(var N=g[y],A=0,k=b-1;(N!==0||A<p)&&k!==-1;k--,A++)N+=256*B[k]>>>0,B[k]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");p=A,y++}for(var I=b-p;I!==b&&B[I]===0;)I++;for(var C=c.repeat(v);I<b;++I)C+=t.charAt(B[I]);return C}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var v=0;if(g[v]!==" "){for(var p=0,y=0;g[v]===c;)p++,v++;for(var E=(g.length-v)*f+1>>>0,b=new Uint8Array(E);g[v];){var B=r[g.charCodeAt(v)];if(B===255)return;for(var N=0,A=E-1;(B!==0||N<y)&&A!==-1;A--,N++)B+=a*b[A]>>>0,b[A]=B%256>>>0,B=B/256>>>0;if(B!==0)throw new Error("Non-zero carry");y=N,v++}if(g[v]!==" "){for(var k=E-y;k!==E&&b[k]===0;)k++;for(var I=new Uint8Array(p+(E-k)),C=p;k!==E;)I[C++]=b[k++];return I}}}function h(g){var v=d(g);if(v)return v;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:d,decode:h}}var Cd=Id,Td=Cd;let Nd=class{constructor(e,r,n){m(this,"name");m(this,"prefix");m(this,"baseEncode");this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Ud=class{constructor(e,r,n){m(this,"name");m(this,"prefix");m(this,"baseDecode");m(this,"prefixCodePoint");this.name=e,this.prefix=r;const s=r.codePointAt(0);if(s===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=s,this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Ec(this,e)}},$d=class{constructor(e){m(this,"decoders");this.decoders=e}or(e){return Ec(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Ec(t,e){return new $d({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}let _d=class{constructor(e,r,n,s){m(this,"name");m(this,"prefix");m(this,"baseEncode");m(this,"baseDecode");m(this,"encoder");m(this,"decoder");this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new Nd(e,r,n),this.decoder=new Ud(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function ss({name:t,prefix:e,encode:r,decode:n}){return new _d(t,e,r,n)}function gn({name:t,prefix:e,alphabet:r}){const{encode:n,decode:s}=Td(r,t);return ss({prefix:e,name:t,encode:n,decode:i=>Ur(s(i))})}function Od(t,e,r,n){const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,f=0;for(let u=0;u<i;++u){const l=s[t[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o}function Pd(t,e,r){const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o!==0&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i}function Be({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return ss({prefix:e,name:t,encode(s){return Pd(s,n,r)},decode(s){return Od(s,n,r,t)}})}const xe=gn({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Dd=gn({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Ld=Object.freeze(Object.defineProperty({__proto__:null,base58btc:xe,base58flickr:Dd},Symbol.toStringTag,{value:"Module"})),Rt=Be({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rd=Be({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Fd=Be({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Vd=Be({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Hd=Be({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Md=Be({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jd=Be({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zd=Be({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Gd=Be({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),qd=Object.freeze(Object.defineProperty({__proto__:null,base32:Rt,base32hex:Hd,base32hexpad:jd,base32hexpadupper:zd,base32hexupper:Md,base32pad:Fd,base32padupper:Vd,base32upper:Rd,base32z:Gd},Symbol.toStringTag,{value:"Module"})),_n=gn({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Wd=gn({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Kd=Object.freeze(Object.defineProperty({__proto__:null,base36:_n,base36upper:Wd},Symbol.toStringTag,{value:"Module"}));var Jd=Bc,Ho=128,Zd=127,Xd=~Zd,Yd=Math.pow(2,31);function Bc(t,e,r){e=e||[],r=r||0;for(var n=r;t>=Yd;)e[r++]=t&255|Ho,t/=128;for(;t&Xd;)e[r++]=t&255|Ho,t>>>=7;return e[r]=t|0,Bc.bytes=r-n+1,e}var Qd=Ys,eh=128,Mo=127;function Ys(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw Ys.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&Mo)<<s:(o&Mo)*Math.pow(2,s),s+=7}while(o>=eh);return Ys.bytes=i-n,r}var th=Math.pow(2,7),rh=Math.pow(2,14),nh=Math.pow(2,21),sh=Math.pow(2,28),ih=Math.pow(2,35),oh=Math.pow(2,42),ah=Math.pow(2,49),ch=Math.pow(2,56),uh=Math.pow(2,63),lh=function(t){return t<th?1:t<rh?2:t<nh?3:t<sh?4:t<ih?5:t<oh?6:t<ah?7:t<ch?8:t<uh?9:10},fh={encode:Jd,decode:Qd,encodingLength:lh},Ln=fh;function Qs(t,e=0){return[Ln.decode(t,e),Ln.decode.bytes]}function Rn(t,e,r=0){return Ln.encode(t,e,r),e}function Fn(t){return Ln.encodingLength(t)}function rn(t,e){const r=e.byteLength,n=Fn(t),s=n+Fn(r),i=new Uint8Array(s+r);return Rn(t,i,0),Rn(r,i,n),i.set(e,s),new Pi(t,r,e,i)}function Oi(t){const e=Ur(t),[r,n]=Qs(e),[s,i]=Qs(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new Pi(r,s,o,e)}function dh(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Sd(t.bytes,r.bytes)}}let Pi=class{constructor(e,r,n,s){m(this,"code");m(this,"size");m(this,"digest");m(this,"bytes");this.code=e,this.size=r,this.digest=n,this.bytes=s}};function jo(t,e){const{bytes:r,version:n}=t;switch(n){case 0:return ph(r,ei(t),e??xe.encoder);default:return gh(r,ei(t),e??Rt.encoder)}}const zo=new WeakMap;function ei(t){const e=zo.get(t);if(e==null){const r=new Map;return zo.set(t,r),r}return e}var dc;let M=class ke{constructor(e,r,n,s){m(this,"code");m(this,"version");m(this,"multihash");m(this,"bytes");m(this,"/");m(this,dc,"CID");this.code=r,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:r}=this;if(e!==jr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==yh)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return ke.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:r}=this.multihash,n=rn(e,r);return ke.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return ke.equals(this,e)}static equals(e,r){const n=r;return n!=null&&e.code===n.code&&e.version===n.version&&dh(e.multihash,n.multihash)}toString(e){return jo(this,e)}toJSON(){return{"/":jo(this)}}link(){return this}[(dc=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const r=e;if(r instanceof ke)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:s,multihash:i,bytes:o}=r;return new ke(n,s,i,o??Go(n,s,i.bytes))}else if(r[wh]===!0){const{version:n,multihash:s,code:i}=r,o=Oi(s);return ke.create(n,i,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==jr)throw new Error(`Version 0 CID must use dag-pb (code: ${jr}) block encoding`);return new ke(e,r,n,n.bytes)}case 1:{const s=Go(e,r,n.bytes);return new ke(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return ke.create(0,jr,e)}static createV1(e,r){return ke.create(1,e,r)}static decode(e){const[r,n]=ke.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(e){const r=ke.inspectBytes(e),n=r.size-r.multihashSize,s=Ur(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");const i=s.subarray(r.multihashSize-r.digestSize),o=new Pi(r.multihashCode,r.digestSize,i,s);return[r.version===0?ke.createV0(o):ke.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0;const n=()=>{const[l,d]=Qs(e.subarray(r));return r+=d,l};let s=n(),i=jr;if(s===18?(s=0,r=0):i=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);const o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){const[n,s]=hh(e,r),i=ke.decode(s);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ei(i).set(n,e),i}};function hh(t,e){switch(t[0]){case"Q":{const r=e??xe;return[xe.prefix,r.decode(`${xe.prefix}${t}`)]}case xe.prefix:{const r=e??xe;return[xe.prefix,r.decode(t)]}case Rt.prefix:{const r=e??Rt;return[Rt.prefix,r.decode(t)]}case _n.prefix:{const r=e??_n;return[_n.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}}function ph(t,e,r){const{prefix:n}=r;if(n!==xe.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=e.get(n);if(s==null){const i=r.encode(t).slice(1);return e.set(n,i),i}else return s}function gh(t,e,r){const{prefix:n}=r,s=e.get(n);if(s==null){const i=r.encode(t);return e.set(n,i),i}else return s}const jr=112,yh=18;function Go(t,e,r){const n=Fn(t),s=n+Fn(e),i=new Uint8Array(s+r.byteLength);return Rn(t,i,0),Rn(e,i,n),i.set(r,s),i}const wh=Symbol.for("@ipld/js-cid/CID");function br(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}const mh=gn({prefix:"9",name:"base10",alphabet:"0123456789"}),bh=Object.freeze(Object.defineProperty({__proto__:null,base10:mh},Symbol.toStringTag,{value:"Module"})),vh=Be({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xh=Be({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Eh=Object.freeze(Object.defineProperty({__proto__:null,base16:vh,base16upper:xh},Symbol.toStringTag,{value:"Module"})),Bh=Be({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Sh=Object.freeze(Object.defineProperty({__proto__:null,base2:Bh},Symbol.toStringTag,{value:"Module"})),Sc=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Ah=Sc.reduce((t,e,r)=>(t[r]=e,t),[]),kh=Sc.reduce((t,e,r)=>{const n=e.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${e}`);return t[n]=r,t},[]);function Ih(t){return t.reduce((e,r)=>(e+=Ah[r],e),"")}function Ch(t){const e=[];for(const r of t){const n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);const s=kh[n];if(s==null)throw new Error(`Non-base256emoji character: ${r}`);e.push(s)}return new Uint8Array(e)}const Th=ss({prefix:"🚀",name:"base256emoji",encode:Ih,decode:Ch}),Nh=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:Th},Symbol.toStringTag,{value:"Module"})),is=Be({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Uh=Be({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),os=Be({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),$h=Be({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),_h=Object.freeze(Object.defineProperty({__proto__:null,base64:is,base64pad:Uh,base64url:os,base64urlpad:$h},Symbol.toStringTag,{value:"Module"})),Oh=Be({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Ph=Object.freeze(Object.defineProperty({__proto__:null,base8:Oh},Symbol.toStringTag,{value:"Module"})),Dh=ss({prefix:"\0",name:"identity",encode:t=>kd(t),decode:t=>Ad(t)}),Lh=Object.freeze(Object.defineProperty({__proto__:null,identity:Dh},Symbol.toStringTag,{value:"Module"})),Rh=new TextEncoder,Fh=new TextDecoder,Vh="json",Hh=512;function Mh(t){return Rh.encode(JSON.stringify(t))}function jh(t){return JSON.parse(Fh.decode(t))}const zh=Object.freeze(Object.defineProperty({__proto__:null,code:Hh,decode:jh,encode:Mh,name:Vh},Symbol.toStringTag,{value:"Module"})),Gh="raw",qh=85;function Wh(t){return Ur(t)}function Kh(t){return Ur(t)}const Jh=Object.freeze(Object.defineProperty({__proto__:null,code:qh,decode:Kh,encode:Wh,name:Gh},Symbol.toStringTag,{value:"Module"})),Ac=0,Zh="identity",kc=Ur;function Xh(t){return rn(Ac,kc(t))}const Kt={code:Ac,name:Zh,encode:kc,digest:Xh},Yh=Object.freeze(Object.defineProperty({__proto__:null,identity:Kt},Symbol.toStringTag,{value:"Module"}));function Ic({name:t,code:e,encode:r}){return new Qh(t,e,r)}class Qh{constructor(e,r,n){m(this,"name");m(this,"code");m(this,"encode");this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?rn(this.code,r):r.then(n=>rn(this.code,n))}else throw Error("Unknown type, must be binary type")}}function Cc(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}const Di=Ic({name:"sha2-256",code:18,encode:Cc("SHA-256")}),ep=Ic({name:"sha2-512",code:19,encode:Cc("SHA-512")}),tp=Object.freeze(Object.defineProperty({__proto__:null,sha256:Di,sha512:ep},Symbol.toStringTag,{value:"Module"})),Vn={...Lh,...Sh,...Ph,...bh,...Eh,...qd,...Kd,...Ld,..._h,...Nh},rp={...tp,...Yh},np={raw:Jh,json:zh};function vr(t=0){return new Uint8Array(t)}function Tc(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}const qo=Tc("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Ns=Tc("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=vr(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Nc={utf8:qo,"utf-8":qo,hex:Vn.base16,latin1:Ns,ascii:Ns,binary:Ns,...Vn};function me(t,e="utf8"){const r=Nc[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}const sp=Math.pow(2,7),ip=Math.pow(2,14),op=Math.pow(2,21),Li=Math.pow(2,28),Ri=Math.pow(2,35),Fi=Math.pow(2,42),Vi=Math.pow(2,49),ee=128,Ce=127;function ht(t){if(t<sp)return 1;if(t<ip)return 2;if(t<op)return 3;if(t<Li)return 4;if(t<Ri)return 5;if(t<Fi)return 6;if(t<Vi)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function Uc(t,e,r=0){switch(ht(t)){case 8:e[r++]=t&255|ee,t/=128;case 7:e[r++]=t&255|ee,t/=128;case 6:e[r++]=t&255|ee,t/=128;case 5:e[r++]=t&255|ee,t/=128;case 4:e[r++]=t&255|ee,t>>>=7;case 3:e[r++]=t&255|ee,t>>>=7;case 2:e[r++]=t&255|ee,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function ap(t,e,r=0){switch(ht(t)){case 8:e.set(r++,t&255|ee),t/=128;case 7:e.set(r++,t&255|ee),t/=128;case 6:e.set(r++,t&255|ee),t/=128;case 5:e.set(r++,t&255|ee),t/=128;case 4:e.set(r++,t&255|ee),t>>>=7;case 3:e.set(r++,t&255|ee),t>>>=7;case 2:e.set(r++,t&255|ee),t>>>=7;case 1:{e.set(r++,t&255),t>>>=7;break}default:throw new Error("unreachable")}return e}function $c(t,e){let r=t[e],n=0;if(n+=r&Ce,r<ee||(r=t[e+1],n+=(r&Ce)<<7,r<ee)||(r=t[e+2],n+=(r&Ce)<<14,r<ee)||(r=t[e+3],n+=(r&Ce)<<21,r<ee)||(r=t[e+4],n+=(r&Ce)*Li,r<ee)||(r=t[e+5],n+=(r&Ce)*Ri,r<ee)||(r=t[e+6],n+=(r&Ce)*Fi,r<ee)||(r=t[e+7],n+=(r&Ce)*Vi,r<ee))return n;throw new RangeError("Could not decode varint")}function cp(t,e){let r=t.get(e),n=0;if(n+=r&Ce,r<ee||(r=t.get(e+1),n+=(r&Ce)<<7,r<ee)||(r=t.get(e+2),n+=(r&Ce)<<14,r<ee)||(r=t.get(e+3),n+=(r&Ce)<<21,r<ee)||(r=t.get(e+4),n+=(r&Ce)*Li,r<ee)||(r=t.get(e+5),n+=(r&Ce)*Ri,r<ee)||(r=t.get(e+6),n+=(r&Ce)*Fi,r<ee)||(r=t.get(e+7),n+=(r&Ce)*Vi,r<ee))return n;throw new RangeError("Could not decode varint")}function as(t,e,r=0){return e==null&&(e=vr(ht(t))),e instanceof Uint8Array?Uc(t,e,r):ap(t,e,r)}function yn(t,e=0){return t instanceof Uint8Array?$c(t,e):cp(t,e)}function Jt(t,e){e==null&&(e=t.reduce((s,i)=>s+i.length,0));const r=vr(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return r}class up{constructor(){m(this,"index",0);m(this,"input","")}new(e){return this.index=0,this.input=e,this}readAtomically(e){const r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){const r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{const r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,s){return this.readAtomically(()=>{let i=0,o=0;const a=this.peekChar();if(a===void 0)return;const c=a==="0",f=2**(8*s)-1;for(;;){const u=this.readAtomically(()=>{const l=this.readChar();if(l===void 0)return;const d=Number.parseInt(l,e);if(!Number.isNaN(d))return d});if(u===void 0)break;if(i*=e,i+=u,i>f||(o+=1,r!==void 0&&o>r))return}if(o!==0)return!n&&c&&o>1?void 0:i})}readIPv4Addr(){return this.readAtomically(()=>{const e=new Uint8Array(4);for(let r=0;r<e.length;r++){const n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){const e=r=>{for(let n=0;n<r.length/2;n++){const s=n*2;if(n<r.length-3){const o=this.readSeparator(":",n,()=>this.readIPv4Addr());if(o!==void 0)return r[s]=o[0],r[s+1]=o[1],r[s+2]=o[2],r[s+3]=o[3],[s+4,!0]}const i=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(i===void 0)return[s,!1];r[s]=i>>8,r[s+1]=i&255}return[r.length,!1]};return this.readAtomically(()=>{const r=new Uint8Array(16),[n,s]=e(r);if(n===16)return r;if(s||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const i=new Uint8Array(14),o=16-(n+2),[a]=e(i.subarray(0,o));return r.set(i.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const _c=45,lp=15,xr=new up;function fp(t){if(!(t.length>lp))return xr.new(t).parseWith(()=>xr.readIPv4Addr())}function dp(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>_c))return xr.new(t).parseWith(()=>xr.readIPv6Addr())}function hp(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>_c))return xr.new(t).parseWith(()=>xr.readIPAddr())}function it(t,e="utf8"){const r=Nc[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}function pp(t){return!!fp(t)}function gp(t){return!!dp(t)}function Oc(t){return!!hp(t)}const Wo=pp,yp=gp,Pc=function(t){let e=0;if(t=t.toString().trim(),Wo(t)){const r=new Uint8Array(e+4);return t.split(/\./g).forEach(n=>{r[e++]=parseInt(n,10)&255}),r}if(yp(t)){const r=t.split(":",8);let n;for(n=0;n<r.length;n++){const i=Wo(r[n]);let o;i&&(o=Pc(r[n]),r[n]=me(o.slice(0,2),"base16")),o!=null&&++n<8&&r.splice(n,0,me(o.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);const i=[n,1];for(n=9-r.length;n>0;n--)i.push("0");r.splice.apply(r,i)}const s=new Uint8Array(e+16);for(n=0;n<r.length;n++){const i=parseInt(r[n],16);s[e++]=i>>8&255,s[e++]=i&255}return s}throw new Error("invalid ip address")},wp=function(t,e=0,r){e=~~e,r=r??t.length-e;const n=new DataView(t.buffer);if(r===4){const s=[];for(let i=0;i<r;i++)s.push(t[e+i]);return s.join(".")}if(r===16){const s=[];for(let i=0;i<r;i+=2)s.push(n.getUint16(e+i).toString(16));return s.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},Me=-1,nn={},ti={},mp=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,Me,"ip6zone"],[43,8,"ipcidr"],[53,Me,"dns",!0],[54,Me,"dns4",!0],[55,Me,"dns6",!0],[56,Me,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc-direct"],[281,0,"webrtc"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,Me,"unix",!1,!0],[421,Me,"ipfs"],[421,Me,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,Me,"garlic64"],[448,0,"tls"],[449,Me,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,Me,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[481,Me,"http-path"],[777,Me,"memory"]];mp.forEach(t=>{const e=bp(...t);ti[e.code]=e,nn[e.name]=e});function bp(t,e,r,n,s){return{code:t,size:e,name:r,resolvable:!!n,path:!!s}}function X(t){if(typeof t=="number"){if(ti[t]!=null)return ti[t];throw new Error(`no protocol with code: ${t}`)}else if(typeof t=="string"){if(nn[t]!=null)return nn[t];throw new Error(`no protocol with name: ${t}`)}throw new Error(`invalid protocol id type: ${typeof t}`)}X("ip4");X("ip6");X("ipcidr");function Dc(t,e){switch(X(t).code){case 4:case 41:return xp(e);case 42:return _s(e);case 43:return me(e,"base10");case 6:case 273:case 33:case 132:return Lc(e).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return _s(e);case 421:return Ap(e);case 444:return Zo(e);case 445:return Zo(e);case 466:return Sp(e);case 481:return globalThis.encodeURIComponent(_s(e));default:return me(e,"base16")}}function Ko(t,e){switch(X(t).code){case 4:return Jo(e);case 41:return Jo(e);case 42:return $s(e);case 43:return it(e,"base10");case 6:case 273:case 33:case 132:return Hi(parseInt(e,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return $s(e);case 421:return Ep(e);case 444:return kp(e);case 445:return Ip(e);case 466:return Bp(e);case 481:return $s(globalThis.decodeURIComponent(e));default:return it(e,"base16")}}const Us=Object.values(Vn).map(t=>t.decoder),vp=function(){let t=Us[0].or(Us[1]);return Us.slice(2).forEach(e=>t=t.or(e)),t}();function Jo(t){if(!Oc(t))throw new Error("invalid ip address");return Pc(t)}function xp(t){const e=wp(t,0,t.length);if(e==null)throw new Error("ipBuff is required");if(!Oc(e))throw new Error("invalid ip address");return e}function Hi(t){const e=new ArrayBuffer(2);return new DataView(e).setUint16(0,t),new Uint8Array(e)}function Lc(t){return new DataView(t.buffer).getUint16(t.byteOffset)}function $s(t){const e=it(t),r=Uint8Array.from(as(e.length));return Jt([r,e],r.length+e.length)}function _s(t){const e=yn(t);if(t=t.slice(ht(e)),t.length!==e)throw new Error("inconsistent lengths");return me(t)}function Ep(t){let e;t[0]==="Q"||t[0]==="1"?e=Oi(xe.decode(`z${t}`)).bytes:e=M.parse(t).multihash.bytes;const r=Uint8Array.from(as(e.length));return Jt([r,e],r.length+e.length)}function Bp(t){const e=vp.decode(t),r=Uint8Array.from(as(e.length));return Jt([r,e],r.length+e.length)}function Sp(t){const e=yn(t),r=t.slice(ht(e));if(r.length!==e)throw new Error("inconsistent lengths");return"u"+me(r,"base64url")}function Ap(t){const e=yn(t),r=t.slice(ht(e));if(r.length!==e)throw new Error("inconsistent lengths");return me(r,"base58btc")}function kp(t){const e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==16)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion address.`);const r=Rt.decode("b"+e[0]),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Hi(n);return Jt([r,s],r.length+s.length)}function Ip(t){const e=t.split(":");if(e.length!==2)throw new Error(`failed to parse onion addr: ["'${e.join('", "')}'"]' does not contain a port number`);if(e[0].length!==56)throw new Error(`failed to parse onion addr: ${e[0]} not a Tor onion3 address.`);const r=Rt.decode(`b${e[0]}`),n=parseInt(e[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const s=Hi(n);return Jt([r,s],r.length+s.length)}function Zo(t){const e=t.slice(0,t.length-2),r=t.slice(t.length-2),n=me(e,"base32"),s=Lc(r);return`${n}:${s}`}function Cp(t){t=ri(t);const e=[],r=[];let n=null;const s=t.split("/").slice(1);if(s.length===1&&s[0]==="")return{bytes:new Uint8Array,string:"/",tuples:[],stringTuples:[],path:null};for(let i=0;i<s.length;i++){const o=s[i],a=X(o);if(a.size===0){e.push([a.code]),r.push([a.code]);continue}if(i++,i>=s.length)throw Vc("invalid address: "+t);if(a.path===!0){n=ri(s.slice(i).join("/")),e.push([a.code,Ko(a.code,n)]),r.push([a.code,n]);break}const c=Ko(a.code,s[i]);e.push([a.code,c]),r.push([a.code,Dc(a.code,c)])}return{string:Rc(r),bytes:Fc(e),tuples:e,stringTuples:r,path:n}}function Xo(t){const e=[],r=[];let n=null,s=0;for(;s<t.length;){const i=yn(t,s),o=ht(i),a=X(i),c=Tp(a,t.slice(s+o));if(c===0){e.push([i]),r.push([i]),s+=o;continue}const f=t.slice(s+o,s+o+c);if(s+=c+o,s>t.length)throw Vc("Invalid address Uint8Array: "+me(t,"base16"));e.push([i,f]);const u=Dc(i,f);if(r.push([i,u]),a.path===!0){n=u;break}}return{bytes:Uint8Array.from(t),string:Rc(r),tuples:e,stringTuples:r,path:n}}function Rc(t){const e=[];return t.map(r=>{const n=X(r[0]);return e.push(n.name),r.length>1&&r[1]!=null&&e.push(r[1]),null}),ri(e.join("/"))}function Fc(t){return Jt(t.map(e=>{const r=X(e[0]);let n=Uint8Array.from(as(r.code));return e.length>1&&e[1]!=null&&(n=Jt([n,e[1]])),n}))}function Tp(t,e){if(t.size>0)return t.size/8;if(t.size===0)return 0;{const r=yn(e instanceof Uint8Array?e:Uint8Array.from(e));return r+ht(r)}}function ri(t){return"/"+t.trim().split("/").filter(e=>e).join("/")}function Vc(t){return new Error("Error parsing address: "+t)}const Np=Symbol.for("nodejs.util.inspect.custom"),Hc=Symbol.for("@multiformats/js-multiaddr/multiaddr"),Up=[X("dns").code,X("dns4").code,X("dns6").code,X("dnsaddr").code];class $p extends Error{constructor(e="No available resolver"){super(e),this.name="NoAvailableResolverError"}}var hc,mr,Dt,hn,pn;const gr=class gr{constructor(e){m(this,"bytes");Hr(this,mr);Hr(this,Dt);Hr(this,hn);Hr(this,pn);m(this,hc,!0);e==null&&(e="");let r;if(e instanceof Uint8Array)r=Xo(e);else if(typeof e=="string"){if(e.length>0&&e.charAt(0)!=="/")throw new Error(`multiaddr "${e}" must start with a "/"`);r=Cp(e)}else if(Hn(e))r=Xo(e.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr");this.bytes=r.bytes,Mr(this,mr,r.string),Mr(this,Dt,r.tuples),Mr(this,hn,r.stringTuples),Mr(this,pn,r.path)}toString(){return yt(this,mr)}toJSON(){return this.toString()}toOptions(){let e,r,n,s,i="";const o=X("tcp"),a=X("udp"),c=X("ip4"),f=X("ip6"),u=X("dns6"),l=X("ip6zone");for(const[h,g]of this.stringTuples())h===l.code&&(i=`%${g??""}`),Up.includes(h)&&(r=o.name,s=443,n=`${g??""}${i}`,e=h===u.code?6:4),(h===o.code||h===a.code)&&(r=X(h).name,s=parseInt(g??"")),(h===c.code||h===f.code)&&(r=X(h).name,n=`${g??""}${i}`,e=h===f.code?6:4);if(e==null||r==null||n==null||s==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:e,host:n,transport:r,port:s}}protos(){return yt(this,Dt).map(([e])=>Object.assign({},X(e)))}protoCodes(){return yt(this,Dt).map(([e])=>e)}protoNames(){return yt(this,Dt).map(([e])=>X(e).name)}tuples(){return yt(this,Dt).map(([e,r])=>r==null?[e]:[e,r])}stringTuples(){return yt(this,hn).map(([e,r])=>r==null?[e]:[e,r])}encapsulate(e){return e=new gr(e),new gr(this.toString()+e.toString())}decapsulate(e){const r=e.toString(),n=this.toString(),s=n.lastIndexOf(r);if(s<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${e.toString()}`);return new gr(n.slice(0,s))}decapsulateCode(e){const r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===e)return new gr(Fc(r.slice(0,n)));return this}getPeerId(){try{let e=[];this.stringTuples().forEach(([n,s])=>{n===nn.p2p.code&&e.push([n,s]),n===nn["p2p-circuit"].code&&(e=[])});const r=e.pop();if((r==null?void 0:r[1])!=null){const n=r[1];return n[0]==="Q"||n[0]==="1"?me(xe.decode(`z${n}`),"base58btc"):me(M.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){return yt(this,pn)}equals(e){return br(this.bytes,e.bytes)}async resolve(e){const r=this.protos().find(i=>i.resolvable);if(r==null)return[this];const n=_p.get(r.name);if(n==null)throw new $p(`no available resolver for ${r.name}`);return(await n(this,e)).map(i=>Ve(i))}nodeAddress(){const e=this.toOptions();if(e.transport!=="tcp"&&e.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${e.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:e.family,address:e.host,port:e.port}}isThinWaistAddress(e){const r=(e??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(hc=Hc,Np)](){return`Multiaddr(${yt(this,mr)})`}};mr=new WeakMap,Dt=new WeakMap,hn=new WeakMap,pn=new WeakMap;let ni=gr;const _p=new Map;function Hn(t){return!!(t!=null&&t[Hc])}function Ve(t){return new ni(t)}const Op=["string","number","bigint","symbol"],Pp=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Dp(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";const e=typeof t;if(Op.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(Lp(t))return"Buffer";const r=Rp(t);return r||"Object"}function Lp(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function Rp(t){const e=Object.prototype.toString.call(t).slice(8,-1);if(Pp.includes(e))return e}class w{constructor(e,r,n){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}}w.uint=new w(0,"uint",!0);w.negint=new w(1,"negint",!0);w.bytes=new w(2,"bytes",!0);w.string=new w(3,"string",!0);w.array=new w(4,"array",!1);w.map=new w(5,"map",!1);w.tag=new w(6,"tag",!1);w.float=new w(7,"float",!0);w.false=new w(7,"false",!0);w.true=new w(7,"true",!0);w.null=new w(7,"null",!0);w.undefined=new w(7,"undefined",!0);w.break=new w(7,"break",!0);class ${constructor(e,r,n){this.type=e,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const $r=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Fp=new TextDecoder,Vp=new TextEncoder;function Mn(t){return $r&&globalThis.Buffer.isBuffer(t)}function Mi(t){return t instanceof Uint8Array?Mn(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}const Hp=$r?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):Qo(t,e,r):(t,e,r)=>r-e>64?Fp.decode(t.subarray(e,r)):Qo(t,e,r),Mc=$r?t=>t.length>64?globalThis.Buffer.from(t):Yo(t):t=>t.length>64?Vp.encode(t):Yo(t),wt=t=>Uint8Array.from(t),ji=$r?(t,e,r)=>Mn(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),Mp=$r?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),Mi(globalThis.Buffer.concat(t,e))):(t,e)=>{const r=new Uint8Array(e);let n=0;for(let s of t)n+s.length>r.length&&(s=s.subarray(0,r.length-n)),r.set(s,n),n+=s.length;return r},jp=$r?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function zp(t,e){if(Mn(t)&&Mn(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function Yo(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128)}return e}function Qo(t,e,r){const n=[];for(;e<r;){const s=t[e];let i=null,o=s>239?4:s>223?3:s>191?2:1;if(e+o<=r){let a,c,f,u;switch(o){case 1:s<128&&(i=s);break;case 2:a=t[e+1],(a&192)===128&&(u=(s&31)<<6|a&63,u>127&&(i=u));break;case 3:a=t[e+1],c=t[e+2],(a&192)===128&&(c&192)===128&&(u=(s&15)<<12|(a&63)<<6|c&63,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:a=t[e+1],c=t[e+2],f=t[e+3],(a&192)===128&&(c&192)===128&&(f&192)===128&&(u=(s&15)<<18|(a&63)<<12|(c&63)<<6|f&63,u>65535&&u<1114112&&(i=u))}}i===null?(i=65533,o=1):i>65535&&(i-=65536,n.push(i>>>10&1023|55296),i=56320|i&1023),n.push(i),e+=o}return jc(n)}const ea=4096;function jc(t){const e=t.length;if(e<=ea)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=ea));return r}const Gp=256;class zc{constructor(e=Gp){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){const s=r.length-(this.maxCursor-this.cursor)-1;r.set(e,s)}else{if(r){const s=r.length-(this.maxCursor-this.cursor)-1;s<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,s),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=jp(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){const n=this.chunks[0];e&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=ji(n,0,this.cursor)}else r=Mp(this.chunks,this.cursor);return e&&this.reset(),r}}const H="CBOR decode error:",Gt="CBOR encode error:";function _r(t,e,r){if(t.length-e<r)throw new Error(`${H} not enough data for type`)}const Ee=[24,256,65536,4294967296,BigInt("18446744073709551616")];function sr(t,e,r){_r(t,e,1);const n=t[e];if(r.strict===!0&&n<Ee[0])throw new Error(`${H} integer encoded in more bytes than necessary (strict decode)`);return n}function ir(t,e,r){_r(t,e,2);const n=t[e]<<8|t[e+1];if(r.strict===!0&&n<Ee[1])throw new Error(`${H} integer encoded in more bytes than necessary (strict decode)`);return n}function or(t,e,r){_r(t,e,4);const n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&n<Ee[2])throw new Error(`${H} integer encoded in more bytes than necessary (strict decode)`);return n}function ar(t,e,r){_r(t,e,8);const n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],s=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],i=(BigInt(n)<<BigInt(32))+BigInt(s);if(r.strict===!0&&i<Ee[3])throw new Error(`${H} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(r.allowBigInt===!0)return i;throw new Error(`${H} integers outside of the safe integer range are not supported`)}function qp(t,e,r,n){return new $(w.uint,sr(t,e+1,n),2)}function Wp(t,e,r,n){return new $(w.uint,ir(t,e+1,n),3)}function Kp(t,e,r,n){return new $(w.uint,or(t,e+1,n),5)}function Jp(t,e,r,n){return new $(w.uint,ar(t,e+1,n),9)}function cr(t,e){return Ye(t,0,e.value)}function Ye(t,e,r){if(r<Ee[0]){const n=Number(r);t.push([e|n])}else if(r<Ee[1]){const n=Number(r);t.push([e|24,n])}else if(r<Ee[2]){const n=Number(r);t.push([e|25,n>>>8,n&255])}else if(r<Ee[3]){const n=Number(r);t.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{const n=BigInt(r);if(n<Ee[4]){const s=[e|27,0,0,0,0,0,0,0];let i=Number(n&BigInt(4294967295)),o=Number(n>>BigInt(32)&BigInt(4294967295));s[8]=i&255,i=i>>8,s[7]=i&255,i=i>>8,s[6]=i&255,i=i>>8,s[5]=i&255,s[4]=o&255,o=o>>8,s[3]=o&255,o=o>>8,s[2]=o&255,o=o>>8,s[1]=o&255,t.push(s)}else throw new Error(`${H} encountered BigInt larger than allowable range`)}}cr.encodedSize=function(e){return Ye.encodedSize(e.value)};Ye.encodedSize=function(e){return e<Ee[0]?1:e<Ee[1]?2:e<Ee[2]?3:e<Ee[3]?5:9};cr.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0};function Zp(t,e,r,n){return new $(w.negint,-1-sr(t,e+1,n),2)}function Xp(t,e,r,n){return new $(w.negint,-1-ir(t,e+1,n),3)}function Yp(t,e,r,n){return new $(w.negint,-1-or(t,e+1,n),5)}const zi=BigInt(-1),Gc=BigInt(1);function Qp(t,e,r,n){const s=ar(t,e+1,n);if(typeof s!="bigint"){const i=-1-s;if(i>=Number.MIN_SAFE_INTEGER)return new $(w.negint,i,9)}if(n.allowBigInt!==!0)throw new Error(`${H} integers outside of the safe integer range are not supported`);return new $(w.negint,zi-BigInt(s),9)}function Gi(t,e){const r=e.value,n=typeof r=="bigint"?r*zi-Gc:r*-1-1;Ye(t,e.type.majorEncoded,n)}Gi.encodedSize=function(e){const r=e.value,n=typeof r=="bigint"?r*zi-Gc:r*-1-1;return n<Ee[0]?1:n<Ee[1]?2:n<Ee[2]?3:n<Ee[3]?5:9};Gi.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0};function wn(t,e,r,n){_r(t,e,r+n);const s=ji(t,e+r,e+r+n);return new $(w.bytes,s,r+n)}function eg(t,e,r,n){return wn(t,e,1,r)}function tg(t,e,r,n){return wn(t,e,2,sr(t,e+1,n))}function rg(t,e,r,n){return wn(t,e,3,ir(t,e+1,n))}function ng(t,e,r,n){return wn(t,e,5,or(t,e+1,n))}function sg(t,e,r,n){const s=ar(t,e+1,n);if(typeof s=="bigint")throw new Error(`${H} 64-bit integer bytes lengths not supported`);return wn(t,e,9,s)}function jn(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===w.string?Mc(t.value):t.value),t.encodedBytes}function cs(t,e){const r=jn(e);Ye(t,e.type.majorEncoded,r.length),t.push(r)}cs.encodedSize=function(e){const r=jn(e);return Ye.encodedSize(r.length)+r.length};cs.compareTokens=function(e,r){return ig(jn(e),jn(r))};function ig(t,e){return t.length<e.length?-1:t.length>e.length?1:zp(t,e)}function mn(t,e,r,n,s){const i=r+n;_r(t,e,i);const o=new $(w.string,Hp(t,e+r,e+i),i);return s.retainStringBytes===!0&&(o.byteValue=ji(t,e+r,e+i)),o}function og(t,e,r,n){return mn(t,e,1,r,n)}function ag(t,e,r,n){return mn(t,e,2,sr(t,e+1,n),n)}function cg(t,e,r,n){return mn(t,e,3,ir(t,e+1,n),n)}function ug(t,e,r,n){return mn(t,e,5,or(t,e+1,n),n)}function lg(t,e,r,n){const s=ar(t,e+1,n);if(typeof s=="bigint")throw new Error(`${H} 64-bit integer string lengths not supported`);return mn(t,e,9,s,n)}const fg=cs;function Or(t,e,r,n){return new $(w.array,n,r)}function dg(t,e,r,n){return Or(t,e,1,r)}function hg(t,e,r,n){return Or(t,e,2,sr(t,e+1,n))}function pg(t,e,r,n){return Or(t,e,3,ir(t,e+1,n))}function gg(t,e,r,n){return Or(t,e,5,or(t,e+1,n))}function yg(t,e,r,n){const s=ar(t,e+1,n);if(typeof s=="bigint")throw new Error(`${H} 64-bit integer array lengths not supported`);return Or(t,e,9,s)}function wg(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${H} indefinite length items not allowed`);return Or(t,e,1,1/0)}function qi(t,e){Ye(t,w.array.majorEncoded,e.value)}qi.compareTokens=cr.compareTokens;qi.encodedSize=function(e){return Ye.encodedSize(e.value)};function Pr(t,e,r,n){return new $(w.map,n,r)}function mg(t,e,r,n){return Pr(t,e,1,r)}function bg(t,e,r,n){return Pr(t,e,2,sr(t,e+1,n))}function vg(t,e,r,n){return Pr(t,e,3,ir(t,e+1,n))}function xg(t,e,r,n){return Pr(t,e,5,or(t,e+1,n))}function Eg(t,e,r,n){const s=ar(t,e+1,n);if(typeof s=="bigint")throw new Error(`${H} 64-bit integer map lengths not supported`);return Pr(t,e,9,s)}function Bg(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${H} indefinite length items not allowed`);return Pr(t,e,1,1/0)}function Wi(t,e){Ye(t,w.map.majorEncoded,e.value)}Wi.compareTokens=cr.compareTokens;Wi.encodedSize=function(e){return Ye.encodedSize(e.value)};function Sg(t,e,r,n){return new $(w.tag,r,1)}function Ag(t,e,r,n){return new $(w.tag,sr(t,e+1,n),2)}function kg(t,e,r,n){return new $(w.tag,ir(t,e+1,n),3)}function Ig(t,e,r,n){return new $(w.tag,or(t,e+1,n),5)}function Cg(t,e,r,n){return new $(w.tag,ar(t,e+1,n),9)}function Ki(t,e){Ye(t,w.tag.majorEncoded,e.value)}Ki.compareTokens=cr.compareTokens;Ki.encodedSize=function(e){return Ye.encodedSize(e.value)};const Tg=20,Ng=21,Ug=22,$g=23;function _g(t,e,r,n){if(n.allowUndefined===!1)throw new Error(`${H} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new $(w.null,null,1):new $(w.undefined,void 0,1)}function Og(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${H} indefinite length items not allowed`);return new $(w.break,void 0,1)}function Ji(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${H} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${H} Infinity values are not supported`)}return new $(w.float,t,e)}function Pg(t,e,r,n){return Ji(Xi(t,e+1),3,n)}function Dg(t,e,r,n){return Ji(Yi(t,e+1),5,n)}function Lg(t,e,r,n){return Ji(Jc(t,e+1),9,n)}function Zi(t,e,r){const n=e.value;if(n===!1)t.push([w.float.majorEncoded|Tg]);else if(n===!0)t.push([w.float.majorEncoded|Ng]);else if(n===null)t.push([w.float.majorEncoded|Ug]);else if(n===void 0)t.push([w.float.majorEncoded|$g]);else{let s,i=!1;(!r||r.float64!==!0)&&(Wc(n),s=Xi(rt,1),n===s||Number.isNaN(n)?(rt[0]=249,t.push(rt.slice(0,3)),i=!0):(Kc(n),s=Yi(rt,1),n===s&&(rt[0]=250,t.push(rt.slice(0,5)),i=!0))),i||(Rg(n),s=Jc(rt,1),rt[0]=251,t.push(rt.slice(0,9)))}}Zi.encodedSize=function(e,r){const n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){Wc(n);let s=Xi(rt,1);if(n===s||Number.isNaN(n))return 3;if(Kc(n),s=Yi(rt,1),n===s)return 5}return 9};const qc=new ArrayBuffer(9),Ke=new DataView(qc,1),rt=new Uint8Array(qc,0);function Wc(t){if(t===1/0)Ke.setUint16(0,31744,!1);else if(t===-1/0)Ke.setUint16(0,64512,!1);else if(Number.isNaN(t))Ke.setUint16(0,32256,!1);else{Ke.setFloat32(0,t);const e=Ke.getUint32(0),r=(e&2139095040)>>23,n=e&8388607;if(r===255)Ke.setUint16(0,31744,!1);else if(r===0)Ke.setUint16(0,(t&2147483648)>>16|n>>13,!1);else{const s=r-127;s<-24?Ke.setUint16(0,0):s<-14?Ke.setUint16(0,(e&2147483648)>>16|1<<24+s,!1):Ke.setUint16(0,(e&2147483648)>>16|s+15<<10|n>>13,!1)}}}function Xi(t,e){if(t.length-e<2)throw new Error(`${H} not enough data for float16`);const r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;const n=r>>10&31,s=r&1023;let i;return n===0?i=s*2**-24:n!==31?i=(s+1024)*2**(n-25):i=s===0?1/0:NaN,r&32768?-i:i}function Kc(t){Ke.setFloat32(0,t,!1)}function Yi(t,e){if(t.length-e<4)throw new Error(`${H} not enough data for float32`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function Rg(t){Ke.setFloat64(0,t,!1)}function Jc(t,e){if(t.length-e<8)throw new Error(`${H} not enough data for float64`);const r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}Zi.compareTokens=cr.compareTokens;function Q(t,e,r){throw new Error(`${H} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function us(t){return()=>{throw new Error(`${H} ${t}`)}}const _=[];for(let t=0;t<=23;t++)_[t]=Q;_[24]=qp;_[25]=Wp;_[26]=Kp;_[27]=Jp;_[28]=Q;_[29]=Q;_[30]=Q;_[31]=Q;for(let t=32;t<=55;t++)_[t]=Q;_[56]=Zp;_[57]=Xp;_[58]=Yp;_[59]=Qp;_[60]=Q;_[61]=Q;_[62]=Q;_[63]=Q;for(let t=64;t<=87;t++)_[t]=eg;_[88]=tg;_[89]=rg;_[90]=ng;_[91]=sg;_[92]=Q;_[93]=Q;_[94]=Q;_[95]=us("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)_[t]=og;_[120]=ag;_[121]=cg;_[122]=ug;_[123]=lg;_[124]=Q;_[125]=Q;_[126]=Q;_[127]=us("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)_[t]=dg;_[152]=hg;_[153]=pg;_[154]=gg;_[155]=yg;_[156]=Q;_[157]=Q;_[158]=Q;_[159]=wg;for(let t=160;t<=183;t++)_[t]=mg;_[184]=bg;_[185]=vg;_[186]=xg;_[187]=Eg;_[188]=Q;_[189]=Q;_[190]=Q;_[191]=Bg;for(let t=192;t<=215;t++)_[t]=Sg;_[216]=Ag;_[217]=kg;_[218]=Ig;_[219]=Cg;_[220]=Q;_[221]=Q;_[222]=Q;_[223]=Q;for(let t=224;t<=243;t++)_[t]=us("simple values are not supported");_[244]=Q;_[245]=Q;_[246]=Q;_[247]=_g;_[248]=us("simple values are not supported");_[249]=Pg;_[250]=Dg;_[251]=Lg;_[252]=Q;_[253]=Q;_[254]=Q;_[255]=Og;const pt=[];for(let t=0;t<24;t++)pt[t]=new $(w.uint,t,1);for(let t=-1;t>=-24;t--)pt[31-t]=new $(w.negint,t,1);pt[64]=new $(w.bytes,new Uint8Array(0),1);pt[96]=new $(w.string,"",1);pt[128]=new $(w.array,0,1);pt[160]=new $(w.map,0,1);pt[244]=new $(w.false,!1,1);pt[245]=new $(w.true,!0,1);pt[246]=new $(w.null,null,1);function Fg(t){switch(t.type){case w.false:return wt([244]);case w.true:return wt([245]);case w.null:return wt([246]);case w.bytes:return t.value.length?void 0:wt([64]);case w.string:return t.value===""?wt([96]):void 0;case w.array:return t.value===0?wt([128]):void 0;case w.map:return t.value===0?wt([160]):void 0;case w.uint:return t.value<24?wt([Number(t.value)]):void 0;case w.negint:if(t.value>=-24)return wt([31-Number(t.value)])}}const Vg={float64:!1,mapSorter:jg,quickEncodeToken:Fg};function Hg(){const t=[];return t[w.uint.major]=cr,t[w.negint.major]=Gi,t[w.bytes.major]=cs,t[w.string.major]=fg,t[w.array.major]=qi,t[w.map.major]=Wi,t[w.tag.major]=Ki,t[w.float.major]=Zi,t}const Zc=Hg(),Os=new zc;class zn{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${Gt} object contains circular references`);return new zn(r,e)}}const Tt={null:new $(w.null,null),undefined:new $(w.undefined,void 0),true:new $(w.true,!0),false:new $(w.false,!1),emptyArray:new $(w.array,0),emptyMap:new $(w.map,0)},Ht={number(t,e,r,n){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new $(w.float,t):t>=0?new $(w.uint,t):new $(w.negint,t)},bigint(t,e,r,n){return t>=BigInt(0)?new $(w.uint,t):new $(w.negint,t)},Uint8Array(t,e,r,n){return new $(w.bytes,t)},string(t,e,r,n){return new $(w.string,t)},boolean(t,e,r,n){return t?Tt.true:Tt.false},null(t,e,r,n){return Tt.null},undefined(t,e,r,n){return Tt.undefined},ArrayBuffer(t,e,r,n){return new $(w.bytes,new Uint8Array(t))},DataView(t,e,r,n){return new $(w.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,n){if(!t.length)return r.addBreakTokens===!0?[Tt.emptyArray,new $(w.break)]:Tt.emptyArray;n=zn.createCheck(n,t);const s=[];let i=0;for(const o of t)s[i++]=On(o,r,n);return r.addBreakTokens?[new $(w.array,t.length),s,new $(w.break)]:[new $(w.array,t.length),s]},Object(t,e,r,n){const s=e!=="Object",i=s?t.keys():Object.keys(t),o=s?t.size:i.length;if(!o)return r.addBreakTokens===!0?[Tt.emptyMap,new $(w.break)]:Tt.emptyMap;n=zn.createCheck(n,t);const a=[];let c=0;for(const f of i)a[c++]=[On(f,r,n),On(s?t.get(f):t[f],r,n)];return Mg(a,r),r.addBreakTokens?[new $(w.map,o),a,new $(w.break)]:[new $(w.map,o),a]}};Ht.Map=Ht.Object;Ht.Buffer=Ht.Uint8Array;for(const t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ht[`${t}Array`]=Ht.DataView;function On(t,e={},r){const n=Dp(t),s=e&&e.typeEncoders&&e.typeEncoders[n]||Ht[n];if(typeof s=="function"){const o=s(t,n,e,r);if(o!=null)return o}const i=Ht[n];if(!i)throw new Error(`${Gt} unsupported type: ${n}`);return i(t,n,e,r)}function Mg(t,e){e.mapSorter&&t.sort(e.mapSorter)}function jg(t,e){const r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);const s=r.type.major,i=Zc[s].compareTokens(r,n);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function Xc(t,e,r,n){if(Array.isArray(e))for(const s of e)Xc(t,s,r,n);else r[e.type.major](t,e,n)}function Yc(t,e,r){const n=On(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){const s=r.quickEncodeToken(n);if(s)return s;const i=e[n.type.major];if(i.encodedSize){const o=i.encodedSize(n,r),a=new zc(o);if(i(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return Mi(a.chunks[0])}}return Os.reset(),Xc(Os,n,e,r),Os.toBytes(!0)}function zg(t,e){return e=Object.assign({},Vg,e),Yc(t,Zc,e)}const Gg={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class qg{constructor(e,r={}){this._pos=0,this.data=e,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const e=this.data[this._pos];let r=pt[e];if(r===void 0){const n=_[e];if(!n)throw new Error(`${H} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);const s=e&31;r=n(this.data,this._pos,s,this.options)}return this._pos+=r.encodedLength,r}}const sn=Symbol.for("DONE"),ls=Symbol.for("BREAK");function Wg(t,e,r){const n=[];for(let s=0;s<t.value;s++){const i=on(e,r);if(i===ls){if(t.value===1/0)break;throw new Error(`${H} got unexpected break to lengthed array`)}if(i===sn)throw new Error(`${H} found array but not enough entries (got ${s}, expected ${t.value})`);n[s]=i}return n}function Kg(t,e,r){const n=r.useMaps===!0,s=n?void 0:{},i=n?new Map:void 0;for(let o=0;o<t.value;o++){const a=on(e,r);if(a===ls){if(t.value===1/0)break;throw new Error(`${H} got unexpected break to lengthed map`)}if(a===sn)throw new Error(`${H} found map but not enough entries (got ${o} [no key], expected ${t.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${H} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&i.has(a)||!n&&a in s))throw new Error(`${H} found repeat map key "${a}"`);const c=on(e,r);if(c===sn)throw new Error(`${H} found map but not enough entries (got ${o} [no value], expected ${t.value})`);n?i.set(a,c):s[a]=c}return n?i:s}function on(t,e){if(t.done())return sn;const r=t.next();if(r.type===w.break)return ls;if(r.type.terminal)return r.value;if(r.type===w.array)return Wg(r,t,e);if(r.type===w.map)return Kg(r,t,e);if(r.type===w.tag){if(e.tags&&typeof e.tags[r.value]=="function"){const n=on(t,e);return e.tags[r.value](n)}throw new Error(`${H} tag not supported (${r.value})`)}throw new Error("unsupported")}function Jg(t,e){if(!(t instanceof Uint8Array))throw new Error(`${H} data to decode must be a Uint8Array`);e=Object.assign({},Gg,e);const r=e.tokenizer||new qg(t,e),n=on(r,e);if(n===sn)throw new Error(`${H} did not find any content to decode`);if(n===ls)throw new Error(`${H} got unexpected break`);return[n,t.subarray(r.pos())]}function Qc(t,e){const[r,n]=Jg(t,e);if(n.length>0)throw new Error(`${H} too many terminals, data makes no sense`);return r}const eu=42;function tu(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}function Zg(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=M.asCID(t);if(!e)return null;const r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new $(w.tag,eu),new $(w.bytes,r)]}function Xg(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Yg(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const si={float64:!0,typeEncoders:{Object:Zg,undefined:Xg,number:Yg}},Qg={...si,typeEncoders:{...si.typeEncoders}};function e0(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return M.decode(t.subarray(1))}const Gn={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};Gn.tags[eu]=e0;const t0={...Gn,tags:Gn.tags.slice()},r0="dag-cbor",n0=113,ru=t=>zg(t,si),nu=t=>Qc(tu(t),Gn),s0=Object.freeze(Object.defineProperty({__proto__:null,code:n0,decode:nu,decodeOptions:t0,encode:ru,encodeOptions:Qg,name:r0,toByteView:tu},Symbol.toStringTag,{value:"Module"}));class i0 extends Array{constructor(){super(),this.inRecursive=[]}prefix(e){const r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===w.array&&(r.elements++,r.elements!==1&&e.push([44])),r.type===w.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?e.push([44]):e.push([58]))))}[w.uint.major](e,r){this.prefix(e);const n=String(r.value),s=[];for(let i=0;i<n.length;i++)s[i]=n.charCodeAt(i);e.push(s)}[w.negint.major](e,r){this[w.uint.major](e,r)}[w.bytes.major](e,r){throw new Error(`${Gt} unsupported type: Uint8Array`)}[w.string.major](e,r){this.prefix(e);const n=Mc(JSON.stringify(r.value));e.push(n.length>32?Mi(n):n)}[w.array.major](e,r){this.prefix(e),this.inRecursive.push({type:w.array,elements:0}),e.push([91])}[w.map.major](e,r){this.prefix(e),this.inRecursive.push({type:w.map,elements:0}),e.push([123])}[w.tag.major](e,r){}[w.float.major](e,r){if(r.type.name==="break"){const o=this.inRecursive.pop();if(o){if(o.type===w.array)e.push([93]);else if(o.type===w.map)e.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${Gt} unsupported type: undefined`);if(this.prefix(e),r.type.name==="true"){e.push([116,114,117,101]);return}else if(r.type.name==="false"){e.push([102,97,108,115,101]);return}else if(r.type.name==="null"){e.push([110,117,108,108]);return}const n=String(r.value),s=[];let i=!1;for(let o=0;o<n.length;o++)s[o]=n.charCodeAt(o),!i&&(s[o]===46||s[o]===101||s[o]===69)&&(i=!0);i||(s.push(46),s.push(48)),e.push(s)}}function o0(t,e){if(Array.isArray(t[0])||Array.isArray(e[0]))throw new Error(`${Gt} complex map keys are not supported`);const r=t[0],n=e[0];if(r.type!==w.string||n.type!==w.string)throw new Error(`${Gt} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${Gt} unexpected duplicate map keys, this is not supported`)}const a0={addBreakTokens:!0,mapSorter:o0};function c0(t,e){return e=Object.assign({},a0,e),Yc(t,new i0,e)}class su{constructor(e,r={}){this._pos=0,this.data=e,this.options=r,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let e=this.ch();for(;e===32||e===9||e===13||e===10;)e=this.data[++this._pos]}expect(e){if(this.data.length-this._pos<e.length)throw new Error(`${H} unexpected end of input at position ${this._pos}`);for(let r=0;r<e.length;r++)if(this.data[this._pos++]!==e[r])throw new Error(`${H} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...e)}'`)}parseNumber(){const e=this._pos;let r=!1,n=!1;const s=a=>{for(;!this.done();){const c=this.ch();if(a.includes(c))this._pos++;else break}};if(this.ch()===45&&(r=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,n=!0;else return new $(w.uint,0,this._pos-e);if(s([48,49,50,51,52,53,54,55,56,57]),r&&this._pos===e+1)throw new Error(`${H} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${H} unexpected token at position ${this._pos}`);n=!0,this._pos++,s([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,s([48,49,50,51,52,53,54,55,56,57]));const i=String.fromCharCode.apply(null,this.data.subarray(e,this._pos)),o=parseFloat(i);return n?new $(w.float,o,this._pos-e):this.options.allowBigInt!==!0||Number.isSafeInteger(o)?new $(o>=0?w.uint:w.negint,o,this._pos-e):new $(o>=0?w.uint:w.negint,BigInt(i),this._pos-e)}parseString(){if(this.ch()!==34)throw new Error(`${H} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let i=this._pos,o=0;i<this.data.length&&o<65536;i++,o++){const a=this.data[i];if(a===92||a<32||a>=128)break;if(a===34){const c=String.fromCharCode.apply(null,this.data.subarray(this._pos,i));return this._pos=i+1,new $(w.string,c,o)}}const e=this._pos,r=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${H} unexpected end of unicode escape sequence at position ${this._pos}`);let i=0;for(let o=0;o<4;o++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${H} unexpected unicode escape character at position ${this._pos}`);i=i*16+a,this._pos++}return i},s=()=>{const i=this.ch();let o=null,a=i>239?4:i>223?3:i>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${H} unexpected unicode sequence at position ${this._pos}`);let c,f,u,l;switch(a){case 1:i<128&&(o=i);break;case 2:c=this.data[this._pos+1],(c&192)===128&&(l=(i&31)<<6|c&63,l>127&&(o=l));break;case 3:c=this.data[this._pos+1],f=this.data[this._pos+2],(c&192)===128&&(f&192)===128&&(l=(i&15)<<12|(c&63)<<6|f&63,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:c=this.data[this._pos+1],f=this.data[this._pos+2],u=this.data[this._pos+3],(c&192)===128&&(f&192)===128&&(u&192)===128&&(l=(i&15)<<18|(c&63)<<12|(f&63)<<6|u&63,l>65535&&l<1114112&&(o=l))}o===null?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|o&1023),r.push(o),this._pos+=a};for(;!this.done();){const i=this.ch();let o;switch(i){case 92:if(this._pos++,this.done())throw new Error(`${H} unexpected string termination at position ${this._pos}`);switch(o=this.ch(),this._pos++,o){case 34:case 39:case 92:case 47:r.push(o);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${H} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new $(w.string,jc(r),this._pos-e);default:if(i<32)throw new Error(`${H} invalid control character at position ${this._pos}`);i<128?(r.push(i),this._pos++):s()}}throw new Error(`${H} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new $(w.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new $(w.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new $(w.null,null,4);case 102:return this.expect([102,97,108,115,101]),new $(w.false,!1,5);case 116:return this.expect([116,114,117,101]),new $(w.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${H} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new $(w.break,void 0,1);if(this.ch()!==44)throw new Error(`${H} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new $(w.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new $(w.break,void 0,1);if(this.ch()!==44)throw new Error(`${H} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new $(w.break,void 0,1);const e=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${H} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),e}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${H} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function u0(t,e){return e=Object.assign({tokenizer:new su(t,e)},e),Qc(t,e)}function l0(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}function f0(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;const e=M.asCID(t);if(!e)return null;const r=e.toString();return[new $(w.map,1/0,1),new $(w.string,"/",1),new $(w.string,r,r.length),new $(w.break,void 0,1)]}function qn(t){const e=is.encode(t).slice(1);return[new $(w.map,1/0,1),new $(w.string,"/",1),new $(w.map,1/0,1),new $(w.string,"bytes",5),new $(w.string,e,e.length),new $(w.break,void 0,1),new $(w.break,void 0,1)]}function Qe(t){return qn(new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}function d0(t){return qn(new Uint8Array(t))}function h0(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function p0(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const g0={typeEncoders:{Object:f0,Buffer:qn,Uint8Array:qn,Int8Array:Qe,Uint16Array:Qe,Int16Array:Qe,Uint32Array:Qe,Int32Array:Qe,Float32Array:Qe,Float64Array:Qe,Uint8ClampedArray:Qe,BigInt64Array:Qe,BigUint64Array:Qe,DataView:Qe,ArrayBuffer:d0,undefined:h0,number:p0}};class y0 extends su{constructor(e,r){super(e,r),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const e=this._next();if(e.type===w.map){const r=this._next();if(r.type===w.string&&r.value==="/"){const n=this._next();if(n.type===w.string){if(this._next().type!==w.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new $(w.tag,42,0)}if(n.type===w.map){const s=this._next();if(s.type===w.string&&s.value==="bytes"){const i=this._next();if(i.type===w.string){for(let a=0;a<2;a++)if(this._next().type!==w.break)throw new Error("Invalid encoded Bytes form");const o=is.decode(`m${i.value}`);return new $(w.bytes,o,i.value.length)}this.tokenBuffer.push(i)}this.tokenBuffer.push(s)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return e}}const ii={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ii.tags[42]=M.parse;const w0="dag-json",m0=297,iu=t=>c0(t,g0),ou=t=>{const e=l0(t),r=Object.assign(ii,{tokenizer:new y0(e,ii)});return u0(e,r)},ta=t=>b0.decode(iu(t)),b0=new TextDecoder,v0=t=>ou(x0.encode(t)),x0=new TextEncoder,E0=Object.freeze(Object.defineProperty({__proto__:null,code:m0,decode:ou,encode:iu,format:ta,name:w0,parse:v0,stringify:ta},Symbol.toStringTag,{value:"Module"})),B0=new TextDecoder;function Qi(t,e){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");const s=t[e++];if(r+=n<28?(s&127)<<n:(s&127)*2**n,s<128)break}return[r,e]}function Wn(t,e){let r;[r,e]=Qi(t,e);const n=e+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,n),n]}function au(t,e){let r;return[r,e]=Qi(t,e),[r&7,r>>3,e]}function S0(t){const e={},r=t.length;let n=0;for(;n<r;){let s,i;if([s,i,n]=au(t,n),i===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(s!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Wn(t,n)}else if(i===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(s!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let o;[o,n]=Wn(t,n),e.Name=B0.decode(o)}else if(i===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(s!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${s}) for Tsize`);[e.Tsize,n]=Qi(t,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function A0(t){const e=t.length;let r=0,n,s=!1,i;for(;r<e;){let a,c;if([a,c,r]=au(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(c===1){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,r]=Wn(t,r),n&&(s=!0)}else if(c===2){if(s)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let f;[f,r]=Wn(t,r),n.push(S0(f))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${c}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");const o={};return i&&(o.Data=i),o.Links=n||[],o}const cu=new TextEncoder,ra=2**32,k0=2**31;function I0(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=Yr(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){const n=cu.encode(t.Name);r-=n.length,e.set(n,r),r=Yr(e,r,n.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=Yr(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function C0(t){const e=N0(t),r=new Uint8Array(e);let n=e;if(t.Data&&(n-=t.Data.length,r.set(t.Data,n),n=Yr(r,n,t.Data.length)-1,r[n]=10),t.Links)for(let s=t.Links.length-1;s>=0;s--){const i=I0(t.Links[s],r.subarray(0,n));n-=i,n=Yr(r,n,i)-1,r[n]=18}return r}function T0(t){let e=0;if(t.Hash){const r=t.Hash.length;e+=1+r+yr(r)}if(typeof t.Name=="string"){const r=cu.encode(t.Name).length;e+=1+r+yr(r)}return typeof t.Tsize=="number"&&(e+=1+yr(t.Tsize)),e}function N0(t){let e=0;if(t.Data){const r=t.Data.length;e+=1+r+yr(r)}if(t.Links)for(const r of t.Links){const n=T0(r);e+=1+n+yr(n)}return e}function Yr(t,e,r){e-=yr(r);const n=e;for(;r>=k0;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,n}function yr(t){return t%2===0&&t++,Math.floor((U0(t)+6)/7)}function U0(t){let e=0;return t>=ra&&(t=Math.floor(t/ra),e=32),t>=65536&&(t>>>=16,e+=16),t>=256&&(t>>>=8,e+=8),e+$0[t]}const $0=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],_0=["Data","Links"],O0=["Hash","Name","Tsize"],oi=new TextEncoder;function uu(t,e){if(t===e)return 0;const r=t.Name?oi.encode(t.Name):[],n=e.Name?oi.encode(e.Name):[];let s=r.length,i=n.length;for(let o=0,a=Math.min(s,i);o<a;++o)if(r[o]!==n[o]){s=r[o],i=n[o];break}return s<i?-1:i<s?1:0}function na(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function lu(t){if(typeof t.asCID=="object"){const r=M.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");const e={};if(t.Hash){let r=M.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=M.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=M.decode(t.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function fu(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");const e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=oi.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map(lu),e.Links.sort(uu);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function du(t){if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form");if(!na(t,_0))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let e=0;e<t.Links.length;e++){const r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!na(r,O0))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(r.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash==null||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0){if(typeof r.Tsize!="number"||r.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(e>0&&uu(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function P0(t,e=[]){return fu({Data:t,Links:e})}function D0(t,e,r){return lu({Hash:r,Name:t,Tsize:e})}function L0(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}const R0="dag-pb",F0=112;function V0(t){du(t);const e={};return t.Links&&(e.Links=t.Links.map(r=>{const n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),t.Data&&(e.Data=t.Data),C0(e)}function H0(t){const e=L0(t),r=A0(e),n={};return r.Data&&(n.Data=r.Data),r.Links&&(n.Links=r.Links.map(s=>{const i={};try{i.Hash=M.decode(s.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return s.Name!==void 0&&(i.Name=s.Name),s.Tsize!==void 0&&(i.Tsize=s.Tsize),i})),n}const M0=Object.freeze(Object.defineProperty({__proto__:null,code:F0,createLink:D0,createNode:P0,decode:H0,encode:V0,name:R0,prepare:fu,validate:du},Symbol.toStringTag,{value:"Module"}));function j0(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function eo(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function z0(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(r[o]!==255)throw new TypeError(i+" is ambiguous");r[o]=s}var a=t.length,c=t.charAt(0),f=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var v=0,p=0,y=0,E=g.length;y!==E&&g[y]===0;)y++,v++;for(var b=(E-y)*u+1>>>0,B=new Uint8Array(b);y!==E;){for(var N=g[y],A=0,k=b-1;(N!==0||A<p)&&k!==-1;k--,A++)N+=256*B[k]>>>0,B[k]=N%a>>>0,N=N/a>>>0;if(N!==0)throw new Error("Non-zero carry");p=A,y++}for(var I=b-p;I!==b&&B[I]===0;)I++;for(var C=c.repeat(v);I<b;++I)C+=t.charAt(B[I]);return C}function d(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var v=0;if(g[v]!==" "){for(var p=0,y=0;g[v]===c;)p++,v++;for(var E=(g.length-v)*f+1>>>0,b=new Uint8Array(E);g[v];){var B=r[g.charCodeAt(v)];if(B===255)return;for(var N=0,A=E-1;(B!==0||N<y)&&A!==-1;A--,N++)B+=a*b[A]>>>0,b[A]=B%256>>>0,B=B/256>>>0;if(B!==0)throw new Error("Non-zero carry");y=N,v++}if(g[v]!==" "){for(var k=E-y;k!==E&&b[k]===0;)k++;for(var I=new Uint8Array(p+(E-k)),C=p;k!==E;)I[C++]=b[k++];return I}}}function h(g){var v=d(g);if(v)return v;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:d,decode:h}}var G0=z0,q0=G0;class W0{constructor(e,r,n){m(this,"name");m(this,"prefix");m(this,"baseEncode");this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class K0{constructor(e,r,n){m(this,"name");m(this,"prefix");m(this,"baseDecode");m(this,"prefixCodePoint");if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return hu(this,e)}}class J0{constructor(e){m(this,"decoders");this.decoders=e}or(e){return hu(this,e)}decode(e){const r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function hu(t,e){return new J0({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}class Z0{constructor(e,r,n,s){m(this,"name");m(this,"prefix");m(this,"baseEncode");m(this,"baseDecode");m(this,"encoder");m(this,"decoder");this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=s,this.encoder=new W0(e,r,n),this.decoder=new K0(e,r,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}function pu({name:t,prefix:e,encode:r,decode:n}){return new Z0(t,e,r,n)}function gu({name:t,prefix:e,alphabet:r}){const{encode:n,decode:s}=q0(r,t);return pu({prefix:e,name:t,encode:n,decode:i=>eo(s(i))})}function X0(t,e,r,n){const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*r/8|0);let a=0,c=0,f=0;for(let u=0;u<i;++u){const l=s[t[u]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<r|l,a+=r,a>=8&&(a-=8,o[f++]=255&c>>a)}if(a>=r||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o}function Y0(t,e,r){const n=e[e.length-1]==="=",s=(1<<r)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>r;)o-=r,i+=e[s&a>>o];if(o!==0&&(i+=e[s&a<<r-o]),n)for(;i.length*r&7;)i+="=";return i}function qe({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return pu({prefix:e,name:t,encode(s){return Y0(s,n,r)},decode(s){return X0(s,n,r,t)}})}qe({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});qe({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});const yu=qe({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});qe({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function xt(t){return yu.encode(t).slice(1)}function ft(t){return yu.decode(`u${t}`)}const Pn=qe({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});qe({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});qe({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});qe({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});qe({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});qe({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});qe({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});qe({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});qe({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const Pt=gu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});gu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Q0=wu,sa=128,ey=127,ty=~ey,ry=Math.pow(2,31);function wu(t,e,r){e=e||[],r=r||0;for(var n=r;t>=ry;)e[r++]=t&255|sa,t/=128;for(;t&ty;)e[r++]=t&255|sa,t>>>=7;return e[r]=t|0,wu.bytes=r-n+1,e}var ny=ai,sy=128,ia=127;function ai(t,n){var r=0,n=n||0,s=0,i=n,o,a=t.length;do{if(i>=a)throw ai.bytes=0,new RangeError("Could not decode varint");o=t[i++],r+=s<28?(o&ia)<<s:(o&ia)*Math.pow(2,s),s+=7}while(o>=sy);return ai.bytes=i-n,r}var iy=Math.pow(2,7),oy=Math.pow(2,14),ay=Math.pow(2,21),cy=Math.pow(2,28),uy=Math.pow(2,35),ly=Math.pow(2,42),fy=Math.pow(2,49),dy=Math.pow(2,56),hy=Math.pow(2,63),py=function(t){return t<iy?1:t<oy?2:t<ay?3:t<cy?4:t<uy?5:t<ly?6:t<fy?7:t<dy?8:t<hy?9:10},gy={encode:Q0,decode:ny,encodingLength:py},Kn=gy;function ci(t,e=0){return[Kn.decode(t,e),Kn.decode.bytes]}function Jn(t,e,r=0){return Kn.encode(t,e,r),e}function Zn(t){return Kn.encodingLength(t)}function yy(t,e){const r=e.byteLength,n=Zn(t),s=n+Zn(r),i=new Uint8Array(s+r);return Jn(t,i,0),Jn(r,i,n),i.set(e,s),new to(t,r,e,i)}function wy(t){const e=eo(t),[r,n]=ci(e),[s,i]=ci(e.subarray(n)),o=e.subarray(n+i);if(o.byteLength!==s)throw new Error("Incorrect length");return new to(r,s,o,e)}function my(t,e){if(t===e)return!0;{const r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&j0(t.bytes,r.bytes)}}class to{constructor(e,r,n,s){m(this,"code");m(this,"size");m(this,"digest");m(this,"bytes");this.code=e,this.size=r,this.digest=n,this.bytes=s}}function oa(t,e){const{bytes:r,version:n}=t;switch(n){case 0:return vy(r,ui(t),e??Pt.encoder);default:return xy(r,ui(t),e??Pn.encoder)}}const aa=new WeakMap;function ui(t){const e=aa.get(t);if(e==null){const r=new Map;return aa.set(t,r),r}return e}var pc;class de{constructor(e,r,n,s){m(this,"code");m(this,"version");m(this,"multihash");m(this,"bytes");m(this,"/");m(this,pc,"CID");this.code=r,this.version=e,this.multihash=n,this.bytes=s,this["/"]=s}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:e,multihash:r}=this;if(e!==zr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ey)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return de.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:e,digest:r}=this.multihash,n=yy(e,r);return de.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return de.equals(this,e)}static equals(e,r){const n=r;return n!=null&&e.code===n.code&&e.version===n.version&&my(e.multihash,n.multihash)}toString(e){return oa(this,e)}toJSON(){return{"/":oa(this)}}link(){return this}[(pc=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;const r=e;if(r instanceof de)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:s,multihash:i,bytes:o}=r;return new de(n,s,i,o??ca(n,s,i.bytes))}else if(r[By]===!0){const{version:n,multihash:s,code:i}=r,o=wy(s);return de.create(n,i,o)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==zr)throw new Error(`Version 0 CID must use dag-pb (code: ${zr}) block encoding`);return new de(e,r,n,n.bytes)}case 1:{const s=ca(e,r,n.bytes);return new de(e,r,n,s)}default:throw new Error("Invalid version")}}static createV0(e){return de.create(0,zr,e)}static createV1(e,r){return de.create(1,e,r)}static decode(e){const[r,n]=de.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(e){const r=de.inspectBytes(e),n=r.size-r.multihashSize,s=eo(e.subarray(n,n+r.multihashSize));if(s.byteLength!==r.multihashSize)throw new Error("Incorrect length");const i=s.subarray(r.multihashSize-r.digestSize),o=new to(r.multihashCode,r.digestSize,i,s);return[r.version===0?de.createV0(o):de.createV1(r.codec,o),e.subarray(r.size)]}static inspectBytes(e){let r=0;const n=()=>{const[l,d]=ci(e.subarray(r));return r+=d,l};let s=n(),i=zr;if(s===18?(s=0,r=0):i=n(),s!==0&&s!==1)throw new RangeError(`Invalid CID version ${s}`);const o=r,a=n(),c=n(),f=r+c,u=f-o;return{version:s,codec:i,multihashCode:a,digestSize:c,multihashSize:u,size:f}}static parse(e,r){const[n,s]=by(e,r),i=de.decode(s);if(i.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return ui(i).set(n,e),i}}function by(t,e){switch(t[0]){case"Q":{const r=e??Pt;return[Pt.prefix,r.decode(`${Pt.prefix}${t}`)]}case Pt.prefix:{const r=e??Pt;return[Pt.prefix,r.decode(t)]}case Pn.prefix:{const r=e??Pn;return[Pn.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}}function vy(t,e,r){const{prefix:n}=r;if(n!==Pt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const s=e.get(n);if(s==null){const i=r.encode(t).slice(1);return e.set(n,i),i}else return s}function xy(t,e,r){const{prefix:n}=r,s=e.get(n);if(s==null){const i=r.encode(t);return e.set(n,i),i}else return s}const zr=112,Ey=18;function ca(t,e,r){const n=Zn(t),s=n+Zn(e),i=new Uint8Array(s+r.byteLength);return Jn(t,i,0),Jn(e,i,n),i.set(r,s),i}const By=Symbol.for("@ipld/js-cid/CID");function Sy(t){const[e,r,n]=t;return{payload:r,signatures:[{protected:e,signature:n}],link:de.decode(ft(r))}}function Ay(t){const e={signature:ft(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=ft(t.protected)),e}function ky(t){return{payload:ft(t.payload),signatures:t.signatures.map(Ay)}}function Iy(t){const e={signature:xt(t.signature)};return t.header&&(e.header=t.header),t.protected&&(e.protected=xt(t.protected)),e}function Cy(t){const e={payload:xt(t.payload),signatures:t.signatures.map(Iy)};try{return e.pld=li(Ny(t.payload)),e}catch{try{return e.link=de.decode(new Uint8Array(t.payload)),e}catch{throw new Error("Invalid payload, must be either JSON or CID")}}}function li(t){if(typeof t=="string"){if(t.startsWith("ipfs://"))return de.parse(t.slice(7))}else{if(Array.isArray(t))return t.map(li);if(Ty(t)){const e={};for(const r in t)e[r]=li(t[r]);return e}}return t}function Ty(t){return typeof t=="object"&&t!==null}function Ny(t){return JSON.parse(new TextDecoder().decode(t))}function Uy(t){const[e,r,n,s,i]=t,o={ciphertext:s,iv:n,protected:e,tag:i};return r&&(o.recipients=[{encrypted_key:r}]),o}function $y(t){const e={};return t.encrypted_key&&(e.encrypted_key=ft(t.encrypted_key)),t.header&&(e.header=t.header),e}function _y(t){const e={ciphertext:ft(t.ciphertext),protected:ft(t.protected),iv:ft(t.iv),tag:ft(t.tag)};return t.aad&&(e.aad=ft(t.aad)),t.recipients&&(e.recipients=t.recipients.map($y)),t.unprotected&&(e.unprotected=t.unprotected),e}function Oy(t){const e={};return t.encrypted_key&&(e.encrypted_key=xt(t.encrypted_key)),t.header&&(e.header=t.header),e}function Py(t){const e={ciphertext:xt(t.ciphertext),protected:xt(t.protected),iv:xt(t.iv),tag:xt(t.tag)};return t.aad&&(e.aad=xt(t.aad)),t.recipients&&(e.recipients=t.recipients.map(Oy)),t.unprotected&&(e.unprotected=t.unprotected),e}const Dy="dag-jose",Ly=133;function mu(t){return"payload"in t&&typeof t.payload=="string"&&"signatures"in t&&Array.isArray(t.signatures)}function Ry(t){return"payload"in t&&t.payload instanceof Uint8Array&&"signatures"in t&&Array.isArray(t.signatures)}function Fy(t){return"ciphertext"in t&&t.ciphertext instanceof Uint8Array&&"iv"in t&&t.iv instanceof Uint8Array&&"protected"in t&&t.protected instanceof Uint8Array&&"tag"in t&&t.tag instanceof Uint8Array}function bu(t){return"ciphertext"in t&&typeof t.ciphertext=="string"&&"iv"in t&&typeof t.iv=="string"&&"protected"in t&&typeof t.protected=="string"&&"tag"in t&&typeof t.tag=="string"}function vu(t){if(typeof t=="string"){const e=t.split(".");if(e.length===3)return Sy(e);if(e.length===5)return Uy(e);throw new Error("Not a valid JOSE string")}if(mu(t)||bu(t))return t;throw new Error("Not a valid unencoded JOSE object")}function Vy(t){typeof t=="string"&&(t=vu(t));let e;if(mu(t))e=ky(t);else if(bu(t))e=_y(t);else throw new Error("Not a valid JOSE object");return new Uint8Array(ru(e))}function Hy(t){let e;try{e=nu(t)}catch{throw new Error("Not a valid DAG-JOSE object")}if(Ry(e))return Cy(e);if(Fy(e))return Py(e);throw new Error("Not a valid DAG-JOSE object")}const My=Object.freeze(Object.defineProperty({__proto__:null,code:Ly,decode:Hy,encode:Vy,name:Dy,toGeneral:vu},Symbol.toStringTag,{value:"Module"}));function At(t){const e=new globalThis.AbortController;function r(){e.abort();for(const i of t)(i==null?void 0:i.removeEventListener)!=null&&i.removeEventListener("abort",r)}for(const i of t){if((i==null?void 0:i.aborted)===!0){r();break}(i==null?void 0:i.addEventListener)!=null&&i.addEventListener("abort",r)}function n(){for(const i of t)(i==null?void 0:i.removeEventListener)!=null&&i.removeEventListener("abort",r)}const s=e.signal;return s.clear=n,s}const jy="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let zy=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=jy[r[t]&63];return e};function Gy(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var qy=Gy;const Wy=Ui(qy),xu=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,ro=Wy(),fs=xu&&!ro,Ky=ro&&xu,Jy=typeof globalThis.process<"u"&&typeof globalThis.process.release<"u"&&globalThis.process.release.name==="node"&&!ro,ds=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope;async function*hs(t,e={}){const r=t.getReader();try{for(;;){const n=await r.read();if(n.done)return;yield n.value}}finally{e.preventCancel!==!0&&await r.cancel(),r.releaseLock()}}function ua(t,e){for(const r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function Zy(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return ua(t,r)}catch{r.message=t.message,r.stack=t.stack;const s=function(){};return s.prototype=Object.create(Object.getPrototypeOf(t)),ua(new s,r)}}var Xy=Zy;const dt=Ui(Xy);function ps(t){const[e,r]=t[Symbol.asyncIterator]!=null?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:s=>{n.push(s)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[r](){return this}}}function Yy(t){return t[Symbol.asyncIterator]!=null}function la(t,e){let r=0;if(Yy(t))return async function*(){for await(const c of t)yield e(c,r++)}();const n=ps(t),{value:s,done:i}=n.next();if(i===!0)return function*(){}();const o=e(s,r++);if(typeof o.then=="function")return async function*(){yield await o;for await(const c of n)yield e(c,r++)}();const a=e;return function*(){yield o;for(const c of n)yield a(c,r++)}()}let Qy=class extends Error{constructor(r){super(r.statusText);m(this,"response");this.name="HTTPError",this.response=r}};class ew extends Error{constructor(e="Invalid mtime"){super(e),this.name="InvalidMtimeError"}}function Er(t){return ArrayBuffer.isView(t)||t instanceof ArrayBuffer}function Xn(t){return t.constructor!=null&&(t.constructor.name==="Blob"||t.constructor.name==="File")&&typeof t.stream=="function"}function fi(t){return typeof t=="object"&&(t.path!=null||t.content!=null)}function Yn(t){return typeof(t==null?void 0:t.getReader)=="function"}function Eu(t){if(t!=null)return typeof t=="string"&&(t=parseInt(t,8)),t&4095}function tw(t){return Object.prototype.hasOwnProperty.call(t,"secs")}function rw(t){return Object.prototype.hasOwnProperty.call(t,"Seconds")}function nw(t){return Array.isArray(t)}function gs(t){if(t!=null){if(tw(t)&&(t={secs:t.secs,nsecs:t.nsecs}),rw(t)&&(t={secs:BigInt(t.Seconds),nsecs:t.FractionalNanoseconds}),nw(t)&&(t={secs:BigInt(t[0]),nsecs:t[1]}),t instanceof Date){const e=t.getTime(),r=Math.floor(e/1e3);t={secs:BigInt(r),nsecs:(e-r*1e3)*1e3}}if(typeof t=="bigint"){const e=t/BigInt(1e9),r=t-e*BigInt(1e9);t={secs:e,nsecs:Number(r)}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw new ew("mtime-nsecs must be within the range [0,999999999]");return t}}}async function*sw(t,e){if(typeof t=="string"||t instanceof String||Er(t)||Xn(t)||t._readableState!=null)throw dt(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(Yn(t)&&(t=hs(t)),Symbol.iterator in t||Symbol.asyncIterator in t){const r=ps(t),{value:n,done:s}=await r.peek();if(s===!0){yield*[];return}if(r.push(n),Number.isInteger(n))throw dt(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState!=null){yield*la(r,async i=>Ps({content:i},e));return}if(Er(n)){yield Ps({content:r},e);return}if(fi(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||Yn(n)||Xn(n)){yield*la(r,async i=>Ps(i,e));return}}throw fi(t)?dt(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):dt(new Error("Unexpected input: "+typeof t),"ERR_UNEXPECTED_INPUT")}async function Ps(t,e){const{path:r,mode:n,mtime:s,content:i}=t,o={path:r??"",mode:Eu(n),mtime:gs(s)};return i!=null?o.content=await e(i):r==null&&(o.content=await e(t)),o}const Bu=Symbol.for("@libp2p/peer-id");class Ze extends Error{constructor(e="Invalid parameters"){super(e),this.name="InvalidParametersError"}}m(Ze,"name","InvalidParametersError");class no extends Error{constructor(e="Invalid public key"){super(e),this.name="InvalidPublicKeyError"}}m(no,"name","InvalidPublicKeyError");class Su extends Error{constructor(e="Invalid Multihash"){super(e),this.name="InvalidMultihashError"}}m(Su,"name","InvalidMultihashError");class so extends Error{constructor(e="Unsupported key type"){super(e),this.name="UnsupportedKeyTypeError"}}m(so,"name","UnsupportedKeyTypeError");function iw(t){return t[Symbol.asyncIterator]!=null}function Au(t){if(iw(t))return(async()=>{const r=[];for await(const n of t)r.push(n);return r})();const e=[];for(const r of t)e.push(r);return e}async function ku(t){if(Er(t))return new Blob([t]);if(typeof t=="string"||t instanceof String)return new Blob([t.toString()]);if(Xn(t))return t;if(Yn(t)&&(t=hs(t)),Symbol.iterator in t||Symbol.asyncIterator in t){const e=ps(t),{value:r,done:n}=await e.peek();if(n===!0)return fa(e);if(e.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await Au(e))]);if(Er(r)||typeof r=="string"||r instanceof String)return fa(e)}throw new Ze(`Unexpected input: ${t}`)}async function fa(t){const e=[];for await(const r of t)e.push(r);return new Blob(e)}function ow(t){return sw(t,ku)}function io(t){if(t!=null)return typeof t=="string"?t:t.toString(8).padStart(4,"0")}async function da(t,e,r={},n){const s=[],i=new FormData;let o=0,a=0;for await(const{content:c,path:f,mode:u,mtime:l}of ow(t)){let d="";const h=c!=null?"file":"dir";o>0&&(d=`-${o}`);let g=h+d;const v=[];if(u!=null&&v.push(`mode=${io(u)}`),l!=null){const{secs:p,nsecs:y}=l;v.push(`mtime=${p}`),y!=null&&v.push(`mtime-nsecs=${y}`)}if(v.length>0&&(g=`${g}?${v.join("&")}`),c!=null){i.set(g,c,f!=null?encodeURIComponent(f):void 0);const p=a+c.size;s.push({name:f,start:a,end:p}),a=p}else if(f!=null)i.set(g,new File([""],encodeURIComponent(f),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");o++}return{total:a,parts:s,headers:r,body:i}}async function Mt(t,e,r={},n=`-----------------------------${zy()}`){let s=da;return Ky&&(s=da),s(t,e,r,n)}function Se(t){if(t==null)return t;const e=/^[A-Z]+$/,r={};return Object.keys(t).reduce((n,s)=>(e.test(s)?n[s.toLowerCase()]=t[s]:e.test(s[0])?n[s[0].toLowerCase()+s.slice(1)]=t[s]:n[s]=t[s],n),r)}function T({arg:t,searchParams:e,hashAlg:r,mtime:n,mode:s,...i}={}){e!=null&&(i={...i,...e}),r!=null&&(i.hash=r),n!=null&&(n=gs(n),i.mtime=n.secs,i.mtimeNsecs=n.nsecs),s!=null&&(i.mode=io(s)),isNaN(i.timeout)||(i.timeout=`${i.timeout}ms`),t==null?t=[]:Array.isArray(t)||(t=[t]);const o=new URLSearchParams(i);return t.forEach(a=>{o.append("arg",a)}),o}function Iu(t){return async function*(r,n={}){const s=new AbortController,i=At([s.signal,n.signal]);try{const{headers:o,body:a,total:c,parts:f}=await Mt(r,s,n.headers),[u,l]=typeof n.progress=="function"?aw(c,n.progress,f):[void 0,void 0],d=await t.post("add",{searchParams:T({"stream-channels":!0,...n,progress:!!u}),onUploadProgress:l,signal:i,headers:o,body:a});for await(let h of d.ndjson())h=Se(h),h.hash!==void 0?yield uw(h):u!=null&&u(h.bytes??0,h.name)}finally{i.clear()}}}const aw=(t,e,r)=>r!=null?[void 0,cw(t,r,e)]:[e,void 0],cw=(t,e,r)=>{let n=0;const s=e.length;return({loaded:i,total:o})=>{const a=Math.floor(i/o*t);for(;n<s;){const{start:c,end:f,name:u}=e[n];if(a<f){r(a-c,u);break}else r(f-c,u),n+=1}}};function uw({name:t,hash:e,size:r,mode:n,mtime:s,mtimeNsecs:i}){const o={path:t,cid:M.parse(e),size:parseInt(r)};return n!=null&&(o.mode=parseInt(n,8)),s!=null&&(o.mtime={secs:s,nsecs:i??0}),o}function lw(t){return t[Symbol.asyncIterator]!=null}function ys(t){if(lw(t))return(async()=>{let r;for await(const n of t)r=n;return r})();let e;for(const r of t)e=r;return e}async function*fw(t,e){if(t==null)throw dt(new Error(`Unexpected input: ${t}`),"ERR_UNEXPECTED_INPUT");if(typeof t=="string"||t instanceof String){yield Bn(t.toString(),e);return}if(Er(t)||Xn(t)){yield Bn(t,e);return}if(Yn(t)&&(t=hs(t)),Symbol.iterator in t||Symbol.asyncIterator in t){const r=ps(t),{value:n,done:s}=await r.peek();if(s===!0){yield{content:[]};return}if(r.push(n),Number.isInteger(n)||Er(n)||typeof n=="string"||n instanceof String){yield Bn(r,e);return}throw dt(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(fi(t)){yield Bn(t,e);return}throw dt(new Error('Unexpected input: cannot convert "'+typeof t+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function Bn(t,e){const{path:r,mode:n,mtime:s,content:i}=t,o={path:r??"",mode:Eu(n),mtime:gs(s)};return i!=null?o.content=await e(i):r==null&&(o.content=await e(t)),o}function dw(t){return fw(t,ku)}function hw(t){const e=Iu(t);return async function(n,s={}){const i=dw(n),o=e(i,s),a=await ys(o);if(a==null)throw new Error("Invalid body");return a}}function ha(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function pw(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function ws(t,...e){if(!pw(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function gw(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");ha(t.outputLen),ha(t.blockLen)}function Qn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function yw(t,e){ws(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const fr=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ds(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ct(t,e){return t<<32-e|t>>>e}function ww(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function oo(t){return typeof t=="string"&&(t=ww(t)),ws(t),t}function mw(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];ws(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}class Cu{clone(){return this._cloneInto()}}function Tu(t){const e=n=>t().update(oo(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Nu(t=32){if(fr&&typeof fr.getRandomValues=="function")return fr.getRandomValues(new Uint8Array(t));if(fr&&typeof fr.randomBytes=="function")return fr.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function bw(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const s=BigInt(32),i=BigInt(4294967295),o=Number(r>>s&i),a=Number(r&i),c=n?4:0,f=n?0:4;t.setUint32(e+c,o,n),t.setUint32(e+f,a,n)}function vw(t,e,r){return t&e^~t&r}function xw(t,e,r){return t&e^t&r^e&r}class Uu extends Cu{constructor(e,r,n,s){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ds(this.buffer)}update(e){Qn(this);const{view:r,buffer:n,blockLen:s}=this;e=oo(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Ds(e);for(;s<=i-o;o+=s)this.process(c,o);continue}n.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Qn(this),yw(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:s,isLE:i}=this;let{pos:o}=this;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(n,0),o=0);for(let l=o;l<s;l++)r[l]=0;bw(n,s-8,BigInt(this.length*8),i),this.process(n,0);const a=Ds(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const f=c/4,u=this.get();if(f>u.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<f;l++)a.setUint32(4*l,u[l],i)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%r&&e.buffer.set(n),e}}const Sn=BigInt(2**32-1),di=BigInt(32);function $u(t,e=!1){return e?{h:Number(t&Sn),l:Number(t>>di&Sn)}:{h:Number(t>>di&Sn)|0,l:Number(t&Sn)|0}}function Ew(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=$u(t[s],e);[r[s],n[s]]=[i,o]}return[r,n]}const Bw=(t,e)=>BigInt(t>>>0)<<di|BigInt(e>>>0),Sw=(t,e,r)=>t>>>r,Aw=(t,e,r)=>t<<32-r|e>>>r,kw=(t,e,r)=>t>>>r|e<<32-r,Iw=(t,e,r)=>t<<32-r|e>>>r,Cw=(t,e,r)=>t<<64-r|e>>>r-32,Tw=(t,e,r)=>t>>>r-32|e<<64-r,Nw=(t,e)=>e,Uw=(t,e)=>t,$w=(t,e,r)=>t<<r|e>>>32-r,_w=(t,e,r)=>e<<r|t>>>32-r,Ow=(t,e,r)=>e<<r-32|t>>>64-r,Pw=(t,e,r)=>t<<r-32|e>>>64-r;function Dw(t,e,r,n){const s=(e>>>0)+(n>>>0);return{h:t+r+(s/2**32|0)|0,l:s|0}}const Lw=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Rw=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,Fw=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Vw=(t,e,r,n,s)=>e+r+n+s+(t/2**32|0)|0,Hw=(t,e,r,n,s)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(s>>>0),Mw=(t,e,r,n,s,i)=>e+r+n+s+i+(t/2**32|0)|0,q={fromBig:$u,split:Ew,toBig:Bw,shrSH:Sw,shrSL:Aw,rotrSH:kw,rotrSL:Iw,rotrBH:Cw,rotrBL:Tw,rotr32H:Nw,rotr32L:Uw,rotlSH:$w,rotlSL:_w,rotlBH:Ow,rotlBL:Pw,add:Dw,add3L:Lw,add3H:Rw,add4L:Fw,add4H:Vw,add5H:Mw,add5L:Hw},[jw,zw]=q.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Nt=new Uint32Array(80),Ut=new Uint32Array(80);class Gw extends Uu{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:f,El:u,Fh:l,Fl:d,Gh:h,Gl:g,Hh:v,Hl:p}=this;return[e,r,n,s,i,o,a,c,f,u,l,d,h,g,v,p]}set(e,r,n,s,i,o,a,c,f,u,l,d,h,g,v,p){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=u|0,this.Fh=l|0,this.Fl=d|0,this.Gh=h|0,this.Gl=g|0,this.Hh=v|0,this.Hl=p|0}process(e,r){for(let b=0;b<16;b++,r+=4)Nt[b]=e.getUint32(r),Ut[b]=e.getUint32(r+=4);for(let b=16;b<80;b++){const B=Nt[b-15]|0,N=Ut[b-15]|0,A=q.rotrSH(B,N,1)^q.rotrSH(B,N,8)^q.shrSH(B,N,7),k=q.rotrSL(B,N,1)^q.rotrSL(B,N,8)^q.shrSL(B,N,7),I=Nt[b-2]|0,C=Ut[b-2]|0,R=q.rotrSH(I,C,19)^q.rotrBH(I,C,61)^q.shrSH(I,C,6),V=q.rotrSL(I,C,19)^q.rotrBL(I,C,61)^q.shrSL(I,C,6),F=q.add4L(k,V,Ut[b-7],Ut[b-16]),Y=q.add4H(F,A,R,Nt[b-7],Nt[b-16]);Nt[b]=Y|0,Ut[b]=F|0}let{Ah:n,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:f,Dl:u,Eh:l,El:d,Fh:h,Fl:g,Gh:v,Gl:p,Hh:y,Hl:E}=this;for(let b=0;b<80;b++){const B=q.rotrSH(l,d,14)^q.rotrSH(l,d,18)^q.rotrBH(l,d,41),N=q.rotrSL(l,d,14)^q.rotrSL(l,d,18)^q.rotrBL(l,d,41),A=l&h^~l&v,k=d&g^~d&p,I=q.add5L(E,N,k,zw[b],Ut[b]),C=q.add5H(I,y,B,A,jw[b],Nt[b]),R=I|0,V=q.rotrSH(n,s,28)^q.rotrBH(n,s,34)^q.rotrBH(n,s,39),F=q.rotrSL(n,s,28)^q.rotrBL(n,s,34)^q.rotrBL(n,s,39),Y=n&i^n&a^i&a,O=s&o^s&c^o&c;y=v|0,E=p|0,v=h|0,p=g|0,h=l|0,g=d|0,{h:l,l:d}=q.add(f|0,u|0,C|0,R|0),f=a|0,u=c|0,a=i|0,c=o|0,i=n|0,o=s|0;const D=q.add3L(R,F,O);n=q.add3H(D,C,V,Y),s=D|0}({h:n,l:s}=q.add(this.Ah|0,this.Al|0,n|0,s|0)),{h:i,l:o}=q.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=q.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:u}=q.add(this.Dh|0,this.Dl|0,f|0,u|0),{h:l,l:d}=q.add(this.Eh|0,this.El|0,l|0,d|0),{h,l:g}=q.add(this.Fh|0,this.Fl|0,h|0,g|0),{h:v,l:p}=q.add(this.Gh|0,this.Gl|0,v|0,p|0),{h:y,l:E}=q.add(this.Hh|0,this.Hl|0,y|0,E|0),this.set(n,s,i,o,a,c,f,u,l,d,h,g,v,p,y,E)}roundClean(){Nt.fill(0),Ut.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const qw=Tu(()=>new Gw);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ms=BigInt(0),bs=BigInt(1),Ww=BigInt(2);function Zt(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function bn(t){if(!Zt(t))throw new Error("Uint8Array expected")}function Bt(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Kw=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Xt(t){bn(t);let e="";for(let r=0;r<t.length;r++)e+=Kw[t[r]];return e}function hr(t){const e=t.toString(16);return e.length&1?"0"+e:e}function ao(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?ms:BigInt("0x"+t)}const mt={_0:48,_9:57,A:65,F:70,a:97,f:102};function pa(t){if(t>=mt._0&&t<=mt._9)return t-mt._0;if(t>=mt.A&&t<=mt.F)return t-(mt.A-10);if(t>=mt.a&&t<=mt.f)return t-(mt.a-10)}function Br(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let s=0,i=0;s<r;s++,i+=2){const o=pa(t.charCodeAt(i)),a=pa(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}n[s]=o*16+a}return n}function qt(t){return ao(Xt(t))}function wr(t){return bn(t),ao(Xt(Uint8Array.from(t).reverse()))}function Sr(t,e){return Br(t.toString(16).padStart(e*2,"0"))}function an(t,e){return Sr(t,e).reverse()}function Jw(t){return Br(hr(t))}function le(t,e,r){let n;if(typeof e=="string")try{n=Br(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Zt(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=n.length;if(typeof r=="number"&&s!==r)throw new Error(t+" of length "+r+" expected, got "+s);return n}function Yt(...t){let e=0;for(let n=0;n<t.length;n++){const s=t[n];bn(s),e+=s.length}const r=new Uint8Array(e);for(let n=0,s=0;n<t.length;n++){const i=t[n];r.set(i,s),s+=i.length}return r}function Zw(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function Xw(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Ls=t=>typeof t=="bigint"&&ms<=t;function vs(t,e,r){return Ls(t)&&Ls(e)&&Ls(r)&&e<=t&&t<r}function Je(t,e,r,n){if(!vs(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function _u(t){let e;for(e=0;t>ms;t>>=bs,e+=1);return e}function Yw(t,e){return t>>BigInt(e)&bs}function Qw(t,e,r){return t|(r?bs:ms)<<BigInt(e)}const co=t=>(Ww<<BigInt(t-1))-bs,Rs=t=>new Uint8Array(t),ga=t=>Uint8Array.from(t);function Ou(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=Rs(t),s=Rs(t),i=0;const o=()=>{n.fill(1),s.fill(0),i=0},a=(...l)=>r(s,n,...l),c=(l=Rs())=>{s=a(ga([0]),l),n=a(),l.length!==0&&(s=a(ga([1]),l),n=a())},f=()=>{if(i++>=1e3)throw new Error("drbg: tried 1000 values");let l=0;const d=[];for(;l<e;){n=a();const h=n.slice();d.push(h),l+=n.length}return Yt(...d)};return(l,d)=>{o(),c(l);let h;for(;!(h=d(f()));)c();return o(),h}}const em={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Zt(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Dr(t,e,r={}){const n=(s,i,o)=>{const a=em[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))n(s,i,!1);for(const[s,i]of Object.entries(r))n(s,i,!0);return t}const tm=()=>{throw new Error("not implemented")};function cn(t){const e=new WeakMap;return(r,...n)=>{const s=e.get(r);if(s!==void 0)return s;const i=t(r,...n);return e.set(r,i),i}}const rm=Object.freeze(Object.defineProperty({__proto__:null,aInRange:Je,abool:Bt,abytes:bn,bitGet:Yw,bitLen:_u,bitMask:co,bitSet:Qw,bytesToHex:Xt,bytesToNumberBE:qt,bytesToNumberLE:wr,concatBytes:Yt,createHmacDrbg:Ou,ensureBytes:le,equalBytes:Zw,hexToBytes:Br,hexToNumber:ao,inRange:vs,isBytes:Zt,memoized:cn,notImplemented:tm,numberToBytesBE:Sr,numberToBytesLE:an,numberToHexUnpadded:hr,numberToVarBytesBE:Jw,utf8ToBytes:Xw,validateObject:Dr},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const we=BigInt(0),ie=BigInt(1),jt=BigInt(2),nm=BigInt(3),hi=BigInt(4),ya=BigInt(5),wa=BigInt(8);function se(t,e){const r=t%e;return r>=we?r:e+r}function sm(t,e,r){if(e<we)throw new Error("invalid exponent, negatives unsupported");if(r<=we)throw new Error("invalid modulus");if(r===ie)return we;let n=ie;for(;e>we;)e&ie&&(n=n*t%r),t=t*t%r,e>>=ie;return n}function oe(t,e,r){let n=t;for(;e-- >we;)n*=n,n%=r;return n}function pi(t,e){if(t===we)throw new Error("invert: expected non-zero number");if(e<=we)throw new Error("invert: expected positive modulus, got "+e);let r=se(t,e),n=e,s=we,i=ie;for(;r!==we;){const a=n/r,c=n%r,f=s-i*a;n=r,r=c,s=i,i=f}if(n!==ie)throw new Error("invert: does not exist");return se(s,e)}function im(t){const e=(t-ie)/jt;let r,n,s;for(r=t-ie,n=0;r%jt===we;r/=jt,n++);for(s=jt;s<t&&sm(s,e,t)!==t-ie;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const o=(t+ie)/hi;return function(c,f){const u=c.pow(f,o);if(!c.eql(c.sqr(u),f))throw new Error("Cannot find square root");return u}}const i=(r+ie)/jt;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let f=n,u=a.pow(a.mul(a.ONE,s),r),l=a.pow(c,i),d=a.pow(c,r);for(;!a.eql(d,a.ONE);){if(a.eql(d,a.ZERO))return a.ZERO;let h=1;for(let v=a.sqr(d);h<f&&!a.eql(v,a.ONE);h++)v=a.sqr(v);const g=a.pow(u,ie<<BigInt(f-h-1));u=a.sqr(g),l=a.mul(l,g),d=a.mul(d,u),f=h}return l}}function om(t){if(t%hi===nm){const e=(t+ie)/hi;return function(n,s){const i=n.pow(s,e);if(!n.eql(n.sqr(i),s))throw new Error("Cannot find square root");return i}}if(t%wa===ya){const e=(t-ya)/wa;return function(n,s){const i=n.mul(s,jt),o=n.pow(i,e),a=n.mul(s,o),c=n.mul(n.mul(a,jt),o),f=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(f),s))throw new Error("Cannot find square root");return f}}return im(t)}const am=(t,e)=>(se(t,e)&ie)===ie,cm=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function um(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=cm.reduce((n,s)=>(n[s]="function",n),e);return Dr(t,r)}function lm(t,e,r){if(r<we)throw new Error("invalid exponent, negatives unsupported");if(r===we)return t.ONE;if(r===ie)return e;let n=t.ONE,s=e;for(;r>we;)r&ie&&(n=t.mul(n,s)),s=t.sqr(s),r>>=ie;return n}function fm(t,e){const r=new Array(e.length),n=e.reduce((i,o,a)=>t.is0(o)?i:(r[a]=i,t.mul(i,o)),t.ONE),s=t.inv(n);return e.reduceRight((i,o,a)=>t.is0(o)?i:(r[a]=t.mul(i,r[a]),t.mul(i,o)),s),r}function Pu(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function xs(t,e,r=!1,n={}){if(t<=we)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=Pu(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:r,BITS:s,BYTES:i,MASK:co(s),ZERO:we,ONE:ie,create:c=>se(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return we<=c&&c<t},is0:c=>c===we,isOdd:c=>(c&ie)===ie,neg:c=>se(-c,t),eql:(c,f)=>c===f,sqr:c=>se(c*c,t),add:(c,f)=>se(c+f,t),sub:(c,f)=>se(c-f,t),mul:(c,f)=>se(c*f,t),pow:(c,f)=>lm(a,c,f),div:(c,f)=>se(c*pi(f,t),t),sqrN:c=>c*c,addN:(c,f)=>c+f,subN:(c,f)=>c-f,mulN:(c,f)=>c*f,inv:c=>pi(c,t),sqrt:n.sqrt||(c=>(o||(o=om(t)),o(a,c))),invertBatch:c=>fm(a,c),cmov:(c,f,u)=>u?f:c,toBytes:c=>r?an(c,i):Sr(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return r?wr(c):qt(c)}});return Object.freeze(a)}function Du(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Lu(t){const e=Du(t);return e+Math.ceil(e/2)}function dm(t,e,r=!1){const n=t.length,s=Du(e),i=Lu(e);if(n<16||n<i||n>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+n);const o=r?wr(t):qt(t),a=se(o,e-ie)+ie;return r?an(a,s):Sr(a,s)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ma=BigInt(0),An=BigInt(1);function Fs(t,e){const r=e.negate();return t?r:e}function Ru(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Vs(t,e){Ru(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function hm(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function pm(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Hs=new WeakMap,Fu=new WeakMap;function Ms(t){return Fu.get(t)||1}function Vu(t,e){return{constTimeNegate:Fs,hasPrecomputes(r){return Ms(r)!==1},unsafeLadder(r,n,s=t.ZERO){let i=r;for(;n>ma;)n&An&&(s=s.add(i)),i=i.double(),n>>=An;return s},precomputeWindow(r,n){const{windows:s,windowSize:i}=Vs(n,e),o=[];let a=r,c=a;for(let f=0;f<s;f++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(r,n,s){const{windows:i,windowSize:o}=Vs(r,e);let a=t.ZERO,c=t.BASE;const f=BigInt(2**r-1),u=2**r,l=BigInt(r);for(let d=0;d<i;d++){const h=d*o;let g=Number(s&f);s>>=l,g>o&&(g-=u,s+=An);const v=h,p=h+Math.abs(g)-1,y=d%2!==0,E=g<0;g===0?c=c.add(Fs(y,n[v])):a=a.add(Fs(E,n[p]))}return{p:a,f:c}},wNAFUnsafe(r,n,s,i=t.ZERO){const{windows:o,windowSize:a}=Vs(r,e),c=BigInt(2**r-1),f=2**r,u=BigInt(r);for(let l=0;l<o;l++){const d=l*a;if(s===ma)break;let h=Number(s&c);if(s>>=u,h>a&&(h-=f,s+=An),h===0)continue;let g=n[d+Math.abs(h)-1];h<0&&(g=g.negate()),i=i.add(g)}return i},getPrecomputes(r,n,s){let i=Hs.get(n);return i||(i=this.precomputeWindow(n,r),r!==1&&Hs.set(n,s(i))),i},wNAFCached(r,n,s){const i=Ms(r);return this.wNAF(i,this.getPrecomputes(i,r,s),n)},wNAFCachedUnsafe(r,n,s,i){const o=Ms(r);return o===1?this.unsafeLadder(r,n,i):this.wNAFUnsafe(o,this.getPrecomputes(o,r,s),n,i)},setWindowSize(r,n){Ru(n,e),Fu.set(r,n),Hs.delete(r)}}}function Hu(t,e,r,n){if(hm(r,t),pm(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=_u(BigInt(r.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),f=Math.floor((e.BITS-1)/o)*o;let u=s;for(let l=f;l>=0;l-=o){c.fill(s);for(let h=0;h<n.length;h++){const g=n[h],v=Number(g>>BigInt(l)&BigInt(a));c[v]=c[v].add(r[h])}let d=s;for(let h=c.length-1,g=s;h>0;h--)g=g.add(c[h]),d=d.add(g);if(u=u.add(d),l!==0)for(let h=0;h<o;h++)u=u.double()}return u}function uo(t){return um(t.Fp),Dr(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Pu(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const et=BigInt(0),Le=BigInt(1),kn=BigInt(2),gm=BigInt(8),ym={zip215:!0};function wm(t){const e=uo(t);return Dr(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function mm(t){const e=wm(t),{Fp:r,n,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,f=kn<<BigInt(a*8)-Le,u=r.create,l=xs(e.n,e.nBitLength),d=e.uvRatio||((S,x)=>{try{return{isValid:!0,value:r.sqrt(S*r.inv(x))}}catch{return{isValid:!1,value:et}}}),h=e.adjustScalarBytes||(S=>S),g=e.domain||((S,x,U)=>{if(Bt("phflag",U),x.length||U)throw new Error("Contexts/pre-hash are not supported");return S});function v(S,x){Je("coordinate "+S,x,et,f)}function p(S){if(!(S instanceof b))throw new Error("ExtendedPoint expected")}const y=cn((S,x)=>{const{ex:U,ey:L,ez:j}=S,z=S.is0();x==null&&(x=z?gm:r.inv(j));const K=u(U*x),Z=u(L*x),G=u(j*x);if(z)return{x:et,y:Le};if(G!==Le)throw new Error("invZ was invalid");return{x:K,y:Z}}),E=cn(S=>{const{a:x,d:U}=e;if(S.is0())throw new Error("bad point: ZERO");const{ex:L,ey:j,ez:z,et:K}=S,Z=u(L*L),G=u(j*j),te=u(z*z),ne=u(te*te),pe=u(Z*x),ge=u(te*u(pe+G)),be=u(ne+u(U*u(Z*G)));if(ge!==be)throw new Error("bad point: equation left != right (1)");const Ae=u(L*j),De=u(z*K);if(Ae!==De)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(x,U,L,j){this.ex=x,this.ey=U,this.ez=L,this.et=j,v("x",x),v("y",U),v("z",L),v("t",j),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(x){if(x instanceof b)throw new Error("extended point not allowed");const{x:U,y:L}=x||{};return v("x",U),v("y",L),new b(U,L,Le,u(U*L))}static normalizeZ(x){const U=r.invertBatch(x.map(L=>L.ez));return x.map((L,j)=>L.toAffine(U[j])).map(b.fromAffine)}static msm(x,U){return Hu(b,l,x,U)}_setWindowSize(x){A.setWindowSize(this,x)}assertValidity(){E(this)}equals(x){p(x);const{ex:U,ey:L,ez:j}=this,{ex:z,ey:K,ez:Z}=x,G=u(U*Z),te=u(z*j),ne=u(L*Z),pe=u(K*j);return G===te&&ne===pe}is0(){return this.equals(b.ZERO)}negate(){return new b(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:x}=e,{ex:U,ey:L,ez:j}=this,z=u(U*U),K=u(L*L),Z=u(kn*u(j*j)),G=u(x*z),te=U+L,ne=u(u(te*te)-z-K),pe=G+K,ge=pe-Z,be=G-K,Ae=u(ne*ge),De=u(pe*be),Ue=u(ne*be),at=u(ge*pe);return new b(Ae,De,at,Ue)}add(x){p(x);const{a:U,d:L}=e,{ex:j,ey:z,ez:K,et:Z}=this,{ex:G,ey:te,ez:ne,et:pe}=x;if(U===BigInt(-1)){const Uo=u((z-j)*(te+G)),$o=u((z+j)*(te-G)),Cs=u($o-Uo);if(Cs===et)return this.double();const _o=u(K*kn*pe),Oo=u(Z*kn*ne),Po=Oo+_o,Do=$o+Uo,Lo=Oo-_o,od=u(Po*Cs),ad=u(Do*Lo),cd=u(Po*Lo),ud=u(Cs*Do);return new b(od,ad,ud,cd)}const ge=u(j*G),be=u(z*te),Ae=u(Z*L*pe),De=u(K*ne),Ue=u((j+z)*(G+te)-ge-be),at=De-Ae,Ct=De+Ae,gt=u(be-U*ge),rd=u(Ue*at),nd=u(Ct*gt),sd=u(Ue*gt),id=u(at*Ct);return new b(rd,nd,id,sd)}subtract(x){return this.add(x.negate())}wNAF(x){return A.wNAFCached(this,x,b.normalizeZ)}multiply(x){const U=x;Je("scalar",U,Le,n);const{p:L,f:j}=this.wNAF(U);return b.normalizeZ([L,j])[0]}multiplyUnsafe(x,U=b.ZERO){const L=x;return Je("scalar",L,et,n),L===et?N:this.is0()||L===Le?this:A.wNAFCachedUnsafe(this,L,b.normalizeZ,U)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return A.unsafeLadder(this,n).is0()}toAffine(x){return y(this,x)}clearCofactor(){const{h:x}=e;return x===Le?this:this.multiplyUnsafe(x)}static fromHex(x,U=!1){const{d:L,a:j}=e,z=r.BYTES;x=le("pointHex",x,z),Bt("zip215",U);const K=x.slice(),Z=x[z-1];K[z-1]=Z&-129;const G=wr(K),te=U?f:r.ORDER;Je("pointHex.y",G,et,te);const ne=u(G*G),pe=u(ne-Le),ge=u(L*ne-j);let{isValid:be,value:Ae}=d(pe,ge);if(!be)throw new Error("Point.fromHex: invalid y coordinate");const De=(Ae&Le)===Le,Ue=(Z&128)!==0;if(!U&&Ae===et&&Ue)throw new Error("Point.fromHex: x=0 and x_0=1");return Ue!==De&&(Ae=u(-Ae)),b.fromAffine({x:Ae,y:G})}static fromPrivateKey(x){return C(x).point}toRawBytes(){const{x,y:U}=this.toAffine(),L=an(U,r.BYTES);return L[L.length-1]|=x&Le?128:0,L}toHex(){return Xt(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,Le,u(e.Gx*e.Gy)),b.ZERO=new b(et,Le,Le,et);const{BASE:B,ZERO:N}=b,A=Vu(b,a*8);function k(S){return se(S,n)}function I(S){return k(wr(S))}function C(S){const x=r.BYTES;S=le("private key",S,x);const U=le("hashed private key",i(S),2*x),L=h(U.slice(0,x)),j=U.slice(x,2*x),z=I(L),K=B.multiply(z),Z=K.toRawBytes();return{head:L,prefix:j,scalar:z,point:K,pointBytes:Z}}function R(S){return C(S).pointBytes}function V(S=new Uint8Array,...x){const U=Yt(...x);return I(i(g(U,le("context",S),!!s)))}function F(S,x,U={}){S=le("message",S),s&&(S=s(S));const{prefix:L,scalar:j,pointBytes:z}=C(x),K=V(U.context,L,S),Z=B.multiply(K).toRawBytes(),G=V(U.context,Z,z,S),te=k(K+G*j);Je("signature.s",te,et,n);const ne=Yt(Z,an(te,r.BYTES));return le("result",ne,r.BYTES*2)}const Y=ym;function O(S,x,U,L=Y){const{context:j,zip215:z}=L,K=r.BYTES;S=le("signature",S,2*K),x=le("message",x),U=le("publicKey",U,K),z!==void 0&&Bt("zip215",z),s&&(x=s(x));const Z=wr(S.slice(K,2*K));let G,te,ne;try{G=b.fromHex(U,z),te=b.fromHex(S.slice(0,K),z),ne=B.multiplyUnsafe(Z)}catch{return!1}if(!z&&G.isSmallOrder())return!1;const pe=V(j,te.toRawBytes(),G.toRawBytes(),x);return te.add(G.multiplyUnsafe(pe)).subtract(ne).clearCofactor().equals(b.ZERO)}return B._setWindowSize(8),{CURVE:e,getPublicKey:R,sign:F,verify:O,ExtendedPoint:b,utils:{getExtendedPublicKey:C,randomPrivateKey:()=>o(r.BYTES),precompute(S=8,x=b.BASE){return x._setWindowSize(S),x.multiply(BigInt(3)),x}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const lo=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ba=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const bm=BigInt(1),va=BigInt(2);BigInt(3);const vm=BigInt(5),xm=BigInt(8);function Em(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),s=BigInt(80),i=lo,a=t*t%i*t%i,c=oe(a,va,i)*a%i,f=oe(c,bm,i)*t%i,u=oe(f,vm,i)*f%i,l=oe(u,e,i)*u%i,d=oe(l,r,i)*l%i,h=oe(d,n,i)*d%i,g=oe(h,s,i)*h%i,v=oe(g,s,i)*h%i,p=oe(v,e,i)*u%i;return{pow_p_5_8:oe(p,va,i)*t%i,b2:a}}function Bm(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Sm(t,e){const r=lo,n=se(e*e*e,r),s=se(n*n*e,r),i=Em(t*s).pow_p_5_8;let o=se(t*n*i,r);const a=se(e*o*o,r),c=o,f=se(o*ba,r),u=a===t,l=a===se(-t,r),d=a===se(-t*ba,r);return u&&(o=c),(l||d)&&(o=f),am(o,r)&&(o=se(-o,r)),{isValid:u||l,value:o}}const Am=xs(lo,void 0,!0),km={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Am,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:xm,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:qw,randomBytes:Nu,adjustScalarBytes:Bm,uvRatio:Sm},Im=mm(km),Mu=32;function Cm(t,e,r){return Im.verify(e,r instanceof Uint8Array?r:r.subarray(),t)}class Tm{constructor(e){m(this,"type","Ed25519");m(this,"raw");this.raw=zu(e,Mu)}toMultihash(){return Kt.digest(Ef(this))}toCID(){return M.createV1(114,this.toMultihash())}toString(){return xe.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:br(this.raw,e.raw)}verify(e,r){return Cm(this.raw,r,e)}}function ju(t){return t=zu(t,Mu),new Tm(t)}function zu(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new Ze(`Key must be a Uint8Array of length ${e}, got ${t.length}`);return t}const fo=new Float32Array([-0]),Lt=new Uint8Array(fo.buffer);function Nm(t,e,r){fo[0]=t,e[r]=Lt[0],e[r+1]=Lt[1],e[r+2]=Lt[2],e[r+3]=Lt[3]}function Um(t,e){return Lt[0]=t[e],Lt[1]=t[e+1],Lt[2]=t[e+2],Lt[3]=t[e+3],fo[0]}const ho=new Float64Array([-0]),Te=new Uint8Array(ho.buffer);function $m(t,e,r){ho[0]=t,e[r]=Te[0],e[r+1]=Te[1],e[r+2]=Te[2],e[r+3]=Te[3],e[r+4]=Te[4],e[r+5]=Te[5],e[r+6]=Te[6],e[r+7]=Te[7]}function _m(t,e){return Te[0]=t[e],Te[1]=t[e+1],Te[2]=t[e+2],Te[3]=t[e+3],Te[4]=t[e+4],Te[5]=t[e+5],Te[6]=t[e+6],Te[7]=t[e+7],ho[0]}const Om=BigInt(Number.MAX_SAFE_INTEGER),Pm=BigInt(Number.MIN_SAFE_INTEGER);class Ne{constructor(e,r){m(this,"lo");m(this,"hi");this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){const r=~this.lo+1>>>0;let n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){const r=~this.lo+1>>>0;let n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){const e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){const e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){const e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return Wt;if(e<Om&&e>Pm)return this.fromNumber(Number(e));const r=e<0n;r&&(e=-e);let n=e>>32n,s=e-(n<<32n);return r&&(n=~n|0n,s=~s|0n,++s>xa&&(s=0n,++n>xa&&(n=0n))),new Ne(Number(s),Number(n))}static fromNumber(e){if(e===0)return Wt;const r=e<0;r&&(e=-e);let n=e>>>0,s=(e-n)/4294967296>>>0;return r&&(s=~s>>>0,n=~n>>>0,++n>4294967295&&(n=0,++s>4294967295&&(s=0))),new Ne(n,s)}static from(e){return typeof e=="number"?Ne.fromNumber(e):typeof e=="bigint"?Ne.fromBigInt(e):typeof e=="string"?Ne.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new Ne(e.low>>>0,e.high>>>0):Wt}}const Wt=new Ne(0,0);Wt.toBigInt=function(){return 0n};Wt.zzEncode=Wt.zzDecode=function(){return this};Wt.length=function(){return 1};const xa=4294967296n;function Dm(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function Lm(t,e,r){if(r-e<1)return"";let s;const i=[];let o=0,a;for(;e<r;)a=t[e++],a<128?i[o++]=a:a>191&&a<224?i[o++]=(a&31)<<6|t[e++]&63:a>239&&a<365?(a=((a&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,i[o++]=55296+(a>>10),i[o++]=56320+(a&1023)):i[o++]=(a&15)<<12|(t[e++]&63)<<6|t[e++]&63,o>8191&&((s??(s=[])).push(String.fromCharCode.apply(String,i)),o=0);return s!=null?(o>0&&s.push(String.fromCharCode.apply(String,i.slice(0,o))),s.join("")):String.fromCharCode.apply(String,i.slice(0,o))}function Gu(t,e,r){const n=r;let s,i;for(let o=0;o<t.length;++o)s=t.charCodeAt(o),s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=s&63|128):(s&64512)===55296&&((i=t.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(i&1023),++o,e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=s&63|128):(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=s&63|128);return r-n}function tt(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function In(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}class Rm{constructor(e){m(this,"buf");m(this,"pos");m(this,"len");m(this,"_slice",Uint8Array.prototype.subarray);this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,tt(this,10);return e}int32(){return this.uint32()|0}sint32(){const e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw tt(this,4);return In(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw tt(this,4);return In(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw tt(this,4);const e=Um(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw tt(this,4);const e=_m(this.buf,this.pos);return this.pos+=8,e}bytes(){const e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw tt(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){const e=this.bytes();return Lm(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw tt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw tt(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){const e=new Ne(0,0);let r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw tt(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw tt(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw tt(this,8);const e=In(this.buf,this.pos+=4),r=In(this.buf,this.pos+=4);return new Ne(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){const e=$c(this.buf,this.pos);return this.pos+=ht(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}}function Fm(t){return new Rm(t instanceof Uint8Array?t:t.subarray())}function qu(t,e,r){const n=Fm(t);return e.decode(n,void 0,r)}function Vm(t){let n,s=8192;return function(o){if(o<1||o>4096)return vr(o);s+o>8192&&(n=vr(8192),s=0);const a=n.subarray(s,s+=o);return s&7&&(s=(s|7)+1),a}}class Wr{constructor(e,r,n){m(this,"fn");m(this,"len");m(this,"next");m(this,"val");this.fn=e,this.len=r,this.next=void 0,this.val=n}}function js(){}class Hm{constructor(e){m(this,"head");m(this,"tail");m(this,"len");m(this,"next");this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}}const Mm=Vm();function jm(t){return globalThis.Buffer!=null?vr(t):Mm(t)}class gi{constructor(){m(this,"len");m(this,"head");m(this,"tail");m(this,"states");this.len=0,this.head=new Wr(js,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new Wr(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new Gm((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(Cn,10,Ne.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){const r=Ne.fromBigInt(e);return this._push(Cn,r.length(),r)}uint64Number(e){return this._push(Uc,ht(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){const r=Ne.fromBigInt(e).zzEncode();return this._push(Cn,r.length(),r)}sint64Number(e){const r=Ne.fromNumber(e).zzEncode();return this._push(Cn,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(zs,1,e?1:0)}fixed32(e){return this._push(Gr,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){const r=Ne.fromBigInt(e);return this._push(Gr,4,r.lo)._push(Gr,4,r.hi)}fixed64Number(e){const r=Ne.fromNumber(e);return this._push(Gr,4,r.lo)._push(Gr,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(Nm,4,e)}double(e){return this._push($m,8,e)}bytes(e){const r=e.length>>>0;return r===0?this._push(zs,1,0):this.uint32(r)._push(qm,r,e)}string(e){const r=Dm(e);return r!==0?this.uint32(r)._push(Gu,r,e):this._push(zs,1,0)}fork(){return this.states=new Hm(this),this.head=this.tail=new Wr(js,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Wr(js,0,0),this.len=0),this}ldelim(){const e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next;const r=jm(this.len);let n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}}function zs(t,e,r){e[r]=t&255}function zm(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}class Gm extends Wr{constructor(r,n){super(zm,r,n);m(this,"next");this.next=void 0}}function Cn(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Gr(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function qm(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(gi.prototype.bytes=function(t){const e=t.length>>>0;return this.uint32(e),e>0&&this._push(Wm,e,t),this},gi.prototype.string=function(t){const e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(Km,e,t),this});function Wm(t,e,r){e.set(t,r)}function Km(t,e,r){t.length<40?Gu(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(it(t),r)}function Jm(){return new gi}function Wu(t,e){const r=Jm();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var es;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(es||(es={}));function Ku(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function Zm(t){function e(s){if(t[s.toString()]==null)throw new Error("Invalid enum value");return t[s]}const r=function(i,o){const a=e(i);o.int32(a)},n=function(i){const o=i.int32();return e(o)};return Ku("enum",es.VARINT,r,n)}function Ju(t,e){return Ku("message",es.LENGTH_DELIMITED,t,e)}var Oe;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.secp256k1="secp256k1"})(Oe||(Oe={}));var yi;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.secp256k1=2]="secp256k1"})(yi||(yi={}));(function(t){t.codec=()=>Zm(yi)})(Oe||(Oe={}));var Ar;(function(t){let e;t.codec=()=>(e==null&&(e=Ju((r,n,s={})=>{s.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Oe.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),s.lengthDelimited!==!1&&n.ldelim()},(r,n,s={})=>{const i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){const a=r.uint32();switch(a>>>3){case 1:{i.Type=Oe.codec().decode(r);break}case 2:{i.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return i})),e),t.encode=r=>Wu(r,t.codec()),t.decode=(r,n)=>qu(r,t.codec(),n)})(Ar||(Ar={}));var Ea;(function(t){let e;t.codec=()=>(e==null&&(e=Ju((r,n,s={})=>{s.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),Oe.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),s.lengthDelimited!==!1&&n.ldelim()},(r,n,s={})=>{const i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){const a=r.uint32();switch(a>>>3){case 1:{i.Type=Oe.codec().decode(r);break}case 2:{i.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return i})),e),t.encode=r=>Wu(r,t.codec()),t.decode=(r,n)=>qu(r,t.codec(),n)})(Ea||(Ea={}));const Xm=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),$t=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),_t=new Uint32Array(64);class Ym extends Uu{constructor(){super(64,32,8,!1),this.A=$t[0]|0,this.B=$t[1]|0,this.C=$t[2]|0,this.D=$t[3]|0,this.E=$t[4]|0,this.F=$t[5]|0,this.G=$t[6]|0,this.H=$t[7]|0}get(){const{A:e,B:r,C:n,D:s,E:i,F:o,G:a,H:c}=this;return[e,r,n,s,i,o,a,c]}set(e,r,n,s,i,o,a,c){this.A=e|0,this.B=r|0,this.C=n|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,r){for(let l=0;l<16;l++,r+=4)_t[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){const d=_t[l-15],h=_t[l-2],g=ct(d,7)^ct(d,18)^d>>>3,v=ct(h,17)^ct(h,19)^h>>>10;_t[l]=v+_t[l-7]+g+_t[l-16]|0}let{A:n,B:s,C:i,D:o,E:a,F:c,G:f,H:u}=this;for(let l=0;l<64;l++){const d=ct(a,6)^ct(a,11)^ct(a,25),h=u+d+vw(a,c,f)+Xm[l]+_t[l]|0,v=(ct(n,2)^ct(n,13)^ct(n,22))+xw(n,s,i)|0;u=f,f=c,c=a,a=o+h|0,o=i,i=s,s=n,n=h+v|0}n=n+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,u=u+this.H|0,this.set(n,s,i,o,a,c,f,u)}roundClean(){_t.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const Zu=Tu(()=>new Ym);/*!
 * MIT License
 * 
 * Copyright (c) 2017-2024 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Qm="[object ArrayBuffer]";class re{static isArrayBuffer(e){return Object.prototype.toString.call(e)===Qm}static toArrayBuffer(e){return this.isArrayBuffer(e)?e:e.byteLength===e.buffer.byteLength||e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:this.toUint8Array(e.buffer).slice(e.byteOffset,e.byteOffset+e.byteLength).buffer}static toUint8Array(e){return this.toView(e,Uint8Array)}static toView(e,r){if(e.constructor===r)return e;if(this.isArrayBuffer(e))return new r(e);if(this.isArrayBufferView(e))return new r(e.buffer,e.byteOffset,e.byteLength);throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(e){return this.isArrayBufferView(e)||this.isArrayBuffer(e)}static isArrayBufferView(e){return ArrayBuffer.isView(e)||e&&this.isArrayBuffer(e.buffer)}static isEqual(e,r){const n=re.toUint8Array(e),s=re.toUint8Array(r);if(n.length!==s.byteLength)return!1;for(let i=0;i<n.length;i++)if(n[i]!==s[i])return!1;return!0}static concat(...e){let r;Array.isArray(e[0])&&!(e[1]instanceof Function)||Array.isArray(e[0])&&e[1]instanceof Function?r=e[0]:e[e.length-1]instanceof Function?r=e.slice(0,e.length-1):r=e;let n=0;for(const o of r)n+=o.byteLength;const s=new Uint8Array(n);let i=0;for(const o of r){const a=this.toUint8Array(o);s.set(a,i),i+=a.length}return e[e.length-1]instanceof Function?this.toView(s,e[e.length-1]):s.buffer}}const Gs="string",eb=/^[0-9a-f\s]+$/i,tb=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/,rb=/^[a-zA-Z0-9-_]+$/;class Ba{static fromString(e){const r=unescape(encodeURIComponent(e)),n=new Uint8Array(r.length);for(let s=0;s<r.length;s++)n[s]=r.charCodeAt(s);return n.buffer}static toString(e){const r=re.toUint8Array(e);let n="";for(let i=0;i<r.length;i++)n+=String.fromCharCode(r[i]);return decodeURIComponent(escape(n))}}class ut{static toString(e,r=!1){const n=re.toArrayBuffer(e),s=new DataView(n);let i="";for(let o=0;o<n.byteLength;o+=2){const a=s.getUint16(o,r);i+=String.fromCharCode(a)}return i}static fromString(e,r=!1){const n=new ArrayBuffer(e.length*2),s=new DataView(n);for(let i=0;i<e.length;i++)s.setUint16(i*2,e.charCodeAt(i),r);return n}}class ae{static isHex(e){return typeof e===Gs&&eb.test(e)}static isBase64(e){return typeof e===Gs&&tb.test(e)}static isBase64Url(e){return typeof e===Gs&&rb.test(e)}static ToString(e,r="utf8"){const n=re.toUint8Array(e);switch(r.toLowerCase()){case"utf8":return this.ToUtf8String(n);case"binary":return this.ToBinary(n);case"hex":return this.ToHex(n);case"base64":return this.ToBase64(n);case"base64url":return this.ToBase64Url(n);case"utf16le":return ut.toString(n,!0);case"utf16":case"utf16be":return ut.toString(n);default:throw new Error(`Unknown type of encoding '${r}'`)}}static FromString(e,r="utf8"){if(!e)return new ArrayBuffer(0);switch(r.toLowerCase()){case"utf8":return this.FromUtf8String(e);case"binary":return this.FromBinary(e);case"hex":return this.FromHex(e);case"base64":return this.FromBase64(e);case"base64url":return this.FromBase64Url(e);case"utf16le":return ut.fromString(e,!0);case"utf16":case"utf16be":return ut.fromString(e);default:throw new Error(`Unknown type of encoding '${r}'`)}}static ToBase64(e){const r=re.toUint8Array(e);if(typeof btoa<"u"){const n=this.ToString(r,"binary");return btoa(n)}else return Buffer.from(r).toString("base64")}static FromBase64(e){const r=this.formatString(e);if(!r)return new ArrayBuffer(0);if(!ae.isBase64(r))throw new TypeError("Argument 'base64Text' is not Base64 encoded");return typeof atob<"u"?this.FromBinary(atob(r)):new Uint8Array(Buffer.from(r,"base64")).buffer}static FromBase64Url(e){const r=this.formatString(e);if(!r)return new ArrayBuffer(0);if(!ae.isBase64Url(r))throw new TypeError("Argument 'base64url' is not Base64Url encoded");return this.FromBase64(this.Base64Padding(r.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(e){return this.ToBase64(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(e,r=ae.DEFAULT_UTF8_ENCODING){switch(r){case"ascii":return this.FromBinary(e);case"utf8":return Ba.fromString(e);case"utf16":case"utf16be":return ut.fromString(e);case"utf16le":case"usc2":return ut.fromString(e,!0);default:throw new Error(`Unknown type of encoding '${r}'`)}}static ToUtf8String(e,r=ae.DEFAULT_UTF8_ENCODING){switch(r){case"ascii":return this.ToBinary(e);case"utf8":return Ba.toString(e);case"utf16":case"utf16be":return ut.toString(e);case"utf16le":case"usc2":return ut.toString(e,!0);default:throw new Error(`Unknown type of encoding '${r}'`)}}static FromBinary(e){const r=e.length,n=new Uint8Array(r);for(let s=0;s<r;s++)n[s]=e.charCodeAt(s);return n.buffer}static ToBinary(e){const r=re.toUint8Array(e);let n="";for(let s=0;s<r.length;s++)n+=String.fromCharCode(r[s]);return n}static ToHex(e){const r=re.toUint8Array(e);let n="";const s=r.length;for(let i=0;i<s;i++){const o=r[i];o<16&&(n+="0"),n+=o.toString(16)}return n}static FromHex(e){let r=this.formatString(e);if(!r)return new ArrayBuffer(0);if(!ae.isHex(r))throw new TypeError("Argument 'hexString' is not HEX encoded");r.length%2&&(r=`0${r}`);const n=new Uint8Array(r.length/2);for(let s=0;s<r.length;s=s+2){const i=r.slice(s,s+2);n[s/2]=parseInt(i,16)}return n.buffer}static ToUtf16String(e,r=!1){return ut.toString(e,r)}static FromUtf16String(e,r=!1){return ut.fromString(e,r)}static Base64Padding(e){const r=4-e.length%4;if(r<4)for(let n=0;n<r;n++)e+="=";return e}static formatString(e){return(e==null?void 0:e.replace(/[\n\r\t ]/g,""))||""}}ae.DEFAULT_UTF8_ENCODING="utf8";/*!
 Copyright (c) Peculiar Ventures, LLC
*/function kr(t,e){let r=0;if(t.length===1)return t[0];for(let n=t.length-1;n>=0;n--)r+=t[t.length-1-n]*Math.pow(2,e*n);return r}function Qt(t,e,r=-1){const n=r;let s=t,i=0,o=Math.pow(2,e);for(let a=1;a<8;a++){if(t<o){let c;if(n<0)c=new ArrayBuffer(a),i=a;else{if(n<a)return new ArrayBuffer(0);c=new ArrayBuffer(n),i=n}const f=new Uint8Array(c);for(let u=a-1;u>=0;u--){const l=Math.pow(2,u*e);f[i-u-1]=Math.floor(s/l),s-=f[i-u-1]*l}return c}o*=Math.pow(2,e)}return new ArrayBuffer(0)}function wi(...t){let e=0,r=0;for(const i of t)e+=i.length;const n=new ArrayBuffer(e),s=new Uint8Array(n);for(const i of t)s.set(i,r),r+=i.length;return s}function Xu(){const t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const a=t[0]===255&&t[1]&128,c=t[0]===0&&(t[1]&128)===0;(a||c)&&this.warnings.push("Needlessly long format")}const e=new ArrayBuffer(this.valueHex.byteLength),r=new Uint8Array(e);for(let a=0;a<this.valueHex.byteLength;a++)r[a]=0;r[0]=t[0]&128;const n=kr(r,8),s=new ArrayBuffer(this.valueHex.byteLength),i=new Uint8Array(s);for(let a=0;a<this.valueHex.byteLength;a++)i[a]=t[a];return i[0]&=127,kr(i,8)-n}function nb(t){const e=t<0?t*-1:t;let r=128;for(let n=1;n<8;n++){if(e<=r){if(t<0){const o=r-e,a=Qt(o,8,n),c=new Uint8Array(a);return c[0]|=128,a}let s=Qt(e,8,n),i=new Uint8Array(s);if(i[0]&128){const o=s.slice(0),a=new Uint8Array(o);s=new ArrayBuffer(s.byteLength+1),i=new Uint8Array(s);for(let c=0;c<o.byteLength;c++)i[c+1]=a[c];i[0]=0}return s}r*=Math.pow(2,8)}return new ArrayBuffer(0)}function sb(t,e){if(t.byteLength!==e.byteLength)return!1;const r=new Uint8Array(t),n=new Uint8Array(e);for(let s=0;s<r.length;s++)if(r[s]!==n[s])return!1;return!0}function ze(t,e){const r=t.toString(10);if(e<r.length)return"";const n=e-r.length,s=new Array(n);for(let o=0;o<n;o++)s[o]="0";return s.join("").concat(r)}/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function ts(){if(typeof BigInt>"u")throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}function po(t){let e=0,r=0;for(let s=0;s<t.length;s++){const i=t[s];e+=i.byteLength}const n=new Uint8Array(e);for(let s=0;s<t.length;s++){const i=t[s];n.set(new Uint8Array(i),r),r+=i.byteLength}return n.buffer}function kt(t,e,r,n){return e instanceof Uint8Array?e.byteLength?r<0?(t.error="Wrong parameter: inputOffset less than zero",!1):n<0?(t.error="Wrong parameter: inputLength less than zero",!1):e.byteLength-r-n<0?(t.error="End of input reached before message was fully decoded (inconsistent offset and length values)",!1):!0:(t.error="Wrong parameter: inputBuffer has zero length",!1):(t.error="Wrong parameter: inputBuffer must be 'Uint8Array'",!1)}class go{constructor(){this.items=[]}write(e){this.items.push(e)}final(){return po(this.items)}}const qr=[new Uint8Array([1])],Sa="0123456789",Lr="",ot=new ArrayBuffer(0),yo=new Uint8Array(0),un="EndOfContent",Yu="OCTET STRING",Qu="BIT STRING";function It(t){var e;return e=class extends t{constructor(...n){var s;super(...n);const i=n[0]||{};this.isHexOnly=(s=i.isHexOnly)!==null&&s!==void 0?s:!1,this.valueHexView=i.valueHex?re.toUint8Array(i.valueHex):yo}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(n){this.valueHexView=new Uint8Array(n)}fromBER(n,s,i){const o=n instanceof ArrayBuffer?new Uint8Array(n):n;if(!kt(this,o,s,i))return-1;const a=s+i;return this.valueHexView=o.subarray(s,a),this.valueHexView.length?(this.blockLength=i,a):(this.warnings.push("Zero buffer length"),s)}toBER(n=!1){return this.isHexOnly?n?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer:(this.error="Flag 'isHexOnly' is not set, abort",ot)}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:ae.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class ur{constructor({blockLength:e=0,error:r=Lr,warnings:n=[],valueBeforeDecode:s=yo}={}){this.blockLength=e,this.error=r,this.warnings=n,this.valueBeforeDecodeView=re.toUint8Array(s)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(e){this.valueBeforeDecodeView=new Uint8Array(e)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:ae.ToHex(this.valueBeforeDecodeView)}}}ur.NAME="baseBlock";class He extends ur{fromBER(e,r,n){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(e,r){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}He.NAME="valueBlock";class el extends It(ur){constructor({idBlock:e={}}={}){var r,n,s,i;super(),e?(this.isHexOnly=(r=e.isHexOnly)!==null&&r!==void 0?r:!1,this.valueHexView=e.valueHex?re.toUint8Array(e.valueHex):yo,this.tagClass=(n=e.tagClass)!==null&&n!==void 0?n:-1,this.tagNumber=(s=e.tagNumber)!==null&&s!==void 0?s:-1,this.isConstructed=(i=e.isConstructed)!==null&&i!==void 0?i:!1):(this.tagClass=-1,this.tagNumber=-1,this.isConstructed=!1)}toBER(e=!1){let r=0;switch(this.tagClass){case 1:r|=0;break;case 2:r|=64;break;case 3:r|=128;break;case 4:r|=192;break;default:return this.error="Unknown tag class",ot}if(this.isConstructed&&(r|=32),this.tagNumber<31&&!this.isHexOnly){const s=new Uint8Array(1);if(!e){let i=this.tagNumber;i&=31,r|=i,s[0]=r}return s.buffer}if(!this.isHexOnly){const s=Qt(this.tagNumber,7),i=new Uint8Array(s),o=s.byteLength,a=new Uint8Array(o+1);if(a[0]=r|31,!e){for(let c=0;c<o-1;c++)a[c+1]=i[c]|128;a[o]=i[o-1]}return a.buffer}const n=new Uint8Array(this.valueHexView.byteLength+1);if(n[0]=r|31,!e){const s=this.valueHexView;for(let i=0;i<s.length-1;i++)n[i+1]=s[i]|128;n[this.valueHexView.byteLength]=s[s.length-1]}return n.buffer}fromBER(e,r,n){const s=re.toUint8Array(e);if(!kt(this,s,r,n))return-1;const i=s.subarray(r,r+n);if(i.length===0)return this.error="Zero buffer length",-1;switch(i[0]&192){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=(i[0]&32)===32,this.isHexOnly=!1;const a=i[0]&31;if(a!==31)this.tagNumber=a,this.blockLength=1;else{let c=1,f=this.valueHexView=new Uint8Array(255),u=255;for(;i[c]&128;){if(f[c-1]=i[c]&127,c++,c>=i.length)return this.error="End of input reached before message was fully decoded",-1;if(c===u){u+=255;const d=new Uint8Array(u);for(let h=0;h<f.length;h++)d[h]=f[h];f=this.valueHexView=new Uint8Array(u)}}this.blockLength=c+1,f[c-1]=i[c]&127;const l=new Uint8Array(c);for(let d=0;d<c;d++)l[d]=f[d];f=this.valueHexView=new Uint8Array(c),f.set(l),this.blockLength<=9?this.tagNumber=kr(f,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(this.tagClass===1&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return r+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}el.NAME="identificationBlock";class tl extends ur{constructor({lenBlock:e={}}={}){var r,n,s;super(),this.isIndefiniteForm=(r=e.isIndefiniteForm)!==null&&r!==void 0?r:!1,this.longFormUsed=(n=e.longFormUsed)!==null&&n!==void 0?n:!1,this.length=(s=e.length)!==null&&s!==void 0?s:0}fromBER(e,r,n){const s=re.toUint8Array(e);if(!kt(this,s,r,n))return-1;const i=s.subarray(r,r+n);if(i.length===0)return this.error="Zero buffer length",-1;if(i[0]===255)return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=i[0]===128,this.isIndefiniteForm)return this.blockLength=1,r+this.blockLength;if(this.longFormUsed=!!(i[0]&128),this.longFormUsed===!1)return this.length=i[0],this.blockLength=1,r+this.blockLength;const o=i[0]&127;if(o>8)return this.error="Too big integer",-1;if(o+1>i.length)return this.error="End of input reached before message was fully decoded",-1;const a=r+1,c=s.subarray(a,a+o);return c[o-1]===0&&this.warnings.push("Needlessly long encoded length"),this.length=kr(c,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unnecessary usage of long length form"),this.blockLength=o+1,r+this.blockLength}toBER(e=!1){let r,n;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return r=new ArrayBuffer(1),e===!1&&(n=new Uint8Array(r),n[0]=128),r;if(this.longFormUsed){const s=Qt(this.length,8);if(s.byteLength>127)return this.error="Too big length",ot;if(r=new ArrayBuffer(s.byteLength+1),e)return r;const i=new Uint8Array(s);n=new Uint8Array(r),n[0]=s.byteLength|128;for(let o=0;o<s.byteLength;o++)n[o+1]=i[o];return r}return r=new ArrayBuffer(1),e===!1&&(n=new Uint8Array(r),n[0]=this.length),r}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}tl.NAME="lengthBlock";const P={};class Pe extends ur{constructor({name:e=Lr,optional:r=!1,primitiveSchema:n,...s}={},i){super(s),this.name=e,this.optional=r,n&&(this.primitiveSchema=n),this.idBlock=new el(s),this.lenBlock=new tl(s),this.valueBlock=i?new i(s):new He(s)}fromBER(e,r,n){const s=this.valueBlock.fromBER(e,r,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return s===-1?(this.error=this.valueBlock.error,s):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),s)}toBER(e,r){const n=r||new go;r||rl(this);const s=this.idBlock.toBER(e);if(n.write(s),this.lenBlock.isIndefiniteForm)n.write(new Uint8Array([128]).buffer),this.valueBlock.toBER(e,n),n.write(new ArrayBuffer(2));else{const i=this.valueBlock.toBER(e);this.lenBlock.length=i.byteLength;const o=this.lenBlock.toBER(e);n.write(o),n.write(i)}return r?ot:n.final()}toJSON(){const e={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};return this.primitiveSchema&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}toString(e="ascii"){return e==="ascii"?this.onAsciiEncoding():ae.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${ae.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(e){if(this===e)return!0;if(!(e instanceof this.constructor))return!1;const r=this.toBER(),n=e.toBER();return sb(r,n)}}Pe.NAME="BaseBlock";function rl(t){if(t instanceof P.Constructed)for(const e of t.valueBlock.value)rl(e)&&(t.lenBlock.isIndefiniteForm=!0);return!!t.lenBlock.isIndefiniteForm}class nl extends Pe{constructor({value:e=Lr,...r}={},n){super(r,n),e&&this.fromString(e)}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}fromBER(e,r,n){const s=this.valueBlock.fromBER(e,r,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return s===-1?(this.error=this.valueBlock.error,s):(this.fromBuffer(this.valueBlock.valueHexView),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),s)}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}nl.NAME="BaseStringBlock";class sl extends It(He){constructor({isHexOnly:e=!0,...r}={}){super(r),this.isHexOnly=e}}sl.NAME="PrimitiveValueBlock";var il;class ol extends Pe{constructor(e={}){super(e,sl),this.idBlock.isConstructed=!1}}il=ol;P.Primitive=il;ol.NAME="PRIMITIVE";function ib(t,e){if(t instanceof e)return t;const r=new e;return r.idBlock=t.idBlock,r.lenBlock=t.lenBlock,r.warnings=t.warnings,r.valueBeforeDecodeView=t.valueBeforeDecodeView,r}function Es(t,e=0,r=t.length){const n=e;let s=new Pe({},He);const i=new ur;if(!kt(i,t,e,r))return s.error=i.error,{offset:-1,result:s};if(!t.subarray(e,e+r).length)return s.error="Zero buffer length",{offset:-1,result:s};let a=s.idBlock.fromBER(t,e,r);if(s.idBlock.warnings.length&&s.warnings.concat(s.idBlock.warnings),a===-1)return s.error=s.idBlock.error,{offset:-1,result:s};if(e=a,r-=s.idBlock.blockLength,a=s.lenBlock.fromBER(t,e,r),s.lenBlock.warnings.length&&s.warnings.concat(s.lenBlock.warnings),a===-1)return s.error=s.lenBlock.error,{offset:-1,result:s};if(e=a,r-=s.lenBlock.blockLength,!s.idBlock.isConstructed&&s.lenBlock.isIndefiniteForm)return s.error="Indefinite length form used for primitive encoding form",{offset:-1,result:s};let c=Pe;switch(s.idBlock.tagClass){case 1:if(s.idBlock.tagNumber>=37&&s.idBlock.isHexOnly===!1)return s.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:s};switch(s.idBlock.tagNumber){case 0:if(s.idBlock.isConstructed&&s.lenBlock.length>0)return s.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:s};c=P.EndOfContent;break;case 1:c=P.Boolean;break;case 2:c=P.Integer;break;case 3:c=P.BitString;break;case 4:c=P.OctetString;break;case 5:c=P.Null;break;case 6:c=P.ObjectIdentifier;break;case 10:c=P.Enumerated;break;case 12:c=P.Utf8String;break;case 13:c=P.RelativeObjectIdentifier;break;case 14:c=P.TIME;break;case 15:return s.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:s};case 16:c=P.Sequence;break;case 17:c=P.Set;break;case 18:c=P.NumericString;break;case 19:c=P.PrintableString;break;case 20:c=P.TeletexString;break;case 21:c=P.VideotexString;break;case 22:c=P.IA5String;break;case 23:c=P.UTCTime;break;case 24:c=P.GeneralizedTime;break;case 25:c=P.GraphicString;break;case 26:c=P.VisibleString;break;case 27:c=P.GeneralString;break;case 28:c=P.UniversalString;break;case 29:c=P.CharacterString;break;case 30:c=P.BmpString;break;case 31:c=P.DATE;break;case 32:c=P.TimeOfDay;break;case 33:c=P.DateTime;break;case 34:c=P.Duration;break;default:{const f=s.idBlock.isConstructed?new P.Constructed:new P.Primitive;f.idBlock=s.idBlock,f.lenBlock=s.lenBlock,f.warnings=s.warnings,s=f}}break;case 2:case 3:case 4:default:c=s.idBlock.isConstructed?P.Constructed:P.Primitive}return s=ib(s,c),a=s.fromBER(t,e,s.lenBlock.isIndefiniteForm?r:s.lenBlock.length),s.valueBeforeDecodeView=t.subarray(n,n+s.blockLength),{offset:a,result:s}}function ob(t){if(!t.byteLength){const e=new Pe({},He);return e.error="Input buffer has zero length",{offset:-1,result:e}}return Es(re.toUint8Array(t).slice(),0,t.byteLength)}function ab(t,e){return t?1:e}class Ft extends He{constructor({value:e=[],isIndefiniteForm:r=!1,...n}={}){super(n),this.value=e,this.isIndefiniteForm=r}fromBER(e,r,n){const s=re.toUint8Array(e);if(!kt(this,s,r,n))return-1;if(this.valueBeforeDecodeView=s.subarray(r,r+n),this.valueBeforeDecodeView.length===0)return this.warnings.push("Zero buffer length"),r;let i=r;for(;ab(this.isIndefiniteForm,n)>0;){const o=Es(s,i,n);if(o.offset===-1)return this.error=o.result.error,this.warnings.concat(o.result.warnings),-1;if(i=o.offset,this.blockLength+=o.result.blockLength,n-=o.result.blockLength,this.value.push(o.result),this.isIndefiniteForm&&o.result.constructor.NAME===un)break}return this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.NAME===un?this.value.pop():this.warnings.push("No EndOfContent block encoded")),i}toBER(e,r){const n=r||new go;for(let s=0;s<this.value.length;s++)this.value[s].toBER(e,n);return r?ot:n.final()}toJSON(){const e={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const r of this.value)e.value.push(r.toJSON());return e}}Ft.NAME="ConstructedValueBlock";var al;class Rr extends Pe{constructor(e={}){super(e,Ft),this.idBlock.isConstructed=!0}fromBER(e,r,n){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const s=this.valueBlock.fromBER(e,r,this.lenBlock.isIndefiniteForm?n:this.lenBlock.length);return s===-1?(this.error=this.valueBlock.error,s):(this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.valueBlock.error.length||(this.blockLength+=this.valueBlock.blockLength),s)}onAsciiEncoding(){const e=[];for(const n of this.valueBlock.value)e.push(n.toString("ascii").split(`
`).map(s=>`  ${s}`).join(`
`));const r=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return e.length?`${r} :
${e.join(`
`)}`:`${r} :`}}al=Rr;P.Constructed=al;Rr.NAME="CONSTRUCTED";class cl extends He{fromBER(e,r,n){return r}toBER(e){return ot}}cl.override="EndOfContentValueBlock";var ul;class ll extends Pe{constructor(e={}){super(e,cl),this.idBlock.tagClass=1,this.idBlock.tagNumber=0}}ul=ll;P.EndOfContent=ul;ll.NAME=un;var fl;class wo extends Pe{constructor(e={}){super(e,He),this.idBlock.tagClass=1,this.idBlock.tagNumber=5}fromBER(e,r,n){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),this.idBlock.error.length||(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length||(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=n,r+n>e.byteLength?(this.error="End of input reached before message was fully decoded (inconsistent offset and length values)",-1):r+n}toBER(e,r){const n=new ArrayBuffer(2);if(!e){const s=new Uint8Array(n);s[0]=5,s[1]=0}return r&&r.write(n),n}onAsciiEncoding(){return`${this.constructor.NAME}`}}fl=wo;P.Null=fl;wo.NAME="NULL";class dl extends It(He){constructor({value:e,...r}={}){super(r),r.valueHex?this.valueHexView=re.toUint8Array(r.valueHex):this.valueHexView=new Uint8Array(1),e&&(this.value=e)}get value(){for(const e of this.valueHexView)if(e>0)return!0;return!1}set value(e){this.valueHexView[0]=e?255:0}fromBER(e,r,n){const s=re.toUint8Array(e);return kt(this,s,r,n)?(this.valueHexView=s.subarray(r,r+n),n>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.isHexOnly=!0,Xu.call(this),this.blockLength=n,r+n):-1}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}dl.NAME="BooleanValueBlock";var hl;let pl=class extends Pe{constructor(e={}){super(e,dl),this.idBlock.tagClass=1,this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(e){this.valueBlock.value=e}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}};hl=pl;P.Boolean=hl;pl.NAME="BOOLEAN";class gl extends It(Ft){constructor({isConstructed:e=!1,...r}={}){super(r),this.isConstructed=e}fromBER(e,r,n){let s=0;if(this.isConstructed){if(this.isHexOnly=!1,s=Ft.prototype.fromBER.call(this,e,r,n),s===-1)return s;for(let i=0;i<this.value.length;i++){const o=this.value[i].constructor.NAME;if(o===un){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(o!==Yu)return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,s=super.fromBER(e,r,n),this.blockLength=n;return s}toBER(e,r){return this.isConstructed?Ft.prototype.toBER.call(this,e,r):e?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}gl.NAME="OctetStringValueBlock";var yl;class Bs extends Pe{constructor({idBlock:e={},lenBlock:r={},...n}={}){var s,i;(s=n.isConstructed)!==null&&s!==void 0||(n.isConstructed=!!(!((i=n.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:n.isConstructed,...e},lenBlock:{...r,isIndefiniteForm:!!n.isIndefiniteForm},...n},gl),this.idBlock.tagClass=1,this.idBlock.tagNumber=4}fromBER(e,r,n){if(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,n===0)return this.idBlock.error.length===0&&(this.blockLength+=this.idBlock.blockLength),this.lenBlock.error.length===0&&(this.blockLength+=this.lenBlock.blockLength),r;if(!this.valueBlock.isConstructed){const i=(e instanceof ArrayBuffer?new Uint8Array(e):e).subarray(r,r+n);try{if(i.byteLength){const o=Es(i,0,i.byteLength);o.offset!==-1&&o.offset===n&&(this.valueBlock.value=[o.result])}}catch{}}return super.fromBER(e,r,n)}onAsciiEncoding(){return this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length?Rr.prototype.onAsciiEncoding.call(this):`${this.constructor.NAME} : ${ae.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed)return this.valueBlock.valueHexView.slice().buffer;const e=[];for(const r of this.valueBlock.value)r instanceof Bs&&e.push(r.valueBlock.valueHexView);return re.concat(e)}}yl=Bs;P.OctetString=yl;Bs.NAME=Yu;class wl extends It(Ft){constructor({unusedBits:e=0,isConstructed:r=!1,...n}={}){super(n),this.unusedBits=e,this.isConstructed=r,this.blockLength=this.valueHexView.byteLength}fromBER(e,r,n){if(!n)return r;let s=-1;if(this.isConstructed){if(s=Ft.prototype.fromBER.call(this,e,r,n),s===-1)return s;for(const a of this.value){const c=a.constructor.NAME;if(c===un){if(this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(c!==Qu)return this.error="BIT STRING may consists of BIT STRINGs only",-1;const f=a.valueBlock;if(this.unusedBits>0&&f.unusedBits>0)return this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only',-1;this.unusedBits=f.unusedBits}return s}const i=re.toUint8Array(e);if(!kt(this,i,r,n))return-1;const o=i.subarray(r,r+n);if(this.unusedBits=o[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;if(!this.unusedBits){const a=o.subarray(1);try{if(a.byteLength){const c=Es(a,0,a.byteLength);c.offset!==-1&&c.offset===n-1&&(this.value=[c.result])}}catch{}}return this.valueHexView=o.subarray(1),this.blockLength=o.length,r+n}toBER(e,r){if(this.isConstructed)return Ft.prototype.toBER.call(this,e,r);if(e)return new ArrayBuffer(this.valueHexView.byteLength+1);if(!this.valueHexView.byteLength)return ot;const n=new Uint8Array(this.valueHexView.length+1);return n[0]=this.unusedBits,n.set(this.valueHexView,1),n.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}wl.NAME="BitStringValueBlock";var ml;class mo extends Pe{constructor({idBlock:e={},lenBlock:r={},...n}={}){var s,i;(s=n.isConstructed)!==null&&s!==void 0||(n.isConstructed=!!(!((i=n.value)===null||i===void 0)&&i.length)),super({idBlock:{isConstructed:n.isConstructed,...e},lenBlock:{...r,isIndefiniteForm:!!n.isIndefiniteForm},...n},wl),this.idBlock.tagClass=1,this.idBlock.tagNumber=3}fromBER(e,r,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,super.fromBER(e,r,n)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length)return Rr.prototype.onAsciiEncoding.call(this);{const e=[],r=this.valueBlock.valueHexView;for(const s of r)e.push(s.toString(2).padStart(8,"0"));const n=e.join("");return`${this.constructor.NAME} : ${n.substring(0,n.length-this.valueBlock.unusedBits)}`}}}ml=mo;P.BitString=ml;mo.NAME=Qu;var bl;function cb(t,e){const r=new Uint8Array([0]),n=new Uint8Array(t),s=new Uint8Array(e);let i=n.slice(0);const o=i.length-1,a=s.slice(0),c=a.length-1;let f=0;const u=c<o?o:c;let l=0;for(let d=u;d>=0;d--,l++){switch(!0){case l<a.length:f=i[o-l]+a[c-l]+r[0];break;default:f=i[o-l]+r[0]}switch(r[0]=f/10,!0){case l>=i.length:i=wi(new Uint8Array([f%10]),i);break;default:i[o-l]=f%10}}return r[0]>0&&(i=wi(r,i)),i}function Aa(t){if(t>=qr.length)for(let e=qr.length;e<=t;e++){const r=new Uint8Array([0]);let n=qr[e-1].slice(0);for(let s=n.length-1;s>=0;s--){const i=new Uint8Array([(n[s]<<1)+r[0]]);r[0]=i[0]/10,n[s]=i[0]%10}r[0]>0&&(n=wi(r,n)),qr.push(n)}return qr[t]}function ub(t,e){let r=0;const n=new Uint8Array(t),s=new Uint8Array(e),i=n.slice(0),o=i.length-1,a=s.slice(0),c=a.length-1;let f,u=0;for(let l=c;l>=0;l--,u++)switch(f=i[o-u]-a[c-u]-r,!0){case f<0:r=1,i[o-u]=f+10;break;default:r=0,i[o-u]=f}if(r>0)for(let l=o-c+1;l>=0;l--,u++)if(f=i[o-u]-r,f<0)r=1,i[o-u]=f+10;else{r=0,i[o-u]=f;break}return i.slice()}class bo extends It(He){constructor({value:e,...r}={}){super(r),this._valueDec=0,r.valueHex&&this.setValueHex(),e!==void 0&&(this.valueDec=e)}setValueHex(){this.valueHexView.length>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,this.valueHexView.length>0&&(this._valueDec=Xu.call(this)))}set valueDec(e){this._valueDec=e,this.isHexOnly=!1,this.valueHexView=new Uint8Array(nb(e))}get valueDec(){return this._valueDec}fromDER(e,r,n,s=0){const i=this.fromBER(e,r,n);if(i===-1)return i;const o=this.valueHexView;return o[0]===0&&o[1]&128?this.valueHexView=o.subarray(1):s!==0&&o.length<s&&(s-o.length>1&&(s=o.length+1),this.valueHexView=o.subarray(s-o.length)),i}toDER(e=!1){const r=this.valueHexView;switch(!0){case(r[0]&128)!==0:{const n=new Uint8Array(this.valueHexView.length+1);n[0]=0,n.set(r,1),this.valueHexView=n}break;case(r[0]===0&&(r[1]&128)===0):this.valueHexView=this.valueHexView.subarray(1);break}return this.toBER(e)}fromBER(e,r,n){const s=super.fromBER(e,r,n);return s===-1||this.setValueHex(),s}toBER(e){return e?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const e=this.valueHexView.length*8-1;let r=new Uint8Array(this.valueHexView.length*8/3),n=0,s;const i=this.valueHexView;let o="",a=!1;for(let c=i.byteLength-1;c>=0;c--){s=i[c];for(let f=0;f<8;f++){if((s&1)===1)switch(n){case e:r=ub(Aa(n),r),o="-";break;default:r=cb(r,Aa(n))}n++,s>>=1}}for(let c=0;c<r.length;c++)r[c]&&(a=!0),a&&(o+=Sa.charAt(r[c]));return a===!1&&(o+=Sa.charAt(0)),o}}bl=bo;bo.NAME="IntegerValueBlock";Object.defineProperty(bl.prototype,"valueHex",{set:function(t){this.valueHexView=new Uint8Array(t),this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}});var vl;class St extends Pe{constructor(e={}){super(e,bo),this.idBlock.tagClass=1,this.idBlock.tagNumber=2}toBigInt(){return ts(),BigInt(this.valueBlock.toString())}static fromBigInt(e){ts();const r=BigInt(e),n=new go,s=r.toString(16).replace(/^-/,""),i=new Uint8Array(ae.FromHex(s));if(r<0){const a=new Uint8Array(i.length+(i[0]&128?1:0));a[0]|=128;const f=BigInt(`0x${ae.ToHex(a)}`)+r,u=re.toUint8Array(ae.FromHex(f.toString(16)));u[0]|=128,n.write(u)}else i[0]&128&&n.write(new Uint8Array([0])),n.write(i);return new St({valueHex:n.final()})}convertToDER(){const e=new St({valueHex:this.valueBlock.valueHexView});return e.valueBlock.toDER(),e}convertFromDER(){return new St({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}vl=St;P.Integer=vl;St.NAME="INTEGER";var xl;class El extends St{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=10}}xl=El;P.Enumerated=xl;El.NAME="ENUMERATED";class mi extends It(He){constructor({valueDec:e=-1,isFirstSid:r=!1,...n}={}){super(n),this.valueDec=e,this.isFirstSid=r}fromBER(e,r,n){if(!n)return r;const s=re.toUint8Array(e);if(!kt(this,s,r,n))return-1;const i=s.subarray(r,r+n);this.valueHexView=new Uint8Array(n);for(let a=0;a<n&&(this.valueHexView[a]=i[a]&127,this.blockLength++,!!(i[a]&128));a++);const o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)o[a]=this.valueHexView[a];return this.valueHexView=o,i[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=kr(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),r+this.blockLength)}set valueBigInt(e){ts();let r=BigInt(e).toString(2);for(;r.length%7;)r="0"+r;const n=new Uint8Array(r.length/7);for(let s=0;s<n.length;s++)n[s]=parseInt(r.slice(s*7,s*7+7),2)+(s+1<n.length?128:0);this.fromBER(n.buffer,0,n.length)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const s=this.valueHexView,i=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)i[o]=s[o]|128;return i[this.blockLength-1]=s[this.blockLength-1],i.buffer}const r=Qt(this.valueDec,7);if(r.byteLength===0)return this.error="Error during encoding SID value",ot;const n=new Uint8Array(r.byteLength);if(!e){const s=new Uint8Array(r),i=r.byteLength-1;for(let o=0;o<i;o++)n[o]=s[o]|128;n[i]=s[i]}return n}toString(){let e="";if(this.isHexOnly)e=ae.ToHex(this.valueHexView);else if(this.isFirstSid){let r=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",r-=40):(e="2.",r-=80),e+=r.toString()}else e=this.valueDec.toString();return e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}mi.NAME="sidBlock";class Bl extends He{constructor({value:e=Lr,...r}={}){super(r),this.value=[],e&&this.fromString(e)}fromBER(e,r,n){let s=r;for(;n>0;){const i=new mi;if(s=i.fromBER(e,s,n),s===-1)return this.blockLength=0,this.error=i.error,s;this.value.length===0&&(i.isFirstSid=!0),this.blockLength+=i.blockLength,n-=i.blockLength,this.value.push(i)}return s}toBER(e){const r=[];for(let n=0;n<this.value.length;n++){const s=this.value[n].toBER(e);if(s.byteLength===0)return this.error=this.value[n].error,ot;r.push(s)}return po(r)}fromString(e){this.value=[];let r=0,n=0,s="",i=!1;do if(n=e.indexOf(".",r),n===-1?s=e.substring(r):s=e.substring(r,n),r=n+1,i){const o=this.value[0];let a=0;switch(o.valueDec){case 0:break;case 1:a=40;break;case 2:a=80;break;default:this.value=[];return}const c=parseInt(s,10);if(isNaN(c))return;o.valueDec=c+a,i=!1}else{const o=new mi;if(s>Number.MAX_SAFE_INTEGER){ts();const a=BigInt(s);o.valueBigInt=a}else if(o.valueDec=parseInt(s,10),isNaN(o.valueDec))return;this.value.length||(o.isFirstSid=!0,i=!0),this.value.push(o)}while(n!==-1)}toString(){let e="",r=!1;for(let n=0;n<this.value.length;n++){r=this.value[n].isHexOnly;let s=this.value[n].toString();n!==0&&(e=`${e}.`),r?(s=`{${s}}`,this.value[n].isFirstSid?e=`2.{${s} - 80}`:e+=s):e+=s}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let r=0;r<this.value.length;r++)e.sidArray.push(this.value[r].toJSON());return e}}Bl.NAME="ObjectIdentifierValueBlock";var Sl;class vo extends Pe{constructor(e={}){super(e,Bl),this.idBlock.tagClass=1,this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Sl=vo;P.ObjectIdentifier=Sl;vo.NAME="OBJECT IDENTIFIER";class bi extends It(ur){constructor({valueDec:e=0,...r}={}){super(r),this.valueDec=e}fromBER(e,r,n){if(n===0)return r;const s=re.toUint8Array(e);if(!kt(this,s,r,n))return-1;const i=s.subarray(r,r+n);this.valueHexView=new Uint8Array(n);for(let a=0;a<n&&(this.valueHexView[a]=i[a]&127,this.blockLength++,!!(i[a]&128));a++);const o=new Uint8Array(this.blockLength);for(let a=0;a<this.blockLength;a++)o[a]=this.valueHexView[a];return this.valueHexView=o,i[this.blockLength-1]&128?(this.error="End of input reached before message was fully decoded",-1):(this.valueHexView[0]===0&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=kr(this.valueHexView,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),r+this.blockLength)}toBER(e){if(this.isHexOnly){if(e)return new ArrayBuffer(this.valueHexView.byteLength);const s=this.valueHexView,i=new Uint8Array(this.blockLength);for(let o=0;o<this.blockLength-1;o++)i[o]=s[o]|128;return i[this.blockLength-1]=s[this.blockLength-1],i.buffer}const r=Qt(this.valueDec,7);if(r.byteLength===0)return this.error="Error during encoding SID value",ot;const n=new Uint8Array(r.byteLength);if(!e){const s=new Uint8Array(r),i=r.byteLength-1;for(let o=0;o<i;o++)n[o]=s[o]|128;n[i]=s[i]}return n.buffer}toString(){let e="";return this.isHexOnly?e=ae.ToHex(this.valueHexView):e=this.valueDec.toString(),e}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}bi.NAME="relativeSidBlock";class Al extends He{constructor({value:e=Lr,...r}={}){super(r),this.value=[],e&&this.fromString(e)}fromBER(e,r,n){let s=r;for(;n>0;){const i=new bi;if(s=i.fromBER(e,s,n),s===-1)return this.blockLength=0,this.error=i.error,s;this.blockLength+=i.blockLength,n-=i.blockLength,this.value.push(i)}return s}toBER(e,r){const n=[];for(let s=0;s<this.value.length;s++){const i=this.value[s].toBER(e);if(i.byteLength===0)return this.error=this.value[s].error,ot;n.push(i)}return po(n)}fromString(e){this.value=[];let r=0,n=0,s="";do{n=e.indexOf(".",r),n===-1?s=e.substring(r):s=e.substring(r,n),r=n+1;const i=new bi;if(i.valueDec=parseInt(s,10),isNaN(i.valueDec))return!0;this.value.push(i)}while(n!==-1);return!0}toString(){let e="",r=!1;for(let n=0;n<this.value.length;n++){r=this.value[n].isHexOnly;let s=this.value[n].toString();n!==0&&(e=`${e}.`),r&&(s=`{${s}}`),e+=s}return e}toJSON(){const e={...super.toJSON(),value:this.toString(),sidArray:[]};for(let r=0;r<this.value.length;r++)e.sidArray.push(this.value[r].toJSON());return e}}Al.NAME="RelativeObjectIdentifierValueBlock";var kl;class Il extends Pe{constructor(e={}){super(e,Al),this.idBlock.tagClass=1,this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(e){this.valueBlock.fromString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}kl=Il;P.RelativeObjectIdentifier=kl;Il.NAME="RelativeObjectIdentifier";var Cl;class Qr extends Rr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=16}}Cl=Qr;P.Sequence=Cl;Qr.NAME="SEQUENCE";var Tl;let Nl=class extends Rr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=17}};Tl=Nl;P.Set=Tl;Nl.NAME="SET";class Ul extends It(He){constructor({...e}={}){super(e),this.isHexOnly=!0,this.value=Lr}toJSON(){return{...super.toJSON(),value:this.value}}}Ul.NAME="StringValueBlock";class $l extends Ul{}$l.NAME="SimpleStringValueBlock";class We extends nl{constructor({...e}={}){super(e,$l)}fromBuffer(e){this.valueBlock.value=String.fromCharCode.apply(null,re.toUint8Array(e))}fromString(e){const r=e.length,n=this.valueBlock.valueHexView=new Uint8Array(r);for(let s=0;s<r;s++)n[s]=e.charCodeAt(s);this.valueBlock.value=e}}We.NAME="SIMPLE STRING";class _l extends We{fromBuffer(e){this.valueBlock.valueHexView=re.toUint8Array(e);try{this.valueBlock.value=ae.ToUtf8String(e)}catch(r){this.warnings.push(`Error during "decodeURIComponent": ${r}, using raw string`),this.valueBlock.value=ae.ToBinary(e)}}fromString(e){this.valueBlock.valueHexView=new Uint8Array(ae.FromUtf8String(e)),this.valueBlock.value=e}}_l.NAME="Utf8StringValueBlock";var Ol;class lr extends _l{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=12}}Ol=lr;P.Utf8String=Ol;lr.NAME="UTF8String";class Pl extends We{fromBuffer(e){this.valueBlock.value=ae.ToUtf16String(e),this.valueBlock.valueHexView=re.toUint8Array(e)}fromString(e){this.valueBlock.value=e,this.valueBlock.valueHexView=new Uint8Array(ae.FromUtf16String(e))}}Pl.NAME="BmpStringValueBlock";var Dl;class Ll extends Pl{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=30}}Dl=Ll;P.BmpString=Dl;Ll.NAME="BMPString";class Rl extends We{fromBuffer(e){const r=ArrayBuffer.isView(e)?e.slice().buffer:e.slice(0),n=new Uint8Array(r);for(let s=0;s<n.length;s+=4)n[s]=n[s+3],n[s+1]=n[s+2],n[s+2]=0,n[s+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(r))}fromString(e){const r=e.length,n=this.valueBlock.valueHexView=new Uint8Array(r*4);for(let s=0;s<r;s++){const i=Qt(e.charCodeAt(s),8),o=new Uint8Array(i);if(o.length>4)continue;const a=4-o.length;for(let c=o.length-1;c>=0;c--)n[s*4+c+a]=o[c]}this.valueBlock.value=e}}Rl.NAME="UniversalStringValueBlock";var Fl;class Vl extends Rl{constructor({...e}={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=28}}Fl=Vl;P.UniversalString=Fl;Vl.NAME="UniversalString";var Hl;class Ml extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=18}}Hl=Ml;P.NumericString=Hl;Ml.NAME="NumericString";var jl;class zl extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=19}}jl=zl;P.PrintableString=jl;zl.NAME="PrintableString";var Gl;class ql extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=20}}Gl=ql;P.TeletexString=Gl;ql.NAME="TeletexString";var Wl;class Kl extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=21}}Wl=Kl;P.VideotexString=Wl;Kl.NAME="VideotexString";var Jl;class Zl extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=22}}Jl=Zl;P.IA5String=Jl;Zl.NAME="IA5String";var Xl;class Yl extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=25}}Xl=Yl;P.GraphicString=Xl;Yl.NAME="GraphicString";var Ql;class xo extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=26}}Ql=xo;P.VisibleString=Ql;xo.NAME="VisibleString";var ef;class tf extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=27}}ef=tf;P.GeneralString=ef;tf.NAME="GeneralString";var rf;class nf extends We{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=29}}rf=nf;P.CharacterString=rf;nf.NAME="CharacterString";var sf;class Eo extends xo{constructor({value:e,valueDate:r,...n}={}){if(super(n),this.year=0,this.month=0,this.day=0,this.hour=0,this.minute=0,this.second=0,e){this.fromString(e),this.valueBlock.valueHexView=new Uint8Array(e.length);for(let s=0;s<e.length;s++)this.valueBlock.valueHexView[s]=e.charCodeAt(s)}r&&(this.fromDate(r),this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())),this.idBlock.tagClass=1,this.idBlock.tagNumber=23}fromBuffer(e){this.fromString(String.fromCharCode.apply(null,re.toUint8Array(e)))}toBuffer(){const e=this.toString(),r=new ArrayBuffer(e.length),n=new Uint8Array(r);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return r}fromDate(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(e){const n=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/ig.exec(e);if(n===null){this.error="Wrong input string for conversion";return}const s=parseInt(n[1],10);s>=50?this.year=1900+s:this.year=2e3+s,this.month=parseInt(n[2],10),this.day=parseInt(n[3],10),this.hour=parseInt(n[4],10),this.minute=parseInt(n[5],10),this.second=parseInt(n[6],10)}toString(e="iso"){if(e==="iso"){const r=new Array(7);return r[0]=ze(this.year<2e3?this.year-1900:this.year-2e3,2),r[1]=ze(this.month,2),r[2]=ze(this.day,2),r[3]=ze(this.hour,2),r[4]=ze(this.minute,2),r[5]=ze(this.second,2),r[6]="Z",r.join("")}return super.toString(e)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}sf=Eo;P.UTCTime=sf;Eo.NAME="UTCTime";var of;class af extends Eo{constructor(e={}){var r;super(e),(r=this.millisecond)!==null&&r!==void 0||(this.millisecond=0),this.idBlock.tagClass=1,this.idBlock.tagNumber=24}fromDate(e){super.fromDate(e),this.millisecond=e.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(e){let r=!1,n="",s="",i=0,o,a=0,c=0;if(e[e.length-1]==="Z")n=e.substring(0,e.length-1),r=!0;else{const l=new Number(e[e.length-1]);if(isNaN(l.valueOf()))throw new Error("Wrong input string for conversion");n=e}if(r){if(n.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(n.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let l=1,d=n.indexOf("+"),h="";if(d===-1&&(d=n.indexOf("-"),l=-1),d!==-1){if(h=n.substring(d+1),n=n.substring(0,d),h.length!==2&&h.length!==4)throw new Error("Wrong input string for conversion");let g=parseInt(h.substring(0,2),10);if(isNaN(g.valueOf()))throw new Error("Wrong input string for conversion");if(a=l*g,h.length===4){if(g=parseInt(h.substring(2,4),10),isNaN(g.valueOf()))throw new Error("Wrong input string for conversion");c=l*g}}}let f=n.indexOf(".");if(f===-1&&(f=n.indexOf(",")),f!==-1){const l=new Number(`0${n.substring(f)}`);if(isNaN(l.valueOf()))throw new Error("Wrong input string for conversion");i=l.valueOf(),s=n.substring(0,f)}else s=n;switch(!0){case s.length===8:if(o=/(\d{4})(\d{2})(\d{2})/ig,f!==-1)throw new Error("Wrong input string for conversion");break;case s.length===10:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/ig,f!==-1){let l=60*i;this.minute=Math.floor(l),l=60*(l-this.minute),this.second=Math.floor(l),l=1e3*(l-this.second),this.millisecond=Math.floor(l)}break;case s.length===12:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/ig,f!==-1){let l=60*i;this.second=Math.floor(l),l=1e3*(l-this.second),this.millisecond=Math.floor(l)}break;case s.length===14:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/ig,f!==-1){const l=1e3*i;this.millisecond=Math.floor(l)}break;default:throw new Error("Wrong input string for conversion")}const u=o.exec(s);if(u===null)throw new Error("Wrong input string for conversion");for(let l=1;l<u.length;l++)switch(l){case 1:this.year=parseInt(u[l],10);break;case 2:this.month=parseInt(u[l],10);break;case 3:this.day=parseInt(u[l],10);break;case 4:this.hour=parseInt(u[l],10)+a;break;case 5:this.minute=parseInt(u[l],10)+c;break;case 6:this.second=parseInt(u[l],10);break;default:throw new Error("Wrong input string for conversion")}if(r===!1){const l=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=l.getUTCFullYear(),this.month=l.getUTCMonth(),this.day=l.getUTCDay(),this.hour=l.getUTCHours(),this.minute=l.getUTCMinutes(),this.second=l.getUTCSeconds(),this.millisecond=l.getUTCMilliseconds()}}toString(e="iso"){if(e==="iso"){const r=[];return r.push(ze(this.year,4)),r.push(ze(this.month,2)),r.push(ze(this.day,2)),r.push(ze(this.hour,2)),r.push(ze(this.minute,2)),r.push(ze(this.second,2)),this.millisecond!==0&&(r.push("."),r.push(ze(this.millisecond,3))),r.push("Z"),r.join("")}return super.toString(e)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}of=af;P.GeneralizedTime=of;af.NAME="GeneralizedTime";var cf;class uf extends lr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=31}}cf=uf;P.DATE=cf;uf.NAME="DATE";var lf;class ff extends lr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=32}}lf=ff;P.TimeOfDay=lf;ff.NAME="TimeOfDay";var df;class hf extends lr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=33}}df=hf;P.DateTime=df;hf.NAME="DateTime";var pf;class gf extends lr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=34}}pf=gf;P.Duration=pf;gf.NAME="Duration";var yf;class wf extends lr{constructor(e={}){super(e),this.idBlock.tagClass=1,this.idBlock.tagNumber=14}}yf=wf;P.TIME=yf;wf.NAME="TIME";class ka extends Error{constructor(e="An error occurred while verifying a message"){super(e),this.name="VerificationError"}}class lb extends Error{constructor(e="Missing Web Crypto API"){super(e),this.name="WebCryptoMissingError"}}const Ia={get(t=globalThis){const e=t.crypto;if((e==null?void 0:e.subtle)==null)throw new lb("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return e}};async function fb(t,e,r){const n=await Ia.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return Ia.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r instanceof Uint8Array?r:r.subarray())}function db(t){if(t.kty!=="RSA")throw new Ze("invalid key type");if(t.n==null)throw new Ze("invalid key modulus");return it(t.n,"base64url").length*8}class hb{constructor(e,r){m(this,"type","RSA");m(this,"_key");m(this,"_raw");m(this,"_multihash");this._key=e,this._multihash=r}get raw(){return this._raw==null&&(this._raw=wb(this._key)),this._raw}toMultihash(){return this._multihash}toCID(){return M.createV1(114,this._multihash)}toString(){return xe.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:br(this.raw,e.raw)}verify(e,r){return fb(this._key,r,e)}}const pb=8192,gb=18;function yb(t){const{result:e}=ob(t),r=e.valueBlock.value[1].valueBlock.value[0].valueBlock.value;return{kty:"RSA",n:Ca(r[0]),e:Ca(r[1])}}function wb(t){if(t.n==null||t.e==null)throw new Ze("JWK was missing components");const r=new Qr({value:[new Qr({value:[new vo({value:"1.2.840.113549.1.1.1"}),new wo]}),new mo({valueHex:new Qr({value:[St.fromBigInt(Ta(it(t.n,"base64url"))),St.fromBigInt(Ta(it(t.e,"base64url")))]}).toBER()})]}).toBER();return new Uint8Array(r,0,r.byteLength)}function Ca(t){let e=t.valueBlock.valueHexView;for(;e[0]===0;)e=e.subarray(1);return me(e,"base64url")}function Ta(t){const e=[];return t.forEach(function(r){let n=r.toString(16);n.length%2>0&&(n=`0${n}`),e.push(n)}),BigInt("0x"+e.join(""))}function mb(t){const e=yb(t);if(db(e)>pb)throw new no("Key size is too large");const r=Zu(Ar.encode({Type:Oe.RSA,Data:t})),n=rn(gb,r);return new hb(e,n)}class mf extends Cu{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,gw(e);const n=oo(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(n.length>s?e.create().update(n).digest():n);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),i.fill(0)}update(e){return Qn(this),this.iHash.update(e),this}digestInto(e){Qn(this),ws(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const bf=(t,e,r)=>new mf(t,e).update(r).digest();bf.create=(t,e)=>new mf(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Na(t){t.lowS!==void 0&&Bt("lowS",t.lowS),t.prehash!==void 0&&Bt("prehash",t.prehash)}function bb(t){const e=uo(t);Dr(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:s}=e;if(r){if(!n.eql(s,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:vb,hexToBytes:xb}=rm;class Eb extends Error{constructor(e=""){super(e)}}const vt={Err:Eb,_tlv:{encode:(t,e)=>{const{Err:r}=vt;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length&1)throw new r("tlv.encode: unpadded data");const n=e.length/2,s=hr(n);if(s.length/2&128)throw new r("tlv.encode: long form length too big");const i=n>127?hr(s.length/2|128):"";return hr(t)+i+s+e},decode(t,e){const{Err:r}=vt;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const s=e[n++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");const f=e.subarray(n,n+c);if(f.length!==c)throw new r("tlv.decode: length bytes not complete");if(f[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(const u of f)o=o<<8|u;if(n+=c,o<128)throw new r("tlv.decode(long): not minimal encoding")}const a=e.subarray(n,n+o);if(a.length!==o)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+o)}}},_int:{encode(t){const{Err:e}=vt;if(t<Et)throw new e("integer: negative integers are not allowed");let r=hr(t);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=vt;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return vb(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=vt,s=typeof t=="string"?xb(t):t;bn(s);const{v:i,l:o}=n.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=n.decode(2,i),{v:f,l:u}=n.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(f)}},hexFromSig(t){const{_tlv:e,_int:r}=vt,n=e.encode(2,r.encode(t.r)),s=e.encode(2,r.encode(t.s)),i=n+s;return e.encode(48,i)}},Et=BigInt(0),ye=BigInt(1);BigInt(2);const Ua=BigInt(3);BigInt(4);function Bb(t){const e=bb(t),{Fp:r}=e,n=xs(e.n,e.nBitLength),s=e.toBytes||((v,p,y)=>{const E=p.toAffine();return Yt(Uint8Array.from([4]),r.toBytes(E.x),r.toBytes(E.y))}),i=e.fromBytes||(v=>{const p=v.subarray(1),y=r.fromBytes(p.subarray(0,r.BYTES)),E=r.fromBytes(p.subarray(r.BYTES,2*r.BYTES));return{x:y,y:E}});function o(v){const{a:p,b:y}=e,E=r.sqr(v),b=r.mul(E,v);return r.add(r.add(b,r.mul(v,p)),y)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function a(v){return vs(v,ye,e.n)}function c(v){const{allowedPrivateKeyLengths:p,nByteLength:y,wrapPrivateKey:E,n:b}=e;if(p&&typeof v!="bigint"){if(Zt(v)&&(v=Xt(v)),typeof v!="string"||!p.includes(v.length))throw new Error("invalid private key");v=v.padStart(y*2,"0")}let B;try{B=typeof v=="bigint"?v:qt(le("private key",v,y))}catch{throw new Error("invalid private key, expected hex or "+y+" bytes, got "+typeof v)}return E&&(B=se(B,b)),Je("private key",B,ye,b),B}function f(v){if(!(v instanceof d))throw new Error("ProjectivePoint expected")}const u=cn((v,p)=>{const{px:y,py:E,pz:b}=v;if(r.eql(b,r.ONE))return{x:y,y:E};const B=v.is0();p==null&&(p=B?r.ONE:r.inv(b));const N=r.mul(y,p),A=r.mul(E,p),k=r.mul(b,p);if(B)return{x:r.ZERO,y:r.ZERO};if(!r.eql(k,r.ONE))throw new Error("invZ was invalid");return{x:N,y:A}}),l=cn(v=>{if(v.is0()){if(e.allowInfinityPoint&&!r.is0(v.py))return;throw new Error("bad point: ZERO")}const{x:p,y}=v.toAffine();if(!r.isValid(p)||!r.isValid(y))throw new Error("bad point: x or y not FE");const E=r.sqr(y),b=o(p);if(!r.eql(E,b))throw new Error("bad point: equation left != right");if(!v.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class d{constructor(p,y,E){if(this.px=p,this.py=y,this.pz=E,p==null||!r.isValid(p))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(E==null||!r.isValid(E))throw new Error("z required");Object.freeze(this)}static fromAffine(p){const{x:y,y:E}=p||{};if(!p||!r.isValid(y)||!r.isValid(E))throw new Error("invalid affine point");if(p instanceof d)throw new Error("projective point not allowed");const b=B=>r.eql(B,r.ZERO);return b(y)&&b(E)?d.ZERO:new d(y,E,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(p){const y=r.invertBatch(p.map(E=>E.pz));return p.map((E,b)=>E.toAffine(y[b])).map(d.fromAffine)}static fromHex(p){const y=d.fromAffine(i(le("pointHex",p)));return y.assertValidity(),y}static fromPrivateKey(p){return d.BASE.multiply(c(p))}static msm(p,y){return Hu(d,n,p,y)}_setWindowSize(p){g.setWindowSize(this,p)}assertValidity(){l(this)}hasEvenY(){const{y:p}=this.toAffine();if(r.isOdd)return!r.isOdd(p);throw new Error("Field doesn't support isOdd")}equals(p){f(p);const{px:y,py:E,pz:b}=this,{px:B,py:N,pz:A}=p,k=r.eql(r.mul(y,A),r.mul(B,b)),I=r.eql(r.mul(E,A),r.mul(N,b));return k&&I}negate(){return new d(this.px,r.neg(this.py),this.pz)}double(){const{a:p,b:y}=e,E=r.mul(y,Ua),{px:b,py:B,pz:N}=this;let A=r.ZERO,k=r.ZERO,I=r.ZERO,C=r.mul(b,b),R=r.mul(B,B),V=r.mul(N,N),F=r.mul(b,B);return F=r.add(F,F),I=r.mul(b,N),I=r.add(I,I),A=r.mul(p,I),k=r.mul(E,V),k=r.add(A,k),A=r.sub(R,k),k=r.add(R,k),k=r.mul(A,k),A=r.mul(F,A),I=r.mul(E,I),V=r.mul(p,V),F=r.sub(C,V),F=r.mul(p,F),F=r.add(F,I),I=r.add(C,C),C=r.add(I,C),C=r.add(C,V),C=r.mul(C,F),k=r.add(k,C),V=r.mul(B,N),V=r.add(V,V),C=r.mul(V,F),A=r.sub(A,C),I=r.mul(V,R),I=r.add(I,I),I=r.add(I,I),new d(A,k,I)}add(p){f(p);const{px:y,py:E,pz:b}=this,{px:B,py:N,pz:A}=p;let k=r.ZERO,I=r.ZERO,C=r.ZERO;const R=e.a,V=r.mul(e.b,Ua);let F=r.mul(y,B),Y=r.mul(E,N),O=r.mul(b,A),D=r.add(y,E),S=r.add(B,N);D=r.mul(D,S),S=r.add(F,Y),D=r.sub(D,S),S=r.add(y,b);let x=r.add(B,A);return S=r.mul(S,x),x=r.add(F,O),S=r.sub(S,x),x=r.add(E,b),k=r.add(N,A),x=r.mul(x,k),k=r.add(Y,O),x=r.sub(x,k),C=r.mul(R,S),k=r.mul(V,O),C=r.add(k,C),k=r.sub(Y,C),C=r.add(Y,C),I=r.mul(k,C),Y=r.add(F,F),Y=r.add(Y,F),O=r.mul(R,O),S=r.mul(V,S),Y=r.add(Y,O),O=r.sub(F,O),O=r.mul(R,O),S=r.add(S,O),F=r.mul(Y,S),I=r.add(I,F),F=r.mul(x,S),k=r.mul(D,k),k=r.sub(k,F),F=r.mul(D,Y),C=r.mul(x,C),C=r.add(C,F),new d(k,I,C)}subtract(p){return this.add(p.negate())}is0(){return this.equals(d.ZERO)}wNAF(p){return g.wNAFCached(this,p,d.normalizeZ)}multiplyUnsafe(p){const{endo:y,n:E}=e;Je("scalar",p,Et,E);const b=d.ZERO;if(p===Et)return b;if(this.is0()||p===ye)return this;if(!y||g.hasPrecomputes(this))return g.wNAFCachedUnsafe(this,p,d.normalizeZ);let{k1neg:B,k1:N,k2neg:A,k2:k}=y.splitScalar(p),I=b,C=b,R=this;for(;N>Et||k>Et;)N&ye&&(I=I.add(R)),k&ye&&(C=C.add(R)),R=R.double(),N>>=ye,k>>=ye;return B&&(I=I.negate()),A&&(C=C.negate()),C=new d(r.mul(C.px,y.beta),C.py,C.pz),I.add(C)}multiply(p){const{endo:y,n:E}=e;Je("scalar",p,ye,E);let b,B;if(y){const{k1neg:N,k1:A,k2neg:k,k2:I}=y.splitScalar(p);let{p:C,f:R}=this.wNAF(A),{p:V,f:F}=this.wNAF(I);C=g.constTimeNegate(N,C),V=g.constTimeNegate(k,V),V=new d(r.mul(V.px,y.beta),V.py,V.pz),b=C.add(V),B=R.add(F)}else{const{p:N,f:A}=this.wNAF(p);b=N,B=A}return d.normalizeZ([b,B])[0]}multiplyAndAddUnsafe(p,y,E){const b=d.BASE,B=(A,k)=>k===Et||k===ye||!A.equals(b)?A.multiplyUnsafe(k):A.multiply(k),N=B(this,y).add(B(p,E));return N.is0()?void 0:N}toAffine(p){return u(this,p)}isTorsionFree(){const{h:p,isTorsionFree:y}=e;if(p===ye)return!0;if(y)return y(d,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:p,clearCofactor:y}=e;return p===ye?this:y?y(d,this):this.multiplyUnsafe(e.h)}toRawBytes(p=!0){return Bt("isCompressed",p),this.assertValidity(),s(d,this,p)}toHex(p=!0){return Bt("isCompressed",p),Xt(this.toRawBytes(p))}}d.BASE=new d(e.Gx,e.Gy,r.ONE),d.ZERO=new d(r.ZERO,r.ONE,r.ZERO);const h=e.nBitLength,g=Vu(d,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:d,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:a}}function Sb(t){const e=uo(t);return Dr(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Ab(t){const e=Sb(t),{Fp:r,n}=e,s=r.BYTES+1,i=2*r.BYTES+1;function o(O){return se(O,n)}function a(O){return pi(O,n)}const{ProjectivePoint:c,normPrivateKeyToScalar:f,weierstrassEquation:u,isWithinCurveOrder:l}=Bb({...e,toBytes(O,D,S){const x=D.toAffine(),U=r.toBytes(x.x),L=Yt;return Bt("isCompressed",S),S?L(Uint8Array.from([D.hasEvenY()?2:3]),U):L(Uint8Array.from([4]),U,r.toBytes(x.y))},fromBytes(O){const D=O.length,S=O[0],x=O.subarray(1);if(D===s&&(S===2||S===3)){const U=qt(x);if(!vs(U,ye,r.ORDER))throw new Error("Point is not on curve");const L=u(U);let j;try{j=r.sqrt(L)}catch(Z){const G=Z instanceof Error?": "+Z.message:"";throw new Error("Point is not on curve"+G)}const z=(j&ye)===ye;return(S&1)===1!==z&&(j=r.neg(j)),{x:U,y:j}}else if(D===i&&S===4){const U=r.fromBytes(x.subarray(0,r.BYTES)),L=r.fromBytes(x.subarray(r.BYTES,2*r.BYTES));return{x:U,y:L}}else{const U=s,L=i;throw new Error("invalid Point, expected length of "+U+", or uncompressed "+L+", got "+D)}}}),d=O=>Xt(Sr(O,e.nByteLength));function h(O){const D=n>>ye;return O>D}function g(O){return h(O)?o(-O):O}const v=(O,D,S)=>qt(O.slice(D,S));class p{constructor(D,S,x){this.r=D,this.s=S,this.recovery=x,this.assertValidity()}static fromCompact(D){const S=e.nByteLength;return D=le("compactSignature",D,S*2),new p(v(D,0,S),v(D,S,2*S))}static fromDER(D){const{r:S,s:x}=vt.toSig(le("DER",D));return new p(S,x)}assertValidity(){Je("r",this.r,ye,n),Je("s",this.s,ye,n)}addRecoveryBit(D){return new p(this.r,this.s,D)}recoverPublicKey(D){const{r:S,s:x,recovery:U}=this,L=A(le("msgHash",D));if(U==null||![0,1,2,3].includes(U))throw new Error("recovery id invalid");const j=U===2||U===3?S+e.n:S;if(j>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const z=U&1?"03":"02",K=c.fromHex(z+d(j)),Z=a(j),G=o(-L*Z),te=o(x*Z),ne=c.BASE.multiplyAndAddUnsafe(K,G,te);if(!ne)throw new Error("point at infinify");return ne.assertValidity(),ne}hasHighS(){return h(this.s)}normalizeS(){return this.hasHighS()?new p(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return Br(this.toDERHex())}toDERHex(){return vt.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Br(this.toCompactHex())}toCompactHex(){return d(this.r)+d(this.s)}}const y={isValidPrivateKey(O){try{return f(O),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const O=Lu(e.n);return dm(e.randomBytes(O),e.n)},precompute(O=8,D=c.BASE){return D._setWindowSize(O),D.multiply(BigInt(3)),D}};function E(O,D=!0){return c.fromPrivateKey(O).toRawBytes(D)}function b(O){const D=Zt(O),S=typeof O=="string",x=(D||S)&&O.length;return D?x===s||x===i:S?x===2*s||x===2*i:O instanceof c}function B(O,D,S=!0){if(b(O))throw new Error("first arg must be private key");if(!b(D))throw new Error("second arg must be public key");return c.fromHex(D).multiply(f(O)).toRawBytes(S)}const N=e.bits2int||function(O){if(O.length>8192)throw new Error("input is too large");const D=qt(O),S=O.length*8-e.nBitLength;return S>0?D>>BigInt(S):D},A=e.bits2int_modN||function(O){return o(N(O))},k=co(e.nBitLength);function I(O){return Je("num < 2^"+e.nBitLength,O,Et,k),Sr(O,e.nByteLength)}function C(O,D,S=R){if(["recovered","canonical"].some(ge=>ge in S))throw new Error("sign() legacy options not supported");const{hash:x,randomBytes:U}=e;let{lowS:L,prehash:j,extraEntropy:z}=S;L==null&&(L=!0),O=le("msgHash",O),Na(S),j&&(O=le("prehashed msgHash",x(O)));const K=A(O),Z=f(D),G=[I(Z),I(K)];if(z!=null&&z!==!1){const ge=z===!0?U(r.BYTES):z;G.push(le("extraEntropy",ge))}const te=Yt(...G),ne=K;function pe(ge){const be=N(ge);if(!l(be))return;const Ae=a(be),De=c.BASE.multiply(be).toAffine(),Ue=o(De.x);if(Ue===Et)return;const at=o(Ae*o(ne+Ue*Z));if(at===Et)return;let Ct=(De.x===Ue?0:2)|Number(De.y&ye),gt=at;return L&&h(at)&&(gt=g(at),Ct^=1),new p(Ue,gt,Ct)}return{seed:te,k2sig:pe}}const R={lowS:e.lowS,prehash:!1},V={lowS:e.lowS,prehash:!1};function F(O,D,S=R){const{seed:x,k2sig:U}=C(O,D,S),L=e;return Ou(L.hash.outputLen,L.nByteLength,L.hmac)(x,U)}c.BASE._setWindowSize(8);function Y(O,D,S,x=V){var Ct;const U=O;D=le("msgHash",D),S=le("publicKey",S);const{lowS:L,prehash:j,format:z}=x;if(Na(x),"strict"in x)throw new Error("options.strict was renamed to lowS");if(z!==void 0&&z!=="compact"&&z!=="der")throw new Error("format must be compact or der");const K=typeof U=="string"||Zt(U),Z=!K&&!z&&typeof U=="object"&&U!==null&&typeof U.r=="bigint"&&typeof U.s=="bigint";if(!K&&!Z)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let G,te;try{if(Z&&(G=new p(U.r,U.s)),K){try{z!=="compact"&&(G=p.fromDER(U))}catch(gt){if(!(gt instanceof vt.Err))throw gt}!G&&z!=="der"&&(G=p.fromCompact(U))}te=c.fromHex(S)}catch{return!1}if(!G||L&&G.hasHighS())return!1;j&&(D=e.hash(D));const{r:ne,s:pe}=G,ge=A(D),be=a(pe),Ae=o(ge*be),De=o(ne*be),Ue=(Ct=c.BASE.multiplyAndAddUnsafe(te,Ae,De))==null?void 0:Ct.toAffine();return Ue?o(Ue.x)===ne:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:B,sign:F,verify:Y,ProjectivePoint:c,Signature:p,utils:y}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function kb(t){return{hash:t,hmac:(e,...r)=>bf(t,e,mw(...r)),randomBytes:Nu}}function Ib(t,e){const r=n=>Ab({...t,...kb(n)});return{...r(e),create:r}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vf=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),$a=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Cb=BigInt(1),vi=BigInt(2),_a=(t,e)=>(t+e/vi)/e;function Tb(t){const e=vf,r=BigInt(3),n=BigInt(6),s=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),c=BigInt(88),f=t*t*t%e,u=f*f*t%e,l=oe(u,r,e)*u%e,d=oe(l,r,e)*u%e,h=oe(d,vi,e)*f%e,g=oe(h,s,e)*h%e,v=oe(g,i,e)*g%e,p=oe(v,a,e)*v%e,y=oe(p,c,e)*p%e,E=oe(y,a,e)*v%e,b=oe(E,r,e)*u%e,B=oe(b,o,e)*g%e,N=oe(B,n,e)*f%e,A=oe(N,vi,e);if(!xi.eql(xi.sqr(A),t))throw new Error("Cannot find square root");return A}const xi=xs(vf,void 0,void 0,{sqrt:Tb}),ln=Ib({a:BigInt(0),b:BigInt(7),Fp:xi,n:$a,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=$a,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-Cb*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),s=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=r,o=BigInt("0x100000000000000000000000000000000"),a=_a(i*t,e),c=_a(-n*t,e);let f=se(t-a*r-c*s,e),u=se(-a*n-c*i,e);const l=f>o,d=u>o;if(l&&(f=e-f),d&&(u=e-u),f>o||u>o)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:f,k2neg:d,k2:u}}}},Zu);BigInt(0);ln.ProjectivePoint;function Nb(t){return t==null?!1:typeof t.then=="function"&&typeof t.catch=="function"&&typeof t.finally=="function"}function Ub(t,e,r){const n=Di.digest(r instanceof Uint8Array?r:r.subarray());if(Nb(n))return n.then(({digest:s})=>ln.verify(e,s,t)).catch(s=>{throw new ka(String(s))});try{return ln.verify(e,n.digest,t)}catch(s){throw new ka(String(s))}}class $b{constructor(e){m(this,"type","secp256k1");m(this,"raw");m(this,"_key");this._key=Ob(e),this.raw=_b(this._key)}toMultihash(){return Kt.digest(Ef(this))}toCID(){return M.createV1(114,this.toMultihash())}toString(){return xe.encode(this.toMultihash().bytes).substring(1)}equals(e){return e==null||!(e.raw instanceof Uint8Array)?!1:br(this.raw,e.raw)}verify(e,r){return Ub(this._key,r,e)}}function xf(t){return new $b(t)}function _b(t){return ln.ProjectivePoint.fromHex(t).toRawBytes(!0)}function Ob(t){try{return ln.ProjectivePoint.fromHex(t),t}catch(e){throw new no(String(e))}}function Pb(t){const{Type:e,Data:r}=Ar.decode(t),n=r??new Uint8Array;switch(e){case Oe.RSA:return mb(n);case Oe.Ed25519:return ju(n);case Oe.secp256k1:return xf(n);default:throw new so}}function Db(t){const{Type:e,Data:r}=Ar.decode(t.digest),n=r??new Uint8Array;switch(e){case Oe.Ed25519:return ju(n);case Oe.secp256k1:return xf(n);default:throw new so}}function Ef(t){return Ar.encode({Type:Oe[t.type],Data:t.raw})}const Bf=Symbol.for("nodejs.util.inspect.custom"),Lb=114;var gc;class Bo{constructor(e){m(this,"type");m(this,"multihash");m(this,"publicKey");m(this,"string");m(this,gc,!0);this.type=e.type,this.multihash=e.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}toString(){return this.string==null&&(this.string=xe.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return M.createV1(Lb,this.multihash)}toJSON(){return this.toString()}equals(e){var r;if(e==null)return!1;if(e instanceof Uint8Array)return br(this.multihash.bytes,e);if(typeof e=="string")return this.toString()===e;if(((r=e==null?void 0:e.toMultihash())==null?void 0:r.bytes)!=null)return br(this.multihash.bytes,e.toMultihash().bytes);throw new Error("not valid Id")}[(gc=Bu,Bf)](){return`PeerId(${this.toString()})`}}class Rb extends Bo{constructor(r){super({...r,type:"RSA"});m(this,"type","RSA");m(this,"publicKey");this.publicKey=r.publicKey}}class Fb extends Bo{constructor(r){super({...r,type:"Ed25519"});m(this,"type","Ed25519");m(this,"publicKey");this.publicKey=r.publicKey}}class Vb extends Bo{constructor(r){super({...r,type:"secp256k1"});m(this,"type","secp256k1");m(this,"publicKey");this.publicKey=r.publicKey}}const Hb=2336;var yc,wc;class Mb{constructor(e){m(this,"type","url");m(this,"multihash");m(this,"publicKey");m(this,"url");m(this,yc,!0);this.url=e.toString(),this.multihash=Kt.digest(it(this.url))}[(wc=Bf,yc=Bu,wc)](){return`PeerId(${this.url})`}toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return M.createV1(Hb,this.toMultihash())}toJSON(){return this.toString()}equals(e){return e==null?!1:(e instanceof Uint8Array&&(e=me(e)),e.toString()===this.toString())}}function je(t,e){let r;if(t.charAt(0)==="1"||t.charAt(0)==="Q")r=Oi(xe.decode(`z${t}`));else throw new Ze('Please pass a multibase decoder for strings that do not start with "1" or "Q"');return jb(r)}function jb(t){if(Gb(t))return new Rb({multihash:t});if(zb(t))try{const e=Db(t);if(e.type==="Ed25519")return new Fb({multihash:t,publicKey:e});if(e.type==="secp256k1")return new Vb({multihash:t,publicKey:e})}catch{const r=me(t.digest);return new Mb(new URL(r))}throw new Su("Supplied PeerID Multihash is invalid")}function zb(t){return t.code===Kt.code}function Gb(t){return t.code===Di.code}function Sf(t){return async function(r={}){const n=await t.post("bitswap/stat",{searchParams:T(r),signal:r.signal,headers:r.headers});return qb(await n.json())}}function qb(t){return{provideBufLen:t.ProvideBufLen,wantlist:(t.Wantlist??[]).map(e=>M.parse(e["/"])),peers:(t.Peers??[]).map(e=>je(e)),blocksReceived:BigInt(t.BlocksReceived),dataReceived:BigInt(t.DataReceived),blocksSent:BigInt(t.BlocksSent),dataSent:BigInt(t.DataSent),dupBlksReceived:BigInt(t.DupBlksReceived),dupDataReceived:BigInt(t.DupDataReceived)}}function Wb(t){return async function(r,n={}){return((await(await t.post("bitswap/wantlist",{signal:n.signal,searchParams:T({...n,peer:r.toString()}),headers:n.headers})).json()).Keys??[]).map(i=>M.parse(i["/"]))}}function Kb(t){return async function(r={}){return((await(await t.post("bitswap/wantlist",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()).Keys??[]).map(s=>M.parse(s["/"]))}}function Jb(t){return{wantlist:Kb(t),wantlistForPeer:Wb(t),stat:Sf(t)}}function Af(t){return async function(r,n={}){const s=await t.post("block/get",{signal:n.signal,searchParams:T({arg:r.toString(),...n}),headers:n.headers});return new Uint8Array(await s.arrayBuffer())}}function Zb(t){return async function e(r,n={}){const s=new AbortController,i=At([s.signal,n.signal]);let o;try{o=await(await t.post("block/put",{signal:i,searchParams:T(n),...await Mt([r],s,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return await e(r,{...n,format:"protobuf"});if(n.format==="dag-cbor")return await e(r,{...n,format:"cbor"});throw a}finally{i.clear()}return M.parse(o.Key)}}function Xb(t){return async function*(r,n={}){Array.isArray(r)||(r=[r]);const s=await t.post("block/rm",{signal:n.signal,searchParams:T({arg:r.map(i=>i.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(const i of s.ndjson())yield Yb(i)}}function Yb(t){const e={cid:M.parse(t.Hash)};return t.Error!=null&&(e.error=new Error(t.Error)),e}function Qb(t){return async function(r,n={}){const i=await(await t.post("block/stat",{signal:n.signal,searchParams:T({arg:r.toString(),...n}),headers:n.headers})).json();return{cid:M.parse(i.Key),size:i.Size}}}function e1(t){return{get:Af(t),put:Zb(t),rm:Xb(t),stat:Qb(t)}}function t1(t){return async function(r,n={}){const s=await t.post("bootstrap/add",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers}),{Peers:i}=await s.json();return{Peers:i.map(o=>Ve(o))}}}function r1(t){return async function(r={}){const n=await t.post("bootstrap/list",{signal:r.signal,searchParams:T(r),headers:r.headers}),{Peers:s}=await n.json();return{Peers:s.map(i=>Ve(i))}}}function n1(t){return async function(r,n={}){const s=await t.post("bootstrap/rm",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers}),{Peers:i}=await s.json();return{Peers:i.map(o=>Ve(o))}}}function s1(t){return{add:t1(t),list:r1(t),rm:n1(t)}}function i1(t){return async function*(r,n={}){yield*(await t.post("cat",{signal:n.signal,searchParams:T({arg:r.toString(),...n}),headers:n.headers})).iterator()}}function o1(t){return async function(r={}){return(await t.post("commands",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()}}function a1(t){return async function(r={}){return await(await t.post("config/show",{signal:r.signal,searchParams:T({...r}),headers:r.headers})).json()}}function c1(t){return async function(r,n={}){if(r==null)throw new Error("key argument is required");return(await(await t.post("config",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).json()).Value}}function u1(t){return async function(r,n={}){const i=await(await t.post("config/profile/apply",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).json();return{original:i.OldCfg,updated:i.NewCfg}}}function l1(t){return{apply:u1(t)}}function f1(t){return async function(r,n={}){const s=new AbortController,i=At([s.signal,n.signal]);try{await(await t.post("config/replace",{signal:i,searchParams:T(n),...await Mt([it(JSON.stringify(r))],s,n.headers)})).text()}finally{i.clear()}}}function d1(t){return async function(r,n,s={}){if(typeof r!="string")throw new Error("Invalid key type");const i={...s,...h1(r,n)};await(await t.post("config",{signal:s.signal,searchParams:T(i),headers:s.headers})).text()}}function h1(t,e){switch(typeof e){case"boolean":return{arg:[t,e.toString()],bool:!0};case"string":return{arg:[t,e]};default:return{arg:[t,JSON.stringify(e)],json:!0}}}function p1(t){return{getAll:a1(t),get:c1(t),set:d1(t),replace:f1(t),profiles:l1(t)}}function g1(t){return async function*(r,n={}){yield*(await t.post("dag/export",{signal:n.signal,searchParams:T({arg:r.toString()}),headers:n.headers})).iterator()}}function y1(t){return t[Symbol.asyncIterator]!=null}function w1(t){if(y1(t))return(async()=>{for await(const e of t)return e})();for(const e of t)return e}async function*Oa(t,e,r,n,s){const i=async f=>{const u=await r.getCodec(f.code),l=await n(f,s);return u.decode(l)},o=e.split("/").filter(Boolean);let a=await i(t),c=t;for(;o.length>0;){const f=o.shift();if(f==null)throw dt(new Error(`Could not resolve path "${e}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,f))a=a[f],yield{value:a,remainderPath:o.join("/")};else throw dt(new Error(`no link named "${f}" under ${c}`),"ERR_NO_LINK");const u=M.asCID(a);u!=null&&(c=u,a=await i(a))}yield{value:a,remainderPath:""}}function m1(t,e){const r=Af(t);return async function(s,i={}){if(i.path!=null){const u=i.localResolve===!0?await w1(Oa(s,i.path,e,r,i)):await ys(Oa(s,i.path,e,r,i));if(u==null)throw dt(new Error("Not found"),"ERR_NOT_FOUND");return u}const o=await e.getCodec(s.code),a=await r(s,i);return{value:o.decode(a),remainderPath:""}}}function b1(t){return async function*(r,n={}){const s=new AbortController,i=At([s.signal,n.signal]);try{const{headers:o,body:a}=await Mt(r,s,n.headers),c=await t.post("dag/import",{signal:i,headers:o,body:a,searchParams:T({"pin-roots":n.pinRoots})});for await(const{Root:f}of c.ndjson())if(f!==void 0){const{Cid:{"/":u},PinErrorMsg:l}=f;yield{root:{cid:M.parse(u),pinErrorMsg:l}}}}finally{i.clear()}}}function v1(t,e){return async function(n,s={}){const i={storeCodec:"dag-cbor",hashAlg:"sha2-256",...s};let o;if(i.inputCodec!=null){if(!(n instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");o=n}else o=(await e.getCodec(i.storeCodec??"dag-cbor")).encode(n),i.inputCodec=i.storeCodec;const a=new AbortController,c=At([a.signal,i.signal]);try{const u=await(await t.post("dag/put",{timeout:i.timeout,signal:c,searchParams:T(i),...await Mt([o],a,i.headers)})).json();return M.parse(u.Cid["/"])}finally{c.clear()}}}function x1(t){return async function(r,n={}){const i=await(await t.post("dag/resolve",{signal:n.signal,searchParams:T({arg:`${r}${n.path!=null?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers})).json();return{cid:M.parse(i.Cid["/"]),remainderPath:i.RemPath}}}function E1(t,e){return{export:g1(t),get:m1(t,e),import:b1(t),put:v1(t,e),resolve:x1(t)}}const B1=0,S1=1,A1=2,k1=3,I1=4,C1=5,T1=6,N1=7;function Fr(t){var e;if(t.Type===B1)return{name:"SENDING_QUERY",type:t.Type};if(t.Type===S1)return{from:je(t.ID),name:"PEER_RESPONSE",type:t.Type,messageType:0,messageName:"PUT_VALUE",closer:(t.Responses??[]).map(({ID:r,Addrs:n})=>({id:je(r),multiaddrs:n.map(s=>Ve(s)),protocols:[]})),providers:(t.Responses??[]).map(({ID:r,Addrs:n})=>({id:je(r),multiaddrs:n.map(s=>Ve(s)),protocols:[]}))};if(t.Type===A1){let r={id:t.ID??je(t.ID),multiaddrs:[],protocols:[]};return((e=t.Responses)==null?void 0:e.length)>0&&(r={id:je(t.Responses[0].ID),multiaddrs:t.Responses[0].Addrs.map(n=>Ve(n)),protocols:[]}),{name:"FINAL_PEER",type:t.Type,peer:r}}if(t.Type===k1)return{name:"QUERY_ERROR",type:t.Type,error:new Error(t.Extra)};if(t.Type===I1)return{name:"PROVIDER",type:t.Type,providers:t.Responses.map(({ID:r,Addrs:n})=>({id:je(r),multiaddrs:n.map(s=>Ve(s)),protocols:[]}))};if(t.Type===C1)return{name:"VALUE",type:t.Type,value:it(t.Extra,"base64pad")};if(t.Type===T1){const r=t.Responses.map(({ID:n})=>je(n));if(r.length===0)throw new Error("No peer found");return{name:"ADDING_PEER",type:t.Type,peer:r[0]}}if(t.Type===N1)return{name:"DIALING_PEER",type:t.Type,peer:je(t.ID)};throw new Error("Unknown DHT event type")}function U1(t){return async function*(r,n={}){const s=await t.post("dht/query",{signal:n.signal,searchParams:T({arg:r.toString(),...n}),headers:n.headers});for await(const i of s.ndjson())yield Fr(i)}}var Pa;(function(t){t[t.SENDING_QUERY=0]="SENDING_QUERY",t[t.PEER_RESPONSE=1]="PEER_RESPONSE",t[t.FINAL_PEER=2]="FINAL_PEER",t[t.QUERY_ERROR=3]="QUERY_ERROR",t[t.PROVIDER=4]="PROVIDER",t[t.VALUE=5]="VALUE",t[t.ADDING_PEER=6]="ADDING_PEER",t[t.DIALING_PEER=7]="DIALING_PEER"})(Pa||(Pa={}));var Da;(function(t){t[t.PUT_VALUE=0]="PUT_VALUE",t[t.GET_VALUE=1]="GET_VALUE",t[t.ADD_PROVIDER=2]="ADD_PROVIDER",t[t.GET_PROVIDERS=3]="GET_PROVIDERS",t[t.FIND_NODE=4]="FIND_NODE",t[t.PING=5]="PING"})(Da||(Da={}));function $1(t){return{query:U1(t)}}function _1(t){return async function(r={}){return(await t.post("diag/cmds",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()}}function O1(t){return async function(r={}){return(await t.post("diag/net",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()}}function P1(t){return async function(r={}){return(await t.post("diag/sys",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()}}function D1(t){return{cmds:_1(t),net:O1(t),sys:P1(t)}}function L1(t){return async function(r,n,s={}){const i=Array.isArray(r)?r:[r];await(await t.post("files/cp",{signal:s.signal,searchParams:T({arg:i.concat(n).map(a=>M.asCID(a)!=null?`/ipfs/${a}`:a),...s}),headers:s.headers})).text()}}function R1(t){return async function(r,n={}){if(typeof r!="string")throw new Error("ipfs.files.flush requires a path");const i=await(await t.post("files/flush",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).json();return M.parse(i.Cid)}}function Ei(t){const e=Se(t);return Object.prototype.hasOwnProperty.call(e,"mode")&&(e.mode=parseInt(e.mode,8)),Object.prototype.hasOwnProperty.call(e,"mtime")&&(e.mtime={secs:e.mtime,nsecs:e.mtimeNsecs??0},delete e.mtimeNsecs),e}function F1(t){return async function*(r,n={}){if(r==null)throw new Error("ipfs.files.ls requires a path");const s=await t.post("files/ls",{signal:n.signal,searchParams:T({arg:M.asCID(r)!=null?`/ipfs/${r}`:r,long:!0,...n,stream:!0}),headers:n.headers});for await(const i of s.ndjson())if("Entries"in i)for(const o of i.Entries??[])yield La(Ei(o));else yield La(Ei(i))}}function La(t){return t.hash!=null&&(t.cid=M.parse(t.hash)),delete t.hash,t.type=t.type===1?"directory":"file",t}function V1(t){return async function(r,n={}){await(await t.post("files/mkdir",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).text()}}function H1(t){return async function(r,n,s={}){Array.isArray(r)||(r=[r]),await(await t.post("files/mv",{signal:s.signal,searchParams:T({arg:r.concat(n),...s}),headers:s.headers})).text()}}function M1(t){if(z1(t))return async function*(){const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)return;yield n}}finally{e.releaseLock()}}();if(j1(t))return t;throw new Error("unknown stream")}function j1(t){return t[Symbol.asyncIterator]!=null}function z1(t){return typeof(t==null?void 0:t.getReader)=="function"}function G1(t){return async function*(r,n={}){const s=await t.post("files/read",{signal:n.signal,searchParams:T({arg:r,count:n.length,...n}),headers:n.headers});if(s.body==null)throw new Error("Invalid response body");yield*M1(s.body)}}function q1(t){return async function(r,n={}){const s=await t.post("files/rm",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers}),i=await s.text();if(i!==""){const o=new Qy(s);throw o.message=i,o}}}function kf(t){return async function(r,n={}){const i=await(await t.post("files/stat",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).json();return i.WithLocality=i.WithLocality??!1,W1(Ei(i))}}function W1(t){return t.cid=M.parse(t.hash),delete t.hash,t}function K1(t){return async function(r,n,s={}){const i=new AbortController,o=At([i.signal,s.signal]);try{await(await t.post("files/write",{signal:o,searchParams:T({arg:r,streamChannels:!0,count:s.length,...s}),...await Mt([{content:n,path:"arg",mode:io(s.mode),mtime:gs(s.mtime)}],i,s.headers)})).text()}finally{o.clear()}}}function J1(t){return{cp:L1(t),flush:R1(t),ls:F1(t),mkdir:V1(t),mv:H1(t),read:G1(t),rm:q1(t),stat:kf(t),write:K1(t)}}function Z1(t){return function(){const r=new URL(t.opts.base??"");return{host:r.hostname,port:r.port,protocol:r.protocol,pathname:r.pathname,"api-path":r.pathname}}}function X1(t){return async function*(r,n={}){const s={arg:`${r instanceof Uint8Array?M.decode(r):r}`,...n};yield*(await t.post("get",{signal:n.signal,searchParams:T(s),headers:n.headers})).iterator()}}function If(t){return async function(r={}){const s=await(await t.post("id",{signal:r.signal,searchParams:T({arg:r.peerId!=null?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),i={...Se(s)};return i.id=je(i.id),i.addresses!=null&&(i.addresses=i.addresses.map(o=>Ve(o))),i}}function Y1(t){const e=If(t);return async function(n={}){var s;try{const i=await e(n);return!!((s=i==null?void 0:i.addresses)!=null&&s.length)}catch{return!1}}}const Q1={type:"ed25519"};function ev(t){return async function(r,n=Q1){const i=await(await t.post("key/gen",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).json();return Se(i)}}function tv(t){return async function(r,n,s,i={}){const a=await(await t.post("key/import",{signal:i.signal,searchParams:T({arg:r,pem:n,password:s,...i}),headers:i.headers})).json();return Se(a)}}function rv(t){return async function(r={}){return((await(await t.post("key/list",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()).Keys??[]).map(i=>Se(i))}}function nv(t){return async function(r,n,s={}){const i=await t.post("key/rename",{signal:s.signal,searchParams:T({arg:[r,n],...s}),headers:s.headers});return Se(await i.json())}}function sv(t){return async function(r,n={}){const i=await(await t.post("key/rm",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers})).json();return Se(i.Keys[0])}}function iv(t){return{gen:ev(t),import:tv(t),list:rv(t),rename:nv(t),rm:sv(t)}}const Ir=1e3,Cr=Ir*60,Tr=Cr*60,er=Tr*24,ov=er*7,av=er*365.25;function Cf(t,e){try{if(typeof t=="string"&&t.length>0)return cv(t);if(typeof t=="number"&&isFinite(t))return e!=null&&e.long?lv(t):uv(t);throw new Error("Value is not a string or number.")}catch(r){const n=fv(r)?`${r.message}. value=${JSON.stringify(t)}`:"An unknown error has occured.";throw new Error(n)}}function cv(t){if(t=String(t),t.length>100)throw new Error("Value exceeds the maximum length of 100 characters.");const e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return NaN;const r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*av;case"weeks":case"week":case"w":return r*ov;case"days":case"day":case"d":return r*er;case"hours":case"hour":case"hrs":case"hr":case"h":return r*Tr;case"minutes":case"minute":case"mins":case"min":case"m":return r*Cr;case"seconds":case"second":case"secs":case"sec":case"s":return r*Ir;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:throw new Error(`The unit ${n} was matched, but no matching case exists.`)}}function uv(t){const e=Math.abs(t);return e>=er?`${Math.round(t/er)}d`:e>=Tr?`${Math.round(t/Tr)}h`:e>=Cr?`${Math.round(t/Cr)}m`:e>=Ir?`${Math.round(t/Ir)}s`:`${t}ms`}function lv(t){const e=Math.abs(t);return e>=er?Tn(t,e,er,"day"):e>=Tr?Tn(t,e,Tr,"hour"):e>=Cr?Tn(t,e,Cr,"minute"):e>=Ir?Tn(t,e,Ir,"second"):`${t} ms`}function Tn(t,e,r,n){const s=e>=r*1.5;return`${Math.round(t/r)} ${n}${s?"s":""}`}function fv(t){return typeof t=="object"&&t!==null&&"message"in t}function dv(t){r.debug=r,r.default=r,r.coerce=c,r.disable=i,r.enable=s,r.enabled=o,r.humanize=Cf,r.destroy=f,Object.keys(t).forEach(u=>{r[u]=t[u]}),r.names=[],r.skips=[],r.formatters={};function e(u){let l=0;for(let d=0;d<u.length;d++)l=(l<<5)-l+u.charCodeAt(d),l|=0;return r.colors[Math.abs(l)%r.colors.length]}r.selectColor=e;function r(u){let l,d=null,h,g;function v(...p){if(!v.enabled)return;const y=v,E=Number(new Date),b=E-(l||E);y.diff=b,y.prev=l,y.curr=E,l=E,p[0]=r.coerce(p[0]),typeof p[0]!="string"&&p.unshift("%O");let B=0;p[0]=p[0].replace(/%([a-zA-Z%])/g,(A,k)=>{if(A==="%%")return"%";B++;const I=r.formatters[k];if(typeof I=="function"){const C=p[B];A=I.call(y,C),p.splice(B,1),B--}return A}),r.formatArgs.call(y,p),(y.log||r.log).apply(y,p)}return v.namespace=u,v.useColors=r.useColors(),v.color=r.selectColor(u),v.extend=n,v.destroy=r.destroy,Object.defineProperty(v,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(h!==r.namespaces&&(h=r.namespaces,g=r.enabled(u)),g),set:p=>{d=p}}),typeof r.init=="function"&&r.init(v),v}function n(u,l){const d=r(this.namespace+(typeof l>"u"?":":l)+u);return d.log=this.log,d}function s(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let l;const d=(typeof u=="string"?u:"").split(/[\s,]+/),h=d.length;for(l=0;l<h;l++)d[l]&&(u=d[l].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.substr(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function i(){const u=[...r.names.map(a),...r.skips.map(a).map(l=>"-"+l)].join(",");return r.enable(""),u}function o(u){if(u[u.length-1]==="*")return!0;let l,d;for(l=0,d=r.skips.length;l<d;l++)if(r.skips[l].test(u))return!1;for(l=0,d=r.names.length;l<d;l++)if(r.names[l].test(u))return!0;return!1}function a(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function c(u){return u instanceof Error?u.stack??u.message:u}function f(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.setupFormatters(r.formatters),r.enable(r.load()),r}var hv={};const lt=vv(),pv=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function gv(){var t,e,r,n,s;return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&((t=navigator.userAgent)==null?void 0:t.toLowerCase().match(/(edge|trident)\/(\d+)/))!=null?!1:typeof document<"u"&&((r=(e=document.documentElement)==null?void 0:e.style)==null?void 0:r.WebkitAppearance)||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&((n=navigator.userAgent)==null?void 0:n.toLowerCase().match(/firefox\/(\d+)/))!=null&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&((s=navigator.userAgent)==null?void 0:s.toLowerCase().match(/applewebkit\/(\d+)/))}function yv(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+Cf(this.diff),!this.useColors)return;const e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,s=>{s!=="%%"&&(r++,s==="%c"&&(n=r))}),t.splice(n,0,e)}const wv=console.debug??console.log??(()=>{});function mv(t){try{t?lt==null||lt.setItem("debug",t):lt==null||lt.removeItem("debug")}catch{}}function bv(){let t;try{t=lt==null?void 0:lt.getItem("debug")}catch{}return!t&&typeof globalThis.process<"u"&&"env"in globalThis.process&&(t=hv.DEBUG),t}function vv(){try{return localStorage}catch{}}function xv(t){t.j=function(e){try{return JSON.stringify(e)}catch(r){return"[UnexpectedJSONParseError]: "+r.message}}}const Ge=dv({formatArgs:yv,save:mv,load:bv,useColors:gv,setupFormatters:xv,colors:pv,storage:lt,log:wv});Ge.formatters.b=t=>t==null?"undefined":xe.baseEncode(t);Ge.formatters.t=t=>t==null?"undefined":Rt.baseEncode(t);Ge.formatters.m=t=>t==null?"undefined":is.baseEncode(t);Ge.formatters.p=t=>t==null?"undefined":t.toString();Ge.formatters.c=t=>t==null?"undefined":t.toString();Ge.formatters.k=t=>t==null?"undefined":t.toString();Ge.formatters.a=t=>t==null?"undefined":t.toString();Ge.formatters.e=t=>t==null?"undefined":Ra(t.stack)??Ra(t.message)??t.toString();function Ev(t){const e=()=>{};return e.enabled=!1,e.color="",e.diff=0,e.log=()=>{},e.namespace=t,e.destroy=()=>!0,e.extend=()=>e,e}function So(t){let e=Ev(`${t}:trace`);return Ge.enabled(`${t}:trace`)&&Ge.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(e=Ge(`${t}:trace`)),Object.assign(Ge(t),{error:Ge(`${t}:error`),trace:e})}function Ra(t){if(t!=null&&(t=t.trim(),t.length!==0))return t}var Bv=t=>{if(Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype};const rs=Bv,{hasOwnProperty:Tf}=Object.prototype,{propertyIsEnumerable:Sv}=Object,Nr=(t,e,r)=>Object.defineProperty(t,e,{value:r,writable:!0,enumerable:!0,configurable:!0}),Av=Xs,Fa={concatArrays:!1,ignoreUndefined:!1},Ss=t=>{const e=[];for(const r in t)Tf.call(t,r)&&e.push(r);if(Object.getOwnPropertySymbols){const r=Object.getOwnPropertySymbols(t);for(const n of r)Sv.call(t,n)&&e.push(n)}return e};function Vr(t){return Array.isArray(t)?kv(t):rs(t)?Iv(t):t}function kv(t){const e=t.slice(0,0);return Ss(t).forEach(r=>{Nr(e,r,Vr(t[r]))}),e}function Iv(t){const e=Object.getPrototypeOf(t)===null?Object.create(null):{};return Ss(t).forEach(r=>{Nr(e,r,Vr(t[r]))}),e}const Nf=(t,e,r,n)=>(r.forEach(s=>{typeof e[s]>"u"&&n.ignoreUndefined||(s in t&&t[s]!==Object.getPrototypeOf(t)?Nr(t,s,Bi(t[s],e[s],n)):Nr(t,s,Vr(e[s])))}),t),Cv=(t,e,r)=>{let n=t.slice(0,0),s=0;return[t,e].forEach(i=>{const o=[];for(let a=0;a<i.length;a++)Tf.call(i,a)&&(o.push(String(a)),i===t?Nr(n,s++,i[a]):Nr(n,s++,Vr(i[a])));n=Nf(n,i,Ss(i).filter(a=>!o.includes(a)),r)}),n};function Bi(t,e,r){return r.concatArrays&&Array.isArray(t)&&Array.isArray(e)?Cv(t,e,r):!rs(e)||!rs(t)?Vr(e):Nf(t,e,Ss(e),r)}var Tv=function(...t){const e=Bi(Vr(Fa),this!==Av&&this||{},Fa);let r={_:{}};for(const n of t)if(n!==void 0){if(!rs(n))throw new TypeError("`"+n+"` is not an Option Object");r=Bi(r,{_:n},e)}return r._};const Uf=Ui(Tv);let Nv=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;J.year=J.yr=J.y=6e4*60*24*365.25;J.month=J.b=6e4*60*24*(365.25/12);J.week=J.wk=J.w=6e4*60*24*7;J.day=J.d=6e4*60*24;J.hour=J.hr=J.h=6e4*60;J.minute=J.min=J.m=6e4;J.second=J.sec=J.s=1e3;J.millisecond=J.millisec=J.ms=1;J.µs=J.μs=J.us=J.microsecond=1/1e3;J.nanosecond=J.ns=1/1e6;function J(t="",e="ms"){var r=null,n;return t=(t+"").replace(/(\d)[,_](\d)/g,"$1$2"),t.replace(Nv,function(s,i,o){if(o)o=o.toLowerCase();else if(n){for(var a in J)if(J[a]<n){o=a;break}}else o=e;Object.prototype.hasOwnProperty.call(J,o)?o=J[o]:Object.prototype.hasOwnProperty.call(J,o.replace(/s$/,""))?o=J[o.replace(/s$/,"")]:o=null,o&&(r=(r||0)+Math.abs(parseFloat(i,10))*o,n=o)}),r&&r/(J[e]||1)*(t[0]==="-"?-1:1)}const Uv=()=>{},$v=typeof navigator<"u"&&navigator.product==="ReactNative";function _v(){return $v?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const en=self.URL,$f=_v();let Ov=class{constructor(e="",r=$f){this.super=new en(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set username(e){this.super.username=e}static createObjectURL(e){return en.createObjectURL(e)}static revokeObjectURL(e){en.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function Pv(t){if(typeof t=="string")return new en(t).toString();if(!(t instanceof en)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",s=t.protocol?t.protocol+"//":"",i=t.host||"",o=t.hostname||"",a=t.search||(t.query?"?"+t.query:""),c=t.hash||"",f=t.pathname||"",u=t.path||f+a;return`${s}${e||r}${i||o+n}${u}${c}`}}var _f={URLWithLegacySupport:Ov,URLSearchParams:self.URLSearchParams,defaultBase:$f,format:Pv};const{URLWithLegacySupport:Va,format:Dv}=_f;var Lv=(t,e={},r={},n)=>{let s=e.protocol?e.protocol.replace(":",""):"http";s=(r[s]||n||s)+":";let i;try{i=new Va(t)}catch{i={}}const o=Object.assign({},e,{protocol:s||i.protocol,host:e.host||i.host});return new Va(t,Dv(o)).toString()};const{URLWithLegacySupport:Rv,format:Fv,URLSearchParams:Vv,defaultBase:Hv}=_f,Mv=Lv;var Nn={URL:Rv,URLSearchParams:Vv,format:Fv,relative:Mv,defaultBase:Hv};class Of extends Error{constructor(e="Request timed out"){super(e),this.name="TimeoutError"}}class jv extends Error{constructor(e="The operation was aborted."){super(e),this.name="AbortError"}}class Ha extends Error{constructor(r){super(r.statusText);m(this,"response");this.name="HTTPError",this.response=r}}const zv=globalThis.fetch,Ao=globalThis.Headers,Gv=globalThis.Request,Pf=globalThis.Response,qv=async(t,e={})=>{const r=new XMLHttpRequest;r.open(e.method??"GET",t.toString(),!0);const{timeout:n,headers:s}=e,i=Number(n);if(!isNaN(i)&&i>0&&i<1/0&&(r.timeout=i),e.overrideMimeType!=null&&r.overrideMimeType(e.overrideMimeType),s!=null)for(const[o,a]of new Ao(s))r.setRequestHeader(o,a);return e.signal!=null&&(e.signal.onabort=()=>{r.abort()}),e.onUploadProgress!=null&&(r.upload.onprogress=e.onUploadProgress),r.responseType="arraybuffer",new Promise((o,a)=>{const c=f=>{switch(f.type){case"error":{o(Pf.error());break}case"load":{o(new Zv(r.responseURL,r.response,{status:r.status,statusText:r.statusText,headers:Jv(r.getAllResponseHeaders())}));break}case"timeout":{a(new Of);break}case"abort":{a(new jv);break}}};r.onerror=c,r.onload=c,r.ontimeout=c,r.onabort=c,r.send(e.body)})},Wv=zv,Kv=(t,e={})=>e.onUploadProgress!=null?qv(t,e):Wv(t,e),Jv=t=>{const e=new Ao;for(const r of t.trim().split(/[\r\n]+/)){const n=r.indexOf(": ");n>0&&e.set(r.slice(0,n),r.slice(n+1))}return e};class Zv extends Pf{constructor(e,r,n){super(r,n),Object.defineProperty(this,"url",{value:e})}}const Ma=Uf.bind({ignoreUndefined:!0}),Un=So("kubo-rpc-client:fetch"),Xv={throwHttpErrors:!0,credentials:"same-origin"},Fe=class Fe{constructor(e={}){m(this,"opts");this.opts=Ma({},Xv,e)}async fetch(e,r={}){const n=Ma({},this.opts,r),s=new Ao(n.headers);if(typeof e!="string"&&!(e instanceof Nn.URL||e instanceof Gv))throw new TypeError("`resource` must be a string, URL, or Request");const i=new Nn.URL(e.toString(),n.base),{searchParams:o,transformSearchParams:a,json:c}=n;o!=null&&(typeof a=="function"?i.search=a(new Nn.URLSearchParams(n.searchParams)):i.search=new Nn.URLSearchParams(n.searchParams).toString()),c!=null&&(n.body=JSON.stringify(n.json),s.set("content-type","application/json"));const f=[n.signal];n.timeout!=null&&isNaN(n.timeout)&&n.timeout>0&&f.push(AbortSignal.timeout(n.timeout));const u=At(f);try{globalThis.ReadableStream!=null&&n.body instanceof globalThis.ReadableStream&&(fs||ds)&&(n.body=new Blob(await Au(hs(n.body)))),Un.trace("outgoing headers",n.headers),Un.trace("%s %s",n.method,i);const l=await Kv(i.toString(),{...n,signal:n.signal,timeout:void 0,headers:s,duplex:"half"});if(Un("%s %s %d",n.method,i,l.status),Un.trace("incoming headers",l.headers),!l.ok&&n.throwHttpErrors===!0)throw n.handleError!=null&&await n.handleError(l),new Ha(l);return l.iterator=async function*(){yield*Qv(l.body)},l.ndjson=async function*(){for await(const d of Yv(l.iterator()))r.transform!=null?yield r.transform(d):yield d},l}finally{u.clear()}}async post(e,r={}){return this.fetch(e,{...r,method:"POST"})}async get(e,r={}){return this.fetch(e,{...r,method:"GET"})}async put(e,r={}){return this.fetch(e,{...r,method:"PUT"})}async delete(e,r={}){return this.fetch(e,{...r,method:"DELETE"})}async options(e,r={}){return this.fetch(e,{...r,method:"OPTIONS"})}};m(Fe,"HTTPError",Ha),m(Fe,"TimeoutError",Of),m(Fe,"post",async(e,r)=>new Fe(r).post(e,r)),m(Fe,"get",async(e,r)=>new Fe(r).get(e,r)),m(Fe,"put",async(e,r)=>new Fe(r).put(e,r)),m(Fe,"delete",async(e,r)=>new Fe(r).delete(e,r)),m(Fe,"options",async(e,r)=>new Fe(r).options(e,r));let zt=Fe;const Yv=async function*(t){const e=new TextDecoder;let r="";for await(const n of t){r+=e.decode(n,{stream:!0});const s=r.split(/\r?\n/);for(let i=0;i<s.length-1;i++){const o=s[i].trim();o.length>0&&(yield JSON.parse(o))}r=s[s.length-1]}r+=e.decode(),r=r.trim(),r.length!==0&&(yield JSON.parse(r))},Qv=t=>{if(ex(t))return t;if(rx(t)){const e=t[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:e.next.bind(e),return(r){return t.destroy(),typeof e.return=="function"?e.return():Promise.resolve({done:!0,value:r})}}}}}if(tx(t)){const e=t.getReader();return async function*(){try{for(;;){const{done:r,value:n}=await e.read();if(r)return;n!=null&&(yield n)}}finally{e.releaseLock()}}()}throw new TypeError("Body can't be converted to AsyncIterable")},ex=t=>t!==null&&typeof t[Symbol.asyncIterator]=="function",tx=t=>t!=null&&typeof t.getReader=="function",rx=t=>Object.prototype.hasOwnProperty.call(t,"readable")&&Object.prototype.hasOwnProperty.call(t,"writable"),nx=[X("tcp").code,X("dns").code,X("dnsaddr").code,X("dns4").code,X("dns6").code];function ja(t){var e;return(e=Df("sni",t))==null?void 0:e[1]}function za(t){var r;const e=(r=Df("tcp",t))==null?void 0:r[1];return e==null?"":`:${e}`}function Df(t,e){let r;try{r=X(t).code}catch{return}for(const[n,s]of e)if(n===r&&s!=null)return[n,s]}function Ga(t){return t.some(([e,r])=>e===X("tls").code)}function Re(t,e,r){const n=Lf[X(t).name];if(n==null)throw new Error(`Can't interpret protocol ${X(t).name}`);const s=n(e,r);return t===X("ip6").code?`[${s}]`:s}const Lf={ip4:(t,e)=>t,ip6:(t,e)=>e.length===0?t:`[${t}]`,tcp:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`tcp://${Re(r[0],r[1]??"",e)}:${t}`},udp:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`udp://${Re(r[0],r[1]??"",e)}:${t}`},dnsaddr:(t,e)=>t,dns4:(t,e)=>t,dns6:(t,e)=>t,dns:(t,e)=>t,ipfs:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`${Re(r[0],r[1]??"",e)}/ipfs/${t}`},p2p:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`${Re(r[0],r[1]??"",e)}/p2p/${t}`},http:(t,e)=>{const r=Ga(e),n=ja(e),s=za(e);if(r&&n!=null)return`https://${n}${s}`;const i=r?"https://":"http://",o=e.pop();if(o==null)throw new Error("Unexpected end of multiaddr");let a=Re(o[0],o[1]??"",e);return a=a.replace("tcp://",""),`${i}${a}`},"http-path":(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");const n=Re(r[0],r[1]??"",e),s=decodeURIComponent(t);return`${n}/${s}`},tls:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return Re(r[0],r[1]??"",e)},sni:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return Re(r[0],r[1]??"",e)},https:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");let n=Re(r[0],r[1]??"",e);return n=n.replace("tcp://",""),`https://${n}`},ws:(t,e)=>{const r=Ga(e),n=ja(e),s=za(e);if(r&&n!=null)return`wss://${n}${s}`;const i=r?"wss://":"ws://",o=e.pop();if(o==null)throw new Error("Unexpected end of multiaddr");let a=Re(o[0],o[1]??"",e);return a=a.replace("tcp://",""),`${i}${a}`},wss:(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");let n=Re(r[0],r[1]??"",e);return n=n.replace("tcp://",""),`wss://${n}`},"p2p-websocket-star":(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`${Re(r[0],r[1]??"",e)}/p2p-websocket-star`},"p2p-webrtc-star":(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`${Re(r[0],r[1]??"",e)}/p2p-webrtc-star`},"p2p-webrtc-direct":(t,e)=>{const r=e.pop();if(r==null)throw new Error("Unexpected end of multiaddr");return`${Re(r[0],r[1]??"",e)}/p2p-webrtc-direct`}};function sx(t,e){const n=Ve(t).stringTuples(),s=n.pop();if(s==null)throw new Error("Unexpected end of multiaddr");const i=X(s[0]),o=Lf[i.name];if(o==null)throw new Error(`No interpreter found for ${i.name}`);let a=o(s[1]??"",n);return nx.includes(s[0])&&(a=a.replace(/^.*:\/\//,""),s[1]==="443"?a=`https://${a}`:a=`http://${a}`),(a.startsWith("http://")||a.startsWith("https://")||a.startsWith("ws://")||a.startsWith("wss://"))&&(a=new URL(a).toString(),a.endsWith("/")&&(a=a.substring(0,a.length-1))),a}function qa(t){try{t=sx(Ve(t))}catch{}return t=t.toString(),t}const Wa=So("js-kubo-rpc-client:lib:error-handler"),ix=Uf.bind({ignoreUndefined:!0}),ox=fs||ds?location.protocol:"http",ax=fs||ds?location.hostname:"localhost",cx=fs||ds?location.port:"5001",ux=(t={})=>{let e,r={},n;if(typeof t=="string"||Hn(t))e=new URL(qa(t));else if(t instanceof URL)e=t;else if(typeof t.url=="string"||Hn(t.url))e=new URL(qa(t.url)),r=t;else if(t.url instanceof URL)e=t.url,r=t;else{r=t??{};const s=(r.protocol??ox).replace(":",""),i=(r.host??ax).split(":")[0],o=r.port??cx;e=new URL(`${s}://${i}:${o}`)}if(r.apiPath!=null?e.pathname=r.apiPath:(e.pathname==="/"||e.pathname===void 0)&&(e.pathname="api/v0"),Jy){const s=Uv();n=r.agent??new s({keepAlive:!0,maxSockets:6})}return{...r,host:e.host,protocol:e.protocol.replace(":",""),port:Number(e.port),apiPath:e.pathname,url:e,agent:n}},lx=async t=>{let e;try{if((t.headers.get("Content-Type")??"").startsWith("application/json")){const n=await t.json();Wa(n),e=n.Message??n.message}else e=await t.text()}catch(n){Wa("Failed to parse error response",n),e=n.message}let r=new zt.HTTPError(t);throw e!=null&&(e.includes("deadline has elapsed")&&(r=new zt.TimeoutError),e.includes("context deadline exceeded")&&(r=new zt.TimeoutError),e.includes("request timed out")&&(r=new zt.TimeoutError),r.message=e),r},fx=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,Ka=t=>t.replace(fx,function(e){return"-"+e.toLowerCase()}),dx=t=>typeof t=="string"?J(t)??0:t;class hx extends zt{constructor(e={}){const r=ux(e);super({timeout:r.timeout!=null?dx(r.timeout):void 0,headers:r.headers,base:`${r.url}`,handleError:lx,transformSearchParams:s=>{const i=new URLSearchParams;for(const[o,a]of s)a!=="undefined"&&a!=="null"&&o!=="signal"&&o!=="timeout"&&i.append(Ka(o),a),o==="timeout"&&!isNaN(parseInt(a))&&i.append(Ka(o),a);return i},agent:r.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const n=this.fetch;this.fetch=async(s,i={})=>(typeof s=="string"&&!s.startsWith("/")&&(s=`${r.url}/${s}`),n.call(this,s,ix(i,{method:"POST"})))}}const px=async t=>Promise.reject(new Error(`No base found for "${t}"`));class gx{constructor(e){m(this,"_basesByName");m(this,"_basesByPrefix");m(this,"_loadBase");this._basesByName={},this._basesByPrefix={},this._loadBase=e.loadBase??px;for(const r of e.bases)this.addBase(r)}addBase(e){if(this._basesByName[e.name]!=null&&this._basesByPrefix[e.prefix]!=null)throw new Error(`Codec already exists for codec "${e.name}"`);this._basesByName[e.name]=e,this._basesByPrefix[e.prefix]=e}removeBase(e){delete this._basesByName[e.name],delete this._basesByPrefix[e.prefix]}async getBase(e){if(this._basesByName[e]!=null)return this._basesByName[e];if(this._basesByPrefix[e]!=null)return this._basesByPrefix[e];const r=await this._loadBase(e);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}}const yx=async t=>Promise.reject(new Error(`No codec found for "${t}"`));class wx{constructor(e){m(this,"_codecsByName");m(this,"_codecsByCode");m(this,"_loadCodec");this._codecsByName={},this._codecsByCode={},this._loadCodec=e.loadCodec??yx;for(const r of e.codecs)this.addCodec(r)}addCodec(e){if(this._codecsByName[e.name]!=null||this._codecsByCode[e.code]!=null)throw new Error(`Resolver already exists for codec "${e.name}"`);this._codecsByName[e.name]=e,this._codecsByCode[e.code]=e}removeCodec(e){delete this._codecsByName[e.name],delete this._codecsByCode[e.code]}async getCodec(e){const r=typeof e=="string"?this._codecsByName:this._codecsByCode;if(r[e]!=null)return r[e];const n=await this._loadCodec(e);return r[e]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}}const mx=async t=>Promise.reject(new Error(`No hasher found for "${t}"`));class bx{constructor(e){m(this,"_hashersByName");m(this,"_hashersByCode");m(this,"_loadHasher");this._hashersByName={},this._hashersByCode={},this._loadHasher=e.loadHasher??mx;for(const r of e.hashers)this.addHasher(r)}addHasher(e){if(this._hashersByName[e.name]!=null||this._hashersByCode[e.code]!=null)throw new Error(`Resolver already exists for codec "${e.name}"`);this._hashersByName[e.name]=e,this._hashersByCode[e.code]=e}removeHasher(e){delete this._hashersByName[e.name],delete this._hashersByCode[e.code]}async getHasher(e){const r=typeof e=="string"?this._hashersByName:this._hashersByCode;if(r[e]!=null)return r[e];const n=await this._loadHasher(e);return r[e]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}}function vx(t){return async function(e,r,n={}){const s=await t.post("log/level",{signal:n.signal,searchParams:T({arg:[e,r],...n}),headers:n.headers});return Se(await s.json())}}function xx(t){return async function(r={}){return(await(await t.post("log/ls",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()).Strings}}function Ex(t){return async function*(r={}){yield*(await t.post("log/tail",{signal:r.signal,searchParams:T(r),headers:r.headers})).ndjson()}}function Bx(t){return{level:vx(t),ls:xx(t),tail:Ex(t)}}function Sx(t){return async function*(r,n={}){const s=`${r instanceof Uint8Array?M.decode(r):r}`;async function i(a){let c=a.Hash;if(c.includes("/")===!0){const u=c.startsWith("/ipfs/")===!0?c:`/ipfs/${c}`;c=(await kf(t)(u)).cid}else c=M.parse(c);return{name:a.Name,path:s+(a.Name!=null?`/${a.Name}`:""),size:a.Size,cid:c,type:Ax(a)}}const o=await t.post("ls",{signal:n.signal,searchParams:T({arg:s,...n}),headers:n.headers});for await(let a of o.ndjson()){if(a=a.Objects,a==null)throw new Error("expected .Objects in results");if(a=a[0],a==null)throw new Error("expected one array in results.Objects");const c=a.Links;if(!Array.isArray(c))throw new Error("expected one array in results.Objects[0].Links");if(c.length===0){yield i(a);return}yield*c.map(i)}}}function Ax(t){switch(t.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}function kx(t){return async function(r={}){const n=await t.post("dns",{signal:r.signal,searchParams:T(r),headers:r.headers});return Se(await n.json())}}function Ix(t){return async function(r,n={}){const s=await t.post("name/publish",{signal:n.signal,searchParams:T({arg:`${r}`,...n}),headers:n.headers});return Se(await s.json())}}function Cx(t){return async function(r,n={}){const s=await t.post("name/pubsub/cancel",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers});return Se(await s.json())}}function Tx(t){return async function(r={}){const n=await t.post("name/pubsub/state",{signal:r.signal,searchParams:T(r),headers:r.headers});return Se(await n.json())}}function Nx(t){return async function(r={}){return(await(await t.post("name/pubsub/subs",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()).Strings??[]}}function Ux(t){return{cancel:Cx(t),state:Tx(t),subs:Nx(t)}}function $x(t){return async function*(r,n={}){const s=await t.post("name/resolve",{signal:n.signal,searchParams:T({arg:r,stream:!0,...n}),headers:n.headers});for await(const i of s.ndjson())yield i.Path}}function _x(t){return{publish:Ix(t),resolve:$x(t),pubsub:Ux(t)}}function Ox(t){return async function(r,n,s={}){const i=await t.post("object/patch/add-link",{signal:s.signal,searchParams:T({arg:[`${r}`,n.Name??n.name??"",(n.Hash??n.cid??"").toString()??null],...s}),headers:s.headers}),{Hash:o}=await i.json();return M.parse(o)}}function Px(t){return async function(r,n,s={}){const i=await t.post("object/patch/rm-link",{signal:s.signal,searchParams:T({arg:[`${r}`,n.Name??n.name??null],...s}),headers:s.headers}),{Hash:o}=await i.json();return M.parse(o)}}function Dx(t){return{addLink:Ox(t),rmLink:Px(t)}}function Lx(t,e){return{patch:Dx(t)}}function Rx(t){return Symbol.iterator in t}function Fx(t){return Symbol.asyncIterator in t}function Ja(t){return M.asCID(t)!=null}async function*Rf(t){if(t==null)throw new Ze(`Unexpected input: ${t}`);const e=M.asCID(t);if(e!=null){yield $e({cid:e});return}if(typeof t=="string"){yield $e({path:t});return}if(t.cid!=null||t.path!=null)return yield $e(t);if(Rx(t)){const r=t[Symbol.iterator](),n=r.next();if(n.done===!0)return r;if(Ja(n.value)){yield $e({cid:n.value});for(const s of r)yield $e({cid:s});return}if(typeof n.value=="string"){yield $e({path:n.value});for(const s of r)yield $e({path:s});return}if(n.value.cid!=null||n.value.path!=null){yield $e(n.value);for(const s of r)yield $e(s);return}throw new Ze(`Unexpected input: ${typeof t}`)}if(Fx(t)){const r=t[Symbol.asyncIterator](),n=await r.next();if(n.done===!0)return r;if(Ja(n.value)){yield $e({cid:n.value});for await(const s of r)yield $e({cid:s});return}if(typeof n.value=="string"){yield $e({path:n.value});for await(const s of r)yield $e({path:s});return}if(n.value.cid!=null||n.value.path!=null){yield $e(n.value);for await(const s of r)yield $e(s);return}throw new Ze(`Unexpected input: ${typeof t}`)}throw new Ze(`Unexpected input: ${typeof t}`)}function $e(t){const e=t.cid??`${t.path}`;if(e==null)throw new Ze("Unexpected input: Please path either a CID or an IPFS path");const r={path:e,recursive:t.recursive!==!1};return t.metadata!=null&&(r.metadata=t.metadata),r}function Ff(t){return async function*(r,n={}){for await(const{path:s,recursive:i,metadata:o}of Rf(r)){const a=await t.post("pin/add",{signal:n.signal,searchParams:T({...n,arg:s,recursive:i,metadata:o!=null?JSON.stringify(o):void 0,stream:!0}),headers:n.headers});for await(const c of a.ndjson()){if(c.Pins!=null){for(const f of c.Pins)yield M.parse(f);continue}yield M.parse(c)}}}}function Vx(t){const e=Ff(t);return async function(n,s={}){const i=await ys(e([{path:n.toString(),...s}],s));if(i==null)throw new Error("No response received");return i}}function Za(t,e,r){const n={type:t,cid:M.parse(e)};return r!=null&&(n.metadata=r),n}function Hx(t){return async function*(r={}){let n=[];r.paths!=null&&(n=Array.isArray(r.paths)?r.paths:[r.paths]);const s=await t.post("pin/ls",{signal:r.signal,searchParams:T({...r,arg:n.map(i=>`${i}`),stream:!0}),headers:r.headers});for await(const i of s.ndjson()){if(i.Keys!=null){for(const o of Object.keys(i.Keys))yield Za(i.Keys[o].Type,o,i.Keys[o].Metadata);return}yield Za(i.Type,i.Cid,i.Metadata)}}}const Vf=({Name:t,Status:e,Cid:r})=>({cid:M.parse(r),name:t,status:e}),Hf=t=>{if(typeof t=="string"&&t!=="")return t;throw new TypeError("service name must be passed")},Mf=t=>{if(M.asCID(t)!=null)return t.toString();throw new TypeError(`CID instance expected instead of ${typeof t}`)},ko=({service:t,cid:e,name:r,status:n,all:s})=>{const i=T({service:Hf(t),name:r,force:s===!0?!0:void 0});if(e!=null)for(const o of e)i.append("cid",Mf(o));if(n!=null)for(const o of n)i.append("status",o);return i},Mx=(t,{service:e,background:r,name:n,origins:s})=>{const i=T({arg:Mf(t),service:Hf(e),name:n,background:r===!0?!0:void 0});if(s!=null)for(const o of s)i.append("origin",o.toString());return i};function jx(t){return async function(r,{timeout:n,signal:s,headers:i,...o}){const a=await t.post("pin/remote/add",{timeout:n,signal:s,headers:i,searchParams:Mx(r,o)});return Vf(await a.json())}}function zx(t){return async function*({timeout:r,signal:n,headers:s,...i}){const o=await t.post("pin/remote/ls",{timeout:r,signal:n,headers:s,searchParams:ko(i)});for await(const a of o.ndjson())yield Vf(a)}}function Gx(t){return async function({timeout:r,signal:n,headers:s,...i}){await t.post("pin/remote/rm",{timeout:r,signal:n,headers:s,searchParams:ko({...i,all:!0})})}}function qx(t){return async function({timeout:r,signal:n,headers:s,...i}){await t.post("pin/remote/rm",{timeout:r,signal:n,headers:s,searchParams:ko({...i,all:!1})})}}function Wx(t){const e=String(t);if(e==="undefined")throw Error("endpoint is required");return e[e.length-1]==="/"?e.slice(0,-1):e}function Kx(t){const e={service:t.Service,endpoint:new URL(t.ApiEndpoint)};return t.Stat!=null&&(e.stat=Jx(t.Stat)),e}function Jx(t){switch(t.Status){case"valid":{const{Pinning:e,Pinned:r,Queued:n,Failed:s}=t.PinCount;return{status:"valid",pinCount:{queued:n,pinning:e,pinned:r,failed:s}}}case"invalid":return{status:"invalid"};default:return{status:t.Status}}}function Zx(t){return async function(r,n){const{endpoint:s,key:i,headers:o,timeout:a,signal:c}=n;await t.post("pin/remote/service/add",{timeout:a,signal:c,searchParams:T({arg:[r,Wx(s),i]}),headers:o})}}function Xx(t){return async function(r={}){const{stat:n,headers:s,timeout:i,signal:o}=r;return(await(await t.post("pin/remote/service/ls",{timeout:i,signal:o,headers:s,searchParams:n===!0?T({stat:n}):void 0})).json()).RemoteServices.map(Kx)}}function Yx(t){return async function(r,n={}){await t.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:T({arg:r})})}}function Qx(t){return{add:Zx(t),ls:Xx(t),rm:Yx(t)}}function eE(t){return{add:jx(t),ls:zx(t),rm:qx(t),rmAll:Gx(t),service:Qx(t)}}function jf(t){return async function*(r,n={}){for await(const{path:s,recursive:i}of Rf(r)){const o=new URLSearchParams(n.searchParams);o.append("arg",`${s}`),i!=null&&o.set("recursive",String(i));const a=await t.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:T({...n,arg:`${s}`,recursive:i})});for await(const c of a.ndjson()){if(c.Pins!=null){yield*c.Pins.map(f=>M.parse(f));continue}yield M.parse(c)}}}}function tE(t){const e=jf(t);return async function(n,s={}){const i=await ys(e([{path:n.toString(),...s}],s));if(i==null)throw new Error("No response received");return i}}function rE(t){return{addAll:Ff(t),add:Vx(t),ls:Hx(t),rmAll:jf(t),rm:tE(t),remote:eE(t)}}function nE(t){return async function*(r,n={}){yield*(await t.post("ping",{signal:n.signal,searchParams:T({arg:`${r}`,...n}),headers:n.headers,transform:Se})).ndjson()}}const sE=t=>Array.isArray(t)?t.map(Si):t,Si=t=>me(Kr(t)),Kr=t=>os.decode(t),iE=t=>BigInt(`0x${me(os.decode(t),"base16")}`),Io=t=>os.encode(it(t));function oE(t){return async function(r={}){const{Strings:n}=await(await t.post("pubsub/ls",{signal:r.signal,searchParams:T(r),headers:r.headers})).json();return sE(n)??[]}}function aE(t){return async function(r,n={}){const s=await t.post("pubsub/peers",{signal:n.signal,searchParams:T({arg:Io(r),...n}),headers:n.headers}),{Strings:i}=await s.json();return i??[]}}function cE(t){return async function(r,n,s={}){const i=T({arg:Io(r),...s}),o=new AbortController,a=At([o.signal,s.signal]);try{await(await t.post("pubsub/pub",{signal:a,searchParams:i,...await Mt([n],o,s.headers)})).text()}finally{a.clear()}}}const uE=So("js-kubo-rpc-client:pubsub:subscribe");function lE(t,e){return async function(n,s,i={}){i.signal=e.subscribe(n,s,i.signal);let o,a;const c=new Promise((u,l)=>{o=u,a=l}),f=setTimeout(()=>{o()},1e3);return t.post("pubsub/sub",{signal:i.signal,searchParams:T({arg:Io(n),...i}),headers:i.headers}).catch(u=>{e.unsubscribe(n,s),a(u)}).then(u=>{clearTimeout(f),u!=null&&(fE(u,{onMessage:l=>{if(s!=null){if(typeof s=="function"){s(l);return}typeof s.handleEvent=="function"&&s.handleEvent(l)}},onEnd:()=>{e.unsubscribe(n,s)},onError:i.onError}),o())}),c}}async function fE(t,{onMessage:e,onEnd:r,onError:n}){n=n??uE;try{for await(const s of t.ndjson())try{if(s.from==null)continue;s.from!=null&&s.seqno!=null?e({type:"signed",from:je(s.from),data:Kr(s.data),sequenceNumber:iE(s.seqno),topic:Si(s.topicIDs[0]),key:s.key!=null?Pb(Kr(s.key??"u")):void 0,signature:Kr(s.signature??"u")}):e({type:"unsigned",data:Kr(s.data),topic:Si(s.topicIDs[0])})}catch(i){i.message=`Failed to parse pubsub message: ${i.message}`,n(i,!1,s)}}catch(s){dE(s)||n(s,!0)}finally{r()}}const dE=t=>{switch(t.type){case"aborted":return!0;case"abort":return!0;default:return t.name==="AbortError"}};class hE{constructor(){m(this,"_subs");this._subs=new Map}subscribe(e,r,n){const s=this._subs.get(e)??[];if(s.find(o=>o.handler===r)!=null)throw new Error(`Already subscribed to ${e} with this handler`);const i=new AbortController;return this._subs.set(e,[{handler:r,controller:i}].concat(s)),n!=null&&n.addEventListener("abort",()=>{this.unsubscribe(e,r)}),i.signal}unsubscribe(e,r){const n=this._subs.get(e)??[];let s;r!=null?(this._subs.set(e,n.filter(i=>i.handler!==r)),s=n.filter(i=>i.handler===r)):(this._subs.set(e,[]),s=n),(this._subs.get(e)??[]).length===0&&this._subs.delete(e),s.forEach(i=>{i.controller.abort()})}}function pE(t,e){return async function(n,s){e.unsubscribe(n,s)}}function gE(t){const e=new hE;return{ls:oE(t),peers:aE(t),publish:cE(t),subscribe:lE(t,e),unsubscribe:pE(t,e)}}function yE(t){return async function*(r={}){yield*(await t.post("refs/local",{signal:r.signal,transform:Se,searchParams:T(r),headers:r.headers})).ndjson()}}function wE(t){async function*e(r,n={}){const s=Array.isArray(r)?r:[r];yield*(await t.post("refs",{signal:n.signal,searchParams:T({arg:s.map(o=>`${o instanceof Uint8Array?M.decode(o):o}`),...n}),headers:n.headers,transform:Se})).ndjson()}return Object.assign(e,{local:yE(t)})}function mE(t){return async function*(r={}){yield*(await t.post("repo/gc",{signal:r.signal,searchParams:T(r),headers:r.headers,transform:s=>{var i;return{err:s.Error!=null?new Error(s.Error):null,cid:((i=s.Key)==null?void 0:i["/"])!=null?M.parse(s.Key["/"]):null}}})).ndjson()}}function zf(t){return async function(r={}){const s=await(await t.post("repo/stat",{signal:r.signal,searchParams:T(r),headers:r.headers})).json();return{numObjects:BigInt(s.NumObjects),repoSize:BigInt(s.RepoSize),repoPath:s.RepoPath,version:s.Version,storageMax:BigInt(s.StorageMax)}}}function bE(t){return async function(r={}){return(await(await t.post("repo/version",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()).Version}}function vE(t){return{gc:mE(t),stat:zf(t),version:bE(t)}}function xE(t){return async function(r,n={}){const s=await t.post("resolve",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers}),{Path:i}=await s.json();return i}}function EE(t){return async function*(r,n={}){const s=await t.post("routing/findpeer",{signal:n.signal,searchParams:T({arg:r.toString(),stream:!0,...n}),headers:n.headers});for await(const i of s.ndjson())yield Fr(i)}}function BE(t){return async function*(r,n={}){const s=await t.post("routing/findprovs",{signal:n.signal,searchParams:T({arg:r.toString(),...n}),headers:n.headers});for await(const i of s.ndjson())yield Fr(i)}}function SE(t){return async function*(r,n={}){const s=await t.post("routing/get",{signal:n.signal,searchParams:T({arg:r instanceof Uint8Array?me(r):r.toString(),...n}),headers:n.headers});for await(const i of s.ndjson())yield Fr(i)}}function AE(t){return async function*(r,n={recursive:!1}){const s=Array.isArray(r)?r:[r],i=await t.post("routing/provide",{signal:n.signal,searchParams:T({arg:s.map(o=>o.toString()),...n}),headers:n.headers});for await(const o of i.ndjson())yield Fr(o)}}function kE(t){return async function*(r,n,s={}){const i=new AbortController,o=At([i.signal,s.signal]);try{const a=await t.post("routing/put",{signal:o,searchParams:T({arg:r instanceof Uint8Array?me(r):r.toString(),stream:!0,...s}),...await Mt([n],i,s.headers)});for await(const c of a.ndjson())yield Fr(c)}finally{o.clear()}}}function IE(t){return{findPeer:EE(t),findProvs:BE(t),get:SE(t),provide:AE(t),put:kE(t)}}function CE(t){return async function*(r={}){yield*(await t.post("stats/bw",{signal:r.signal,searchParams:T(r),headers:r.headers,transform:s=>({totalIn:BigInt(s.TotalIn),totalOut:BigInt(s.TotalOut),rateIn:parseFloat(s.RateIn),rateOut:parseFloat(s.RateOut)})})).ndjson()}}function TE(t){return{bitswap:Sf(t),repo:zf(t),bw:CE(t)}}function NE(t){return async function(r={}){await(await t.post("shutdown",{signal:r.signal,searchParams:T(r),headers:r.headers})).text()}}function UE(t){return async function(r={}){const n=await t.post("swarm/addrs",{signal:r.signal,searchParams:T(r),headers:r.headers}),{Addrs:s}=await n.json();return Object.keys(s).map(i=>({id:je(i),addrs:(s[i]??[]).map(o=>Ve(o))}))}}function $E(t){return async function(r,n={}){const s=await t.post("swarm/connect",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers}),{Strings:i}=await s.json();return i??[]}}function _E(t){return async function(r,n={}){const s=await t.post("swarm/disconnect",{signal:n.signal,searchParams:T({arg:r,...n}),headers:n.headers}),{Strings:i}=await s.json();return i??[]}}function OE(t){return async function(r={}){const n=await t.post("swarm/addrs/local",{signal:r.signal,searchParams:T(r),headers:r.headers}),{Strings:s}=await n.json();return(s??[]).map(i=>Ve(i))}}function PE(t){return async function(r={}){return((await(await t.post("swarm/peers",{signal:r.signal,searchParams:T(r),headers:r.headers})).json()).Peers??[]).map(i=>({addr:Ve(i.Addr),peer:je(i.Peer),muxer:i.Muxer,latency:i.Latency,streams:i.Streams,direction:i.Direction==null?void 0:i.Direction===0?"inbound":"outbound"}))}}function DE(t){return{addrs:UE(t),connect:$E(t),disconnect:_E(t),localAddrs:OE(t),peers:PE(t)}}function LE(t){return async function(r={}){const n=await t.post("version",{signal:r.signal,searchParams:T(r),headers:r.headers});return{...Se(await n.json()),"ipfs-http-client":"1.0.0"}}}class RE{constructor(e){m(this,"bases");m(this,"codecs");m(this,"hashers");m(this,"bitswap");m(this,"block");m(this,"bootstrap");m(this,"config");m(this,"dag");m(this,"dht");m(this,"diag");m(this,"files");m(this,"key");m(this,"log");m(this,"name");m(this,"object");m(this,"pin");m(this,"pubsub");m(this,"refs");m(this,"repo");m(this,"routing");m(this,"stats");m(this,"swarm");m(this,"add");m(this,"addAll");m(this,"cat");m(this,"get");m(this,"ls");m(this,"id");m(this,"version");m(this,"stop");m(this,"ping");m(this,"resolve");m(this,"commands");m(this,"mount");m(this,"isOnline");m(this,"getEndpointConfig");var a,c,f,u,l,d;const r=new hx(e),n={name:Kt.name,code:Kt.code,encode:h=>h,decode:h=>h},s=Object.values(Vn);(((a=e.ipld)==null?void 0:a.bases)??[]).forEach(h=>s.push(h)),this.bases=new gx({bases:s,loadBase:(c=e.ipld)==null?void 0:c.loadBase});const i=Object.values(np);[M0,s0,E0,My,n].concat(((f=e.ipld)==null?void 0:f.codecs)??[]).forEach(h=>{i.push(h)}),this.codecs=new wx({codecs:i,loadCodec:(u=e.ipld)==null?void 0:u.loadCodec});const o=Object.values(rp);(((l=e.ipld)==null?void 0:l.hashers)??[]).forEach(h=>o.push(h)),this.hashers=new bx({hashers:o,loadHasher:(d=e.ipld)==null?void 0:d.loadHasher}),this.bitswap=Jb(r),this.block=e1(r),this.bootstrap=s1(r),this.config=p1(r),this.dag=E1(r,this.codecs),this.dht=$1(r),this.diag=D1(r),this.files=J1(r),this.key=iv(r),this.log=Bx(r),this.name=_x(r),this.object=Lx(r,this.codecs),this.pin=rE(r),this.pubsub=gE(r),this.refs=wE(r),this.repo=vE(r),this.routing=IE(r),this.stats=TE(r),this.swarm=DE(r),this.add=hw(r),this.addAll=Iu(r),this.cat=i1(r),this.get=X1(r),this.ls=Sx(r),this.id=If(r),this.version=LE(r),this.stop=NE(r),this.ping=nE(r),this.resolve=xE(r),this.commands=o1(r),this.mount=kx(r),this.isOnline=Y1(r),this.getEndpointConfig=Z1(r)}}function FE(t){return new RE(t)}function VE(t={}){return(typeof t=="string"||Hn(t)||t instanceof URL)&&(t={url:t}),FE(t)}function HE(t){if(Array.isArray(t))return t}function ME(t,e){var r=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r!=null){var n,s,i,o,a=[],c=!0,f=!1;try{if(i=(r=r.call(t)).next,e===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(a.push(n.value),a.length!==e);c=!0);}catch(u){f=!0,s=u}finally{try{if(!c&&r.return!=null&&(o=r.return(),Object(o)!==o))return}finally{if(f)throw s}}return a}}function Ai(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Gf(t,e){if(t){if(typeof t=="string")return Ai(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ai(t,e):void 0}}function jE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Co(t,e){return HE(t)||ME(t,e)||Gf(t,e)||jE()}var tr={},vn={};Object.defineProperty(vn,"__esModule",{value:!0});vn.bind=void 0;function zE(t,e){var r=e.type,n=e.listener,s=e.options;return t.addEventListener(r,n,s),function(){t.removeEventListener(r,n,s)}}vn.bind=zE;var As={},pr=Xs&&Xs.__assign||function(){return pr=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s])}return t},pr.apply(this,arguments)};Object.defineProperty(As,"__esModule",{value:!0});As.bindAll=void 0;var GE=vn;function Xa(t){if(!(typeof t>"u"))return typeof t=="boolean"?{capture:t}:t}function qE(t,e){if(e==null)return t;var r=pr(pr({},t),{options:pr(pr({},Xa(e)),Xa(t.options))});return r}function WE(t,e,r){var n=e.map(function(s){var i=qE(s,r);return(0,GE.bind)(t,i)});return function(){n.forEach(function(i){return i()})}}As.bindAll=WE;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.bindAll=t.bind=void 0;var e=vn;Object.defineProperty(t,"bind",{enumerable:!0,get:function(){return e.bind}});var r=As;Object.defineProperty(t,"bindAll",{enumerable:!0,get:function(){return r.bindAll}})})(tr);var qf="data-pdnd-honey-pot";function Wf(t){return t instanceof Element&&t.hasAttribute(qf)}function Kf(t){var e=document.elementsFromPoint(t.x,t.y),r=Co(e,2),n=r[0],s=r[1];return n?Wf(n)?s??null:n:null}function fn(t){"@babel/helpers - typeof";return fn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(t)}function KE(t,e){if(fn(t)!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(fn(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JE(t){var e=KE(t,"string");return fn(e)=="symbol"?e:e+""}function xn(t,e,r){return(e=JE(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var Jf=2147483647;function Ya(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Qa(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?Ya(Object(r),!0).forEach(function(n){xn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ya(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var dn=2,ec=dn/2;function ZE(t){return{x:Math.floor(t.x),y:Math.floor(t.y)}}function XE(t){return{x:t.x-ec,y:t.y-ec}}function YE(t){return{x:Math.max(t.x,0),y:Math.max(t.y,0)}}function QE(t){return{x:Math.min(t.x,window.innerWidth-dn),y:Math.min(t.y,window.innerHeight-dn)}}function tc(t){var e=t.client,r=QE(YE(XE(ZE(e))));return DOMRect.fromRect({x:r.x,y:r.y,width:dn,height:dn})}function rc(t){var e=t.clientRect;return{left:"".concat(e.left,"px"),top:"".concat(e.top,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}}function e2(t){var e=t.client,r=t.clientRect;return e.x>=r.x&&e.x<=r.x+r.width&&e.y>=r.y&&e.y<=r.y+r.height}function t2(t){var e=t.initial,r=document.createElement("div");r.setAttribute(qf,"true");var n=tc({client:e});Object.assign(r.style,Qa(Qa({backgroundColor:"transparent",position:"fixed",padding:0,margin:0,boxSizing:"border-box"},rc({clientRect:n})),{},{pointerEvents:"auto",zIndex:Jf})),document.body.appendChild(r);var s=tr.bind(window,{type:"pointermove",listener:function(o){var a={x:o.clientX,y:o.clientY};n=tc({client:a}),Object.assign(r.style,rc({clientRect:n}))},options:{capture:!0}});return function(o){var a=o.current;if(s(),e2({client:a,clientRect:n})){r.remove();return}function c(){f(),r.remove()}var f=tr.bindAll(window,[{type:"pointerdown",listener:c},{type:"pointermove",listener:c},{type:"focusin",listener:c},{type:"focusout",listener:c},{type:"dragstart",listener:c},{type:"dragenter",listener:c},{type:"dragover",listener:c}],{capture:!0})}}function r2(){var t=null;function e(){return t=null,tr.bind(window,{type:"pointermove",listener:function(s){t={x:s.clientX,y:s.clientY}},options:{capture:!0}})}function r(){var n=null;return function(i){var o=i.eventName,a=i.payload;if(o==="onDragStart"){var c,f=a.location.initial.input,u=(c=t)!==null&&c!==void 0?c:{x:f.clientX,y:f.clientY};n=t2({initial:u})}if(o==="onDrop"){var l,d=a.location.current.input;(l=n)===null||l===void 0||l({current:{x:d.clientX,y:d.clientY}}),n=null,t=null}}}return{bindEvents:e,getOnPostDispatch:r}}function n2(t){if(Array.isArray(t))return Ai(t)}function s2(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function i2(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zf(t){return n2(t)||s2(t)||Gf(t)||i2()}function To(t){var e=null;return function(){if(!e){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];var o=t.apply(this,s);e={result:o}}return e.result}}var o2=To(function(){return navigator.userAgent.includes("Firefox")}),ks=To(function(){var e=navigator,r=e.userAgent;return r.includes("AppleWebKit")&&!r.includes("Chrome")}),ki={isLeavingWindow:Symbol("leaving"),isEnteringWindow:Symbol("entering")};function a2(t){var e=t.dragLeave;return ks()?e.hasOwnProperty(ki.isLeavingWindow):!1}(function(){if(typeof window>"u"||!ks())return;function e(){return{enterCount:0,isOverWindow:!1}}var r=e();function n(){r=e()}tr.bindAll(window,[{type:"dragstart",listener:function(){r.enterCount=0,r.isOverWindow=!0}},{type:"drop",listener:n},{type:"dragend",listener:n},{type:"dragenter",listener:function(i){!r.isOverWindow&&r.enterCount===0&&(i[ki.isEnteringWindow]=!0),r.isOverWindow=!0,r.enterCount++}},{type:"dragleave",listener:function(i){r.enterCount--,r.isOverWindow&&r.enterCount===0&&(i[ki.isLeavingWindow]=!0,r.isOverWindow=!1)}}],{capture:!0})})();function c2(t){return"nodeName"in t}function u2(t){return c2(t)&&t.ownerDocument!==document}function l2(t){var e=t.dragLeave,r=e.type,n=e.relatedTarget;return r!=="dragleave"?!1:ks()?a2({dragLeave:e}):n==null?!0:o2()?u2(n):n instanceof HTMLIFrameElement}function f2(t){var e=t.onDragEnd;return[{type:"pointermove",listener:function(){var r=0;return function(){if(r<20){r++;return}e()}}()},{type:"pointerdown",listener:e}]}function tn(t){return{altKey:t.altKey,button:t.button,buttons:t.buttons,ctrlKey:t.ctrlKey,metaKey:t.metaKey,shiftKey:t.shiftKey,clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var d2=function(e){var r=[],n=null,s=function(){for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];r=a,!n&&(n=requestAnimationFrame(function(){n=null,e.apply(void 0,r)}))};return s.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},s},qs=d2(function(t){return t()}),$n=function(){var t=null;function e(n){var s=requestAnimationFrame(function(){t=null,n()});t={frameId:s,fn:n}}function r(){t&&(cancelAnimationFrame(t.frameId),t.fn(),t=null)}return{schedule:e,flush:r}}();function h2(t){var e=t.source,r=t.initial,n=t.dispatchEvent,s={dropTargets:[]};function i(a){n(a),s={dropTargets:a.payload.location.current.dropTargets}}var o={start:function(c){var f=c.nativeSetDragImage,u={current:r,previous:s,initial:r};i({eventName:"onGenerateDragPreview",payload:{source:e,location:u,nativeSetDragImage:f}}),$n.schedule(function(){i({eventName:"onDragStart",payload:{source:e,location:u}})})},dragUpdate:function(c){var f=c.current;$n.flush(),qs.cancel(),i({eventName:"onDropTargetChange",payload:{source:e,location:{initial:r,previous:s,current:f}}})},drag:function(c){var f=c.current;qs(function(){$n.flush();var u={initial:r,previous:s,current:f};i({eventName:"onDrag",payload:{source:e,location:u}})})},drop:function(c){var f=c.current,u=c.updatedSourcePayload;$n.flush(),qs.cancel(),i({eventName:"onDrop",payload:{source:u??e,location:{current:f,previous:s,initial:r}}})}};return o}var Ii={isActive:!1};function Xf(){return!Ii.isActive}function p2(t){return t.dataTransfer?t.dataTransfer.setDragImage.bind(t.dataTransfer):null}function g2(t){var e=t.current,r=t.next;if(e.length!==r.length)return!0;for(var n=0;n<e.length;n++)if(e[n].element!==r[n].element)return!0;return!1}function y2(t){var e=t.event,r=t.dragType,n=t.getDropTargetsOver,s=t.dispatchEvent;if(!Xf())return;var i=w2({event:e,dragType:r,getDropTargetsOver:n});Ii.isActive=!0;var o={current:i};Ws({event:e,current:i.dropTargets});var a=h2({source:r.payload,dispatchEvent:s,initial:i});function c(h){var g=g2({current:o.current.dropTargets,next:h.dropTargets});o.current=h,g&&a.dragUpdate({current:o.current})}function f(h){var g=tn(h),v=Wf(h.target)?Kf({x:g.clientX,y:g.clientY}):h.target,p=n({target:v,input:g,source:r.payload,current:o.current.dropTargets});p.length&&(h.preventDefault(),Ws({event:h,current:p})),c({dropTargets:p,input:g})}function u(){o.current.dropTargets.length&&c({dropTargets:[],input:o.current.input}),a.drop({current:o.current,updatedSourcePayload:null}),l()}function l(){Ii.isActive=!1,d()}var d=tr.bindAll(window,[{type:"dragover",listener:function(g){f(g),a.drag({current:o.current})}},{type:"dragenter",listener:f},{type:"dragleave",listener:function(g){l2({dragLeave:g})&&(c({input:o.current.input,dropTargets:[]}),r.startedFrom==="external"&&u())}},{type:"drop",listener:function(g){if(o.current={dropTargets:o.current.dropTargets,input:tn(g)},!o.current.dropTargets.length){u();return}g.preventDefault(),Ws({event:g,current:o.current.dropTargets}),a.drop({current:o.current,updatedSourcePayload:r.type==="external"?r.getDropPayload(g):null}),l()}},{type:"dragend",listener:function(g){o.current={dropTargets:o.current.dropTargets,input:tn(g)},u()}}].concat(Zf(f2({onDragEnd:u}))),{capture:!0});a.start({nativeSetDragImage:p2(e)})}function Ws(t){var e,r=t.event,n=t.current,s=(e=n[0])===null||e===void 0?void 0:e.dropEffect;s!=null&&r.dataTransfer&&(r.dataTransfer.dropEffect=s)}function w2(t){var e=t.event,r=t.dragType,n=t.getDropTargetsOver,s=tn(e);if(r.startedFrom==="external")return{input:s,dropTargets:[]};var i=n({input:s,source:r.payload,target:e.target,current:[]});return{input:s,dropTargets:i}}var nc={canStart:Xf,start:y2},Ci=new Map;function m2(t){var e=t.typeKey,r=t.mount,n=Ci.get(e);if(n)return n.usageCount++,n;var s={typeKey:e,unmount:r(),usageCount:1};return Ci.set(e,s),s}function b2(t){var e=m2(t);return function(){e.usageCount--,!(e.usageCount>0)&&(e.unmount(),Ci.delete(t.typeKey))}}function Is(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return function(){e.forEach(function(s){return s()})}}function Yf(t,e){var r=e.attribute,n=e.value;return t.setAttribute(r,n),function(){return t.removeAttribute(r)}}function sc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function Ot(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?sc(Object(r),!0).forEach(function(n){xn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):sc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function Ks(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=v2(t))||e){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,o=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var f=r.next();return o=f.done,f},e:function(f){a=!0,i=f},f:function(){try{o||r.return==null||r.return()}finally{if(a)throw i}}}}function v2(t,e){if(t){if(typeof t=="string")return ic(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ic(t,e):void 0}}function ic(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Js(t){return t.slice(0).reverse()}function x2(t){var e=t.typeKey,r=t.defaultDropEffect,n=new WeakMap,s="data-drop-target-for-".concat(e),i="[".concat(s,"]");function o(h){return n.set(h.element,h),function(){return n.delete(h.element)}}function a(h){return Is(Yf(h.element,{attribute:s,value:"true"}),o(h))}function c(h){var g,v,p,y,E=h.source,b=h.target,B=h.input,N=h.result,A=N===void 0?[]:N;if(b==null)return A;if(!(b instanceof Element))return b instanceof Node?c({source:E,target:b.parentElement,input:B,result:A}):A;var k=b.closest(i);if(k==null)return A;var I=n.get(k);if(I==null)return A;var C={input:B,source:E,element:I.element};if(I.canDrop&&!I.canDrop(C))return c({source:E,target:I.element.parentElement,input:B,result:A});var R=(g=(v=I.getData)===null||v===void 0?void 0:v.call(I,C))!==null&&g!==void 0?g:{},V=(p=(y=I.getDropEffect)===null||y===void 0?void 0:y.call(I,C))!==null&&p!==void 0?p:r,F={data:R,element:I.element,dropEffect:V,isActiveDueToStickiness:!1};return c({source:E,target:I.element.parentElement,input:B,result:[].concat(Zf(A),[F])})}function f(h){var g=h.eventName,v=h.payload,p=Ks(v.location.current.dropTargets),y;try{for(p.s();!(y=p.n()).done;){var E,b=y.value,B=n.get(b.element),N=Ot(Ot({},v),{},{self:b});B==null||(E=B[g])===null||E===void 0||E.call(B,N)}}catch(A){p.e(A)}finally{p.f()}}var u={onGenerateDragPreview:f,onDrag:f,onDragStart:f,onDrop:f,onDropTargetChange:function(g){var v=g.payload,p=new Set(v.location.current.dropTargets.map(function(x){return x.element})),y=new Set,E=Ks(v.location.previous.dropTargets),b;try{for(E.s();!(b=E.n()).done;){var B,N=b.value;y.add(N.element);var A=n.get(N.element),k=p.has(N.element),I=Ot(Ot({},v),{},{self:N});if(A==null||(B=A.onDropTargetChange)===null||B===void 0||B.call(A,I),!k){var C;A==null||(C=A.onDragLeave)===null||C===void 0||C.call(A,I)}}}catch(x){E.e(x)}finally{E.f()}var R=Ks(v.location.current.dropTargets),V;try{for(R.s();!(V=R.n()).done;){var F,Y,O=V.value;if(!y.has(O.element)){var D=Ot(Ot({},v),{},{self:O}),S=n.get(O.element);S==null||(F=S.onDropTargetChange)===null||F===void 0||F.call(S,D),S==null||(Y=S.onDragEnter)===null||Y===void 0||Y.call(S,D)}}}catch(x){R.e(x)}finally{R.f()}}};function l(h){u[h.eventName](h)}function d(h){var g=h.source,v=h.target,p=h.input,y=h.current,E=c({source:g,target:v,input:p});if(E.length>=y.length)return E;for(var b=Js(y),B=Js(E),N=[],A=0;A<b.length;A++){var k,I=b[A],C=B[A];if(C!=null){N.push(C);continue}var R=N[A-1],V=b[A-1];if((R==null?void 0:R.element)!==(V==null?void 0:V.element))break;var F=n.get(I.element);if(!F)break;var Y={input:p,source:g,element:F.element};if(F.canDrop&&!F.canDrop(Y)||!((k=F.getIsSticky)!==null&&k!==void 0&&k.call(F,Y)))break;N.push(Ot(Ot({},I),{},{isActiveDueToStickiness:!0}))}return Js(N)}return{dropTargetForConsumers:a,getIsOver:d,dispatchEvent:l}}function E2(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=B2(t))||e){r&&(t=r);var n=0,s=function(){};return{s,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(f){throw f},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i,o=!0,a=!1;return{s:function(){r=r.call(t)},n:function(){var f=r.next();return o=f.done,f},e:function(f){a=!0,i=f},f:function(){try{o||r.return==null||r.return()}finally{if(a)throw i}}}}function B2(t,e){if(t){if(typeof t=="string")return oc(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?oc(t,e):void 0}}function oc(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function ac(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function S2(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?ac(Object(r),!0).forEach(function(n){xn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ac(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function A2(){var t=new Set,e=null;function r(i){e&&(!i.canMonitor||i.canMonitor(e.canMonitorArgs))&&e.active.add(i)}function n(i){var o=S2({},i);return t.add(o),r(o),function(){t.delete(o),e&&e.active.delete(o)}}function s(i){var o=i.eventName,a=i.payload;if(o==="onGenerateDragPreview"){e={canMonitorArgs:{initial:a.location.initial,source:a.source},active:new Set};var c=E2(t),f;try{for(c.s();!(f=c.n()).done;){var u=f.value;r(u)}}catch(p){c.e(p)}finally{c.f()}}if(e){for(var l=Array.from(e.active),d=0,h=l;d<h.length;d++){var g=h[d];if(e.active.has(g)){var v;(v=g[o])===null||v===void 0||v.call(g,a)}}o==="onDrop"&&(e.active.clear(),e=null)}}return{dispatchEvent:s,monitorForConsumers:n}}function k2(t){var e=t.typeKey,r=t.mount,n=t.dispatchEventToSource,s=t.onPostDispatch,i=t.defaultDropEffect,o=A2(),a=x2({typeKey:e,defaultDropEffect:i});function c(l){n==null||n(l),a.dispatchEvent(l),o.dispatchEvent(l),s==null||s(l)}function f(l){var d=l.event,h=l.dragType;nc.start({event:d,dragType:h,getDropTargetsOver:a.getIsOver,dispatchEvent:c})}function u(){function l(){var d={canStart:nc.canStart,start:f};return r(d)}return b2({typeKey:e,mount:l})}return{registerUsage:u,dropTarget:a.dropTargetForConsumers,monitor:o.monitorForConsumers}}var I2=To(function(){return navigator.userAgent.toLocaleLowerCase().includes("android")}),C2="pdnd:android-fallback",cc="text/plain",T2="text/uri-list",N2="application/vnd.pdnd",ns=new WeakMap;function U2(t){return ns.set(t.element,t),function(){ns.delete(t.element)}}var uc=r2(),No=k2({typeKey:"element",defaultDropEffect:"move",mount:function(e){return Is(uc.bindEvents(),tr.bind(document,{type:"dragstart",listener:function(n){var s,i,o,a,c,f;if(e.canStart(n)&&!n.defaultPrevented&&n.dataTransfer){var u=n.target;if(!(u instanceof HTMLElement))return null;var l=ns.get(u);if(!l)return null;var d=tn(n),h={element:l.element,dragHandle:(s=l.dragHandle)!==null&&s!==void 0?s:null,input:d};if(l.canDrag&&!l.canDrag(h))return n.preventDefault(),null;if(l.dragHandle){var g=Kf({x:d.clientX,y:d.clientY});if(!l.dragHandle.contains(g))return n.preventDefault(),null}var v=(i=(o=l.getInitialDataForExternal)===null||o===void 0?void 0:o.call(l,h))!==null&&i!==void 0?i:null;if(v)for(var p=0,y=Object.entries(v);p<y.length;p++){var E=Co(y[p],2),b=E[0],B=E[1];n.dataTransfer.setData(b,B??"")}I2()&&!n.dataTransfer.types.includes(cc)&&!n.dataTransfer.types.includes(T2)&&n.dataTransfer.setData(cc,C2),n.dataTransfer.setData(N2,"");var N={element:l.element,dragHandle:(a=l.dragHandle)!==null&&a!==void 0?a:null,data:(c=(f=l.getInitialData)===null||f===void 0?void 0:f.call(l,h))!==null&&c!==void 0?c:{}},A={type:"element",payload:N,startedFrom:"internal"};e.start({event:n,dragType:A})}}}))},dispatchEventToSource:function(e){var r,n,s=e.eventName,i=e.payload;(r=ns.get(i.source.element))===null||r===void 0||(n=r[s])===null||n===void 0||n.call(r,i)},onPostDispatch:uc.getOnPostDispatch()}),$2=No.dropTarget,Qf=No.monitor;function _2(t){return Is(No.registerUsage(),U2(t),Yf(t.element,{attribute:"draggable",value:"true"}))}function lc(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),r.push.apply(r,n)}return r}function fc(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?lc(Object(r),!0).forEach(function(n){xn(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):lc(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}var O2={top:function(e,r){return Math.abs(r.y-e.top)},right:function(e,r){return Math.abs(e.right-r.x)},bottom:function(e,r){return Math.abs(e.bottom-r.y)},left:function(e,r){return Math.abs(r.x-e.left)}},ed=Symbol("closestEdge");function P2(t,e){var r,n,s=e.element,i=e.input,o=e.allowedEdges,a={x:i.clientX,y:i.clientY},c=s.getBoundingClientRect(),f=o.map(function(l){return{edge:l,value:O2[l](c,a)}}),u=(r=(n=f.sort(function(l,d){return l.value-d.value})[0])===null||n===void 0?void 0:n.edge)!==null&&r!==void 0?r:null;return fc(fc({},t),{},xn({},ed,u))}function Ti(t){var e;return(e=t[ed])!==null&&e!==void 0?e:null}function D2(t){var e=t.list,r=t.startIndex,n=t.finishIndex;if(r===-1||n===-1)return e;var s=Array.from(e),i=s.splice(r,1),o=Co(i,1),a=o[0];return s.splice(n,0,a),s}function L2(t){var e=t.startIndex,r=t.closestEdgeOfTarget,n=t.indexOfTarget,s=t.axis;if(e===-1||n===-1||e===n)return e;if(r==null)return n;var i=s==="vertical"&&r==="bottom"||s==="horizontal"&&r==="right",o=e<n;return o?i?n:n-1:i?n+1:n}function R2(t){var e=t.list,r=t.startIndex,n=t.closestEdgeOfTarget,s=t.indexOfTarget,i=t.axis;return D2({list:e,startIndex:r,finishIndex:L2({closestEdgeOfTarget:n,startIndex:r,indexOfTarget:s,axis:i})})}var F2={none:0,small:100,medium:350,large:700};function V2(t){t.animate([{backgroundColor:"var(--ds-background-selected, #E9F2FF)"},{}],{duration:F2.large,easing:"cubic-bezier(0.25, 0.1, 0.25, 1.0)",iterations:1})}function H2(){return{x:0,y:0}}function M2(t){var e=t.render,r=t.nativeSetDragImage,n=t.getOffset,s=n===void 0?H2:n,i=document.createElement("div");Object.assign(i.style,{position:"fixed",top:0,left:0,zIndex:Jf,pointerEvents:"none"}),document.body.append(i);var o=e({container:i});queueMicrotask(function(){var f=s({container:i});if(ks()){var u=i.getBoundingClientRect();if(u.width===0)return;i.style.left="-".concat(u.width-1e-4,"px")}r==null||r(i,f.x,f.y)});function a(){c(),o==null||o(),document.body.removeChild(i)}var c=Qf({onDragStart:a,onDrop:a})}function j2(t){return function(e){var r=e.container;return Object.assign(r.style,{borderLeft:"".concat(t.x," solid transparent"),borderTop:"".concat(t.y," solid transparent")}),{x:0,y:0}}}var z2="Invariant failed";function G2(t,e){if(!t)throw new Error(z2)}var q2=Xe("<div></div>");function W2(t,e){let r=Vt(e,"edge",3,"top"),n=Vt(e,"gap",3,"0.5rem");const s=2,i=8,o=(s-i)/2,a=`calc(-0.5 * (${n()} + ${s}px))`;var c=q2();st(()=>{$i(c,_i(["drop-indicator",`${r()}`]),"svelte-1m3o7hh"),bt(c,"--line-thickness",`${s}px`),bt(c,"--line-offset",a),bt(c,"--terminal-size",`${i}px`),bt(c,"--terminal-radius",`${i/2}px`),bt(c,"--negative-terminal-size",`-${i}px`),bt(c,"--offset-terminal",`${o}px`),bt(c,"position","absolute"),bt(c,"pointer-events","none")}),ve(t,c)}var K2=dd(`<li class="relative"><div><script lang="ts">
    // @ts-ignore
  <\/script> <!></div> <!></li>`);function J2(t,e){rr(e,!0);const r={type:"idle"};let n=Vt(e,"datum",15,null);if(n()==null)throw new Error("`null` `datum`.");let s=nt(null),i=nt(he(r));mc(()=>(G2(W(s)),Is(_2({element:W(s),getInitialData(){return n()},onGenerateDragPreview({nativeSetDragImage:l}){M2({nativeSetDragImage:l,getOffset:j2({x:"1rem",y:"0.5rem"}),render({container:d}){e.preview!=null&&(ce(i,he({type:"preview",container:d})),yd(e.preview,{target:d,props:{datum:n()}}))}})},onDragStart(){ce(i,he({type:"is-dragging"}))},onDrop(){ce(i,he(r))}}),$2({element:W(s),canDrop({source:l}){return l.element===W(s)?!1:e.isDatum(l.data)},getData({input:l}){return n()==null?{}:W(s)==null?n():P2(n(),{element:W(s),input:l,allowedEdges:["top","bottom"]})},getIsSticky(){return!0},onDragEnter({self:l}){const d=Ti(l.data);ce(i,he({type:"is-dragging-over",closestEdge:d}))},onDrag({self:l}){const d=Ti(l.data);ce(i,he({type:"is-dragging-over",closestEdge:d}))},onDragLeave(){ce(i,he(r))},onDrop(){ce(i,he(r))}}))));var o=K2(),a=fe(o),c=_e(fe(a),2);xd(c,()=>e.row,(l,d)=>{d(l,{get datum(){return n()},set datum(h){n(h)}})}),ue(a),dr(a,l=>ce(s,l),()=>W(s));var f=_e(a,2);{var u=l=>{W2(l,{get edge(){return W(i).closestEdge},gap:"0.5rem"})};Zr(f,l=>{W(i).type==="is-dragging-over"&&W(i).closestEdge&&l(u)})}ue(o),st(l=>{var d,h;Ie(a,"data-element-id",(d=n())==null?void 0:d.id),$i(a,_i(l)),bt(a,"view-transition-name",`item-${(h=n())==null?void 0:h.id}`)},[()=>{var l;return(l=e.rowClasses)==null?void 0:l.call(e,W(i).type)}]),ve(t,o),nr()}var Z2=Xe("<ol></ol>");function X2(t,e){rr(e,!0);let r=Vt(e,"data",31,()=>he([])),n=Vt(e,"history",27,()=>he([]));const s=o=>e.isDatum?e.isDatum(o):!0;mc(()=>Qf({canMonitor({source:o}){return s(o.data)},onDrop({location:o,source:a}){const[c]=o.current.dropTargets;if(!c)return;const{data:f}=a,{data:u}=c;if(!s(f)||!s(u))return;const l=p=>r().findIndex(({id:y})=>y===p),d=l(f.id),h=l(u.id);if(h<0||d<0)return;const g=Ti(u);document.startViewTransition(async()=>{n().push([...r()]),r(R2({list:r(),startIndex:d,indexOfTarget:h,closestEdgeOfTarget:g,axis:"vertical"})),await bc()});const v=document.querySelector(`[data-element-id="${f.id}"]`);v instanceof HTMLElement&&V2(v)}}));var i=Z2();vd(i,23,r,o=>o.id,(o,a,c)=>{J2(o,{get row(){return e.row},get rowClasses(){return e.rowClasses},get preview(){return e.preview},isDatum:s,get datum(){return r()[W(c)]},set datum(f){r(r()[W(c)]=f,!0)}})}),ue(i),st(o=>$i(i,_i(o)),[()=>[...Array.from(e.listClasses??[]),"sortable-list"]]),ve(t,i),nr()}var Y2=Xe('<img class="svelte-akvkx7">'),Q2=Xe("<audio controls><source></audio>"),eB=Xe('<video controls class="svelte-akvkx7"><source> <track kind="captions"></video>',2),tB=Xe(`<object class="svelte-akvkx7"><p>Your browser can't render an <code>&lt;object&gt;</code> of type <q></q>.</p></object>`);function td(t,e){rr(e,!0);const r=!!vc.url.searchParams.get("debug");let n=Vt(e,"content",15);const{cid:s,title:i,type:o}=e.datum;let a=pd(()=>{if(o==null)return"undefined";const[d,h,g]=Array.from(o.match(/^([^/]+)\/(.*)$/)??[]);return r&&console.debug({klass:h,ext:g}),g!=="svg+xml"?h:"object"});var c=Ts(),f=Jr(c);{var u=d=>{var h=Y2();Ie(h,"alt",i),dr(h,g=>n(g),()=>n()),st(g=>Ie(h,"src",g),[()=>En({cid:s})]),ve(d,h)},l=d=>{var h=Ts(),g=Jr(h);{var v=y=>{var E=Q2();Ie(E,"tabindex",-1);var b=fe(E);Ie(b,"type",o),ue(E),dr(E,B=>n(B),()=>n()),st(B=>Ie(b,"src",B),[()=>En({cid:s})]),ve(y,E)},p=y=>{var E=Ts(),b=Jr(E);{var B=A=>{var k=eB();Ie(k,"tabindex",-1);var I=fe(k);Ie(I,"type",o),Vo(2),ue(k),dr(k,C=>n(C),()=>n()),st(C=>Ie(I,"src",C),[()=>En({cid:s})]),ve(A,k)},N=A=>{var k=tB();Ie(k,"title",i),Ie(k,"type",o);var I=fe(k),C=_e(fe(I),3);C.textContent=o,Vo(),ue(I),ue(k),dr(k,R=>n(R),()=>n()),st(R=>Ie(k,"data",R),[()=>En({cid:s})]),ve(A,k)};Zr(b,A=>{W(a)==="video"?A(B):A(N,!1)},!0)}ve(y,E)};Zr(g,y=>{W(a)==="audio"?y(v):y(p,!1)},!0)}ve(d,h)};Zr(f,d=>{W(a)==="image"?d(u):d(l,!1)})}ve(t,c),nr()}var rB=(t,e)=>{var r;return(r=e())==null?void 0:r.close()},nB=(t,e)=>{var r;return(r=e())==null?void 0:r.close()},sB=(t,e,r)=>{const n=new CustomEvent("datum-delete",{detail:{id:e.datum.id},bubbles:!0});r().dispatchEvent(n)},iB=Xe('<dialog><h1> </h1> <button id="x" commandfor="close" class="svelte-4icvjz">⨯</button> <form class="svelte-4icvjz"><!> <nav class="svelte-4icvjz"><button id="cancel" type="button" accesskey="c" commandfor="close" class="svelte-4icvjz"><u>C</u>ancel</button> <button id="delete" accesskey="r" class="svelte-4icvjz"><u>R</u>emove</button></nav></form></dialog>');function oB(t,e){rr(e,!0);let r=Vt(e,"handle",15,null);var n=iB(),s=fe(n),i=fe(s);ue(s);var o=_e(s,2);o.__click=[rB,r];var a=_e(o,2),c=fe(a);td(c,{get datum(){return e.datum}});var f=_e(c,2),u=fe(f);u.__click=[nB,r];var l=_e(u,2);l.__click=[sB,e,r],ue(f),ue(a),ue(n),dr(n,d=>r(d),()=>r()),st(()=>Dn(i,`Delete ${e.datum.title??""}?`)),Xr("submit",a,d=>d.preventDefault()),ve(t,n),nr()}Ni(["click"]);var aB=(t,e,r,n,s)=>{const i=t.currentTarget;e&&console.debug({clicked:t.target,"child-of":i}),t.target instanceof HTMLMediaElement&&i.open?(r(n),t.preventDefault()):i.open&&(s(i,{open:!1}),t.preventDefault())},cB=t=>{var e;if(/^Arrow(Up|Down)$/.test(t.key)){const r=t.currentTarget.closest("li"),n=t.key.endsWith("Up")?r==null?void 0:r.previousElementSibling:r==null?void 0:r.nextElementSibling;if(!n)return;(e=n.querySelector("summary"))==null||e.focus(),t.preventDefault()}},uB=Xe('<details name="file" class="svelte-w2o2jo"><summary class="svelte-w2o2jo"></summary> <!></details> <!>',1);function lB(t,e){rr(e,!0);const r=!!vc.url.searchParams.get("debug");class n extends Error{constructor(){super("Not a media element.")}}let s=Vt(e,"datum",11,null),i=null;if(s()==null)throw new Error(" `null` `datum`.");const{cid:o,title:a,type:c}=s();let f=nt(null);const u=(y,E)=>{const{play:b=null,pitch:B=null}=E??{};if(!(y instanceof HTMLMediaElement)){if(B===!1)return;throw new n}(y.paused||b===!0)&&b!==!1?(r&&console.debug({playing:y}),y.play()):(r&&console.debug({pausing:y}),y.pause())},l=(y,E)=>{const{open:b=null}=E??{};if((y!=null&&y.open||b===!0)&&b!==!1)y.open=!0;else{if(r&&console.debug({closing:y}),!y)return;y.removeAttribute("open"),u(i,{play:!1,pitch:!1})}};var d=uB();Xr("click",Zs,y=>{r&&console.debug({doc:{clicked:y.target}}),y.target.closest("li")!=(i==null?void 0:i.closest("li"))&&u(i,{play:!1,pitch:!1})});var h=Jr(d);Ie(h,"id",`deets-${Math.floor(Math.random()*1e6)??""}`),h.__click=[aB,r,u,i,l],h.__keydown=[cB];var g=fe(h);Ie(g,"tabindex",0),g.textContent=a;var v=_e(g,2);td(v,{get datum(){return s()},get content(){return i}}),ue(h);var p=_e(h,2);oB(p,{get datum(){return s()},get handle(){return W(f)},set handle(y){ce(f,he(y))}}),Xr("keypress",h,y=>{var b;const E=y.currentTarget;if(r&&console.debug({"🔑":y.key,open:E.open}),y.key==="Escape")l(y.currentTarget,{open:!1});else if(y.key==="Enter")E.open&&(l(E,{open:!1}),y.preventDefault());else if(y.key===" ")try{u(i),y.preventDefault()}finally{}else y.key==="d"&&((b=W(f))==null||b.showModal())}),Xr("keypress",g,y=>{var b;const E=y.target.closest("details");E&&(r&&console.debug({"🔑":y.key,open:E==null?void 0:E.open,content:i}),console.debug({summary:i}),y.key===" "?(E.open&&u(i),l(E,{open:!0}),y.preventDefault()):y.key==="d"&&((b=W(f))==null||b.showModal()))}),ve(t,d),nr()}Ni(["click","keydown"]);var fB=Xe('<div class="border-solid rounded p-2 bg-white dark:bg-white/25"> </div>');function dB(t,e){rr(e,!0);var r=fB(),n=fe(r,!0);ue(r),st(()=>Dn(n,e.datum.title)),ve(t,r),nr()}async function hB(t,e,r){var n;try{t.preventDefault(),ce(e,!0);const s=(n=t.currentTarget)==null?void 0:n.files;if(!s)return;await r(Array.from(s))}catch(s){bd({text:s.message,duration:16e3,close:!0,gravity:"bottom",position:"center",stopOnFocus:!0,style:{background:"linear-gradient(to right, #1E396A, #F32587)"}}).showToast()}finally{ce(e,!1)}}function pB(t,e){try{ce(e,!0)}finally{ce(e,!1)}}function gB(t,e,r,n){W(e).length!==0&&document.startViewTransition(async()=>{const s=W(e).pop();ce(r,he(s)),ce(n,W(e).length>0),await bc()})}var yB=Xe('<meta name="description">'),wB=t=>{var e;(e=t.currentTarget.form)==null||e.elements.namedItem("toAdd").click()},mB=Xe("<section><p>Loading…</p> <progress> </progress></section>"),bB=Xe('<header><h1>Merge List</h1></header> <main class="svelte-17jhzzc"><form><label><button id="add-file" type="button" class="svelte-17jhzzc"><!></button> <input type="file" accept="image/*,video/*" name="toAdd" multiple class="svelte-17jhzzc"></label> <section id="controls" class="svelte-17jhzzc"><button id="save" type="button" class="svelte-17jhzzc"> </button> <button id="undo" type="button" class="svelte-17jhzzc">Undo</button></section></form> <!></main>',1);function JB(t,e){rr(e,!0);let r=nt(he([])),n=VE(Ed.ipfsAPI),s=nt(!1),i=nt(!1),o=nt(!1),a=nt(he([])),c=nt(0),f=nt(0),u=nt(0);async function l(R){Array.isArray(R)||(R=[R]),ce(f,he(R.reduce((x,{size:U})=>x+U,0)));const V={chunker:"rabin",cidVersion:1,progress:x=>{ce(c,W(c)+x)}};let F=[],Y=0;const O=await n.addAll(R,V);for await(const{cid:x}of O)F.push({id:gd(u),cid:x.toString(),title:R[Y].name.replace(/\.[^.]*$/,""),type:R[Y].type}),Y++;const D=W(r).map(({cid:x})=>x),S=F.filter(x=>!D.includes(x.cid));ce(r,he(W(r).concat(S)))}var d=bB();wd(R=>{var V=yB();Zs.title="Mïmis: Merge List",Ie(V,"content","Ordered list of files to be combined with others in the same namespace."),ve(R,V)}),Xr("datum-delete",Zs,R=>{const{id:V}=R.detail;ce(r,he(W(r).filter(F=>F.id!==V)))});var h=_e(Jr(d),2),g=fe(h),v=fe(g),p=fe(v);p.__click=[wB];var y=fe(p);{var E=R=>{var V=mB(),F=_e(fe(V),2),Y=fe(F);ue(F),ue(V),st(()=>{Ie(F,"max",W(f)),md(F,W(c)),Dn(Y,`${W(c)/W(f)*100}%`)}),ve(R,V)},b=R=>{var V=hd("Add a File");ve(R,V)};Zr(y,R=>{W(s)?R(E):R(b,!1)})}ue(p);var B=_e(p,2);B.__change=[hB,s,l],ue(v);var N=_e(v,2),A=fe(N);A.__click=[pB,i];var k=fe(A,!0);ue(A);var I=_e(A,2);I.__click=[gB,a,r,o],ue(N),ue(g);var C=_e(g,2);X2(C,{id:"entries",row:lB,preview:dB,get data(){return W(r)},set data(R){ce(r,he(R))},get history(){return W(a)},set history(R){ce(a,he(R))}}),ue(h),st(()=>{p.disabled=W(s),A.disabled=!W(o)||W(i),Dn(k,W(i)?"Saving…":"Save"),I.disabled=W(a).length===0||W(i)}),ve(t,d),nr()}Ni(["click","change"]);export{JB as component};
