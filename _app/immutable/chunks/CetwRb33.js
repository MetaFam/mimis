const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BewbSyHt.js","./B9DlHVMq.js","./BAImuLPX.js","./MNLnUxoq.js","./h_AOB8ce.js","./DcooX2_W.js","./DnAqqwf4.js","./DpgXNEDH.js","./C1FmrZbK.js","./DTZbnzMC.js","./CPNz4xAG.js","./D0-K3f_i.js","./Dw8pcMw7.js","./2KFBoGHW.js","./D7YuQRtF.js","./CPOzAvy8.js","./DP3ksmgy.js","./BXPI66WI.js","./FZPdUiUP.js","./DA4wh6vk.js","./Zv3zDodb.js","./DTETl9Ch.js","./f7Kpb33w.js","./Dmg8YACJ.js","./CuvqY_QN.js","./2BneT-j3.js","./D6WcufdL.js","./lVFk5twV.js","./NC_6RwF3.js","./1zZyuO7i.js","./CtjuK9NJ.js","./Dl5t9nbF.js","./DSGET4GS.js","./DroNdjkC.js","./6jRWYIMo.js","./DyHj-ff_.js","./CT0xzexg.js","./CVby7M2N.js","./C5s1_XW8.js","./CAvAa3Lj.js","./753QrkIx.js","./Dk26py-x.js","./Dv5IYN-j.js","./B97eNmSH.js","./BQAvWlWe.js","./C6Tjlg4e.js","./CWJ0pDpQ.js","./DyuJDvCh.js"])))=>i.map(i=>d[i]);
import{_ as Ht}from"./C1FmrZbK.js";import{b as PC}from"./Lj-dUBm2.js";import{o as OC,H as RC,k as hg,v as DC,w as fg,b as pg,t as $C,d as gg,x as kC,c as p0,y as UC,z as MC,A as LC,B as BC,C as FC,n as jC,g as Il,u as zC,e as mr}from"./B9DlHVMq.js";const qC=Symbol(),mg=Object.getPrototypeOf,Ch=new WeakMap,HC=t=>t&&(Ch.has(t)?Ch.get(t):mg(t)===Object.prototype||mg(t)===Array.prototype),WC=t=>HC(t)&&t[qC]||null,yg=(t,e=!0)=>{Ch.set(t,e)},Vu={},Kf=t=>typeof t=="object"&&t!==null,VC=t=>Kf(t)&&!Pc.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),g0=(t,e)=>{const n=_h.get(t);if((n==null?void 0:n[0])===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return yg(r,!0),_h.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(Pc.has(i))yg(i,!1);else if(Rs.has(i)){const[c,u]=Rs.get(i);a.value=g0(c,u())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},GC=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),u=Reflect.get(s,i,a);if(c&&(wg(u,o)||Ua.has(o)&&wg(u,Ua.get(o))))return!0;n(i),Kf(o)&&(o=WC(o)||o);const l=!Rs.has(o)&&YC(o)?Ye(o):o;return e(i,l),Reflect.set(s,i,l,a),r(["set",[i],o,u]),!0}}),Rs=new WeakMap,Pc=new WeakSet,_h=new WeakMap,ha=[1,1],Ua=new WeakMap;let wg=Object.is,KC=(t,e)=>new Proxy(t,e),YC=VC,ZC=g0,JC=GC;function Ye(t={}){if(!Kf(t))throw new Error("object required");const e=Ua.get(t);if(e)return e;let n=ha[0];const r=new Set,s=(m,v=++ha[0])=>{n!==v&&(n=v,r.forEach(w=>w(m,v)))};let i=ha[1];const o=(m=++ha[1])=>(i!==m&&!r.size&&(i=m,c.forEach(([v])=>{const w=v[1](m);w>n&&(n=w)})),n),a=m=>(v,w)=>{const b=[...v];b[1]=[m,...b[1]],s(b,w)},c=new Map,u=(m,v)=>{const w=!Pc.has(v)&&Rs.get(v);if(w){if((Vu?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const b=w[2](a(m));c.set(m,[w,b])}else c.set(m,[w])}},l=m=>{var v;const w=c.get(m);w&&(c.delete(m),(v=w[1])==null||v.call(w))},d=m=>(r.add(m),r.size===1&&c.forEach(([w,b],S)=>{if((Vu?"production":void 0)!=="production"&&b)throw new Error("remove already exists");const _=w[2](a(S));c.set(S,[w,_])}),()=>{r.delete(m),r.size===0&&c.forEach(([w,b],S)=>{b&&(b(),c.set(S,[w]))})});let h=!0;const f=JC(()=>h,u,l,s),p=KC(t,f);Ua.set(t,p);const g=[t,o,d];return Rs.set(p,g),Reflect.ownKeys(t).forEach(m=>{const v=Object.getOwnPropertyDescriptor(t,m);"value"in v&&v.writable&&(p[m]=t[m])}),h=!1,p}function Dt(t,e,n){const r=Rs.get(t);(Vu?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const u=o(l=>{i.push(l),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,u()}}function Ma(t){const e=Rs.get(t);(Vu?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return ZC(n,r())}function hi(t){return Pc.add(t),t}function XC(){return{proxyStateMap:Rs,refSet:Pc,snapCache:_h,versionHolder:ha,proxyCache:Ua}}function $t(t,e,n,r){let s=t[e];return Dt(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:QC,snapCache:e_}=XC(),Jc=t=>QC.has(t);function t_(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const u=e_.get(a),l=u==null?void 0:u[1];if(l&&!s.has(l)){const d=new Map(r);s.set(l,d)}},o=u=>s.get(u)||r,a={data:e,index:n,epoch:0,get size(){return Jc(this)||i(),o(this).size},get(u){const d=o(this).get(u);if(d===void 0){this.epoch;return}return this.data[d]},has(u){const l=o(this);return this.epoch,l.has(u)},set(u,l){if(!Jc(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(u);return d===void 0?(r.set(u,this.index),this.data[this.index++]=l):this.data[d]=l,this.epoch++,this},delete(u){if(!Jc(this))throw new Error("Cannot perform mutations on a snapshot");const l=r.get(u);return l===void 0?!1:(delete this.data[l],r.delete(u),this.epoch++,!0)},clear(){if(!Jc(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(u){this.epoch,o(this).forEach((d,h)=>{u(this.data[d],h,this)})},*entries(){this.epoch;const u=o(this);for(const[l,d]of u)yield[l,this.data[d]]},*keys(){this.epoch;const u=o(this);for(const l of u.keys())yield l},*values(){this.epoch;const u=o(this);for(const l of u.values())yield this.data[l]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Ye(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var bg={};const $={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof bg<"u"?bg.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{shortMessage:"Multi-Wallet Not Enabled",longMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{shortMessage:"Multi-Wallet Not Enabled",longMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{shortMessage:"Multi-Wallet Not Enabled",longMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},La={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(n=>n.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){var s;if(!e)return;const n=t.find(i=>i.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return((s=$.CHAIN_NAME_MAP)==null?void 0:s[r])||void 0}};var n_=20,r_=1,fi=1e6,vg=1e6,s_=-7,i_=21,o_=!1,Oc="[big.js] ",Ni=Oc+"Invalid ",Sl=Ni+"decimal places",a_=Ni+"rounding mode",m0=Oc+"Division by zero",He={},Er=void 0,c_=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function y0(){function t(e){var n=this;if(!(n instanceof t))return e===Er?y0():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Ni+"value");e=e===0&&1/e<0?"-0":String(e)}u_(n,e)}n.constructor=t}return t.prototype=He,t.DP=n_,t.RM=r_,t.NE=s_,t.PE=i_,t.strict=o_,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function u_(t,e){var n,r,s;if(!c_.test(e))throw Error(Ni+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function Ti(t,e,n,r){var s=t.c;if(n===Er&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(a_);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==Er))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==Er||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function xi(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}He.abs=function(){var t=new this.constructor(this);return t.s=1,t};He.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};He.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>fi)throw Error(Sl);if(!s[0])throw Error(m0);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,u,l,d,h=s.slice(),f=a=s.length,p=r.length,g=r.slice(0,a),m=g.length,v=t,w=v.c=[],b=0,S=o+(v.e=e.e-t.e)+1;for(v.s=i,i=S<0?0:S,h.unshift(0);m++<a;)g.push(0);do{for(u=0;u<10;u++){if(a!=(m=g.length))l=a>m?1:-1;else for(d=-1,l=0;++d<a;)if(s[d]!=g[d]){l=s[d]>g[d]?1:-1;break}if(l<0){for(c=m==a?s:h;m;){if(g[--m]<c[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}w[b++]=l?u:++u,g[0]&&l?g[m]=r[f]||0:g=[r[f]]}while((f++<p||g[0]!==Er)&&i--);return!w[0]&&b!=1&&(w.shift(),v.e--,S--),b>S&&Ti(v,S,n.RM,g[0]!==Er),v};He.eq=function(t){return this.cmp(t)===0};He.gt=function(t){return this.cmp(t)>0};He.gte=function(t){return this.cmp(t)>-1};He.lt=function(t){return this.cmp(t)<0};He.lte=function(t){return this.cmp(t)<1};He.minus=He.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var u=i.c.slice(),l=i.e,d=t.c,h=t.e;if(!u[0]||!d[0])return d[0]?t.s=-c:u[0]?t=new o(i):t.s=1,t;if(a=l-h){for((s=a<0)?(a=-a,r=u):(h=l,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=u.length<d.length)?u:d).length,a=c=0;c<n;c++)if(u[c]!=d[c]){s=u[c]<d[c];break}if(s&&(r=u,u=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=u.length))>0)for(;c--;)u[e++]=0;for(c=e;n>a;){if(u[--n]<d[n]){for(e=n;e&&!u[--e];)u[e]=9;--u[e],u[n]+=10}u[n]-=d[n]}for(;u[--c]===0;)u.pop();for(;u[0]===0;)u.shift(),--h;return u[0]||(t.s=1,u=[h=0]),t.c=u,t.e=h,t};He.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(m0);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};He.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};He.plus=He.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,u=t.c;if(!a[0]||!u[0])return u[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=u):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-u.length<0&&(r=u,u=a,a=r),e=u.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+u[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};He.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-vg||t>vg)throw Error(Ni+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};He.prec=function(t,e){if(t!==~~t||t<1||t>fi)throw Error(Ni+"precision");return Ti(new this.constructor(this),t,e)};He.round=function(t,e){if(t===Er)t=0;else if(t!==~~t||t<-fi||t>fi)throw Error(Sl);return Ti(new this.constructor(this),t+this.e+1,e)};He.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(Oc+"No square root");i=Math.sqrt(+xi(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return Ti(t,(s.DP-=4)+t.e+1,s.RM)};He.times=He.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,u=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+u,o<a&&(e=s,s=i,i=e,u=o,o=a,a=u),e=new Array(u=o+a);u--;)e[u]=0;for(c=a;c--;){for(a=0,u=o+c;u>c;)a=e[u]+i[c]*s[u-c-1]+a,e[u--]=a%10,a=a/10|0;e[u]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};He.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==Er){if(t!==~~t||t<0||t>fi)throw Error(Sl);for(n=Ti(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return xi(n,!0,!!r)};He.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==Er){if(t!==~~t||t<0||t>fi)throw Error(Sl);for(n=Ti(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return xi(n,!1,!!r)};He[Symbol.for("nodejs.util.inspect.custom")]=He.toJSON=He.toString=function(){var t=this,e=t.constructor;return xi(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};He.toNumber=function(){var t=+xi(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Oc+"Imprecise conversion");return t};He.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==Er){if(t!==~~t||t<1||t>fi)throw Error(Ni+"precision");for(n=Ti(new r(n),t,e);n.c.length<t;)n.c.push(0)}return xi(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};He.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Oc+"valueOf disallowed");return xi(t,t.e<=e.NE||t.e>=e.PE,!0)};var Ho=y0();const l_={bigNumber(t){return t?new Ho(t):new Ho(0)},multiply(t,e){if(t===void 0||e===void 0)return new Ho(0);const n=new Ho(t),r=new Ho(e);return n.times(r)},formatNumberToLocalString(t,e=2){return t===void 0?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(t){return t===void 0?0:parseFloat(t.replace(/,/gu,""))}},d_=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],h_=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],f_=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],p_={getERC20Abi:t=>$.USDT_CONTRACT_ADDRESSES.includes(t)?f_:d_,getSwapAbi:()=>h_},En={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},ye={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids"};function fd(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const pe={setItem(t,e){fa()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(fa())return localStorage.getItem(t)||void 0},removeItem(t){fa()&&localStorage.removeItem(t)},clear(){fa()&&localStorage.clear()}};function fa(){return typeof window<"u"&&typeof localStorage<"u"}function Gr(t,e){return e==="light"?{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var Eg={};const pd=(typeof process<"u"&&typeof Eg<"u"?Eg.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",w0=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],g_="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Be={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:pd,SECURE_SITE_DASHBOARD:`${pd}/dashboard`,SECURE_SITE_FAVICON:`${pd}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[$.CHAIN.EVM,$.CHAIN.SOLANA],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[$.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[$.CHAIN.EVM,$.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[$.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[$.CHAIN.EVM,$.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},H={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=H.getActiveNamespace(),e=H.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{pe.setItem(ye.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=pe.getItem(ye.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{pe.removeItem(ye.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{pe.setItem(ye.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{pe.setItem(ye.ACTIVE_CAIP_NETWORK_ID,t),H.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return pe.getItem(ye.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{pe.removeItem(ye.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=fd(t);pe.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=H.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),pe.setItem(ye.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=pe.getItem(ye.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(t,e){try{const n=fd(t);pe.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return pe.getItem(ye.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=fd(t);return pe.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{pe.setItem(ye.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return pe.getItem(ye.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{pe.removeItem(ye.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return pe.getItem(ye.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var n;const t=pe.getItem(ye.ACTIVE_CAIP_NETWORK_ID);return(n=t==null?void 0:t.split(":"))==null?void 0:n[1]},setConnectionStatus(t){try{pe.setItem(ye.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return pe.getItem(ye.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=pe.getItem(ye.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));pe.setItem(ye.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=H.getConnectedNamespaces();e.includes(t)||(e.push(t),H.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=H.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),H.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return pe.getItem(ye.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{pe.setItem(ye.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{pe.removeItem(ye.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=pe.getItem(ye.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=H.getBalanceCache();pe.setItem(ye.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=H.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;H.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=H.getBalanceCache();e[t.caipAddress]=t,pe.setItem(ye.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=pe.getItem(ye.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=H.getBalanceCache();pe.setItem(ye.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=H.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),H.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=H.getNativeBalanceCache();e[t.caipAddress]=t,pe.setItem(ye.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=pe.getItem(ye.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=H.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;H.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=H.getEnsCache();e[t.address]=t,pe.setItem(ye.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=H.getEnsCache();pe.setItem(ye.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=pe.getItem(ye.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=H.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;H.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=H.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},pe.setItem(ye.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=H.getIdentityCache();pe.setItem(ye.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{pe.removeItem(ye.PORTFOLIO_CACHE),pe.removeItem(ye.NATIVE_BALANCE_CACHE),pe.removeItem(ye.ENS_CACHE),pe.removeItem(ye.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{pe.setItem(ye.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=pe.getItem(ye.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=H.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===$.CONNECTOR_ID.AUTH;if(a&&!c){const u=new Set(a.accounts.map(d=>d.address.toLowerCase())),l=o.accounts.filter(d=>!u.has(d.address.toLowerCase()));a.accounts.push(...l)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};pe.setItem(ye.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=pe.getItem(ye.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=H.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),pe.setItem(ye.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=pe.getItem(ye.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=H.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),pe.setItem(ye.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=H.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),pe.setItem(ye.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(H.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1}},ie={isMobile(){var t;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((t=window.matchMedia("(pointer:coarse)"))!=null&&t.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return ie.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Be.TEN_SEC_MS:!0},isAllowedRetry(t,e=Be.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var t,e;if(ie.isClient()&&window.self!==window.top)try{const n=(e=(t=window==null?void 0:window.location)==null?void 0:t.ancestorOrigins)==null?void 0:e[0],r="https://app.safe.global";if(n){const s=new URL(n),i=new URL(r);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Be.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(ie.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!ie.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?H.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window==null||window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var n,r;if(typeof window>"u")return!1;const t=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(n=window.matchMedia("(display-mode: standalone)"))==null?void 0:n.matches:!1,e=(r=window==null?void 0:window.navigator)==null?void 0:r.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,ie.wait(2e3)])},formatBalance(t,e){let n="0.000";if(typeof t=="string"){const r=Number(t);if(r){const s=Math.floor(r*1e3)/1e3;s&&(n=s.toString())}}return`${n}${e?` ${e}`:""}`},formatBalance2(t,e){var r;let n;if(t==="0")n="0";else if(typeof t=="string"){const s=Number(t);s&&(n=(r=s.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:r[0])}return{value:n??"0",rest:n==="0"?"000":"",symbol:e}},getApiUrl(){return $.W3M_API_URL},getBlockchainApiUrl(){return $.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return $.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,n;return typeof t=="string"?t:typeof((n=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:n.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Be.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in $.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),u=t.substring(s),l=c+n;return a+l+u}};async function Wo(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Rc{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await Wo(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await Wo(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Wo(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Wo(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await Wo(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const m_={getFeatureValue(t,e){const n=e==null?void 0:e[t];return n===void 0?Be.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(ie.isTelegram()){if(ie.isIos())return t.filter(e=>e!=="google");if(ie.isMac())return t.filter(e=>e!=="x");if(ie.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},ue=Ye({features:Be.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Be.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),F={state:ue,subscribeKey(t,e){return $t(ue,t,e)},setOptions(t){Object.assign(ue,t)},setRemoteFeatures(t){var n,r;if(!t)return;const e={...ue.remoteFeatures,...t};ue.remoteFeatures=e,(n=ue.remoteFeatures)!=null&&n.socials&&(ue.remoteFeatures.socials=m_.filterSocialsByPlatform(ue.remoteFeatures.socials)),(r=ue.features)!=null&&r.pay&&(ue.remoteFeatures.email=!1,ue.remoteFeatures.socials=!1)},setFeatures(t){var n;if(!t)return;ue.features||(ue.features=Be.DEFAULT_FEATURES);const e={...ue.features,...t};ue.features=e,(n=ue.features)!=null&&n.pay&&ue.remoteFeatures&&(ue.remoteFeatures.email=!1,ue.remoteFeatures.socials=!1)},setProjectId(t){ue.projectId=t},setCustomRpcUrls(t){ue.customRpcUrls=t},setAllWallets(t){ue.allWallets=t},setIncludeWalletIds(t){ue.includeWalletIds=t},setExcludeWalletIds(t){ue.excludeWalletIds=t},setFeaturedWalletIds(t){ue.featuredWalletIds=t},setTokens(t){ue.tokens=t},setTermsConditionsUrl(t){ue.termsConditionsUrl=t},setPrivacyPolicyUrl(t){ue.privacyPolicyUrl=t},setCustomWallets(t){ue.customWallets=t},setIsSiweEnabled(t){ue.isSiweEnabled=t},setIsUniversalProvider(t){ue.isUniversalProvider=t},setSdkVersion(t){ue.sdkVersion=t},setMetadata(t){ue.metadata=t},setDisableAppend(t){ue.disableAppend=t},setEIP6963Enabled(t){ue.enableEIP6963=t},setDebug(t){ue.debug=t},setEnableWalletConnect(t){ue.enableWalletConnect=t},setEnableWalletGuide(t){ue.enableWalletGuide=t},setEnableAuthLogger(t){ue.enableAuthLogger=t},setEnableWallets(t){ue.enableWallets=t},setPreferUniversalLinks(t){ue.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Be.SIWX_DEFAULTS))t[e]??(t[e]=n);ue.siwx=t},setConnectMethodsOrder(t){ue.features={...ue.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){ue.features={...ue.features,walletFeaturesOrder:t}},setSocialsOrder(t){ue.remoteFeatures={...ue.remoteFeatures,socials:t}},setCollapseWallets(t){ue.features={...ue.features,collapseWallets:t}},setEnableEmbedded(t){ue.enableEmbedded=t},setAllowUnsupportedChain(t){ue.allowUnsupportedChain=t},setManualWCControl(t){ue.manualWCControl=t},setEnableNetworkSwitch(t){ue.enableNetworkSwitch=t},setEnableReconnect(t){ue.enableReconnect=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(ue.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){ue.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return ue.universalProviderConfigOverride},getSnapshot(){return Ma(ue)}},y_=Object.freeze({enabled:!0,events:[]}),w_=new Rc({baseUrl:ie.getAnalyticsUrl(),clientId:null}),b_=5,v_=60*1e3,ts=Ye({...y_}),E_={state:ts,subscribeKey(t,e){return $t(ts,t,e)},async sendError(t,e){if(!ts.enabled)return;const n=Date.now();if(ts.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<v_}).length>=b_)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};ts.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=F.state;await w_.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:ie.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){ts.enabled=!0},disable(){ts.enabled=!1},clearEvents(){ts.events=[]}};class wo extends Error{constructor(e,n,r){super(e),this.name="AppKitError",this.category=n,this.originalError=r,Object.setPrototypeOf(this,wo.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,wo):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function Cg(t,e){const n=t instanceof wo?t:new wo(t instanceof Error?t.message:String(t),e,t);throw E_.sendError(n,n.category),n}function Nn(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return Cg(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return Cg(a,e)}},n[r]=i}else n[r]=s}),n}var bo={};const C_="https://secure.walletconnect.org/sdk",__=(typeof process<"u"&&typeof bo<"u"?bo.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||C_,A_=(typeof process<"u"&&typeof bo<"u"?bo.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",I_=(typeof process<"u"&&typeof bo<"u"?bo.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",oe={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},wt={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},yr={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"}},S_={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===yr.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${yr.PHANTOM.url}/ul/browse/${r}?ref=${o}`}t===yr.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${yr.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===$.CHAIN.SOLANA&&t===yr.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${yr.COINBASE.url}/dapp?cb_url=${r}`)}},mn=Ye({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),N_={state:mn,subscribeNetworkImages(t){return Dt(mn.networkImages,()=>t(mn.networkImages))},subscribeKey(t,e){return $t(mn,t,e)},subscribe(t){return Dt(mn,()=>t(mn))},setWalletImage(t,e){mn.walletImages[t]=e},setNetworkImage(t,e){mn.networkImages[t]=e},setChainImage(t,e){mn.chainImages[t]=e},setConnectorImage(t,e){mn.connectorImages={...mn.connectorImages,[t]:e}},setTokenImage(t,e){mn.tokenImages[t]=e},setCurrencyImage(t,e){mn.currencyImages[t]=e}},Jn=Nn(N_),T_={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},gd=Ye({networkImagePromises:{}}),b0={async fetchWalletImage(t){if(t)return await le._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(gd.networkImagePromises[t]||(gd.networkImagePromises[t]=le._fetchNetworkImage(t)),await gd.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return Jn.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return Jn.state.walletImages[t.image_id]},getNetworkImage(t){var e,n,r;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(n=t==null?void 0:t.assets)==null?void 0:n.imageUrl;if((r=t==null?void 0:t.assets)!=null&&r.imageId)return Jn.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return Jn.state.networkImages[t]},getConnectorImage(t){var e;if(t!=null&&t.imageUrl)return t.imageUrl;if((e=t==null?void 0:t.info)!=null&&e.icon)return t.info.icon;if(t!=null&&t.imageId)return Jn.state.connectorImages[t.imageId]},getChainImage(t){return Jn.state.networkImages[T_[t]]}},ns=Ye({message:"",variant:"info",open:!1}),x_={state:ns,subscribeKey(t,e){return $t(ns,t,e)},open(t,e){const{debug:n}=F.state,{shortMessage:r,longMessage:s}=t;n&&(ns.message=r,ns.variant=e,ns.open=!0),s&&console.error(typeof s=="function"?s():s)},close(){ns.open=!1,ns.message="",ns.variant="info"}},et=Nn(x_),P_=ie.getAnalyticsUrl(),O_=new Rc({baseUrl:P_,clientId:null}),R_=["MODAL_CREATED"],Dr=Ye({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),qe={state:Dr,subscribe(t){return Dt(Dr,()=>t(Dr))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=F.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(t){try{const e=ce.state.address;if(R_.includes(t.data.event)||typeof window>"u")return;await O_.post({path:"/e",params:qe.getSdkProperties(),body:{eventId:ie.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e}}}),Dr.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===$.HTTP_STATUS_CODES.FORBIDDEN&&!Dr.reportedErrors.FORBIDDEN&&(et.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${fa()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),Dr.reportedErrors.FORBIDDEN=!0)}},sendEvent(t){var e;Dr.timestamp=Date.now(),Dr.data=t,((e=F.state.features)!=null&&e.analytics||t.event==="INITIALIZE")&&qe._sendAnalyticsEvent(Dr)}},D_=ie.getApiUrl(),Xt=new Rc({baseUrl:D_,clientId:null}),$_=40,_g=4,k_=20,be=Ye({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),le={state:be,subscribeKey(t,e){return $t(be,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=F.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return F.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${Xt.baseUrl}/getWalletImage/${t}`,n=await Xt.getBlob({path:e,params:le._getSdkProperties()});Jn.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${Xt.baseUrl}/public/getAssetImage/${t}`,n=await Xt.getBlob({path:e,params:le._getSdkProperties()});Jn.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${Xt.baseUrl}/public/getAssetImage/${t}`,n=await Xt.getBlob({path:e,params:le._getSdkProperties()});Jn.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${Xt.baseUrl}/public/getCurrencyImage/${t}`,n=await Xt.getBlob({path:e,params:le._getSdkProperties()});Jn.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${Xt.baseUrl}/public/getTokenImage/${t}`,n=await Xt.getBlob({path:e,params:le._getSdkProperties()});Jn.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){return ie.isMobile()?t==null?void 0:t.filter(n=>n.mobile_link||n.id===yr.COINBASE.id?!0:E.state.activeChain==="solana"&&(n.id===yr.SOLFLARE.id||n.id===yr.PHANTOM.id)):t},async fetchProjectConfig(){return(await Xt.get({path:"/appkit/v1/config",params:le._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await Xt.get({path:"/projects/v1/origins",params:le._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===$.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=$.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const t=E.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:n})=>n==null?void 0:n.imageId).filter(Boolean).filter(n=>!b0.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>le._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=K.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>le._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>le._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>le._fetchTokenImage(e)))},async fetchWallets(t){var i;const e=t.exclude??[];le._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(yr).map(o=>o.id));const r=await Xt.get({path:"/getWallets",params:{...le._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(i=t.include)==null?void 0:i.join(","),exclude:e.join(",")}});return{data:le._filterWalletsByPlatform(r==null?void 0:r.data)||[],count:r==null?void 0:r.count}},async fetchFeaturedWallets(){const{featuredWalletIds:t}=F.state;if(t!=null&&t.length){const e={...le._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??_g,include:t},{data:n}=await le.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>le._fetchWalletImage(i))),be.featured=r,be.allFeatured=r}},async fetchRecommendedWallets(){try{be.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=F.state,r=[...e??[],...n??[]].filter(Boolean),s=E.getRequestedCaipNetworkIds().join(","),i={page:1,entries:_g,include:t,exclude:r,chains:s},{data:o,count:a}=await le.fetchWallets(i),c=H.getRecentWallets(),u=o.map(d=>d.image_id).filter(Boolean),l=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...u,...l].map(d=>le._fetchWalletImage(d))),be.recommended=o,be.allRecommended=o,be.count=a??0}catch{}finally{be.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=F.state,s=E.getRequestedCaipNetworkIds().join(","),i=[...be.recommended.map(({id:l})=>l),...n??[],...r??[]].filter(Boolean),o={page:t,entries:$_,include:e,exclude:i,chains:s},{data:a,count:c}=await le.fetchWallets(o),u=a.slice(0,k_).map(l=>l.image_id).filter(Boolean);await Promise.allSettled(u.map(l=>le._fetchWalletImage(l))),be.wallets=ie.uniqueBy([...be.wallets,...le._filterOutExtensions(a)],"id").filter(l=>{var d;return(d=l.chains)==null?void 0:d.some(h=>s.includes(h))}),be.count=c>be.count?c:be.count,be.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await le.fetchWallets(e);n&&n.forEach(r=>{be.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=F.state,s=E.getRequestedCaipNetworkIds().join(",");be.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await le.fetchWallets(i);qe.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>le._fetchWalletImage(c)),ie.wait(300)]),be.search=le._filterOutExtensions(o)},initPromise(t,e){const n=be.promises[t];return n||(be.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0}={}){const s=[t&&le.initPromise("connectorImages",le.fetchConnectorImages),e&&le.initPromise("featuredWallets",le.fetchFeaturedWallets),n&&le.initPromise("recommendedWallets",le.fetchRecommendedWallets),r&&le.initPromise("networkImages",le.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var t;(t=F.state.features)!=null&&t.analytics&&le.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await Xt.get({path:"/getAnalyticsConfig",params:le._getSdkProperties()});F.setFeatures({analytics:t})}catch{F.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){be.featured=be.allFeatured,be.recommended=be.allRecommended;return}const e=E.getRequestedCaipNetworkIds().join(",");be.featured=be.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),be.recommended=be.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),be.filteredWallets=be.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})},clearFilterByNamespaces(){be.filteredWallets=[]},setFilterByNamespace(t){if(!t){be.featured=be.allFeatured,be.recommended=be.allRecommended;return}const e=E.getRequestedCaipNetworkIds().join(",");be.featured=be.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),be.recommended=be.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),be.filteredWallets=be.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})}},We=Ye({view:"Connect",history:["Connect"],transactionStack:[]}),U_={state:We,subscribeKey(t,e){return $t(We,t,e)},pushTransactionStack(t){We.transactionStack.push(t)},popTransactionStack(t){const e=We.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n==null||n();break;case"error":r==null||r(),ge.goBack();break;case"cancel":s==null||s(),ge.goBack();break}},push(t,e){t!==We.view&&(We.view=t,We.history.push(t),We.data=e)},reset(t,e){We.view=t,We.history=[t],We.data=e},replace(t,e){We.history.at(-1)===t||(We.view=t,We.history[We.history.length-1]=t,We.data=e)},goBack(){var r;const t=E.state.activeCaipAddress,e=ge.state.view==="ConnectingFarcaster",n=!t&&e;if(We.history.length>1){We.history.pop();const[s]=We.history.slice(-1);s&&(t&&s==="Connect"?We.view="Account":We.view=s)}else $e.close();(r=We.data)!=null&&r.wallet&&(We.data.wallet=void 0),setTimeout(()=>{var s,i,o;if(n){ce.setFarcasterUrl(void 0,E.state.activeChain);const a=K.getAuthConnector();(s=a==null?void 0:a.provider)==null||s.reload();const c=Ma(F.state);(o=(i=a==null?void 0:a.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:c.metadata,sdkVersion:c.sdkVersion,projectId:c.projectId,sdkType:c.sdkType})}},100)},goBackToIndex(t){if(We.history.length>1){We.history=We.history.slice(0,t+1);const[e]=We.history.slice(-1);e&&(We.view=e)}},goBackOrCloseModal(){ge.state.history.length>1?ge.goBack():$e.close()}},ge=Nn(U_),$r=Ye({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Ah={state:$r,subscribe(t){return Dt($r,()=>t($r))},setThemeMode(t){$r.themeMode=t;try{const e=K.getAuthConnector();if(e){const n=Ah.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:Gr(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){$r.themeVariables={...$r.themeVariables,...t};try{const e=K.getAuthConnector();if(e){const n=Ah.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:Gr($r.themeVariables,$r.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Ma($r)}},cn=Nn(Ah),v0={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},Pe=Ye({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...v0},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),M_={state:Pe,subscribe(t){return Dt(Pe,()=>{t(Pe)})},subscribeKey(t,e){return $t(Pe,t,e)},initialize(t){t.forEach(e=>{const n=H.getConnectedConnectorId(e);n&&K.setConnectorId(n,e)})},setActiveConnector(t){t&&(Pe.activeConnector=hi(t))},setConnectors(t){t.filter(s=>!Pe.allConnectors.some(i=>i.id===s.id&&K.getConnectorName(i.name)===K.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&Pe.allConnectors.push(hi(s))});const n=K.getEnabledNamespaces(),r=K.getEnabledConnectors(n);Pe.connectors=K.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(Pe.filterByNamespaceMap).forEach(e=>{Pe.filterByNamespaceMap[e]=!1}),t.forEach(e=>{Pe.filterByNamespaceMap[e]=!0}),K.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){Pe.filterByNamespaceMap[t]=e,K.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=K.getEnabledNamespaces(),e=K.getEnabledConnectors(t),n=K.areAllNamespacesEnabled();Pe.connectors=K.mergeMultiChainConnectors(e),n?le.clearFilterByNamespaces():le.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(Pe.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return Pe.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(Pe.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=K.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=(s==null?void 0:s.id)===$.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=K.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){var e,n,r;if(t.id===$.CONNECTOR_ID.AUTH){const s=t,i=Ma(F.state),o=cn.getSnapshot().themeMode,a=cn.getSnapshot().themeVariables;(n=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||n.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(r=s==null?void 0:s.provider)==null||r.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:Gr(a,o)}),K.setConnectors([t])}else K.setConnectors([t])},getAuthConnector(t){var r;const e=t||E.state.activeChain,n=Pe.connectors.find(s=>s.id===$.CONNECTOR_ID.AUTH);if(n)return(r=n==null?void 0:n.connectors)!=null&&r.length?n.connectors.find(i=>i.chain===e):n},getAnnouncedConnectorRdns(){return Pe.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return Pe.allConnectors.find(e=>e.id===t)},getConnector(t,e){return Pe.allConnectors.filter(r=>r.chain===E.state.activeChain).find(r=>{var s;return r.explorerId===t||((s=r.info)==null?void 0:s.rdns)===e})},syncIfAuthConnector(t){var i,o;if(t.id!=="ID_AUTH")return;const e=t,n=Ma(F.state),r=cn.getSnapshot().themeMode,s=cn.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:Gr(s,r)})},getConnectorsByNamespace(t){const e=Pe.allConnectors.filter(n=>n.chain===t);return K.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return E.checkIfSmartAccountEnabled()&&In(t)===wt.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=K.getConnector(t.id,t.rdns);S_.handleMobileDeeplinkRedirect((e==null?void 0:e.explorerId)||t.id,E.state.activeChain),e?ge.push("ConnectingExternal",{connector:e}):ge.push("ConnectingWalletConnect",{wallet:t})},getConnectors(t){return t?K.getConnectorsByNamespace(t):K.mergeMultiChainConnectors(Pe.allConnectors)},setFilterByNamespace(t){Pe.filterByNamespace=t,Pe.connectors=K.getConnectors(t),le.setFilterByNamespace(t)},setConnectorId(t,e){t&&(Pe.activeConnectorIds={...Pe.activeConnectorIds,[e]:t},H.setConnectedConnectorId(e,t))},removeConnectorId(t){Pe.activeConnectorIds={...Pe.activeConnectorIds,[t]:void 0},H.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return Pe.activeConnectorIds[t]},isConnected(t){return t?!!Pe.activeConnectorIds[t]:Object.values(Pe.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){Pe.activeConnectorIds={...v0}}},K=Nn(M_),L_=1e3,Vo={checkNamespaceConnectorId(t,e){return K.getConnectorId(t)===e},isSocialProvider(t){return Be.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&K.setActiveConnector(e),s==null||s(ie.isMobile()&&t),r){const u=$e.subscribeKey("open",l=>{l||(ge.state.view!==r&&ge.replace(r),u(),a(new Error("Modal closed")))})}const c=E.subscribeKey("activeCaipAddress",u=>{u&&(i==null||i(),n&&$e.close(),c(),o(En.parseCaipAddress(u)))})})},connectExternal(t){return new Promise((e,n)=>{const r=E.subscribeKey("activeCaipAddress",s=>{s&&($e.close(),r(),e(En.parseCaipAddress(s)))});J.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,closeModalOnConnect:e=!0,onOpenFarcaster:n,onConnect:r}){let s=ce.state.socialWindow,i=ce.state.socialProvider,o=!1,a=null;const c=E.subscribeKey("activeCaipAddress",u=>{u&&(e&&$e.close(),c())});return new Promise((u,l)=>{async function d(f){var p,g;if((p=f.data)!=null&&p.resultUri)if(f.origin===$.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",d,!1);try{const m=K.getAuthConnector();if(m&&!o){s&&(s.close(),ce.setSocialWindow(void 0,E.state.activeChain),s=ce.state.socialWindow),o=!0;const v=f.data.resultUri;if(i&&qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:i}}),i){H.setConnectedSocialProvider(i),await J.connectExternal({id:m.id,type:m.type,socialUri:v},m.chain);const w=E.state.activeCaipAddress;if(!w){l(new Error("Failed to connect"));return}u(En.parseCaipAddress(w)),qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:i,caipNetworkId:(g=E.getActiveCaipNetwork())==null?void 0:g.caipNetworkId}})}}}catch{i&&qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:i}}),l(new Error("Failed to connect"))}}else i&&qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:i}})}async function h(){if(t&&(ce.setSocialProvider(t,E.state.activeChain),i=ce.state.socialProvider,qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:i}})),i==="farcaster"){n==null||n();const f=$e.subscribeKey("open",g=>{!g&&t==="farcaster"&&(l(new Error("Popup closed")),r==null||r(),f())}),p=K.getAuthConnector();if(p&&!ce.state.farcasterUrl)try{const{url:g}=await p.provider.getFarcasterUri();ce.setFarcasterUrl(g,E.state.activeChain)}catch{l(new Error("Failed to connect to farcaster"))}}else{const f=K.getAuthConnector();a=ie.returnOpenHref(`${$.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(f&&i){const{uri:p}=await f.provider.getSocialRedirectUri({provider:i});if(a&&p){ce.setSocialWindow(a,E.state.activeChain),s=ce.state.socialWindow,a.location.href=p;const g=setInterval(()=>{s!=null&&s.closed&&!o&&(l(new Error("Popup closed")),clearInterval(g))},1e3);window.addEventListener("message",d,!1)}else a==null||a.close(),l(new Error("Failed to initiate social connection"))}}catch{l(new Error("Failed to initiate social connection")),a==null||a.close()}}}h()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n==null||n(),e){const a=$e.subscribeKey("open",c=>{c||(ge.state.view!==e&&ge.replace(e),a(),i(new Error("Modal closed")))})}const o=E.subscribeKey("activeCaipAddress",a=>{a&&(r==null||r(),t&&$e.close(),o(),s(En.parseCaipAddress(a)))})})},async updateEmail(){const t=H.getConnectedConnectorId(E.state.activeChain),e=K.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==$.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return ge.push("UpdateEmailWallet",{email:n,redirectView:void 0}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&($e.close(),clearInterval(i),o(),r({email:a}))},L_),o=$e.subscribeKey("open",a=>{a||(ge.state.view!=="Connect"&&ge.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return E.checkIfSmartAccountEnabled()&&In(t)===wt.ACCOUNT_TYPES.EOA}};function E0(){var r,s;const t=((r=E.state.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((s=E.state.activeCaipNetwork)==null?void 0:s.id)||1,n=Be.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function In(t){var n;return(n=E.getAccountData(t))==null?void 0:n.preferredAccountType}const Gu={getConnectionStatus(t,e){const n=K.state.activeConnectorIds[e],r=J.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){var a;const e=!!((a=F.state.remoteFeatures)!=null&&a.multiWallet),n=K.state.activeConnectorIds[t],r=J.getConnections(t),i=(J.state.recentConnections.get(t)??[]).filter(c=>K.getConnectorById(c.connectorId)),o=Gu.excludeExistingConnections([...r.map(c=>c.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(c=>c.connectorId.toLowerCase()===(n==null?void 0:n.toLowerCase())),recentConnections:[]}}},Ys=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),ht=Ye({...Ys}),B_={state:ht,subscribeKey(t,e){return $t(ht,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=ie.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){ht.message=Ys.message,ht.variant=Ys.variant,ht.svg=Ys.svg,ht.open=Ys.open,ht.autoClose=Ys.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=Ys.autoClose}){ht.open?(ht.open=!1,setTimeout(()=>{ht.message=t,ht.variant=n,ht.svg=e,ht.open=!0,ht.autoClose=r},150)):(ht.message=t,ht.variant=n,ht.svg=e,ht.open=!0,ht.autoClose=r)}},vr=B_,nt=Ye({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),F_={state:nt,subscribe(t){return Dt(nt,()=>t(nt))},setLastNetworkInView(t){nt.lastNetworkInView=t},async fetchTransactions(t){var e;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");nt.loading=!0;try{const n=await he.fetchTransactions({account:t,cursor:nt.next,chainId:(e=E.state.activeCaipNetwork)==null?void 0:e.caipNetworkId}),r=xu.filterSpamTransactions(n.data),s=xu.filterByConnectedChain(r),i=[...nt.transactions,...s];nt.loading=!1,nt.transactions=i,nt.transactionsByYear=xu.groupTransactionsByYearAndMonth(nt.transactionsByYear,s),nt.empty=i.length===0,nt.next=n.next?n.next:void 0}catch{const r=E.state.activeChain;qe.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:F.state.projectId,cursor:nt.next,isSmartAccount:In(r)===wt.ACCOUNT_TYPES.SMART_ACCOUNT}}),vr.showError("Failed to fetch transactions"),nt.loading=!1,nt.empty=!0,nt.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(u=>u.id!==r.id);n[s]={...o,[i]:[...c,r].sort((u,l)=>new Date(l.metadata.minedAt).getTime()-new Date(u.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>{var s;return((s=r.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(t){var r;const e=(r=E.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){nt.next=void 0},resetTransactions(){nt.transactions=[],nt.transactionsByYear={},nt.lastNetworkInView=void 0,nt.loading=!1,nt.empty=!1,nt.next=void 0}},xu=Nn(F_,"API_ERROR"),Te=Ye({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let zs;const j_={state:Te,subscribe(t){return Dt(Te,()=>t(Te))},subscribeKey(t,e){return $t(Te,t,e)},_getClient(){return Te._client},setClient(t){Te._client=hi(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);J.syncStorageConnections(e)},syncStorageConnections(t){const e=H.getConnections(),n=t??Array.from(E.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(Te.recentConnections);i.set(r,s),Te.recentConnections=i}},getConnections(t){return t?Te.connections.get(t)??[]:[]},hasAnyConnection(t){const e=J.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect(){var t,e,n,r;if(ie.isTelegram()||ie.isSafari()&&ie.isIos()){if(zs){await zs,zs=void 0;return}if(!ie.isPairingExpired(Te==null?void 0:Te.wcPairingExpiry)){const s=Te.wcUri;Te.wcUri=s;return}zs=(e=(t=J._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:e.call(t).catch(()=>{}),J.state.status="connecting",await zs,zs=void 0,Te.wcPairingExpiry=void 0,J.state.status="connected"}else await((r=(n=J._getClient())==null?void 0:n.connectWalletConnect)==null?void 0:r.call(n))},async connectExternal(t,e,n=!0){var s,i;const r=await((i=(s=J._getClient())==null?void 0:s.connectExternal)==null?void 0:i.call(s,t));return n&&E.setActiveNamespace(e),r},async reconnectExternal(t){var n,r;await((r=(n=J._getClient())==null?void 0:n.reconnectExternal)==null?void 0:r.call(n,t));const e=t.chain||E.state.activeChain;e&&K.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var r;if(!e)return;$e.setLoading(!0,E.state.activeChain);const n=K.getAuthConnector();n&&(ce.setPreferredAccountType(t,e),await n.provider.setPreferredAccount(t),H.setPreferredAccountTypes(Object.entries(E.state.chains).reduce((s,[i,o])=>{const a=i,c=In(a);return c!==void 0&&(s[a]=c),s},{})),await J.reconnectExternal(n),$e.setLoading(!1,E.state.activeChain),qe.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((r=E.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=J._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var n;return(n=J._getClient())==null?void 0:n.parseUnits(t,e)},formatUnits(t,e){var n;return(n=J._getClient())==null?void 0:n.formatUnits(t,e)},async sendTransaction(t){var e;return(e=J._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=J._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=J._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=J._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=J._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=J._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=J._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=J._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,n;return((n=(e=J._getClient())==null?void 0:e.checkInstalled)==null?void 0:n.call(e,t))||!1},resetWcConnection(){Te.wcUri=void 0,Te.wcPairingExpiry=void 0,Te.wcLinking=void 0,Te.recentWallet=void 0,Te.status="disconnected",xu.resetTransactions(),H.deleteWalletConnectDeepLink()},resetUri(){Te.wcUri=void 0,Te.wcPairingExpiry=void 0,zs=void 0},finalizeWcConnection(){var n,r,s;const{wcLinking:t,recentWallet:e}=J.state;t&&H.setWalletConnectDeepLink(t),e&&H.setAppKitRecent(e),qe.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:t?"mobile":"qrcode",name:((r=(n=ge.state.data)==null?void 0:n.wallet)==null?void 0:r.name)||"Unknown",caipNetworkId:(s=E.getActiveCaipNetwork())==null?void 0:s.caipNetworkId}})},setWcBasic(t){Te.wcBasic=t},setUri(t){Te.wcUri=t,Te.wcPairingExpiry=ie.getPairingExpiry()},setWcLinking(t){Te.wcLinking=t},setWcError(t){Te.wcError=t,Te.buffering=!1},setRecentWallet(t){Te.recentWallet=t},setBuffering(t){Te.buffering=t},setStatus(t){Te.status=t},setIsSwitchingConnection(t){Te.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){var r;try{await((r=J._getClient())==null?void 0:r.disconnect({id:t,chainNamespace:e,initialDisconnect:n}))}catch(s){throw new wo("Failed to disconnect","INTERNAL_SDK_ERROR",s)}},setConnections(t,e){const n=new Map(Te.connections);n.set(e,t),Te.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){var s,i;const n=(i=(s=ce.state.user)==null?void 0:s.accounts)==null?void 0:i.find(o=>o.type==="smartAccount"),r=n&&n.address.toLowerCase()===t.toLowerCase()&&Vo.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await J.setPreferredAccountType(r,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=K.getConnectorById(t.connectorId),s=t.connectorId===$.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)s&&n&&await J.handleAuthAccountSwitch({address:n,namespace:e});else{const i=await J.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e);return i==null?void 0:i.address}return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){var u,l;const s=K.getConnectorById(t.connectorId),i=(l=(u=t.auth)==null?void 0:u.name)==null?void 0:l.toLowerCase(),o=t.connectorId===$.CONNECTOR_ID.AUTH,a=t.connectorId===$.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&Vo.isSocialProvider(i)){const{address:d}=await Vo.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){$e.open({view:"ConnectingFarcaster"})},onConnect(){ge.replace("ProfileWallets")}});c=d}else{const{address:d}=await Vo.connectEmail({closeModalOnConnect:r,onOpen(){$e.open({view:"EmailLogin"})},onConnect(){ge.replace("ProfileWallets")}});c=d}else if(a){const{address:d}=await Vo.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(h){$e.open({view:h?"AllWallets":"ConnectingWalletConnect"})},onConnect(){ge.replace("ProfileWallets")}});c=d}else{const d=await J.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);d&&(c=d.address)}return o&&n&&await J.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=ce.getCaipAddress(n);if(o){const{address:c}=En.parseCaipAddress(o);i=c}const a=Gu.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await J.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const u=c.toLowerCase()!==i.toLowerCase();s==null||s({address:c,namespace:n,hasSwitchedAccount:u,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await J.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&(s==null||s({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${a}`)}}},J=Nn(j_),Mi=Ye({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Cr={state:Mi,subscribe(t){return Dt(Mi,()=>t(Mi))},subscribeOpen(t){return $t(Mi,"open",t)},set(t){Object.assign(Mi,{...Mi,...t})}},z_={async getTokenList(){var r;const t=E.state.activeCaipNetwork,e=await he.fetchSwapTokens({chainId:t==null?void 0:t.caipNetworkId});return((r=e==null?void 0:e.tokens)==null?void 0:r.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const t=E.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const n=(e=await(J==null?void 0:J.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:n,fast:n,instant:n};case"eip155":default:return await he.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await he.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s!=null&&s.allowance&&n&&r){const i=J.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await yp.getMyTokensWithBalance(t);return ce.setTokenBalance(e,E.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:E0(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},ze=Ye({tokenBalances:[],loading:!1}),q_={state:ze,subscribe(t){return Dt(ze,()=>t(ze))},subscribeKey(t,e){return $t(ze,t,e)},setToken(t){t&&(ze.token=hi(t))},setTokenAmount(t){ze.sendTokenAmount=t},setReceiverAddress(t){ze.receiverAddress=t},setReceiverProfileImageUrl(t){ze.receiverProfileImageUrl=t},setReceiverProfileName(t){ze.receiverProfileName=t},setNetworkBalanceInUsd(t){ze.networkBalanceInUSD=t},setLoading(t){ze.loading=t},async sendToken(){var t;try{switch(Le.setLoading(!0),(t=E.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await Le.sendEvmToken();return;case"solana":await Le.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{Le.setLoading(!1)}},async sendEvmToken(){var n,r,s;const t=E.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=In(t);if(!Le.state.sendTokenAmount||!Le.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Le.state.token)throw new Error("A token is required");(n=Le.state.token)!=null&&n.address?(qe.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===wt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Le.state.token.address,amount:Le.state.sendTokenAmount,network:((r=E.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}),await Le.sendERC20Token({receiverAddress:Le.state.receiverAddress,tokenAddress:Le.state.token.address,sendTokenAmount:Le.state.sendTokenAmount,decimals:Le.state.token.quantity.decimals})):(qe.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===wt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Le.state.token.symbol||"",amount:Le.state.sendTokenAmount,network:((s=E.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await Le.sendNativeToken({receiverAddress:Le.state.receiverAddress,sendTokenAmount:Le.state.sendTokenAmount,decimals:Le.state.token.quantity.decimals}))},async fetchTokenBalance(t){var i,o;ze.loading=!0;const e=(i=E.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,n=(o=E.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=E.state.activeCaipAddress,s=r?ie.getPlainAddress(r):void 0;if(ze.lastRetry&&!ie.isAllowedRetry(ze.lastRetry,30*Be.ONE_SEC_MS))return ze.loading=!1,[];try{if(s&&e&&n){const a=await yp.getMyTokensWithBalance();return ze.tokenBalances=a,ze.lastRetry=void 0,a}}catch(a){ze.lastRetry=Date.now(),t==null||t(a),vr.showError("Token Balance Unavailable")}finally{ze.loading=!1}return[]},fetchNetworkBalance(){if(ze.tokenBalances.length===0)return;const t=z_.mapBalancesToSwapTokens(ze.tokenBalances);if(!t)return;const e=t.find(n=>n.address===E0());e&&(ze.networkBalanceInUSD=e?l_.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var i,o,a;ge.pushTransactionStack({});const e=t.receiverAddress,n=ce.state.address,r=J.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));await J.sendTransaction({chainNamespace:$.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)}),qe.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:In("eip155")===wt.ACCOUNT_TYPES.SMART_ACCOUNT,token:((i=Le.state.token)==null?void 0:i.symbol)||"",amount:t.sendTokenAmount,network:((o=E.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)||""}}),(a=J._getClient())==null||a.updateBalance("eip155"),Le.resetSend()},async sendERC20Token(t){ge.pushTransactionStack({onSuccess(){ge.replace("Account")}});const e=J.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));if(ce.state.address&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const n=ie.getPlainAddress(t.tokenAddress);if(!n)throw new Error("SendController:sendERC20Token - tokenAddress is required");await J.writeContract({fromAddress:ce.state.address,tokenAddress:n,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:p_.getERC20Abi(n),chainNamespace:$.CHAIN.EVM}),Le.resetSend()}},async sendSolanaToken(){var t;if(!Le.state.sendTokenAmount||!Le.state.receiverAddress)throw new Error("An amount and receiver address are required");ge.pushTransactionStack({onSuccess(){ge.replace("Account")}}),await J.sendTransaction({chainNamespace:"solana",to:Le.state.receiverAddress,value:Le.state.sendTokenAmount}),(t=J._getClient())==null||t.updateBalance("solana"),Le.resetSend()},resetSend(){ze.token=void 0,ze.sendTokenAmount=void 0,ze.receiverAddress=void 0,ze.receiverProfileImageUrl=void 0,ze.receiverProfileName=void 0,ze.loading=!1,ze.tokenBalances=[]}},Le=Nn(q_),md={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},Xc={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},X=Ye({chains:t_(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),H_={state:X,subscribe(t){return Dt(X,()=>{t(X)})},subscribeKey(t,e){return $t(X,t,e)},subscribeChainProp(t,e,n){let r;return Dt(X.chains,()=>{var i;const s=n||X.activeChain;if(s){const o=(i=X.chains.get(s))==null?void 0:i[t];r!==o&&(r=o,e(o))}})},initialize(t,e,n){const{chainId:r,namespace:s}=H.getActiveNetworkProps(),i=e==null?void 0:e.find(l=>l.id.toString()===(r==null?void 0:r.toString())),a=t.find(l=>(l==null?void 0:l.namespace)===s)||(t==null?void 0:t[0]),c=t.map(l=>l.namespace).filter(l=>l!==void 0),u=F.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(l=>l.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!a)&&(X.noAdapters=!0),X.noAdapters||(X.activeChain=a==null?void 0:a.namespace,X.activeCaipNetwork=i,E.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),X.activeChain&&Cr.set({activeChain:a==null?void 0:a.namespace})),u.forEach(l=>{const d=e==null?void 0:e.filter(p=>p.chainNamespace===l),h=H.getPreferredAccountTypes()||{},f={...F.state.defaultAccountTypes,...h};E.state.chains.set(l,{namespace:l,networkState:Ye({...Xc,caipNetwork:d==null?void 0:d[0]}),accountState:Ye({...md,preferredAccountType:f[l]}),caipNetworks:d??[],...n}),E.setRequestedCaipNetworks(d??[],l)})},removeAdapter(t){var e,n;if(X.activeChain===t){const r=Array.from(X.chains.entries()).find(([s])=>s!==t);if(r){const s=(n=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:n[0];s&&E.setActiveCaipNetwork(s)}}X.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:n},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");X.chains.set(t.namespace,{namespace:t.namespace,networkState:{...Xc,caipNetwork:r[0]},accountState:md,caipNetworks:r,connectionControllerClient:n,networkControllerClient:e}),E.setRequestedCaipNetworks((r==null?void 0:r.filter(s=>s.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var n;const e=X.chains.get(t.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(n=e.caipNetworks)!=null&&n.find(s=>s.id===t.id)||r.push(t),X.chains.set(t.chainNamespace,{...e,caipNetworks:r}),E.setRequestedCaipNetworks(r,t.chainNamespace),K.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var r,s,i;const n=X.chains.get(t);if(n){const o=((r=X.activeCaipNetwork)==null?void 0:r.id)===e,a=[...((s=n.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=n==null?void 0:n.caipNetworks)!=null&&i[0])&&E.setActiveCaipNetwork(n.caipNetworks[0]),X.chains.set(t,{...n,caipNetworks:a}),E.setRequestedCaipNetworks(a||[],t),a.length===0&&K.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=X.chains.get(t);n&&(n.networkState={...n.networkState||Xc,...e},X.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=X.chains.get(t);if(r){const s={...r.accountState||md,...e};X.chains.set(t,{...r,accountState:s}),(X.chains.size===1||X.activeChain===t)&&(e.caipAddress&&(X.activeCaipAddress=e.caipAddress),ce.replaceState(s))}},setChainNetworkData(t,e){if(!t)return;const n=X.chains.get(t);if(n){const r={...n.networkState||Xc,...e};X.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){E.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){var r,s;X.activeChain=t;const e=t?X.chains.get(t):void 0,n=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;n!=null&&n.id&&t&&(X.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,X.activeCaipNetwork=n,E.setChainNetworkData(t,{caipNetwork:n}),H.setActiveCaipNetworkId(n==null?void 0:n.caipNetworkId),Cr.set({activeChain:t,selectedNetworkId:n==null?void 0:n.caipNetworkId}))},setActiveCaipNetwork(t){var r,s,i;if(!t)return;X.activeChain!==t.chainNamespace&&E.setIsSwitchingNamespace(!0);const e=X.chains.get(t.chainNamespace);X.activeChain=t.chainNamespace,X.activeCaipNetwork=t,E.setChainNetworkData(t.chainNamespace,{caipNetwork:t}),(r=e==null?void 0:e.accountState)!=null&&r.address?X.activeCaipAddress=`${t.chainNamespace}:${t.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:X.activeCaipAddress=void 0,E.setAccountProp("caipAddress",X.activeCaipAddress,t.chainNamespace),e&&ce.replaceState(e.accountState),Le.resetSend(),Cr.set({activeChain:X.activeChain,selectedNetworkId:(i=X.activeCaipNetwork)==null?void 0:i.caipNetworkId}),H.setActiveCaipNetworkId(t.caipNetworkId),!E.checkIfSupportedNetwork(t.chainNamespace)&&F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&!J.state.wcBasic&&E.showUnsupportedChainUI()},addCaipNetwork(t){var n;if(!t)return;const e=X.chains.get(t.chainNamespace);e&&((n=e==null?void 0:e.caipNetworks)==null||n.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==E.state.activeChain,n=(s=E.getNetworkData(t))==null?void 0:s.caipNetwork,r=E.getCaipNetworkByNamespace(t,n==null?void 0:n.id);e&&r&&await E.switchActiveNetwork(r)},async switchActiveNetwork(t){var i;const e=E.state.activeChain;if(!e)throw new Error("ChainController:switchActiveNetwork - namespace is required");const n=E.state.chains.get(e),r=!((i=n==null?void 0:n.caipNetworks)!=null&&i.some(o=>{var a;return o.id===((a=X.activeCaipNetwork)==null?void 0:a.id)})),s=E.getNetworkControllerClient(t.chainNamespace);if(s){try{await s.switchCaipNetwork(t),r&&$e.close()}catch{ge.goBack()}qe.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||X.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=X.chains.get(e);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(t){const e=t||X.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=X.chains.get(e);if(!(n!=null&&n.connectionControllerClient))throw new Error("ConnectionController client not set");return n.connectionControllerClient},getAccountProp(t,e){var s;let n=X.activeChain;if(e&&(n=e),!n)return;const r=(s=X.chains.get(n))==null?void 0:s.accountState;if(r)return r[t]},getNetworkProp(t,e){var r;const n=(r=X.chains.get(e))==null?void 0:r.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=X.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return ie.sortRequestedNetworks(n,r).filter(o=>o==null?void 0:o.id)},getAllRequestedCaipNetworks(){const t=[];return X.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=E.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){E.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=E.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));K.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return X.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=E.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){var e,n;return t?(n=(e=X.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:X.activeCaipNetwork},getActiveCaipAddress(){return X.activeCaipAddress},getApprovedCaipNetworkIds(t){var r;const e=X.chains.get(t);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(t){const e=E.getNetworkControllerClient(),n=await(e==null?void 0:e.getApprovedCaipNetworksData());E.setAdapterNetworkState(t,{approvedCaipNetworkIds:n==null?void 0:n.approvedCaipNetworkIds,supportsAllNetworks:n==null?void 0:n.supportsAllNetworks})},checkIfSupportedNetwork(t,e){const n=e||X.activeCaipNetwork,r=E.getRequestedCaipNetworks(t);return r.length?r==null?void 0:r.some(s=>s.id===(n==null?void 0:n.id)):!0},checkIfSupportedChainId(t){if(!X.activeChain)return!0;const e=E.getRequestedCaipNetworks(X.activeChain);return e==null?void 0:e.some(n=>n.id===t)},setSmartAccountEnabledNetworks(t,e){E.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){var r;const t=La.caipNetworkIdToNumber((r=X.activeCaipNetwork)==null?void 0:r.caipNetworkId),e=X.activeChain;if(!e||!t)return!1;const n=E.getNetworkProp("smartAccountEnabledNetworks",e);return!!(n!=null&&n.includes(Number(t)))},showUnsupportedChainUI(){$e.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=X.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&Be.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){E.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=F.state.defaultAccountTypes[e],r=E.getAccountProp("preferredAccountType",e);X.activeCaipAddress=void 0,E.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:n||r,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),K.removeConnectorId(e)},setIsSwitchingNamespace(t){X.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var n,r;const t=[];let e;if(X.chains.forEach(s=>{$.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(r=(n=X.chains.get(s))==null?void 0:n.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(t){var e;return t?(e=E.state.chains.get(t))==null?void 0:e.accountState:ce.state},getNetworkData(t){var n;const e=t||X.activeChain;if(e)return(n=E.state.chains.get(e))==null?void 0:n.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const n=E.state.chains.get(t),r=(s=n==null?void 0:n.caipNetworks)==null?void 0:s.find(a=>a.id===e);return r||((i=n==null?void 0:n.networkState)==null?void 0:i.caipNetwork)||((o=n==null?void 0:n.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=K.state.filterByNamespace;return(t?[X.chains.get(t)]:Array.from(X.chains.values())).flatMap(n=>(n==null?void 0:n.caipNetworks)||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?E.getRequestedCaipNetworks(t):E.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(t){X.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return X.lastConnectedSIWECaipNetwork}},E=Nn(H_),W_={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},C0=ie.getBlockchainApiUrl(),Qt=Ye({clientId:null,api:new Rc({baseUrl:C0,clientId:null}),supportedChains:{http:[],ws:[]}}),he={state:Qt,async get(t){const{st:e,sv:n}=he.getSdkProperties(),r=F.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return Qt.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=F.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{Qt.supportedChains.http.length||await he.getSupportedNetworks()}catch{return!1}return Qt.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await he.get({path:"v1/supported-chains"});return Qt.supportedChains=t,t}catch{return Qt.supportedChains}},async fetchIdentity({address:t,caipNetworkId:e}){if(!await he.isNetworkSupported(e))return{avatar:"",name:""};const r=H.getIdentityFromCacheForAddress(t);if(r)return r;const s=await he.get({path:`/v1/identity/${t}`,params:{sender:E.state.activeCaipAddress?ie.getPlainAddress(E.state.activeCaipAddress):void 0}});return H.updateIdentityCache({address:t,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){var o;return await he.isNetworkSupported((o=E.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?he.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r}):{data:[],next:void 0}},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){var o;return await he.isNetworkSupported((o=E.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?he.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var n;return await he.isNetworkSupported((n=E.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?he.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){var n;return await he.isNetworkSupported((n=E.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?Qt.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:F.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var r;return await he.isNetworkSupported((r=E.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?he.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:n}=he.getSdkProperties();if(!await he.isNetworkSupported((s=E.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return he.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){var o;if(!await he.isNetworkSupported((o=E.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return Qt.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Be.CONVERT_SLIPPAGE_TOLERANCE},projectId:F.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){var o;const{st:r,sv:s}=he.getSdkProperties();if(!await he.isNetworkSupported((o=E.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return he.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){var u;const{st:r,sv:s}=he.getSdkProperties();if(!await he.isNetworkSupported((u=E.state.activeCaipNetwork)==null?void 0:u.caipNetworkId))return vr.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=H.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await he.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return H.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){var n;return await he.isNetworkSupported((n=E.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?he.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var n;return await he.isNetworkSupported((n=E.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?he.get({path:`/v1/profile/reverse/${t}`,params:{sender:ce.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(t){var n;return await he.isNetworkSupported((n=E.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?he.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){var i;return await he.isNetworkSupported((i=E.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?Qt.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){var a;return await he.isNetworkSupported((a=E.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await Qt.api.post({path:"/v1/generators/onrampurl",params:{projectId:F.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await he.isNetworkSupported((e=E.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await he.get({path:"/v1/onramp/options"})}catch{return W_}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){var s;try{return await he.isNetworkSupported((s=E.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await Qt.api.post({path:"/v1/onramp/quote",params:{projectId:F.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var n;return await he.isNetworkSupported((n=E.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?he.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){var s;return await he.isNetworkSupported((s=E.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?Qt.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:F.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){Qt.clientId=t,Qt.api=new Rc({baseUrl:C0,clientId:t})}},V_="1.0.8";let Jt=class Ih extends Error{constructor(e,n={}){var o;const r=n.cause instanceof Ih?n.cause.details:(o=n.cause)!=null&&o.message?n.cause.message:n.details,s=n.cause instanceof Ih&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: abitype@${V_}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}};function es(t,e){const n=t.exec(e);return n==null?void 0:n.groups}const _0=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,A0=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,I0=/^\(.+?\).*?$/,Ag=/^tuple(?<array>(\[(\d*)\])*)$/;function Sh(t){let e=t.type;if(Ag.test(t.type)&&"components"in t){e="(";const n=t.components.length;for(let s=0;s<n;s++){const i=t.components[s];e+=Sh(i),s<n-1&&(e+=", ")}const r=es(Ag,t.type);return e+=`)${(r==null?void 0:r.array)??""}`,Sh({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function Go(t){let e="";const n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=Sh(s),r!==n-1&&(e+=", ")}return e}function G_(t){var e;return t.type==="function"?`function ${t.name}(${Go(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${(e=t.outputs)!=null&&e.length?` returns (${Go(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${Go(t.inputs)})`:t.type==="error"?`error ${t.name}(${Go(t.inputs)})`:t.type==="constructor"?`constructor(${Go(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const S0=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function K_(t){return S0.test(t)}function Y_(t){return es(S0,t)}const N0=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function Z_(t){return N0.test(t)}function J_(t){return es(N0,t)}const T0=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function X_(t){return T0.test(t)}function Q_(t){return es(T0,t)}const x0=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function P0(t){return x0.test(t)}function eA(t){return es(x0,t)}const O0=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function tA(t){return O0.test(t)}function nA(t){return es(O0,t)}const R0=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function rA(t){return R0.test(t)}function sA(t){return es(R0,t)}const iA=/^receive\(\) external payable$/;function oA(t){return iA.test(t)}const Qj=new Set(["memory","indexed","storage","calldata"]),aA=new Set(["indexed"]),Nh=new Set(["calldata","memory","storage"]);class ez extends Jt{constructor({signature:e}){super("Failed to parse ABI item.",{details:`parseAbiItem(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiitem-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiItemError"})}}class cA extends Jt{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class uA extends Jt{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class tz extends Jt{constructor({param:e}){super("Failed to parse ABI parameter.",{details:`parseAbiParameter(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameter-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParameterError"})}}class nz extends Jt{constructor({params:e}){super("Failed to parse ABI parameters.",{details:`parseAbiParameters(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameters-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParametersError"})}}class lA extends Jt{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class dA extends Jt{constructor({param:e,name:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class hA extends Jt{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class fA extends Jt{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class pA extends Jt{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class Po extends Jt{constructor({signature:e,type:n}){super(`Invalid ${n} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class gA extends Jt{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class mA extends Jt{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class yA extends Jt{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class wA extends Jt{constructor({current:e,depth:n}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function bA(t,e,n){let r="";if(n)for(const s of Object.entries(n)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;r+=`(${s[0]}{${i}})`}return e?`${e}:${t}${r}`:t}const yd=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function vA(t,e={}){if(X_(t))return EA(t,e);if(Z_(t))return CA(t,e);if(K_(t))return _A(t,e);if(tA(t))return AA(t,e);if(rA(t))return IA(t);if(oA(t))return{type:"receive",stateMutability:"payable"};throw new gA({signature:t})}function EA(t,e={}){const n=Q_(t);if(!n)throw new Po({signature:t,type:"function"});const r=Xn(n.parameters),s=[],i=r.length;for(let a=0;a<i;a++)s.push(pi(r[a],{modifiers:Nh,structs:e,type:"function"}));const o=[];if(n.returns){const a=Xn(n.returns),c=a.length;for(let u=0;u<c;u++)o.push(pi(a[u],{modifiers:Nh,structs:e,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:o}}function CA(t,e={}){const n=J_(t);if(!n)throw new Po({signature:t,type:"event"});const r=Xn(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(pi(r[o],{modifiers:aA,structs:e,type:"event"}));return{name:n.name,type:"event",inputs:s}}function _A(t,e={}){const n=Y_(t);if(!n)throw new Po({signature:t,type:"error"});const r=Xn(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(pi(r[o],{structs:e,type:"error"}));return{name:n.name,type:"error",inputs:s}}function AA(t,e={}){const n=nA(t);if(!n)throw new Po({signature:t,type:"constructor"});const r=Xn(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(pi(r[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}function IA(t){const e=sA(t);if(!e)throw new Po({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const SA=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,NA=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,TA=/^u?int$/;function pi(t,e){var d,h;const n=bA(t,e==null?void 0:e.type,e==null?void 0:e.structs);if(yd.has(n))return yd.get(n);const r=I0.test(t),s=es(r?NA:SA,t);if(!s)throw new lA({param:t});if(s.name&&PA(s.name))throw new dA({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=(e==null?void 0:e.structs)??{};let c,u={};if(r){c="tuple";const f=Xn(s.type),p=[],g=f.length;for(let m=0;m<g;m++)p.push(pi(f[m],{structs:a}));u={components:p}}else if(s.type in a)c="tuple",u={components:a[s.type]};else if(TA.test(s.type))c=`${s.type}256`;else if(c=s.type,(e==null?void 0:e.type)!=="struct"&&!D0(c))throw new uA({type:c});if(s.modifier){if(!((h=(d=e==null?void 0:e.modifiers)==null?void 0:d.has)!=null&&h.call(d,s.modifier)))throw new hA({param:t,type:e==null?void 0:e.type,modifier:s.modifier});if(Nh.has(s.modifier)&&!OA(c,!!s.array))throw new fA({param:t,type:e==null?void 0:e.type,modifier:s.modifier})}const l={type:`${c}${s.array??""}`,...i,...o,...u};return yd.set(n,l),l}function Xn(t,e=[],n="",r=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?Xn(a,[...e,n.trim()]):Xn(a,e,`${n}${o}`,r);case"(":return Xn(a,e,`${n}${o}`,r+1);case")":return Xn(a,e,`${n}${o}`,r-1);default:return Xn(a,e,`${n}${o}`,r)}}if(n==="")return e;if(r!==0)throw new wA({current:n,depth:r});return e.push(n.trim()),e}function D0(t){return t==="address"||t==="bool"||t==="function"||t==="string"||_0.test(t)||A0.test(t)}const xA=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function PA(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||_0.test(t)||A0.test(t)||xA.test(t)}function OA(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function RA(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!P0(a))continue;const c=eA(a);if(!c)throw new Po({signature:a,type:"struct"});const u=c.properties.split(";"),l=[],d=u.length;for(let h=0;h<d;h++){const p=u[h].trim();if(!p)continue;const g=pi(p,{type:"struct"});l.push(g)}if(!l.length)throw new mA({signature:a});e[c.name]=l}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=$0(c,e)}return r}const DA=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function $0(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(I0.test(o.type))r.push(o);else{const c=es(DA,o.type);if(!(c!=null&&c.type))throw new pA({abiParameter:o});const{array:u,type:l}=c;if(l in e){if(n.has(l))throw new yA({type:l});r.push({...o,type:`tuple${u??""}`,components:$0(e[l]??[],e,new Set([...n,l]))})}else if(D0(l))r.push(o);else throw new cA({type:l})}}return r}function k0(t){const e=RA(t),n=[],r=t.length;for(let s=0;s<r;s++){const i=t[s];P0(i)||n.push(vA(i,e))}return n}function st(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}function Ds(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new WA(t.type);return`${t.name}(${Nl(t.inputs,{includeName:e})})`}function Nl(t,{includeName:e=!1}={}){return t?t.map(n=>$A(n,{includeName:e})).join(e?", ":","):""}function $A(t,{includeName:e}){return t.type.startsWith("tuple")?`(${Nl(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function $s(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function yt(t){return $s(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const U0="2.32.0";let so={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${U0}`};function rz(t){so=t}let j=class Th extends Error{constructor(e,n={}){var a;const r=(()=>{var c;return n.cause instanceof Th?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof Th&&n.cause.docsPath||n.docsPath,i=(a=so.getDocsUrl)==null?void 0:a.call(so,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...so.version?[`Version: ${so.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=U0}walk(e){return M0(this,e)}};function M0(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?M0(t.cause,e):e?null:t}class kA extends j{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class Ig extends j{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class sz extends j{constructor({data:e,size:n}){super([`Data size of ${n} bytes is invalid.`,"Size must be in increments of 32 bytes (size % 32 === 0)."].join(`
`),{metaMessages:[`Data: ${e} (${n} bytes)`],name:"AbiDecodingDataSizeInvalidError"})}}class L0 extends j{constructor({data:e,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${Nl(n,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=n,this.size=r}}class Tl extends j{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class UA extends j{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class MA extends j{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${yt(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class LA extends j{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class iz extends j{constructor(e,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class oz extends j{constructor(e,{docsPath:n}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class B0 extends j{constructor(e,{docsPath:n}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class BA extends j{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class F0 extends j{constructor(e,{docsPath:n}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class az extends j{constructor(e,{docsPath:n}={}){super([`Event ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class Ku extends j{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class FA extends j{constructor(e,{docsPath:n}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class cz extends j{constructor(e,{docsPath:n}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class jA extends j{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${Ds(e.abiItem)}\`, and`,`\`${n.type}\` in \`${Ds(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class uz extends j{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class xh extends j{constructor({abiItem:e,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${Nl(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=n,this.params=r,this.size=s}}class j0 extends j{constructor({abiItem:e,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${Ds(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class zA extends j{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class qA extends j{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}class HA extends j{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class WA extends j{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class lz extends j{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}let z0=class extends j{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}},q0=class extends j{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class Sg extends j{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function Oo(t,{dir:e,size:n=32}={}){return typeof t=="string"?As(t,{dir:e,size:n}):VA(t,{dir:e,size:n})}function As(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new q0({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function VA(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new q0({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let H0=class extends j{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}};class GA extends j{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class KA extends j{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let pz=class extends j{constructor(e){super(`Hex value "${e}" is an odd length (${e.length}). It must be an even length.`,{name:"InvalidHexValueError"})}},YA=class extends j{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Is(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function jn(t,{size:e}){if(yt(t)>e)throw new YA({givenSize:yt(t),maxSize:e})}function yz(t,e){const n=typeof e=="string"?{to:e}:e,r=n.to;return r==="number"?ks(t,n):r==="bigint"?gi(t,n):r==="string"?Yf(t,n):r==="boolean"?ZA(t,n):sr(t,n)}function gi(t,e={}){const{signed:n}=e;e.size&&jn(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function ZA(t,e={}){let n=t;if(e.size&&(jn(n,{size:e.size}),n=Is(n)),Is(n)==="0x00")return!1;if(Is(n)==="0x01")return!0;throw new KA(n)}function ks(t,e={}){return Number(gi(t,e))}function Yf(t,e={}){let n=sr(t);return e.size&&(jn(n,{size:e.size}),n=Is(n,{dir:"right"})),new TextDecoder().decode(n)}const JA=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function mi(t,e={}){return typeof t=="number"||typeof t=="bigint"?Ae(t,e):typeof t=="string"?xl(t,e):typeof t=="boolean"?W0(t,e):Yt(t,e)}function W0(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(jn(n,{size:e.size}),Oo(n,{size:e.size})):n}function Yt(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=JA[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(jn(r,{size:e.size}),Oo(r,{dir:"right",size:e.size})):r}function Ae(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new H0({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Oo(a,{size:r}):a}const XA=new TextEncoder;function xl(t,e={}){const n=XA.encode(t);return Yt(n,e)}const QA=new TextEncoder;function Pl(t,e={}){return typeof t=="number"||typeof t=="bigint"?tI(t,e):typeof t=="boolean"?eI(t,e):$s(t)?sr(t,e):V0(t,e)}function eI(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(jn(n,{size:e.size}),Oo(n,{size:e.size})):n}const kr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Ng(t){if(t>=kr.zero&&t<=kr.nine)return t-kr.zero;if(t>=kr.A&&t<=kr.F)return t-(kr.A-10);if(t>=kr.a&&t<=kr.f)return t-(kr.a-10)}function sr(t,e={}){let n=t;e.size&&(jn(n,{size:e.size}),n=Oo(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Ng(r.charCodeAt(a++)),u=Ng(r.charCodeAt(a++));if(c===void 0||u===void 0)throw new j(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+u}return i}function tI(t,e){const n=Ae(t,e);return sr(n)}function V0(t,e={}){const n=QA.encode(t);return typeof e.size=="number"?(jn(n,{size:e.size}),Oo(n,{dir:"right",size:e.size})):n}const nI=BigInt(0),Ko=BigInt(1),rI=BigInt(2),sI=BigInt(7),iI=BigInt(256),oI=BigInt(113),G0=[],K0=[],Y0=[];for(let t=0,e=Ko,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],G0.push(2*(5*r+n)),K0.push((t+1)*(t+2)/2%64);let s=nI;for(let i=0;i<7;i++)e=(e<<Ko^(e>>sI)*oI)%iI,e&rI&&(s^=Ko<<(Ko<<BigInt(i))-Ko);Y0.push(s)}const Z0=FC(Y0,!0),aI=Z0[0],cI=Z0[1],Tg=(t,e,n)=>n>32?LC(t,e,n):UC(t,e,n),xg=(t,e,n)=>n>32?BC(t,e,n):MC(t,e,n);function uI(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=n[c],l=n[c+1],d=Tg(u,l,1)^n[a],h=xg(u,l,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=K0[o],c=Tg(s,i,a),u=xg(s,i,a),l=G0[o];s=t[l],i=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=aI[r],t[1]^=cI[r]}p0(n)}class Zf extends RC{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,hg(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=DC(this.state)}clone(){return this._cloneInto()}keccak(){fg(this.state32),uI(this.state32,this.rounds),fg(this.state32),this.posOut=0,this.pos=0}update(e){pg(this),e=$C(e),gg(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){pg(this,!1),gg(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return hg(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(kC(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,p0(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Zf(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const lI=(t,e,n)=>OC(()=>new Zf(e,t,n)),J0=lI(1,136,256/8);function Dc(t,e){const n=e||"hex",r=J0($s(t,{strict:!1})?Pl(t):t);return n==="bytes"?r:mi(r)}const dI=t=>Dc(Pl(t));function hI(t){return dI(t)}function fI(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new j("Unable to normalize signature.");return s}const pI=t=>{const e=typeof t=="string"?t:G_(t);return fI(e)};function X0(t){return hI(pI(t))}const Jf=X0;class yi extends j{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}let Ol=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const wd=new Ol(8192);function Rl(t,e){if(wd.has(`${t}.${e}`))return wd.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=Dc(V0(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return wd.set(`${t}.${e}`,i),i}function ei(t,e){if(!Nr(t,{strict:!1}))throw new yi({address:t});return Rl(t,e)}const gI=/^0x[a-fA-F0-9]{40}$/,bd=new Ol(8192);function Nr(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if(bd.has(r))return bd.get(r);const s=gI.test(t)?t.toLowerCase()===t?!0:n?Rl(t)===t:!0:!1;return bd.set(r,s),s}function vo(t){return typeof t[0]=="string"?Dl(t):mI(t)}function mI(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function Dl(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function Yu(t,e,n,{strict:r}={}){return $s(t,{strict:!1})?yI(t,e,n,{strict:r}):tb(t,e,n,{strict:r})}function Q0(t,e){if(typeof e=="number"&&e>0&&e>yt(t)-1)throw new z0({offset:e,position:"start",size:yt(t)})}function eb(t,e,n){if(typeof e=="number"&&typeof n=="number"&&yt(t)!==n-e)throw new z0({offset:n,position:"end",size:yt(t)})}function tb(t,e,n,{strict:r}={}){Q0(t,e);const s=t.slice(e,n);return r&&eb(s,e,n),s}function yI(t,e,n,{strict:r}={}){Q0(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return r&&eb(s,e,n),s}const bz=/^(.*)\[([0-9]*)\]$/,vz=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,wI=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function nb(t,e){if(t.length!==e.length)throw new LA({expectedLength:t.length,givenLength:e.length});const n=bI({params:t,values:e}),r=Qf(n);return r.length===0?"0x":r}function bI({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(Xf({param:t[r],value:e[r]}));return n}function Xf({param:t,value:e}){const n=ep(t.type);if(n){const[r,s]=n;return EI(e,{length:r,param:{...t,type:s}})}if(t.type==="tuple")return SI(e,{param:t});if(t.type==="address")return vI(e);if(t.type==="bool")return _I(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=wI.exec(t.type)??[];return AI(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return CI(e,{param:t});if(t.type==="string")return II(e);throw new zA(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function Qf(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=yt(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(Ae(e+s,{size:32})),r.push(a),s+=yt(a)):n.push(a)}return vo([...n,...r])}function vI(t){if(!Nr(t))throw new yi({address:t});return{dynamic:!1,encoded:As(t.toLowerCase())}}function EI(t,{length:e,param:n}){const r=e===null;if(!Array.isArray(t))throw new HA(t);if(!r&&t.length!==e)throw new UA({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=Xf({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=Qf(i);if(r){const a=Ae(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?vo([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:vo(i.map(({encoded:o})=>o))}}function CI(t,{param:e}){const[,n]=e.type.split("bytes"),r=yt(t);if(!n){let s=t;return r%32!==0&&(s=As(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:vo([As(Ae(r,{size:32})),s])}}if(r!==Number.parseInt(n))throw new MA({expectedSize:Number.parseInt(n),value:t});return{dynamic:!1,encoded:As(t,{dir:"right"})}}function _I(t){if(typeof t!="boolean")throw new j(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:As(W0(t))}}function AI(t,{signed:e,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new H0({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:Ae(t,{size:32,signed:e})}}function II(t){const e=xl(t),n=Math.ceil(yt(e)/32),r=[];for(let s=0;s<n;s++)r.push(As(Yu(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:vo([As(Ae(yt(e),{size:32})),...r])}}function SI(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=Xf({param:i,value:t[o]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?Qf(r):vo(r.map(({encoded:s})=>s))}}function ep(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const tp=t=>Yu(X0(t),0,4);function np(t){const{abi:e,args:n=[],name:r}=t,s=$s(r,{strict:!1}),i=e.filter(a=>s?a.type==="function"?tp(a)===r:a.type==="event"?Jf(a)===r:!1:"name"in a&&a.name===r);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!n||n.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==n.length)continue;if(n.every((u,l)=>{const d="inputs"in a&&a.inputs[l];return d?Ph(u,d):!1})){if(o&&"inputs"in o&&o.inputs){const u=rb(a.inputs,o.inputs,n);if(u)throw new jA({abiItem:a,type:u[0]},{abiItem:o,type:u[1]})}o=a}}return o||i[0]}function Ph(t,e){const n=typeof t,r=e.type;switch(r){case"address":return Nr(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>Ph(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>Ph(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function rb(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return rb(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?Nr(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?Nr(n[r],{strict:!1}):!1)return o}}function NI(t,{method:e}){var r,s;const n={};return t.transport.type==="fallback"&&((s=(r=t.transport).onResponse)==null||s.call(r,({method:i,response:o,status:a,transport:c})=>{a==="success"&&e===i&&(n[o]=c.request)})),i=>n[i]||t.request}function Rr(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const Pg="/docs/contract/encodeFunctionData";function TI(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=np({abi:e,args:n,name:r});if(!i)throw new Ku(r,{docsPath:Pg});s=i}if(s.type!=="function")throw new Ku(void 0,{docsPath:Pg});return{abi:[s],functionName:tp(Ds(s))}}function $l(t){const{args:e}=t,{abi:n,functionName:r}=(()=>{var a;return t.abi.length===1&&((a=t.functionName)!=null&&a.startsWith("0x"))?t:TI(t)})(),s=n[0],i=r,o="inputs"in s&&s.inputs?nb(s.inputs,e??[]):void 0;return Dl([i,o??"0x"])}const xI={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},PI={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},OI={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};class Og extends j{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class sb extends j{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class RI extends j{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const DI={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new RI({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new sb({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new Og({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new Og({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function rp(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(DI);return n.bytes=t,n.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}function Ez(t,e){const n=typeof e=="string"?{to:e}:e,r=n.to;return r==="number"?_r(t,n):r==="bigint"?ib(t,n):r==="boolean"?ob(t,n):r==="string"?ab(t,n):Yt(t,n)}function ib(t,e={}){typeof e.size<"u"&&jn(t,{size:e.size});const n=Yt(t,e);return gi(n,e)}function ob(t,e={}){let n=t;if(typeof e.size<"u"&&(jn(n,{size:e.size}),n=Is(n)),n.length>1||n[0]>1)throw new GA(n);return!!n[0]}function _r(t,e={}){typeof e.size<"u"&&jn(t,{size:e.size});const n=Yt(t,e);return ks(n,e)}function ab(t,e={}){let n=t;return typeof e.size<"u"&&(jn(n,{size:e.size}),n=Is(n,{dir:"right"})),new TextDecoder().decode(n)}function kl(t,e){const n=typeof e=="string"?sr(e):e,r=rp(n);if(yt(n)===0&&t.length>0)throw new Tl;if(yt(e)&&yt(e)<32)throw new L0({data:typeof e=="string"?e:Yt(e),params:t,size:yt(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];r.setPosition(s);const[c,u]=ho(r,a,{staticPosition:0});s+=u,i.push(c)}return i}function ho(t,e,{staticPosition:n}){const r=ep(e.type);if(r){const[s,i]=r;return kI(t,{...e,type:i},{length:s,staticPosition:n})}if(e.type==="tuple")return BI(t,e,{staticPosition:n});if(e.type==="address")return $I(t);if(e.type==="bool")return UI(t);if(e.type.startsWith("bytes"))return MI(t,e,{staticPosition:n});if(e.type.startsWith("uint")||e.type.startsWith("int"))return LI(t,e);if(e.type==="string")return FI(t,{staticPosition:n});throw new qA(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const Rg=32,Oh=32;function $I(t){const e=t.readBytes(32);return[Rl(Yt(tb(e,-20))),32]}function kI(t,e,{length:n,staticPosition:r}){if(!n){const o=_r(t.readBytes(Oh)),a=r+o,c=a+Rg;t.setPosition(a);const u=_r(t.readBytes(Rg)),l=Ba(e);let d=0;const h=[];for(let f=0;f<u;++f){t.setPosition(c+(l?f*32:d));const[p,g]=ho(t,e,{staticPosition:c});d+=g,h.push(p)}return t.setPosition(r+32),[h,32]}if(Ba(e)){const o=_r(t.readBytes(Oh)),a=r+o,c=[];for(let u=0;u<n;++u){t.setPosition(a+u*32);const[l]=ho(t,e,{staticPosition:a});c.push(l)}return t.setPosition(r+32),[c,32]}let s=0;const i=[];for(let o=0;o<n;++o){const[a,c]=ho(t,e,{staticPosition:r+s});s+=c,i.push(a)}return[i,s]}function UI(t){return[ob(t.readBytes(32),{size:32}),32]}function MI(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=_r(t.readBytes(32));t.setPosition(n+o);const a=_r(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[Yt(c),32]}return[Yt(t.readBytes(Number.parseInt(s),32)),32]}function LI(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256"),s=t.readBytes(32);return[r>48?ib(s,{signed:n}):_r(s,{signed:n}),32]}function BI(t,e,{staticPosition:n}){const r=e.components.length===0||e.components.some(({name:o})=>!o),s=r?[]:{};let i=0;if(Ba(e)){const o=_r(t.readBytes(Oh)),a=n+o;for(let c=0;c<e.components.length;++c){const u=e.components[c];t.setPosition(a+i);const[l,d]=ho(t,u,{staticPosition:a});i+=d,s[r?c:u==null?void 0:u.name]=l}return t.setPosition(n+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,u]=ho(t,a,{staticPosition:n});s[r?o:a==null?void 0:a.name]=c,i+=u}return[s,i]}function FI(t,{staticPosition:e}){const n=_r(t.readBytes(32)),r=e+n;t.setPosition(r);const s=_r(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=ab(Is(i));return t.setPosition(e+32),[o,32]}function Ba(t){var r;const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return(r=t.components)==null?void 0:r.some(Ba);const n=ep(t.type);return!!(n&&Ba({...t,type:n[1]}))}function jI(t){const{abi:e,data:n}=t,r=Yu(n,0,4);if(r==="0x")throw new Tl;const i=[...e||[],PI,OI].find(o=>o.type==="error"&&r===tp(Ds(o)));if(!i)throw new B0(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?kl(i.inputs,Yu(n,4)):void 0,errorName:i.name}}const An=(t,e,n)=>JSON.stringify(t,(r,s)=>{const i=typeof s=="bigint"?s.toString():s;return typeof e=="function"?e(r,i):i},n);function cb({abiItem:t,args:e,includeFunctionName:n=!0,includeName:r=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${n?t.name:""}(${t.inputs.map((s,i)=>`${r&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?An(e[i]):e[i]}`).join(", ")})`}const zI={gwei:9,wei:18},qI={ether:-9,wei:9},HI={ether:-18,gwei:-9};function Ro(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function sp(t,e="wei"){return Ro(t,zI[e])}function hn(t,e="wei"){return Ro(t,qI[e])}class WI extends j{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class VI extends j{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function Dg(t){return t.reduce((e,{slot:n,value:r})=>`${e}        ${n}: ${r}
`,"")}function GI(t){return t.reduce((e,{address:n,...r})=>{let s=`${e}    ${n}:
`;return r.nonce&&(s+=`      nonce: ${r.nonce}
`),r.balance&&(s+=`      balance: ${r.balance}
`),r.code&&(s+=`      code: ${r.code}
`),r.state&&(s+=`      state:
`,s+=Dg(r.state)),r.stateDiff&&(s+=`      stateDiff:
`,s+=Dg(r.stateDiff)),s},`  State Override:
`).slice(0,-1)}function $c(t){const e=Object.entries(t).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=e.reduce((r,[s])=>Math.max(r,s.length),0);return e.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class KI extends j{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}}class Cz extends j{constructor({v:e}){super(`Invalid \`v\` value "${e}". Expected 27 or 28.`,{name:"InvalidLegacyVError"})}}class YI extends j{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",$c(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class _z extends j{constructor({serializedType:e}){super(`Serialized transaction type "${e}" is invalid.`,{name:"InvalidSerializedTransactionType"}),Object.defineProperty(this,"serializedType",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.serializedType=e}}class Az extends j{constructor({attributes:e,serializedTransaction:n,type:r}){const s=Object.entries(e).map(([i,o])=>typeof o>"u"?i:void 0).filter(Boolean);super(`Invalid serialized transaction of type "${r}" was provided.`,{metaMessages:[`Serialized Transaction: "${n}"`,s.length>0?`Missing Attributes: ${s.join(", ")}`:""].filter(Boolean),name:"InvalidSerializedTransactionError"}),Object.defineProperty(this,"serializedTransaction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.serializedTransaction=n,this.type=r}}class Iz extends j{constructor({storageKey:e}){super(`Size for storage key "${e}" is invalid. Expected 32 bytes. Got ${Math.floor((e.length-2)/2)} bytes.`,{name:"InvalidStorageKeySizeError"})}}class ZI extends j{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:h}){var p;const f=$c({chain:s&&`${s==null?void 0:s.name} (id: ${s==null?void 0:s.id})`,from:n==null?void 0:n.address,to:d,value:typeof h<"u"&&`${sp(h)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${hn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${hn(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${hn(u)} gwei`,nonce:l});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",f].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class ub extends j{constructor({blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){let o="Transaction";r&&i!==void 0&&(o=`Transaction at block time "${r}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),n&&i!==void 0&&(o=`Transaction at block number "${n}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class lb extends j{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class JI extends j{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const XI=t=>t,kc=t=>t;class QI extends j{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:h,stateOverride:f}){var m;const p=n?Rr(n):void 0;let g=$c({from:p==null?void 0:p.address,to:d,value:typeof h<"u"&&`${sp(h)} ${((m=s==null?void 0:s.nativeCurrency)==null?void 0:m.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${hn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${hn(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${hn(u)} gwei`,nonce:l});f&&(g+=`
${GI(f)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",g].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class db extends j{constructor(e,{abi:n,args:r,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=np({abi:n,args:r,name:o}),u=c?cb({abiItem:c,args:r,includeFunctionName:!1,includeName:!1}):void 0,l=c?Ds(c,{includeName:!0}):void 0,d=$c({address:s&&XI(s),function:l,args:u&&u!=="()"&&`${[...Array((o==null?void 0:o.length)??0).keys()].map(()=>" ").join("")}${u}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=r,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class e2 extends j{constructor({abi:e,data:n,functionName:r,message:s}){let i,o,a,c;if(n&&n!=="0x")try{o=jI({abi:e,data:n});const{abiItem:l,errorName:d,args:h}=o;if(d==="Error")c=h[0];else if(d==="Panic"){const[f]=h;c=xI[f]}else{const f=l?Ds(l,{includeName:!0}):void 0,p=l&&h?cb({abiItem:l,args:h,includeFunctionName:!1,includeName:!1}):void 0;a=[f?`Error: ${f}`:"",p&&p!=="()"?`       ${[...Array((d==null?void 0:d.length)??0).keys()].map(()=>" ").join("")}${p}`:""]}}catch(l){i=l}else s&&(c=s);let u;i instanceof B0&&(u=i.signature,a=[`Unable to decode signature "${u}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${u}.`]),super(c&&c!=="execution reverted"||u?[`The contract function "${r}" reverted with the following ${u?"signature":"reason"}:`,c||u].join(`
`):`The contract function "${r}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=n,this.reason=c,this.signature=u}}class t2 extends j{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class n2 extends j{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class ip extends j{constructor({data:e,message:n}){super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class va extends j{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${kc(o)}`,e&&`Request body: ${An(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class Sz extends j{constructor({body:e,cause:n,details:r,url:s}){super("WebSocket request failed.",{cause:n,details:r,metaMessages:[`URL: ${kc(s)}`,e&&`Request body: ${An(e)}`].filter(Boolean),name:"WebSocketRequestError"})}}class op extends j{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${kc(r)}`,`Request body: ${An(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class Nz extends j{constructor({url:e}={}){super("The socket has been closed.",{metaMessages:[e&&`URL: ${kc(e)}`].filter(Boolean),name:"SocketClosedError"})}}class $g extends j{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${kc(n)}`,`Request body: ${An(e)}`],name:"TimeoutError"})}}const r2=-1;class pn extends j{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof op?e.code:n??r2}}class Tn extends pn{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class Fa extends pn{constructor(e){super(e,{code:Fa.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Fa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class ja extends pn{constructor(e){super(e,{code:ja.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(ja,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class za extends pn{constructor(e,{method:n}={}){super(e,{code:za.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(za,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class qa extends pn{constructor(e){super(e,{code:qa.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(qa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class wi extends pn{constructor(e){super(e,{code:wi.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(wi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Ha extends pn{constructor(e){super(e,{code:Ha.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Ha,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Wa extends pn{constructor(e){super(e,{code:Wa.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Wa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Ss extends pn{constructor(e){super(e,{code:Ss.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Ss,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Eo extends pn{constructor(e){super(e,{code:Eo.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Eo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class ti extends pn{constructor(e,{method:n}={}){super(e,{code:ti.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(ti,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Co extends pn{constructor(e){super(e,{code:Co.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Co,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Va extends pn{constructor(e){super(e,{code:Va.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Va,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class gt extends Tn{constructor(e){super(e,{code:gt.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(gt,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class Ga extends Tn{constructor(e){super(e,{code:Ga.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(Ga,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Ka extends Tn{constructor(e,{method:n}={}){super(e,{code:Ka.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Ka,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Ya extends Tn{constructor(e){super(e,{code:Ya.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Ya,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class Za extends Tn{constructor(e){super(e,{code:Za.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(Za,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Tr extends Tn{constructor(e){super(e,{code:Tr.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Tr,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Ja extends Tn{constructor(e){super(e,{code:Ja.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(Ja,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class Xa extends Tn{constructor(e){super(e,{code:Xa.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(Xa,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Qa extends Tn{constructor(e){super(e,{code:Qa.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Qa,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class ec extends Tn{constructor(e){super(e,{code:ec.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(ec,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class tc extends Tn{constructor(e){super(e,{code:tc.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(tc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class nc extends Tn{constructor(e){super(e,{code:nc.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(nc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class rc extends Tn{constructor(e){super(e,{code:rc.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(rc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class s2 extends pn{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const i2=3;function Zu(t,{abi:e,address:n,args:r,docsPath:s,functionName:i,sender:o}){const a=t instanceof ip?t:t instanceof j?t.walk(p=>"data"in p)||t.walk():{},{code:c,data:u,details:l,message:d,shortMessage:h}=a,f=t instanceof Tl?new t2({functionName:i}):[i2,wi.code].includes(c)&&(u||l||d||h)?new e2({abi:e,data:typeof u=="object"?u.data:u,functionName:i,message:a instanceof op?l:h??d}):t;return new db(f,{abi:e,args:r,contractAddress:n,docsPath:s,functionName:i,sender:o})}function o2(t){const e=Dc(`0x${t.substring(4)}`).substring(26);return Rl(`0x${e}`)}async function a2({hash:t,signature:e}){const n=$s(t)?t:mi(t),{secp256k1:r}=await Ht(async()=>{const{secp256k1:o}=await import("./BewbSyHt.js").then(a=>a.k);return{secp256k1:o}},__vite__mapDeps([0,1,2]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:d,yParity:h}=e,f=Number(h??d),p=kg(f);return new r.Signature(gi(u),gi(l)).addRecoveryBit(p)}const o=$s(e)?e:mi(e);if(yt(o)!==65)throw new Error("invalid signature length");const a=ks(`0x${o.slice(130)}`),c=kg(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function kg(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function c2({hash:t,signature:e}){return o2(await a2({hash:t,signature:e}))}function ap(t,e="hex"){const n=hb(t),r=rp(new Uint8Array(n.length));return n.encode(r),e==="hex"?Yt(r.bytes):r.bytes}function Tz(t,e="bytes"){return ap(t,e)}function xz(t,e="hex"){return ap(t,e)}function hb(t){return Array.isArray(t)?u2(t.map(e=>hb(e))):l2(t)}function u2(t){const e=t.reduce((s,i)=>s+i.length,0),n=fb(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),n===1?s.pushUint8(e):n===2?s.pushUint16(e):n===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function l2(t){const e=typeof t=="string"?sr(t):t,n=fb(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+n),n===1?s.pushUint8(e.length):n===2?s.pushUint16(e.length):n===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function fb(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new j("Length is too large.")}function d2(t){const{chainId:e,nonce:n,to:r}=t,s=t.contractAddress??t.address,i=Dc(Dl(["0x05",ap([e?Ae(e):"0x",s,n?Ae(n):"0x"])]));return r==="bytes"?sr(i):i}async function pb(t){const{authorization:e,signature:n}=t;return c2({hash:d2(e),signature:n??e})}class h2 extends j{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:u,nonce:l,to:d,value:h}){var p;const f=$c({from:n==null?void 0:n.address,to:d,value:typeof h<"u"&&`${sp(h)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${hn(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${hn(c)} gwei`,maxPriorityFeePerGas:typeof u<"u"&&`${hn(u)} gwei`,nonce:l});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",f].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class ni extends j{constructor({cause:e,message:n}={}){var s;const r=(s=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(ni,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(ni,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Ju extends j{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${hn(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(Ju,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Rh extends j{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${hn(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(Rh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class Dh extends j{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(Dh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class $h extends j{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty($h,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class kh extends j{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(kh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class Uh extends j{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(Uh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Mh extends j{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Mh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Lh extends j{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(Lh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class Bh extends j{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(Bh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class Xu extends j{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${hn(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${hn(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(Xu,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class Ul extends j{constructor({cause:e}){super(`An error occurred while executing: ${e==null?void 0:e.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function cp(t,e){const n=(t.details||"").toLowerCase(),r=t instanceof j?t.walk(s=>(s==null?void 0:s.code)===ni.code):t;return r instanceof j?new ni({cause:t,message:r.details}):ni.nodeMessage.test(n)?new ni({cause:t,message:t.details}):Ju.nodeMessage.test(n)?new Ju({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):Rh.nodeMessage.test(n)?new Rh({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):Dh.nodeMessage.test(n)?new Dh({cause:t,nonce:e==null?void 0:e.nonce}):$h.nodeMessage.test(n)?new $h({cause:t,nonce:e==null?void 0:e.nonce}):kh.nodeMessage.test(n)?new kh({cause:t,nonce:e==null?void 0:e.nonce}):Uh.nodeMessage.test(n)?new Uh({cause:t}):Mh.nodeMessage.test(n)?new Mh({cause:t,gas:e==null?void 0:e.gas}):Lh.nodeMessage.test(n)?new Lh({cause:t,gas:e==null?void 0:e.gas}):Bh.nodeMessage.test(n)?new Bh({cause:t}):Xu.nodeMessage.test(n)?new Xu({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas,maxPriorityFeePerGas:e==null?void 0:e.maxPriorityFeePerGas}):new Ul({cause:t})}function f2(t,{docsPath:e,...n}){const r=(()=>{const s=cp(t,n);return s instanceof Ul?t:s})();return new h2(r,{docsPath:e,...n})}function up(t,{format:e}){if(!e)return{};const n={};function r(i){const o=Object.keys(i);for(const a of o)a in t&&(n[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&r(i[a])}const s=e(t||{});return r(s),n}function Ml(t,e){return({exclude:n,format:r})=>({exclude:n,format:s=>{const i=e(s);if(n)for(const o of n)delete i[o];return{...i,...r(s)}},type:t})}const p2={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function Ll(t){const e={};return typeof t.authorizationList<"u"&&(e.authorizationList=g2(t.authorizationList)),typeof t.accessList<"u"&&(e.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(e.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?e.blobs=t.blobs.map(n=>Yt(n)):e.blobs=t.blobs),typeof t.data<"u"&&(e.data=t.data),typeof t.from<"u"&&(e.from=t.from),typeof t.gas<"u"&&(e.gas=Ae(t.gas)),typeof t.gasPrice<"u"&&(e.gasPrice=Ae(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(e.maxFeePerBlobGas=Ae(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(e.maxFeePerGas=Ae(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(e.maxPriorityFeePerGas=Ae(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(e.nonce=Ae(t.nonce)),typeof t.to<"u"&&(e.to=t.to),typeof t.type<"u"&&(e.type=p2[t.type]),typeof t.value<"u"&&(e.value=Ae(t.value)),e}const Pz=Ml("transactionRequest",Ll);function g2(t){return t.map(e=>({address:e.address,r:e.r?Ae(BigInt(e.r)):e.r,s:e.s?Ae(BigInt(e.s)):e.s,chainId:Ae(e.chainId),nonce:Ae(e.nonce),...typeof e.yParity<"u"?{yParity:Ae(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:Ae(e.v)}:{}}))}function Ug(t){if(!(!t||t.length===0))return t.reduce((e,{slot:n,value:r})=>{if(n.length!==66)throw new Sg({size:n.length,targetSize:66,type:"hex"});if(r.length!==66)throw new Sg({size:r.length,targetSize:66,type:"hex"});return e[n]=r,e},{})}function m2(t){const{balance:e,nonce:n,state:r,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=Ae(e)),n!==void 0&&(o.nonce=Ae(n)),r!==void 0&&(o.state=Ug(r)),s!==void 0){if(o.state)throw new VI;o.stateDiff=Ug(s)}return o}function gb(t){if(!t)return;const e={};for(const{address:n,...r}of t){if(!Nr(n,{strict:!1}))throw new yi({address:n});if(e[n])throw new WI({address:n});e[n]=m2(r)}return e}const Oz=2n**(8n-1n)-1n,Rz=2n**(16n-1n)-1n,Dz=2n**(24n-1n)-1n,$z=2n**(32n-1n)-1n,kz=2n**(40n-1n)-1n,Uz=2n**(48n-1n)-1n,Mz=2n**(56n-1n)-1n,Lz=2n**(64n-1n)-1n,Bz=2n**(72n-1n)-1n,Fz=2n**(80n-1n)-1n,jz=2n**(88n-1n)-1n,zz=2n**(96n-1n)-1n,qz=2n**(104n-1n)-1n,Hz=2n**(112n-1n)-1n,Wz=2n**(120n-1n)-1n,Vz=2n**(128n-1n)-1n,Gz=2n**(136n-1n)-1n,Kz=2n**(144n-1n)-1n,Yz=2n**(152n-1n)-1n,Zz=2n**(160n-1n)-1n,Jz=2n**(168n-1n)-1n,Xz=2n**(176n-1n)-1n,Qz=2n**(184n-1n)-1n,eq=2n**(192n-1n)-1n,tq=2n**(200n-1n)-1n,nq=2n**(208n-1n)-1n,rq=2n**(216n-1n)-1n,sq=2n**(224n-1n)-1n,iq=2n**(232n-1n)-1n,oq=2n**(240n-1n)-1n,aq=2n**(248n-1n)-1n,cq=2n**(256n-1n)-1n,uq=-(2n**(8n-1n)),lq=-(2n**(16n-1n)),dq=-(2n**(24n-1n)),hq=-(2n**(32n-1n)),fq=-(2n**(40n-1n)),pq=-(2n**(48n-1n)),gq=-(2n**(56n-1n)),mq=-(2n**(64n-1n)),yq=-(2n**(72n-1n)),wq=-(2n**(80n-1n)),bq=-(2n**(88n-1n)),vq=-(2n**(96n-1n)),Eq=-(2n**(104n-1n)),Cq=-(2n**(112n-1n)),_q=-(2n**(120n-1n)),Aq=-(2n**(128n-1n)),Iq=-(2n**(136n-1n)),Sq=-(2n**(144n-1n)),Nq=-(2n**(152n-1n)),Tq=-(2n**(160n-1n)),xq=-(2n**(168n-1n)),Pq=-(2n**(176n-1n)),Oq=-(2n**(184n-1n)),Rq=-(2n**(192n-1n)),Dq=-(2n**(200n-1n)),$q=-(2n**(208n-1n)),kq=-(2n**(216n-1n)),Uq=-(2n**(224n-1n)),Mq=-(2n**(232n-1n)),Lq=-(2n**(240n-1n)),Bq=-(2n**(248n-1n)),Fq=-(2n**(256n-1n)),jq=2n**8n-1n,zq=2n**16n-1n,qq=2n**24n-1n,Hq=2n**32n-1n,Wq=2n**40n-1n,Vq=2n**48n-1n,Gq=2n**56n-1n,Kq=2n**64n-1n,Yq=2n**72n-1n,Zq=2n**80n-1n,Jq=2n**88n-1n,Xq=2n**96n-1n,Qq=2n**104n-1n,eH=2n**112n-1n,tH=2n**120n-1n,nH=2n**128n-1n,rH=2n**136n-1n,sH=2n**144n-1n,iH=2n**152n-1n,oH=2n**160n-1n,aH=2n**168n-1n,cH=2n**176n-1n,uH=2n**184n-1n,lH=2n**192n-1n,dH=2n**200n-1n,hH=2n**208n-1n,fH=2n**216n-1n,pH=2n**224n-1n,gH=2n**232n-1n,mH=2n**240n-1n,yH=2n**248n-1n,y2=2n**256n-1n;function Bl(t){const{account:e,gasPrice:n,maxFeePerGas:r,maxPriorityFeePerGas:s,to:i}=t,o=e?Rr(e):void 0;if(o&&!Nr(o.address))throw new yi({address:o.address});if(i&&!Nr(i))throw new yi({address:i});if(typeof n<"u"&&(typeof r<"u"||typeof s<"u"))throw new KI;if(r&&r>y2)throw new Ju({maxFeePerGas:r});if(s&&r&&s>r)throw new Xu({maxFeePerGas:r,maxPriorityFeePerGas:s})}class w2 extends j{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class lp extends j{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class b2 extends j{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${hn(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class mb extends j{constructor({blockHash:e,blockNumber:n}){let r="Block";e&&(r=`Block at hash "${e}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`,{name:"BlockNotFoundError"})}}const yb={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function dp(t){const e={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?ks(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?ks(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?yb[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(e.authorizationList=v2(t.authorizationList)),e.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof e.v=="bigint"){if(e.v===0n||e.v===27n)return 0;if(e.v===1n||e.v===28n)return 1;if(e.v>=35n)return e.v%2n===0n?1:0}})(),e.type==="legacy"&&(delete e.accessList,delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas,delete e.yParity),e.type==="eip2930"&&(delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas),e.type==="eip1559"&&delete e.maxFeePerBlobGas,e}const wH=Ml("transaction",dp);function v2(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function wb(t){const e=(t.transactions??[]).map(n=>typeof n=="string"?n:dp(n));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:e,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}const bH=Ml("block",wb);async function sc(t,{blockHash:e,blockNumber:n,blockTag:r,includeTransactions:s}={}){var l,d,h;const i=r??"latest",o=s??!1,a=n!==void 0?Ae(n):void 0;let c=null;if(e?c=await t.request({method:"eth_getBlockByHash",params:[e,o]},{dedupe:!0}):c=await t.request({method:"eth_getBlockByNumber",params:[a||i,o]},{dedupe:!!a}),!c)throw new mb({blockHash:e,blockNumber:n});return(((h=(d=(l=t.chain)==null?void 0:l.formatters)==null?void 0:d.block)==null?void 0:h.format)||wb)(c)}async function bb(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function vH(t,e){return vb(t,e)}async function vb(t,e){var i,o;const{block:n,chain:r=t.chain,request:s}=e||{};try{const a=((i=r==null?void 0:r.fees)==null?void 0:i.maxPriorityFeePerGas)??((o=r==null?void 0:r.fees)==null?void 0:o.defaultPriorityFee);if(typeof a=="function"){const u=n||await st(t,sc,"getBlock")({}),l=await a({block:u,client:t,request:s});if(l===null)throw new Error;return l}if(typeof a<"u")return a;const c=await t.request({method:"eth_maxPriorityFeePerGas"});return gi(c)}catch{const[a,c]=await Promise.all([n?Promise.resolve(n):st(t,sc,"getBlock")({}),st(t,bb,"getGasPrice")({})]);if(typeof a.baseFeePerGas!="bigint")throw new lp;const u=c-a.baseFeePerGas;return u<0n?0n:u}}async function EH(t,e){return Fh(t,e)}async function Fh(t,e){var h,f;const{block:n,chain:r=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>{var p,g;return typeof((p=r==null?void 0:r.fees)==null?void 0:p.baseFeeMultiplier)=="function"?r.fees.baseFeeMultiplier({block:n,client:t,request:s}):((g=r==null?void 0:r.fees)==null?void 0:g.baseFeeMultiplier)??1.2})();if(o<1)throw new w2;const c=10**(((h=o.toString().split(".")[1])==null?void 0:h.length)??0),u=p=>p*BigInt(Math.ceil(o*c))/BigInt(c),l=n||await st(t,sc,"getBlock")({});if(typeof((f=r==null?void 0:r.fees)==null?void 0:f.estimateFeesPerGas)=="function"){const p=await r.fees.estimateFeesPerGas({block:n,client:t,multiply:u,request:s,type:i});if(p!==null)return p}if(i==="eip1559"){if(typeof l.baseFeePerGas!="bigint")throw new lp;const p=typeof(s==null?void 0:s.maxPriorityFeePerGas)=="bigint"?s.maxPriorityFeePerGas:await vb(t,{block:l,chain:r,request:s}),g=u(l.baseFeePerGas);return{maxFeePerGas:(s==null?void 0:s.maxFeePerGas)??g+p,maxPriorityFeePerGas:p}}return{gasPrice:(s==null?void 0:s.gasPrice)??u(await st(t,bb,"getGasPrice")({}))}}async function E2(t,{address:e,blockTag:n="latest",blockNumber:r}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof r=="bigint"?Ae(r):n]},{dedupe:!!r});return ks(s)}function Eb(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(i=>sr(i)):t.blobs,s=[];for(const i of r)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return n==="bytes"?s:s.map(i=>Yt(i))}function Cb(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(o=>sr(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>sr(o)):t.commitments,i=[];for(let o=0;o<r.length;o++){const a=r[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return n==="bytes"?i:i.map(o=>Yt(o))}function C2(t,e){const n=e||"hex",r=jC($s(t,{strict:!1})?Pl(t):t);return n==="bytes"?r:mi(r)}function _2(t){const{commitment:e,version:n=1}=t,r=t.to??(typeof e=="string"?"hex":"bytes"),s=C2(e,"bytes");return s.set([n],0),r==="bytes"?s:Yt(s)}function A2(t){const{commitments:e,version:n}=t,r=t.to??(typeof e[0]=="string"?"hex":"bytes"),s=[];for(const i of e)s.push(_2({commitment:i,to:r,version:n}));return s}const Mg=6,_b=32,hp=4096,Ab=_b*hp,Lg=Ab*Mg-1-1*hp*Mg,I2=1;class S2 extends j{constructor({maxSize:e,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class N2 extends j{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}class CH extends j{constructor({hash:e,size:n}){super(`Versioned hash "${e}" size is invalid.`,{metaMessages:["Expected: 32",`Received: ${n}`],name:"InvalidVersionedHashSizeError"})}}class _H extends j{constructor({hash:e,version:n}){super(`Versioned hash "${e}" version is invalid.`,{metaMessages:[`Expected: ${I2}`,`Received: ${n}`],name:"InvalidVersionedHashVersionError"})}}function T2(t){const e=t.to??(typeof t.data=="string"?"hex":"bytes"),n=typeof t.data=="string"?sr(t.data):t.data,r=yt(n);if(!r)throw new N2;if(r>Lg)throw new S2({maxSize:Lg,size:r});const s=[];let i=!0,o=0;for(;i;){const a=rp(new Uint8Array(Ab));let c=0;for(;c<hp;){const u=n.slice(o,o+(_b-1));if(a.pushByte(0),a.pushBytes(u),u.length<31){a.pushByte(128),i=!1;break}c++,o+=31}s.push(a)}return e==="bytes"?s.map(a=>a.bytes):s.map(a=>Yt(a.bytes))}function x2(t){const{data:e,kzg:n,to:r}=t,s=t.blobs??T2({data:e,to:r}),i=t.commitments??Eb({blobs:s,kzg:n,to:r}),o=t.proofs??Cb({blobs:s,commitments:i,kzg:n,to:r}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function P2(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new YI({transaction:t})}async function Ib(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return ks(e)}const Sb=["blobVersionedHashes","chainId","fees","gas","nonce","type"],Bg=new Map;async function fp(t,e){const{account:n=t.account,blobs:r,chain:s,gas:i,kzg:o,nonce:a,nonceManager:c,parameters:u=Sb,type:l}=e,d=n&&Rr(n),h={...e,...d?{from:d==null?void 0:d.address}:{}};let f;async function p(){return f||(f=await st(t,sc,"getBlock")({blockTag:"latest"}),f)}let g;async function m(){return g||(s?s.id:typeof e.chainId<"u"?e.chainId:(g=await st(t,Ib,"getChainId")({}),g))}if(u.includes("nonce")&&typeof a>"u"&&d)if(c){const v=await m();h.nonce=await c.consume({address:d.address,chainId:v,client:t})}else h.nonce=await st(t,E2,"getTransactionCount")({address:d.address,blockTag:"pending"});if((u.includes("blobVersionedHashes")||u.includes("sidecars"))&&r&&o){const v=Eb({blobs:r,kzg:o});if(u.includes("blobVersionedHashes")){const w=A2({commitments:v,to:"hex"});h.blobVersionedHashes=w}if(u.includes("sidecars")){const w=Cb({blobs:r,commitments:v,kzg:o}),b=x2({blobs:r,commitments:v,proofs:w,to:"hex"});h.sidecars=b}}if(u.includes("chainId")&&(h.chainId=await m()),(u.includes("fees")||u.includes("type"))&&typeof l>"u")try{h.type=P2(h)}catch{let v=Bg.get(t.uid);if(typeof v>"u"){const w=await p();v=typeof(w==null?void 0:w.baseFeePerGas)=="bigint",Bg.set(t.uid,v)}h.type=v?"eip1559":"legacy"}if(u.includes("fees"))if(h.type!=="legacy"&&h.type!=="eip2930"){if(typeof h.maxFeePerGas>"u"||typeof h.maxPriorityFeePerGas>"u"){const v=await p(),{maxFeePerGas:w,maxPriorityFeePerGas:b}=await Fh(t,{block:v,chain:s,request:h});if(typeof e.maxPriorityFeePerGas>"u"&&e.maxFeePerGas&&e.maxFeePerGas<b)throw new b2({maxPriorityFeePerGas:b});h.maxPriorityFeePerGas=b,h.maxFeePerGas=w}}else{if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")throw new lp;if(typeof e.gasPrice>"u"){const v=await p(),{gasPrice:w}=await Fh(t,{block:v,chain:s,request:h,type:"legacy"});h.gasPrice=w}}return u.includes("gas")&&typeof i>"u"&&(h.gas=await st(t,Tb,"estimateGas")({...h,account:d&&{address:d.address,type:"json-rpc"}})),Bl(h),delete h.parameters,h}async function Nb(t,{address:e,blockNumber:n,blockTag:r="latest"}){const s=typeof n=="bigint"?Ae(n):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||r]});return BigInt(i)}async function Tb(t,e){var s,i,o;const{account:n=t.account}=e,r=n?Rr(n):void 0;try{let B=function(I){const{block:x,request:R,rpcStateOverride:O}=I;return t.request({method:"eth_estimateGas",params:O?[R,x??"latest",O]:x?[R,x]:[R]})};const{accessList:a,authorizationList:c,blobs:u,blobVersionedHashes:l,blockNumber:d,blockTag:h,data:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:w,nonce:b,value:S,stateOverride:_,...T}=await fp(t,{...e,parameters:(r==null?void 0:r.type)==="local"?void 0:["blobVersionedHashes"]}),D=(typeof d=="bigint"?Ae(d):void 0)||h,A=gb(_),U=await(async()=>{if(T.to)return T.to;if(c&&c.length>0)return await pb({authorization:c[0]}).catch(()=>{throw new j("`to` is required. Could not infer from `authorizationList`")})})();Bl(e);const P=(o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionRequest)==null?void 0:o.format,L=(P||Ll)({...up(T,{format:P}),from:r==null?void 0:r.address,accessList:a,authorizationList:c,blobs:u,blobVersionedHashes:l,data:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:w,nonce:b,to:U,value:S});let C=BigInt(await B({block:D,request:L,rpcStateOverride:A}));if(c){const I=await Nb(t,{address:L.from}),x=await Promise.all(c.map(async R=>{const{address:O}=R,M=await B({block:D,request:{authorizationList:void 0,data:f,from:r==null?void 0:r.address,to:O,value:Ae(I)},rpcStateOverride:A}).catch(()=>100000n);return 2n*BigInt(M)}));C+=x.reduce((R,O)=>R+O,0n)}return C}catch(a){throw f2(a,{...e,account:r,chain:t.chain})}}function O2(t,e){if(!Nr(t,{strict:!1}))throw new yi({address:t});if(!Nr(e,{strict:!1}))throw new yi({address:e});return t.toLowerCase()===e.toLowerCase()}const Fg="/docs/contract/decodeEventLog";function R2(t){const{abi:e,data:n,strict:r,topics:s}=t,i=r??!0,[o,...a]=s;if(!o)throw new BA({docsPath:Fg});const c=e.find(g=>g.type==="event"&&o===Jf(Ds(g)));if(!(c&&"name"in c)||c.type!=="event")throw new F0(o,{docsPath:Fg});const{name:u,inputs:l}=c,d=l==null?void 0:l.some(g=>!("name"in g&&g.name)),h=d?[]:{},f=l.map((g,m)=>[g,m]).filter(([g])=>"indexed"in g&&g.indexed);for(let g=0;g<f.length;g++){const[m,v]=f[g],w=a[g];if(!w)throw new j0({abiItem:c,param:m});h[d?v:m.name||v]=D2({param:m,value:w})}const p=l.filter(g=>!("indexed"in g&&g.indexed));if(p.length>0){if(n&&n!=="0x")try{const g=kl(p,n);if(g)if(d)for(let m=0;m<l.length;m++)h[m]=h[m]??g.shift();else for(let m=0;m<p.length;m++)h[p[m].name]=g[m]}catch(g){if(i)throw g instanceof L0||g instanceof sb?new xh({abiItem:c,data:n,params:p,size:yt(n)}):g}else if(i)throw new xh({abiItem:c,data:"0x",params:p,size:0})}return{eventName:u,args:Object.values(h).length>0?h:void 0}}function D2({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(kl([t],e)||[])[0]}function $2(t){const{abi:e,args:n,logs:r,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return r.map(o=>{var a;try{const c=e.find(l=>l.type==="event"&&o.topics[0]===Jf(l));if(!c)return null;const u=R2({...o,abi:[c],strict:s});return i&&!i.includes(u.eventName)||!k2({args:u.args,inputs:c.inputs,matchArgs:n})?null:{...u,...o}}catch(c){let u,l;if(c instanceof F0)return null;if(c instanceof xh||c instanceof j0){if(s)return null;u=c.abiItem.name,l=(a=c.abiItem.inputs)==null?void 0:a.some(d=>!("name"in d&&d.name))}return{...o,args:l?[]:{},eventName:u}}}).filter(Boolean)}function k2(t){const{args:e,inputs:n,matchArgs:r}=t;if(!r)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?O2(o,a):i.type==="string"||i.type==="bytes"?Dc(Pl(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(r)?r.every((i,o)=>{if(i==null)return!0;const a=n[o];return a?(Array.isArray(i)?i:[i]).some(u=>s(a,u,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).every(([i,o])=>{if(o==null)return!0;const a=n.find(u=>u.name===i);return a?(Array.isArray(o)?o:[o]).some(u=>s(a,u,e[i])):!1}):!1}function xb(t,{args:e,eventName:n}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...n?{args:e,eventName:n}:{}}}const vd="/docs/contract/decodeFunctionResult";function pp(t){const{abi:e,args:n,functionName:r,data:s}=t;let i=e[0];if(r){const a=np({abi:e,args:n,name:r});if(!a)throw new Ku(r,{docsPath:vd});i=a}if(i.type!=="function")throw new Ku(void 0,{docsPath:vd});if(!i.outputs)throw new FA(i.name,{docsPath:vd});const o=kl(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const U2="0.1.1";function M2(){return U2}let Do=class jh extends Error{constructor(e,n={}){const r=(()=>{var c;if(n.cause instanceof jh){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof jh&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${M2()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return Pb(this,e)}};function Pb(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?Pb(t.cause,e):e?null:t}const L2="#__bigint";function B2(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+L2:s,n)}function Ob(t,e){if(_o(t)>e)throw new K2({givenSize:_o(t),maxSize:e})}function F2(t,e){if(typeof e=="number"&&e>0&&e>_o(t)-1)throw new $b({offset:e,position:"start",size:_o(t)})}function j2(t,e,n){if(typeof e=="number"&&typeof n=="number"&&_o(t)!==n-e)throw new $b({offset:n,position:"end",size:_o(t)})}function Rb(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new Y2({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const z2=new TextEncoder,q2=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function H2(t,e={}){const{strict:n=!1}=e;if(!t)throw new jg(t);if(typeof t!="string")throw new jg(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new zg(t);if(!t.startsWith("0x"))throw new zg(t)}function AH(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function IH(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Ob(n,e.size),Db(n,e.size)):n}function W2(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=q2[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Ob(r,e.size),V2(r,e.size)):r}function Wr(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const u=typeof t=="bigint"?"n":"";throw new G2({max:i?`${i}${u}`:void 0,min:`${o}${u}`,signed:n,size:r,value:`${t}${u}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Db(c,r):c}function SH(t,e={}){return W2(z2.encode(t),e)}function Db(t,e){return Rb(t,{dir:"left",size:e})}function V2(t,e){return Rb(t,{dir:"right",size:e})}function NH(t,e,n,r={}){const{strict:s}=r;F2(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&j2(i,e,n),i}function _o(t){return Math.ceil((t.length-2)/2)}function TH(t,e={}){const{strict:n=!1}=e;try{return H2(t,{strict:n}),!0}catch{return!1}}let G2=class extends Do{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}};class jg extends Do{constructor(e){super(`Value \`${typeof e=="object"?B2(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class zg extends Do{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let K2=class extends Do{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class $b extends Do{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let Y2=class extends Do{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};function Z2(t){return{address:t.address,amount:Wr(t.amount),index:Wr(t.index),validatorIndex:Wr(t.validatorIndex)}}function J2(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:Wr(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:Wr(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:Wr(t.gasLimit)},...typeof t.number=="bigint"&&{number:Wr(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:Wr(t.prevRandao)},...typeof t.time=="bigint"&&{time:Wr(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(Z2)}}}const zh=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],RH=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],kb=[{inputs:[],name:"ResolverNotFound",type:"error"},{inputs:[],name:"ResolverWildcardNotSupported",type:"error"},{inputs:[],name:"ResolverNotContract",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{components:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"errors",type:"tuple[]"}],name:"HttpError",type:"error"}],DH=[...kb,{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]},{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],$H=[...kb,{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]},{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]}],kH=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],UH=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],MH=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],LH=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],BH=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"bytes32"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"bytes32"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],FH=[{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"balance",type:"uint256"},{internalType:"uint256",name:"needed",type:"uint256"},{internalType:"uint256",name:"tokenId",type:"uint256"}],name:"ERC1155InsufficientBalance",type:"error"},{inputs:[{internalType:"address",name:"approver",type:"address"}],name:"ERC1155InvalidApprover",type:"error"},{inputs:[{internalType:"uint256",name:"idsLength",type:"uint256"},{internalType:"uint256",name:"valuesLength",type:"uint256"}],name:"ERC1155InvalidArrayLength",type:"error"},{inputs:[{internalType:"address",name:"operator",type:"address"}],name:"ERC1155InvalidOperator",type:"error"},{inputs:[{internalType:"address",name:"receiver",type:"address"}],name:"ERC1155InvalidReceiver",type:"error"},{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"ERC1155InvalidSender",type:"error"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"address",name:"owner",type:"address"}],name:"ERC1155MissingApprovalForAll",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!1,internalType:"bool",name:"approved",type:"bool"}],name:"ApprovalForAll",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256[]",name:"ids",type:"uint256[]"},{indexed:!1,internalType:"uint256[]",name:"values",type:"uint256[]"}],name:"TransferBatch",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"operator",type:"address"},{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"id",type:"uint256"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"TransferSingle",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"value",type:"string"},{indexed:!0,internalType:"uint256",name:"id",type:"uint256"}],name:"URI",type:"event"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"uint256",name:"id",type:"uint256"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address[]",name:"accounts",type:"address[]"},{internalType:"uint256[]",name:"ids",type:"uint256[]"}],name:"balanceOfBatch",outputs:[{internalType:"uint256[]",name:"",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"account",type:"address"},{internalType:"address",name:"operator",type:"address"}],name:"isApprovedForAll",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256[]",name:"ids",type:"uint256[]"},{internalType:"uint256[]",name:"values",type:"uint256[]"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeBatchTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"from",type:"address"},{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],name:"safeTransferFrom",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"operator",type:"address"},{internalType:"bool",name:"approved",type:"bool"}],name:"setApprovalForAll",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"uri",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"}],jH=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!0,name:"tokenId",type:"uint256"}]},{type:"event",name:"ApprovalForAll",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"operator",type:"address"},{indexed:!1,name:"approved",type:"bool"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!0,name:"tokenId",type:"uint256"}]},{type:"function",name:"approve",stateMutability:"payable",inputs:[{name:"spender",type:"address"},{name:"tokenId",type:"uint256"}],outputs:[]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"getApproved",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{type:"address"}]},{type:"function",name:"isApprovedForAll",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"operator",type:"address"}],outputs:[{type:"bool"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"ownerOf",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{name:"owner",type:"address"}]},{type:"function",name:"safeTransferFrom",stateMutability:"payable",inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"tokenId",type:"uint256"}],outputs:[]},{type:"function",name:"safeTransferFrom",stateMutability:"nonpayable",inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"id",type:"uint256"},{name:"data",type:"bytes"}],outputs:[]},{type:"function",name:"setApprovalForAll",stateMutability:"nonpayable",inputs:[{name:"operator",type:"address"},{name:"approved",type:"bool"}],outputs:[]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"tokenByIndex",stateMutability:"view",inputs:[{name:"index",type:"uint256"}],outputs:[{type:"uint256"}]},{type:"function",name:"tokenByIndex",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"index",type:"uint256"}],outputs:[{name:"tokenId",type:"uint256"}]},{type:"function",name:"tokenURI",stateMutability:"view",inputs:[{name:"tokenId",type:"uint256"}],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transferFrom",stateMutability:"payable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"tokenId",type:"uint256"}],outputs:[]}],zH=[{anonymous:!1,inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"receiver",type:"address"},{indexed:!1,name:"assets",type:"uint256"},{indexed:!1,name:"shares",type:"uint256"}],name:"Deposit",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"receiver",type:"address"},{indexed:!0,name:"owner",type:"address"},{indexed:!1,name:"assets",type:"uint256"},{indexed:!1,name:"shares",type:"uint256"}],name:"Withdraw",type:"event"},{inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],name:"allowance",outputs:[{type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],name:"approve",outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"asset",outputs:[{name:"assetTokenAddress",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"shares",type:"uint256"}],name:"convertToAssets",outputs:[{name:"assets",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"assets",type:"uint256"}],name:"convertToShares",outputs:[{name:"shares",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"assets",type:"uint256"},{name:"receiver",type:"address"}],name:"deposit",outputs:[{name:"shares",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"caller",type:"address"}],name:"maxDeposit",outputs:[{name:"maxAssets",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"caller",type:"address"}],name:"maxMint",outputs:[{name:"maxShares",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"owner",type:"address"}],name:"maxRedeem",outputs:[{name:"maxShares",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"owner",type:"address"}],name:"maxWithdraw",outputs:[{name:"maxAssets",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"shares",type:"uint256"},{name:"receiver",type:"address"}],name:"mint",outputs:[{name:"assets",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"assets",type:"uint256"}],name:"previewDeposit",outputs:[{name:"shares",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"shares",type:"uint256"}],name:"previewMint",outputs:[{name:"assets",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"shares",type:"uint256"}],name:"previewRedeem",outputs:[{name:"assets",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"assets",type:"uint256"}],name:"previewWithdraw",outputs:[{name:"shares",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"shares",type:"uint256"},{name:"receiver",type:"address"},{name:"owner",type:"address"}],name:"redeem",outputs:[{name:"assets",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"totalAssets",outputs:[{name:"totalManagedAssets",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"to",type:"address"},{name:"amount",type:"uint256"}],name:"transfer",outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"from",type:"address"},{name:"to",type:"address"},{name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"assets",type:"uint256"},{name:"receiver",type:"address"},{name:"owner",type:"address"}],name:"withdraw",outputs:[{name:"shares",type:"uint256"}],stateMutability:"nonpayable",type:"function"}],X2="0x82ad56cb",Q2="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",eS="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",qH="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572";class qh extends j{constructor({blockNumber:e,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class tS extends j{constructor({chain:e,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${e.id}  ${e.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e.id}  ${e.name}`],name:"ChainMismatchError"})}}class nS extends j{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class Ub extends j{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}class HH extends j{constructor({chainId:e}){super(typeof e=="number"?`Chain ID "${e}" is invalid.`:"Chain ID is invalid.",{name:"InvalidChainIdError"})}}const Ed="/docs/contract/encodeDeployData";function Mb(t){const{abi:e,args:n,bytecode:r}=t;if(!n||n.length===0)return r;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new kA({docsPath:Ed});if(!("inputs"in s))throw new Ig({docsPath:Ed});if(!s.inputs||s.inputs.length===0)throw new Ig({docsPath:Ed});const i=nb(s.inputs,n);return Dl([r,i])}function Lb({blockNumber:t,chain:e,contract:n}){var s;const r=(s=e==null?void 0:e.contracts)==null?void 0:s[n];if(!r)throw new qh({chain:e,contract:{name:n}});if(t&&r.blockCreated&&r.blockCreated>t)throw new qh({blockNumber:t,chain:e,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function rS(t,{docsPath:e,...n}){const r=(()=>{const s=cp(t,n);return s instanceof Ul?t:s})();return new QI(r,{docsPath:e,...n})}function Bb(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const Cd=new Map;function Fb({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const l=c();o();const d=l.map(({args:h})=>h);d.length!==0&&t(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let f=0;f<l.length;f++){const{resolve:p}=l[f];p==null||p([h[f],h])}}).catch(h=>{for(let f=0;f<l.length;f++){const{reject:p}=l[f];p==null||p(h)}})},o=()=>Cd.delete(e),a=()=>c().map(({args:l})=>l),c=()=>Cd.get(e)||[],u=l=>Cd.set(e,[...c(),l]);return{flush:o,async schedule(l){const{promise:d,resolve:h,reject:f}=Bb();return(n==null?void 0:n([...a(),l]))&&i(),c().length>0?(u({args:l,resolve:h,reject:f}),d):(u({args:l,resolve:h,reject:f}),setTimeout(i,r),d)}}}async function jb(t,e){var L,B,C,I;const{account:n=t.account,authorizationList:r,batch:s=!!((L=t.batch)!=null&&L.multicall),blockNumber:i,blockTag:o="latest",accessList:a,blobs:c,blockOverrides:u,code:l,data:d,factory:h,factoryData:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:w,nonce:b,to:S,value:_,stateOverride:T,...N}=e,D=n?Rr(n):void 0;if(l&&(h||f))throw new j("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(l&&S)throw new j("Cannot provide both `code` & `to` as parameters.");const A=l&&d,U=h&&f&&S&&d,P=A||U,k=A?oS({code:l,data:d}):U?aS({data:d,factory:h,factoryData:f,to:S}):d;try{Bl(e);const R=(typeof i=="bigint"?Ae(i):void 0)||o,O=u?J2(u):void 0,M=gb(T),z=(I=(C=(B=t.chain)==null?void 0:B.formatters)==null?void 0:C.transactionRequest)==null?void 0:I.format,ee=(z||Ll)({...up(N,{format:z}),from:D==null?void 0:D.address,accessList:a,authorizationList:r,blobs:c,data:k,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:w,nonce:b,to:P?void 0:S,value:_});if(s&&sS({request:ee})&&!M&&!O)try{return await iS(t,{...ee,blockNumber:i,blockTag:o})}catch(fe){if(!(fe instanceof Ub)&&!(fe instanceof qh))throw fe}const Z=(()=>{const fe=[ee,R];return M&&O?[...fe,M,O]:M?[...fe,M]:O?[...fe,{},O]:fe})(),ae=await t.request({method:"eth_call",params:Z});return ae==="0x"?{data:void 0}:{data:ae}}catch(x){const R=cS(x),{offchainLookup:O,offchainLookupSignature:M}=await Ht(async()=>{const{offchainLookup:z,offchainLookupSignature:Y}=await import("./MNLnUxoq.js");return{offchainLookup:z,offchainLookupSignature:Y}},__vite__mapDeps([3,4]),import.meta.url);if(t.ccipRead!==!1&&(R==null?void 0:R.slice(0,10))===M&&S)return{data:await O(t,{data:R,to:S})};throw P&&(R==null?void 0:R.slice(0,10))==="0x101bb98d"?new n2({factory:h}):rS(x,{...e,account:D,chain:t.chain})}}function sS({request:t}){const{data:e,to:n,...r}=t;return!(!e||e.startsWith(X2)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function iS(t,e){var g;const{batchSize:n=1024,wait:r=0}=typeof((g=t.batch)==null?void 0:g.multicall)=="object"?t.batch.multicall:{},{blockNumber:s,blockTag:i="latest",data:o,multicallAddress:a,to:c}=e;let u=a;if(!u){if(!t.chain)throw new Ub;u=Lb({blockNumber:s,chain:t.chain,contract:"multicall3"})}const d=(typeof s=="bigint"?Ae(s):void 0)||i,{schedule:h}=Fb({id:`${t.uid}.${d}`,wait:r,shouldSplitBatch(m){return m.reduce((w,{data:b})=>w+(b.length-2),0)>n*2},fn:async m=>{const v=m.map(S=>({allowFailure:!0,callData:S.data,target:S.to})),w=$l({abi:zh,args:[v],functionName:"aggregate3"}),b=await t.request({method:"eth_call",params:[{data:w,to:u},d]});return pp({abi:zh,args:[v],functionName:"aggregate3",data:b||"0x"})}}),[{returnData:f,success:p}]=await h({data:o,to:c});if(!p)throw new ip({data:f});return f==="0x"?{data:void 0}:{data:f}}function oS(t){const{code:e,data:n}=t;return Mb({abi:k0(["constructor(bytes, bytes)"]),bytecode:Q2,args:[e,n]})}function aS(t){const{data:e,factory:n,factoryData:r,to:s}=t;return Mb({abi:k0(["constructor(address, bytes, address, bytes)"]),bytecode:eS,args:[s,e,n,r]})}function cS(t){var n;if(!(t instanceof j))return;const e=t.walk();return typeof(e==null?void 0:e.data)=="object"?(n=e.data)==null?void 0:n.data:e.data}async function zb(t,e){const{abi:n,address:r,args:s,functionName:i,...o}=e,a=$l({abi:n,args:s,functionName:i});try{const{data:c}=await st(t,jb,"call")({...o,data:a,to:r});return pp({abi:n,args:s,functionName:i,data:c||"0x"})}catch(c){throw Zu(c,{abi:n,address:r,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}const _d=new Map,qg=new Map;let uS=0;function Qu(t,e,n){const r=++uS,s=()=>_d.get(t)||[],i=()=>{const l=s();_d.set(t,l.filter(d=>d.id!==r))},o=()=>{const l=s();if(!l.some(h=>h.id===r))return;const d=qg.get(t);if(l.length===1&&d){const h=d();h instanceof Promise&&h.catch(()=>{})}i()},a=s();if(_d.set(t,[...a,{id:r,fns:e}]),a&&a.length>0)return o;const c={};for(const l in e)c[l]=(...d)=>{var f,p;const h=s();if(h.length!==0)for(const g of h)(p=(f=g.fns)[l])==null||p.call(f,...d)};const u=n(c);return typeof u=="function"&&qg.set(t,u),o}async function el(t){return new Promise(e=>setTimeout(e,t))}function qb(t,{emitOnBegin:e,initialWaitTime:n,interval:r}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await(n==null?void 0:n(a))??r;await el(c);const u=async()=>{s&&(await t({unpoll:i}),await el(r),u())};u()})(),i}const lS=new Map,dS=new Map;function hS(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),n=e(t,lS),r=e(t,dS);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function fS(t,{cacheKey:e,cacheTime:n=Number.POSITIVE_INFINITY}){const r=hS(e),s=r.response.get();if(s&&n>0&&new Date().getTime()-s.created.getTime()<n)return s.data;let i=r.promise.get();i||(i=t(),r.promise.set(i));try{const o=await i;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const pS=t=>`blockNumber.${t}`;async function gS(t,{cacheTime:e=t.cacheTime}={}){const n=await fS(()=>t.request({method:"eth_blockNumber"}),{cacheKey:pS(t.uid),cacheTime:e});return BigInt(n)}async function mS(t,{filter:e}){const n="strict"in e&&e.strict,r=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof r[0]=="string")return r;const s=r.map(i=>xb(i));return!("abi"in e)||!e.abi?s:$2({abi:e.abi,logs:s,strict:n})}async function yS(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}class gp extends j{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class Ad extends j{constructor({docsPath:e,metaMessages:n,type:r}){super(`Account type "${r}" is not supported.`,{docsPath:e,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function wS({chain:t,currentChainId:e}){if(!t)throw new nS;if(e!==t.id)throw new tS({chain:t,currentChainId:e})}function bS(t,{docsPath:e,...n}){const r=(()=>{const s=cp(t,n);return s instanceof Ul?t:s})();return new ZI(r,{docsPath:e,...n})}async function vS(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const Id=new Ol(128);async function Hb(t,e){var w,b,S,_;const{account:n=t.account,chain:r=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,type:p,value:g,...m}=e;if(typeof n>"u")throw new gp({docsPath:"/docs/actions/wallet/sendTransaction"});const v=n?Rr(n):null;try{Bl(e);const T=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await pb({authorization:i[0]}).catch(()=>{throw new j("`to` is required. Could not infer from `authorizationList`.")})})();if((v==null?void 0:v.type)==="json-rpc"||v===null){let N;r!==null&&(N=await st(t,Ib,"getChainId")({}),wS({currentChainId:N,chain:r}));const D=(S=(b=(w=t.chain)==null?void 0:w.formatters)==null?void 0:b.transactionRequest)==null?void 0:S.format,U=(D||Ll)({...up(m,{format:D}),accessList:s,authorizationList:i,blobs:o,chainId:N,data:a,from:v==null?void 0:v.address,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,to:T,type:p,value:g}),P=Id.get(t.uid),k=P?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:k,params:[U]},{retryCount:0})}catch(L){if(P===!1)throw L;const B=L;if(B.name==="InvalidInputRpcError"||B.name==="InvalidParamsRpcError"||B.name==="MethodNotFoundRpcError"||B.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[U]},{retryCount:0}).then(C=>(Id.set(t.uid,!0),C)).catch(C=>{const I=C;throw I.name==="MethodNotFoundRpcError"||I.name==="MethodNotSupportedRpcError"?(Id.set(t.uid,!1),B):I});throw B}}if((v==null?void 0:v.type)==="local"){const N=await st(t,fp,"prepareTransactionRequest")({account:v,accessList:s,authorizationList:i,blobs:o,chain:r,data:a,gas:c,gasPrice:u,maxFeePerBlobGas:l,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,nonceManager:v.nonceManager,parameters:[...Sb,"sidecars"],type:p,value:g,...m,to:T}),D=(_=r==null?void 0:r.serializers)==null?void 0:_.transaction,A=await v.signTransaction(N,{serializer:D});return await st(t,vS,"sendRawTransaction")({serializedTransaction:A})}throw(v==null?void 0:v.type)==="smart"?new Ad({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new Ad({docsPath:"/docs/actions/wallet/sendTransaction",type:v==null?void 0:v.type})}catch(T){throw T instanceof Ad?T:bS(T,{...e,account:v,chain:e.chain||void 0})}}async function ES(t,e){const{abi:n,account:r=t.account,address:s,args:i,dataSuffix:o,functionName:a,...c}=e;if(typeof r>"u")throw new gp({docsPath:"/docs/contract/writeContract"});const u=r?Rr(r):null,l=$l({abi:n,args:i,functionName:a});try{return await st(t,Hb,"sendTransaction")({data:`${l}${o?o.replace("0x",""):""}`,to:s,account:u,...c})}catch(d){throw Zu(d,{abi:n,address:s,args:i,docsPath:"/docs/contract/writeContract",functionName:a,sender:u==null?void 0:u.address})}}const CS={"0x0":"reverted","0x1":"success"};function Wb(t){const e={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(n=>xb(n)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?ks(t.transactionIndex):null,status:t.status?CS[t.status]:null,type:t.type?yb[t.type]||t.type:null};return t.blobGasPrice&&(e.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(e.blobGasUsed=BigInt(t.blobGasUsed)),e}const WH=Ml("transactionReceipt",Wb),Hh=256;let Qc=Hh,eu;function Vb(t=11){if(!eu||Qc+t>Hh*2){eu="",Qc=0;for(let e=0;e<Hh;e++)eu+=(256+Math.random()*256|0).toString(16).substring(1)}return eu.substring(Qc,Qc+++t)}function Gb(t){const{batch:e,chain:n,ccipRead:r,key:s="base",name:i="Base Client",type:o="base"}=t,a=(n==null?void 0:n.blockTime)??12e3,c=Math.min(Math.max(Math.floor(a/2),500),4e3),u=t.pollingInterval??c,l=t.cacheTime??u,d=t.account?Rr(t.account):void 0,{config:h,request:f,value:p}=t.transport({chain:n,pollingInterval:u}),g={...h,...p},m={account:d,batch:e,cacheTime:l,ccipRead:r,chain:n,key:s,name:i,pollingInterval:u,request:f,transport:g,type:o,uid:Vb()};function v(w){return b=>{const S=b(w);for(const T in m)delete S[T];const _={...w,...S};return Object.assign(_,{extend:v(_)})}}return Object.assign(m,{extend:v(m)})}function VH(){return null}const tu=new Ol(8192);function _S(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(tu.get(n))return tu.get(n);const r=t().finally(()=>tu.delete(n));return tu.set(n,r),r}function tl(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:u})=>{const l=typeof e=="function"?e({count:a,error:u}):e;l&&await el(l),o({count:a+1})};try{const u=await t();s(u)}catch(u){if(a<n&&await r({count:a,error:u}))return c({error:u});i(u)}};o()})}function AS(t,e={}){return async(n,r={})=>{var d;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:u}=n;if((d=i==null?void 0:i.exclude)!=null&&d.includes(u))throw new ti(new Error("method not supported"),{method:u});if(i!=null&&i.include&&!i.include.includes(u))throw new ti(new Error("method not supported"),{method:u});const l=s?xl(`${c}.${An(n)}`):void 0;return _S(()=>tl(async()=>{try{return await t(n)}catch(h){const f=h;switch(f.code){case Fa.code:throw new Fa(f);case ja.code:throw new ja(f);case za.code:throw new za(f,{method:n.method});case qa.code:throw new qa(f);case wi.code:throw new wi(f);case Ha.code:throw new Ha(f);case Wa.code:throw new Wa(f);case Ss.code:throw new Ss(f);case Eo.code:throw new Eo(f);case ti.code:throw new ti(f,{method:n.method});case Co.code:throw new Co(f);case Va.code:throw new Va(f);case gt.code:throw new gt(f);case Ga.code:throw new Ga(f);case Ka.code:throw new Ka(f);case Ya.code:throw new Ya(f);case Za.code:throw new Za(f);case Tr.code:throw new Tr(f);case Ja.code:throw new Ja(f);case Xa.code:throw new Xa(f);case Qa.code:throw new Qa(f);case ec.code:throw new ec(f);case tc.code:throw new tc(f);case nc.code:throw new nc(f);case rc.code:throw new rc(f);case 5e3:throw new gt(f);default:throw h instanceof j?h:new s2(f)}}},{delay:({count:h,error:f})=>{var p;if(f&&f instanceof va){const g=(p=f==null?void 0:f.headers)==null?void 0:p.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g)*1e3}return~~(1<<h)*o},retryCount:a,shouldRetry:({error:h})=>IS(h)}),{enabled:s,id:l})}}function IS(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===Co.code||t.code===wi.code:t instanceof va&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function mp({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const u=Vb();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:AS(r,{methods:e,retryCount:s,retryDelay:i,uid:u}),value:c}}function SS(t,e={}){const{key:n="custom",methods:r,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>mp({key:n,methods:r,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function Hg(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=NS,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:u=4e3,timeout:l,...d})=>{let h=t,f=()=>{};const p=mp({key:n,name:r,async request({method:g,params:m}){let v;const w=async(b=0)=>{const S=h[b]({...d,chain:c,retryCount:0,timeout:l});try{const _=await S.request({method:g,params:m});return f({method:g,params:m,response:_,transport:S,status:"success"}),_}catch(_){if(f({error:_,method:g,params:m,transport:S,status:"error"}),i(_)||b===h.length-1||(v??(v=h.slice(b+1).some(T=>{const{include:N,exclude:D}=T({chain:c}).config.methods||{};return N?N.includes(g):D?!D.includes(g):!0})),!v))throw _;return w(b+1)}};return w()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>f=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};TS({chain:c,interval:g.interval??u,onTransports:m=>h=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return p}}function NS(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===Eo.code||t.code===gt.code||ni.nodeMessage.test(t.message)||t.code===5e3))}function TS({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:u=.3}=a,l=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const m=g({chain:t,retryCount:0,timeout:i}),v=Date.now();let w,b;try{await(r?r({transport:m}):m.request({method:"net_listening"})),b=1}catch{b=0}finally{w=Date.now()}return{latency:w-v,success:b}}));l.push(h),l.length>s&&l.shift();const f=Math.max(...l.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const v=l.map(T=>T[m].latency),b=1-v.reduce((T,N)=>T+N,0)/v.length/f,S=l.map(T=>T[m].success),_=S.reduce((T,N)=>T+N,0)/S.length;return _===0?[0,m]:[u*b+c*_,m]}).sort((g,m)=>m[0]-g[0]);n(p.map(([,g])=>o[g])),await el(e),d()};d()}class xS extends j{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function Kb(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r?a.abort():i(e)},n)),s(await t({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function PS(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const Wg=PS();function OS(t,e={}){return{async request(n){var d;const{body:r,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=n,a={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:c,method:u,signal:l}=a;try{const h=await Kb(async({signal:p})=>{const g={...a,body:Array.isArray(r)?An(r.map(b=>({jsonrpc:"2.0",id:b.id??Wg.take(),...b}))):An({jsonrpc:"2.0",id:r.id??Wg.take(),...r}),headers:{"Content-Type":"application/json",...c},method:u||"POST",signal:l||(o>0?p:null)},m=new Request(t,g),v=await(s==null?void 0:s(m,g))??{...g,url:t};return await fetch(v.url??t,v)},{errorInstance:new $g({body:r,url:t}),timeout:o,signal:!0});i&&await i(h);let f;if((d=h.headers.get("Content-Type"))!=null&&d.startsWith("application/json"))f=await h.json();else{f=await h.text();try{f=JSON.parse(f||"{}")}catch(p){if(h.ok)throw p;f={error:f}}}if(!h.ok)throw new va({body:r,details:An(f.error)||h.statusText,headers:h.headers,status:h.status,url:t});return f}catch(h){throw h instanceof va||h instanceof $g?h:new va({body:r,cause:h,url:t})}}}}function nu(t,e={}){const{batch:n,fetchOptions:r,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:u,raw:l}=e;return({chain:d,retryCount:h,timeout:f})=>{const{batchSize:p=1e3,wait:g=0}=typeof n=="object"?n:{},m=e.retryCount??h,v=f??e.timeout??1e4,w=t||(d==null?void 0:d.rpcUrls.default.http[0]);if(!w)throw new xS;const b=OS(w,{fetchOptions:r,onRequest:a,onResponse:c,timeout:v});return mp({key:s,methods:i,name:o,async request({method:S,params:_}){const T={method:S,params:_},{schedule:N}=Fb({id:w,wait:g,shouldSplitBatch(P){return P.length>p},fn:P=>b.request({body:P}),sort:(P,k)=>P.id-k.id}),D=async P=>n?N(P):[await b.request({body:P})],[{error:A,result:U}]=await D(T);if(l)return{error:A,result:U};if(A)throw new op({body:T,error:A,url:w});return U},retryCount:m,retryDelay:u,timeout:v,type:"http"},{fetchOptions:r,url:w})}}async function RS(t){const e=NI(t,{method:"eth_newPendingTransactionFilter"}),n=await t.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:e(n),type:"transaction"}}function DS(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}class $S extends j{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function kS(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new $S({value:t});let[n,r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[i,o,a]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],c=Math.round(+`${o}.${a}`);c>9?r=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):r=`${i}${c}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}async function Yb(t,{blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){var l,d,h;const o=r||"latest",a=n!==void 0?Ae(n):void 0;let c=null;if(s?c=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?c=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,Ae(i)]},{dedupe:!0}):c=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[a||o,Ae(i)]},{dedupe:!!a}),!c)throw new ub({blockHash:e,blockNumber:n,blockTag:o,hash:s,index:i});return(((h=(d=(l=t.chain)==null?void 0:l.formatters)==null?void 0:d.transaction)==null?void 0:h.format)||dp)(c)}async function Vg(t,{hash:e}){var s,i,o;const n=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!n)throw new lb({hash:e});return(((o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionReceipt)==null?void 0:o.format)||Wb)(n)}async function US(t,e){var v;const{account:n,allowFailure:r=!0,batchSize:s,blockNumber:i,blockTag:o,multicallAddress:a,stateOverride:c}=e,u=e.contracts,l=s??(typeof((v=t.batch)==null?void 0:v.multicall)=="object"&&t.batch.multicall.batchSize||1024);let d=a;if(!d){if(!t.chain)throw new Error("client chain not configured. multicallAddress is required.");d=Lb({blockNumber:i,chain:t.chain,contract:"multicall3"})}const h=[[]];let f=0,p=0;for(let w=0;w<u.length;w++){const{abi:b,address:S,args:_,functionName:T}=u[w];try{const N=$l({abi:b,args:_,functionName:T});p+=(N.length-2)/2,l>0&&p>l&&h[f].length>0&&(f++,p=(N.length-2)/2,h[f]=[]),h[f]=[...h[f],{allowFailure:!0,callData:N,target:S}]}catch(N){const D=Zu(N,{abi:b,address:S,args:_,docsPath:"/docs/contract/multicall",functionName:T,sender:n});if(!r)throw D;h[f]=[...h[f],{allowFailure:!0,callData:"0x",target:S}]}}const g=await Promise.allSettled(h.map(w=>st(t,zb,"readContract")({abi:zh,account:n,address:d,args:[w],blockNumber:i,blockTag:o,functionName:"aggregate3",stateOverride:c}))),m=[];for(let w=0;w<g.length;w++){const b=g[w];if(b.status==="rejected"){if(!r)throw b.reason;for(let _=0;_<h[w].length;_++)m.push({status:"failure",error:b.reason,result:void 0});continue}const S=b.value;for(let _=0;_<S.length;_++){const{returnData:T,success:N}=S[_],{callData:D}=h[w][_],{abi:A,address:U,functionName:P,args:k}=u[m.length];try{if(D==="0x")throw new Tl;if(!N)throw new ip({data:T});const L=pp({abi:A,args:k,data:T,functionName:P});m.push(r?{result:L,status:"success"}:L)}catch(L){const B=Zu(L,{abi:A,address:U,args:k,docsPath:"/docs/contract/multicall",functionName:P});if(!r)throw B;m.push({error:B,result:void 0,status:"failure"})}}}if(m.length!==u.length)throw new j("multicall results mismatch");return m}function MS(t,{emitOnBegin:e=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc"));let c;return a?(()=>{const d=An(["watchBlockNumber",t.uid,e,n,o]);return Qu(d,{onBlockNumber:r,onError:s},h=>qb(async()=>{var f;try{const p=await st(t,gS,"getBlockNumber")({cacheTime:0});if(c){if(p===c)return;if(p-c>1&&n)for(let g=c+1n;g<p;g++)h.onBlockNumber(g,c),c=g}(!c||p>c)&&(h.onBlockNumber(p,c),c=p)}catch(p){(f=h.onError)==null||f.call(h,p)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=An(["watchBlockNumber",t.uid,e,n]);return Qu(d,{onBlockNumber:r,onError:s},h=>{let f=!0,p=()=>f=!1;return(async()=>{try{const g=(()=>{if(t.transport.type==="fallback"){const v=t.transport.transports.find(w=>w.config.type==="webSocket"||w.config.type==="ipc");return v?v.value:t.transport}return t.transport})(),{unsubscribe:m}=await g.subscribe({params:["newHeads"],onData(v){var b;if(!f)return;const w=gi((b=v.result)==null?void 0:b.number);h.onBlockNumber(w,c),c=w},onError(v){var w;(w=h.onError)==null||w.call(h,v)}});p=m,f||p()}catch(g){s==null||s(g)}})(),()=>p()})})()}async function LS(t,{confirmations:e=1,hash:n,onReplaced:r,pollingInterval:s=t.pollingInterval,retryCount:i=6,retryDelay:o=({count:c})=>~~(1<<c)*200,timeout:a=18e4}){const c=An(["waitForTransactionReceipt",t.uid,n]);let u,l,d,h=!1,f,p;const{promise:g,resolve:m,reject:v}=Bb(),w=a?setTimeout(()=>{p(),f(),v(new JI({hash:n}))},a):void 0;return f=Qu(c,{onReplaced:r,resolve:m,reject:v},b=>{p=st(t,MS,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(S){const _=N=>{clearTimeout(w),p(),N(),f()};let T=S;if(!h)try{if(d){if(e>1&&(!d.blockNumber||T-d.blockNumber+1n<e))return;_(()=>b.resolve(d));return}if(u||(h=!0,await tl(async()=>{u=await st(t,Yb,"getTransaction")({hash:n}),u.blockNumber&&(T=u.blockNumber)},{delay:o,retryCount:i}),h=!1),d=await st(t,Vg,"getTransactionReceipt")({hash:n}),e>1&&(!d.blockNumber||T-d.blockNumber+1n<e))return;_(()=>b.resolve(d))}catch(N){if(N instanceof ub||N instanceof lb){if(!u){h=!1;return}try{l=u,h=!0;const D=await tl(()=>st(t,sc,"getBlock")({blockNumber:T,includeTransactions:!0}),{delay:o,retryCount:i,shouldRetry:({error:P})=>P instanceof mb});h=!1;const A=D.transactions.find(({from:P,nonce:k})=>P===l.from&&k===l.nonce);if(!A||(d=await st(t,Vg,"getTransactionReceipt")({hash:A.hash}),e>1&&(!d.blockNumber||T-d.blockNumber+1n<e)))return;let U="replaced";A.to===l.to&&A.value===l.value&&A.input===l.input?U="repriced":A.from===A.to&&A.value===0n&&(U="cancelled"),_(()=>{var P;(P=b.onReplaced)==null||P.call(b,{reason:U,replacedTransaction:l,transaction:A,transactionReceipt:d}),b.resolve(d)})}catch(D){_(()=>b.reject(D))}}else _(()=>b.reject(N))}}})}),g}function BS(t,{batch:e=!0,onError:n,onTransactions:r,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket"&&t.transport.type!=="ipc")?(()=>{const u=An(["watchPendingTransactions",t.uid,e,i]);return Qu(u,{onTransactions:r,onError:n},l=>{let d;const h=qb(async()=>{var f;try{if(!d)try{d=await st(t,RS,"createPendingTransactionFilter")({});return}catch(g){throw h(),g}const p=await st(t,mS,"getFilterChanges")({filter:d});if(p.length===0)return;if(e)l.onTransactions(p);else for(const g of p)l.onTransactions([g])}catch(p){(f=l.onError)==null||f.call(l,p)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await st(t,yS,"uninstallFilter")({filter:d}),h()}})})():(()=>{let u=!0,l=()=>u=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(h){if(!u)return;const f=h.result;r([f])},onError(h){n==null||n(h)}});l=d,u||l()}catch(d){n==null||n(d)}})(),()=>l()})()}async function FS(t,{account:e=t.account,message:n}){if(!e)throw new gp({docsPath:"/docs/actions/wallet/signMessage"});const r=Rr(e);if(r.signMessage)return r.signMessage({message:n});const s=typeof n=="string"?xl(n):n.raw instanceof Uint8Array?mi(n.raw):n.raw;return t.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}const Sd={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return Ro(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}},yp={async getMyTokensWithBalance(t){const e=ce.state.address,n=E.state.activeCaipNetwork,r=K.getConnectorId("eip155")===$.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=H.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===$.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,n);if(a)return this.filterLowQualityTokens(a)}const o=await he.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){var n,r;try{const s=Sd.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await J.getCapabilities(t);if(!((r=(n=i==null?void 0:i[s])==null?void 0:n.assetDiscovery)!=null&&r.supported))return null;const o=await J.walletGetAssets({account:t,chainFilter:[s]});if(!Sd.isWalletGetAssetsResponse(o))return null;const c=(o[s]||[]).map(u=>Sd.createBalance(u,e.caipNetworkId));return H.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:c},timestamp:Date.now()}),c}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")}},cr=Ye({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),jS={state:cr,replaceState(t){t&&Object.assign(cr,hi(t))},subscribe(t){return E.subscribeChainProp("accountState",e=>{if(e)return t(e)})},subscribeKey(t,e,n){let r;return E.subscribeChainProp("accountState",s=>{if(s){const i=s[t];r!==i&&(r=i,e(i))}},n)},setStatus(t,e){E.setAccountProp("status",t,e)},getCaipAddress(t){return E.getAccountProp("caipAddress",t)},setCaipAddress(t,e){const n=t?ie.getPlainAddress(t):void 0;e===E.state.activeChain&&(E.state.activeCaipAddress=t),E.setAccountProp("caipAddress",t,e),E.setAccountProp("address",n,e)},setBalance(t,e,n){E.setAccountProp("balance",t,n),E.setAccountProp("balanceSymbol",e,n)},setProfileName(t,e){E.setAccountProp("profileName",t,e)},setProfileImage(t,e){E.setAccountProp("profileImage",t,e)},setUser(t,e){E.setAccountProp("user",t,e)},setAddressExplorerUrl(t,e){E.setAccountProp("addressExplorerUrl",t,e)},setSmartAccountDeployed(t,e){E.setAccountProp("smartAccountDeployed",t,e)},setCurrentTab(t){E.setAccountProp("currentTab",t,E.state.activeChain)},setTokenBalance(t,e){t&&E.setAccountProp("tokenBalance",t,e)},setShouldUpdateToAddress(t,e){E.setAccountProp("shouldUpdateToAddress",t,e)},addAddressLabel(t,e,n){const r=E.getAccountProp("addressLabels",n)||new Map;r.set(t,e),E.setAccountProp("addressLabels",r,n)},removeAddressLabel(t,e){const n=E.getAccountProp("addressLabels",e)||new Map;n.delete(t),E.setAccountProp("addressLabels",n,e)},setConnectedWalletInfo(t,e){E.setAccountProp("connectedWalletInfo",t,e,!1)},setPreferredAccountType(t,e){E.setAccountProp("preferredAccountType",t,e)},setSocialProvider(t,e){t&&E.setAccountProp("socialProvider",t,e)},setSocialWindow(t,e){E.setAccountProp("socialWindow",t?hi(t):void 0,e)},setFarcasterUrl(t,e){E.setAccountProp("farcasterUrl",t,e)},async fetchTokenBalance(t){var i,o;cr.balanceLoading=!0;const e=(i=E.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,n=(o=E.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=E.state.activeCaipAddress,s=r?ie.getPlainAddress(r):void 0;if(cr.lastRetry&&!ie.isAllowedRetry(cr.lastRetry,30*Be.ONE_SEC_MS))return cr.balanceLoading=!1,[];try{if(s&&e&&n){const a=await yp.getMyTokensWithBalance();return ce.setTokenBalance(a,n),cr.lastRetry=void 0,cr.balanceLoading=!1,a}}catch(a){cr.lastRetry=Date.now(),t==null||t(a),vr.showError("Token Balance Unavailable")}finally{cr.balanceLoading=!1}return[]},resetAccount(t){E.resetAccount(t)}},ce=Nn(jS),zS={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=E.state.activeCaipNetwork,r=ge.state.data;if(t.id===(n==null?void 0:n.id))return;const i=ce.getCaipAddress(E.state.activeChain),o=t.chainNamespace!==E.state.activeChain,a=ce.getCaipAddress(t.chainNamespace),u=K.getConnectorId(E.state.activeChain)===$.CONNECTOR_ID.AUTH,l=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===t.chainNamespace);e||u&&l?ge.push("SwitchNetwork",{...r,network:t}):i&&o&&!a?ge.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):ge.push("SwitchNetwork",{...r,network:t})}},en=Ye({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),qS={state:en,subscribe(t){return Dt(en,()=>t(en))},subscribeKey(t,e){return $t(en,t,e)},async open(t){var i,o;const e=t==null?void 0:t.namespace,n=E.state.activeChain,r=e&&e!==n,s=(i=E.getAccountData(t==null?void 0:t.namespace))==null?void 0:i.caipAddress;if(J.state.wcBasic?le.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await le.prefetch(),K.setFilterByNamespace(t==null?void 0:t.namespace),$e.setLoading(!0,e),e&&r){const a=((o=E.getNetworkData(e))==null?void 0:o.caipNetwork)||E.getRequestedCaipNetworks(e)[0];a&&zS.onSwitchNetwork({network:a,ignoreSwitchConfirmation:!0})}else{const a=E.state.noAdapters;F.state.manualWCControl||a&&!s?ie.isMobile()?ge.reset("AllWallets"):ge.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?ge.reset(t.view,t.data):s?ge.reset("Account"):ge.reset("Connect")}en.open=!0,Cr.set({open:!0}),qe.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=F.state.enableEmbedded,e=!!E.state.activeCaipAddress;en.open&&qe.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),en.open=!1,ge.reset("Connect"),$e.clearLoading(),t?e?ge.replace("Account"):ge.push("Connect"):Cr.set({open:!1}),J.resetUri()},setLoading(t,e){e&&en.loadingNamespaceMap.set(e,t),en.loading=t,Cr.set({loading:t})},clearLoading(){en.loadingNamespaceMap.clear(),en.loading=!1},shake(){en.shake||(en.shake=!0,setTimeout(()=>{en.shake=!1},500))}},$e=Nn(qS),Ea={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Wh={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},HS={providers:w0,selectedProvider:null,error:null,purchaseCurrency:Ea,paymentCurrency:Wh,purchaseCurrencies:[Ea],paymentCurrencies:[],quotesLoading:!1},xe=Ye(HS),WS={state:xe,subscribe(t){return Dt(xe,()=>t(xe))},subscribeKey(t,e){return $t(xe,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=E.state.activeChain,n=e===$.CHAIN.SOLANA?"SOL":"USDC",r=E.getAccountProp("address",e)??"",s=new URL(t.url);s.searchParams.append("publicKey",g_),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",F.state.projectId),xe.selectedProvider={...t,url:s.toString()}}else xe.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=w0.filter(r=>e.includes(r.name));xe.providers=n}else xe.providers=[]},setPurchaseCurrency(t){xe.purchaseCurrency=t},setPaymentCurrency(t){xe.paymentCurrency=t},setPurchaseAmount(t){Vh.state.purchaseAmount=t},setPaymentAmount(t){Vh.state.paymentAmount=t},async getAvailableCurrencies(){const t=await he.getOnrampOptions();xe.purchaseCurrencies=t.purchaseCurrencies,xe.paymentCurrencies=t.paymentCurrencies,xe.paymentCurrency=t.paymentCurrencies[0]||Wh,xe.purchaseCurrency=t.purchaseCurrencies[0]||Ea,await le.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await le.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var t,e;xe.quotesLoading=!0;try{const n=await he.getOnrampQuote({purchaseCurrency:xe.purchaseCurrency,paymentCurrency:xe.paymentCurrency,amount:((t=xe.paymentAmount)==null?void 0:t.toString())||"0",network:(e=xe.purchaseCurrency)==null?void 0:e.symbol});return xe.quotesLoading=!1,xe.purchaseAmount=Number(n==null?void 0:n.purchaseAmount.amount),n}catch(n){return xe.error=n.message,xe.quotesLoading=!1,null}finally{xe.quotesLoading=!1}},resetState(){xe.selectedProvider=null,xe.error=null,xe.purchaseCurrency=Ea,xe.paymentCurrency=Wh,xe.purchaseCurrencies=[Ea],xe.paymentCurrencies=[],xe.paymentAmount=void 0,xe.purchaseAmount=void 0,xe.quotesLoading=!1}},Vh=Nn(WS),Gg=2147483648,VS={convertEVMChainIdToCoinType(t){if(t>=Gg)throw new Error("Invalid chainId");return(Gg|t)>>>0}},xn=Ye({suggestions:[],loading:!1}),GS={state:xn,subscribe(t){return Dt(xn,()=>t(xn))},subscribeKey(t,e){return $t(xn,t,e)},async resolveName(t){var e,n;try{return await he.lookupEnsName(t)}catch(r){const s=r;throw new Error(((n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description)||"Error resolving name")}},async isNameRegistered(t){try{return await he.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{xn.loading=!0,xn.suggestions=[];const e=await he.getEnsNameSuggestions(t);return xn.suggestions=e.suggestions.map(n=>({...n,name:n.name}))||[],xn.suggestions}catch(e){const n=Ca.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{xn.loading=!1}},async getNamesForAddress(t){try{if(!E.state.activeCaipNetwork)return[];const n=H.getEnsFromCacheForAddress(t);if(n)return n;const r=await he.reverseLookupEnsName({address:t});return H.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Ca.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=E.state.activeCaipNetwork,n=ce.state.address,r=K.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");xn.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});ge.pushTransactionStack({onCancel(){ge.replace("RegisterAccountName")}});const i=await J.signMessage(s);xn.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=VS.convertEVMChainIdToCoinType(Number(o));await he.registerEnsName({coinType:a,address:n,signature:i,message:s}),ce.setProfileName(t,e.chainNamespace),ge.replace("RegisterAccountNameSuccess")}catch(s){const i=Ca.parseEnsApiError(s,`Error registering name ${t}`);throw ge.replace("RegisterAccountName"),new Error(i)}finally{xn.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var r,s;const n=t;return((s=(r=n==null?void 0:n.reasons)==null?void 0:r[0])==null?void 0:s.description)||e}},Ca=Nn(GS);var wp={exports:{}},fo=typeof Reflect=="object"?Reflect:null,Kg=fo&&typeof fo.apply=="function"?fo.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Pu;fo&&typeof fo.ownKeys=="function"?Pu=fo.ownKeys:Object.getOwnPropertySymbols?Pu=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Pu=function(e){return Object.getOwnPropertyNames(e)};function KS(t){console&&console.warn&&console.warn(t)}var Zb=Number.isNaN||function(e){return e!==e};function Ge(){Ge.init.call(this)}wp.exports=Ge;wp.exports.once=XS;Ge.EventEmitter=Ge;Ge.prototype._events=void 0;Ge.prototype._eventsCount=0;Ge.prototype._maxListeners=void 0;var Yg=10;function Fl(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ge,"defaultMaxListeners",{enumerable:!0,get:function(){return Yg},set:function(t){if(typeof t!="number"||t<0||Zb(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Yg=t}});Ge.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ge.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Zb(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Jb(t){return t._maxListeners===void 0?Ge.defaultMaxListeners:t._maxListeners}Ge.prototype.getMaxListeners=function(){return Jb(this)};Ge.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")Kg(c,this,n);else for(var u=c.length,l=nv(c,u),r=0;r<u;++r)Kg(l[r],this,n);return!0};function Xb(t,e,n,r){var s,i,o;if(Fl(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),o=i[e]),o===void 0)o=i[e]=n,++t._eventsCount;else if(typeof o=="function"?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=Jb(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,KS(a)}return t}Ge.prototype.addListener=function(e,n){return Xb(this,e,n,!1)};Ge.prototype.on=Ge.prototype.addListener;Ge.prototype.prependListener=function(e,n){return Xb(this,e,n,!0)};function YS(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Qb(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=YS.bind(r);return s.listener=n,r.wrapFn=s,s}Ge.prototype.once=function(e,n){return Fl(n),this.on(e,Qb(this,e,n)),this};Ge.prototype.prependOnceListener=function(e,n){return Fl(n),this.prependListener(e,Qb(this,e,n)),this};Ge.prototype.removeListener=function(e,n){var r,s,i,o,a;if(Fl(n),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():ZS(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Ge.prototype.off=Ge.prototype.removeListener;Ge.prototype.removeAllListeners=function(e){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function ev(t,e,n){var r=t._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?JS(s):nv(s,s.length)}Ge.prototype.listeners=function(e){return ev(this,e,!0)};Ge.prototype.rawListeners=function(e){return ev(this,e,!1)};Ge.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):tv.call(t,e)};Ge.prototype.listenerCount=tv;function tv(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Ge.prototype.eventNames=function(){return this._eventsCount>0?Pu(this._events):[]};function nv(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function ZS(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function JS(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function XS(t,e){return new Promise(function(n,r){function s(o){t.removeListener(e,i),r(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}rv(t,e,i,{once:!0}),e!=="error"&&QS(t,s,{once:!0})})}function QS(t,e,n){typeof t.on=="function"&&rv(t,"error",e,n)}function rv(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){r.once&&t.removeEventListener(e,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var zn=wp.exports;const bp=Il(zn);var V={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gh=function(t,e){return Gh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},Gh(t,e)};function eN(t,e){Gh(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Kh=function(){return Kh=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Kh.apply(this,arguments)};function tN(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function nN(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function rN(t,e){return function(n,r){e(n,r,t)}}function sN(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function iN(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(l){try{u(r.next(l))}catch(d){o(d)}}function c(l){try{u(r.throw(l))}catch(d){o(d)}}function u(l){l.done?i(l.value):s(l.value).then(a,c)}u((r=r.apply(t,e||[])).next())})}function oN(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(l){return c([u,l])}}function c(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=u[0]&2?s.return:u[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,u[1])).done)return i;switch(s=0,i&&(u=[u[0]&2,i.value]),u[0]){case 0:case 1:i=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){n.label=u[1];break}if(u[0]===6&&n.label<i[1]){n.label=i[1],i=u;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(u);break}i[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(l){u=[6,l],s=0}finally{r=i=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function aN(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function cN(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function Yh(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function sv(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function uN(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(sv(arguments[e]));return t}function lN(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function ic(t){return this instanceof ic?(this.v=t,this):new ic(t)}function dN(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(f){return new Promise(function(p,g){i.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{c(r[h](f))}catch(p){d(i[0][3],p)}}function c(h){h.value instanceof ic?Promise.resolve(h.value.v).then(u,l):d(i[0][2],h)}function u(h){a("next",h)}function l(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function hN(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:ic(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function fN(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Yh=="function"?Yh(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(u){i({value:u,done:a})},o)}}function pN(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function gN(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function mN(t){return t&&t.__esModule?t:{default:t}}function yN(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function wN(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const bN=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Kh},__asyncDelegator:hN,__asyncGenerator:dN,__asyncValues:fN,__await:ic,__awaiter:iN,__classPrivateFieldGet:yN,__classPrivateFieldSet:wN,__createBinding:aN,__decorate:nN,__exportStar:cN,__extends:eN,__generator:oN,__importDefault:mN,__importStar:gN,__makeTemplateObject:pN,__metadata:sN,__param:rN,__read:sv,__rest:tN,__spread:uN,__spreadArrays:lN,__values:Yh},Symbol.toStringTag,{value:"Module"})),Uc=zC(bN);var Nd={},Yo={},Zg;function vN(){if(Zg)return Yo;Zg=1,Object.defineProperty(Yo,"__esModule",{value:!0}),Yo.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return Yo.delay=t,Yo}var qs={},Td={},Hs={},Jg;function EN(){return Jg||(Jg=1,Object.defineProperty(Hs,"__esModule",{value:!0}),Hs.ONE_THOUSAND=Hs.ONE_HUNDRED=void 0,Hs.ONE_HUNDRED=100,Hs.ONE_THOUSAND=1e3),Hs}var xd={},Xg;function CN(){return Xg||(Xg=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(xd)),xd}var Qg;function iv(){return Qg||(Qg=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Uc;e.__exportStar(EN(),t),e.__exportStar(CN(),t)}(Td)),Td}var em;function _N(){if(em)return qs;em=1,Object.defineProperty(qs,"__esModule",{value:!0}),qs.fromMiliseconds=qs.toMiliseconds=void 0;const t=iv();function e(r){return r*t.ONE_THOUSAND}qs.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return qs.fromMiliseconds=n,qs}var tm;function AN(){return tm||(tm=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Uc;e.__exportStar(vN(),t),e.__exportStar(_N(),t)}(Nd)),Nd}var Li={},nm;function IN(){if(nm)return Li;nm=1,Object.defineProperty(Li,"__esModule",{value:!0}),Li.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Li.Watch=t,Li.default=t,Li}var Pd={},Zo={},rm;function SN(){if(rm)return Zo;rm=1,Object.defineProperty(Zo,"__esModule",{value:!0}),Zo.IWatch=void 0;class t{}return Zo.IWatch=t,Zo}var sm;function NN(){return sm||(sm=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),Uc.__exportStar(SN(),t)}(Pd)),Pd}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Uc;e.__exportStar(AN(),t),e.__exportStar(IN(),t),e.__exportStar(NN(),t),e.__exportStar(iv(),t)})(V);class Pi{}let TN=class extends Pi{constructor(e){super()}};const im=V.FIVE_SECONDS,Oi={pulse:"heartbeat_pulse"};let xN=class ov extends TN{constructor(e){super(e),this.events=new zn.EventEmitter,this.interval=im,this.interval=(e==null?void 0:e.interval)||im}static async init(e){const n=new ov(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),V.toMiliseconds(this.interval))}pulse(){this.events.emit(Oi.pulse)}};const PN=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,ON=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,RN=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function DN(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){$N(t);return}return e}function $N(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function ru(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!RN.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(PN.test(t)||ON.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,DN)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function kN(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Et(t,...e){try{return kN(t(...e))}catch(n){return Promise.reject(n)}}function UN(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function MN(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Ou(t){if(UN(t))return String(t);if(MN(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Ou(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Zh="base64:";function LN(t){return typeof t=="string"?t:Zh+jN(t)}function BN(t){return typeof t!="string"||!t.startsWith(Zh)?t:FN(t.slice(Zh.length))}function FN(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function jN(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function on(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function zN(...t){return on(t.join(":"))}function su(t){return t=on(t),t?t+":":""}function qN(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function HN(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const WN="memory",VN=()=>{const t=new Map;return{name:WN,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function GN(t={}){const e={mounts:{"":t.driver||VN()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},r=(u,l)=>e.mountpoints.filter(d=>d.startsWith(u)||l&&u.startsWith(d)).map(d=>({relativeBase:u.length>d.length?u.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(u,l)=>{if(e.watching){l=on(l);for(const d of e.watchListeners)d(u,l)}},i=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await om(e.mounts[u],s,u)}},o=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},a=(u,l,d)=>{const h=new Map,f=p=>{let g=h.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},h.set(p.base,g)),g};for(const p of u){const g=typeof p=="string",m=on(g?p:p.key),v=g?void 0:p.value,w=g||!p.options?l:{...l,...p.options},b=n(m);f(b).items.push({key:m,value:v,relativeKey:b.relativeKey,options:w})}return Promise.all([...h.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(u,l={}){u=on(u);const{relativeKey:d,driver:h}=n(u);return Et(h.hasItem,d,l)},getItem(u,l={}){u=on(u);const{relativeKey:d,driver:h}=n(u);return Et(h.getItem,d,l).then(f=>ru(f))},getItems(u,l={}){return a(u,l,d=>d.driver.getItems?Et(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),l).then(h=>h.map(f=>({key:zN(d.base,f.key),value:ru(f.value)}))):Promise.all(d.items.map(h=>Et(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:ru(f)})))))},getItemRaw(u,l={}){u=on(u);const{relativeKey:d,driver:h}=n(u);return h.getItemRaw?Et(h.getItemRaw,d,l):Et(h.getItem,d,l).then(f=>BN(f))},async setItem(u,l,d={}){if(l===void 0)return c.removeItem(u);u=on(u);const{relativeKey:h,driver:f}=n(u);f.setItem&&(await Et(f.setItem,h,Ou(l),d),f.watch||s("update",u))},async setItems(u,l){await a(u,l,async d=>{if(d.driver.setItems)return Et(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:Ou(h.value),options:h.options})),l);d.driver.setItem&&await Promise.all(d.items.map(h=>Et(d.driver.setItem,h.relativeKey,Ou(h.value),h.options)))})},async setItemRaw(u,l,d={}){if(l===void 0)return c.removeItem(u,d);u=on(u);const{relativeKey:h,driver:f}=n(u);if(f.setItemRaw)await Et(f.setItemRaw,h,l,d);else if(f.setItem)await Et(f.setItem,h,LN(l),d);else return;f.watch||s("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=on(u);const{relativeKey:d,driver:h}=n(u);h.removeItem&&(await Et(h.removeItem,d,l),(l.removeMeta||l.removeMata)&&await Et(h.removeItem,d+"$",l),h.watch||s("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=on(u);const{relativeKey:d,driver:h}=n(u),f=Object.create(null);if(h.getMeta&&Object.assign(f,await Et(h.getMeta,d,l)),!l.nativeOnly){const p=await Et(h.getItem,d+"$",l).then(g=>ru(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(u,l,d={}){return this.setItem(u+"$",l,d)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){var m;u=su(u);const d=r(u,!0);let h=[];const f=[];let p=!0;for(const v of d){(m=v.driver.flags)!=null&&m.maxDepth||(p=!1);const w=await Et(v.driver.getKeys,v.relativeBase,l);for(const b of w){const S=v.mountpoint+on(b);h.some(_=>S.startsWith(_))||f.push(S)}h=[v.mountpoint,...h.filter(b=>!b.startsWith(v.mountpoint))]}const g=l.maxDepth!==void 0&&!p;return f.filter(v=>(!g||qN(v,l.maxDepth))&&HN(v,u))},async clear(u,l={}){u=su(u),await Promise.all(r(u,!1).map(async d=>{if(d.driver.clear)return Et(d.driver.clear,d.relativeBase,l);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",l);return Promise.all(h.map(f=>d.driver.removeItem(f,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>am(u)))},async watch(u){return await i(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(u,l){if(u=su(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[u]=l,e.watching&&Promise.resolve(om(l,s,u)).then(d=>{e.unwatch[u]=d}).catch(console.error),c},async unmount(u,l=!0){var d,h;u=su(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&((h=(d=e.unwatch)[u])==null||h.call(d),delete e.unwatch[u]),l&&await am(e.mounts[u]),e.mountpoints=e.mountpoints.filter(f=>f!==u),delete e.mounts[u])},getMount(u=""){u=on(u)+":";const l=n(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=on(u),r(u,l.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(u,l={})=>c.getKeys(u,l),get:(u,l={})=>c.getItem(u,l),set:(u,l,d={})=>c.setItem(u,l,d),has:(u,l={})=>c.hasItem(u,l),del:(u,l={})=>c.removeItem(u,l),remove:(u,l={})=>c.removeItem(u,l)};return c}function om(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function am(t){typeof t.dispose=="function"&&await Et(t.dispose)}function Ri(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function av(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=Ri(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let Od;function Mc(){return Od||(Od=av("keyval-store","keyval")),Od}function cm(t,e=Mc()){return e("readonly",n=>Ri(n.get(t)))}function KN(t,e,n=Mc()){return n("readwrite",r=>(r.put(e,t),Ri(r.transaction)))}function YN(t,e=Mc()){return e("readwrite",n=>(n.delete(t),Ri(n.transaction)))}function ZN(t=Mc()){return t("readwrite",e=>(e.clear(),Ri(e.transaction)))}function JN(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ri(t.transaction)}function XN(t=Mc()){return t("readonly",e=>{if(e.getAllKeys)return Ri(e.getAllKeys());const n=[];return JN(e,r=>n.push(r.key)).then(()=>n)})}const QN=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),eT=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function bi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return eT(t)}catch{return t}}function Jr(t){return typeof t=="string"?t:QN(t)||""}const tT="idb-keyval";var nT=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=av(t.dbName,t.storeName)),{name:tT,options:t,async hasItem(s){return!(typeof await cm(n(s),r)>"u")},async getItem(s){return await cm(n(s),r)??null},setItem(s,i){return KN(n(s),i,r)},removeItem(s){return YN(n(s),r)},getKeys(){return XN(r)},clear(){return ZN(r)}}};const rT="WALLET_CONNECT_V2_INDEXED_DB",sT="keyvaluestorage";let iT=class{constructor(){this.indexedDb=GN({driver:nT({dbName:rT,storeName:sT})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,Jr(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Rd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ru={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Rd<"u"&&Rd.localStorage?Ru.exports=Rd.localStorage:typeof window<"u"&&window.localStorage?Ru.exports=window.localStorage:Ru.exports=new e})();function oT(t){var e;return[t[0],bi((e=t[1])!=null?e:"")]}let aT=class{constructor(){this.localStorage=Ru.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(oT)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return bi(n)}async setItem(e,n){this.localStorage.setItem(e,Jr(n))}async removeItem(e){this.localStorage.removeItem(e)}};const cT="wc_storage_version",um=1,uT=async(t,e,n)=>{const r=cT,s=await e.getItem(r);if(s&&s>=um){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const u=await t.getItem(a);await e.setItem(a,u),o.push(a)}}await e.setItem(r,um),n(e),lT(t,o)},lT=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let dT=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new aT;this.storage=e;try{const n=new iT;uT(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};function hT(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var fT=pT;function pT(t,e,n){var r=n&&n.stringify||hT,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var u="",l=1-s,d=-1,h=t&&t.length||0,f=0;f<h;){if(t.charCodeAt(f)===37&&f+1<h){switch(d=d>-1?d:0,t.charCodeAt(f+1)){case 100:case 102:if(l>=c||e[l]==null)break;d<f&&(u+=t.slice(d,f)),u+=Number(e[l]),d=f+2,f++;break;case 105:if(l>=c||e[l]==null)break;d<f&&(u+=t.slice(d,f)),u+=Math.floor(Number(e[l])),d=f+2,f++;break;case 79:case 111:case 106:if(l>=c||e[l]===void 0)break;d<f&&(u+=t.slice(d,f));var p=typeof e[l];if(p==="string"){u+="'"+e[l]+"'",d=f+2,f++;break}if(p==="function"){u+=e[l].name||"<anonymous>",d=f+2,f++;break}u+=r(e[l]),d=f+2,f++;break;case 115:if(l>=c)break;d<f&&(u+=t.slice(d,f)),u+=String(e[l]),d=f+2,f++;break;case 37:d<f&&(u+=t.slice(d,f)),u+="%",d=f+2,f++,l--;break}++l}++f}return d===-1?t:(d<h&&(u+=t.slice(d)),u)}const lm=fT;var io=Ar;const oc=AT().console||{},gT={mapHttpRequest:iu,mapHttpResponse:iu,wrapRequestSerializer:Dd,wrapResponseSerializer:Dd,wrapErrorSerializer:Dd,req:iu,res:iu,err:vT};function mT(t,e){return Array.isArray(t)?t.filter(function(r){return r!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Ar(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||oc;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=mT(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof n=="function"&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(n);c.log||(c.log=ac),Object.defineProperty(c,"levelVal",{get:l}),Object.defineProperty(c,"level",{get:d,set:h});const u={transmit:e,serialize:s,asObject:t.browser.asObject,levels:o,timestamp:ET(t)};c.levels=Ar.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=ac,c.serializers=r,c._serialize=s,c._stdErrSerialize=i,c.child=f,e&&(c._logEvent=Jh());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function d(){return this._level}function h(p){if(p!=="silent"&&!this.levels.values[p])throw Error("unknown level "+p);this._level=p,Bi(u,c,"error","log"),Bi(u,c,"fatal","error"),Bi(u,c,"warn","error"),Bi(u,c,"info","log"),Bi(u,c,"debug","log"),Bi(u,c,"trace","log")}function f(p,g){if(!p)throw new Error("missing bindings for child Pino");g=g||{},s&&p.serializers&&(g.serializers=p.serializers);const m=g.serializers;if(s&&m){var v=Object.assign({},r,m),w=t.browser.serialize===!0?Object.keys(v):s;delete p.serializers,jl([p],w,v,this._stdErrSerialize)}function b(S){this._childLevel=(S._childLevel|0)+1,this.error=Fi(S,p,"error"),this.fatal=Fi(S,p,"fatal"),this.warn=Fi(S,p,"warn"),this.info=Fi(S,p,"info"),this.debug=Fi(S,p,"debug"),this.trace=Fi(S,p,"trace"),v&&(this.serializers=v,this._serialize=w),e&&(this._logEvent=Jh([].concat(S._logEvent.bindings,p)))}return b.prototype=this,new b(this)}return c}Ar.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Ar.stdSerializers=gT;Ar.stdTimeFunctions=Object.assign({},{nullTime:cv,epochTime:uv,unixTime:CT,isoTime:_T});function Bi(t,e,n,r){const s=Object.getPrototypeOf(e);e[n]=e.levelVal>e.levels.values[n]?ac:s[n]?s[n]:oc[n]||oc[r]||ac,yT(t,e,n)}function yT(t,e,n){!t.transmit&&e[n]===ac||(e[n]=function(r){return function(){const i=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===oc?oc:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(t.serialize&&!t.asObject&&jl(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?r.call(a,wT(this,n,o,i)):r.apply(a,o),t.transmit){const u=t.transmit.level||e.level,l=Ar.levels.values[u],d=Ar.levels.values[n];if(d<l)return;bT(this,{ts:i,methodLevel:n,methodValue:d,transmitValue:Ar.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[n]))}function wT(t,e,n,r){t._serialize&&jl(n,t._serialize,t.serializers,t._stdErrSerialize);const s=n.slice();let i=s[0];const o={};r&&(o.time=r),o.level=Ar.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?lm(s.shift(),s):void 0}else typeof i=="string"&&(i=lm(s.shift(),s));return i!==void 0&&(o.msg=i),o}function jl(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=Ar.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s]))for(const i in t[s])e&&e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function Fi(t,e,n){return function(){const r=new Array(1+arguments.length);r[0]=e;for(var s=1;s<r.length;s++)r[s]=arguments[s-1];return t[n].apply(this,r)}}function bT(t,e,n){const r=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;jl(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=n.filter(function(u){return c.indexOf(u)===-1}),t._logEvent.level.label=i,t._logEvent.level.value=o,r(i,t._logEvent,a),t._logEvent=Jh(c)}function Jh(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function vT(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function ET(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?cv:uv}function iu(){return{}}function Dd(t){return t}function ac(){}function cv(){return!1}function uv(){return Date.now()}function CT(){return Math.round(Date.now()/1e3)}function _T(){return new Date(Date.now()).toISOString()}function AT(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const Lc=Il(io),IT={level:"info"},Bc="custom_context",vp=1e3*1024;let ST=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},dm=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new ST(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}},lv=class{constructor(e,n=vp){this.level=e??"error",this.levelValue=io.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new dm(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===io.levels.values.error?console.error(e):n===io.levels.values.warn?console.warn(e):n===io.levels.values.debug?console.debug(e):n===io.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Jr({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new dm(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(Jr({extraMetadata:e})),new Blob(n,{type:"application/json"})}},NT=class{constructor(e,n=vp){this.baseChunkLogger=new lv(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},TT=class{constructor(e,n=vp){this.baseChunkLogger=new lv(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var xT=Object.defineProperty,PT=Object.defineProperties,OT=Object.getOwnPropertyDescriptors,hm=Object.getOwnPropertySymbols,RT=Object.prototype.hasOwnProperty,DT=Object.prototype.propertyIsEnumerable,fm=(t,e,n)=>e in t?xT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nl=(t,e)=>{for(var n in e||(e={}))RT.call(e,n)&&fm(t,n,e[n]);if(hm)for(var n of hm(e))DT.call(e,n)&&fm(t,n,e[n]);return t},rl=(t,e)=>PT(t,OT(e));function $o(t){return rl(nl({},t),{level:(t==null?void 0:t.level)||IT.level})}function $T(t,e=Bc){return t[e]||""}function kT(t,e,n=Bc){return t[n]=e,t}function gn(t,e=Bc){let n="";return typeof t.bindings>"u"?n=$T(t,e):n=t.bindings().context||"",n}function UT(t,e,n=Bc){const r=gn(t,n);return r.trim()?`${r}/${e}`:e}function Vt(t,e,n=Bc){const r=UT(t,e,n),s=t.child({context:r});return kT(s,r,n)}function MT(t){var e,n;const r=new NT((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Lc(rl(nl({},t.opts),{level:"trace",browser:rl(nl({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function LT(t){var e;const n=new TT((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Lc(rl(nl({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function Ep(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?MT(t):LT(t)}var BT=Object.defineProperty,FT=(t,e,n)=>e in t?BT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pm=(t,e,n)=>FT(t,typeof e!="symbol"?e+"":e,n);let jT=class extends Pi{constructor(e){super(),this.opts=e,pm(this,"protocol","wc"),pm(this,"version",2)}};var zT=Object.defineProperty,qT=(t,e,n)=>e in t?zT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,HT=(t,e,n)=>qT(t,e+"",n);let WT=class extends Pi{constructor(e,n){super(),this.core=e,this.logger=n,HT(this,"records",new Map)}},VT=class{constructor(e,n){this.logger=e,this.core=n}},GT=class extends Pi{constructor(e,n){super(),this.relayer=e,this.logger=n}},KT=class extends Pi{constructor(e){super()}},YT=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},ZT=class extends Pi{constructor(e,n){super(),this.relayer=e,this.logger=n}},JT=class extends Pi{constructor(e,n){super(),this.core=e,this.logger=n}},XT=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},QT=class{constructor(e,n){this.projectId=e,this.logger=n}},ex=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var tx=Object.defineProperty,nx=(t,e,n)=>e in t?tx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gm=(t,e,n)=>nx(t,typeof e!="symbol"?e+"":e,n);let rx=class{constructor(e){this.opts=e,gm(this,"protocol","wc"),gm(this,"version",2)}},sx=class{constructor(e){this.client=e}};function ix(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function dv(t,...e){if(!ix(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function mm(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ox(t,e){dv(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const ji=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const $d=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function ax(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function hv(t){return typeof t=="string"&&(t=ax(t)),dv(t),t}let cx=class{clone(){return this._cloneInto()}};function ux(t){const e=r=>t().update(hv(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function fv(t=32){if(ji&&typeof ji.getRandomValues=="function")return ji.getRandomValues(new Uint8Array(t));if(ji&&typeof ji.randomBytes=="function")return ji.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function lx(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+u,a,r)}let dx=class extends cx{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=$d(this.buffer)}update(e){mm(this);const{view:n,buffer:r,blockLen:s}=this;e=hv(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=$d(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){mm(this),ox(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;lx(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=$d(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const ou=BigInt(2**32-1),Xh=BigInt(32);function pv(t,e=!1){return e?{h:Number(t&ou),l:Number(t>>Xh&ou)}:{h:Number(t>>Xh&ou)|0,l:Number(t&ou)|0}}function hx(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=pv(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const fx=(t,e)=>BigInt(t>>>0)<<Xh|BigInt(e>>>0),px=(t,e,n)=>t>>>n,gx=(t,e,n)=>t<<32-n|e>>>n,mx=(t,e,n)=>t>>>n|e<<32-n,yx=(t,e,n)=>t<<32-n|e>>>n,wx=(t,e,n)=>t<<64-n|e>>>n-32,bx=(t,e,n)=>t>>>n-32|e<<64-n,vx=(t,e)=>e,Ex=(t,e)=>t,Cx=(t,e,n)=>t<<n|e>>>32-n,_x=(t,e,n)=>e<<n|t>>>32-n,Ax=(t,e,n)=>e<<n-32|t>>>64-n,Ix=(t,e,n)=>t<<n-32|e>>>64-n;function Sx(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Nx=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Tx=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,xx=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),Px=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,Ox=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),Rx=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Ce={fromBig:pv,split:hx,toBig:fx,shrSH:px,shrSL:gx,rotrSH:mx,rotrSL:yx,rotrBH:wx,rotrBL:bx,rotr32H:vx,rotr32L:Ex,rotlSH:Cx,rotlSL:_x,rotlBH:Ax,rotlBL:Ix,add:Sx,add3L:Nx,add3H:Tx,add4L:xx,add4H:Px,add5H:Rx,add5L:Ox},[Dx,$x]=Ce.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rs=new Uint32Array(80),ss=new Uint32Array(80);let kx=class extends dx{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,u,l,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,u,l,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let b=0;b<16;b++,n+=4)rs[b]=e.getUint32(n),ss[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const S=rs[b-15]|0,_=ss[b-15]|0,T=Ce.rotrSH(S,_,1)^Ce.rotrSH(S,_,8)^Ce.shrSH(S,_,7),N=Ce.rotrSL(S,_,1)^Ce.rotrSL(S,_,8)^Ce.shrSL(S,_,7),D=rs[b-2]|0,A=ss[b-2]|0,U=Ce.rotrSH(D,A,19)^Ce.rotrBH(D,A,61)^Ce.shrSH(D,A,6),P=Ce.rotrSL(D,A,19)^Ce.rotrBL(D,A,61)^Ce.shrSL(D,A,6),k=Ce.add4L(N,P,ss[b-7],ss[b-16]),L=Ce.add4H(k,T,U,rs[b-7],rs[b-16]);rs[b]=L|0,ss[b]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:v,Hl:w}=this;for(let b=0;b<80;b++){const S=Ce.rotrSH(d,h,14)^Ce.rotrSH(d,h,18)^Ce.rotrBH(d,h,41),_=Ce.rotrSL(d,h,14)^Ce.rotrSL(d,h,18)^Ce.rotrBL(d,h,41),T=d&f^~d&g,N=h&p^~h&m,D=Ce.add5L(w,_,N,$x[b],ss[b]),A=Ce.add5H(D,v,S,T,Dx[b],rs[b]),U=D|0,P=Ce.rotrSH(r,s,28)^Ce.rotrBH(r,s,34)^Ce.rotrBH(r,s,39),k=Ce.rotrSL(r,s,28)^Ce.rotrBL(r,s,34)^Ce.rotrBL(r,s,39),L=r&i^r&a^i&a,B=s&o^s&c^o&c;v=g|0,w=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Ce.add(u|0,l|0,A|0,U|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const C=Ce.add3L(U,k,B);r=Ce.add3H(C,A,P,L),s=C|0}({h:r,l:s}=Ce.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ce.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ce.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Ce.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Ce.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Ce.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Ce.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:v,l:w}=Ce.add(this.Hh|0,this.Hl|0,v|0,w|0),this.set(r,s,i,o,a,c,u,l,d,h,f,p,g,m,v,w)}roundClean(){rs.fill(0),ss.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const Ux=ux(()=>new kx);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Cp=BigInt(0),gv=BigInt(1),Mx=BigInt(2);function _p(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Ap(t){if(!_p(t))throw new Error("Uint8Array expected")}function kd(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Lx=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ip(t){Ap(t);let e="";for(let n=0;n<t.length;n++)e+=Lx[t[n]];return e}function mv(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Cp:BigInt("0x"+t)}const Ur={_0:48,_9:57,A:65,F:70,a:97,f:102};function ym(t){if(t>=Ur._0&&t<=Ur._9)return t-Ur._0;if(t>=Ur.A&&t<=Ur.F)return t-(Ur.A-10);if(t>=Ur.a&&t<=Ur.f)return t-(Ur.a-10)}function yv(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=ym(t.charCodeAt(i)),a=ym(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function Bx(t){return mv(Ip(t))}function Du(t){return Ap(t),mv(Ip(Uint8Array.from(t).reverse()))}function wv(t,e){return yv(t.toString(16).padStart(e*2,"0"))}function Qh(t,e){return wv(t,e).reverse()}function Mr(t,e,n){let r;if(typeof e=="string")try{r=yv(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(_p(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function wm(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Ap(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const Ud=t=>typeof t=="bigint"&&Cp<=t;function Fx(t,e,n){return Ud(t)&&Ud(e)&&Ud(n)&&e<=t&&t<n}function Jo(t,e,n,r){if(!Fx(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function jx(t){let e;for(e=0;t>Cp;t>>=gv,e+=1);return e}const zx=t=>(Mx<<BigInt(t-1))-gv,qx={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||_p(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Sp(t,e,n={}){const r=(s,i,o)=>{const a=qx[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function bm(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const It=BigInt(0),ut=BigInt(1),Js=BigInt(2),Hx=BigInt(3),ef=BigInt(4),vm=BigInt(5),Em=BigInt(8);function mt(t,e){const n=t%e;return n>=It?n:e+n}function Wx(t,e,n){if(e<It)throw new Error("invalid exponent, negatives unsupported");if(n<=It)throw new Error("invalid modulus");if(n===ut)return It;let r=ut;for(;e>It;)e&ut&&(r=r*t%n),t=t*t%n,e>>=ut;return r}function ur(t,e,n){let r=t;for(;e-- >It;)r*=r,r%=n;return r}function Cm(t,e){if(t===It)throw new Error("invert: expected non-zero number");if(e<=It)throw new Error("invert: expected positive modulus, got "+e);let n=mt(t,e),r=e,s=It,i=ut;for(;n!==It;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==ut)throw new Error("invert: does not exist");return mt(s,e)}function Vx(t){const e=(t-ut)/Js;let n,r,s;for(n=t-ut,r=0;n%Js===It;n/=Js,r++);for(s=Js;s<t&&Wx(s,e,t)!==t-ut;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+ut)/ef;return function(a,c){const u=a.pow(c,o);if(!a.eql(a.sqr(u),c))throw new Error("Cannot find square root");return u}}const i=(n+ut)/Js;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,u=o.pow(o.mul(o.ONE,s),n),l=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(u,ut<<BigInt(c-h-1));u=o.sqr(f),l=o.mul(l,f),d=o.mul(d,u),c=h}return l}}function Gx(t){if(t%ef===Hx){const e=(t+ut)/ef;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%Em===vm){const e=(t-vm)/Em;return function(n,r){const s=n.mul(r,Js),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,Js),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return Vx(t)}const Kx=(t,e)=>(mt(t,e)&ut)===ut,Yx=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Zx(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=Yx.reduce((r,s)=>(r[s]="function",r),e);return Sp(t,n)}function Jx(t,e,n){if(n<It)throw new Error("invalid exponent, negatives unsupported");if(n===It)return t.ONE;if(n===ut)return e;let r=t.ONE,s=e;for(;n>It;)n&ut&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ut;return r}function Xx(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function bv(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function vv(t,e,n=!1,r={}){if(t<=It)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=bv(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:zx(s),ZERO:It,ONE:ut,create:c=>mt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return It<=c&&c<t},is0:c=>c===It,isOdd:c=>(c&ut)===ut,neg:c=>mt(-c,t),eql:(c,u)=>c===u,sqr:c=>mt(c*c,t),add:(c,u)=>mt(c+u,t),sub:(c,u)=>mt(c-u,t),mul:(c,u)=>mt(c*u,t),pow:(c,u)=>Jx(a,c,u),div:(c,u)=>mt(c*Cm(u,t),t),sqrN:c=>c*c,addN:(c,u)=>c+u,subN:(c,u)=>c-u,mulN:(c,u)=>c*u,inv:c=>Cm(c,t),sqrt:r.sqrt||(c=>(o||(o=Gx(t)),o(a,c))),invertBatch:c=>Xx(a,c),cmov:(c,u,l)=>l?u:c,toBytes:c=>n?Qh(c,i):wv(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Du(c):Bx(c)}});return Object.freeze(a)}const _m=BigInt(0),au=BigInt(1);function Md(t,e){const n=e.negate();return t?n:e}function Ev(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Ld(t,e){Ev(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function Qx(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function eP(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Bd=new WeakMap,Cv=new WeakMap;function Fd(t){return Cv.get(t)||1}function tP(t,e){return{constTimeNegate:Md,hasPrecomputes(n){return Fd(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>_m;)r&au&&(s=s.add(i)),i=i.double(),r>>=au;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Ld(r,e),o=[];let a=n,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=Ld(n,e);let a=t.ZERO,c=t.BASE;const u=BigInt(2**n-1),l=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&u);s>>=d,p>o&&(p-=l,s+=au);const g=f,m=f+Math.abs(p)-1,v=h%2!==0,w=p<0;p===0?c=c.add(Md(v,r[g])):a=a.add(Md(w,r[m]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=Ld(n,e),c=BigInt(2**n-1),u=2**n,l=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===_m)break;let f=Number(s&c);if(s>>=l,f>a&&(f-=u,s+=au),f===0)continue;let p=r[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=Bd.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&Bd.set(r,s(i))),i},wNAFCached(n,r,s){const i=Fd(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Fd(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){Ev(r,e),Cv.set(n,r),Bd.delete(n)}}}function nP(t,e,n,r){if(Qx(n,t),eP(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=jx(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),u=Math.floor((e.BITS-1)/o)*o;let l=s;for(let d=u;d>=0;d-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(l=l.add(h),d!==0)for(let f=0;f<o;f++)l=l.double()}return l}function rP(t){return Zx(t.Fp),Sp(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...bv(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Wn=BigInt(0),tn=BigInt(1),cu=BigInt(2),sP=BigInt(8),iP={zip215:!0};function oP(t){const e=rP(t);return Sp(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function aP(t){const e=oP(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,u=cu<<BigInt(a*8)-tn,l=n.create,d=vv(e.n,e.nBitLength),h=e.uvRatio||((C,I)=>{try{return{isValid:!0,value:n.sqrt(C*n.inv(I))}}catch{return{isValid:!1,value:Wn}}}),f=e.adjustScalarBytes||(C=>C),p=e.domain||((C,I,x)=>{if(kd("phflag",x),I.length||x)throw new Error("Contexts/pre-hash are not supported");return C});function g(C,I){Jo("coordinate "+C,I,Wn,u)}function m(C){if(!(C instanceof b))throw new Error("ExtendedPoint expected")}const v=bm((C,I)=>{const{ex:x,ey:R,ez:O}=C,M=C.is0();I==null&&(I=M?sP:n.inv(O));const z=l(x*I),Y=l(R*I),ee=l(O*I);if(M)return{x:Wn,y:tn};if(ee!==tn)throw new Error("invZ was invalid");return{x:z,y:Y}}),w=bm(C=>{const{a:I,d:x}=e;if(C.is0())throw new Error("bad point: ZERO");const{ex:R,ey:O,ez:M,et:z}=C,Y=l(R*R),ee=l(O*O),Z=l(M*M),ae=l(Z*Z),fe=l(Y*I),Fe=l(Z*l(fe+ee)),Me=l(ae+l(x*l(Y*ee)));if(Fe!==Me)throw new Error("bad point: equation left != right (1)");const Ie=l(R*O),ct=l(M*z);if(Ie!==ct)throw new Error("bad point: equation left != right (2)");return!0});class b{constructor(I,x,R,O){this.ex=I,this.ey=x,this.ez=R,this.et=O,g("x",I),g("y",x),g("z",R),g("t",O),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(I){if(I instanceof b)throw new Error("extended point not allowed");const{x,y:R}=I||{};return g("x",x),g("y",R),new b(x,R,tn,l(x*R))}static normalizeZ(I){const x=n.invertBatch(I.map(R=>R.ez));return I.map((R,O)=>R.toAffine(x[O])).map(b.fromAffine)}static msm(I,x){return nP(b,d,I,x)}_setWindowSize(I){T.setWindowSize(this,I)}assertValidity(){w(this)}equals(I){m(I);const{ex:x,ey:R,ez:O}=this,{ex:M,ey:z,ez:Y}=I,ee=l(x*Y),Z=l(M*O),ae=l(R*Y),fe=l(z*O);return ee===Z&&ae===fe}is0(){return this.equals(b.ZERO)}negate(){return new b(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:I}=e,{ex:x,ey:R,ez:O}=this,M=l(x*x),z=l(R*R),Y=l(cu*l(O*O)),ee=l(I*M),Z=x+R,ae=l(l(Z*Z)-M-z),fe=ee+z,Fe=fe-Y,Me=ee-z,Ie=l(ae*Fe),ct=l(fe*Me),St=l(ae*Me),js=l(Fe*fe);return new b(Ie,ct,js,St)}add(I){m(I);const{a:x,d:R}=e,{ex:O,ey:M,ez:z,et:Y}=this,{ex:ee,ey:Z,ez:ae,et:fe}=I;if(x===BigInt(-1)){const ig=l((M-O)*(Z+ee)),og=l((M+O)*(Z-ee)),hd=l(og-ig);if(hd===Wn)return this.double();const ag=l(z*cu*fe),cg=l(Y*cu*ae),ug=cg+ag,lg=og+ig,dg=cg-ag,SC=l(ug*hd),NC=l(lg*dg),TC=l(ug*dg),xC=l(hd*lg);return new b(SC,NC,xC,TC)}const Fe=l(O*ee),Me=l(M*Z),Ie=l(Y*R*fe),ct=l(z*ae),St=l((O+M)*(ee+Z)-Fe-Me),js=ct-Ie,Zc=ct+Ie,Ui=l(Me-x*Fe),dd=l(St*js),_C=l(Zc*Ui),AC=l(St*Ui),IC=l(js*Zc);return new b(dd,_C,IC,AC)}subtract(I){return this.add(I.negate())}wNAF(I){return T.wNAFCached(this,I,b.normalizeZ)}multiply(I){const x=I;Jo("scalar",x,tn,r);const{p:R,f:O}=this.wNAF(x);return b.normalizeZ([R,O])[0]}multiplyUnsafe(I,x=b.ZERO){const R=I;return Jo("scalar",R,Wn,r),R===Wn?_:this.is0()||R===tn?this:T.wNAFCachedUnsafe(this,R,b.normalizeZ,x)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return T.unsafeLadder(this,r).is0()}toAffine(I){return v(this,I)}clearCofactor(){const{h:I}=e;return I===tn?this:this.multiplyUnsafe(I)}static fromHex(I,x=!1){const{d:R,a:O}=e,M=n.BYTES;I=Mr("pointHex",I,M),kd("zip215",x);const z=I.slice(),Y=I[M-1];z[M-1]=Y&-129;const ee=Du(z),Z=x?u:n.ORDER;Jo("pointHex.y",ee,Wn,Z);const ae=l(ee*ee),fe=l(ae-tn),Fe=l(R*ae-O);let{isValid:Me,value:Ie}=h(fe,Fe);if(!Me)throw new Error("Point.fromHex: invalid y coordinate");const ct=(Ie&tn)===tn,St=(Y&128)!==0;if(!x&&Ie===Wn&&St)throw new Error("Point.fromHex: x=0 and x_0=1");return St!==ct&&(Ie=l(-Ie)),b.fromAffine({x:Ie,y:ee})}static fromPrivateKey(I){return A(I).point}toRawBytes(){const{x:I,y:x}=this.toAffine(),R=Qh(x,n.BYTES);return R[R.length-1]|=I&tn?128:0,R}toHex(){return Ip(this.toRawBytes())}}b.BASE=new b(e.Gx,e.Gy,tn,l(e.Gx*e.Gy)),b.ZERO=new b(Wn,tn,tn,Wn);const{BASE:S,ZERO:_}=b,T=tP(b,a*8);function N(C){return mt(C,r)}function D(C){return N(Du(C))}function A(C){const I=n.BYTES;C=Mr("private key",C,I);const x=Mr("hashed private key",i(C),2*I),R=f(x.slice(0,I)),O=x.slice(I,2*I),M=D(R),z=S.multiply(M),Y=z.toRawBytes();return{head:R,prefix:O,scalar:M,point:z,pointBytes:Y}}function U(C){return A(C).pointBytes}function P(C=new Uint8Array,...I){const x=wm(...I);return D(i(p(x,Mr("context",C),!!s)))}function k(C,I,x={}){C=Mr("message",C),s&&(C=s(C));const{prefix:R,scalar:O,pointBytes:M}=A(I),z=P(x.context,R,C),Y=S.multiply(z).toRawBytes(),ee=P(x.context,Y,M,C),Z=N(z+ee*O);Jo("signature.s",Z,Wn,r);const ae=wm(Y,Qh(Z,n.BYTES));return Mr("result",ae,n.BYTES*2)}const L=iP;function B(C,I,x,R=L){const{context:O,zip215:M}=R,z=n.BYTES;C=Mr("signature",C,2*z),I=Mr("message",I),x=Mr("publicKey",x,z),M!==void 0&&kd("zip215",M),s&&(I=s(I));const Y=Du(C.slice(z,2*z));let ee,Z,ae;try{ee=b.fromHex(x,M),Z=b.fromHex(C.slice(0,z),M),ae=S.multiplyUnsafe(Y)}catch{return!1}if(!M&&ee.isSmallOrder())return!1;const fe=P(O,Z.toRawBytes(),ee.toRawBytes(),I);return Z.add(ee.multiplyUnsafe(fe)).subtract(ae).clearCofactor().equals(b.ZERO)}return S._setWindowSize(8),{CURVE:e,getPublicKey:U,sign:k,verify:B,ExtendedPoint:b,utils:{getExtendedPublicKey:A,randomPrivateKey:()=>o(n.BYTES),precompute(C=8,I=b.BASE){return I._setWindowSize(C),I.multiply(BigInt(3)),I}}}}BigInt(0),BigInt(1);const Np=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Am=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const cP=BigInt(1),Im=BigInt(2);BigInt(3);const uP=BigInt(5),lP=BigInt(8);function dP(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Np,o=t*t%i*t%i,a=ur(o,Im,i)*o%i,c=ur(a,cP,i)*t%i,u=ur(c,uP,i)*c%i,l=ur(u,e,i)*u%i,d=ur(l,n,i)*l%i,h=ur(d,r,i)*d%i,f=ur(h,s,i)*h%i,p=ur(f,s,i)*h%i,g=ur(p,e,i)*u%i;return{pow_p_5_8:ur(g,Im,i)*t%i,b2:o}}function hP(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function fP(t,e){const n=Np,r=mt(e*e*e,n),s=mt(r*r*e,n),i=dP(t*s).pow_p_5_8;let o=mt(t*r*i,n);const a=mt(e*o*o,n),c=o,u=mt(o*Am,n),l=a===t,d=a===mt(-t,n),h=a===mt(-t*Am,n);return l&&(o=c),(d||h)&&(o=u),Kx(o,n)&&(o=mt(-o,n)),{isValid:l||d,value:o}}const pP=vv(Np,void 0,!0),gP={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:pP,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:lP,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Ux,randomBytes:fv,adjustScalarBytes:hP,uvRatio:fP},_v=aP(gP),mP="EdDSA",yP="JWT",sl=".",zl="base64url",Av="utf8",Iv="utf8",wP=":",bP="did",vP="key",Sm="base58btc",EP="z",CP="K36",_P=32;function Tp(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Sv(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Tp(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Nv(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=Sv(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Tp(n)}function AP(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,w=p.length;v!==w&&p[v]===0;)v++,g++;for(var b=(w-v)*l+1>>>0,S=new Uint8Array(b);v!==w;){for(var _=p[v],T=0,N=b-1;(_!==0||T<m)&&N!==-1;N--,T++)_+=256*S[N]>>>0,S[N]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");m=T,v++}for(var D=b-m;D!==b&&S[D]===0;)D++;for(var A=c.repeat(g);D<b;++D)A+=t.charAt(S[D]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===c;)m++,g++;for(var w=(p.length-g)*u+1>>>0,b=new Uint8Array(w);p[g];){var S=n[p.charCodeAt(g)];if(S===255)return;for(var _=0,T=w-1;(S!==0||_<v)&&T!==-1;T--,_++)S+=a*b[T]>>>0,b[T]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");v=_,g++}if(p[g]!==" "){for(var N=w-v;N!==w&&b[N]===0;)N++;for(var D=new Uint8Array(m+(w-N)),A=m;N!==w;)D[A++]=b[N++];return D}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var IP=AP,SP=IP;const Tv=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},NP=t=>new TextEncoder().encode(t),TP=t=>new TextDecoder().decode(t);let xP=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},PP=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return xv(this,e)}},OP=class{constructor(e){this.decoders=e}or(e){return xv(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const xv=(t,e)=>new OP({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let RP=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new xP(e,n,r),this.decoder=new PP(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const ql=({name:t,prefix:e,encode:n,decode:r})=>new RP(t,e,n,r),Fc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=SP(n,e);return ql({prefix:t,name:e,encode:r,decode:i=>Tv(s(i))})},DP=(t,e,n,r)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},$P=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},kt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>ql({prefix:e,name:t,encode(s){return $P(s,r,n)},decode(s){return DP(s,r,n,t)}}),kP=ql({prefix:"\0",name:"identity",encode:t=>TP(t),decode:t=>NP(t)});var UP=Object.freeze({__proto__:null,identity:kP});const MP=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var LP=Object.freeze({__proto__:null,base2:MP});const BP=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var FP=Object.freeze({__proto__:null,base8:BP});const jP=Fc({prefix:"9",name:"base10",alphabet:"0123456789"});var zP=Object.freeze({__proto__:null,base10:jP});const qP=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),HP=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var WP=Object.freeze({__proto__:null,base16:qP,base16upper:HP});const VP=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),GP=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),KP=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),YP=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ZP=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),JP=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),XP=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),QP=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),eO=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var tO=Object.freeze({__proto__:null,base32:VP,base32upper:GP,base32pad:KP,base32padupper:YP,base32hex:ZP,base32hexupper:JP,base32hexpad:XP,base32hexpadupper:QP,base32z:eO});const nO=Fc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),rO=Fc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var sO=Object.freeze({__proto__:null,base36:nO,base36upper:rO});const iO=Fc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),oO=Fc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var aO=Object.freeze({__proto__:null,base58btc:iO,base58flickr:oO});const cO=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),uO=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),lO=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),dO=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var hO=Object.freeze({__proto__:null,base64:cO,base64pad:uO,base64url:lO,base64urlpad:dO});const Pv=Array.from(""),fO=Pv.reduce((t,e,n)=>(t[n]=e,t),[]),pO=Pv.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function gO(t){return t.reduce((e,n)=>(e+=fO[n],e),"")}function mO(t){const e=[];for(const n of t){const r=pO[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const yO=ql({prefix:"",name:"base256emoji",encode:gO,decode:mO});var wO=Object.freeze({__proto__:null,base256emoji:yO}),bO=Ov,Nm=128,vO=-128,EO=Math.pow(2,31);function Ov(t,e,n){e=e||[],n=n||0;for(var r=n;t>=EO;)e[n++]=t&255|Nm,t/=128;for(;t&vO;)e[n++]=t&255|Nm,t>>>=7;return e[n]=t|0,Ov.bytes=n-r+1,e}var CO=tf,_O=128,Tm=127;function tf(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw tf.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Tm)<<s:(o&Tm)*Math.pow(2,s),s+=7}while(o>=_O);return tf.bytes=i-r,n}var AO=Math.pow(2,7),IO=Math.pow(2,14),SO=Math.pow(2,21),NO=Math.pow(2,28),TO=Math.pow(2,35),xO=Math.pow(2,42),PO=Math.pow(2,49),OO=Math.pow(2,56),RO=Math.pow(2,63),DO=function(t){return t<AO?1:t<IO?2:t<SO?3:t<NO?4:t<TO?5:t<xO?6:t<PO?7:t<OO?8:t<RO?9:10},$O={encode:bO,decode:CO,encodingLength:DO},Rv=$O;const xm=(t,e,n=0)=>(Rv.encode(t,e,n),e),Pm=t=>Rv.encodingLength(t),nf=(t,e)=>{const n=e.byteLength,r=Pm(t),s=r+Pm(n),i=new Uint8Array(s+n);return xm(t,i,0),xm(n,i,r),i.set(e,s),new kO(t,n,e,i)};let kO=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const Dv=({name:t,code:e,encode:n})=>new UO(t,e,n);let UO=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?nf(this.code,n):n.then(r=>nf(this.code,r))}else throw Error("Unknown type, must be binary type")}};const $v=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),MO=Dv({name:"sha2-256",code:18,encode:$v("SHA-256")}),LO=Dv({name:"sha2-512",code:19,encode:$v("SHA-512")});var BO=Object.freeze({__proto__:null,sha256:MO,sha512:LO});const kv=0,FO="identity",Uv=Tv,jO=t=>nf(kv,Uv(t)),zO={code:kv,name:FO,encode:Uv,digest:jO};var qO=Object.freeze({__proto__:null,identity:zO});new TextEncoder,new TextDecoder;const Om={...UP,...LP,...FP,...zP,...WP,...tO,...sO,...aO,...hO,...wO};({...BO,...qO});function Mv(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Rm=Mv("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),jd=Mv("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=Sv(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),Lv={utf8:Rm,"utf-8":Rm,hex:Om.base16,latin1:jd,ascii:jd,binary:jd,...Om};function Hl(t,e="utf8"){const n=Lv[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function ko(t,e="utf8"){const n=Lv[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Tp(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Dm(t){return bi(Hl(ko(t,zl),Av))}function il(t){return Hl(ko(Jr(t),Av),zl)}function Bv(t){const e=ko(CP,Sm),n=EP+Hl(Nv([e,t]),Sm);return[bP,vP,n].join(wP)}function HO(t){return Hl(t,zl)}function WO(t){return ko(t,zl)}function VO(t){return ko([il(t.header),il(t.payload)].join(sl),Iv)}function GO(t){return[il(t.header),il(t.payload),HO(t.signature)].join(sl)}function rf(t){const e=t.split(sl),n=Dm(e[0]),r=Dm(e[1]),s=WO(e[2]),i=ko(e.slice(0,2).join(sl),Iv);return{header:n,payload:r,signature:s,data:i}}function $m(t=fv(_P)){const e=_v.getPublicKey(t);return{secretKey:Nv([t,e]),publicKey:e}}async function KO(t,e,n,r,s=V.fromMiliseconds(Date.now())){const i={alg:mP,typ:yP},o=Bv(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},u=VO({header:i,payload:c}),l=_v.sign(u,r.secretKey.slice(0,32));return GO({header:i,payload:c,signature:l})}var km=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},YO=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),ZO=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),JO=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),XO=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),QO=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),eR=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,tR=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Um=3,nR=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",eR]],Mm=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function rR(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new QO:typeof navigator<"u"?iR(navigator.userAgent):aR()}function sR(t){return t!==""&&nR.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function iR(t){var e=sR(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new XO;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<Um&&(s=km(km([],s,!0),cR(Um-s.length),!0)):s=[];var i=s.join("."),o=oR(t),a=tR.exec(t);return a&&a[1]?new JO(n,i,o,a[1]):new YO(n,i,o)}function oR(t){for(var e=0,n=Mm.length;e<n;e++){var r=Mm[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function aR(){var t=typeof process<"u"&&process.version;return t?new ZO(process.version.slice(1)):null}function cR(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var Je={};Object.defineProperty(Je,"__esModule",{value:!0});Je.getLocalStorage=Je.getLocalStorageOrThrow=Je.getCrypto=Je.getCryptoOrThrow=Fv=Je.getLocation=Je.getLocationOrThrow=xp=Je.getNavigator=Je.getNavigatorOrThrow=vi=Je.getDocument=Je.getDocumentOrThrow=Je.getFromWindowOrThrow=Je.getFromWindow=void 0;function Di(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Je.getFromWindow=Di;function Uo(t){const e=Di(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Je.getFromWindowOrThrow=Uo;function uR(){return Uo("document")}Je.getDocumentOrThrow=uR;function lR(){return Di("document")}var vi=Je.getDocument=lR;function dR(){return Uo("navigator")}Je.getNavigatorOrThrow=dR;function hR(){return Di("navigator")}var xp=Je.getNavigator=hR;function fR(){return Uo("location")}Je.getLocationOrThrow=fR;function pR(){return Di("location")}var Fv=Je.getLocation=pR;function gR(){return Uo("crypto")}Je.getCryptoOrThrow=gR;function mR(){return Di("crypto")}Je.getCrypto=mR;function yR(){return Uo("localStorage")}Je.getLocalStorageOrThrow=yR;function wR(){return Di("localStorage")}Je.getLocalStorage=wR;var Pp={};Object.defineProperty(Pp,"__esModule",{value:!0});var jv=Pp.getWindowMetadata=void 0;const Lm=Je;function bR(){let t,e;try{t=Lm.getDocumentOrThrow(),e=Lm.getLocationOrThrow()}catch{return null}function n(){const d=t.getElementsByTagName("link"),h=[];for(let f=0;f<d.length;f++){const p=d[f],g=p.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const m=p.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let v=e.protocol+"//"+e.host;if(m.indexOf("/")===0)v+=m;else{const w=e.pathname.split("/");w.pop();const b=w.join("/");v+=b+"/"+m}h.push(v)}else if(m.indexOf("//")===0){const v=e.protocol+m;h.push(v)}else h.push(m)}}return h}function r(...d){const h=t.getElementsByTagName("meta");for(let f=0;f<h.length;f++){const p=h[f],g=["itemprop","property","name"].map(m=>p.getAttribute(m)).filter(m=>m?d.includes(m):!1);if(g.length&&g){const m=p.getAttribute("content");if(m)return m}}return""}function s(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,u=n();return{description:a,url:c,icons:u,name:o}}jv=Pp.getWindowMetadata=bR;function cc(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function sf(t){return cc(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const zv="2.31.0";let Xo={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${zv}`},Wl=class of extends Error{constructor(e,n={}){var a;const r=(()=>{var c;return n.cause instanceof of?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof of&&n.cause.docsPath||n.docsPath,i=(a=Xo.getDocsUrl)==null?void 0:a.call(Xo,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Xo.version?[`Version: ${Xo.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=zv}walk(e){return qv(this,e)}};function qv(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?qv(t.cause,e):e?null:t}class Hv extends Wl{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Mo(t,{dir:e,size:n=32}={}){return typeof t=="string"?vR(t,{dir:e,size:n}):ER(t,{dir:e,size:n})}function vR(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new Hv({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function ER(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new Hv({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}class CR extends Wl{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class _R extends Wl{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Lo(t,{size:e}){if(sf(t)>e)throw new _R({givenSize:sf(t),maxSize:e})}function af(t,e={}){const{signed:n}=e;e.size&&Lo(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function AR(t,e={}){return Number(af(t,e))}const IR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function cf(t,e={}){return typeof t=="number"||typeof t=="bigint"?Vv(t,e):typeof t=="string"?TR(t,e):typeof t=="boolean"?SR(t,e):Wv(t,e)}function SR(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Lo(n,{size:e.size}),Mo(n,{size:e.size})):n}function Wv(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=IR[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Lo(r,{size:e.size}),Mo(r,{dir:"right",size:e.size})):r}function Vv(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new CR({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Mo(a,{size:r}):a}const NR=new TextEncoder;function TR(t,e={}){const n=NR.encode(t);return Wv(n,e)}const xR=new TextEncoder;function PR(t,e={}){return typeof t=="number"||typeof t=="bigint"?RR(t,e):typeof t=="boolean"?OR(t,e):cc(t)?Gv(t,e):Kv(t,e)}function OR(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Lo(n,{size:e.size}),Mo(n,{size:e.size})):n}const Lr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Bm(t){if(t>=Lr.zero&&t<=Lr.nine)return t-Lr.zero;if(t>=Lr.A&&t<=Lr.F)return t-(Lr.A-10);if(t>=Lr.a&&t<=Lr.f)return t-(Lr.a-10)}function Gv(t,e={}){let n=t;e.size&&(Lo(n,{size:e.size}),n=Mo(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Bm(r.charCodeAt(a++)),u=Bm(r.charCodeAt(a++));if(c===void 0||u===void 0)throw new Wl(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+u}return i}function RR(t,e){const n=Vv(t,e);return Gv(n)}function Kv(t,e={}){const n=xR.encode(t);return typeof e.size=="number"?(Lo(n,{size:e.size}),Mo(n,{dir:"right",size:e.size})):n}function Yv(t,e){const n=e||"hex",r=J0(cc(t,{strict:!1})?PR(t):t);return n==="bytes"?r:cf(r)}class DR extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const zd=new DR(8192);function $R(t,e){if(zd.has(`${t}.${e}`))return zd.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),r=Yv(Kv(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return zd.set(`${t}.${e}`,i),i}function kR(t){const e=Yv(`0x${t.substring(4)}`).substring(26);return $R(`0x${e}`)}async function UR({hash:t,signature:e}){const n=cc(t)?t:cf(t),{secp256k1:r}=await Ht(async()=>{const{secp256k1:o}=await import("./DcooX2_W.js");return{secp256k1:o}},__vite__mapDeps([5,1,2]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:u,s:l,v:d,yParity:h}=e,f=Number(h??d),p=Fm(f);return new r.Signature(af(u),af(l)).addRecoveryBit(p)}const o=cc(e)?e:cf(e);if(sf(o)!==65)throw new Error("invalid signature length");const a=AR(`0x${o.slice(130)}`),c=Fm(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function Fm(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function MR({hash:t,signature:e}){return kR(await UR({hash:t,signature:e}))}function LR(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let u=0;u<e.length;u++)e[u]=255;for(let u=0;u<t.length;u++){const l=t.charAt(u),d=l.charCodeAt(0);if(e[d]!==255)throw new TypeError(l+" is ambiguous");e[d]=u}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";let l=0,d=0,h=0;const f=u.length;for(;h!==f&&u[h]===0;)h++,l++;const p=(f-h)*i+1>>>0,g=new Uint8Array(p);for(;h!==f;){let w=u[h],b=0;for(let S=p-1;(w!==0||b<d)&&S!==-1;S--,b++)w+=256*g[S]>>>0,g[S]=w%n>>>0,w=w/n>>>0;if(w!==0)throw new Error("Non-zero carry");d=b,h++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let v=r.repeat(l);for(;m<p;++m)v+=t.charAt(g[m]);return v}function a(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;let l=0,d=0,h=0;for(;u[l]===r;)d++,l++;const f=(u.length-l)*s+1>>>0,p=new Uint8Array(f);for(;l<u.length;){const w=u.charCodeAt(l);if(w>255)return;let b=e[w];if(b===255)return;let S=0;for(let _=f-1;(b!==0||S<h)&&_!==-1;_--,S++)b+=n*p[_]>>>0,p[_]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");h=S,l++}let g=f-h;for(;g!==f&&p[g]===0;)g++;const m=new Uint8Array(d+(f-g));let v=d;for(;g!==f;)m[v++]=p[g++];return m}function c(u){const l=a(u);if(l)return l;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var BR="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Bo=LR(BR);function FR(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function jR(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const zR=new TextEncoder,qR=50;function HR(t,e,n){zR.encodeInto(t,e.subarray(n))}function WR(t,e,n){t.length>qR?HR(t,e,n):jR(t,e,n)}const VR=4096;function Zv(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if(!(a&128))i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,u=t[r++]&63;i.push((a&31)<<12|c<<6|u)}else if((a&248)===240){const c=t[r++]&63,u=t[r++]&63,l=t[r++]&63;let d=(a&7)<<18|c<<12|u<<6|l;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=VR&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const GR=new TextDecoder,KR=200;function YR(t,e,n){const r=t.subarray(e,e+n);return GR.decode(r)}function ZR(t,e,n){return n>KR?YR(t,e,n):Zv(t,e,n)}class uu{constructor(e,n){this.type=e,this.data=n}}class bn extends Error{constructor(e){super(e);const n=Object.create(bn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:bn.name})}}const Qo=4294967295;function JR(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function Jv(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function Xv(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function XR(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const QR=-1,e3=4294967296-1,t3=17179869184-1;function n3({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=t3)if(e===0&&t<=e3){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),Jv(r,4,t),n}}function r3(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function s3(t){if(t instanceof Date){const e=r3(t);return n3(e)}else return null}function i3(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=Xv(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new bn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function o3(t){const e=i3(t);return new Date(e.sec*1e3+e.nsec/1e6)}const a3={type:QR,encode:s3,decode:o3};class ol{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(a3)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new uu(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new uu(o,i)}}}return e instanceof uu?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new uu(n,e)}}ol.defaultCodec=new ol;function c3(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function uf(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):c3(t)?new Uint8Array(t):Uint8Array.from(t)}const u3=100,l3=2048;let d3=class Qv{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??ol.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??u3,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??l3,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new Qv({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=FR(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),WR(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=uf(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),JR(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),Jv(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function h3(t,e){return new d3(e).encodeSharedRef(t)}function qd(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const f3=16,p3=16;class g3{constructor(e=f3,n=p3){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=Zv(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const lf="array",_a="map_key",eE="map_value",m3=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new bn("The type of key must be string or number but "+typeof t)};class y3{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=lf,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=_a,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===lf){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===_a||e.type===eE){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const ea=-1,Op=new DataView(new ArrayBuffer(0)),w3=new Uint8Array(Op.buffer);try{Op.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const jm=new RangeError("Insufficient data"),b3=new g3;let v3=class tE{constructor(e){this.totalPos=0,this.pos=0,this.view=Op,this.bytes=w3,this.headByte=ea,this.stack=new y3,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??ol.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??Qo,this.maxBinLength=(e==null?void 0:e.maxBinLength)??Qo,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??Qo,this.maxMapLength=(e==null?void 0:e.maxMapLength)??Qo,this.maxExtLength=(e==null?void 0:e.maxExtLength)??Qo,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:b3,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??m3}clone(){return new tE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=ea,this.stack.reset()}setBuffer(e){const n=uf(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===ea&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=uf(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${qd(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new bn(`Unrecognized type byte: ${qd(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===lf)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===_a){if(n==="__proto__")throw new bn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=eE;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=_a;continue e}}return n}}readHeadByte(){return this.headByte===ea&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=ea}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new bn(`Unrecognized array type byte: ${qd(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new bn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new bn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){var i;if(e>this.maxStrLength)throw new bn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw jm;const r=this.pos+n;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,r,e):s=ZR(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===_a:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new bn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw jm;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new bn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=XR(this.view,this.pos);return this.pos+=8,e}readI64(){const e=Xv(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function E3(t,e){return new v3(e).decode(t)}function Rp(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function nE(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Rp(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Aa(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=nE(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Rp(n)}function C3(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,w=p.length;v!==w&&p[v]===0;)v++,g++;for(var b=(w-v)*l+1>>>0,S=new Uint8Array(b);v!==w;){for(var _=p[v],T=0,N=b-1;(_!==0||T<m)&&N!==-1;N--,T++)_+=256*S[N]>>>0,S[N]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");m=T,v++}for(var D=b-m;D!==b&&S[D]===0;)D++;for(var A=c.repeat(g);D<b;++D)A+=t.charAt(S[D]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===c;)m++,g++;for(var w=(p.length-g)*u+1>>>0,b=new Uint8Array(w);p[g];){var S=n[p.charCodeAt(g)];if(S===255)return;for(var _=0,T=w-1;(S!==0||_<v)&&T!==-1;T--,_++)S+=a*b[T]>>>0,b[T]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");v=_,g++}if(p[g]!==" "){for(var N=w-v;N!==w&&b[N]===0;)N++;for(var D=new Uint8Array(m+(w-N)),A=m;N!==w;)D[A++]=b[N++];return D}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var _3=C3,A3=_3;const I3=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},S3=t=>new TextEncoder().encode(t),N3=t=>new TextDecoder().decode(t);class T3{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class x3{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return rE(this,e)}}class P3{constructor(e){this.decoders=e}or(e){return rE(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const rE=(t,e)=>new P3({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class O3{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new T3(e,n,r),this.decoder=new x3(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Vl=({name:t,prefix:e,encode:n,decode:r})=>new O3(t,e,n,r),jc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=A3(n,e);return Vl({prefix:t,name:e,encode:r,decode:i=>I3(s(i))})},R3=(t,e,n,r)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},D3=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ut=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Vl({prefix:e,name:t,encode(s){return D3(s,r,n)},decode(s){return R3(s,r,n,t)}}),$3=Vl({prefix:"\0",name:"identity",encode:t=>N3(t),decode:t=>S3(t)}),k3=Object.freeze(Object.defineProperty({__proto__:null,identity:$3},Symbol.toStringTag,{value:"Module"})),U3=Ut({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),M3=Object.freeze(Object.defineProperty({__proto__:null,base2:U3},Symbol.toStringTag,{value:"Module"})),L3=Ut({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),B3=Object.freeze(Object.defineProperty({__proto__:null,base8:L3},Symbol.toStringTag,{value:"Module"})),F3=jc({prefix:"9",name:"base10",alphabet:"0123456789"}),j3=Object.freeze(Object.defineProperty({__proto__:null,base10:F3},Symbol.toStringTag,{value:"Module"})),z3=Ut({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q3=Ut({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),H3=Object.freeze(Object.defineProperty({__proto__:null,base16:z3,base16upper:q3},Symbol.toStringTag,{value:"Module"})),W3=Ut({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),V3=Ut({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),G3=Ut({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),K3=Ut({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Y3=Ut({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Z3=Ut({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),J3=Ut({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),X3=Ut({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Q3=Ut({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),e5=Object.freeze(Object.defineProperty({__proto__:null,base32:W3,base32hex:Y3,base32hexpad:J3,base32hexpadupper:X3,base32hexupper:Z3,base32pad:G3,base32padupper:K3,base32upper:V3,base32z:Q3},Symbol.toStringTag,{value:"Module"})),t5=jc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),n5=jc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),r5=Object.freeze(Object.defineProperty({__proto__:null,base36:t5,base36upper:n5},Symbol.toStringTag,{value:"Module"})),s5=jc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),i5=jc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),o5=Object.freeze(Object.defineProperty({__proto__:null,base58btc:s5,base58flickr:i5},Symbol.toStringTag,{value:"Module"})),a5=Ut({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),c5=Ut({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),u5=Ut({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),l5=Ut({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),d5=Object.freeze(Object.defineProperty({__proto__:null,base64:a5,base64pad:c5,base64url:u5,base64urlpad:l5},Symbol.toStringTag,{value:"Module"})),sE=Array.from(""),h5=sE.reduce((t,e,n)=>(t[n]=e,t),[]),f5=sE.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function p5(t){return t.reduce((e,n)=>(e+=h5[n],e),"")}function g5(t){const e=[];for(const n of t){const r=f5[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const m5=Vl({prefix:"",name:"base256emoji",encode:p5,decode:g5}),y5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:m5},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const zm={...k3,...M3,...B3,...j3,...H3,...e5,...r5,...o5,...d5,...y5};function iE(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const qm=iE("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Hd=iE("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=nE(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),oE={utf8:qm,"utf-8":qm,hex:zm.base16,latin1:Hd,ascii:Hd,binary:Hd,...zm};function Mn(t,e="utf8"){const n=oE[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Rp(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function fn(t,e="utf8"){const n=oE[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const w5={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},b5="Input must be an string, Buffer or Uint8Array";function v5(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(b5);return e}function E5(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function lu(t){return(4294967296+t).toString(16).substring(1)}function C5(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=lu(e[s]).toUpperCase(),r+=" ",r+=lu(e[s+1]).toUpperCase();else if(n===64)r+=lu(e[s+1]).toUpperCase(),r+=lu(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function _5(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<n;o++){const a=t(s),c=new Date().getTime(),u=c-r;r=c,console.log("Hashed in "+u+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(u/1e3)*100)/100+" MB PER SECOND")}}var aE={normalizeInput:v5,toHex:E5,debugPrint:C5,testSpeed:_5};const $u=aE;function du(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function Hm(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function cE(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function is(t,e,n,r,s,i){const o=pa[s],a=pa[s+1],c=pa[i],u=pa[i+1];du(ve,t,e),Hm(ve,t,o,a);let l=ve[r]^ve[t],d=ve[r+1]^ve[t+1];ve[r]=d,ve[r+1]=l,du(ve,n,r),l=ve[e]^ve[n],d=ve[e+1]^ve[n+1],ve[e]=l>>>24^d<<8,ve[e+1]=d>>>24^l<<8,du(ve,t,e),Hm(ve,t,c,u),l=ve[r]^ve[t],d=ve[r+1]^ve[t+1],ve[r]=l>>>16^d<<16,ve[r+1]=d>>>16^l<<16,du(ve,n,r),l=ve[e]^ve[n],d=ve[e+1]^ve[n+1],ve[e]=d>>>31^l<<1,ve[e+1]=l>>>31^d<<1}const uE=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),A5=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],Lt=new Uint8Array(A5.map(function(t){return t*2})),ve=new Uint32Array(32),pa=new Uint32Array(32);function lE(t,e){let n=0;for(n=0;n<16;n++)ve[n]=t.h[n],ve[n+16]=uE[n];for(ve[24]=ve[24]^t.t,ve[25]=ve[25]^t.t/4294967296,e&&(ve[28]=~ve[28],ve[29]=~ve[29]),n=0;n<32;n++)pa[n]=cE(t.b,4*n);for(n=0;n<12;n++)is(0,8,16,24,Lt[n*16+0],Lt[n*16+1]),is(2,10,18,26,Lt[n*16+2],Lt[n*16+3]),is(4,12,20,28,Lt[n*16+4],Lt[n*16+5]),is(6,14,22,30,Lt[n*16+6],Lt[n*16+7]),is(0,10,20,30,Lt[n*16+8],Lt[n*16+9]),is(2,12,22,24,Lt[n*16+10],Lt[n*16+11]),is(4,14,16,26,Lt[n*16+12],Lt[n*16+13]),is(6,8,18,28,Lt[n*16+14],Lt[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^ve[n]^ve[n+16]}const os=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function dE(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};os.fill(0),os[0]=t,e&&(os[1]=e.length),os[2]=1,os[3]=1,n&&os.set(n,32),r&&os.set(r,48);for(let i=0;i<16;i++)s.h[i]=uE[i]^cE(os,i*4);return e&&(Dp(s,e),s.c=128),s}function Dp(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,lE(t,!1),t.c=0),t.b[t.c++]=e[n]}function hE(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;lE(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function fE(t,e,n,r,s){n=n||64,t=$u.normalizeInput(t),r&&(r=$u.normalizeInput(r)),s&&(s=$u.normalizeInput(s));const i=dE(n,e,r,s);return Dp(i,t),hE(i)}function I5(t,e,n,r,s){const i=fE(t,e,n,r,s);return $u.toHex(i)}var S5={blake2b:fE,blake2bHex:I5,blake2bInit:dE,blake2bUpdate:Dp,blake2bFinal:hE};const pE=aE;function N5(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function as(t,e,n,r,s,i){De[t]=De[t]+De[e]+s,De[r]=hu(De[r]^De[t],16),De[n]=De[n]+De[r],De[e]=hu(De[e]^De[n],12),De[t]=De[t]+De[e]+i,De[r]=hu(De[r]^De[t],8),De[n]=De[n]+De[r],De[e]=hu(De[e]^De[n],7)}function hu(t,e){return t>>>e^t<<32-e}const gE=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Bt=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),De=new Uint32Array(16),Nt=new Uint32Array(16);function mE(t,e){let n=0;for(n=0;n<8;n++)De[n]=t.h[n],De[n+8]=gE[n];for(De[12]^=t.t,De[13]^=t.t/4294967296,e&&(De[14]=~De[14]),n=0;n<16;n++)Nt[n]=N5(t.b,4*n);for(n=0;n<10;n++)as(0,4,8,12,Nt[Bt[n*16+0]],Nt[Bt[n*16+1]]),as(1,5,9,13,Nt[Bt[n*16+2]],Nt[Bt[n*16+3]]),as(2,6,10,14,Nt[Bt[n*16+4]],Nt[Bt[n*16+5]]),as(3,7,11,15,Nt[Bt[n*16+6]],Nt[Bt[n*16+7]]),as(0,5,10,15,Nt[Bt[n*16+8]],Nt[Bt[n*16+9]]),as(1,6,11,12,Nt[Bt[n*16+10]],Nt[Bt[n*16+11]]),as(2,7,8,13,Nt[Bt[n*16+12]],Nt[Bt[n*16+13]]),as(3,4,9,14,Nt[Bt[n*16+14]],Nt[Bt[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=De[n]^De[n+8]}function yE(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(gE),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&($p(r,e),r.c=64),r}function $p(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,mE(t,!1),t.c=0),t.b[t.c++]=e[n]}function wE(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;mE(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function bE(t,e,n){n=n||32,t=pE.normalizeInput(t);const r=yE(n,e);return $p(r,t),wE(r)}function T5(t,e,n){const r=bE(t,e,n);return pE.toHex(r)}var x5={blake2s:bE,blake2sHex:T5,blake2sInit:yE,blake2sUpdate:$p,blake2sFinal:wE};const ta=S5,na=x5;var P5={blake2b:ta.blake2b,blake2bHex:ta.blake2bHex,blake2bInit:ta.blake2bInit,blake2bUpdate:ta.blake2bUpdate,blake2bFinal:ta.blake2bFinal,blake2s:na.blake2s,blake2sHex:na.blake2sHex,blake2sInit:na.blake2sInit,blake2sUpdate:na.blake2sUpdate,blake2sFinal:na.blake2sFinal},O5={};const R5=":";function po(t){const[e,n]=t.split(R5);return{namespace:e,reference:n}}function vE(t,e){return t.includes(":")?[t]:e.chains||[]}var D5=Object.defineProperty,$5=Object.defineProperties,k5=Object.getOwnPropertyDescriptors,Wm=Object.getOwnPropertySymbols,U5=Object.prototype.hasOwnProperty,M5=Object.prototype.propertyIsEnumerable,Vm=(t,e,n)=>e in t?D5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gm=(t,e)=>{for(var n in e||(e={}))U5.call(e,n)&&Vm(t,n,e[n]);if(Wm)for(var n of Wm(e))M5.call(e,n)&&Vm(t,n,e[n]);return t},L5=(t,e)=>$5(t,k5(e));const B5="ReactNative",_n={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},F5="js";function al(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Fs(){return!vi()&&!!xp()&&navigator.product===B5}function j5(){return Fs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function z5(){return Fs()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function Fo(){return!al()&&!!xp()&&!!vi()}function zc(){return Fs()?_n.reactNative:al()?_n.node:Fo()?_n.browser:_n.unknown}function Km(){var t;try{return Fs()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function q5(t,e){const n=new URLSearchParams(t);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&n.set(r,s)}return n.toString()}function H5(t){var e,n;const r=EE();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),L5(Gm(Gm({},r),t),{url:(t==null?void 0:t.url)||r.url,name:(t==null?void 0:t.name)||r.name,description:(t==null?void 0:t.description)||r.description,icons:(n=t==null?void 0:t.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function EE(){return jv()||{name:"",description:"",url:"",icons:[""]}}function W5(){if(zc()===_n.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=rR();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function V5(){var t;const e=zc();return e===_n.browser?[e,((t=Fv())==null?void 0:t.host)||"unknown"].join(":"):e}function CE(t,e,n){const r=W5(),s=V5();return[[t,e].join("-"),[F5,n].join("-"),r,s].join("/")}function G5({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const u=n.split("?"),l=CE(t,e,r),d={auth:s,ua:l,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=q5(u[1]||"",d);return u[0]+"?"+h}function ri(t,e){return t.filter(n=>e.includes(n)).length===t.length}function df(t){return Object.fromEntries(t.entries())}function hf(t){return new Map(Object.entries(t))}function Zs(t=V.FIVE_MINUTES,e){const n=V.toMiliseconds(t||V.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const u=new Error(e);o=Promise.reject(u),c(u)},n),r=a,s=c})}}function Cs(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function _E(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function K5(t){return _E("topic",t)}function Y5(t){return _E("id",t)}function AE(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function pt(t,e){return V.fromMiliseconds(Date.now()+V.toMiliseconds(t))}function ps(t){return Date.now()>=V.toMiliseconds(t)}function je(t,e){return`${t}${e?`:${e}`:""}`}function Ir(t=[],e=[]){return[...new Set([...t,...e])]}async function Z5({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=J5(i,t,e),a=zc();if(a===_n.browser){if(!((r=vi())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}X5(o)}else a===_n.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function J5(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${n6(r,!0)}`}else s=`${s}/wc?${r}`;return s}function X5(t){let e="_self";t6()?e="_top":(e6()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function Q5(t,e){let n="";try{if(Fo()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function Ym(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function Zm(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function kp(){return typeof process<"u"&&O5.IS_VITEST==="true"}function e6(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function t6(){try{return window.self!==window.top}catch{return!1}}function n6(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function IE(t){return Buffer.from(t,"base64").toString("utf-8")}function r6(t){return new Promise(e=>setTimeout(e,t))}const fu=BigInt(2**32-1),Jm=BigInt(32);function SE(t,e=!1){return e?{h:Number(t&fu),l:Number(t>>Jm&fu)}:{h:Number(t>>Jm&fu)|0,l:Number(t&fu)|0}}function NE(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=SE(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const Xm=(t,e,n)=>t>>>n,Qm=(t,e,n)=>t<<32-n|e>>>n,gs=(t,e,n)=>t>>>n|e<<32-n,ms=(t,e,n)=>t<<32-n|e>>>n,ga=(t,e,n)=>t<<64-n|e>>>n-32,ma=(t,e,n)=>t>>>n-32|e<<64-n,s6=(t,e)=>e,i6=(t,e)=>t,o6=(t,e,n)=>t<<n|e>>>32-n,a6=(t,e,n)=>e<<n|t>>>32-n,c6=(t,e,n)=>e<<n-32|t>>>64-n,u6=(t,e,n)=>t<<n-32|e>>>64-n;function Zn(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Up=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),Mp=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,l6=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),d6=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,h6=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),f6=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,zi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Lp(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Xr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Bn(t,...e){if(!Lp(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Bp(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Xr(t.outputLen),Xr(t.blockLen)}function Us(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Fp(t,e){Bn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function uc(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Fn(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Wd(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function lr(t,e){return t<<32-e|t>>>e}const TE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function xE(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const zr=TE?t=>t:t=>xE(t);function p6(t){for(let e=0;e<t.length;e++)t[e]=xE(t[e]);return t}const ys=TE?t=>t:p6,PE=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",g6=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function lc(t){if(Bn(t),PE)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=g6[t[n]];return e}const Br={_0:48,_9:57,A:65,F:70,a:97,f:102};function ey(t){if(t>=Br._0&&t<=Br._9)return t-Br._0;if(t>=Br.A&&t<=Br.F)return t-(Br.A-10);if(t>=Br.a&&t<=Br.f)return t-(Br.a-10)}function jp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(PE)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=ey(t.charCodeAt(i)),a=ey(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function m6(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function tr(t){return typeof t=="string"&&(t=m6(t)),Bn(t),t}function si(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Bn(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let Gl=class{};function qc(t){const e=r=>t().update(tr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function y6(t){const e=(r,s)=>t(s).update(tr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function jo(t=32){if(zi&&typeof zi.getRandomValues=="function")return zi.getRandomValues(new Uint8Array(t));if(zi&&typeof zi.randomBytes=="function")return Uint8Array.from(zi.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const w6=BigInt(0),ra=BigInt(1),b6=BigInt(2),v6=BigInt(7),E6=BigInt(256),C6=BigInt(113),OE=[],RE=[],DE=[];for(let t=0,e=ra,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],OE.push(2*(5*r+n)),RE.push((t+1)*(t+2)/2%64);let s=w6;for(let i=0;i<7;i++)e=(e<<ra^(e>>v6)*C6)%E6,e&b6&&(s^=ra<<(ra<<BigInt(i))-ra);DE.push(s)}const $E=NE(DE,!0),_6=$E[0],A6=$E[1],ty=(t,e,n)=>n>32?c6(t,e,n):o6(t,e,n),ny=(t,e,n)=>n>32?u6(t,e,n):a6(t,e,n);function I6(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,u=n[c],l=n[c+1],d=ty(u,l,1)^n[a],h=ny(u,l,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=RE[o],c=ty(s,i,a),u=ny(s,i,a),l=OE[o];s=t[l],i=t[l+1],t[l]=c,t[l+1]=u}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=_6[r],t[1]^=A6[r]}Fn(n)}let S6=class kE extends Gl{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Xr(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=uc(this.state)}clone(){return this._cloneInto()}keccak(){ys(this.state32),I6(this.state32,this.rounds),ys(this.state32),this.posOut=0,this.pos=0}update(e){Us(this),e=tr(e),Bn(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Us(this,!1),Bn(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Xr(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(Fp(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Fn(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new kE(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const N6=(t,e,n)=>qc(()=>new S6(e,t,n)),T6=N6(1,136,256/8);function x6(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,u=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+u,a,r)}function P6(t,e,n){return t&e^~t&n}function O6(t,e,n){return t&e^t&n^e&n}let UE=class extends Gl{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Wd(this.buffer)}update(e){Us(this),e=tr(e),Bn(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Wd(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Us(this),Fp(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Fn(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;x6(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Wd(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=c/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<u;d++)a.setUint32(4*d,l[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const cs=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ft=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),jt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),R6=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),us=new Uint32Array(64);let D6=class extends UE{constructor(e=32){super(64,e,8,!1),this.A=cs[0]|0,this.B=cs[1]|0,this.C=cs[2]|0,this.D=cs[3]|0,this.E=cs[4]|0,this.F=cs[5]|0,this.G=cs[6]|0,this.H=cs[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)us[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=us[d-15],f=us[d-2],p=lr(h,7)^lr(h,18)^h>>>3,g=lr(f,17)^lr(f,19)^f>>>10;us[d]=g+us[d-7]+p+us[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:u,H:l}=this;for(let d=0;d<64;d++){const h=lr(a,6)^lr(a,11)^lr(a,25),f=l+h+P6(a,c,u)+R6[d]+us[d]|0,p=(lr(r,2)^lr(r,13)^lr(r,22))+O6(r,s,i)|0;l=u,u=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(r,s,i,o,a,c,u,l)}roundClean(){Fn(us)}destroy(){this.set(0,0,0,0,0,0,0,0),Fn(this.buffer)}};const ME=NE(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),$6=ME[0],k6=ME[1],ls=new Uint32Array(80),ds=new Uint32Array(80);let zp=class extends UE{constructor(e=64){super(128,e,16,!1),this.Ah=jt[0]|0,this.Al=jt[1]|0,this.Bh=jt[2]|0,this.Bl=jt[3]|0,this.Ch=jt[4]|0,this.Cl=jt[5]|0,this.Dh=jt[6]|0,this.Dl=jt[7]|0,this.Eh=jt[8]|0,this.El=jt[9]|0,this.Fh=jt[10]|0,this.Fl=jt[11]|0,this.Gh=jt[12]|0,this.Gl=jt[13]|0,this.Hh=jt[14]|0,this.Hl=jt[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:u,El:l,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,u,l,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,u,l,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=u|0,this.El=l|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let b=0;b<16;b++,n+=4)ls[b]=e.getUint32(n),ds[b]=e.getUint32(n+=4);for(let b=16;b<80;b++){const S=ls[b-15]|0,_=ds[b-15]|0,T=gs(S,_,1)^gs(S,_,8)^Xm(S,_,7),N=ms(S,_,1)^ms(S,_,8)^Qm(S,_,7),D=ls[b-2]|0,A=ds[b-2]|0,U=gs(D,A,19)^ga(D,A,61)^Xm(D,A,6),P=ms(D,A,19)^ma(D,A,61)^Qm(D,A,6),k=l6(N,P,ds[b-7],ds[b-16]),L=d6(k,T,U,ls[b-7],ls[b-16]);ls[b]=L|0,ds[b]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:u,Dl:l,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:v,Hl:w}=this;for(let b=0;b<80;b++){const S=gs(d,h,14)^gs(d,h,18)^ga(d,h,41),_=ms(d,h,14)^ms(d,h,18)^ma(d,h,41),T=d&f^~d&g,N=h&p^~h&m,D=h6(w,_,N,k6[b],ds[b]),A=f6(D,v,S,T,$6[b],ls[b]),U=D|0,P=gs(r,s,28)^ga(r,s,34)^ga(r,s,39),k=ms(r,s,28)^ma(r,s,34)^ma(r,s,39),L=r&i^r&a^i&a,B=s&o^s&c^o&c;v=g|0,w=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Zn(u|0,l|0,A|0,U|0),u=a|0,l=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const C=Up(U,k,B);r=Mp(C,A,P,L),s=C|0}({h:r,l:s}=Zn(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Zn(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Zn(this.Ch|0,this.Cl|0,a|0,c|0),{h:u,l}=Zn(this.Dh|0,this.Dl|0,u|0,l|0),{h:d,l:h}=Zn(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Zn(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Zn(this.Gh|0,this.Gl|0,g|0,m|0),{h:v,l:w}=Zn(this.Hh|0,this.Hl|0,v|0,w|0),this.set(r,s,i,o,a,c,u,l,d,h,f,p,g,m,v,w)}roundClean(){Fn(ls,ds)}destroy(){Fn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},U6=class extends zp{constructor(){super(48),this.Ah=Ft[0]|0,this.Al=Ft[1]|0,this.Bh=Ft[2]|0,this.Bl=Ft[3]|0,this.Ch=Ft[4]|0,this.Cl=Ft[5]|0,this.Dh=Ft[6]|0,this.Dl=Ft[7]|0,this.Eh=Ft[8]|0,this.El=Ft[9]|0,this.Fh=Ft[10]|0,this.Fl=Ft[11]|0,this.Gh=Ft[12]|0,this.Gl=Ft[13]|0,this.Hh=Ft[14]|0,this.Hl=Ft[15]|0}};const zt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);let M6=class extends zp{constructor(){super(32),this.Ah=zt[0]|0,this.Al=zt[1]|0,this.Bh=zt[2]|0,this.Bl=zt[3]|0,this.Ch=zt[4]|0,this.Cl=zt[5]|0,this.Dh=zt[6]|0,this.Dl=zt[7]|0,this.Eh=zt[8]|0,this.El=zt[9]|0,this.Fh=zt[10]|0,this.Fl=zt[11]|0,this.Gh=zt[12]|0,this.Gl=zt[13]|0,this.Hh=zt[14]|0,this.Hl=zt[15]|0}};const Kl=qc(()=>new D6),L6=qc(()=>new zp),B6=qc(()=>new U6),F6=qc(()=>new M6),j6=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),ft=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Q=new Uint32Array(32);function hs(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=Q[2*t],u=Q[2*t+1],l=Q[2*e],d=Q[2*e+1],h=Q[2*n],f=Q[2*n+1],p=Q[2*r],g=Q[2*r+1],m=Up(c,l,o);u=Mp(m,u,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^u,Dl:p^c},{Dh:g,Dl:p}={Dh:s6(g,p),Dl:i6(g)},{h:f,l:h}=Zn(f,h,g,p),{Bh:d,Bl:l}={Bh:d^f,Bl:l^h},{Bh:d,Bl:l}={Bh:gs(d,l,24),Bl:ms(d,l,24)},Q[2*t]=c,Q[2*t+1]=u,Q[2*e]=l,Q[2*e+1]=d,Q[2*n]=h,Q[2*n+1]=f,Q[2*r]=p,Q[2*r+1]=g}function fs(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=Q[2*t],u=Q[2*t+1],l=Q[2*e],d=Q[2*e+1],h=Q[2*n],f=Q[2*n+1],p=Q[2*r],g=Q[2*r+1],m=Up(c,l,o);u=Mp(m,u,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^u,Dl:p^c},{Dh:g,Dl:p}={Dh:gs(g,p,16),Dl:ms(g,p,16)},{h:f,l:h}=Zn(f,h,g,p),{Bh:d,Bl:l}={Bh:d^f,Bl:l^h},{Bh:d,Bl:l}={Bh:ga(d,l,63),Bl:ma(d,l,63)},Q[2*t]=c,Q[2*t+1]=u,Q[2*e]=l,Q[2*e+1]=d,Q[2*n]=h,Q[2*n+1]=f,Q[2*r]=p,Q[2*r+1]=g}function z6(t,e={},n,r,s){if(Xr(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class q6 extends Gl{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Xr(e),Xr(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=uc(this.buffer)}update(e){Us(this),e=tr(e),Bn(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(ys(s),this.compress(s,0,!1),ys(s),this.pos=0);const u=Math.min(n-this.pos,i-c),l=o+c;if(u===n&&!(l%4)&&c+u<i){const d=new Uint32Array(a,l,Math.floor((i-c)/4));ys(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);ys(d);continue}r.set(e.subarray(c,c+u),this.pos),this.pos+=u,this.length+=u,c+=u}return this}digestInto(e){Us(this),Fp(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Fn(this.buffer.subarray(n)),ys(r),this.compress(r,0,!0),ys(r);const s=uc(e);this.get().forEach((i,o)=>s[o]=zr(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class H6 extends q6{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=ft[0]|0,this.v0h=ft[1]|0,this.v1l=ft[2]|0,this.v1h=ft[3]|0,this.v2l=ft[4]|0,this.v2h=ft[5]|0,this.v3l=ft[6]|0,this.v3h=ft[7]|0,this.v4l=ft[8]|0,this.v4h=ft[9]|0,this.v5l=ft[10]|0,this.v5h=ft[11]|0,this.v6l=ft[12]|0,this.v6h=ft[13]|0,this.v7l=ft[14]|0,this.v7h=ft[15]|0,z6(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=tr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=tr(i);const a=uc(i);this.v4l^=zr(a[0]),this.v4h^=zr(a[1]),this.v5l^=zr(a[2]),this.v5h^=zr(a[3])}if(s!==void 0){s=tr(s);const a=uc(s);this.v6l^=zr(a[0]),this.v6h^=zr(a[1]),this.v7l^=zr(a[2]),this.v7h^=zr(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:u,v4h:l,v5l:d,v5h:h,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,n,r,s,i,o,a,c,u,l,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,u,l,d,h,f,p,g,m){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=u|0,this.v4h=l|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,n,r){this.get().forEach((c,u)=>Q[u]=c),Q.set(ft,16);let{h:s,l:i}=SE(BigInt(this.length));Q[24]=ft[8]^i,Q[25]=ft[9]^s,r&&(Q[28]=~Q[28],Q[29]=~Q[29]);let o=0;const a=j6;for(let c=0;c<12;c++)hs(0,4,8,12,e,n+2*a[o++]),fs(0,4,8,12,e,n+2*a[o++]),hs(1,5,9,13,e,n+2*a[o++]),fs(1,5,9,13,e,n+2*a[o++]),hs(2,6,10,14,e,n+2*a[o++]),fs(2,6,10,14,e,n+2*a[o++]),hs(3,7,11,15,e,n+2*a[o++]),fs(3,7,11,15,e,n+2*a[o++]),hs(0,5,10,15,e,n+2*a[o++]),fs(0,5,10,15,e,n+2*a[o++]),hs(1,6,11,12,e,n+2*a[o++]),fs(1,6,11,12,e,n+2*a[o++]),hs(2,7,8,13,e,n+2*a[o++]),fs(2,7,8,13,e,n+2*a[o++]),hs(3,4,9,14,e,n+2*a[o++]),fs(3,4,9,14,e,n+2*a[o++]);this.v0l^=Q[0]^Q[16],this.v0h^=Q[1]^Q[17],this.v1l^=Q[2]^Q[18],this.v1h^=Q[3]^Q[19],this.v2l^=Q[4]^Q[20],this.v2h^=Q[5]^Q[21],this.v3l^=Q[6]^Q[22],this.v3h^=Q[7]^Q[23],this.v4l^=Q[8]^Q[24],this.v4h^=Q[9]^Q[25],this.v5l^=Q[10]^Q[26],this.v5h^=Q[11]^Q[27],this.v6l^=Q[12]^Q[28],this.v6h^=Q[13]^Q[29],this.v7l^=Q[14]^Q[30],this.v7h^=Q[15]^Q[31],Fn(Q)}destroy(){this.destroyed=!0,Fn(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const W6=y6(t=>new H6(t)),V6="https://rpc.walletconnect.org/v1";function LE(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(T6(n)).toString("hex")}async function G6(t,e,n,r,s,i){switch(n.t){case"eip191":return await K6(t,e,n.s);case"eip1271":return await Y6(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function K6(t,e,n){return(await MR({hash:LE(e),signature:n})).toLowerCase()===t.toLowerCase()}async function Y6(t,e,n,r,s,i){const o=po(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",u=n.substring(2),l=(u.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:LE(e)).substring(2),h=a+d+c+l+u,f=await fetch(`${i||V6}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Z6(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function Z6(){return Date.now()+Math.floor(Math.random()*1e3)}function J6(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Bo.encode(i)}function X6(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=W6(r,{dkLen:32});return Bo.encode(s)}function ry(t){const e=new Uint8Array(Kl(Q6(t)));return Bo.encode(e)}function Q6(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function sy(t){const e=Buffer.from(t,"base64"),n=E3(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=h3(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=F6(i);return PC.encode(o).replace(/=+$/,"")}function Vd(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function eD(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Vd(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Vd(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(Vd(r.length)),s.push(r);const i=Buffer.concat(s),o=Kl(i);return Buffer.from(o).toString("hex").toUpperCase()}var tD=Object.defineProperty,nD=Object.defineProperties,rD=Object.getOwnPropertyDescriptors,iy=Object.getOwnPropertySymbols,sD=Object.prototype.hasOwnProperty,iD=Object.prototype.propertyIsEnumerable,oy=(t,e,n)=>e in t?tD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oD=(t,e)=>{for(var n in e||(e={}))sD.call(e,n)&&oy(t,n,e[n]);if(iy)for(var n of iy(e))iD.call(e,n)&&oy(t,n,e[n]);return t},aD=(t,e)=>nD(t,rD(e));const cD="did:pkh:",qp=t=>t==null?void 0:t.split(":"),uD=t=>{const e=t&&qp(t);if(e)return t.includes(cD)?e[3]:e[1]},ff=t=>{const e=t&&qp(t);if(e)return e[2]+":"+e[3]},cl=t=>{const e=t&&qp(t);if(e)return e.pop()};async function ay(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=BE(s,s.iss),o=cl(s.iss);return await G6(o,i,r,ff(s.iss),n)}const BE=(t,e)=>{const n=`${t.domain} wants you to sign in with your Ethereum account:`,r=cl(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${uD(e)}`,c=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,l=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,f=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=ku(t.resources);if(p){const g=dc(p);s=wD(s,g)}return[n,r,"",s,"",i,o,a,c,u,l,d,h,f].filter(g=>g!=null).join(`
`)};function lD(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function dD(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Ei(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function hD(t,e,n,r={}){return n==null||n.sort((s,i)=>s.localeCompare(i)),{att:{[t]:fD(e,n,r)}}}function fD(t,e,n={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function FE(t){return Ei(t),`urn:recap:${lD(t).replace(/=/g,"")}`}function dc(t){const e=dD(t.replace("urn:recap:",""));return Ei(e),e}function pD(t,e,n){const r=hD(t,e,n);return FE(r)}function gD(t){return t&&t.includes("urn:recap:")}function mD(t,e){const n=dc(t),r=dc(e),s=yD(n,r);return FE(s)}function yD(t,e){Ei(t),Ei(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,u;r.att[s]=aD(oD({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((u=e.att[s])==null?void 0:u[a])})})}),r}function wD(t="",e){Ei(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const u={};c.forEach(d=>{u[d.ability]||(u[d.ability]=[]),u[d.ability].push(d.action)});const l=Object.keys(u).map(d=>(s++,`(${s}) '${d}': '${u[d].join("', '")}' for '${a}'.`));r.push(l.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function cy(t){var e;const n=dc(t);Ei(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function uy(t){const e=dc(t);Ei(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function ku(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return gD(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function jE(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function pf(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function Gd(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function ln(t,...e){if(!jE(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ly(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function bD(t,e){ln(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Ns(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ao(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function vD(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const ED=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function CD(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function gf(t){if(typeof t=="string")t=CD(t);else if(jE(t))t=mf(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function _D(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function AD(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const ID=(t,e)=>{function n(r,...s){if(ln(r),!ED)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const u=s[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?ln(u):ln(u,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&ln(s[1]);const o=e(r,...s),a=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");ln(l)}};let c=!1;return{encrypt(u,l){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,ln(u),a(o.encrypt.length,l),o.encrypt(u,l)},decrypt(u,l){if(ln(u),i&&u.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,l),o.decrypt(u,l)}}}return Object.assign(n,t),n};function dy(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!ND(e))throw new Error("invalid output, must be aligned");return e}function hy(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function SD(t,e,n){pf(n);const r=new Uint8Array(16),s=vD(r);return hy(s,0,BigInt(e),n),hy(s,8,BigInt(t),n),r}function ND(t){return t.byteOffset%4===0}function mf(t){return Uint8Array.from(t)}const zE=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),TD=zE("expand 16-byte k"),xD=zE("expand 32-byte k"),PD=Ns(TD),OD=Ns(xD);function Oe(t,e){return t<<e|t>>>32-e}function yf(t){return t.byteOffset%4===0}const pu=64,RD=16,qE=2**32-1,fy=new Uint32Array;function DD(t,e,n,r,s,i,o,a){const c=s.length,u=new Uint8Array(pu),l=Ns(u),d=yf(s)&&yf(i),h=d?Ns(s):fy,f=d?Ns(i):fy;for(let p=0;p<c;o++){if(t(e,n,r,l,o,a),o>=qE)throw new Error("arx: counter overflow");const g=Math.min(pu,c-p);if(d&&g===pu){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let v=0,w;v<RD;v++)w=m+v,f[w]=h[w]^l[v];p+=pu;continue}for(let m=0,v;m<g;m++)v=p+m,i[v]=s[v]^u[m];p+=g}}function $D(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=_D({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Gd(s),Gd(o),pf(i),pf(n),(a,c,u,l,d=0)=>{ln(a),ln(c),ln(u);const h=u.length;if(l===void 0&&(l=new Uint8Array(h)),ln(l),Gd(d),d<0||d>=qE)throw new Error("arx: counter overflow");if(l.length<h)throw new Error(`arx: output (${l.length}) is shorter than data (${h})`);const f=[];let p=a.length,g,m;if(p===32)f.push(g=mf(a)),m=OD;else if(p===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),m=PD,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);yf(c)||f.push(c=mf(c));const v=Ns(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,v,Ns(c.subarray(0,16)),v),c=c.subarray(16)}const w=16-s;if(w!==c.length)throw new Error(`arx: nonce must be ${w} or 16 bytes`);if(w!==12){const S=new Uint8Array(12);S.set(c,i?0:12-c.length),c=S,f.push(c)}const b=Ns(c);return DD(t,m,v,b,u,l,d,o),Ao(...f),l}}const Tt=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class kD{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=gf(e),ln(e,32);const n=Tt(e,0),r=Tt(e,2),s=Tt(e,4),i=Tt(e,6),o=Tt(e,8),a=Tt(e,10),c=Tt(e,12),u=Tt(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=Tt(e,16+2*l)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],u=o[2],l=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],v=Tt(e,n+0),w=Tt(e,n+2),b=Tt(e,n+4),S=Tt(e,n+6),_=Tt(e,n+8),T=Tt(e,n+10),N=Tt(e,n+12),D=Tt(e,n+14);let A=i[0]+(v&8191),U=i[1]+((v>>>13|w<<3)&8191),P=i[2]+((w>>>10|b<<6)&8191),k=i[3]+((b>>>7|S<<9)&8191),L=i[4]+((S>>>4|_<<12)&8191),B=i[5]+(_>>>1&8191),C=i[6]+((_>>>14|T<<2)&8191),I=i[7]+((T>>>11|N<<5)&8191),x=i[8]+((N>>>8|D<<8)&8191),R=i[9]+(D>>>5|s),O=0,M=O+A*a+U*(5*m)+P*(5*g)+k*(5*p)+L*(5*f);O=M>>>13,M&=8191,M+=B*(5*h)+C*(5*d)+I*(5*l)+x*(5*u)+R*(5*c),O+=M>>>13,M&=8191;let z=O+A*c+U*a+P*(5*m)+k*(5*g)+L*(5*p);O=z>>>13,z&=8191,z+=B*(5*f)+C*(5*h)+I*(5*d)+x*(5*l)+R*(5*u),O+=z>>>13,z&=8191;let Y=O+A*u+U*c+P*a+k*(5*m)+L*(5*g);O=Y>>>13,Y&=8191,Y+=B*(5*p)+C*(5*f)+I*(5*h)+x*(5*d)+R*(5*l),O+=Y>>>13,Y&=8191;let ee=O+A*l+U*u+P*c+k*a+L*(5*m);O=ee>>>13,ee&=8191,ee+=B*(5*g)+C*(5*p)+I*(5*f)+x*(5*h)+R*(5*d),O+=ee>>>13,ee&=8191;let Z=O+A*d+U*l+P*u+k*c+L*a;O=Z>>>13,Z&=8191,Z+=B*(5*m)+C*(5*g)+I*(5*p)+x*(5*f)+R*(5*h),O+=Z>>>13,Z&=8191;let ae=O+A*h+U*d+P*l+k*u+L*c;O=ae>>>13,ae&=8191,ae+=B*a+C*(5*m)+I*(5*g)+x*(5*p)+R*(5*f),O+=ae>>>13,ae&=8191;let fe=O+A*f+U*h+P*d+k*l+L*u;O=fe>>>13,fe&=8191,fe+=B*c+C*a+I*(5*m)+x*(5*g)+R*(5*p),O+=fe>>>13,fe&=8191;let Fe=O+A*p+U*f+P*h+k*d+L*l;O=Fe>>>13,Fe&=8191,Fe+=B*u+C*c+I*a+x*(5*m)+R*(5*g),O+=Fe>>>13,Fe&=8191;let Me=O+A*g+U*p+P*f+k*h+L*d;O=Me>>>13,Me&=8191,Me+=B*l+C*u+I*c+x*a+R*(5*m),O+=Me>>>13,Me&=8191;let Ie=O+A*m+U*g+P*p+k*f+L*h;O=Ie>>>13,Ie&=8191,Ie+=B*d+C*l+I*u+x*c+R*a,O+=Ie>>>13,Ie&=8191,O=(O<<2)+O|0,O=O+M|0,M=O&8191,O=O>>>13,z+=O,i[0]=M,i[1]=z,i[2]=Y,i[3]=ee,i[4]=Z,i[5]=ae,i[6]=fe,i[7]=Fe,i[8]=Me,i[9]=Ie}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;Ao(r)}update(e){ly(this),e=gf(e),ln(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){Ao(this.h,this.r,this.buffer,this.pad)}digestInto(e){ly(this),bD(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function UD(t){const e=(r,s)=>t(s).update(gf(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const MD=UD(t=>new kD(t));function LD(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],u=t[3],l=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],v=e[7],w=s,b=n[0],S=n[1],_=n[2],T=o,N=a,D=c,A=u,U=l,P=d,k=h,L=f,B=p,C=g,I=m,x=v,R=w,O=b,M=S,z=_;for(let ee=0;ee<i;ee+=2)T=T+U|0,R=Oe(R^T,16),B=B+R|0,U=Oe(U^B,12),T=T+U|0,R=Oe(R^T,8),B=B+R|0,U=Oe(U^B,7),N=N+P|0,O=Oe(O^N,16),C=C+O|0,P=Oe(P^C,12),N=N+P|0,O=Oe(O^N,8),C=C+O|0,P=Oe(P^C,7),D=D+k|0,M=Oe(M^D,16),I=I+M|0,k=Oe(k^I,12),D=D+k|0,M=Oe(M^D,8),I=I+M|0,k=Oe(k^I,7),A=A+L|0,z=Oe(z^A,16),x=x+z|0,L=Oe(L^x,12),A=A+L|0,z=Oe(z^A,8),x=x+z|0,L=Oe(L^x,7),T=T+P|0,z=Oe(z^T,16),I=I+z|0,P=Oe(P^I,12),T=T+P|0,z=Oe(z^T,8),I=I+z|0,P=Oe(P^I,7),N=N+k|0,R=Oe(R^N,16),x=x+R|0,k=Oe(k^x,12),N=N+k|0,R=Oe(R^N,8),x=x+R|0,k=Oe(k^x,7),D=D+L|0,O=Oe(O^D,16),B=B+O|0,L=Oe(L^B,12),D=D+L|0,O=Oe(O^D,8),B=B+O|0,L=Oe(L^B,7),A=A+U|0,M=Oe(M^A,16),C=C+M|0,U=Oe(U^C,12),A=A+U|0,M=Oe(M^A,8),C=C+M|0,U=Oe(U^C,7);let Y=0;r[Y++]=o+T|0,r[Y++]=a+N|0,r[Y++]=c+D|0,r[Y++]=u+A|0,r[Y++]=l+U|0,r[Y++]=d+P|0,r[Y++]=h+k|0,r[Y++]=f+L|0,r[Y++]=p+B|0,r[Y++]=g+C|0,r[Y++]=m+I|0,r[Y++]=v+x|0,r[Y++]=w+R|0,r[Y++]=b+O|0,r[Y++]=S+M|0,r[Y++]=_+z|0}const BD=$D(LD,{counterRight:!1,counterLength:4,allowShortKeys:!1}),FD=new Uint8Array(16),py=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(FD.subarray(n))},jD=new Uint8Array(32);function gy(t,e,n,r,s){const i=t(e,n,jD),o=MD.create(i);s&&py(o,s),py(o,r);const a=SD(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return Ao(i,a),c}const zD=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=dy(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=gy(t,e,n,a,r);return i.set(c,o),Ao(c),i},decrypt(s,i){i=dy(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=gy(t,e,n,o,r);if(!AD(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),Ao(c),i}}),HE=ID({blockSize:64,nonceLength:12,tagLength:16},zD(BD));let WE=class extends Gl{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,Bp(e);const r=tr(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Fn(i)}update(e){return Us(this),this.iHash.update(e),this}digestInto(e){Us(this),Bn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Yl=(t,e,n)=>new WE(t,e).update(n).digest();Yl.create=(t,e)=>new WE(t,e);function qD(t,e,n){return Bp(t),n===void 0&&(n=new Uint8Array(t.outputLen)),Yl(t,tr(n),tr(e))}const Kd=Uint8Array.from([0]),my=Uint8Array.of();function HD(t,e,n,r=32){Bp(t),Xr(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=my);const o=new Uint8Array(i*s),a=Yl.create(t,e),c=a._cloneInto(),u=new Uint8Array(a.outputLen);for(let l=0;l<i;l++)Kd[0]=l+1,c.update(l===0?my:u).update(n).update(Kd).digestInto(u),o.set(u,s*l),a._cloneInto(c);return a.destroy(),c.destroy(),Fn(u,Kd),o.slice(0,r)}const WD=(t,e,n,r,s)=>HD(t,qD(t,e,n),r,s),Zl=Kl,Hp=BigInt(0),wf=BigInt(1);function ul(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function gu(t){const e=t.toString(16);return e.length&1?"0"+e:e}function VE(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Hp:BigInt("0x"+t)}function Jl(t){return VE(lc(t))}function ll(t){return Bn(t),VE(lc(Uint8Array.from(t).reverse()))}function Wp(t,e){return jp(t.toString(16).padStart(e*2,"0"))}function Vp(t,e){return Wp(t,e).reverse()}function un(t,e,n){let r;if(typeof e=="string")try{r=jp(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Lp(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const Yd=t=>typeof t=="bigint"&&Hp<=t;function VD(t,e,n){return Yd(t)&&Yd(e)&&Yd(n)&&e<=t&&t<n}function bf(t,e,n,r){if(!VD(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function GD(t){let e;for(e=0;t>Hp;t>>=wf,e+=1);return e}const Xl=t=>(wf<<BigInt(t))-wf;function KD(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},u=(...h)=>n(o,i,...h),l=(h=r(0))=>{o=u(s(0),h),i=u(),h.length!==0&&(o=u(s(1),h),i=u())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){i=u();const p=i.slice();f.push(p),h+=i.length}return si(...f)};return(h,f)=>{c(),l(h);let p;for(;!(p=f(d()));)l();return c(),p}}function Ql(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function yy(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const dn=BigInt(0),Gt=BigInt(1),ii=BigInt(2),YD=BigInt(3),GE=BigInt(4),KE=BigInt(5),YE=BigInt(8);function kn(t,e){const n=t%e;return n>=dn?n:e+n}function Yn(t,e,n){let r=t;for(;e-- >dn;)r*=r,r%=n;return r}function wy(t,e){if(t===dn)throw new Error("invert: expected non-zero number");if(e<=dn)throw new Error("invert: expected positive modulus, got "+e);let n=kn(t,e),r=e,s=dn,i=Gt;for(;n!==dn;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Gt)throw new Error("invert: does not exist");return kn(s,e)}function ZE(t,e){const n=(t.ORDER+Gt)/GE,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function ZD(t,e){const n=(t.ORDER-KE)/YE,r=t.mul(e,ii),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,ii),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function JD(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Gt,n=0;for(;e%ii===dn;)e/=ii,n++;let r=ii;const s=zo(t);for(;by(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return ZE;let i=s.pow(r,e);const o=(e+Gt)/ii;return function(a,c){if(a.is0(c))return c;if(by(a,c)!==1)throw new Error("Cannot find square root");let u=n,l=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===u)throw new Error("Cannot find square root");const g=Gt<<BigInt(u-f-1),m=a.pow(l,g);u=f,l=a.sqr(m),d=a.mul(d,l),h=a.mul(h,m)}return h}}function XD(t){return t%GE===YD?ZE:t%YE===KE?ZD:JD(t)}const QD=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function e$(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=QD.reduce((r,s)=>(r[s]="function",r),e);return Ql(t,n),t}function t$(t,e,n){if(n<dn)throw new Error("invalid exponent, negatives unsupported");if(n===dn)return t.ONE;if(n===Gt)return e;let r=t.ONE,s=e;for(;n>dn;)n&Gt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Gt;return r}function JE(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function by(t,e){const n=(t.ORDER-Gt)/ii,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function n$(t,e){e!==void 0&&Xr(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function zo(t,e,n=!1,r={}){if(t<=dn)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const l=e;l.BITS&&(s=l.BITS),l.sqrt&&(i=l.sqrt),typeof l.isLE=="boolean"&&(n=l.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=n$(t,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:a,MASK:Xl(o),ZERO:dn,ONE:Gt,create:l=>kn(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return dn<=l&&l<t},is0:l=>l===dn,isValidNot0:l=>!u.is0(l)&&u.isValid(l),isOdd:l=>(l&Gt)===Gt,neg:l=>kn(-l,t),eql:(l,d)=>l===d,sqr:l=>kn(l*l,t),add:(l,d)=>kn(l+d,t),sub:(l,d)=>kn(l-d,t),mul:(l,d)=>kn(l*d,t),pow:(l,d)=>t$(u,l,d),div:(l,d)=>kn(l*wy(d,t),t),sqrN:l=>l*l,addN:(l,d)=>l+d,subN:(l,d)=>l-d,mulN:(l,d)=>l*d,inv:l=>wy(l,t),sqrt:i||(l=>(c||(c=XD(t)),c(u,l))),toBytes:l=>n?Vp(l,a):Wp(l,a),fromBytes:l=>{if(l.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+l.length);return n?ll(l):Jl(l)},invertBatch:l=>JE(u,l),cmov:(l,d,h)=>h?d:l});return Object.freeze(u)}function XE(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function QE(t){const e=XE(t);return e+Math.ceil(e/2)}function r$(t,e,n=!1){const r=t.length,s=XE(e),i=QE(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?ll(t):Jl(t),a=kn(o,e-Gt)+Gt;return n?Vp(a,s):Wp(a,s)}const Io=BigInt(0),oi=BigInt(1);function Ia(t,e){const n=e.negate();return t?n:e}function s$(t,e,n){const r=i=>i.pz,s=JE(t.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(t.fromAffine)}function e1(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Zd(t,e){e1(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Xl(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function vy(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=oi);const u=e*r,l=u+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:l,isZero:d,isNeg:h,isNegF:f,offsetF:u}}function i$(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function o$(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Jd=new WeakMap,t1=new WeakMap;function Xd(t){return t1.get(t)||1}function Ey(t){if(t!==Io)throw new Error("invalid wNAF")}function a$(t,e){return{constTimeNegate:Ia,hasPrecomputes(n){return Xd(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>Io;)r&oi&&(s=s.add(i)),i=i.double(),r>>=oi;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=Zd(r,e),o=[];let a=n,c=a;for(let u=0;u<s;u++){c=a,o.push(c);for(let l=1;l<i;l++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=Zd(n,e);for(let c=0;c<a.windows;c++){const{nextN:u,offset:l,isZero:d,isNeg:h,isNegF:f,offsetF:p}=vy(s,c,a);s=u,d?o=o.add(Ia(f,r[p])):i=i.add(Ia(h,r[l]))}return Ey(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=Zd(n,e);for(let a=0;a<o.windows&&s!==Io;a++){const{nextN:c,offset:u,isZero:l,isNeg:d}=vy(s,a,o);if(s=c,!l){const h=r[u];i=i.add(d?h.negate():h)}}return Ey(s),i},getPrecomputes(n,r,s){let i=Jd.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),Jd.set(r,i))),i},wNAFCached(n,r,s){const i=Xd(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=Xd(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){e1(r,e),t1.set(n,r),Jd.delete(n)}}}function c$(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>Io||r>Io;)n&oi&&(i=i.add(s)),r&oi&&(o=o.add(s)),s=s.double(),n>>=oi,r>>=oi;return{p1:i,p2:o}}function u$(t,e,n,r){i$(n,t),o$(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=GD(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const u=Xl(c),l=new Array(Number(u)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let f=d;f>=0;f-=c){l.fill(o);for(let g=0;g<i;g++){const m=r[g],v=Number(m>>BigInt(f)&u);l[v]=l[v].add(n[g])}let p=o;for(let g=l.length-1,m=o;g>0;g--)m=m.add(l[g]),p=p.add(m);if(h=h.add(p),f!==0)for(let g=0;g<c;g++)h=h.double()}return h}function Cy(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return e$(e),e}else return zo(t)}function l$(t,e,n={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>Io))throw new Error(`CURVE.${o} must be positive bigint`)}const r=Cy(e.p,n.Fp),s=Cy(e.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const sa=BigInt(0),qi=BigInt(1),mu=BigInt(2);function d$(t){return Ql(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function h$(t){const e=d$(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||jo,u=a?255:448,l=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?mu**BigInt(254):mu**BigInt(447),p=a?BigInt(8)*mu**BigInt(251)-qi:BigInt(4)*mu**BigInt(445)-qi,g=f+p+qi,m=A=>kn(A,n),v=w(d);function w(A){return Vp(m(A),l)}function b(A){const U=un("u coordinate",A,l);return a&&(U[31]&=127),m(ll(U))}function S(A){return ll(s(un("scalar",A,l)))}function _(A,U){const P=D(b(U),S(A));if(P===sa)throw new Error("invalid private or public key received");return w(P)}function T(A){return _(A,v)}function N(A,U,P){const k=m(A*(U-P));return U=m(U-k),P=m(P+k),{x_2:U,x_3:P}}function D(A,U){bf("u",A,sa,n),bf("scalar",U,f,g);const P=U,k=A;let L=qi,B=sa,C=A,I=qi,x=sa;for(let O=BigInt(u-1);O>=sa;O--){const M=P>>O&qi;x^=M,{x_2:L,x_3:C}=N(x,L,C),{x_2:B,x_3:I}=N(x,B,I),x=M;const z=L+B,Y=m(z*z),ee=L-B,Z=m(ee*ee),ae=Y-Z,fe=C+I,Fe=C-I,Me=m(Fe*z),Ie=m(fe*ee),ct=Me+Ie,St=Me-Ie;C=m(ct*ct),I=m(k*m(St*St)),L=m(Y*Z),B=m(ae*(Y+m(h*ae)))}({x_2:L,x_3:C}=N(x,L,C)),{x_2:B,x_3:I}=N(x,B,I);const R=i(B);return m(L*R)}return{scalarMult:_,scalarMultBase:T,getSharedSecret:(A,U)=>_(A,U),getPublicKey:A=>T(A),utils:{randomPrivateKey:()=>c(l)},GuBytes:v.slice()}}BigInt(0);const f$=BigInt(1),_y=BigInt(2),p$=BigInt(3),g$=BigInt(5);BigInt(8);const n1={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function m$(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=n1.p,o=t*t%i*t%i,a=Yn(o,_y,i)*o%i,c=Yn(a,f$,i)*t%i,u=Yn(c,g$,i)*c%i,l=Yn(u,e,i)*u%i,d=Yn(l,n,i)*l%i,h=Yn(d,r,i)*d%i,f=Yn(h,s,i)*h%i,p=Yn(f,s,i)*h%i,g=Yn(p,e,i)*u%i;return{pow_p_5_8:Yn(g,_y,i)*t%i,b2:o}}function y$(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const vf=(()=>{const t=n1.p;return h$({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=m$(e);return kn(Yn(n,p$,t)*r,t)},adjustScalarBytes:y$})})();function Ay(t){t.lowS!==void 0&&ul("lowS",t.lowS),t.prehash!==void 0&&ul("prehash",t.prehash)}class w$ extends Error{constructor(e=""){super(e)}}const Vr={Err:w$,_tlv:{encode:(t,e)=>{const{Err:n}=Vr;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=gu(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?gu(s.length/2|128):"";return gu(t)+i+s+e},decode(t,e){const{Err:n}=Vr;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const u=e.subarray(r,r+c);if(u.length!==c)throw new n("tlv.decode: length bytes not complete");if(u[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const l of u)o=o<<8|l;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Vr;if(t<Sa)throw new e("integer: negative integers are not allowed");let n=gu(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Vr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Jl(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Vr,s=un("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:u,l}=r.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(u)}},hexFromSig(t){const{_tlv:e,_int:n}=Vr,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},Sa=BigInt(0),Na=BigInt(1),b$=BigInt(2),yu=BigInt(3),v$=BigInt(4);function E$(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function r1(t,e,n){const{BYTES:r}=t;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=un("private key",i);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=t.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function C$(t,e={}){const{Fp:n,Fn:r}=l$("weierstrass",t,e),{h:s,n:i}=t;Ql(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!n.is0(t.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(D,A,U){const{x:P,y:k}=A.toAffine(),L=n.toBytes(P);if(ul("isCompressed",U),U){a();const B=!n.isOdd(k);return si(s1(B),L)}else return si(Uint8Array.of(4),L,n.toBytes(k))}function u(D){Bn(D);const A=n.BYTES,U=A+1,P=2*A+1,k=D.length,L=D[0],B=D.subarray(1);if(k===U&&(L===2||L===3)){const C=n.fromBytes(B);if(!n.isValid(C))throw new Error("bad point: is not on curve, wrong x");const I=h(C);let x;try{x=n.sqrt(I)}catch(O){const M=O instanceof Error?": "+O.message:"";throw new Error("bad point: is not on curve, sqrt error"+M)}a();const R=n.isOdd(x);return(L&1)===1!==R&&(x=n.neg(x)),{x:C,y:x}}else if(k===P&&L===4){const C=n.fromBytes(B.subarray(A*0,A*1)),I=n.fromBytes(B.subarray(A*1,A*2));if(!f(C,I))throw new Error("bad point: is not on curve");return{x:C,y:I}}else throw new Error(`bad point: got length ${k}, expected compressed=${U} or uncompressed=${P}`)}const l=e.toBytes||c,d=e.fromBytes||u,h=E$(n,t.a,t.b);function f(D,A){const U=n.sqr(A),P=h(D);return n.eql(U,P)}if(!f(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const p=n.mul(n.pow(t.a,yu),v$),g=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(p,g)))throw new Error("bad curve params: a or b");function m(D,A,U=!1){if(!n.isValid(A)||U&&n.is0(A))throw new Error(`bad point coordinate ${D}`);return A}function v(D){if(!(D instanceof _))throw new Error("ProjectivePoint expected")}const w=yy((D,A)=>{const{px:U,py:P,pz:k}=D;if(n.eql(k,n.ONE))return{x:U,y:P};const L=D.is0();A==null&&(A=L?n.ONE:n.inv(k));const B=n.mul(U,A),C=n.mul(P,A),I=n.mul(k,A);if(L)return{x:n.ZERO,y:n.ZERO};if(!n.eql(I,n.ONE))throw new Error("invZ was invalid");return{x:B,y:C}}),b=yy(D=>{if(D.is0()){if(e.allowInfinityPoint&&!n.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:A,y:U}=D.toAffine();if(!n.isValid(A)||!n.isValid(U))throw new Error("bad point: x or y not field elements");if(!f(A,U))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function S(D,A,U,P,k){return U=new _(n.mul(U.px,D),U.py,U.pz),A=Ia(P,A),U=Ia(k,U),A.add(U)}class _{constructor(A,U,P){this.px=m("x",A),this.py=m("y",U,!0),this.pz=m("z",P),Object.freeze(this)}static fromAffine(A){const{x:U,y:P}=A||{};if(!A||!n.isValid(U)||!n.isValid(P))throw new Error("invalid affine point");if(A instanceof _)throw new Error("projective point not allowed");return n.is0(U)&&n.is0(P)?_.ZERO:new _(U,P,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(A){return s$(_,"pz",A)}static fromBytes(A){return Bn(A),_.fromHex(A)}static fromHex(A){const U=_.fromAffine(d(un("pointHex",A)));return U.assertValidity(),U}static fromPrivateKey(A){const U=r1(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return _.BASE.multiply(U(A))}static msm(A,U){return u$(_,r,A,U)}precompute(A=8,U=!0){return N.setWindowSize(this,A),U||this.multiply(yu),this}_setWindowSize(A){this.precompute(A)}assertValidity(){b(this)}hasEvenY(){const{y:A}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(A)}equals(A){v(A);const{px:U,py:P,pz:k}=this,{px:L,py:B,pz:C}=A,I=n.eql(n.mul(U,C),n.mul(L,k)),x=n.eql(n.mul(P,C),n.mul(B,k));return I&&x}negate(){return new _(this.px,n.neg(this.py),this.pz)}double(){const{a:A,b:U}=t,P=n.mul(U,yu),{px:k,py:L,pz:B}=this;let C=n.ZERO,I=n.ZERO,x=n.ZERO,R=n.mul(k,k),O=n.mul(L,L),M=n.mul(B,B),z=n.mul(k,L);return z=n.add(z,z),x=n.mul(k,B),x=n.add(x,x),C=n.mul(A,x),I=n.mul(P,M),I=n.add(C,I),C=n.sub(O,I),I=n.add(O,I),I=n.mul(C,I),C=n.mul(z,C),x=n.mul(P,x),M=n.mul(A,M),z=n.sub(R,M),z=n.mul(A,z),z=n.add(z,x),x=n.add(R,R),R=n.add(x,R),R=n.add(R,M),R=n.mul(R,z),I=n.add(I,R),M=n.mul(L,B),M=n.add(M,M),R=n.mul(M,z),C=n.sub(C,R),x=n.mul(M,O),x=n.add(x,x),x=n.add(x,x),new _(C,I,x)}add(A){v(A);const{px:U,py:P,pz:k}=this,{px:L,py:B,pz:C}=A;let I=n.ZERO,x=n.ZERO,R=n.ZERO;const O=t.a,M=n.mul(t.b,yu);let z=n.mul(U,L),Y=n.mul(P,B),ee=n.mul(k,C),Z=n.add(U,P),ae=n.add(L,B);Z=n.mul(Z,ae),ae=n.add(z,Y),Z=n.sub(Z,ae),ae=n.add(U,k);let fe=n.add(L,C);return ae=n.mul(ae,fe),fe=n.add(z,ee),ae=n.sub(ae,fe),fe=n.add(P,k),I=n.add(B,C),fe=n.mul(fe,I),I=n.add(Y,ee),fe=n.sub(fe,I),R=n.mul(O,ae),I=n.mul(M,ee),R=n.add(I,R),I=n.sub(Y,R),R=n.add(Y,R),x=n.mul(I,R),Y=n.add(z,z),Y=n.add(Y,z),ee=n.mul(O,ee),ae=n.mul(M,ae),Y=n.add(Y,ee),ee=n.sub(z,ee),ee=n.mul(O,ee),ae=n.add(ae,ee),z=n.mul(Y,ae),x=n.add(x,z),z=n.mul(fe,ae),I=n.mul(Z,I),I=n.sub(I,z),z=n.mul(Z,Y),R=n.mul(fe,R),R=n.add(R,z),new _(I,x,R)}subtract(A){return this.add(A.negate())}is0(){return this.equals(_.ZERO)}multiply(A){const{endo:U}=e;if(!r.isValidNot0(A))throw new Error("invalid scalar: out of range");let P,k;const L=B=>N.wNAFCached(this,B,_.normalizeZ);if(U){const{k1neg:B,k1:C,k2neg:I,k2:x}=U.splitScalar(A),{p:R,f:O}=L(C),{p:M,f:z}=L(x);k=O.add(z),P=S(U.beta,R,M,B,I)}else{const{p:B,f:C}=L(A);P=B,k=C}return _.normalizeZ([P,k])[0]}multiplyUnsafe(A){const{endo:U}=e,P=this;if(!r.isValid(A))throw new Error("invalid scalar: out of range");if(A===Sa||P.is0())return _.ZERO;if(A===Na)return P;if(N.hasPrecomputes(this))return this.multiply(A);if(U){const{k1neg:k,k1:L,k2neg:B,k2:C}=U.splitScalar(A),{p1:I,p2:x}=c$(_,P,L,C);return S(U.beta,I,x,k,B)}else return N.wNAFCachedUnsafe(P,A)}multiplyAndAddUnsafe(A,U,P){const k=this.multiplyUnsafe(U).add(A.multiplyUnsafe(P));return k.is0()?void 0:k}toAffine(A){return w(this,A)}isTorsionFree(){const{isTorsionFree:A}=e;return s===Na?!0:A?A(_,this):N.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:A}=e;return s===Na?this:A?A(_,this):this.multiplyUnsafe(s)}toBytes(A=!0){return ul("isCompressed",A),this.assertValidity(),l(_,this,A)}toRawBytes(A=!0){return this.toBytes(A)}toHex(A=!0){return lc(this.toBytes(A))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}_.BASE=new _(t.Gx,t.Gy,n.ONE),_.ZERO=new _(n.ZERO,n.ONE,n.ZERO),_.Fp=n,_.Fn=r;const T=r.BITS,N=a$(_,e.endo?Math.ceil(T/2):T);return _}function s1(t){return Uint8Array.of(t?2:3)}function _$(t,e,n={}){Ql(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||jo,s=e.hmac||((P,...k)=>Yl(e.hash,P,si(...k))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o;function u(P){const k=a>>Na;return P>k}function l(P){return u(P)?o.neg(P):P}function d(P,k){if(!o.isValidNot0(k))throw new Error(`invalid signature ${P}: out of range 1..CURVE.n`)}class h{constructor(k,L,B){d("r",k),d("s",L),this.r=k,this.s=L,B!=null&&(this.recovery=B),Object.freeze(this)}static fromCompact(k){const L=o.BYTES,B=un("compactSignature",k,L*2);return new h(o.fromBytes(B.subarray(0,L)),o.fromBytes(B.subarray(L,L*2)))}static fromDER(k){const{r:L,s:B}=Vr.toSig(un("DER",k));return new h(L,B)}assertValidity(){}addRecoveryBit(k){return new h(this.r,this.s,k)}recoverPublicKey(k){const L=i.ORDER,{r:B,s:C,recovery:I}=this;if(I==null||![0,1,2,3].includes(I))throw new Error("recovery id invalid");if(a*b$<L&&I>1)throw new Error("recovery id is ambiguous for h>1 curve");const x=I===2||I===3?B+a:B;if(!i.isValid(x))throw new Error("recovery id 2 or 3 invalid");const R=i.toBytes(x),O=t.fromHex(si(s1((I&1)===0),R)),M=o.inv(x),z=b(un("msgHash",k)),Y=o.create(-z*M),ee=o.create(C*M),Z=t.BASE.multiplyUnsafe(Y).add(O.multiplyUnsafe(ee));if(Z.is0())throw new Error("point at infinify");return Z.assertValidity(),Z}hasHighS(){return u(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes(k){if(k==="compact")return si(o.toBytes(this.r),o.toBytes(this.s));if(k==="der")return jp(Vr.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return lc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return lc(this.toBytes("compact"))}}const f=r1(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),p={isValidPrivateKey(P){try{return f(P),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const P=a;return r$(r(QE(P)),P)},precompute(P=8,k=t.BASE){return k.precompute(P,!1)}};function g(P,k=!0){return t.fromPrivateKey(P).toBytes(k)}function m(P){if(typeof P=="bigint")return!1;if(P instanceof t)return!0;const k=un("key",P).length,L=i.BYTES,B=L+1,C=2*L+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===B))return k===B||k===C}function v(P,k,L=!0){if(m(P)===!0)throw new Error("first arg must be private key");if(m(k)===!1)throw new Error("second arg must be public key");return t.fromHex(k).multiply(f(P)).toBytes(L)}const w=e.bits2int||function(P){if(P.length>8192)throw new Error("input is too large");const k=Jl(P),L=P.length*8-c;return L>0?k>>BigInt(L):k},b=e.bits2int_modN||function(P){return o.create(w(P))},S=Xl(c);function _(P){return bf("num < 2^"+c,P,Sa,S),o.toBytes(P)}function T(P,k,L=N){if(["recovered","canonical"].some(Z=>Z in L))throw new Error("sign() legacy options not supported");const{hash:B}=e;let{lowS:C,prehash:I,extraEntropy:x}=L;C==null&&(C=!0),P=un("msgHash",P),Ay(L),I&&(P=un("prehashed msgHash",B(P)));const R=b(P),O=f(k),M=[_(O),_(R)];if(x!=null&&x!==!1){const Z=x===!0?r(i.BYTES):x;M.push(un("extraEntropy",Z))}const z=si(...M),Y=R;function ee(Z){const ae=w(Z);if(!o.isValidNot0(ae))return;const fe=o.inv(ae),Fe=t.BASE.multiply(ae).toAffine(),Me=o.create(Fe.x);if(Me===Sa)return;const Ie=o.create(fe*o.create(Y+Me*O));if(Ie===Sa)return;let ct=(Fe.x===Me?0:2)|Number(Fe.y&Na),St=Ie;return C&&u(Ie)&&(St=l(Ie),ct^=1),new h(Me,St,ct)}return{seed:z,k2sig:ee}}const N={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function A(P,k,L=N){const{seed:B,k2sig:C}=T(P,k,L);return KD(e.hash.outputLen,o.BYTES,s)(B,C)}t.BASE.precompute(8);function U(P,k,L,B=D){const C=P;k=un("msgHash",k),L=un("publicKey",L),Ay(B);const{lowS:I,prehash:x,format:R}=B;if("strict"in B)throw new Error("options.strict was renamed to lowS");if(R!==void 0&&!["compact","der","js"].includes(R))throw new Error('format must be "compact", "der" or "js"');const O=typeof C=="string"||Lp(C),M=!O&&!R&&typeof C=="object"&&C!==null&&typeof C.r=="bigint"&&typeof C.s=="bigint";if(!O&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let z,Y;try{if(M)if(R===void 0||R==="js")z=new h(C.r,C.s);else throw new Error("invalid format");if(O){try{R!=="compact"&&(z=h.fromDER(C))}catch(ct){if(!(ct instanceof Vr.Err))throw ct}!z&&R!=="der"&&(z=h.fromCompact(C))}Y=t.fromHex(L)}catch{return!1}if(!z||I&&z.hasHighS())return!1;x&&(k=e.hash(k));const{r:ee,s:Z}=z,ae=b(k),fe=o.inv(Z),Fe=o.create(ae*fe),Me=o.create(ee*fe),Ie=t.BASE.multiplyUnsafe(Fe).add(Y.multiplyUnsafe(Me));return Ie.is0()?!1:o.create(Ie.x)===ee}return Object.freeze({getPublicKey:g,getSharedSecret:v,sign:A,verify:U,utils:p,Point:t,Signature:h})}function A$(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=zo(e.n,t.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function I$(t){const{CURVE:e,curveOpts:n}=A$(t),r={hash:t.hash,hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,ecdsaOpts:r}}function S$(t,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:t})}function N$(t){const{CURVE:e,curveOpts:n,ecdsaOpts:r}=I$(t),s=C$(e,n),i=_$(s,r,n);return S$(t,i)}function Ef(t,e){const n=r=>N$({...t,hash:r});return{...n(e),create:n}}const i1={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},o1={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},a1={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},T$=zo(i1.p),x$=zo(o1.p),P$=zo(a1.p),O$=Ef({...i1,Fp:T$,lowS:!1},Kl);Ef({...o1,Fp:x$,lowS:!1},B6),Ef({...a1,Fp:P$,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},L6);const R$=O$,c1="base10",Kt="base16",Qn="base64pad",bs="base64url",Hc="utf8",u1=0,Kr=1,Wc=2,D$=0,Iy=1,Ta=12,Gp=32;function $$(){const t=vf.utils.randomPrivateKey(),e=vf.getPublicKey(t);return{privateKey:fn(t,Kt),publicKey:fn(e,Kt)}}function Cf(){const t=jo(Gp);return fn(t,Kt)}function k$(t,e){const n=vf.getSharedSecret(Mn(t,Kt),Mn(e,Kt)),r=WD(Zl,n,void 0,void 0,Gp);return fn(r,Kt)}function Uu(t){const e=Zl(Mn(t,Kt));return fn(e,Kt)}function wr(t){const e=Zl(Mn(t,Hc));return fn(e,Kt)}function l1(t){return Mn(`${t}`,c1)}function Ci(t){return Number(fn(t,c1))}function d1(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function h1(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function U$(t){const e=l1(typeof t.type<"u"?t.type:u1);if(Ci(e)===Kr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?Mn(t.senderPublicKey,Kt):void 0,r=typeof t.iv<"u"?Mn(t.iv,Kt):jo(Ta),s=Mn(t.symKey,Kt),i=HE(s,r).encrypt(Mn(t.message,Hc)),o=f1({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===bs?d1(o):o}function M$(t){const e=Mn(t.symKey,Kt),{sealed:n,iv:r}=hc({encoded:t.encoded,encoding:t.encoding}),s=HE(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return fn(s,Hc)}function L$(t,e){const n=l1(Wc),r=jo(Ta),s=Mn(t,Hc),i=f1({type:n,sealed:s,iv:r});return e===bs?d1(i):i}function B$(t,e){const{sealed:n}=hc({encoded:t,encoding:e});return fn(n,Hc)}function f1(t){if(Ci(t.type)===Wc)return fn(Aa([t.type,t.sealed]),Qn);if(Ci(t.type)===Kr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return fn(Aa([t.type,t.senderPublicKey,t.iv,t.sealed]),Qn)}return fn(Aa([t.type,t.iv,t.sealed]),Qn)}function hc(t){const e=(t.encoding||Qn)===bs?h1(t.encoded):t.encoded,n=Mn(e,Qn),r=n.slice(D$,Iy),s=Iy;if(Ci(r)===Kr){const c=s+Gp,u=c+Ta,l=n.slice(s,c),d=n.slice(c,u),h=n.slice(u);return{type:r,sealed:h,iv:d,senderPublicKey:l}}if(Ci(r)===Wc){const c=n.slice(s),u=jo(Ta);return{type:r,sealed:c,iv:u}}const i=s+Ta,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function F$(t,e){const n=hc({encoded:t,encoding:e==null?void 0:e.encoding});return p1({type:Ci(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?fn(n.senderPublicKey,Kt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function p1(t){const e=(t==null?void 0:t.type)||u1;if(e===Kr){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function Sy(t){return t.type===Kr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Ny(t){return t.type===Wc}function j$(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return Aa([new Uint8Array([4]),e,n])}function z$(t,e){const[n,r,s]=t.split("."),i=Buffer.from(h1(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,u=Zl(c),l=j$(e);if(!R$.verify(Aa([o,a]),u,l))throw new Error("Invalid signature");return rf(t).payload}const q$="irn";function dl(t){return(t==null?void 0:t.relay)||{protocol:q$}}function ya(t){const e=w5[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function H$(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function Ty(t){if(!t.includes("wc:")){const u=IE(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((u,l)=>{a[l]=u});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:W$(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:H$(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function W$(t){return t.startsWith("//")?t.substring(2):t}function V$(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function xy(t){const e=new URLSearchParams,n=V$(t.relay);Object.keys(n).sort().forEach(s=>{e.set(s,n[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const r=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${r}`}function wu(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var G$=Object.defineProperty,K$=Object.defineProperties,Y$=Object.getOwnPropertyDescriptors,Py=Object.getOwnPropertySymbols,Z$=Object.prototype.hasOwnProperty,J$=Object.prototype.propertyIsEnumerable,Oy=(t,e,n)=>e in t?G$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,X$=(t,e)=>{for(var n in e||(e={}))Z$.call(e,n)&&Oy(t,n,e[n]);if(Py)for(var n of Py(e))J$.call(e,n)&&Oy(t,n,e[n]);return t},Q$=(t,e)=>K$(t,Y$(e));function qo(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function e8(t){const e=[];return Object.values(t).forEach(n=>{e.push(...qo(n.accounts))}),e}function t8(t,e){const n=[];return Object.values(t).forEach(r=>{qo(r.accounts).includes(e)&&n.push(...r.methods)}),n}function n8(t,e){const n=[];return Object.values(t).forEach(r=>{qo(r.accounts).includes(e)&&n.push(...r.events)}),n}function ed(t){return t.includes(":")}function uo(t){return ed(t)?t.split(":")[0]:t}function Ry(t){var e,n,r;const s={};if(!Ts(t))return s;for(const[i,o]of Object.entries(t)){const a=ed(i)?[i]:o.chains,c=o.methods||[],u=o.events||[],l=uo(i);s[l]=Q$(X$({},s[l]),{chains:Ir(a,(e=s[l])==null?void 0:e.chains),methods:Ir(c,(n=s[l])==null?void 0:n.methods),events:Ir(u,(r=s[l])==null?void 0:r.events)})}return s}function r8(t){const e={};return t==null||t.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function Dy(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=r8(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=Ir(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function s8(t,e){var n,r,s,i,o,a;const c=Ry(t),u=Ry(e),l={},d=Object.keys(c).concat(Object.keys(u));for(const h of d)l[h]={chains:Ir((n=c[h])==null?void 0:n.chains,(r=u[h])==null?void 0:r.chains),methods:Ir((s=c[h])==null?void 0:s.methods,(i=u[h])==null?void 0:i.methods),events:Ir((o=c[h])==null?void 0:o.events,(a=u[h])==null?void 0:a.events)};return l}const i8={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},o8={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function G(t,e){const{message:n,code:r}=o8[t];return{message:e?`${n} ${e}`:n,code:r}}function rt(t,e){const{message:n,code:r}=i8[t];return{message:e?`${n} ${e}`:n,code:r}}function Yr(t,e){return!!Array.isArray(t)}function Ts(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Rt(t){return typeof t>"u"}function dt(t,e){return e&&Rt(t)?!0:typeof t=="string"&&!!t.trim().length}function Kp(t,e){return e&&Rt(t)?!0:typeof t=="number"&&!isNaN(t)}function a8(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return ri(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:u}=t.namespaces[o],l=qo(a),d=n[o];(!ri(vE(o,d),l)||!ri(d.methods,c)||!ri(d.events,u))&&(i=!1)}),i):!1}function hl(t){return dt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function c8(t){if(dt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&hl(n)}}return!1}function u8(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(dt(t,!1)){if(e(t))return!0;const n=IE(t);return e(n)}}catch{}return!1}function l8(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function d8(t){return t==null?void 0:t.topic}function h8(t,e){let n=null;return dt(t==null?void 0:t.publicKey,!1)||(n=G("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function $y(t){let e=!0;return Yr(t)?t.length&&(e=t.every(n=>dt(n,!1))):e=!1,e}function f8(t,e,n){let r=null;return Yr(e)&&e.length?e.forEach(s=>{r||hl(s)||(r=rt("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):hl(t)||(r=rt("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function p8(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=f8(s,vE(s,i),`${e} ${n}`);o&&(r=o)}),r}function g8(t,e){let n=null;return Yr(t)?t.forEach(r=>{n||c8(r)||(n=rt("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=rt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function m8(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=g8(r==null?void 0:r.accounts,`${e} namespace`);s&&(n=s)}),n}function y8(t,e){let n=null;return $y(t==null?void 0:t.methods)?$y(t==null?void 0:t.events)||(n=rt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=rt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function g1(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=y8(r,`${e}, namespace`);s&&(n=s)}),n}function w8(t,e,n){let r=null;if(t&&Ts(t)){const s=g1(t,e);s&&(r=s);const i=p8(t,e,n);i&&(r=i)}else r=G("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function Qd(t,e){let n=null;if(t&&Ts(t)){const r=g1(t,e);r&&(n=r);const s=m8(t,e);s&&(n=s)}else n=G("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function m1(t){return dt(t.protocol,!0)}function b8(t,e){let n=!1;return t?t&&Yr(t)&&t.length&&t.forEach(r=>{n=m1(r)}):n=!0,n}function v8(t){return typeof t=="number"}function an(t){return typeof t<"u"&&typeof t!==null}function E8(t){return!(!t||typeof t!="object"||!t.code||!Kp(t.code,!1)||!t.message||!dt(t.message,!1))}function C8(t){return!(Rt(t)||!dt(t.method,!1))}function _8(t){return!(Rt(t)||Rt(t.result)&&Rt(t.error)||!Kp(t.id,!1)||!dt(t.jsonrpc,!1))}function A8(t){return!(Rt(t)||!dt(t.name,!1))}function ky(t,e){return!(!hl(e)||!e8(t).includes(e))}function I8(t,e,n){return dt(n,!1)?t8(t,e).includes(n):!1}function S8(t,e,n){return dt(n,!1)?n8(t,e).includes(n):!1}function Uy(t,e,n){let r=null;const s=N8(t),i=T8(e),o=Object.keys(s),a=Object.keys(i),c=My(Object.keys(t)),u=My(Object.keys(e)),l=c.filter(d=>!u.includes(d));return l.length&&(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),ri(o,a)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const h=qo(e[d].accounts);h.includes(d)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(ri(s[d].methods,i[d].methods)?ri(s[d].events,i[d].events)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function N8(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function My(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function T8(t){const e={};return Object.keys(t).forEach(n=>{if(n.includes(":"))e[n]=t[n];else{const r=qo(t[n].accounts);r==null||r.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}}),e}function x8(t,e){return Kp(t,!1)&&t<=e.max&&t>=e.min}function Ly(){const t=zc();return new Promise(e=>{switch(t){case _n.browser:e(P8());break;case _n.reactNative:e(O8());break;case _n.node:e(R8());break;default:e(!0)}})}function P8(){return Fo()&&(navigator==null?void 0:navigator.onLine)}async function O8(){if(Fs()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function R8(){return!0}function D8(t){switch(zc()){case _n.browser:$8(t);break;case _n.reactNative:k8(t);break}}function $8(t){!Fs()&&Fo()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function k8(t){Fs()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function U8(){var t;return Fo()&&vi()?((t=vi())==null?void 0:t.visibilityState)==="visible":!0}const eh={};class ia{static get(e){return eh[e]}static set(e,n){eh[e]=n}static delete(e){delete eh[e]}}function M8(t){const e=Bo.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function L8({publicKey:t,signature:e,payload:n}){var r;const s=_f(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=j8(n.address),a=n.era==="00"?new Uint8Array([0]):_f(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),u=new Uint8Array([c&255,c>>8&255]),l=BigInt(`0x${F8(n.tip)}`),d=q8(l),h=new Uint8Array([0,...t,o,...e,...a,...u,...d,...s]),f=z8(h.length+1);return new Uint8Array([...f,i,...h])}function B8(t){const e=_f(t),n=P5.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function _f(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function F8(t){return t.startsWith("0x")?t.slice(2):t}function j8(t){const e=Bo.decode(t)[0];return e===42?0:e===60?2:1}function z8(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function q8(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function H8(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=M8(t.transaction.address),r=L8({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return B8(s)}const W8="PARSE_ERROR",V8="INVALID_REQUEST",G8="METHOD_NOT_FOUND",K8="INVALID_PARAMS",y1="INTERNAL_ERROR",Yp="SERVER_ERROR",Y8=[-32700,-32600,-32601,-32602,-32603],xa={[W8]:{code:-32700,message:"Parse error"},[V8]:{code:-32600,message:"Invalid Request"},[G8]:{code:-32601,message:"Method not found"},[K8]:{code:-32602,message:"Invalid params"},[y1]:{code:-32603,message:"Internal error"},[Yp]:{code:-32e3,message:"Server error"}},w1=Yp;function Z8(t){return Y8.includes(t)}function By(t){return Object.keys(xa).includes(t)?xa[t]:xa[w1]}function J8(t){const e=Object.values(xa).find(n=>n.code===t);return e||xa[w1]}function b1(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var v1={},Fr={},Fy;function X8(){if(Fy)return Fr;Fy=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.isBrowserCryptoAvailable=Fr.getSubtleCrypto=Fr.getBrowerCrypto=void 0;function t(){return(mr===null||mr===void 0?void 0:mr.crypto)||(mr===null||mr===void 0?void 0:mr.msCrypto)||{}}Fr.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Fr.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Fr.isBrowserCryptoAvailable=n,Fr}var jr={},jy;function Q8(){if(jy)return jr;jy=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.isBrowser=jr.isNode=jr.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}jr.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}jr.isNode=e;function n(){return!t()&&!e()}return jr.isBrowser=n,jr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=Uc;e.__exportStar(X8(),t),e.__exportStar(Q8(),t)})(v1);function pr(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function ai(t=6){return BigInt(pr(t))}function _s(t,e,n){return{id:n||pr(),jsonrpc:"2.0",method:t,params:e}}function td(t,e){return{id:t,jsonrpc:"2.0",result:e}}function nd(t,e,n){return{id:t,jsonrpc:"2.0",error:ek(e)}}function ek(t,e){return typeof t>"u"?By(y1):(typeof t=="string"&&(t=Object.assign(Object.assign({},By(Yp)),{message:t})),Z8(t.code)&&(t=J8(t.code)),t)}let tk=class{},nk=class extends tk{constructor(){super()}},rk=class extends nk{constructor(e){super()}};const sk="^https?:",ik="^wss?:";function ok(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function E1(t,e){const n=ok(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function zy(t){return E1(t,sk)}function qy(t){return E1(t,ik)}function ak(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function C1(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Zp(t){return C1(t)&&"method"in t}function rd(t){return C1(t)&&(gr(t)||$n(t))}function gr(t){return"result"in t}function $n(t){return"error"in t}let qn=class extends rk{constructor(e){super(e),this.events=new zn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(_s(e.method,e.params||[],e.id||ai().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{$n(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),rd(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const ck=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),uk=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Hy=t=>t.split("?")[0],Wy=10,lk=ck();let dk=class{constructor(e){if(this.url=e,this.events=new zn.EventEmitter,this.registering=!1,!qy(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Jr(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!qy(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=v1.isReactNative()?void 0:{rejectUnauthorized:!ak(e)},i=new lk(e,[],s);uk()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?bi(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=nd(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return b1(e,Hy(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Wy&&this.events.setMaxListeners(Wy)}emitError(e){const n=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Hy(this.url)}`));return this.events.emit("register_error",n),n}};var hk={};const _1="wc",A1=2,Af="core",xr=`${_1}@2:${Af}:`,fk={logger:"error"},pk={database:":memory:"},gk="crypto",Vy="client_ed25519_seed",mk=V.ONE_DAY,yk="keychain",wk="0.3",bk="messages",vk="0.3",Gy=V.SIX_HOURS,Ek="publisher",I1="irn",Ck="error",S1="wss://relay.walletconnect.org",_k="relayer",Ct={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},Ak="_subscription",Pn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},Ik=.1,If="2.21.3",Qe={link_mode:"link_mode",relay:"relay"},Mu={inbound:"inbound",outbound:"outbound"},Sk="0.3",Nk="WALLETCONNECT_CLIENT_ID",Ky="WALLETCONNECT_LINK_MODE_APPS",wn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},Tk="subscription",xk="0.3",Pk="pairing",Ok="0.3",oa={wc_pairingDelete:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:V.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:V.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:V.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:V.ONE_DAY,prompt:!1,tag:0},res:{ttl:V.ONE_DAY,prompt:!1,tag:0}}},Xs={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Vn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Rk="history",Dk="0.3",$k="expirer",Dn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},kk="0.3",Uk="verify-api",Mk="https://verify.walletconnect.com",N1="https://verify.walletconnect.org",Pa=N1,Lk=`${Pa}/v3`,Bk=[Mk,N1],Fk="echo",jk="https://echo.walletconnect.com",fr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},qr={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Gn={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ws={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Vs={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},aa={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},zk=.1,qk="event-client",Hk=86400,Wk="https://pulse.walletconnect.org/batch";function Vk(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),u=Math.log(a)/Math.log(256),l=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,w=p.length;v!==w&&p[v]===0;)v++,g++;for(var b=(w-v)*l+1>>>0,S=new Uint8Array(b);v!==w;){for(var _=p[v],T=0,N=b-1;(_!==0||T<m)&&N!==-1;N--,T++)_+=256*S[N]>>>0,S[N]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");m=T,v++}for(var D=b-m;D!==b&&S[D]===0;)D++;for(var A=c.repeat(g);D<b;++D)A+=t.charAt(S[D]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===c;)m++,g++;for(var w=(p.length-g)*u+1>>>0,b=new Uint8Array(w);p[g];){var S=n[p.charCodeAt(g)];if(S===255)return;for(var _=0,T=w-1;(S!==0||_<v)&&T!==-1;T--,_++)S+=a*b[T]>>>0,b[T]=S%256>>>0,S=S/256>>>0;if(S!==0)throw new Error("Non-zero carry");v=_,g++}if(p[g]!==" "){for(var N=w-v;N!==w&&b[N]===0;)N++;for(var D=new Uint8Array(m+(w-N)),A=m;N!==w;)D[A++]=b[N++];return D}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var Gk=Vk,Kk=Gk;const T1=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Yk=t=>new TextEncoder().encode(t),Zk=t=>new TextDecoder().decode(t);class Jk{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Xk{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return x1(this,e)}}class Qk{constructor(e){this.decoders=e}or(e){return x1(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const x1=(t,e)=>new Qk({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class eU{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new Jk(e,n,r),this.decoder=new Xk(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const sd=({name:t,prefix:e,encode:n,decode:r})=>new eU(t,e,n,r),Vc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=Kk(n,e);return sd({prefix:t,name:e,encode:r,decode:i=>T1(s(i))})},tU=(t,e,n,r)=>{const s={};for(let l=0;l<e.length;++l)s[e[l]]=l;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,u=0;for(let l=0;l<i;++l){const d=s[t[l]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[u++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},nU=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Mt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>sd({prefix:e,name:t,encode(s){return nU(s,r,n)},decode(s){return tU(s,r,n,t)}}),rU=sd({prefix:"\0",name:"identity",encode:t=>Zk(t),decode:t=>Yk(t)});var sU=Object.freeze({__proto__:null,identity:rU});const iU=Mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var oU=Object.freeze({__proto__:null,base2:iU});const aU=Mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var cU=Object.freeze({__proto__:null,base8:aU});const uU=Vc({prefix:"9",name:"base10",alphabet:"0123456789"});var lU=Object.freeze({__proto__:null,base10:uU});const dU=Mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hU=Mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var fU=Object.freeze({__proto__:null,base16:dU,base16upper:hU});const pU=Mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),gU=Mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),mU=Mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),yU=Mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),wU=Mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bU=Mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),vU=Mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),EU=Mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),CU=Mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var _U=Object.freeze({__proto__:null,base32:pU,base32upper:gU,base32pad:mU,base32padupper:yU,base32hex:wU,base32hexupper:bU,base32hexpad:vU,base32hexpadupper:EU,base32z:CU});const AU=Vc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),IU=Vc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var SU=Object.freeze({__proto__:null,base36:AU,base36upper:IU});const NU=Vc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),TU=Vc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var xU=Object.freeze({__proto__:null,base58btc:NU,base58flickr:TU});const PU=Mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),OU=Mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),RU=Mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),DU=Mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $U=Object.freeze({__proto__:null,base64:PU,base64pad:OU,base64url:RU,base64urlpad:DU});const P1=Array.from(""),kU=P1.reduce((t,e,n)=>(t[n]=e,t),[]),UU=P1.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function MU(t){return t.reduce((e,n)=>(e+=kU[n],e),"")}function LU(t){const e=[];for(const n of t){const r=UU[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const BU=sd({prefix:"",name:"base256emoji",encode:MU,decode:LU});var FU=Object.freeze({__proto__:null,base256emoji:BU}),jU=O1,Yy=128,zU=-128,qU=Math.pow(2,31);function O1(t,e,n){e=e||[],n=n||0;for(var r=n;t>=qU;)e[n++]=t&255|Yy,t/=128;for(;t&zU;)e[n++]=t&255|Yy,t>>>=7;return e[n]=t|0,O1.bytes=n-r+1,e}var HU=Sf,WU=128,Zy=127;function Sf(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw Sf.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Zy)<<s:(o&Zy)*Math.pow(2,s),s+=7}while(o>=WU);return Sf.bytes=i-r,n}var VU=Math.pow(2,7),GU=Math.pow(2,14),KU=Math.pow(2,21),YU=Math.pow(2,28),ZU=Math.pow(2,35),JU=Math.pow(2,42),XU=Math.pow(2,49),QU=Math.pow(2,56),e4=Math.pow(2,63),t4=function(t){return t<VU?1:t<GU?2:t<KU?3:t<YU?4:t<ZU?5:t<JU?6:t<XU?7:t<QU?8:t<e4?9:10},n4={encode:jU,decode:HU,encodingLength:t4},R1=n4;const Jy=(t,e,n=0)=>(R1.encode(t,e,n),e),Xy=t=>R1.encodingLength(t),Nf=(t,e)=>{const n=e.byteLength,r=Xy(t),s=r+Xy(n),i=new Uint8Array(s+n);return Jy(t,i,0),Jy(n,i,r),i.set(e,s),new r4(t,n,e,i)};class r4{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const D1=({name:t,code:e,encode:n})=>new s4(t,e,n);class s4{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Nf(this.code,n):n.then(r=>Nf(this.code,r))}else throw Error("Unknown type, must be binary type")}}const $1=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),i4=D1({name:"sha2-256",code:18,encode:$1("SHA-256")}),o4=D1({name:"sha2-512",code:19,encode:$1("SHA-512")});var a4=Object.freeze({__proto__:null,sha256:i4,sha512:o4});const k1=0,c4="identity",U1=T1,u4=t=>Nf(k1,U1(t)),l4={code:k1,name:c4,encode:U1,digest:u4};var d4=Object.freeze({__proto__:null,identity:l4});new TextEncoder,new TextDecoder;const Qy={...sU,...oU,...cU,...lU,...fU,..._U,...SU,...xU,...$U,...FU};({...a4,...d4});function M1(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function h4(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?M1(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function L1(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const ew=L1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),th=L1("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=h4(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),f4={utf8:ew,"utf-8":ew,hex:Qy.base16,latin1:th,ascii:th,binary:th,...Qy};function p4(t,e="utf8"){const n=f4[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?M1(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var g4=Object.defineProperty,m4=(t,e,n)=>e in t?g4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dr=(t,e,n)=>m4(t,typeof e!="symbol"?e+"":e,n);class y4{constructor(e,n){this.core=e,this.logger=n,dr(this,"keychain",new Map),dr(this,"name",yk),dr(this,"version",wk),dr(this,"initialized",!1),dr(this,"storagePrefix",xr),dr(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),dr(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),dr(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),dr(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),dr(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=Vt(n,this.name)}get context(){return gn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,df(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?hf(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var w4=Object.defineProperty,b4=(t,e,n)=>e in t?w4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xt=(t,e,n)=>b4(t,typeof e!="symbol"?e+"":e,n);class v4{constructor(e,n,r){this.core=e,this.logger=n,xt(this,"name",gk),xt(this,"keychain"),xt(this,"randomSessionIdentifier",Cf()),xt(this,"initialized",!1),xt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),xt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),xt(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=$m(s);return Bv(i.publicKey)}),xt(this,"generateKeyPair",()=>{this.isInitialized();const s=$$();return this.setPrivateKey(s.publicKey,s.privateKey)}),xt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=$m(i),a=this.randomSessionIdentifier;return await KO(a,s,mk,o)}),xt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=k$(a,i);return this.setSymKey(c,o)}),xt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||Uu(s);return await this.keychain.set(o,s),o}),xt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),xt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),xt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=p1(o),c=Jr(i);if(Ny(a))return L$(c,o==null?void 0:o.encoding);if(Sy(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const u=this.getSymKey(s),{type:l,senderPublicKey:d}=a;return U$({type:l,symKey:u,message:c,senderPublicKey:d,encoding:o==null?void 0:o.encoding})}),xt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=F$(i,o);if(Ny(a)){const c=B$(i,o==null?void 0:o.encoding);return bi(c)}if(Sy(a)){const c=a.receiverPublicKey,u=a.senderPublicKey;s=await this.generateSharedKey(c,u)}try{const c=this.getSymKey(s),u=M$({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return bi(u)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),xt(this,"getPayloadType",(s,i=Qn)=>{const o=hc({encoded:s,encoding:i});return Ci(o.type)}),xt(this,"getPayloadSenderPublicKey",(s,i=Qn)=>{const o=hc({encoded:s,encoding:i});return o.senderPublicKey?fn(o.senderPublicKey,Kt):void 0}),this.core=e,this.logger=Vt(n,this.name),this.keychain=r||new y4(this.core,this.logger)}get context(){return gn(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Vy)}catch{e=Cf(),await this.keychain.set(Vy,e)}return p4(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var E4=Object.defineProperty,C4=Object.defineProperties,_4=Object.getOwnPropertyDescriptors,tw=Object.getOwnPropertySymbols,A4=Object.prototype.hasOwnProperty,I4=Object.prototype.propertyIsEnumerable,Tf=(t,e,n)=>e in t?E4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,S4=(t,e)=>{for(var n in e||(e={}))A4.call(e,n)&&Tf(t,n,e[n]);if(tw)for(var n of tw(e))I4.call(e,n)&&Tf(t,n,e[n]);return t},N4=(t,e)=>C4(t,_4(e)),yn=(t,e,n)=>Tf(t,typeof e!="symbol"?e+"":e,n);class T4 extends VT{constructor(e,n){super(e,n),this.logger=e,this.core=n,yn(this,"messages",new Map),yn(this,"messagesWithoutClientAck",new Map),yn(this,"name",bk),yn(this,"version",vk),yn(this,"initialized",!1),yn(this,"storagePrefix",xr),yn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),yn(this,"set",async(r,s,i)=>{this.isInitialized();const o=wr(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===Mu.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,N4(S4({},c),{[o]:s}))}return await this.persist(),o}),yn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),yn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),yn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=wr(s);return typeof i[o]<"u"}),yn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=wr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),yn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=Vt(e,this.name),this.core=n}get context(){return gn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,df(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,df(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?hf(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?hf(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var x4=Object.defineProperty,P4=Object.defineProperties,O4=Object.getOwnPropertyDescriptors,nw=Object.getOwnPropertySymbols,R4=Object.prototype.hasOwnProperty,D4=Object.prototype.propertyIsEnumerable,xf=(t,e,n)=>e in t?x4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bu=(t,e)=>{for(var n in e||(e={}))R4.call(e,n)&&xf(t,n,e[n]);if(nw)for(var n of nw(e))D4.call(e,n)&&xf(t,n,e[n]);return t},nh=(t,e)=>P4(t,O4(e)),Kn=(t,e,n)=>xf(t,typeof e!="symbol"?e+"":e,n);class $4 extends GT{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Kn(this,"events",new zn.EventEmitter),Kn(this,"name",Ek),Kn(this,"queue",new Map),Kn(this,"publishTimeout",V.toMiliseconds(V.ONE_MINUTE)),Kn(this,"initialPublishTimeout",V.toMiliseconds(V.ONE_SECOND*15)),Kn(this,"needsTransportRestart",!1),Kn(this,"publish",async(r,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||Gy,c=dl(i),u=(i==null?void 0:i.prompt)||!1,l=(i==null?void 0:i.tag)||0,d=(i==null?void 0:i.id)||ai().toString(),h={topic:r,message:s,opts:{ttl:a,relay:c,prompt:u,tag:l,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},f=`Failed to publish payload, please try again. id:${d} tag:${l}`;try{const p=new Promise(async g=>{const m=({id:w})=>{h.opts.id===w&&(this.removeRequestFromQueue(w),this.relayer.events.removeListener(Ct.publish,m),g(h))};this.relayer.events.on(Ct.publish,m);const v=Cs(new Promise((w,b)=>{this.rpcPublish({topic:r,message:s,ttl:a,prompt:u,tag:l,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(w).catch(S=>{this.logger.warn(S,S==null?void 0:S.message),b(S)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${l}`);try{await v,this.events.removeListener(Ct.publish,m)}catch(w){this.queue.set(d,nh(bu({},h),{attempt:1})),this.logger.warn(w,w==null?void 0:w.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:r,message:s,opts:i}}),await Cs(p,this.publishTimeout,f)}catch(p){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(p),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw p}finally{this.queue.delete(d)}}),Kn(this,"on",(r,s)=>{this.events.on(r,s)}),Kn(this,"once",(r,s)=>{this.events.once(r,s)}),Kn(this,"off",(r,s)=>{this.events.off(r,s)}),Kn(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=Vt(n,this.name),this.registerEventListeners()}get context(){return gn(this.logger)}async rpcPublish(e){var n,r,s,i;const{topic:o,message:a,ttl:c=Gy,prompt:u,tag:l,id:d,attestation:h,tvf:f}=e,p={method:ya(dl().protocol).publish,params:bu({topic:o,message:a,ttl:c,prompt:u,tag:l,attestation:h},f),id:d};Rt((n=p.params)==null?void 0:n.prompt)&&((r=p.params)==null||delete r.prompt),Rt((s=p.params)==null?void 0:s.tag)&&((i=p.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const g=await this.relayer.request(p);return this.relayer.events.emit(Ct.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{const r=e.attempt+1;this.queue.set(n,nh(bu({},e),{attempt:r}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(nh(bu({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Oi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Ct.connection_stalled);return}this.checkQueue()}),this.relayer.on(Ct.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var k4=Object.defineProperty,U4=(t,e,n)=>e in t?k4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hi=(t,e,n)=>U4(t,typeof e!="symbol"?e+"":e,n);class M4{constructor(){Hi(this,"map",new Map),Hi(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),Hi(this,"get",e=>this.map.get(e)||[]),Hi(this,"exists",(e,n)=>this.get(e).includes(n)),Hi(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Hi(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var L4=Object.defineProperty,B4=Object.defineProperties,F4=Object.getOwnPropertyDescriptors,rw=Object.getOwnPropertySymbols,j4=Object.prototype.hasOwnProperty,z4=Object.prototype.propertyIsEnumerable,Pf=(t,e,n)=>e in t?L4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ca=(t,e)=>{for(var n in e||(e={}))j4.call(e,n)&&Pf(t,n,e[n]);if(rw)for(var n of rw(e))z4.call(e,n)&&Pf(t,n,e[n]);return t},rh=(t,e)=>B4(t,F4(e)),Ke=(t,e,n)=>Pf(t,typeof e!="symbol"?e+"":e,n);class q4 extends ZT{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Ke(this,"subscriptions",new Map),Ke(this,"topicMap",new M4),Ke(this,"events",new zn.EventEmitter),Ke(this,"name",Tk),Ke(this,"version",xk),Ke(this,"pending",new Map),Ke(this,"cached",[]),Ke(this,"initialized",!1),Ke(this,"storagePrefix",xr),Ke(this,"subscribeTimeout",V.toMiliseconds(V.ONE_MINUTE)),Ke(this,"initialSubscribeTimeout",V.toMiliseconds(V.ONE_SECOND*15)),Ke(this,"clientId"),Ke(this,"batchSubscribeTopicsLimit",500),Ke(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Ke(this,"subscribe",async(r,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const i=dl(s),o={topic:r,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(r,o);const a=await this.rpcSubscribe(r,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),Ke(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),Ke(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),Ke(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),Ke(this,"on",(r,s)=>{this.events.on(r,s)}),Ke(this,"once",(r,s)=>{this.events.once(r,s)}),Ke(this,"off",(r,s)=>{this.events.off(r,s)}),Ke(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),Ke(this,"start",async()=>{await this.onConnect()}),Ke(this,"stop",async()=>{await this.onDisconnect()}),Ke(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Ke(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),Ke(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Oi.pulse,async()=>{await this.checkPending()}),this.events.on(wn.created,async r=>{const s=wn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(wn.deleted,async r=>{const s=wn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=Vt(n,this.name),this.clientId=""}get context(){return gn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=dl(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=rt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s;(!r||(r==null?void 0:r.transportType)===Qe.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const i={method:ya(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=r==null?void 0:r.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((r==null?void 0:r.transportType)===Qe.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(l=>this.logger.warn(l))},V.toMiliseconds(V.ONE_SECOND)),a;const c=new Promise(async l=>{const d=h=>{h.topic===e&&(this.events.removeListener(wn.created,d),l(h.id))};this.events.on(wn.created,d);try{const h=await Cs(new Promise((f,p)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g==null?void 0:g.message),p(g)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(wn.created,d),l(h)}catch{}}),u=await Cs(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return u?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Ct.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:ya(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Cs(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(Ct.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:ya(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await Cs(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(Ct.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:ya(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,rh(ca({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,ca({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,ca({},n)),this.topicMap.set(n.topic,e),this.events.emit(wn.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(wn.deleted,rh(ca({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(wn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(wn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>rh(ca({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await r6(V.toMiliseconds(V.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return wr(e+await this.getClientId())}}var H4=Object.defineProperty,sw=Object.getOwnPropertySymbols,W4=Object.prototype.hasOwnProperty,V4=Object.prototype.propertyIsEnumerable,Of=(t,e,n)=>e in t?H4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iw=(t,e)=>{for(var n in e||(e={}))W4.call(e,n)&&Of(t,n,e[n]);if(sw)for(var n of sw(e))V4.call(e,n)&&Of(t,n,e[n]);return t},Re=(t,e,n)=>Of(t,typeof e!="symbol"?e+"":e,n);class G4 extends KT{constructor(e){super(e),Re(this,"protocol","wc"),Re(this,"version",2),Re(this,"core"),Re(this,"logger"),Re(this,"events",new zn.EventEmitter),Re(this,"provider"),Re(this,"messages"),Re(this,"subscriber"),Re(this,"publisher"),Re(this,"name",_k),Re(this,"transportExplicitlyClosed",!1),Re(this,"initialized",!1),Re(this,"connectionAttemptInProgress",!1),Re(this,"relayUrl"),Re(this,"projectId"),Re(this,"packageName"),Re(this,"bundleId"),Re(this,"hasExperiencedNetworkDisruption",!1),Re(this,"pingTimeout"),Re(this,"heartBeatTimeout",V.toMiliseconds(V.THIRTY_SECONDS+V.FIVE_SECONDS)),Re(this,"reconnectTimeout"),Re(this,"connectPromise"),Re(this,"reconnectInProgress",!1),Re(this,"requestsInFlight",[]),Re(this,"connectTimeout",V.toMiliseconds(V.ONE_SECOND*15)),Re(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||ai().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Re(this,"resetPingTimeout",()=>{al()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),Re(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),Re(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(Ct.connect)}),Re(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),Re(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(Ct.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Re(this,"registerProviderListeners",()=>{this.provider.on(Pn.payload,this.onPayloadHandler),this.provider.on(Pn.connect,this.onConnectHandler),this.provider.on(Pn.disconnect,this.onDisconnectHandler),this.provider.on(Pn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?Vt(e.logger,this.name):Lc($o({level:e.logger||Ck})),this.messages=new T4(this.logger,e.core),this.subscriber=new q4(this,this.logger),this.publisher=new $4(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||S1,this.projectId=e.projectId,j5()?this.packageName=Km():z5()&&(this.bundleId=Km()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return gn(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:Qe.relay},Mu.outbound)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||(n==null?void 0:n.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=n==null?void 0:n.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const u=l=>{l.topic===e&&(this.subscriber.off(wn.created,u),c())};return await Promise.all([new Promise(l=>{c=l,this.subscriber.on(wn.created,u)}),new Promise(async(l,d)=>{a=await this.subscriber.subscribe(e,iw({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,l()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Cs(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Ly())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=pt(V.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(Ct.message,e),await this.recordMessageEvent(e,Mu.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Pn.disconnect,i),await Cs(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Pn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Pn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Pn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,V.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(al())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new qn(new dk(G5({sdkVersion:If,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Zp(e)){if(!e.method.endsWith(Ak))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:Qe.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(iw({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else rd(e)&&this.events.emit(Ct.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,Mu.inbound),this.events.emit(Ct.message,e))}async acknowledgePayload(e){const n=td(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(Pn.payload,this.onPayloadHandler),this.provider.off(Pn.connect,this.onConnectHandler),this.provider.off(Pn.disconnect,this.onDisconnectHandler),this.provider.off(Pn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Ly();D8(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Oi.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&U8())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n==null?void 0:n.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(Ct.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},V.toMiliseconds(Ik)))))}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function K4(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function ow(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function aw(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const Y4="[object RegExp]",Z4="[object String]",J4="[object Number]",X4="[object Boolean]",cw="[object Arguments]",Q4="[object Symbol]",eM="[object Date]",tM="[object Map]",nM="[object Set]",rM="[object Array]",sM="[object Function]",iM="[object ArrayBuffer]",sh="[object Object]",oM="[object Error]",aM="[object DataView]",cM="[object Uint8Array]",uM="[object Uint8ClampedArray]",lM="[object Uint16Array]",dM="[object Uint32Array]",hM="[object BigUint64Array]",fM="[object Int8Array]",pM="[object Int16Array]",gM="[object Int32Array]",mM="[object BigInt64Array]",yM="[object Float32Array]",wM="[object Float64Array]";function bM(){}function uw(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function vM(t,e,n){return wa(t,e,void 0,void 0,void 0,void 0,n)}function wa(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Oa(t,e,i,o)}return Oa(t,e,i,o)}function Oa(t,e,n,r){if(Object.is(t,e))return!0;let s=aw(t),i=aw(e);if(s===cw&&(s=sh),i===cw&&(i=sh),s!==i)return!1;switch(s){case Z4:return t.toString()===e.toString();case J4:{const c=t.valueOf(),u=e.valueOf();return K4(c,u)}case X4:case eM:case Q4:return Object.is(t.valueOf(),e.valueOf());case Y4:return t.source===e.source&&t.flags===e.flags;case sM:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case tM:{if(t.size!==e.size)return!1;for(const[c,u]of t.entries())if(!e.has(c)||!wa(u,e.get(c),c,t,e,n,r))return!1;return!0}case nM:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),u=Array.from(e.values());for(let l=0;l<c.length;l++){const d=c[l],h=u.findIndex(f=>wa(d,f,void 0,t,e,n,r));if(h===-1)return!1;u.splice(h,1)}return!0}case rM:case cM:case uM:case lM:case dM:case hM:case fM:case pM:case gM:case mM:case yM:case wM:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!wa(t[c],e[c],c,t,e,n,r))return!1;return!0}case iM:return t.byteLength!==e.byteLength?!1:Oa(new Uint8Array(t),new Uint8Array(e),n,r);case aM:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Oa(new Uint8Array(t),new Uint8Array(e),n,r);case oM:return t.name===e.name&&t.message===e.message;case sh:{if(!(Oa(t.constructor,e.constructor,n,r)||uw(t)&&uw(e)))return!1;const c=[...Object.keys(t),...ow(t)],u=[...Object.keys(e),...ow(e)];if(c.length!==u.length)return!1;for(let l=0;l<c.length;l++){const d=c[l],h=t[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!wa(h,f,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function EM(t,e){return vM(t,e,bM)}var CM=Object.defineProperty,lw=Object.getOwnPropertySymbols,_M=Object.prototype.hasOwnProperty,AM=Object.prototype.propertyIsEnumerable,Rf=(t,e,n)=>e in t?CM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dw=(t,e)=>{for(var n in e||(e={}))_M.call(e,n)&&Rf(t,n,e[n]);if(lw)for(var n of lw(e))AM.call(e,n)&&Rf(t,n,e[n]);return t},nn=(t,e,n)=>Rf(t,typeof e!="symbol"?e+"":e,n);class $i extends YT{constructor(e,n,r,s=xr,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,nn(this,"map",new Map),nn(this,"version",Sk),nn(this,"cached",[]),nn(this,"initialized",!1),nn(this,"getKey"),nn(this,"storagePrefix",xr),nn(this,"recentlyDeleted",[]),nn(this,"recentlyDeletedLimit",200),nn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Rt(o)?this.map.set(this.getKey(o),o):l8(o)?this.map.set(o.id,o):d8(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),nn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),nn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),nn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>EM(a[c],o[c]))):this.values)),nn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=dw(dw({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),nn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=Vt(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return gn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=G("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var IM=Object.defineProperty,SM=(t,e,n)=>e in t?IM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Se=(t,e,n)=>SM(t,typeof e!="symbol"?e+"":e,n);class NM{constructor(e,n){this.core=e,this.logger=n,Se(this,"name",Pk),Se(this,"version",Ok),Se(this,"events",new bp),Se(this,"pairings"),Se(this,"initialized",!1),Se(this,"storagePrefix",xr),Se(this,"ignoredPayloadTypes",[Kr]),Se(this,"registeredMethods",[]),Se(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Se(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Se(this,"create",async r=>{this.isInitialized();const s=Cf(),i=await this.core.crypto.setSymKey(s),o=pt(V.FIVE_MINUTES),a={protocol:I1},c={topic:i,expiry:o,relay:a,active:!1,methods:r==null?void 0:r.methods},u=xy({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(Xs.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r==null?void 0:r.transportType}),{topic:i,uri:u}}),Se(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[fr.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:u}=Ty(r.uri);s.props.properties.topic=i,s.addTrace(fr.pairing_uri_validation_success),s.addTrace(fr.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(i)){if(l=this.pairings.get(i),s.addTrace(fr.existing_pairing),l.active)throw s.setError(qr.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(fr.pairing_not_expired)}const d=c||pt(V.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:u};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(fr.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Xs.create,h),s.addTrace(fr.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(fr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(qr.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(qr.subscribe_pairing_topic_failure),f}return s.addTrace(fr.subscribe_pairing_topic_success),h}),Se(this,"activate",async({topic:r})=>{this.isInitialized();const s=pt(V.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),Se(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Zs();this.events.once(je("pairing_ping",i),({error:u})=>{u?c(u):a()}),await o()}}),Se(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),Se(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),Se(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Se(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",rt("USER_DISCONNECTED")),await this.deletePairing(s))}),Se(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return xy({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Se(this,"sendRequest",async(r,s,i)=>{const o=_s(s,i),a=await this.core.crypto.encode(r,o),c=oa[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Se(this,"sendResult",async(r,s,i)=>{const o=td(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,u=oa[c].res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),Se(this,"sendError",async(r,s,i)=>{const o=nd(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,u=oa[c]?oa[c].res:oa.unregistered_method.res;await this.core.relayer.publish(s,a,u),await this.core.history.resolve(o)}),Se(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,rt("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),Se(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>ps(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),Se(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Se(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Se(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Xs.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Se(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{gr(s)?this.events.emit(je("pairing_ping",i),{}):$n(s)&&this.events.emit(je("pairing_ping",i),{error:s.error})},500)}),Se(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Xs.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Se(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=rt("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),Se(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(rt("WC_METHOD_UNSUPPORTED",r))}),Se(this,"isValidPair",(r,s)=>{var i;if(!an(r)){const{message:a}=G("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(qr.malformed_pairing_uri),new Error(a)}if(!u8(r.uri)){const{message:a}=G("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(qr.malformed_pairing_uri),new Error(a)}const o=Ty(r==null?void 0:r.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(qr.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=G("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(qr.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&V.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(qr.pairing_expired);const{message:a}=G("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Se(this,"isValidPing",async r=>{if(!an(r)){const{message:i}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Se(this,"isValidDisconnect",async r=>{if(!an(r)){const{message:i}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Se(this,"isValidPairingTopic",async r=>{if(!dt(r,!1)){const{message:s}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(ps(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=G("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=Vt(n,this.name),this.pairings=new $i(this.core,this.logger,this.name,this.storagePrefix)}get context(){return gn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(Ct.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==Qe.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Zp(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):rd(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Dn.expired,async e=>{const{topic:n}=AE(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Xs.expire,{topic:n}))})}}var TM=Object.defineProperty,xM=(t,e,n)=>e in t?TM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pt=(t,e,n)=>xM(t,typeof e!="symbol"?e+"":e,n);class PM extends WT{constructor(e,n){super(e,n),this.core=e,this.logger=n,Pt(this,"records",new Map),Pt(this,"events",new zn.EventEmitter),Pt(this,"name",Rk),Pt(this,"version",Dk),Pt(this,"cached",[]),Pt(this,"initialized",!1),Pt(this,"storagePrefix",xr),Pt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Pt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:pt(V.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Vn.created,o)}),Pt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=$n(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Vn.updated,s))}),Pt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Pt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Vn.deleted,i)}}),this.persist()}),Pt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Pt(this,"on",(r,s)=>{this.events.on(r,s)}),Pt(this,"once",(r,s)=>{this.events.once(r,s)}),Pt(this,"off",(r,s)=>{this.events.off(r,s)}),Pt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Vt(n,this.name)}get context(){return gn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:_s(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Vn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Vn.created,e=>{const n=Vn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Vn.updated,e=>{const n=Vn.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Vn.deleted,e=>{const n=Vn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(Oi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{V.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Vn.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var OM=Object.defineProperty,RM=(t,e,n)=>e in t?OM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qt=(t,e,n)=>RM(t,typeof e!="symbol"?e+"":e,n);class DM extends JT{constructor(e,n){super(e,n),this.core=e,this.logger=n,qt(this,"expirations",new Map),qt(this,"events",new zn.EventEmitter),qt(this,"name",$k),qt(this,"version",kk),qt(this,"cached",[]),qt(this,"initialized",!1),qt(this,"storagePrefix",xr),qt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),qt(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),qt(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Dn.created,{target:i,expiration:o})}),qt(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),qt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Dn.deleted,{target:s,expiration:i})}}),qt(this,"on",(r,s)=>{this.events.on(r,s)}),qt(this,"once",(r,s)=>{this.events.once(r,s)}),qt(this,"off",(r,s)=>{this.events.off(r,s)}),qt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=Vt(n,this.name)}get context(){return gn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return K5(e);if(typeof e=="number")return Y5(e);const{message:n}=G("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Dn.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;V.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(Dn.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(Oi.pulse,()=>this.checkExpirations()),this.events.on(Dn.created,e=>{const n=Dn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Dn.expired,e=>{const n=Dn.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Dn.deleted,e=>{const n=Dn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var $M=Object.defineProperty,kM=(t,e,n)=>e in t?$M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lt=(t,e,n)=>kM(t,typeof e!="symbol"?e+"":e,n);class UM extends XT{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,lt(this,"name",Uk),lt(this,"abortController"),lt(this,"isDevEnv"),lt(this,"verifyUrlV3",Lk),lt(this,"storagePrefix",xr),lt(this,"version",A1),lt(this,"publicKey"),lt(this,"fetchPromise"),lt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&V.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),lt(this,"register",async s=>{if(!Fo()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const u=vi(),l=this.startAbortTimer(V.ONE_SECOND*5),d=await new Promise((h,f)=>{const p=()=>{window.removeEventListener("message",m),u.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=u.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=v=>{if(v.data&&typeof v.data=="string")try{const w=JSON.parse(v.data);if(w.type==="verify_attestation"){if(rf(w.attestation).payload.id!==o)return;clearInterval(l),u.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(w.attestation===null?"":w.attestation)}}catch(w){this.logger.warn(w)}};u.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(u){this.logger.warn(u)}return""}),lt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(rf(i).payload.id!==a)return;const u=await this.isValidJwtAttestation(i);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),lt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(V.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),lt(this,"getVerifyUrl",s=>{let i=s||Pa;return Bk.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Pa}`),i=Pa),i}),lt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(V.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),lt(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),lt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),lt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),lt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),lt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),lt(this,"validateAttestation",(s,i)=>{const o=z$(s,i.publicKey),a={hasExpired:V.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=Vt(n,this.name),this.abortController=new AbortController,this.isDevEnv=kp(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return gn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),V.toMiliseconds(e))}}var MM=Object.defineProperty,LM=(t,e,n)=>e in t?MM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hw=(t,e,n)=>LM(t,typeof e!="symbol"?e+"":e,n);class BM extends QT{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,hw(this,"context",Fk),hw(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${jk}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=Vt(n,this.context)}}var FM=Object.defineProperty,fw=Object.getOwnPropertySymbols,jM=Object.prototype.hasOwnProperty,zM=Object.prototype.propertyIsEnumerable,Df=(t,e,n)=>e in t?FM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ua=(t,e)=>{for(var n in e||(e={}))jM.call(e,n)&&Df(t,n,e[n]);if(fw)for(var n of fw(e))zM.call(e,n)&&Df(t,n,e[n]);return t},bt=(t,e,n)=>Df(t,typeof e!="symbol"?e+"":e,n);class qM extends ex{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,bt(this,"context",qk),bt(this,"storagePrefix",xr),bt(this,"storageVersion",zk),bt(this,"events",new Map),bt(this,"shouldPersist",!1),bt(this,"init",async()=>{if(!kp())try{const s={eventId:Zm(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:CE(this.core.relayer.protocol,this.core.relayer.version,If)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),bt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,u=Zm(),l=this.core.projectId||"",d=Date.now(),h=ua({eventId:u,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,h),this.shouldPersist=!0),h}),bt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return ua(ua({},a),this.setMethods(a.eventId))}),bt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),bt(this,"setEventListeners",()=>{this.core.heartbeat.on(Oi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{V.fromMiliseconds(Date.now())-V.fromMiliseconds(s.timestamp)>Hk&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),bt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),bt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),bt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),bt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),bt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,ua(ua({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),bt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),bt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${Wk}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${If}${i}`,{method:"POST",body:JSON.stringify(s)})}),bt(this,"getAppDomain",()=>EE().url),this.logger=Vt(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var HM=Object.defineProperty,pw=Object.getOwnPropertySymbols,WM=Object.prototype.hasOwnProperty,VM=Object.prototype.propertyIsEnumerable,$f=(t,e,n)=>e in t?HM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gw=(t,e)=>{for(var n in e||(e={}))WM.call(e,n)&&$f(t,n,e[n]);if(pw)for(var n of pw(e))VM.call(e,n)&&$f(t,n,e[n]);return t},Ze=(t,e,n)=>$f(t,typeof e!="symbol"?e+"":e,n);let GM=class B1 extends jT{constructor(e){var n;super(e),Ze(this,"protocol",_1),Ze(this,"version",A1),Ze(this,"name",Af),Ze(this,"relayUrl"),Ze(this,"projectId"),Ze(this,"customStoragePrefix"),Ze(this,"events",new zn.EventEmitter),Ze(this,"logger"),Ze(this,"heartbeat"),Ze(this,"relayer"),Ze(this,"crypto"),Ze(this,"storage"),Ze(this,"history"),Ze(this,"expirer"),Ze(this,"pairing"),Ze(this,"verify"),Ze(this,"echoClient"),Ze(this,"linkModeSupportedApps"),Ze(this,"eventClient"),Ze(this,"initialized",!1),Ze(this,"logChunkController"),Ze(this,"on",(a,c)=>this.events.on(a,c)),Ze(this,"once",(a,c)=>this.events.once(a,c)),Ze(this,"off",(a,c)=>this.events.off(a,c)),Ze(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ze(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:u})=>{if(!a||!c)return;const l={topic:a,message:c,publishedAt:Date.now(),transportType:Qe.link_mode};this.relayer.onLinkMessageEvent(l,{sessionExists:u})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||S1,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=$o({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:fk.logger,name:Af}),{logger:i,chunkLoggerController:o}=Ep({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=Vt(i,this.name),this.heartbeat=new xN,this.crypto=new v4(this,this.logger,e==null?void 0:e.keychain),this.history=new PM(this,this.logger),this.expirer=new DM(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new dT(gw(gw({},pk),e==null?void 0:e.storageOptions)),this.relayer=new G4({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new NM(this,this.logger),this.verify=new UM(this,this.logger,this.storage),this.echoClient=new BM(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new qM(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new B1(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(Nk,r),n}get context(){return gn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(Ky,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(Ky)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&hk.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const KM=GM,F1="wc",j1=2,z1="client",Jp=`${F1}@${j1}:${z1}:`,ih={name:z1,logger:"error"},mw="WALLETCONNECT_DEEPLINK_CHOICE",YM="proposal",yw="Proposal expired",ZM="session",Wi=V.SEVEN_DAYS,JM="engine",vt={wc_sessionPropose:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1104},res:{ttl:V.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1106},res:{ttl:V.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:V.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1112},res:{ttl:V.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:V.ONE_DAY,prompt:!1,tag:1114},res:{ttl:V.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:V.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:V.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:V.FIVE_MINUTES,prompt:!1,tag:1119}}},oh={min:V.FIVE_MINUTES,max:V.SEVEN_DAYS},hr={idle:"IDLE",active:"ACTIVE"},XM={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},QM="request",eL=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],tL="wc",nL="auth",rL="authKeys",sL="pairingTopics",iL="requests",id=`${tL}@${1.5}:${nL}:`,Lu=`${id}:PUB_KEY`;var oL=Object.defineProperty,aL=Object.defineProperties,cL=Object.getOwnPropertyDescriptors,ww=Object.getOwnPropertySymbols,uL=Object.prototype.hasOwnProperty,lL=Object.prototype.propertyIsEnumerable,kf=(t,e,n)=>e in t?oL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xe=(t,e)=>{for(var n in e||(e={}))uL.call(e,n)&&kf(t,n,e[n]);if(ww)for(var n of ww(e))lL.call(e,n)&&kf(t,n,e[n]);return t},rn=(t,e)=>aL(t,cL(e)),q=(t,e,n)=>kf(t,typeof e!="symbol"?e+"":e,n);class dL extends sx{constructor(e){super(e),q(this,"name",JM),q(this,"events",new bp),q(this,"initialized",!1),q(this,"requestQueue",{state:hr.idle,queue:[]}),q(this,"sessionRequestQueue",{state:hr.idle,queue:[]}),q(this,"requestQueueDelay",V.ONE_SECOND),q(this,"expectedPairingMethodMap",new Map),q(this,"recentlyDeletedMap",new Map),q(this,"recentlyDeletedLimit",200),q(this,"relayMessageCache",[]),q(this,"pendingSessions",new Map),q(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(vt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},V.toMiliseconds(this.requestQueueDelay)))}),q(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=rn(Xe({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=s8(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:u}=r;let l=s,d,h=!1;try{if(l){const T=this.client.core.pairing.pairings.get(l);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=T.active}}catch(T){throw this.client.logger.error(`connect() -> pairing.get(${l}) failed`),T}if(!l||!h){const{topic:T,uri:N}=await this.client.core.pairing.create();l=T,d=N}if(!l){const{message:T}=G("NO_MATCHING_KEY",`connect() pairing topic: ${l}`);throw new Error(T)}const f=await this.client.core.crypto.generateKeyPair(),p=vt.wc_sessionPropose.req.ttl||V.FIVE_MINUTES,g=pt(p),m=rn(Xe(Xe({requiredNamespaces:i,optionalNamespaces:o,relays:u??[{protocol:I1}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:l},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:pr()}),v=je("session_connect",m.id),{reject:w,resolve:b,done:S}=Zs(p,yw),_=({id:T})=>{T===m.id&&(this.client.events.off("proposal_expire",_),this.pendingSessions.delete(m.id),this.events.emit(v,{error:{message:yw,code:0}}))};return this.client.events.on("proposal_expire",_),this.events.once(v,({error:T,session:N})=>{this.client.events.off("proposal_expire",_),T?w(T):N&&b(N)}),await this.sendRequest({topic:l,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:d,approval:S}}),q(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),q(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n==null?void 0:n.id)==null?void 0:r.toString(),trace:[Gn.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(A){throw o.setError(Ws.no_internet_connection),A}try{await this.isValidProposalId(n==null?void 0:n.id)}catch(A){throw this.client.logger.error(`approve() -> proposal.get(${n==null?void 0:n.id}) failed`),o.setError(Ws.proposal_not_found),A}try{await this.isValidApprove(n)}catch(A){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ws.session_approve_namespace_validation_failure),A}const{id:a,relayProtocol:c,namespaces:u,sessionProperties:l,scopedProperties:d,sessionConfig:h}=n,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:v}=f;let w=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});w||(w=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:Gn.session_approve_started,properties:{topic:p,trace:[Gn.session_approve_started,Gn.session_namespaces_validation_success]}}));const b=await this.client.core.crypto.generateKeyPair(),S=g.publicKey,_=await this.client.core.crypto.generateSharedKey(b,S),T=Xe(Xe(Xe({relay:{protocol:c??"irn"},namespaces:u,controller:{publicKey:b,metadata:this.client.metadata},expiry:pt(Wi)},l&&{sessionProperties:l}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),N=Qe.relay;w.addTrace(Gn.subscribing_session_topic);try{await this.client.core.relayer.subscribe(_,{transportType:N})}catch(A){throw w.setError(Ws.subscribe_session_topic_failure),A}w.addTrace(Gn.subscribe_session_topic_success);const D=rn(Xe({},T),{topic:_,requiredNamespaces:m,optionalNamespaces:v,pairingTopic:p,acknowledged:!1,self:T.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:b,transportType:Qe.relay});await this.client.session.set(_,D),w.addTrace(Gn.store_session);try{w.addTrace(Gn.publishing_session_settle),await this.sendRequest({topic:_,method:"wc_sessionSettle",params:T,throwOnFailedPublish:!0}).catch(A=>{throw w==null||w.setError(Ws.session_settle_publish_failure),A}),w.addTrace(Gn.session_settle_publish_success),w.addTrace(Gn.publishing_session_approve),await this.sendResult({id:a,topic:p,result:{relay:{protocol:c??"irn"},responderPublicKey:b},throwOnFailedPublish:!0}).catch(A=>{throw w==null||w.setError(Ws.session_approve_publish_failure),A}),w.addTrace(Gn.session_approve_publish_success)}catch(A){throw this.client.logger.error(A),this.client.session.delete(_,rt("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(_),A}return this.client.core.eventClient.deleteEvent({eventId:w.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(_,pt(Wi)),{topic:_,acknowledged:()=>Promise.resolve(this.client.session.get(_))}}),q(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:vt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),q(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=Zs(),c=pr(),u=ai().toString(),l=this.client.session.get(r).namespaces;return this.events.once(je("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:u}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:l}),a(d)}),{acknowledged:i}}),q(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=pr(),{done:i,resolve:o,reject:a}=Zs();return this.events.once(je("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,pt(Wi)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),q(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:r,request:s,topic:i,expiry:o=vt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);(a==null?void 0:a.transportType)===Qe.relay&&await this.confirmOnlineStateOrThrow();const c=pr(),u=ai().toString(),{done:l,resolve:d,reject:h}=Zs(o,"Request expired. Please try again.");this.events.once(je("session_request",c),({error:m,result:v})=>{m?h(m):d(v)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:f,params:{request:rn(Xe({},s),{expiryTimestamp:pt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>h(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await l();const g={request:rn(Xe({},s),{expiryTimestamp:pt(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:u,topic:i,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(v=>h(v)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),m()}),new Promise(async m=>{var v;if(!((v=a.sessionConfig)!=null&&v.disableDeepLink)){const w=await Q5(this.client.core.storage,mw);await Z5({id:c,topic:i,wcDeepLink:w})}m()}),l()]).then(m=>m[2])}),q(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===Qe.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);gr(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):$n(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),q(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=pr(),i=ai().toString(),{done:o,resolve:a,reject:c}=Zs();this.events.once(je("session_ping",s),({error:u})=>{u?c(u):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),q(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=ai().toString(),a=pr();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),q(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:rt("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=G("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),q(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>a8(r,n)))),q(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),q(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Qe.link_mode:Qe.relay;o===Qe.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:u,domain:l,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=n,v=[...n.resources||[]],{topic:w,uri:b}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:b}});const S=await this.client.core.crypto.generateKeyPair(),_=Uu(S);if(await Promise.all([this.client.auth.authKeys.set(Lu,{responseTopic:_,publicKey:S}),this.client.auth.pairingTopics.set(_,{topic:_,pairingTopic:w})]),await this.client.core.relayer.subscribe(_,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${w}`),g.length>0){const{namespace:O}=po(a[0]);let M=pD(O,"request",g);ku(v)&&(M=mD(M,v.pop())),v.push(M)}const T=m&&m>vt.wc_sessionAuthenticate.req.ttl?m:vt.wc_sessionAuthenticate.req.ttl,N={authPayload:{type:h??"caip122",chains:a,statement:c,aud:u,domain:l,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:v},requester:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:pt(T)},D={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},A={requiredNamespaces:{},optionalNamespaces:D,relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:S,metadata:this.client.metadata},expiryTimestamp:pt(vt.wc_sessionPropose.req.ttl),id:pr()},{done:U,resolve:P,reject:k}=Zs(T,"Request expired"),L=pr(),B=je("session_connect",A.id),C=je("session_request",L),I=async({error:O,session:M})=>{this.events.off(C,x),O?k(O):M&&P({session:M})},x=async O=>{var M,z,Y;if(await this.deletePendingAuthRequest(L,{message:"fulfilled",code:0}),O.error){const Ie=rt("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return O.error.code===Ie.code?void 0:(this.events.off(B,I),k(O.error.message))}await this.deleteProposal(A.id),this.events.off(B,I);const{cacaos:ee,responder:Z}=O.result,ae=[],fe=[];for(const Ie of ee){await ay({cacao:Ie,projectId:this.client.core.projectId})||(this.client.logger.error(Ie,"Signature verification failed"),k(rt("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:ct}=Ie,St=ku(ct.resources),js=[ff(ct.iss)],Zc=cl(ct.iss);if(St){const Ui=cy(St),dd=uy(St);ae.push(...Ui),js.push(...dd)}for(const Ui of js)fe.push(`${Ui}:${Zc}`)}const Fe=await this.client.core.crypto.generateSharedKey(S,Z.publicKey);let Me;ae.length>0&&(Me={topic:Fe,acknowledged:!0,self:{publicKey:S,metadata:this.client.metadata},peer:Z,controller:Z.publicKey,expiry:pt(Wi),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:Dy([...new Set(ae)],[...new Set(fe)]),transportType:o},await this.client.core.relayer.subscribe(Fe,{transportType:o}),await this.client.session.set(Fe,Me),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:Z.metadata}),Me=this.client.session.get(Fe)),(M=this.client.metadata.redirect)!=null&&M.linkMode&&(z=Z.metadata.redirect)!=null&&z.linkMode&&(Y=Z.metadata.redirect)!=null&&Y.universal&&r&&(this.client.core.addLinkModeSupportedApp(Z.metadata.redirect.universal),this.client.session.update(Fe,{transportType:Qe.link_mode})),P({auths:ee,session:Me})};this.events.once(B,I),this.events.once(C,x);let R;try{if(i){const O=_s("wc_sessionAuthenticate",N,L);this.client.core.history.set(w,O);const M=await this.client.core.crypto.encode("",O,{type:Wc,encoding:bs});R=wu(r,w,M)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:N,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:L}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:A,expiry:vt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:A.id})])}catch(O){throw this.events.off(B,I),this.events.off(C,x),O}return await this.setProposal(A.id,A),await this.setAuthRequest(L,{request:rn(Xe({},N),{verifyContext:{}}),pairingTopic:w,transportType:o}),{uri:R??b,response:U}}),q(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Vs.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(aa.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(aa.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Qe.relay;a===Qe.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=Uu(c),d={type:Kr,receiverPublicKey:c,senderPublicKey:u},h=[],f=[];for(const m of s){if(!await ay({cacao:m,projectId:this.client.core.projectId})){i.setError(aa.invalid_cacao);const _=rt("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:l,error:_,encodeOpts:d}),new Error(_.message)}i.addTrace(Vs.cacaos_verified);const{p:v}=m,w=ku(v.resources),b=[ff(v.iss)],S=cl(v.iss);if(w){const _=cy(w),T=uy(w);h.push(..._),b.push(...T)}for(const _ of b)f.push(`${_}:${S}`)}const p=await this.client.core.crypto.generateSharedKey(u,c);i.addTrace(Vs.create_authenticated_session_topic);let g;if((h==null?void 0:h.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:pt(Wi),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:Dy([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(Vs.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(aa.subscribe_authenticated_session_topic_failure),m}i.addTrace(Vs.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(Vs.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Vs.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:r,result:{cacaos:s,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(aa.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),q(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Qe.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=Uu(o),u={type:Kr,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:u,rpcOpts:vt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),q(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return BE(r,s)}),q(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),q(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),q(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,rt("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(mw).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===s&&this.deletePendingSessionRequest(u.id,rt("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=hr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),q(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(Ws.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,rt("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),q(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=hr.idle,this.client.events.emit("session_request_expire",{id:n}))}),q(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),q(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),q(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,pt(vt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),q(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Qe.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),q(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||pt(vt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),q(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:d}=n,h=_s(s,i,c);let f;const p=!!l;try{const v=p?bs:Qn;f=await this.client.core.crypto.encode(r,h,{encoding:v})}catch(v){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),v}let g;if(eL.includes(s)){const v=wr(JSON.stringify(h)),w=wr(f);g=await this.client.core.verify.register({id:w,decryptedId:v})}const m=vt[s].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(r,h),p){const v=wu(l,r,f);await global.Linking.openURL(v,this.client.name)}else{const v=vt[s].req;o&&(v.ttl=o),a&&(v.id=a),v.tvf=rn(Xe({},d),{correlationId:h.id}),u?(v.internal=rn(Xe({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,f,v)):this.client.core.relayer.publish(r,f,v).catch(w=>this.client.logger.error(w))}return h.id}),q(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,u=td(r,i);let l;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?bs:Qn;l=await this.client.core.crypto.encode(s,u,rn(Xe({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,f;try{h=await this.client.core.history.get(s,r);const p=h.request;try{f=this.getTVFParams(r,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(d){const p=wu(c,s,l);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,g=vt[p].res;g.tvf=rn(Xe({},f),{correlationId:r}),o?(g.internal=rn(Xe({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,l,g)):this.client.core.relayer.publish(s,l,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(u)}),q(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,u=nd(r,i);let l;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?bs:Qn;l=await this.client.core.crypto.encode(s,u,rn(Xe({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),f}if(d){const f=wu(c,s,l);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,p=a||vt[f].res;this.client.core.relayer.publish(s,l,p)}await this.client.core.history.resolve(u)}),q(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;ps(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{ps(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),q(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),q(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),q(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===hr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=hr.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=hr.idle}),q(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),q(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),q(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=G("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),q(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),q(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const u=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u==null||u.setError(qr.proposal_listener_not_found)),this.isValidConnect(Xe({},s.params));const l=a.expiryTimestamp||pt(vt.wc_sessionPropose.req.ttl),d=Xe({id:c,pairingTopic:r,expiryTimestamp:l,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:wr(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});u==null||u.addTrace(fr.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(u){await this.sendError({id:c,topic:r,error:u,rpcOpts:vt.wc_sessionPropose.autoReject}),this.client.logger.error(u)}}),q(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(gr(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const u=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(c,u);this.pendingSessions.set(i,{sessionTopic:l,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(l,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if($n(r)){await this.deleteProposal(i);const o=je("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),q(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:u,sessionProperties:l,scopedProperties:d,sessionConfig:h}=r.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===n);if(!f)return this.client.logger.error(`Pending session not found for topic ${n}`);const p=this.client.proposal.get(f.proposalId),g=rn(Xe(Xe(Xe({topic:n,relay:o,expiry:c,namespaces:u,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},l&&{sessionProperties:l}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Qe.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(je("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;gr(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(je("session_approve",s),{})):$n(r)&&(await this.client.session.delete(n,rt("USER_DISCONNECTED")),this.events.emit(je("session_approve",s),{error:r.error}))}),q(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=ia.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:rt("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Xe({topic:n},s));try{ia.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw ia.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),q(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=je("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);gr(r)?this.events.emit(je("session_update",s),{}):$n(r)&&this.events.emit(je("session_update",s),{error:r.error})}),q(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,pt(Wi)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=je("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);gr(r)?this.events.emit(je("session_extend",s),{}):$n(r)&&this.events.emit(je("session_extend",s),{error:r.error})}),q(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=je("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);gr(r)?this.events.emit(je("session_ping",s),{}):$n(r)&&this.events.emit(je("session_ping",s),{error:r.error})},500)}),q(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(Ct.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:rt("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),q(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:u,transportType:l}=n,{id:d,params:h}=a;try{await this.isValidRequest(Xe({topic:o},h));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:wr(JSON.stringify(_s("wc_sessionRequest",h,d))),encryptedId:u,metadata:f.peer.metadata,transportType:l}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),l===Qe.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),q(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=je("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);gr(r)?this.events.emit(je("session_request",s),{result:r.result}):$n(r)&&this.events.emit(je("session_request",s),{error:r.error})}),q(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=ia.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Xe({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),ia.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),gr(r)?this.events.emit(je("session_request",s),{result:r.result}):$n(r)&&this.events.emit(je("session_request",s),{error:r.error})}),q(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:u,authPayload:l,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:wr(JSON.stringify(i)),encryptedId:a,metadata:u.metadata,transportType:c}),f={requester:u,pairingTopic:s,id:i.id,authPayload:l,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===Qe.link_mode&&(r=u.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(u){this.client.logger.error(u);const l=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:Kr,receiverPublicKey:l,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:u,encodeOpts:f,rpcOpts:vt.wc_sessionAuthenticate.autoReject,appLink:h})}}),q(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),q(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=hr.idle,this.processSessionRequestQueue()},V.toMiliseconds(this.requestQueueDelay))}),q(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=je("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(je("session_request",i.request.id),{error:r})})}),q(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===hr.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=hr.active,this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),q(this,"emitSessionRequest",n=>{this.client.events.emit("session_request",n)}),q(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:_s("wc_sessionPropose",rn(Xe({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),q(this,"isValidConnect",async n=>{if(!an(n)){const{message:u}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(u)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(Rt(r)||await this.isValidPairingTopic(r),!b8(c)){const{message:u}=G("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(u)}if(!Rt(s)&&Ts(s)!==0){const u="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(u):this.client.logger.warn(u),this.validateNamespaces(s,"requiredNamespaces")}if(!Rt(i)&&Ts(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),Rt(o)||this.validateSessionProps(o,"sessionProperties"),!Rt(a)){this.validateSessionProps(a,"scopedProperties");const u=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(l=>u.includes(l)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(u)}`)}}),q(this,"validateNamespaces",(n,r)=>{const s=w8(n,"connect()",r);if(s)throw new Error(s.message)}),q(this,"isValidApprove",async n=>{if(!an(n))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),u=Qd(s,"approve()");if(u)throw new Error(u.message);const l=Uy(c.requiredNamespaces,s,"approve()");if(l)throw new Error(l.message);if(!dt(i,!0)){const{message:d}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(Rt(o)||this.validateSessionProps(o,"sessionProperties"),!Rt(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),q(this,"isValidReject",async n=>{if(!an(n)){const{message:i}=G("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!E8(s)){const{message:i}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),q(this,"isValidSessionSettleRequest",n=>{if(!an(n)){const{message:u}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(u)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!m1(r)){const{message:u}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const a=h8(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Qd(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(ps(o)){const{message:u}=G("EXPIRED","onSessionSettleRequest()");throw new Error(u)}}),q(this,"isValidUpdate",async n=>{if(!an(n)){const{message:c}=G("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Qd(s,"update()");if(o)throw new Error(o.message);const a=Uy(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),q(this,"isValidExtend",async n=>{if(!an(n)){const{message:s}=G("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),q(this,"isValidRequest",async n=>{if(!an(n)){const{message:c}=G("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!ky(a,i)){const{message:c}=G("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!C8(s)){const{message:c}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!I8(a,i,s.method)){const{message:c}=G("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!x8(o,oh)){const{message:c}=G("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${oh.min} and ${oh.max}`);throw new Error(c)}}),q(this,"isValidRespond",async n=>{var r;if(!an(n)){const{message:o}=G("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n==null?void 0:n.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!_8(i)){const{message:o}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),q(this,"isValidPing",async n=>{if(!an(n)){const{message:s}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidEmit",async n=>{if(!an(n)){const{message:a}=G("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!ky(o,i)){const{message:a}=G("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!A8(s)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!S8(o,i,s.name)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),q(this,"isValidDisconnect",async n=>{if(!an(n)){const{message:s}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!dt(s,!1))throw new Error("uri is required parameter");if(!dt(i,!1))throw new Error("domain is required parameter");if(!dt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>po(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=po(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),q(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||Pa,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Qe.link_mode){const l=this.getAppLinkIfEnabled(o,a);return c.verified.validation=l&&new URL(l).origin===new URL(o.url).origin?"VALID":"INVALID",c}const u=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});u&&(c.verified.origin=u.origin,c.verified.isScam=u.isScam,c.verified.validation=u.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),q(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=G("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),q(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),q(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),q(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=G("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),q(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,u,l,d,h;return!n||r!==Qe.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((u=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:u.universal)!==""&&((l=n==null?void 0:n.redirect)==null?void 0:l.universal)!==void 0&&((d=n==null?void 0:n.redirect)==null?void 0:d.universal)!==""&&((h=n==null?void 0:n.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),q(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n==null?void 0:n.redirect)==null?void 0:s.universal:void 0}),q(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=Ym(n,"topic")||"",s=decodeURIComponent(Ym(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Qe.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),q(this,"registerLinkModeListeners",async()=>{var n;if(kp()||Fs()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),q(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const u=this.extractTxHashesFromResult(r.request,s);c.txHashes=u,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(u){this.client.logger.warn("Error getting TVF params",u)}return c}),q(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=(n==null?void 0:n.data)||((r=n==null?void 0:n[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),q(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=XM[i];if(i==="sui_signTransaction")return[X6(r.transactionBytes)];if(i==="near_signTransaction")return[ry(r)];if(i==="near_signTransactions")return r.map(c=>ry(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[H8({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return Yr(r)?r.map(c=>sy(c)):[sy(r)];if(i==="cosmos_signDirect")return[eD(r)];if(typeof r=="string")return[r];const a=r[o.key];if(Yr(a))return i==="solana_signAllTransactions"?a.map(c=>J6(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Ct.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(Lu)?this.client.auth.authKeys.get(Lu):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Qe.link_mode?bs:Qn});Zp(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:wr(r)})):rd(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Dn.expired,async e=>{const{topic:n,id:r}=AE(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,G("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,G("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Xs.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Xs.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!dt(e,!1)){const{message:n}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(ps(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=G("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!dt(e,!1)){const{message:n}=G("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(ps(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=G("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=G("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(dt(e,!1)){const{message:n}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!v8(e)){const{message:n}=G("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(ps(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=G("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}}class hL extends $i{constructor(e,n){super(e,n,YM,Jp),this.core=e,this.logger=n}}let fL=class extends $i{constructor(e,n){super(e,n,ZM,Jp),this.core=e,this.logger=n}};class pL extends $i{constructor(e,n){super(e,n,QM,Jp,r=>r.id),this.core=e,this.logger=n}}class gL extends $i{constructor(e,n){super(e,n,rL,id,()=>Lu),this.core=e,this.logger=n}}class mL extends $i{constructor(e,n){super(e,n,sL,id),this.core=e,this.logger=n}}class yL extends $i{constructor(e,n){super(e,n,iL,id,r=>r.id),this.core=e,this.logger=n}}var wL=Object.defineProperty,bL=(t,e,n)=>e in t?wL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ah=(t,e,n)=>bL(t,typeof e!="symbol"?e+"":e,n);class vL{constructor(e,n){this.core=e,this.logger=n,ah(this,"authKeys"),ah(this,"pairingTopics"),ah(this,"requests"),this.authKeys=new gL(this.core,this.logger),this.pairingTopics=new mL(this.core,this.logger),this.requests=new yL(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var EL=Object.defineProperty,CL=(t,e,n)=>e in t?EL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ne=(t,e,n)=>CL(t,typeof e!="symbol"?e+"":e,n);let _L=class q1 extends rx{constructor(e){super(e),Ne(this,"protocol",F1),Ne(this,"version",j1),Ne(this,"name",ih.name),Ne(this,"metadata"),Ne(this,"core"),Ne(this,"logger"),Ne(this,"events",new zn.EventEmitter),Ne(this,"engine"),Ne(this,"session"),Ne(this,"proposal"),Ne(this,"pendingRequest"),Ne(this,"auth"),Ne(this,"signConfig"),Ne(this,"on",(r,s)=>this.events.on(r,s)),Ne(this,"once",(r,s)=>this.events.once(r,s)),Ne(this,"off",(r,s)=>this.events.off(r,s)),Ne(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Ne(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Ne(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Ne(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Ne(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Ne(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||ih.name,this.metadata=H5(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const n=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Lc($o({level:(e==null?void 0:e.logger)||ih.logger}));this.core=(e==null?void 0:e.core)||new KM(e),this.logger=Vt(n,this.name),this.session=new fL(this.core,this.logger),this.proposal=new hL(this.core,this.logger),this.pendingRequest=new pL(this.core,this.logger),this.engine=new dL(this),this.auth=new vL(this.core,this.logger)}static async init(e){const n=new q1(e);return await n.initialize(),n}get context(){return gn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},V.toMiliseconds(V.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Uf={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof mr<"u"&&mr,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof mr<"u"&&mr||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function u(C){return C&&DataView.prototype.isPrototypeOf(C)}if(c.arrayBuffer)var l=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(C){return C&&l.indexOf(Object.prototype.toString.call(C))>-1};function h(C){if(typeof C!="string"&&(C=String(C)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(C)||C==="")throw new TypeError('Invalid character in header field name: "'+C+'"');return C.toLowerCase()}function f(C){return typeof C!="string"&&(C=String(C)),C}function p(C){var I={next:function(){var x=C.shift();return{done:x===void 0,value:x}}};return c.iterable&&(I[Symbol.iterator]=function(){return I}),I}function g(C){this.map={},C instanceof g?C.forEach(function(I,x){this.append(x,I)},this):Array.isArray(C)?C.forEach(function(I){if(I.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+I.length);this.append(I[0],I[1])},this):C&&Object.getOwnPropertyNames(C).forEach(function(I){this.append(I,C[I])},this)}g.prototype.append=function(C,I){C=h(C),I=f(I);var x=this.map[C];this.map[C]=x?x+", "+I:I},g.prototype.delete=function(C){delete this.map[h(C)]},g.prototype.get=function(C){return C=h(C),this.has(C)?this.map[C]:null},g.prototype.has=function(C){return this.map.hasOwnProperty(h(C))},g.prototype.set=function(C,I){this.map[h(C)]=f(I)},g.prototype.forEach=function(C,I){for(var x in this.map)this.map.hasOwnProperty(x)&&C.call(I,this.map[x],x,this)},g.prototype.keys=function(){var C=[];return this.forEach(function(I,x){C.push(x)}),p(C)},g.prototype.values=function(){var C=[];return this.forEach(function(I){C.push(I)}),p(C)},g.prototype.entries=function(){var C=[];return this.forEach(function(I,x){C.push([x,I])}),p(C)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(C){if(!C._noBody){if(C.bodyUsed)return Promise.reject(new TypeError("Already read"));C.bodyUsed=!0}}function v(C){return new Promise(function(I,x){C.onload=function(){I(C.result)},C.onerror=function(){x(C.error)}})}function w(C){var I=new FileReader,x=v(I);return I.readAsArrayBuffer(C),x}function b(C){var I=new FileReader,x=v(I),R=/charset=([A-Za-z0-9_-]+)/.exec(C.type),O=R?R[1]:"utf-8";return I.readAsText(C,O),x}function S(C){for(var I=new Uint8Array(C),x=new Array(I.length),R=0;R<I.length;R++)x[R]=String.fromCharCode(I[R]);return x.join("")}function _(C){if(C.slice)return C.slice(0);var I=new Uint8Array(C.byteLength);return I.set(new Uint8Array(C)),I.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(C){this.bodyUsed=this.bodyUsed,this._bodyInit=C,C?typeof C=="string"?this._bodyText=C:c.blob&&Blob.prototype.isPrototypeOf(C)?this._bodyBlob=C:c.formData&&FormData.prototype.isPrototypeOf(C)?this._bodyFormData=C:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(C)?this._bodyText=C.toString():c.arrayBuffer&&c.blob&&u(C)?(this._bodyArrayBuffer=_(C.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(C)||d(C))?this._bodyArrayBuffer=_(C):this._bodyText=C=Object.prototype.toString.call(C):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof C=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(C)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var C=m(this);if(C)return C;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var C=m(this);return C||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(w);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var C=m(this);if(C)return C;if(this._bodyBlob)return b(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(S(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(U)}),this.json=function(){return this.text().then(JSON.parse)},this}var N=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(C){var I=C.toUpperCase();return N.indexOf(I)>-1?I:C}function A(C,I){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');I=I||{};var x=I.body;if(C instanceof A){if(C.bodyUsed)throw new TypeError("Already read");this.url=C.url,this.credentials=C.credentials,I.headers||(this.headers=new g(C.headers)),this.method=C.method,this.mode=C.mode,this.signal=C.signal,!x&&C._bodyInit!=null&&(x=C._bodyInit,C.bodyUsed=!0)}else this.url=String(C);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new g(I.headers)),this.method=D(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal||function(){if("AbortController"in a){var M=new AbortController;return M.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&x)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(x),(this.method==="GET"||this.method==="HEAD")&&(I.cache==="no-store"||I.cache==="no-cache")){var R=/([?&])_=[^&]*/;if(R.test(this.url))this.url=this.url.replace(R,"$1_="+new Date().getTime());else{var O=/\?/;this.url+=(O.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}A.prototype.clone=function(){return new A(this,{body:this._bodyInit})};function U(C){var I=new FormData;return C.trim().split("&").forEach(function(x){if(x){var R=x.split("="),O=R.shift().replace(/\+/g," "),M=R.join("=").replace(/\+/g," ");I.append(decodeURIComponent(O),decodeURIComponent(M))}}),I}function P(C){var I=new g,x=C.replace(/\r?\n[\t ]+/g," ");return x.split("\r").map(function(R){return R.indexOf(`
`)===0?R.substr(1,R.length):R}).forEach(function(R){var O=R.split(":"),M=O.shift().trim();if(M){var z=O.join(":").trim();try{I.append(M,z)}catch(Y){console.warn("Response "+Y.message)}}}),I}T.call(A.prototype);function k(C,I){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=I.statusText===void 0?"":""+I.statusText,this.headers=new g(I.headers),this.url=I.url||"",this._initBody(C)}T.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},k.error=function(){var C=new k(null,{status:200,statusText:""});return C.ok=!1,C.status=0,C.type="error",C};var L=[301,302,303,307,308];k.redirect=function(C,I){if(L.indexOf(I)===-1)throw new RangeError("Invalid status code");return new k(null,{status:I,headers:{location:C}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(I,x){this.message=I,this.name=x;var R=Error(I);this.stack=R.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function B(C,I){return new Promise(function(x,R){var O=new A(C,I);if(O.signal&&O.signal.aborted)return R(new o.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function z(){M.abort()}M.onload=function(){var Z={statusText:M.statusText,headers:P(M.getAllResponseHeaders()||"")};O.url.indexOf("file://")===0&&(M.status<200||M.status>599)?Z.status=200:Z.status=M.status,Z.url="responseURL"in M?M.responseURL:Z.headers.get("X-Request-URL");var ae="response"in M?M.response:M.responseText;setTimeout(function(){x(new k(ae,Z))},0)},M.onerror=function(){setTimeout(function(){R(new TypeError("Network request failed"))},0)},M.ontimeout=function(){setTimeout(function(){R(new TypeError("Network request timed out"))},0)},M.onabort=function(){setTimeout(function(){R(new o.DOMException("Aborted","AbortError"))},0)};function Y(Z){try{return Z===""&&a.location.href?a.location.href:Z}catch{return Z}}if(M.open(O.method,Y(O.url),!0),O.credentials==="include"?M.withCredentials=!0:O.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&(c.blob?M.responseType="blob":c.arrayBuffer&&(M.responseType="arraybuffer")),I&&typeof I.headers=="object"&&!(I.headers instanceof g||a.Headers&&I.headers instanceof a.Headers)){var ee=[];Object.getOwnPropertyNames(I.headers).forEach(function(Z){ee.push(h(Z)),M.setRequestHeader(Z,f(I.headers[Z]))}),O.headers.forEach(function(Z,ae){ee.indexOf(ae)===-1&&M.setRequestHeader(ae,Z)})}else O.headers.forEach(function(Z,ae){M.setRequestHeader(ae,Z)});O.signal&&(O.signal.addEventListener("abort",z),M.onreadystatechange=function(){M.readyState===4&&O.signal.removeEventListener("abort",z)}),M.send(typeof O._bodyInit>"u"?null:O._bodyInit)})}return B.polyfill=!0,a.fetch||(a.fetch=B,a.Headers=g,a.Request=A,a.Response=k),o.Headers=g,o.Request=A,o.Response=k,o.fetch=B,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Uf,Uf.exports);var AL=Uf.exports;const bw=Il(AL);var IL=Object.defineProperty,SL=Object.defineProperties,NL=Object.getOwnPropertyDescriptors,vw=Object.getOwnPropertySymbols,TL=Object.prototype.hasOwnProperty,xL=Object.prototype.propertyIsEnumerable,Ew=(t,e,n)=>e in t?IL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cw=(t,e)=>{for(var n in e||(e={}))TL.call(e,n)&&Ew(t,n,e[n]);if(vw)for(var n of vw(e))xL.call(e,n)&&Ew(t,n,e[n]);return t},_w=(t,e)=>SL(t,NL(e));const PL={Accept:"application/json","Content-Type":"application/json"},OL="POST",Aw={headers:PL,method:OL},Iw=10;let ar=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new zn.EventEmitter,this.isAvailable=!1,this.registering=!1,!zy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=Jr(e),r=await(await bw(this.url,_w(Cw({},Aw),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!zy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=Jr({id:1,jsonrpc:"2.0",method:"test",params:[]});await bw(e,_w(Cw({},Aw),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?bi(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=nd(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return b1(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Iw&&this.events.setMaxListeners(Iw)}};const Sw="error",RL="wss://relay.walletconnect.org",DL="wc",$L="universal_provider",vu=`${DL}@2:${$L}:`,H1="https://rpc.walletconnect.org/v1/",oo="generic",kL=`${H1}bundler`,Hn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function Xp(t){return t==null||typeof t!="object"&&typeof t!="function"}function W1(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function V1(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const UL="[object RegExp]",G1="[object String]",K1="[object Number]",Y1="[object Boolean]",Z1="[object Arguments]",ML="[object Symbol]",LL="[object Date]",BL="[object Map]",FL="[object Set]",jL="[object Array]",zL="[object ArrayBuffer]",qL="[object Object]",HL="[object DataView]",WL="[object Uint8Array]",VL="[object Uint8ClampedArray]",GL="[object Uint16Array]",KL="[object Uint32Array]",YL="[object Int8Array]",ZL="[object Int16Array]",JL="[object Int32Array]",XL="[object Float32Array]",QL="[object Float64Array]";function Qp(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function eB(t,e){return lo(t,void 0,t,new Map,e)}function lo(t,e,n,r=new Map,s=void 0){const i=s==null?void 0:s(t,e,n,r);if(i!=null)return i;if(Xp(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=lo(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,lo(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(lo(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Qp(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=lo(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),Qs(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),Qs(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),Qs(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,Qs(o,t,n,r,s),o}if(typeof t=="object"&&tB(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),Qs(o,t,n,r,s),o}return t}function Qs(t,e,n=t,r,s){const i=[...Object.keys(e),...W1(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=lo(e[a],a,n,r,s))}}function tB(t){switch(V1(t)){case Z1:case jL:case zL:case HL:case Y1:case LL:case XL:case QL:case YL:case ZL:case JL:case BL:case K1:case qL:case UL:case FL:case G1:case ML:case WL:case VL:case GL:case KL:return!0;default:return!1}}function nB(t,e){return eB(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case K1:case G1:case Y1:{const o=new t.constructor(t==null?void 0:t.valueOf());return Qs(o,t),o}case Z1:{const o={};return Qs(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function Nw(t){return nB(t)}function Tw(t){return t!==null&&typeof t=="object"&&V1(t)==="[object Arguments]"}function xw(t){return typeof t=="object"&&t!==null}function rB(){}function sB(t){return Qp(t)}function iB(t){var n;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const r=t[Symbol.toStringTag];return r==null||!((n=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&n.writable)?!1:t.toString()===`[object ${r}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function oB(t){if(Xp(t))return t;if(Array.isArray(t)||Qp(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function aB(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=Mf(s,o,r,new Map)}return s}function Mf(t,e,n,r){if(Xp(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return oB(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...W1(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(Tw(a)&&(a={...a}),Tw(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=Nw(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const l=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];l[f]=c[f]}c=l}else c=[];const u=n(c,a,o,t,e,r);u!=null?t[o]=u:Array.isArray(a)||xw(c)&&xw(a)?t[o]=Mf(c,a,n,r):c==null&&iB(a)?t[o]=Mf({},a,n,r):c==null&&sB(a)?t[o]=Nw(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function cB(t,...e){return aB(t,...e,rB)}var uB=Object.defineProperty,lB=Object.defineProperties,dB=Object.getOwnPropertyDescriptors,Pw=Object.getOwnPropertySymbols,hB=Object.prototype.hasOwnProperty,fB=Object.prototype.propertyIsEnumerable,Ow=(t,e,n)=>e in t?uB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Eu=(t,e)=>{for(var n in e||(e={}))hB.call(e,n)&&Ow(t,n,e[n]);if(Pw)for(var n of Pw(e))fB.call(e,n)&&Ow(t,n,e[n]);return t},pB=(t,e)=>lB(t,dB(e));function Sn(t,e,n){var r;const s=po(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${H1}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function ki(t){return t.includes(":")?t.split(":")[1]:t}function J1(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function gB(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function Cu(t={},e={}){const n=Rw(t),r=Rw(e);return cB(n,r)}function Rw(t){var e,n,r,s,i;const o={};if(!Ts(t))return o;for(const[a,c]of Object.entries(t)){const u=ed(a)?[a]:c.chains,l=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=uo(a);o[f]=pB(Eu(Eu({},o[f]),c),{chains:Ir(u,(e=o[f])==null?void 0:e.chains),methods:Ir(l,(n=o[f])==null?void 0:n.methods),events:Ir(d,(r=o[f])==null?void 0:r.events)}),(Ts(h)||Ts(((s=o[f])==null?void 0:s.rpcMap)||{}))&&(o[f].rpcMap=Eu(Eu({},h),(i=o[f])==null?void 0:i.rpcMap))}return o}function Dw(t){return t.includes(":")?t.split(":")[2]:t}function $w(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=ed(n)?[n]:r.chains?r.chains:J1(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function ch(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const X1={},Ue=t=>X1[t],uh=(t,e)=>{X1[t]=e};var mB=Object.defineProperty,yB=(t,e,n)=>e in t?mB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vi=(t,e,n)=>yB(t,typeof e!="symbol"?e+"":e,n);class wB{constructor(e){Vi(this,"name","polkadot"),Vi(this,"client"),Vi(this,"httpProviders"),Vi(this,"events"),Vi(this,"namespace"),Vi(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ki(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var bB=Object.defineProperty,vB=Object.defineProperties,EB=Object.getOwnPropertyDescriptors,kw=Object.getOwnPropertySymbols,CB=Object.prototype.hasOwnProperty,_B=Object.prototype.propertyIsEnumerable,Lf=(t,e,n)=>e in t?bB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Uw=(t,e)=>{for(var n in e||(e={}))CB.call(e,n)&&Lf(t,n,e[n]);if(kw)for(var n of kw(e))_B.call(e,n)&&Lf(t,n,e[n]);return t},Mw=(t,e)=>vB(t,EB(e)),Gi=(t,e,n)=>Lf(t,typeof e!="symbol"?e+"":e,n);class AB{constructor(e){Gi(this,"name","eip155"),Gi(this,"client"),Gi(this,"chainId"),Gi(this,"namespace"),Gi(this,"httpProviders"),Gi(this,"events"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n),this.chainId=parseInt(e),this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||Sn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(ki(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[],u=`${a}${c.join(",")}`;if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),d=((o=l==null?void 0:l.sessionProperties)==null?void 0:o.capabilities)||{};if(d!=null&&d[u])return d==null?void 0:d[u];const h=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Mw(Uw({},l.sessionProperties||{}),{capabilities:Mw(Uw({},d||{}),{[u]:h})})})}catch(f){console.warn("Failed to update session with capabilities",f)}return h}async getCallStatus(e){var n,r;const s=this.client.session.get(e.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_s("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${kL}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}}var IB=Object.defineProperty,SB=(t,e,n)=>e in t?IB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ki=(t,e,n)=>SB(t,typeof e!="symbol"?e+"":e,n);class NB{constructor(e){Ki(this,"name","solana"),Ki(this,"client"),Ki(this,"httpProviders"),Ki(this,"events"),Ki(this,"namespace"),Ki(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ki(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var TB=Object.defineProperty,xB=(t,e,n)=>e in t?TB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yi=(t,e,n)=>xB(t,typeof e!="symbol"?e+"":e,n);class PB{constructor(e){Yi(this,"name","cosmos"),Yi(this,"client"),Yi(this,"httpProviders"),Yi(this,"events"),Yi(this,"namespace"),Yi(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ki(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var OB=Object.defineProperty,RB=(t,e,n)=>e in t?OB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zi=(t,e,n)=>RB(t,typeof e!="symbol"?e+"":e,n);class DB{constructor(e){Zi(this,"name","algorand"),Zi(this,"client"),Zi(this,"httpProviders"),Zi(this,"events"),Zi(this,"namespace"),Zi(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(!this.httpProviders[e]){const r=n||Sn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new qn(new ar(r,Ue("disableProviderPing")))}}var $B=Object.defineProperty,kB=(t,e,n)=>e in t?$B(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ji=(t,e,n)=>kB(t,typeof e!="symbol"?e+"":e,n);class UB{constructor(e){Ji(this,"name","cip34"),Ji(this,"client"),Ji(this,"httpProviders"),Ji(this,"events"),Ji(this,"namespace"),Ji(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=ki(n);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}getCardanoRPCUrl(e){const n=this.namespace.rpcMap;if(n)return n[e]}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var MB=Object.defineProperty,LB=(t,e,n)=>e in t?MB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xi=(t,e,n)=>LB(t,typeof e!="symbol"?e+"":e,n);class BB{constructor(e){Xi(this,"name","elrond"),Xi(this,"client"),Xi(this,"httpProviders"),Xi(this,"events"),Xi(this,"namespace"),Xi(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ki(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var FB=Object.defineProperty,jB=(t,e,n)=>e in t?FB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qi=(t,e,n)=>jB(t,typeof e!="symbol"?e+"":e,n);class zB{constructor(e){Qi(this,"name","multiversx"),Qi(this,"client"),Qi(this,"httpProviders"),Qi(this,"events"),Qi(this,"namespace"),Qi(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=ki(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var qB=Object.defineProperty,HB=(t,e,n)=>e in t?qB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,eo=(t,e,n)=>HB(t,typeof e!="symbol"?e+"":e,n);class WB{constructor(e){eo(this,"name","near"),eo(this,"client"),eo(this,"httpProviders"),eo(this,"events"),eo(this,"namespace"),eo(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||Sn(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace);return typeof r>"u"?void 0:new qn(new ar(r,Ue("disableProviderPing")))}}var VB=Object.defineProperty,GB=(t,e,n)=>e in t?VB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,to=(t,e,n)=>GB(t,typeof e!="symbol"?e+"":e,n);class KB{constructor(e){to(this,"name","tezos"),to(this,"client"),to(this,"httpProviders"),to(this,"events"),to(this,"namespace"),to(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||Sn(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{e[n]=this.createHttpProvider(n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace);return typeof r>"u"?void 0:new qn(new ar(r))}}var YB=Object.defineProperty,ZB=(t,e,n)=>e in t?YB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,no=(t,e,n)=>ZB(t,typeof e!="symbol"?e+"":e,n);class JB{constructor(e){no(this,"name",oo),no(this,"client"),no(this,"httpProviders"),no(this,"events"),no(this,"namespace"),no(this,"chainId"),this.namespace=e.namespace,this.events=Ue("events"),this.client=Ue("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(Hn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{const i=po(s);r[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),r}getHttpProvider(e){const n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||Sn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new qn(new ar(r,Ue("disableProviderPing")))}}var XB=Object.defineProperty,QB=Object.defineProperties,e9=Object.getOwnPropertyDescriptors,Lw=Object.getOwnPropertySymbols,t9=Object.prototype.hasOwnProperty,n9=Object.prototype.propertyIsEnumerable,Bf=(t,e,n)=>e in t?XB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_u=(t,e)=>{for(var n in e||(e={}))t9.call(e,n)&&Bf(t,n,e[n]);if(Lw)for(var n of Lw(e))n9.call(e,n)&&Bf(t,n,e[n]);return t},lh=(t,e)=>QB(t,e9(e)),On=(t,e,n)=>Bf(t,typeof e!="symbol"?e+"":e,n);let r9=class Q1{constructor(e){On(this,"client"),On(this,"namespaces"),On(this,"optionalNamespaces"),On(this,"sessionProperties"),On(this,"scopedProperties"),On(this,"events",new bp),On(this,"rpcProviders",{}),On(this,"session"),On(this,"providerOpts"),On(this,"logger"),On(this,"uri"),On(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Lc($o({level:(e==null?void 0:e.logger)||Sw})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const n=new Q1(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:_u({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,td(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:rt("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=$w(this.session.namespaces);this.namespaces=Cu(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){const{uri:n,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=$w(s.namespaces);return this.namespaces=Cu(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e),i=this.getProvider(r);i.name===oo?i.setDefaultChain(`${r}:${s}`,n):i.setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(Yr(n)){for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await _L.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Sw,relayUrl:this.providerOpts.relayUrl||RL,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>uo(n)))];uh("client",this.client),uh("events",this.events),uh("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=gB(n,this.session),s=J1(r),i=Cu(this.namespaces,this.optionalNamespaces),o=lh(_u({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new AB({namespace:o});break;case"algorand":this.rpcProviders[n]=new DB({namespace:o});break;case"solana":this.rpcProviders[n]=new NB({namespace:o});break;case"cosmos":this.rpcProviders[n]=new PB({namespace:o});break;case"polkadot":this.rpcProviders[n]=new wB({namespace:o});break;case"cip34":this.rpcProviders[n]=new UB({namespace:o});break;case"elrond":this.rpcProviders[n]=new BB({namespace:o});break;case"multiversx":this.rpcProviders[n]=new zB({namespace:o});break;case"near":this.rpcProviders[n]=new WB({namespace:o});break;case"tezos":this.rpcProviders[n]=new KB({namespace:o});break;default:this.rpcProviders[oo]?this.rpcProviders[oo].updateNamespace(o):this.rpcProviders[oo]=new JB({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&Yr(o)&&this.events.emit("accountsChanged",o.map(Dw))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=uo(o),u=ch(o)!==ch(a)?`${c}:${ch(a)}`:o;this.onChainChanged(u)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=lh(_u({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",lh(_u({},rt("USER_DISCONNECTED")),{data:e.topic})))}),this.on(Hn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[oo]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Cu(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>uo(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=uo(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s),this.events.emit("chainChanged",s);const i=this.getProvider(r).getDefaultChain();n||this.getProvider(r).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(Dw);if(!Yr(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${vu}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${vu}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${vu}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(vu)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}},Gs=null;const Un={getSIWX(){return F.state.siwx},async initializeIfEnabled(){var i;const t=F.state.siwx,e=E.getActiveCaipAddress();if(!(t&&e))return;const[n,r,s]=e.split(":");if(E.checkIfSupportedNetwork(n))try{if(Gs&&await Gs,(await t.getSessions(`${n}:${r}`,s)).length)return;await $e.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),qe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((i=J._getClient())==null?void 0:i.disconnect().catch(console.error)),ge.reset("Connect"),vr.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=F.state.siwx,e=ie.getPlainAddress(E.getActiveCaipAddress()),n=E.getActiveCaipNetwork(),r=J._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),i=s.toString();K.getConnectorId(n.chainNamespace)===$.CONNECTOR_ID.AUTH&&ge.pushTransactionStack({});const a=await r.signMessage(i);await t.addSession({data:s,message:i,signature:a}),E.setLastConnectedSIWECaipNetwork(n),$e.close(),qe.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!$e.state.open||ge.state.view==="ApproveTransaction")&&await $e.open({view:"SIWXSignMessage"}),vr.showError("Error signing message"),qe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();if((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e)){const r=E.getLastConnectedSIWECaipNetwork();if(r){const s=await(e==null?void 0:e.getSessions(r==null?void 0:r.caipNetworkId,ie.getPlainAddress(E.getActiveCaipAddress())||""));s&&s.length>0?await E.switchActiveNetwork(r):await J.disconnect()}else await J.disconnect()}else $e.close();$e.close(),qe.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const t=this.getSIWX(),e=E.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await(t==null?void 0:t.getSessions(r.caipNetworkId,ie.getPlainAddress(E.getActiveCaipAddress())||""));s&&n.push(...s)})),n},async getSessions(t){const e=F.state.siwx;let n=t==null?void 0:t.address;if(!n){const s=E.getActiveCaipAddress();n=ie.getPlainAddress(s)}let r=t==null?void 0:t.caipNetworkId;if(!r){const s=E.getActiveCaipNetwork();r=s==null?void 0:s.caipNetworkId}return e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const n=ge.state.view==="ApproveTransaction",r=ge.state.view==="SIWXSignMessage";if(n||r)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){var u;const i=Un.getSIWX();if(!i||!s.includes($.CHAIN.EVM)){const l=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:l.address,chainId:l.chainId,accounts:l.accounts}}const o=await i.createMessage({chainId:((u=E.getActiveCaipNetwork())==null?void 0:u.caipNetworkId)||"",accountAddress:"<<AccountAddress>>"}),a={accountAddress:o.accountAddress,chainId:o.chainId,domain:o.domain,uri:o.uri,version:o.version,nonce:o.nonce,notBefore:o.notBefore,statement:o.statement,resources:o.resources,requestId:o.requestId,issuedAt:o.issuedAt,expirationTime:o.expirationTime,serializedMessage:o.toString()},c=await t.connect({chainId:e,socialUri:n,siwxMessage:a,preferredAccountType:r});return a.accountAddress=c.address,a.serializedMessage=c.message||"",c.signature&&c.message&&await Un.addEmbeddedWalletSession(a,c.message,c.signature),{address:c.address,chainId:c.chainId,accounts:c.accounts}},async addEmbeddedWalletSession(t,e,n){if(Gs)return Gs;const r=Un.getSIWX();return r?(Gs=r.addSession({data:t,message:e,signature:n}).finally(()=>{Gs=null}),Gs):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){var a,c,u;const r=Un.getSIWX(),s=new Set(e.map(l=>l.split(":")[0]));if(!r||s.size!==1||!s.has("eip155"))return!1;const i=await r.createMessage({chainId:((a=E.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await t.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:n,chains:[i.chainId,...e.filter(l=>l!==i.chainId)]});if(vr.showLoading("Authenticating...",{autoClose:!1}),ce.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(s)[0]),(u=o==null?void 0:o.auths)!=null&&u.length){const l=o.auths.map(d=>{const h=t.client.formatAuthMessage({request:d.p,iss:d.p.iss});return{data:{...d.p,accountAddress:d.p.iss.split(":").slice(-1).join(""),chainId:d.p.iss.split(":").slice(2,4).join(":"),uri:d.p.aud,version:d.p.version||i.version,expirationTime:d.p.exp,issuedAt:d.p.iat,notBefore:d.p.nbf},message:h,signature:d.s.s,cacao:d}});try{await r.setSessions(l),qe.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Un.getSIWXEventProperties()})}catch(d){throw console.error("SIWX:universalProviderAuth - failed to set sessions",d),qe.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Un.getSIWXEventProperties()}),await t.disconnect().catch(console.error),d}finally{vr.hide()}}return!0},getSIWXEventProperties(){var e;const t=E.state.activeChain;if(!t)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:((e=E.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:In(t)===wt.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},tt={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:$.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},vn={ConnectorExplorerIds:{[$.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[$.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[$.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[$.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[$.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[tt.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[tt.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[tt.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[tt.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[tt.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[tt.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[tt.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[tt.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[tt.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[tt.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[tt.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[$.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[$.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[$.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[$.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[$.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[$.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[$.CONNECTOR_ID.INJECTED]:"Browser Wallet",[$.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[$.CONNECTOR_ID.COINBASE]:"Coinbase",[$.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[$.CONNECTOR_ID.LEDGER]:"Ledger",[$.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[$.CONNECTOR_ID.INJECTED]:"INJECTED",[$.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[$.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[$.CONNECTOR_ID.AUTH]:"AUTH",[tt.CONNECTOR_TYPE_AUTH]:"AUTH"}},At={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${tt.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const t=E.state.activeChain;return $.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>K.getConnectorId(e)===$.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})}},s9=new AbortController,it={EmbeddedWalletAbortController:s9,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found. Please make sure it is included in 'networks' array in createAppKit function."},ORIGIN_NOT_ALLOWED:{shortMessage:"Origin Not Allowed",longMessage:()=>` Origin ${i9()?window.origin:"unknown"} not found on allow list. Please update your project configurations on dashboard.reown.com.`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Unverified Domain",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider. Please check your time settings and connect again."},INVALID_PROJECT_ID:{shortMessage:"Invalid Project ID",longMessage:"The project ID is invalid. Visit dashboard.reown.com to get a new one."},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured. Please update your project configurations on dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{shortMessage:"Server Error",longMessage:t=>`Failed to get App Configuration ${t||""}`},RATE_LIMITED_APP_CONFIGURATION:{shortMessage:"Rate Limited",longMessage:"Rate limited when trying to get the App Configuration"}}};function i9(){return typeof window<"u"}const o9={createLogger(t,e="error"){const n=$o({level:e}),{logger:r}=Ep({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},a9="rpc.walletconnect.org";function Bw(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const dh=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],br={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===a9}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:$.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${$.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){var s,i,o;const r=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return dh.includes(e)?Bw(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){var h,f,p,g,m,v,w;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(p=(f=(h=t.rpcUrls)==null?void 0:h.default)==null?void 0:f.http)==null?void 0:p[0],a=this.getDefaultRpcUrl(t,i,n),c=((v=(m=(g=t==null?void 0:t.rpcUrls)==null?void 0:g.chainDefault)==null?void 0:m.http)==null?void 0:v[0])||o,u=((w=r==null?void 0:r[i])==null?void 0:w.map(b=>b.url))||[],l=[...u,...a?[a]:[]],d=[...u];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:vn.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:l},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>br.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){var s,i,o;const r=[];return n==null||n.forEach(a=>{r.push(nu(a.url,a.config))}),dh.includes(t.caipNetworkId)&&r.push(nu(Bw(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{r.push(nu(a))}),Hg(r)},extendWagmiTransports(t,e,n){if(dh.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return Hg([n,nu(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:$.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var c;const e=H.getActiveCaipNetworkId(),n=E.getAllRequestedCaipNetworks(),r=Array.from(((c=E.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?r.includes(s):!1,o=n==null?void 0:n.find(u=>u.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(n==null?void 0:n[0])}},fl={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},sn=Ye({providers:{...fl},providerIds:{...fl}}),Ve={state:sn,subscribeKey(t,e){return $t(sn,t,e)},subscribe(t){return Dt(sn,()=>{t(sn)})},subscribeProviders(t){return Dt(sn.providers,()=>t(sn.providers))},setProvider(t,e){t&&e&&(sn.providers[t]=hi(e))},getProvider(t){if(t)return sn.providers[t]},setProviderId(t,e){e&&(sn.providerIds[t]=e)},getProviderId(t){if(t)return sn.providerIds[t]},reset(){sn.providers={...fl},sn.providerIds={...fl}},resetChain(t){sn.providers[t]=void 0,sn.providerIds[t]=void 0}},eC={BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org"},c9={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},Fw={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Ot={set(t,e){Cn.isClient&&localStorage.setItem(`${oe.STORAGE_KEY}${t}`,e)},get(t){return Cn.isClient?localStorage.getItem(`${oe.STORAGE_KEY}${t}`):null},delete(t,e){Cn.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${oe.STORAGE_KEY}${t}`))}},Au=30*1e3,Cn={checkIfAllowedToTriggerEmail(){const t=Ot.get(oe.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Au){const n=Math.ceil((Au-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Ot.get(oe.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<Au)return Math.ceil((Au-e)/1e3)}return 0},checkIfRequestExists(t){return wt.NOT_SAFE_RPC_METHODS.includes(t.method)||wt.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(Fw.transactionHash))||(t==null?void 0:t.match(Fw.signedMessage)))?oe.RPC_RESPONSE_TYPE_TX:oe.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return wt.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var ke;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(ke||(ke={}));var Ff;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(Ff||(Ff={}));const te=ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),vs=t=>{switch(typeof t){case"undefined":return te.undefined;case"string":return te.string;case"number":return isNaN(t)?te.nan:te.number;case"boolean":return te.boolean;case"function":return te.function;case"bigint":return te.bigint;case"symbol":return te.symbol;case"object":return Array.isArray(t)?te.array:t===null?te.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?te.promise:typeof Map<"u"&&t instanceof Map?te.map:typeof Set<"u"&&t instanceof Set?te.set:typeof Date<"u"&&t instanceof Date?te.date:te.object;default:return te.unknown}},W=ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),u9=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class nr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const u=o.path[c];c===o.path.length-1?(a[u]=a[u]||{_errors:[]},a[u]._errors.push(n(o))):a[u]=a[u]||{_errors:[]},a=a[u],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,ke.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}nr.create=t=>new nr(t);const fc=(t,e)=>{let n;switch(t.code){case W.invalid_type:t.received===te.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case W.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,ke.jsonStringifyReplacer)}`;break;case W.unrecognized_keys:n=`Unrecognized key(s) in object: ${ke.joinValues(t.keys,", ")}`;break;case W.invalid_union:n="Invalid input";break;case W.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${ke.joinValues(t.options)}`;break;case W.invalid_enum_value:n=`Invalid enum value. Expected ${ke.joinValues(t.options)}, received '${t.received}'`;break;case W.invalid_arguments:n="Invalid function arguments";break;case W.invalid_return_type:n="Invalid function return type";break;case W.invalid_date:n="Invalid date";break;case W.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:ke.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case W.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case W.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case W.custom:n="Invalid input";break;case W.invalid_intersection_types:n="Intersection results could not be merged";break;case W.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case W.not_finite:n="Number must be finite";break;default:n=e.defaultError,ke.assertNever(t)}return{message:n}};let tC=fc;function l9(t){tC=t}function pl(){return tC}const gl=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(u=>!!u).slice().reverse();for(const u of c)a=u(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},d9=[];function se(t,e){const n=gl({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,pl(),fc].filter(r=>!!r)});t.common.issues.push(n)}class Wt{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return we;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return Wt.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return we;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const we=Object.freeze({status:"aborted"}),nC=t=>({status:"dirty",value:t}),Zt=t=>({status:"valid",value:t}),jf=t=>t.status==="aborted",zf=t=>t.status==="dirty",pc=t=>t.status==="valid",ml=t=>typeof Promise<"u"&&t instanceof Promise;var de;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(de||(de={}));class Pr{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const jw=(t,e)=>{if(pc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new nr(t.common.issues);return this._error=n,this._error}}};function Ee(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class _e{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return vs(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:vs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Wt,ctx:{common:e.parent.common,data:e.data,parsedType:vs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ml(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:vs(e)},i=this._parseSync({data:e,path:s.path,parent:s});return jw(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:vs(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(ml(s)?s:Promise.resolve(s));return jw(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:W.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new ir({schema:this,typeName:me.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Zr.create(this,this._def)}nullable(){return Ii.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return rr.create(this,this._def)}promise(){return No.create(this,this._def)}or(e){return wc.create([this,e],this._def)}and(e){return bc.create(this,e,this._def)}transform(e){return new ir({...Ee(this._def),schema:this,typeName:me.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Ac({...Ee(this._def),innerType:this,defaultValue:n,typeName:me.ZodDefault})}brand(){return new sC({typeName:me.ZodBranded,type:this,...Ee(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new vl({...Ee(this._def),innerType:this,catchValue:n,typeName:me.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Gc.create(this,e)}readonly(){return Cl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const h9=/^c[^\s-]{8,}$/i,f9=/^[a-z][a-z0-9]*$/,p9=/^[0-9A-HJKMNP-TV-Z]{26}$/,g9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,m9=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,y9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let hh;const w9=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,b9=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,v9=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function E9(t,e){return!!((e==="v4"||!e)&&w9.test(t)||(e==="v6"||!e)&&b9.test(t))}class er extends _e{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==te.string){const i=this._getOrReturnCtx(e);return se(i,{code:W.invalid_type,expected:te.string,received:i.parsedType}),we}const r=new Wt;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),se(s,{code:W.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),se(s,{code:W.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?se(s,{code:W.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&se(s,{code:W.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")m9.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"email",code:W.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")hh||(hh=new RegExp(y9,"u")),hh.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"emoji",code:W.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")g9.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"uuid",code:W.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")h9.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"cuid",code:W.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")f9.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"cuid2",code:W.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")p9.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"ulid",code:W.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),se(s,{validation:"url",code:W.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"regex",code:W.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),se(s,{code:W.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),se(s,{code:W.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),se(s,{code:W.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?v9(i).test(e.data)||(s=this._getOrReturnCtx(e,s),se(s,{code:W.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?E9(e.data,i.version)||(s=this._getOrReturnCtx(e,s),se(s,{validation:"ip",code:W.invalid_string,message:i.message}),r.dirty()):ke.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:W.invalid_string,...de.errToObj(r)})}_addCheck(e){return new er({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...de.errToObj(e)})}url(e){return this._addCheck({kind:"url",...de.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...de.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...de.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...de.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...de.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...de.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...de.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...de.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...de.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...de.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...de.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...de.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...de.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...de.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...de.errToObj(n)})}nonempty(e){return this.min(1,de.errToObj(e))}trim(){return new er({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new er({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new er({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}er.create=t=>{var e;return new er({checks:[],typeName:me.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ee(t)})};function C9(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Ms extends _e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==te.number){const i=this._getOrReturnCtx(e);return se(i,{code:W.invalid_type,expected:te.number,received:i.parsedType}),we}let r;const s=new Wt;for(const i of this._def.checks)i.kind==="int"?ke.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),se(r,{code:W.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),se(r,{code:W.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),se(r,{code:W.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?C9(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),se(r,{code:W.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),se(r,{code:W.not_finite,message:i.message}),s.dirty()):ke.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,de.toString(n))}gt(e,n){return this.setLimit("min",e,!1,de.toString(n))}lte(e,n){return this.setLimit("max",e,!0,de.toString(n))}lt(e,n){return this.setLimit("max",e,!1,de.toString(n))}setLimit(e,n,r,s){return new Ms({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:de.toString(s)}]})}_addCheck(e){return new Ms({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:de.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:de.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:de.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:de.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:de.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:de.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:de.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:de.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:de.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ke.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ms.create=t=>new Ms({checks:[],typeName:me.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ee(t)});class Ls extends _e{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==te.bigint){const i=this._getOrReturnCtx(e);return se(i,{code:W.invalid_type,expected:te.bigint,received:i.parsedType}),we}let r;const s=new Wt;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),se(r,{code:W.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),se(r,{code:W.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),se(r,{code:W.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):ke.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,de.toString(n))}gt(e,n){return this.setLimit("min",e,!1,de.toString(n))}lte(e,n){return this.setLimit("max",e,!0,de.toString(n))}lt(e,n){return this.setLimit("max",e,!1,de.toString(n))}setLimit(e,n,r,s){return new Ls({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:de.toString(s)}]})}_addCheck(e){return new Ls({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:de.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:de.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:de.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:de.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:de.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ls.create=t=>{var e;return new Ls({checks:[],typeName:me.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ee(t)})};class gc extends _e{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==te.boolean){const r=this._getOrReturnCtx(e);return se(r,{code:W.invalid_type,expected:te.boolean,received:r.parsedType}),we}return Zt(e.data)}}gc.create=t=>new gc({typeName:me.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ee(t)});class _i extends _e{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==te.date){const i=this._getOrReturnCtx(e);return se(i,{code:W.invalid_type,expected:te.date,received:i.parsedType}),we}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return se(i,{code:W.invalid_date}),we}const r=new Wt;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),se(s,{code:W.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),se(s,{code:W.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ke.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new _i({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:de.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:de.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}_i.create=t=>new _i({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:me.ZodDate,...Ee(t)});class yl extends _e{_parse(e){if(this._getType(e)!==te.symbol){const r=this._getOrReturnCtx(e);return se(r,{code:W.invalid_type,expected:te.symbol,received:r.parsedType}),we}return Zt(e.data)}}yl.create=t=>new yl({typeName:me.ZodSymbol,...Ee(t)});class mc extends _e{_parse(e){if(this._getType(e)!==te.undefined){const r=this._getOrReturnCtx(e);return se(r,{code:W.invalid_type,expected:te.undefined,received:r.parsedType}),we}return Zt(e.data)}}mc.create=t=>new mc({typeName:me.ZodUndefined,...Ee(t)});class yc extends _e{_parse(e){if(this._getType(e)!==te.null){const r=this._getOrReturnCtx(e);return se(r,{code:W.invalid_type,expected:te.null,received:r.parsedType}),we}return Zt(e.data)}}yc.create=t=>new yc({typeName:me.ZodNull,...Ee(t)});class So extends _e{constructor(){super(...arguments),this._any=!0}_parse(e){return Zt(e.data)}}So.create=t=>new So({typeName:me.ZodAny,...Ee(t)});class ui extends _e{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Zt(e.data)}}ui.create=t=>new ui({typeName:me.ZodUnknown,...Ee(t)});class Qr extends _e{_parse(e){const n=this._getOrReturnCtx(e);return se(n,{code:W.invalid_type,expected:te.never,received:n.parsedType}),we}}Qr.create=t=>new Qr({typeName:me.ZodNever,...Ee(t)});class wl extends _e{_parse(e){if(this._getType(e)!==te.undefined){const r=this._getOrReturnCtx(e);return se(r,{code:W.invalid_type,expected:te.void,received:r.parsedType}),we}return Zt(e.data)}}wl.create=t=>new wl({typeName:me.ZodVoid,...Ee(t)});class rr extends _e{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==te.array)return se(n,{code:W.invalid_type,expected:te.array,received:n.parsedType}),we;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(se(n,{code:o?W.too_big:W.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(se(n,{code:W.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(se(n,{code:W.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Pr(n,o,n.path,a)))).then(o=>Wt.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Pr(n,o,n.path,a)));return Wt.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new rr({...this._def,minLength:{value:e,message:de.toString(n)}})}max(e,n){return new rr({...this._def,maxLength:{value:e,message:de.toString(n)}})}length(e,n){return new rr({...this._def,exactLength:{value:e,message:de.toString(n)}})}nonempty(e){return this.min(1,e)}}rr.create=(t,e)=>new rr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:me.ZodArray,...Ee(e)});function ao(t){if(t instanceof ot){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Zr.create(ao(r))}return new ot({...t._def,shape:()=>e})}else return t instanceof rr?new rr({...t._def,type:ao(t.element)}):t instanceof Zr?Zr.create(ao(t.unwrap())):t instanceof Ii?Ii.create(ao(t.unwrap())):t instanceof Or?Or.create(t.items.map(e=>ao(e))):t}class ot extends _e{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=ke.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==te.object){const u=this._getOrReturnCtx(e);return se(u,{code:W.invalid_type,expected:te.object,received:u.parsedType}),we}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Qr&&this._def.unknownKeys==="strip"))for(const u in s.data)o.includes(u)||a.push(u);const c=[];for(const u of o){const l=i[u],d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Pr(s,d,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Qr){const u=this._def.unknownKeys;if(u==="passthrough")for(const l of a)c.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(u==="strict")a.length>0&&(se(s,{code:W.unrecognized_keys,keys:a}),r.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const u=this._def.catchall;for(const l of a){const d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Pr(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const u=[];for(const l of c){const d=await l.key;u.push({key:d,value:await l.value,alwaysSet:l.alwaysSet})}return u}).then(u=>Wt.mergeObjectSync(r,u)):Wt.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return de.errToObj,new ot({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=de.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new ot({...this._def,unknownKeys:"strip"})}passthrough(){return new ot({...this._def,unknownKeys:"passthrough"})}extend(e){return new ot({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ot({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:me.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new ot({...this._def,catchall:e})}pick(e){const n={};return ke.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new ot({...this._def,shape:()=>n})}omit(e){const n={};return ke.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new ot({...this._def,shape:()=>n})}deepPartial(){return ao(this)}partial(e){const n={};return ke.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new ot({...this._def,shape:()=>n})}required(e){const n={};return ke.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Zr;)i=i._def.innerType;n[r]=i}}),new ot({...this._def,shape:()=>n})}keyof(){return rC(ke.objectKeys(this.shape))}}ot.create=(t,e)=>new ot({shape:()=>t,unknownKeys:"strip",catchall:Qr.create(),typeName:me.ZodObject,...Ee(e)});ot.strictCreate=(t,e)=>new ot({shape:()=>t,unknownKeys:"strict",catchall:Qr.create(),typeName:me.ZodObject,...Ee(e)});ot.lazycreate=(t,e)=>new ot({shape:t,unknownKeys:"strip",catchall:Qr.create(),typeName:me.ZodObject,...Ee(e)});class wc extends _e{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new nr(a.ctx.common.issues));return se(n,{code:W.invalid_union,unionErrors:o}),we}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const u={...n,common:{...n.common,issues:[]},parent:null},l=c._parseSync({data:n.data,path:n.path,parent:u});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:u}),u.common.issues.length&&o.push(u.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new nr(c));return se(n,{code:W.invalid_union,unionErrors:a}),we}}get options(){return this._def.options}}wc.create=(t,e)=>new wc({options:t,typeName:me.ZodUnion,...Ee(e)});const Bu=t=>t instanceof Ec?Bu(t.schema):t instanceof ir?Bu(t.innerType()):t instanceof Cc?[t.value]:t instanceof Bs?t.options:t instanceof _c?Object.keys(t.enum):t instanceof Ac?Bu(t._def.innerType):t instanceof mc?[void 0]:t instanceof yc?[null]:null;class od extends _e{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==te.object)return se(n,{code:W.invalid_type,expected:te.object,received:n.parsedType}),we;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(se(n,{code:W.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),we)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=Bu(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new od({typeName:me.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...Ee(r)})}}function qf(t,e){const n=vs(t),r=vs(e);if(t===e)return{valid:!0,data:t};if(n===te.object&&r===te.object){const s=ke.objectKeys(e),i=ke.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=qf(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===te.array&&r===te.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=qf(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===te.date&&r===te.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class bc extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(jf(i)||jf(o))return we;const a=qf(i.value,o.value);return a.valid?((zf(i)||zf(o))&&n.dirty(),{status:n.value,value:a.data}):(se(r,{code:W.invalid_intersection_types}),we)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}bc.create=(t,e,n)=>new bc({left:t,right:e,typeName:me.ZodIntersection,...Ee(n)});class Or extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.array)return se(r,{code:W.invalid_type,expected:te.array,received:r.parsedType}),we;if(r.data.length<this._def.items.length)return se(r,{code:W.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),we;!this._def.rest&&r.data.length>this._def.items.length&&(se(r,{code:W.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Pr(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Wt.mergeArray(n,o)):Wt.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Or({...this._def,rest:e})}}Or.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Or({items:t,typeName:me.ZodTuple,rest:null,...Ee(e)})};class vc extends _e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.object)return se(r,{code:W.invalid_type,expected:te.object,received:r.parsedType}),we;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Pr(r,a,r.path,a)),value:o._parse(new Pr(r,r.data[a],r.path,a))});return r.common.async?Wt.mergeObjectAsync(n,s):Wt.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof _e?new vc({keyType:e,valueType:n,typeName:me.ZodRecord,...Ee(r)}):new vc({keyType:er.create(),valueType:e,typeName:me.ZodRecord,...Ee(n)})}}class bl extends _e{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.map)return se(r,{code:W.invalid_type,expected:te.map,received:r.parsedType}),we;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],u)=>({key:s._parse(new Pr(r,a,r.path,[u,"key"])),value:i._parse(new Pr(r,c,r.path,[u,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const u=await c.key,l=await c.value;if(u.status==="aborted"||l.status==="aborted")return we;(u.status==="dirty"||l.status==="dirty")&&n.dirty(),a.set(u.value,l.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const u=c.key,l=c.value;if(u.status==="aborted"||l.status==="aborted")return we;(u.status==="dirty"||l.status==="dirty")&&n.dirty(),a.set(u.value,l.value)}return{status:n.value,value:a}}}}bl.create=(t,e,n)=>new bl({valueType:e,keyType:t,typeName:me.ZodMap,...Ee(n)});class Ai extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.set)return se(r,{code:W.invalid_type,expected:te.set,received:r.parsedType}),we;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(se(r,{code:W.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(se(r,{code:W.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const u=new Set;for(const l of c){if(l.status==="aborted")return we;l.status==="dirty"&&n.dirty(),u.add(l.value)}return{status:n.value,value:u}}const a=[...r.data.values()].map((c,u)=>i._parse(new Pr(r,c,r.path,u)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new Ai({...this._def,minSize:{value:e,message:de.toString(n)}})}max(e,n){return new Ai({...this._def,maxSize:{value:e,message:de.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Ai.create=(t,e)=>new Ai({valueType:t,minSize:null,maxSize:null,typeName:me.ZodSet,...Ee(e)});class go extends _e{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==te.function)return se(n,{code:W.invalid_type,expected:te.function,received:n.parsedType}),we;function r(a,c){return gl({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,pl(),fc].filter(u=>!!u),issueData:{code:W.invalid_arguments,argumentsError:c}})}function s(a,c){return gl({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,pl(),fc].filter(u=>!!u),issueData:{code:W.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof No){const a=this;return Zt(async function(...c){const u=new nr([]),l=await a._def.args.parseAsync(c,i).catch(f=>{throw u.addIssue(r(c,f)),u}),d=await Reflect.apply(o,this,l);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw u.addIssue(s(d,f)),u})})}else{const a=this;return Zt(function(...c){const u=a._def.args.safeParse(c,i);if(!u.success)throw new nr([r(c,u.error)]);const l=Reflect.apply(o,this,u.data),d=a._def.returns.safeParse(l,i);if(!d.success)throw new nr([s(l,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new go({...this._def,args:Or.create(e).rest(ui.create())})}returns(e){return new go({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new go({args:e||Or.create([]).rest(ui.create()),returns:n||ui.create(),typeName:me.ZodFunction,...Ee(r)})}}class Ec extends _e{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Ec.create=(t,e)=>new Ec({getter:t,typeName:me.ZodLazy,...Ee(e)});class Cc extends _e{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return se(n,{received:n.data,code:W.invalid_literal,expected:this._def.value}),we}return{status:"valid",value:e.data}}get value(){return this._def.value}}Cc.create=(t,e)=>new Cc({value:t,typeName:me.ZodLiteral,...Ee(e)});function rC(t,e){return new Bs({values:t,typeName:me.ZodEnum,...Ee(e)})}class Bs extends _e{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return se(n,{expected:ke.joinValues(r),received:n.parsedType,code:W.invalid_type}),we}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return se(n,{received:n.data,code:W.invalid_enum_value,options:r}),we}return Zt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Bs.create(e)}exclude(e){return Bs.create(this.options.filter(n=>!e.includes(n)))}}Bs.create=rC;class _c extends _e{_parse(e){const n=ke.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==te.string&&r.parsedType!==te.number){const s=ke.objectValues(n);return se(r,{expected:ke.joinValues(s),received:r.parsedType,code:W.invalid_type}),we}if(n.indexOf(e.data)===-1){const s=ke.objectValues(n);return se(r,{received:r.data,code:W.invalid_enum_value,options:s}),we}return Zt(e.data)}get enum(){return this._def.values}}_c.create=(t,e)=>new _c({values:t,typeName:me.ZodNativeEnum,...Ee(e)});class No extends _e{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==te.promise&&n.common.async===!1)return se(n,{code:W.invalid_type,expected:te.promise,received:n.parsedType}),we;const r=n.parsedType===te.promise?n.data:Promise.resolve(n.data);return Zt(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}No.create=(t,e)=>new No({type:t,typeName:me.ZodPromise,...Ee(e)});class ir extends _e{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===me.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{se(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?we:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?we:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!pc(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>pc(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);ke.assertNever(s)}}ir.create=(t,e,n)=>new ir({schema:t,typeName:me.ZodEffects,effect:e,...Ee(n)});ir.createWithPreprocess=(t,e,n)=>new ir({schema:e,effect:{type:"preprocess",transform:t},typeName:me.ZodEffects,...Ee(n)});class Zr extends _e{_parse(e){return this._getType(e)===te.undefined?Zt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Zr.create=(t,e)=>new Zr({innerType:t,typeName:me.ZodOptional,...Ee(e)});class Ii extends _e{_parse(e){return this._getType(e)===te.null?Zt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ii.create=(t,e)=>new Ii({innerType:t,typeName:me.ZodNullable,...Ee(e)});class Ac extends _e{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===te.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Ac.create=(t,e)=>new Ac({innerType:t,typeName:me.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ee(e)});class vl extends _e{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ml(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new nr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new nr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}vl.create=(t,e)=>new vl({innerType:t,typeName:me.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ee(e)});class El extends _e{_parse(e){if(this._getType(e)!==te.nan){const r=this._getOrReturnCtx(e);return se(r,{code:W.invalid_type,expected:te.nan,received:r.parsedType}),we}return{status:"valid",value:e.data}}}El.create=t=>new El({typeName:me.ZodNaN,...Ee(t)});const _9=Symbol("zod_brand");class sC extends _e{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Gc extends _e{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?we:i.status==="dirty"?(n.dirty(),nC(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?we:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new Gc({in:e,out:n,typeName:me.ZodPipeline})}}class Cl extends _e{_parse(e){const n=this._def.innerType._parse(e);return pc(n)&&(n.value=Object.freeze(n.value)),n}}Cl.create=(t,e)=>new Cl({innerType:t,typeName:me.ZodReadonly,...Ee(e)});const iC=(t,e={},n)=>t?So.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,u=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...u,fatal:c})}}):So.create(),A9={object:ot.lazycreate};var me;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(me||(me={}));const I9=(t,e={message:`Input not instance of ${t.name}`})=>iC(n=>n instanceof t,e),oC=er.create,aC=Ms.create,S9=El.create,N9=Ls.create,cC=gc.create,T9=_i.create,x9=yl.create,P9=mc.create,O9=yc.create,R9=So.create,D9=ui.create,$9=Qr.create,k9=wl.create,U9=rr.create,M9=ot.create,L9=ot.strictCreate,B9=wc.create,F9=od.create,j9=bc.create,z9=Or.create,q9=vc.create,H9=bl.create,W9=Ai.create,V9=go.create,G9=Ec.create,K9=Cc.create,Y9=Bs.create,Z9=_c.create,J9=No.create,zw=ir.create,X9=Zr.create,Q9=Ii.create,eF=ir.createWithPreprocess,tF=Gc.create,nF=()=>oC().optional(),rF=()=>aC().optional(),sF=()=>cC().optional(),iF={string:t=>er.create({...t,coerce:!0}),number:t=>Ms.create({...t,coerce:!0}),boolean:t=>gc.create({...t,coerce:!0}),bigint:t=>Ls.create({...t,coerce:!0}),date:t=>_i.create({...t,coerce:!0})},oF=we;var y=Object.freeze({__proto__:null,defaultErrorMap:fc,setErrorMap:l9,getErrorMap:pl,makeIssue:gl,EMPTY_PATH:d9,addIssueToContext:se,ParseStatus:Wt,INVALID:we,DIRTY:nC,OK:Zt,isAborted:jf,isDirty:zf,isValid:pc,isAsync:ml,get util(){return ke},get objectUtil(){return Ff},ZodParsedType:te,getParsedType:vs,ZodType:_e,ZodString:er,ZodNumber:Ms,ZodBigInt:Ls,ZodBoolean:gc,ZodDate:_i,ZodSymbol:yl,ZodUndefined:mc,ZodNull:yc,ZodAny:So,ZodUnknown:ui,ZodNever:Qr,ZodVoid:wl,ZodArray:rr,ZodObject:ot,ZodUnion:wc,ZodDiscriminatedUnion:od,ZodIntersection:bc,ZodTuple:Or,ZodRecord:vc,ZodMap:bl,ZodSet:Ai,ZodFunction:go,ZodLazy:Ec,ZodLiteral:Cc,ZodEnum:Bs,ZodNativeEnum:_c,ZodPromise:No,ZodEffects:ir,ZodTransformer:ir,ZodOptional:Zr,ZodNullable:Ii,ZodDefault:Ac,ZodCatch:vl,ZodNaN:El,BRAND:_9,ZodBranded:sC,ZodPipeline:Gc,ZodReadonly:Cl,custom:iC,Schema:_e,ZodSchema:_e,late:A9,get ZodFirstPartyTypeKind(){return me},coerce:iF,any:R9,array:U9,bigint:N9,boolean:cC,date:T9,discriminatedUnion:F9,effect:zw,enum:Y9,function:V9,instanceof:I9,intersection:j9,lazy:G9,literal:K9,map:H9,nan:S9,nativeEnum:Z9,never:$9,null:O9,nullable:Q9,number:aC,object:M9,oboolean:sF,onumber:rF,optional:X9,ostring:nF,pipeline:tF,preprocess:eF,promise:J9,record:q9,set:W9,strictObject:L9,string:oC,symbol:x9,transformer:zw,tuple:z9,undefined:P9,union:B9,unknown:D9,void:k9,NEVER:oF,ZodIssueCode:W,quotelessJson:u9,ZodError:nr});const at=y.object({message:y.string()});function ne(t){return y.literal(oe[t])}const ad=y.object({serializedMessage:y.string().optional(),accountAddress:y.string(),chainId:y.string(),notBefore:y.string().optional(),domain:y.string(),uri:y.string(),version:y.string(),nonce:y.string(),statement:y.string().optional(),resources:y.array(y.string()).optional(),requestId:y.string().optional(),issuedAt:y.string().optional(),expirationTime:y.string().optional()});y.object({accessList:y.array(y.string()),blockHash:y.string().nullable(),blockNumber:y.string().nullable(),chainId:y.string().or(y.number()),from:y.string(),gas:y.string(),hash:y.string(),input:y.string().nullable(),maxFeePerGas:y.string(),maxPriorityFeePerGas:y.string(),nonce:y.string(),r:y.string(),s:y.string(),to:y.string(),transactionIndex:y.string().nullable(),type:y.string(),v:y.string(),value:y.string()});const aF=y.object({chainId:y.string().or(y.number()),rpcUrl:y.optional(y.string())}),cF=y.object({email:y.string().email()}),uF=y.object({otp:y.string()}),lF=y.object({uri:y.string(),preferredAccountType:y.optional(y.string()),chainId:y.optional(y.string().or(y.number())),siwxMessage:y.optional(ad),rpcUrl:y.optional(y.string())}),dF=y.object({chainId:y.optional(y.string().or(y.number())),preferredAccountType:y.optional(y.string()),socialUri:y.optional(y.string()),siwxMessage:y.optional(ad),rpcUrl:y.optional(y.string())}),hF=y.object({provider:y.enum(["google","github","apple","facebook","x","discord"])}),fF=y.object({email:y.string().email()}),pF=y.object({otp:y.string()}),gF=y.object({otp:y.string()}),mF=y.object({themeMode:y.optional(y.enum(["light","dark"])),themeVariables:y.optional(y.record(y.string(),y.string().or(y.number()))),w3mThemeVariables:y.optional(y.record(y.string(),y.string()))}),yF=y.object({metadata:y.object({name:y.string(),description:y.string(),url:y.string(),icons:y.array(y.string())}).optional(),sdkVersion:y.string().optional(),sdkType:y.string().optional(),projectId:y.string()}),wF=y.object({type:y.string()}),bF=y.object({action:y.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),vF=y.object({url:y.string()}),EF=y.object({userName:y.string()}),CF=y.object({email:y.string().optional().nullable(),address:y.string(),chainId:y.string().or(y.number()),accounts:y.array(y.object({address:y.string(),type:y.enum([wt.ACCOUNT_TYPES.EOA,wt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:y.string().optional().nullable(),preferredAccountType:y.optional(y.string()),signature:y.string().optional(),message:y.string().optional(),siwxMessage:y.optional(ad)}),_F=y.object({action:y.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),AF=y.object({email:y.string().email().optional().nullable(),address:y.string(),chainId:y.string().or(y.number()),smartAccountDeployed:y.optional(y.boolean()),accounts:y.array(y.object({address:y.string(),type:y.enum([wt.ACCOUNT_TYPES.EOA,wt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:y.optional(y.string()),signature:y.string().optional(),message:y.string().optional(),siwxMessage:y.optional(ad)}),IF=y.object({uri:y.string()}),SF=y.object({isConnected:y.boolean()}),NF=y.object({chainId:y.string().or(y.number())}),TF=y.object({chainId:y.string().or(y.number())}),xF=y.object({newEmail:y.string().email()}),PF=y.object({smartAccountEnabledNetworks:y.array(y.number())});y.object({address:y.string(),isDeployed:y.boolean()});const OF=y.object({version:y.string().optional()}),RF=y.object({type:y.string(),address:y.string()}),DF=y.any(),$F=y.object({method:y.literal("eth_accounts")}),kF=y.object({method:y.literal("eth_blockNumber")}),UF=y.object({method:y.literal("eth_call"),params:y.array(y.any())}),MF=y.object({method:y.literal("eth_chainId")}),LF=y.object({method:y.literal("eth_estimateGas"),params:y.array(y.any())}),BF=y.object({method:y.literal("eth_feeHistory"),params:y.array(y.any())}),FF=y.object({method:y.literal("eth_gasPrice")}),jF=y.object({method:y.literal("eth_getAccount"),params:y.array(y.any())}),zF=y.object({method:y.literal("eth_getBalance"),params:y.array(y.any())}),qF=y.object({method:y.literal("eth_getBlockByHash"),params:y.array(y.any())}),HF=y.object({method:y.literal("eth_getBlockByNumber"),params:y.array(y.any())}),WF=y.object({method:y.literal("eth_getBlockReceipts"),params:y.array(y.any())}),VF=y.object({method:y.literal("eth_getBlockTransactionCountByHash"),params:y.array(y.any())}),GF=y.object({method:y.literal("eth_getBlockTransactionCountByNumber"),params:y.array(y.any())}),KF=y.object({method:y.literal("eth_getCode"),params:y.array(y.any())}),YF=y.object({method:y.literal("eth_getFilterChanges"),params:y.array(y.any())}),ZF=y.object({method:y.literal("eth_getFilterLogs"),params:y.array(y.any())}),JF=y.object({method:y.literal("eth_getLogs"),params:y.array(y.any())}),XF=y.object({method:y.literal("eth_getProof"),params:y.array(y.any())}),QF=y.object({method:y.literal("eth_getStorageAt"),params:y.array(y.any())}),e7=y.object({method:y.literal("eth_getTransactionByBlockHashAndIndex"),params:y.array(y.any())}),t7=y.object({method:y.literal("eth_getTransactionByBlockNumberAndIndex"),params:y.array(y.any())}),n7=y.object({method:y.literal("eth_getTransactionByHash"),params:y.array(y.any())}),r7=y.object({method:y.literal("eth_getTransactionCount"),params:y.array(y.any())}),s7=y.object({method:y.literal("eth_getTransactionReceipt"),params:y.array(y.any())}),i7=y.object({method:y.literal("eth_getUncleCountByBlockHash"),params:y.array(y.any())}),o7=y.object({method:y.literal("eth_getUncleCountByBlockNumber"),params:y.array(y.any())}),a7=y.object({method:y.literal("eth_maxPriorityFeePerGas")}),c7=y.object({method:y.literal("eth_newBlockFilter")}),u7=y.object({method:y.literal("eth_newFilter"),params:y.array(y.any())}),l7=y.object({method:y.literal("eth_newPendingTransactionFilter")}),d7=y.object({method:y.literal("eth_sendRawTransaction"),params:y.array(y.any())}),h7=y.object({method:y.literal("eth_syncing"),params:y.array(y.any())}),f7=y.object({method:y.literal("eth_uninstallFilter"),params:y.array(y.any())}),qw=y.object({method:y.literal("personal_sign"),params:y.array(y.any())}),p7=y.object({method:y.literal("eth_signTypedData_v4"),params:y.array(y.any())}),g7=y.object({method:y.literal("eth_sendTransaction"),params:y.array(y.any())}),m7=y.object({method:y.literal("solana_signMessage"),params:y.object({message:y.string(),pubkey:y.string()})}),y7=y.object({method:y.literal("solana_signTransaction"),params:y.object({transaction:y.string()})}),w7=y.object({method:y.literal("solana_signAllTransactions"),params:y.object({transactions:y.array(y.string())})}),b7=y.object({method:y.literal("solana_signAndSendTransaction"),params:y.object({transaction:y.string(),options:y.object({skipPreflight:y.boolean().optional(),preflightCommitment:y.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:y.number().optional(),minContextSlot:y.number().optional()}).optional()})}),v7=y.object({method:y.literal("wallet_sendCalls"),params:y.array(y.object({chainId:y.string().or(y.number()).optional(),from:y.string().optional(),version:y.string().optional(),capabilities:y.any().optional(),calls:y.array(y.object({to:y.string().startsWith("0x"),data:y.string().startsWith("0x").optional(),value:y.string().optional()}))}))}),E7=y.object({method:y.literal("wallet_getCallsStatus"),params:y.array(y.string())}),C7=y.object({method:y.literal("wallet_getCapabilities"),params:y.array(y.string().or(y.number()).optional()).optional()}),_7=y.object({method:y.literal("wallet_grantPermissions"),params:y.array(y.any())}),A7=y.object({method:y.literal("wallet_revokePermissions"),params:y.any()}),I7=y.object({method:y.literal("wallet_getAssets"),params:y.any()}),Hw=y.object({token:y.string()}),re=y.object({id:y.string().optional()}),fh={appEvent:re.extend({type:ne("APP_SWITCH_NETWORK"),payload:aF}).or(re.extend({type:ne("APP_CONNECT_EMAIL"),payload:cF})).or(re.extend({type:ne("APP_CONNECT_DEVICE")})).or(re.extend({type:ne("APP_CONNECT_OTP"),payload:uF})).or(re.extend({type:ne("APP_CONNECT_SOCIAL"),payload:lF})).or(re.extend({type:ne("APP_GET_FARCASTER_URI")})).or(re.extend({type:ne("APP_CONNECT_FARCASTER")})).or(re.extend({type:ne("APP_GET_USER"),payload:y.optional(dF)})).or(re.extend({type:ne("APP_GET_SOCIAL_REDIRECT_URI"),payload:hF})).or(re.extend({type:ne("APP_SIGN_OUT")})).or(re.extend({type:ne("APP_IS_CONNECTED"),payload:y.optional(Hw)})).or(re.extend({type:ne("APP_GET_CHAIN_ID")})).or(re.extend({type:ne("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(re.extend({type:ne("APP_INIT_SMART_ACCOUNT")})).or(re.extend({type:ne("APP_SET_PREFERRED_ACCOUNT"),payload:wF})).or(re.extend({type:ne("APP_RPC_REQUEST"),payload:qw.or(I7).or($F).or(kF).or(UF).or(MF).or(LF).or(BF).or(FF).or(jF).or(zF).or(qF).or(HF).or(WF).or(VF).or(GF).or(KF).or(YF).or(ZF).or(JF).or(XF).or(QF).or(e7).or(t7).or(n7).or(r7).or(s7).or(i7).or(o7).or(a7).or(c7).or(u7).or(l7).or(d7).or(h7).or(f7).or(qw).or(p7).or(g7).or(m7).or(y7).or(w7).or(b7).or(E7).or(v7).or(C7).or(_7).or(A7).and(y.object({chainId:y.string().or(y.number()).optional(),chainNamespace:y.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:y.string().optional()}))})).or(re.extend({type:ne("APP_UPDATE_EMAIL"),payload:fF})).or(re.extend({type:ne("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:pF})).or(re.extend({type:ne("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:gF})).or(re.extend({type:ne("APP_SYNC_THEME"),payload:mF})).or(re.extend({type:ne("APP_SYNC_DAPP_DATA"),payload:yF})).or(re.extend({type:ne("APP_RELOAD")})).or(re.extend({type:ne("APP_RPC_ABORT")})),frameEvent:re.extend({type:ne("FRAME_SWITCH_NETWORK_ERROR"),payload:at}).or(re.extend({type:ne("FRAME_SWITCH_NETWORK_SUCCESS"),payload:TF})).or(re.extend({type:ne("FRAME_CONNECT_EMAIL_SUCCESS"),payload:bF})).or(re.extend({type:ne("FRAME_CONNECT_EMAIL_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:vF})).or(re.extend({type:ne("FRAME_GET_FARCASTER_URI_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:EF})).or(re.extend({type:ne("FRAME_CONNECT_FARCASTER_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_CONNECT_OTP_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_CONNECT_OTP_SUCCESS")})).or(re.extend({type:ne("FRAME_CONNECT_DEVICE_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_CONNECT_DEVICE_SUCCESS")})).or(re.extend({type:ne("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:CF})).or(re.extend({type:ne("FRAME_CONNECT_SOCIAL_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_GET_USER_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_GET_USER_SUCCESS"),payload:AF})).or(re.extend({type:ne("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:IF})).or(re.extend({type:ne("FRAME_SIGN_OUT_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_SIGN_OUT_SUCCESS")})).or(re.extend({type:ne("FRAME_IS_CONNECTED_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_IS_CONNECTED_SUCCESS"),payload:SF})).or(re.extend({type:ne("FRAME_GET_CHAIN_ID_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_GET_CHAIN_ID_SUCCESS"),payload:NF})).or(re.extend({type:ne("FRAME_RPC_REQUEST_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_RPC_REQUEST_SUCCESS"),payload:DF})).or(re.extend({type:ne("FRAME_SESSION_UPDATE"),payload:Hw})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_SUCCESS"),payload:_F})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:xF})).or(re.extend({type:ne("FRAME_SYNC_THEME_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_SYNC_THEME_SUCCESS")})).or(re.extend({type:ne("FRAME_SYNC_DAPP_DATA_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(re.extend({type:ne("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:PF})).or(re.extend({type:ne("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:RF})).or(re.extend({type:ne("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_READY"),payload:OF})).or(re.extend({type:ne("FRAME_RELOAD_ERROR"),payload:at})).or(re.extend({type:ne("FRAME_RELOAD_SUCCESS")}))};function ph(t,e={}){var n;return typeof(e==null?void 0:e.type)=="string"&&((n=e==null?void 0:e.type)==null?void 0:n.includes(t))}function S7({projectId:t,chainId:e,version:n,enableLogger:r,rpcUrl:s=eC.BLOCKCHAIN_API_RPC_URL}){const i=new URL(__);return i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",n),i.searchParams.set("enableLogger",String(r)),i.searchParams.set("rpcUrl",s),i.toString()}class N7{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,rpcUrl:i=eC.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const o=document.getElementById("w3m-iframe");this.iframe&&!o&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(o,a,c)=>{function u({data:l}){var h;if(!ph(oe.FRAME_EVENT_KEY,l))return;const d=fh.frameEvent.safeParse(l);if(!d.success){console.warn("W3mFrame: invalid frame event",d.error.message);return}((h=d.data)==null?void 0:h.id)===o&&(a(d.data),window.removeEventListener("message",u))}Cn.isClient&&(window.addEventListener("message",u),c.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:o=>{Cn.isClient&&window.addEventListener("message",({data:a})=>{if(!ph(oe.FRAME_EVENT_KEY,a))return;const c=fh.frameEvent.safeParse(a);c.success?o(c.data):console.warn("W3mFrame: invalid frame event",c.error.message)})},onAppEvent:o=>{Cn.isClient&&window.addEventListener("message",({data:a})=>{if(!ph(oe.APP_EVENT_KEY,a))return;const c=fh.appEvent.safeParse(a);c.success||console.warn("W3mFrame: invalid app event",c.error.message),o(a)})},postAppEvent:o=>{var a;if(Cn.isClient){if(!((a=this.iframe)!=null&&a.contentWindow))throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(o,"*")}},postFrameEvent:o=>{if(Cn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(o,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((o,a)=>{this.frameLoadPromiseResolver={resolve:o,reject:a}}),this.rpcUrl=i,n&&(this.frameLoadPromise=new Promise((o,a)=>{this.frameLoadPromiseResolver={resolve:o,reject:a}}),Cn.isClient)){const o=document.createElement("iframe");o.id="w3m-iframe",o.src=S7({projectId:e,chainId:r,version:I_,enableLogger:s,rpcUrl:this.rpcUrl}),o.name="w3m-secure-iframe",o.style.position="fixed",o.style.zIndex="999999",o.style.display="none",o.style.border="none",o.style.animationDelay="0s, 50ms",o.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",o.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=o,this.iframe.onerror=()=>{var a;(a=this.frameLoadPromiseResolver)==null||a.reject("Unable to load email login dependency")},this.events.onFrameEvent(a=>{var c;a.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(c=this.frameLoadPromiseResolver)==null||c.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}class T7{constructor(e){var i;const n=$o({level:A_}),{logger:r,chunkLoggerController:s}=Ep({opts:n});this.logger=Vt(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class x7{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o}){this.openRpcRequests=[],this.isInitialized=!1,r&&(this.w3mLogger=new T7(e)),this.abortController=i,this.getActiveCaipNetwork=o;const a=this.getRpcUrl(n);this.w3mFrame=new N7({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:a}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Ot.get(oe.EMAIL_LOGIN_USED_KEY)}getEmail(){return Ot.get(oe.EMAIL)}getUsername(){return Ot.get(oe.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:oe.APP_RELOAD})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error reloading iframe"),n}}async connectEmail(e){var n;try{Cn.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:oe.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:oe.APP_CONNECT_DEVICE})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting device"),n}}async connectOtp(e){var n;try{return this.appEvent({type:oe.APP_CONNECT_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const n=await this.appEvent({type:oe.APP_IS_CONNECTED});return n!=null&&n.isConnected||this.deleteAuthLoginCache(),n}catch(n){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error checking connection"),n}}async getChainId(){var e;try{const n=await this.appEvent({type:oe.APP_GET_CHAIN_ID});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting chain id"),n}}async getSocialRedirectUri(e){var n;try{return await this.init(),this.appEvent({type:oe.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var n;try{const r=await this.appEvent({type:oe.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var n;try{return this.appEvent({type:oe.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var n;try{const r=await this.appEvent({type:oe.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var n;try{return this.appEvent({type:oe.APP_SYNC_THEME,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var n;try{return this.appEvent({type:oe.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const n=await this.appEvent({type:oe.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(n.smartAccountEnabledNetworks),n}catch(n){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting smart account enabled networks"),n}}async setPreferredAccount(e){var n;try{return this.appEvent({type:oe.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var n,r;if(e!=null&&e.socialUri)try{await this.init();const s=this.getRpcUrl(e.chainId),i=await this.appEvent({type:oe.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:s}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType,siwxMessage:e==null?void 0:e.siwxMessage,rpcUrl:this.getRpcUrl(s)});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting"),s}}async getUser(e){var n;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:oe.APP_GET_USER,payload:{...e,chainId:r}});return this.user=s,s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting"),r}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){var s;try{await this.init();const i=this.getRpcUrl(n),o=await this.appEvent({type:oe.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:i,preferredAccountType:r}});return o.userName&&this.setSocialLoginSuccess(o.userName),o}catch(i){throw(s=this.w3mLogger)==null||s.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:oe.APP_GET_FARCASTER_URI})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting farcaster uri"),n}}async connectFarcaster(){var e;try{const n=await this.appEvent({type:oe.APP_CONNECT_FARCASTER});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting farcaster"),n}}async switchNetwork({chainId:e}){var n;try{const r=this.getRpcUrl(e),s=await this.appEvent({type:oe.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:r}});return this.setLastUsedChainId(s.chainId),s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const s=setTimeout(()=>{r()},3e3);await this.appEvent({type:oe.APP_SIGN_OUT}),clearTimeout(s),r()})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error disconnecting"),n}}async request(e){var r,s,i,o,a;const n=e;try{if(wt.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const c=e.chainNamespace||"eip155",u=(r=this.getActiveCaipNetwork(c))==null?void 0:r.id;n.chainNamespace=c,n.chainId=u,n.rpcUrl=this.getRpcUrl(u),(s=this.rpcRequestHandler)==null||s.call(this,e);const l=await this.appEvent({type:oe.APP_RPC_REQUEST,payload:n});return(i=this.rpcSuccessHandler)==null||i.call(this,l,n),l}catch(c){throw(o=this.rpcErrorHandler)==null||o.call(this,c,n),(a=this.w3mLogger)==null||a.logger.error({error:c},"Error requesting"),c}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_IS_CONNECTED_ERROR&&e(),n.type===oe.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===oe.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:wt.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){var e;try{await Promise.all(this.openRpcRequests.map(async({abortController:n,method:r})=>{wt.SAFE_RPC_METHODS.includes(r)||n.abort(),await this.appEvent({type:oe.APP_RPC_ABORT})})),this.openRpcRequests=[]}catch(n){(e=this.w3mLogger)==null||e.logger.error({error:n},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[oe.APP_SYNC_DAPP_DATA,oe.APP_SYNC_THEME,oe.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[oe.APP_CONNECT_EMAIL,oe.APP_CONNECT_DEVICE,oe.APP_CONNECT_OTP,oe.APP_CONNECT_SOCIAL,oe.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,u)=>{var f,p,g;const l=Math.random().toString(36).substring(7);(g=(f=this.w3mLogger)==null?void 0:(p=f.logger).info)==null||g.call(p,{event:e,id:l},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:l});const d=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:d}]}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?u(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&u(new Error("Something went wrong"))});function h(m,v){var w,b,S;m.id===l&&((b=v==null?void 0:(w=v.logger).info)==null||b.call(w,{framEvent:m,id:l},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in m&&u(new Error(((S=m.payload)==null?void 0:S.message)||"An error occurred")),u(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(l,m=>h(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Ot.set(oe.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Ot.set(oe.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Ot.set(oe.EMAIL,e),Ot.set(oe.EMAIL_LOGIN_USED_KEY,"true"),Ot.delete(oe.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Ot.delete(oe.EMAIL_LOGIN_USED_KEY),Ot.delete(oe.EMAIL),Ot.delete(oe.LAST_USED_CHAIN_KEY),Ot.delete(oe.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Ot.set(oe.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Ot.get(oe.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Ot.set(oe.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){var s,i;let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=(s=c9.parseCaipNetworkId(e))==null?void 0:s.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getActiveCaipNetwork(n);return(i=r==null?void 0:r.rpcUrls.default.http)==null?void 0:i[0]}}class li{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o}){return li.instance||(li.instance=new x7({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o})),li.instance}}var Ww={};const P7={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof Ww<"u"?Ww.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},Hf={filterOutDuplicatesByRDNS(t){const e=F.state.enableEIP6963?K.state.connectors:[],n=H.getRecentWallets(),r=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&ie.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a!=null&&a.rdns&&i.includes(String(a.rdns))||!(a!=null&&a.rdns)&&e.some(u=>u.name===a.name)))},filterOutDuplicatesByIds(t){const e=K.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=H.getRecentWallets(),r=e.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=K.state,{featuredWalletIds:n}=F.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>{var c;return(c=a.info)!=null&&c.rdns&&(o[a.info.rdns]=!0),o},{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n!=null&&n.length){const u=n.indexOf(o.id),l=n.indexOf(a.id);if(u!==-1&&l!==-1)return u-l;if(u!==-1)return-1;if(l!==-1)return 1}return 0})},getConnectOrderMethod(t,e){var c;const n=(t==null?void 0:t.connectMethodsOrder)||((c=F.state.features)==null?void 0:c.connectMethodsOrder),r=e||K.state.connectors;if(n)return n;const{injected:s,announced:i}=Fu.getConnectorsByType(r,le.state.recommended,le.state.featured),o=s.filter(Fu.showConnector),a=i.filter(Fu.showConnector);return o.length||a.length?["wallet","email","social"]:P7.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&le.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&le.state.excludedWallets.some(r=>At.isLowerCaseMatch(r.name,t.name));return e||n}},Fu={getConnectorsByType(t,e,n){const{customWallets:r}=F.state,s=H.getRecentWallets(),i=Hf.filterOutDuplicateWallets(e),o=Hf.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),u=t.filter(d=>d.type==="INJECTED"),l=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:l,multiChain:a,announced:c,injected:u,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,n=!!e&&le.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),r=!!t.name&&le.state.excludedWallets.some(i=>At.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!ie.isMobile()||ie.isMobile()&&!e&&!J.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(E.state.chains.values()).some(n=>K.getConnectorId(n.namespace)===$.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(u=>(u=F.state.features)==null?void 0:u.connectorTypeOrder)()??[]}){const h=[{type:"walletConnect",isEnabled:F.state.enableWalletConnect},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(m=>m.isEnabled),f=new Set(h.map(m=>m.type)),p=c.filter(m=>f.has(m)).map(m=>({type:m,isEnabled:!0})),g=h.filter(({type:m})=>!p.some(({type:w})=>w===m));return Array.from(new Set([...p,...g].map(({type:m})=>m)))},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){var e,n;try{if(t.name==="Browser Wallet"&&!ie.isMobile())return{accounts:[],chainId:void 0};if(t.id===$.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[r,s]=await Promise.all([(e=t.provider)==null?void 0:e.request({method:"eth_accounts"}),(n=t.provider)==null?void 0:n.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:r,chainId:s}}catch(r){return console.warn(`Failed to fetch provider data for ${t.name}`,r),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ju=globalThis,eg=ju.ShadowRoot&&(ju.ShadyCSS===void 0||ju.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,tg=Symbol(),Vw=new WeakMap;let uC=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==tg)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(eg&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=Vw.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Vw.set(n,e))}return e}toString(){return this.cssText}};const Rn=t=>new uC(typeof t=="string"?t:t+"",void 0,tg),mo=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new uC(n,t,tg)},O7=(t,e)=>{if(eg)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=ju.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},Gw=eg?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return Rn(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:R7,defineProperty:D7,getOwnPropertyDescriptor:$7,getOwnPropertyNames:k7,getOwnPropertySymbols:U7,getPrototypeOf:M7}=Object,xs=globalThis,Kw=xs.trustedTypes,L7=Kw?Kw.emptyScript:"",gh=xs.reactiveElementPolyfillSupport,Ra=(t,e)=>t,Wf={toAttribute(t,e){switch(e){case Boolean:t=t?L7:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},lC=(t,e)=>!R7(t,e),Yw={attribute:!0,type:String,converter:Wf,reflect:!1,useDefault:!1,hasChanged:lC};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),xs.litPropertyMetadata??(xs.litPropertyMetadata=new WeakMap);let co=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=Yw){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&D7(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=$7(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Yw}static _$Ei(){if(this.hasOwnProperty(Ra("elementProperties")))return;const e=M7(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ra("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ra("properties"))){const n=this.properties,r=[...k7(n),...U7(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(Gw(s))}else e!==void 0&&n.push(Gw(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(n=>n(this))}addController(e){var n;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((n=e.hostConnected)==null||n.call(e))}removeController(e){var n;(n=this._$EO)==null||n.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return O7(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostConnected)==null?void 0:r.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostDisconnected)==null?void 0:r.call(n)})}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){var i;const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:Wf).toAttribute(n,r.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,n){var i,o;const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=r.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:Wf;this._$Em=s;const u=c.fromAttribute(n,a.type);this[s]=u??((o=this._$Ej)==null?void 0:o.get(s))??u,this._$Em=null}}requestUpdate(e,n,r){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(r??(r=i.getPropertyOptions(e)),!((r.hasChanged??lC)(o,n)||r.useDefault&&r.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),(r=this._$EO)==null||r.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(n)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(n)}willUpdate(e){}_$AE(e){var n;(n=this._$EO)==null||n.forEach(r=>{var s;return(s=r.hostUpdated)==null?void 0:s.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};co.elementStyles=[],co.shadowRootOptions={mode:"open"},co[Ra("elementProperties")]=new Map,co[Ra("finalized")]=new Map,gh==null||gh({ReactiveElement:co}),(xs.reactiveElementVersions??(xs.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Da=globalThis,_l=Da.trustedTypes,Zw=_l?_l.createPolicy("lit-html",{createHTML:t=>t}):void 0,dC="$lit$",Es=`lit$${Math.random().toFixed(9).slice(2)}$`,hC="?"+Es,B7=`<${hC}>`,Si=document,Ic=()=>Si.createComment(""),Sc=t=>t===null||typeof t!="object"&&typeof t!="function",ng=Array.isArray,F7=t=>ng(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",mh=`[ 	
\f\r]`,la=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Jw=/-->/g,Xw=/>/g,Ks=RegExp(`>|${mh}(?:([^\\s"'>=/]+)(${mh}*=${mh}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Qw=/'/g,e0=/"/g,fC=/^(?:script|style|textarea|title)$/i,pC=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),FW=pC(1),jW=pC(2),To=Symbol.for("lit-noChange"),_t=Symbol.for("lit-nothing"),t0=new WeakMap,ci=Si.createTreeWalker(Si,129);function gC(t,e){if(!ng(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Zw!==void 0?Zw.createHTML(e):e}const j7=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=la;for(let a=0;a<n;a++){const c=t[a];let u,l,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,l=o.exec(c),l!==null);)h=o.lastIndex,o===la?l[1]==="!--"?o=Jw:l[1]!==void 0?o=Xw:l[2]!==void 0?(fC.test(l[2])&&(s=RegExp("</"+l[2],"g")),o=Ks):l[3]!==void 0&&(o=Ks):o===Ks?l[0]===">"?(o=s??la,d=-1):l[1]===void 0?d=-2:(d=o.lastIndex-l[2].length,u=l[1],o=l[3]===void 0?Ks:l[3]==='"'?e0:Qw):o===e0||o===Qw?o=Ks:o===Jw||o===Xw?o=la:(o=Ks,s=void 0);const f=o===Ks&&t[a+1].startsWith("/>")?" ":"";i+=o===la?c+B7:d>=0?(r.push(u),c.slice(0,d)+dC+c.slice(d)+Es+f):c+Es+(d===-2?a:f)}return[gC(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class Nc{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[u,l]=j7(e,n);if(this.el=Nc.createElement(u,r),ci.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=ci.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(dC)){const h=l[o++],f=s.getAttribute(d).split(Es),p=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?q7:p[1]==="?"?H7:p[1]==="@"?W7:cd}),s.removeAttribute(d)}else d.startsWith(Es)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(fC.test(s.tagName)){const d=s.textContent.split(Es),h=d.length-1;if(h>0){s.textContent=_l?_l.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],Ic()),ci.nextNode(),c.push({type:2,index:++i});s.append(d[h],Ic())}}}else if(s.nodeType===8)if(s.data===hC)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Es,d+1))!==-1;)c.push({type:7,index:i}),d+=Es.length-1}i++}}static createElement(e,n){const r=Si.createElement("template");return r.innerHTML=e,r}}function xo(t,e,n=t,r){var o,a;if(e===To)return e;let s=r!==void 0?(o=n._$Co)==null?void 0:o[r]:n._$Cl;const i=Sc(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??(n._$Co=[]))[r]=s:n._$Cl=s),s!==void 0&&(e=xo(t,s._$AS(t,e.values),s,r)),e}class z7{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=((e==null?void 0:e.creationScope)??Si).importNode(n,!0);ci.currentNode=s;let i=ci.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let u;c.type===2?u=new Kc(i,i.nextSibling,this,e):c.type===1?u=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(u=new V7(i,this,e)),this._$AV.push(u),c=r[++a]}o!==(c==null?void 0:c.index)&&(i=ci.nextNode(),o++)}return ci.currentNode=Si,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class Kc{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=_t,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=xo(this,e,n),Sc(e)?e===_t||e==null||e===""?(this._$AH!==_t&&this._$AR(),this._$AH=_t):e!==this._$AH&&e!==To&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):F7(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==_t&&Sc(this._$AH)?this._$AA.nextSibling.data=e:this.T(Si.createTextNode(e)),this._$AH=e}$(e){var i;const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=Nc.createElement(gC(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(n);else{const o=new z7(s,this),a=o.u(this.options);o.p(n),this.T(a),this._$AH=o}}_$AC(e){let n=t0.get(e.strings);return n===void 0&&t0.set(e.strings,n=new Nc(e)),n}k(e){ng(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new Kc(this.O(Ic()),this.O(Ic()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,n);e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var n;this._$AM===void 0&&(this._$Cv=e,(n=this._$AP)==null||n.call(this,e))}}class cd{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=_t,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=_t}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=xo(this,e,n,0),o=!Sc(e)||e!==this._$AH&&e!==To,o&&(this._$AH=e);else{const a=e;let c,u;for(e=i[0],c=0;c<i.length-1;c++)u=xo(this,a[r+c],n,c),u===To&&(u=this._$AH[c]),o||(o=!Sc(u)||u!==this._$AH[c]),u===_t?e=_t:e!==_t&&(e+=(u??"")+i[c+1]),this._$AH[c]=u}o&&!s&&this.j(e)}j(e){e===_t?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class q7 extends cd{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===_t?void 0:e}}class H7 extends cd{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==_t)}}class W7 extends cd{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=xo(this,e,n,0)??_t)===To)return;const r=this._$AH,s=e===_t&&r!==_t||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==_t&&(r===_t||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n;typeof this._$AH=="function"?this._$AH.call(((n=this.options)==null?void 0:n.host)??this.element,e):this._$AH.handleEvent(e)}}class V7{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){xo(this,e)}}const yh=Da.litHtmlPolyfillSupport;yh==null||yh(Nc,Kc),(Da.litHtmlVersions??(Da.litHtmlVersions=[])).push("3.3.1");const G7=(t,e,n)=>{const r=(n==null?void 0:n.renderBefore)??e;let s=r._$litPart$;if(s===void 0){const i=(n==null?void 0:n.renderBefore)??null;r._$litPart$=s=new Kc(e.insertBefore(Ic(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const di=globalThis;class zu extends co{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var n;const e=super.createRenderRoot();return(n=this.renderOptions).renderBefore??(n.renderBefore=e.firstChild),e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=G7(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return To}}var f0;zu._$litElement$=!0,zu.finalized=!0,(f0=di.litElementHydrateSupport)==null||f0.call(di,{LitElement:zu});const wh=di.litElementPolyfillSupport;wh==null||wh({LitElement:zu});(di.litElementVersions??(di.litElementVersions=[])).push("4.2.1");let $a,Ps,Os;function zW(t,e){$a=document.createElement("style"),Ps=document.createElement("style"),Os=document.createElement("style"),$a.textContent=yo(t).core.cssText,Ps.textContent=yo(t).dark.cssText,Os.textContent=yo(t).light.cssText,document.head.appendChild($a),document.head.appendChild(Ps),document.head.appendChild(Os),mC(e)}function mC(t){Ps&&Os&&(t==="light"?(Ps.removeAttribute("media"),Os.media="enabled"):(Os.removeAttribute("media"),Ps.media="enabled"))}function K7(t){$a&&Ps&&Os&&($a.textContent=yo(t).core.cssText,Ps.textContent=yo(t).dark.cssText,Os.textContent=yo(t).light.cssText)}function yo(t){return{core:mo`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${Rn(t!=null&&t["--w3m-color-mix-strength"]?`${t["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${Rn((t==null?void 0:t["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${Rn((t==null?void 0:t["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${Rn((t==null?void 0:t["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${Rn((t==null?void 0:t["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:mo`
      :root {
        --w3m-color-mix: ${Rn((t==null?void 0:t["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${Rn(Gr(t,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${Rn(Gr(t,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:mo`
      :root {
        --w3m-color-mix: ${Rn((t==null?void 0:t["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${Rn(Gr(t,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${Rn(Gr(t,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const qW=mo`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,HW=mo`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,WW=mo`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,qu={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([qu.getAddresses(t),qu.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){var r,s;const n=((r=e.rpcUrls.chainDefault)==null?void 0:r.http)||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:qu.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[vn.NetworkImageIds[e.id]]}]})}},ro={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},VW=DS({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function Yc(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const n0=Yc({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),r0=Yc({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});Yc({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});Yc({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});Yc({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const Y7={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},Sr={getMethodsByChainNamespace(t){return Y7[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const u=`${o}:${i}`,l=r[o];switch(l.chains.push(u),u){case n0.caipNetworkId:l.chains.push(n0.deprecatedCaipNetworkId);break;case r0.caipNetworkId:l.chains.push(r0.deprecatedCaipNetworkId);break}return l!=null&&l.rpcMap&&c&&(l.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{var r;const e=await Ca.resolveName(t);return((r=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isOriginAllowed(t,e,n){for(const r of[...e,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(r).origin===t)return!0}catch{if(r===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=Sr.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("session_event",a=>{if(Sr.isSessionEventData(a)){const{name:c,data:u}=a.params.event;if(c==="accountsChanged"&&Array.isArray(u)){const l=u.filter(d=>ie.isCaipAddress(d)).map(d=>En.parseCaipAddress(d)).filter(d=>d.chainNamespace===e);s(l)}}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){var s,i,o,a;const n=new Set,r=(a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>En.parseCaipAddress(c)).filter(({address:c})=>n.has(c.toLowerCase())?!1:(n.add(c.toLowerCase()),!0));return r&&r.length>0?r:[]}};class Z7{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case $.CHAIN.EVM:await this.syncEVMConnections(e);break;case $.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case $.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:u}=s(a.id);return!c&&u}).map(async a=>{if(a.id===$.CONNECTOR_ID.WALLET_CONNECT){const c=Sr.getWalletConnectAccounts(r,this.namespace),u=n.find(l=>{var d,h;return l.chainNamespace===this.namespace&&l.id.toString()===((h=(d=c[0])==null?void 0:d.chainId)==null?void 0:h.toString())});c.length>0&&i({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:u})}else{const{accounts:c,chainId:u}=await Fu.fetchProviderData(a);if(c.length>0&&u){const l=n.find(d=>d.chainNamespace===this.namespace&&d.id.toString()===u.toString());i({connectorId:a.id,accounts:c.map(d=>({address:d})),caipNetwork:l}),a.provider&&a.id!==$.CONNECTOR_ID.AUTH&&a.id!==$.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:u}=s(a.id);return!c&&u}).map(async a=>{if(a.id===$.CONNECTOR_ID.WALLET_CONNECT){const c=Sr.getWalletConnectAccounts(r,this.namespace);c.length>0&&i({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:n})}else{const c=await a.connect({chainId:n==null?void 0:n.id});c&&(i({connectorId:a.id,accounts:[{address:c}],caipNetwork:n}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:u}=s(a.id);return!c&&u}).map(async a=>{var h,f,p,g,m,v;if(a.id===$.CONNECTOR_ID.WALLET_CONNECT){const w=Sr.getWalletConnectAccounts(r,this.namespace);w.length>0&&i({connectorId:a.id,accounts:w.map(b=>({address:b.address})),caipNetwork:n});return}const c=await a.connect(),u=await a.getAccountAddresses();let l=u==null?void 0:u.map(w=>ie.createAccount($.CHAIN.BITCOIN,w.address,w.purpose||"payment",w.publicKey,w.path));if(l&&l.length>1&&(l=[{namespace:$.CHAIN.BITCOIN,publicKey:((h=l[ro.ACCOUNT_INDEXES.PAYMENT])==null?void 0:h.publicKey)??"",path:((f=l[ro.ACCOUNT_INDEXES.PAYMENT])==null?void 0:f.path)??"",address:((p=l[ro.ACCOUNT_INDEXES.PAYMENT])==null?void 0:p.address)??"",type:"payment"},{namespace:$.CHAIN.BITCOIN,publicKey:((g=l[ro.ACCOUNT_INDEXES.ORDINAL])==null?void 0:g.publicKey)??"",path:((m=l[ro.ACCOUNT_INDEXES.ORDINAL])==null?void 0:m.path)??"",address:((v=l[ro.ACCOUNT_INDEXES.ORDINAL])==null?void 0:v.address)??"",type:"ordinal"}]),!(a.chains.find(w=>w.id===(n==null?void 0:n.id))||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),i({connectorId:a.id,accounts:l.map(w=>({address:w.address,type:w.type})),caipNetwork:n}))}))}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(u=>At.isLowerCaseMatch(u.connectorId,n));if(!o)return null;const a=s.find(u=>At.isLowerCaseMatch(u.id,o.connectorId)),c=e?o.accounts.find(u=>At.isLowerCaseMatch(u.address,e)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>At.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>At.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const ba={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class rg{constructor({provider:e,namespace:n}){this.id=$.CONNECTOR_ID.WALLET_CONNECT,this.name=vn.ConnectorNamesMap[$.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=vn.ConnectorImageIds[$.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=E.getCaipNetworks.bind(E),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=F.state.universalProviderConfigOverride,s=Sr.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return Un.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:J7})}}const J7=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],X7=[$.CONNECTOR_ID.AUTH,$.CONNECTOR_ID.WALLET_CONNECT];class yC{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>E.getCaipNetworks(n),this.getConnectorId=n=>K.getConnectorId(n),e&&this.construct(e),e!=null&&e.namespace&&(this.connectionManager=new Z7({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===(n==null?void 0:n.toString()));e&&r&&this.addConnection({connectorId:$.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:$.CONNECTOR_ID.AUTH,type:"AUTH",name:$.CONNECTOR_NAMES.AUTH,provider:e,imageId:vn.ConnectorImageIds[$.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>!At.isLowerCaseMatch(n.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){ce.setStatus(e,n)}on(e,n){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:n,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=In(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n instanceof rg);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=ie.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===(s==null?void 0:s.toString())),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=ie.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){var s,i;if(e.length>0){const{address:o}=ie.getAccount(e[0]),a=(s=this.connectionManager)==null?void 0:s.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});o&&At.isLowerCaseMatch(this.getConnectorId($.CHAIN.EVM),n)&&this.emit("accountChanged",{address:o,chainId:(i=a==null?void 0:a.caipNetwork)==null?void 0:i.id,connector:a==null?void 0:a.connector}),this.addConnection({connectorId:n,accounts:e.map(c=>{const{address:u}=ie.getAccount(c);return{address:u}}),caipNetwork:a==null?void 0:a.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),At.isLowerCaseMatch(this.getConnectorId($.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){var o;const r=typeof e=="string"&&e.startsWith("0x")?qu.hexStringToNumber(e).toString():e.toString(),s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),At.isLowerCaseMatch(this.getConnectorId($.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(X7.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){var n,r;const e=(n=this.connectionManager)==null?void 0:n.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[s]=e.accounts;this.emit("accountChanged",{address:s==null?void 0:s.address,chainId:(r=e.caipNetwork)==null?void 0:r.id,connector:e.connector})}}}class Q7 extends yC{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new rg({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){var s,i,o,a;const n=this.provider,r=((a=(o=(i=(s=n==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,u]=c.split(":");return u}).filter((c,u,l)=>l.indexOf(c)===u))||[];return Promise.resolve({accounts:r.map(c=>ie.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,u;if(!(e.caipNetwork&&Be.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(ce.state.balanceLoading&&e.chainId===((c=E.state.activeCaipNetwork)==null?void 0:c.id))return{balance:ce.state.balance||"0.00",symbol:ce.state.balanceSymbol||""};const s=(await ce.fetchTokenBalance()).find(l=>{var d,h;return l.chainId===`${(d=e.caipNetwork)==null?void 0:d.chainNamespace}:${e.chainId}`&&l.symbol===((h=e.caipNetwork)==null?void 0:h.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((u=e.caipNetwork)==null?void 0:u.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=E.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===$.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Bo.encode(new TextEncoder().encode(r)),pubkey:s}},(a=E.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},(c=E.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,u;const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===$.CHAIN.EVM)try{await((s=r.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:mi(n.id)}]}))}catch(l){if(l.code===ba.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||l.code===ba.ERROR_INVALID_CHAIN_ID||l.code===ba.ERROR_CODE_DEFAULT||((o=(i=l==null?void 0:l.data)==null?void 0:i.originalError)==null?void 0:o.code)===ba.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((u=r.provider)==null?void 0:u.request({method:"wallet_addEthereumChain",params:[{chainId:mi(n.id),rpcUrls:[(a=n==null?void 0:n.rpcUrls.chainDefault)==null?void 0:a.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[(c=n.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const ej=["email","socials","swaps","onramp","activity","reownBranding","multiWallet"],Iu={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Be.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Be.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Be.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Be.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Be.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Be.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Be.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Be.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Be.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Be.DEFAULT_REMOTE_FEATURES.multiWallet}},tj={localSettingsOverridden:new Set,getApiConfig(t,e){return e==null?void 0:e.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=Iu[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=Iu[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return(a==null?void 0:a.config)===null?this.processFallbackFeature(t,o):a!=null&&a.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return Iu[t].processApi(e)},processFallbackFeature(t,e){return Iu[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await le.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Be.DEFAULT_REMOTE_FEATURES:Be.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of ej){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Be.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;et.open({shortMessage:"Local configuration ignored",longMessage:`[Reown Config Notice] ${o}`},"warning")}return i}};class nj{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{var s,i,o;if(n){const a=(s=E.getCaipNetworks(n))==null?void 0:s.find(l=>l.id===r);if(a)return a;const c=(i=E.getNetworkData(n))==null?void 0:i.caipNetwork;return c||((o=E.getRequestedCaipNetworks(n).filter(l=>l.chainNamespace===n))==null?void 0:o[0])}return E.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>E.getCaipNetworks(n),this.getActiveChainNamespace=()=>E.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{E.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>E.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>E.state.activeChain===n||!n?E.state.activeCaipAddress:E.getAccountProp("caipAddress",n),this.setClientId=n=>{he.setClientId(n)},this.getProvider=n=>Ve.getProvider(n),this.getProviderType=n=>Ve.getProviderId(n),this.getPreferredAccountType=n=>In(n),this.setCaipAddress=(n,r)=>{ce.setCaipAddress(n,r)},this.setBalance=(n,r,s)=>{ce.setBalance(n,r,s)},this.setProfileName=(n,r)=>{ce.setProfileName(n,r)},this.setProfileImage=(n,r)=>{ce.setProfileImage(n,r)},this.setUser=(n,r)=>{ce.setUser(n,r)},this.resetAccount=n=>{ce.resetAccount(n)},this.setCaipNetwork=n=>{E.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{E.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{ce.setStatus(n,r),K.isConnected()?H.setConnectionStatus("connected"):H.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>E.getAccountProp("address",n),this.setConnectors=n=>{const r=[...K.state.allConnectors,...n];K.setConnectors(r)},this.setConnections=(n,r)=>{H.setConnections(n,r),J.setConnections(n,r)},this.fetchIdentity=n=>he.fetchIdentity(n),this.getReownName=n=>Ca.getNamesForAddress(n),this.getConnectors=()=>K.getConnectors(),this.getConnectorImage=n=>b0.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?Gu.getConnectionsData(n).connections:(et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?Gu.getConnectionsData(n).recentConnections:(et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await J.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}H.deleteAddressFromConnection(n),J.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=Ve.getProviderId(r),i=n?{...n,type:s}:void 0;ce.setConnectedWalletInfo(i,r)},this.getIsConnectedState=()=>!!E.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{ce.addAddressLabel(n,r,s)},this.removeAddressLabel=(n,r)=>{ce.removeAddressLabel(n,r)},this.getAddress=n=>E.state.activeChain===n||!n?ce.state.address:E.getAccountProp("address",n),this.setApprovedCaipNetworksData=n=>E.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{E.resetNetwork(n)},this.addConnector=n=>{K.addConnector(n)},this.resetWcConnection=()=>{J.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{ce.setAddressExplorerUrl(n,r)},this.setSmartAccountDeployed=(n,r)=>{ce.setSmartAccountDeployed(n,r)},this.setPreferredAccountType=(n,r)=>{E.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{F.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(r!=null&&r.length)return[...new Set(r)];const s=n==null?void 0:n.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var n,r,s;this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),F.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await tj.fetchRemoteFeatures(e),F.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Vh.setOnrampProviders(this.remoteFeatures.onramp),((n=F.state.remoteFeatures)!=null&&n.email||Array.isArray((r=F.state.remoteFeatures)==null?void 0:r.socials)&&((s=F.state.remoteFeatures)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const e=await le.fetchAllowedOrigins();if(!e||!ie.isClient()){et.open(it.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const n=window.location.origin;Sr.isOriginAllowed(n,e,ba.DEFAULT_ALLOWED_ANCESTORS)||et.open(it.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error)){et.open(it.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(e.message){case"RATE_LIMITED":et.open(it.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;et.open({shortMessage:it.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.shortMessage,longMessage:it.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.longMessage(n.message)},"error");break}default:et.open(it.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(e){var r;const{...n}=e;delete n.adapters,delete n.universalProvider,qe.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(s=>s.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&cn.setThemeMode(e.themeMode),e.themeVariables&&cn.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");E.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&E.setActiveCaipNetwork(n)}initializeConnectionController(e){J.initialize(e.adapters??[]),J.setWcBasic(e.basic??!1)}initializeConnectorController(){K.initialize(this.chainNamespaces)}initializeProjectSettings(e){F.setProjectId(e.projectId),F.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var s;F.setDebug(e.debug!==!1),F.setEnableWalletConnect(e.enableWalletConnect!==!1),F.setEnableWalletGuide(e.enableWalletGuide!==!1),F.setEnableWallets(e.enableWallets!==!1),F.setEIP6963Enabled(e.enableEIP6963!==!1),F.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),F.setEnableReconnect(e.enableReconnect!==!1),F.setEnableAuthLogger(e.enableAuthLogger!==!1),F.setCustomRpcUrls(e.customRpcUrls),F.setEnableEmbedded(e.enableEmbedded),F.setAllWallets(e.allWallets),F.setIncludeWalletIds(e.includeWalletIds),F.setExcludeWalletIds(e.excludeWalletIds),F.setFeaturedWalletIds(e.featuredWalletIds),F.setTokens(e.tokens),F.setTermsConditionsUrl(e.termsConditionsUrl),F.setPrivacyPolicyUrl(e.privacyPolicyUrl),F.setCustomWallets(e.customWallets),F.setFeatures(e.features),F.setAllowUnsupportedChain(e.allowUnsupportedChain),F.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),F.setPreferUniversalLinks(e.experimental_preferUniversalLinks),F.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),F.setMetadata(e.metadata),F.setDisableAppend(e.disableAppend),F.setEnableEmbedded(e.enableEmbedded),F.setSIWX(e.siwx),!e.projectId){et.open(it.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((s=e.adapters)==null?void 0:s.find(i=>i.namespace===$.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");F.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,n,r,s;return ie.isClient()?{name:((n=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:n.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=br.getUnsupportedNetwork(`${n}:${e}`);E.setActiveCaipNetwork(r)}}getDefaultNetwork(){return br.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return br.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return br.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return n?br.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e),{caipAddress:i}=E.getAccountData(e)||{};return(i||!F.state.enableReconnect)&&(s!=null&&s.disconnect)&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var u;const e=E.state.activeChain,n=this.getAdapter(e),r=(u=this.getCaipNetwork(e))==null?void 0:u.id,s=J.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId((a==null?void 0:a.clientId)||null),H.setConnectedNamespaces([...E.state.chains.keys()]),await this.syncWalletConnectAccount(),await Un.initializeIfEnabled()},connectExternal:async({id:e,address:n,info:r,type:s,provider:i,chain:o,caipNetwork:a,socialUri:c})=>{var p,g,m,v,w,b;const u=E.state.activeChain,l=o||u,d=this.getAdapter(l);if(o&&o!==u&&!a){const S=this.getCaipNetworks().find(_=>_.chainNamespace===o);S&&this.setCaipNetwork(S)}if(!l)throw new Error("connectExternal: namespace not found");if(!d)throw new Error("connectExternal: adapter not found");const h=this.getCaipNetwork(l),f=await d.connect({id:e,address:n,info:r,type:s,provider:i,socialUri:c,chainId:(a==null?void 0:a.id)||(h==null?void 0:h.id),rpcUrl:((m=(g=(p=a==null?void 0:a.rpcUrls)==null?void 0:p.default)==null?void 0:g.http)==null?void 0:m[0])||((b=(w=(v=h==null?void 0:h.rpcUrls)==null?void 0:v.default)==null?void 0:w.http)==null?void 0:b[0])});if(f)return H.addConnectedNamespace(l),this.syncProvider({...f,chainNamespace:l}),this.setStatus("connected",l),this.syncConnectedWalletInfo(l),H.removeDisconnectedConnectorId(e,l),{address:f.address}},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{var a;const i=E.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:n,type:r,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),H.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{var u;const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||E.state.activeChain,o=K.getConnectorId(i),a=n===$.CONNECTOR_ID.AUTH||o===$.CONNECTOR_ID.AUTH,c=n===$.CONNECTOR_ID.WALLET_CONNECT||o===$.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(E.state.chains.keys());let d=r?[r]:l;(c||a)&&(d=l);const h=d.map(async g=>{const m=K.getConnectorId(g),v=await this.disconnectNamespace(g,n||m);v&&(a&&H.deleteConnectedSocialProvider(),v.connections.forEach(w=>{H.addDisconnectedConnectorId(w.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),f=await Promise.allSettled(h);Le.resetSend(),J.resetWcConnection(),(u=Un.getSIWX())!=null&&u.signOutOnDisconnect&&await Un.clearSessions(),K.setFilterByNamespace(void 0),J.syncStorageConnections();const p=f.filter(g=>g.status==="rejected");if(p.length>0)throw new Error(p.map(g=>g.reason.message).join(", "));qe.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(n=>{var r;return!!((r=window.ethereum)!=null&&r[String(n)])}):!!window.ethereum,signMessage:async e=>{const n=E.state.activeChain,r=this.getAdapter(E.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=await(r==null?void 0:r.signMessage({message:e,address:ce.state.address,provider:Ve.getProvider(n)}));return(s==null?void 0:s.signature)||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Be.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=Ve.getProvider(n),i=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===$.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=Ve.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const o=await(r==null?void 0:r.estimateGas({...e,provider:s,caipNetwork:i}));return(o==null?void 0:o.gas)||0n}return 0n},getEnsAvatar:async()=>{var n;const e=E.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:ce.state.address,chainId:Number((n=this.getCaipNetwork())==null?void 0:n.id),chainNamespace:e}),ce.state.profileImage||!1},getEnsAddress:async e=>await Sr.resolveReownName(e),writeContract:async e=>{const n=E.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=Ve.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const a=await(r==null?void 0:r.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}));return a==null?void 0:a.hash},parseUnits:(e,n)=>{const r=this.getAdapter(E.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return(r==null?void 0:r.parseUnits({value:e,decimals:n}))??0n},formatUnits:(e,n)=>{const r=this.getAdapter(E.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return(r==null?void 0:r.formatUnits({value:e,decimals:n}))??"0"},getCapabilities:async e=>{const n=this.getAdapter(E.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await(n==null?void 0:n.getCapabilities(e))},grantPermissions:async e=>{const n=this.getAdapter(E.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await(n==null?void 0:n.grantPermissions(e))},revokePermissions:async e=>{const n=this.getAdapter(E.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n!=null&&n.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(E.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await(n==null?void 0:n.walletGetAssets(e))??{}},updateBalance:e=>{const n=this.getCaipNetwork(e);!n||!ce.state.address||this.updateNativeBalance(ce.state.address,n==null?void 0:n.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},J.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var n,r,s,i,o;if(Ve.getProviderId(E.state.activeChain)===tt.CONNECTOR_TYPE_WALLET_CONNECT){const a=(r=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Ve.getProvider(n),i=Ve.getProviderId(n);if(e.chainNamespace===E.state.activeChain){const o=this.getAdapter(n);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===tt.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=En.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===r);return s?(s.construct({namespace:r,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),n[r]=s):n[r]=new Q7({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){var n;this.onConnectors(e),this.listenAdapter(e),await((n=this.chainAdapters)==null?void 0:n[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const n=this.getAdapter(e);n==null||n.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=H.getConnectionStatus();F.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(H.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(u=>u.id.toString()===i.toString()||u.caipNetworkId.toString()===i.toString()),a=E.state.activeChain===e,c=E.getAccountProp("address",e);if(o){const u=a&&s?s:c;u&&this.syncAccount({address:u,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{this.onDisconnectNamespace({chainNamespace:e})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=ce.state.address,i=E.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{var c,u;const a=E.state.activeChain===e;o!=null&&o.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e)),a&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):a&&((c=E.state.activeCaipNetwork)!=null&&c.id)?this.syncAccount({address:s,chainId:(u=E.state.activeCaipNetwork)==null?void 0:u.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),H.addConnectedNamespace(e)})}async createUniversalProviderForAdapter(e){var n,r,s;await this.getUniversalProvider(),this.universalProvider&&await((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setUniversalProvider)==null?void 0:s.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>J.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async syncNamespaceConnection(e){try{e===$.CHAIN.EVM&&ie.isSafeApp()&&K.setConnectorId($.CONNECTOR_ID.SAFE,e);const n=K.getConnectorId(e);switch(this.setStatus("connecting",e),n){case $.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case $.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};E.resetAccount(n),E.resetNetwork(n),H.removeConnectedNamespace(n);const s=Array.from(E.state.chains.keys());(n?[n]:s).forEach(o=>H.addDisconnectedConnectorId(K.getConnectorId(o)||"",o)),K.removeConnectorId(n),Ve.resetChain(n),this.setUser(void 0,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(void 0,n),r!==!1&&$e.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{var s;const n=this.getCaipAddress(e),r=this.getCaipNetwork(e);return(s=this.chainAdapters)==null?void 0:s[e].syncConnections({connectToFirstConnector:!n,caipNetwork:r,getConnectorStorageInfo(i){const a=H.getConnections()[e]??[];return{hasDisconnected:H.isConnectorDisconnected(i,e),hasConnected:a.some(c=>At.isLowerCaseMatch(c.connectorId,i))}}})}))}async syncAdapterConnection(e){var a,c,u;const n=this.getAdapter(e),r=K.getConnectorId(e),s=this.getCaipNetwork(e),o=K.getConnectors(e).find(l=>l.id===r);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const l=await(n==null?void 0:n.syncConnection({namespace:e,id:o.id,chainId:s.id,rpcUrl:(u=(c=(a=s==null?void 0:s.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:u[0]}));l?(this.syncProvider({...l,chainNamespace:e}),await this.syncAccount({...l,chainNamespace:e}),this.setStatus("connected",e)):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){var r,s;const e=Object.keys(((s=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:s.namespaces)||{}),n=this.chainNamespaces.map(async i=>{var l,d,h,f,p;const o=this.getAdapter(i);if(!o)return;const a=((f=(h=(d=(l=this.universalProvider)==null?void 0:l.session)==null?void 0:d.namespaces)==null?void 0:h[i])==null?void 0:f.accounts)||[],c=(p=E.state.activeCaipNetwork)==null?void 0:p.id,u=a.find(g=>{const{chainId:m}=En.parseCaipAddress(g);return m===(c==null?void 0:c.toString())})||a[0];if(u){const g=En.validateCaipAddress(u),{chainId:m,address:v}=En.parseCaipAddress(g);if(Ve.setProviderId(i,tt.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&E.state.activeCaipNetwork&&o.namespace!==$.CHAIN.EVM){const w=o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:E.state.activeCaipNetwork});Ve.setProvider(i,w)}else Ve.setProvider(i,this.universalProvider);K.setConnectorId($.CONNECTOR_ID.WALLET_CONNECT,i),H.addConnectedNamespace(i),await this.syncAccount({address:v,chainId:m,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);this.syncConnectedWalletInfo(i),await E.setApprovedCaipNetworksData(i)});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){Ve.setProviderId(s,e),Ve.setProvider(s,n),K.setConnectorId(r,s)}async syncAccount(e){var d,h;const n=e.chainNamespace===E.state.activeChain,r=E.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=H.getActiveNetworkProps(),c=i||a,u=((d=E.state.activeCaipNetwork)==null?void 0:d.name)===$.UNSUPPORTED_NETWORK_NAME,l=E.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(u&&!l)&&c){let f=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),p=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!l&&!f&&!p){const m=this.getApprovedCaipNetworkIds()||[],v=m.find(b=>{var S;return((S=En.parseCaipNetworkId(b))==null?void 0:S.chainId)===c.toString()}),w=m.find(b=>{var S;return((S=En.parseCaipNetworkId(b))==null?void 0:S.chainNamespace)===o});f=this.getCaipNetworks().find(b=>b.caipNetworkId===v),p=this.getCaipNetworks().find(b=>b.caipNetworkId===w||"deprecatedCaipNetworkId"in b&&b.deprecatedCaipNetworkId===w)}const g=f||p;(g==null?void 0:g.chainNamespace)===E.state.activeChain?F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&((h=E.state.activeCaipNetwork)==null?void 0:h.name)===$.UNSUPPORTED_NETWORK_NAME?E.showUnsupportedChainUI():this.setCaipNetwork(g):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),At.isLowerCaseMatch(s,ce.state.address)||this.syncAccountInfo(s,g==null?void 0:g.id,o),n?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r==null?void 0:r.id,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){var s;const n=K.getConnectorId(e),r=Ve.getProviderId(e);if(r===tt.CONNECTOR_TYPE_ANNOUNCED||r===tt.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{var l,d;const a=o.id===n,c=((l=o.info)==null?void 0:l.rdns)===n,u=(d=o.connectors)==null?void 0:d.some(h=>{var f;return h.id===n||((f=h.info)==null?void 0:f.rdns)===n});return a||c||!!u});if(i){const{info:o,name:a,imageUrl:c}=i,u=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:u,...o},e)}}}else if(r===tt.CONNECTOR_TYPE_WALLET_CONNECT){const i=Ve.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(n&&n===$.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===$.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}}async syncBalance(e){!La.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var s;return r.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=E.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var r,s,i,o,a,c,u,l,d,h;const e=o9.createLogger((f,...p)=>{f&&this.handleAlertError(f),console.error(...p)}),n={projectId:(r=this.options)==null?void 0:r.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(u=this.options)==null?void 0:u.metadata.url:"",icons:(l=this.options)!=null&&l.metadata?(d=this.options)==null?void 0:d.metadata.icons:[""]},logger:e};F.setManualWCControl(!!((h=this.options)!=null&&h.manualWCControl)),this.universalProvider=this.options.universalProvider??await r9.init(n),F.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{Sr.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{J.setUri(n)},onConnect:()=>{J.finalizeWcConnection()},onDisconnect:()=>{E.state.noAdapters&&this.resetAccount(e),J.resetWcConnection()},onChainChanged:n=>{const r=E.state.activeChain,s=r&&K.state.activeConnectorIds[r]===$.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(E.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}(o==null?void 0:o.id.toString())!==(i==null?void 0:i.id.toString())&&(o==null?void 0:o.chainNamespace)===(i==null?void 0:i.chainNamespace)&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=E.state.activeChain,s=r&&K.state.activeConnectorIds[r]===$.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(E.state.noAdapters||s)&&n.length>0){const i=n[0];this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&ie.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){qe.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const n=Object.entries(it.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=it.ALERT_ERRORS[o];a&&(et.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var n;if(e)return(n=this.chainAdapters)==null?void 0:n[e]}createAdapter(e){var s;if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&J.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return $e.open({...e,data:{swap:e.arguments}})}return $e.open(e)}async close(){await this.injectModalUi(),$e.close()}setLoading(e,n){$e.setLoading(e,n)}async disconnect(e){await J.disconnect({namespace:e})}getSIWX(){return F.state.siwx}getError(){return""}getChainId(){var e;return(e=E.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const n=this.getCaipNetworks().find(r=>r.id===e.id);if(!n){et.open(it.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await E.switchActiveNetwork(n)}getWalletProvider(){return E.state.activeChain?Ve.state.providers[E.state.activeChain]:null}getWalletProviderType(){return Ve.getProviderId(E.state.activeChain)}subscribeProviders(e){return Ve.subscribeProviders(e)}getThemeMode(){return cn.state.themeMode}getThemeVariables(){return cn.state.themeVariables}setThemeMode(e){cn.setThemeMode(e),mC(cn.state.themeMode)}setTermsConditionsUrl(e){F.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){F.setPrivacyPolicyUrl(e)}setThemeVariables(e){cn.setThemeVariables(e),K7(cn.state.themeVariables)}subscribeTheme(e){return cn.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?J.subscribe(e):(et.open($.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?E.getAccountProp("connectedWalletInfo",e):ce.state.connectedWalletInfo}getAccount(e){const n=e||E.state.activeChain,r=K.getAuthConnector(n),s=E.getAccountData(n),i=H.getConnectedConnectorId(E.state.activeChain),o=J.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:u,type:l})=>ie.createAccount(n,u,l||"eoa")));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:ie.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===$.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:H.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:In(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?E.subscribeChainProp("accountState",r,n):E.subscribe(r),K.subscribe(r)}subscribeNetwork(e){return E.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n==null?void 0:n.id,caipNetworkId:n==null?void 0:n.caipNetworkId})})}subscribeWalletInfo(e,n){return n?ce.subscribeKey("connectedWalletInfo",e,n):ce.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){ce.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){E.subscribeKey("activeCaipNetwork",e)}getState(){return Cr.state}getRemoteFeatures(){return F.state.remoteFeatures}subscribeState(e){return Cr.subscribe(e)}subscribeRemoteFeatures(e){return F.subscribeKey("remoteFeatures",e)}showErrorMessage(e){vr.showError(e)}showSuccessMessage(e){vr.showSuccess(e)}getEvent(){return{...qe.state}}subscribeEvents(e){return qe.subscribe(e)}replace(e){ge.replace(e)}redirect(e){ge.push(e)}popTransactionStack(e){ge.popTransactionStack(e)}isOpen(){return $e.state.open}isTransactionStackEmpty(){return ge.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){F.setFeatures(e)}updateRemoteFeatures(e){F.setRemoteFeatures(e)}updateOptions(e){const r={...F.state||{},...e};F.setOptions(r)}setConnectMethodsOrder(e){F.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){F.setWalletFeaturesOrder(e)}setCollapseWallets(e){F.setCollapseWallets(e)}setSocialsOrder(e){F.setSocialsOrder(e)}getConnectMethodsOrder(){return Hf.getConnectOrderMethod(F.state.features,K.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||E.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&E.removeNetwork(e,n)}}let s0=!1;class rj extends nj{async onAuthProviderConnected(e){e.message&&e.signature&&e.siwxMessage&&await Un.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature);const n=E.state.activeChain;if(!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===$.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=F.state.defaultAccountTypes[n],i=In(n),o=e.preferredAccountType||i||s;At.isLowerCaseMatch(e.address,ce.state.address)||this.syncIdentity({address:e.address,chainId:e.chainId,chainNamespace:n}),this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:u,...l}=e;this.setUser({...ce.state.user||{},...l},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{Cn.checkIfRequestExists(n)?Cn.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(wt.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(wt.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=Cn.checkIfRequestIsSafe(r),i=ce.state.address,o=E.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=E.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");K.getConnectorId(n)===$.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=E.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=cn.getSnapshot(),r=F.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:Gr(n.themeVariables,n.themeMode)})])}async syncAuthConnector(e,n){var u,l,d,h;const r=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===E.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername();this.setUser({...((u=ce.state)==null?void 0:u.user)||{},username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),n&&r&&s){const f=await e.getSmartAccountEnabledNetworks();E.setSmartAccountEnabledNetworks((f==null?void 0:f.smartAccountEnabledNetworks)||[],n),c&&((l=this.connectionControllerClient)!=null&&l.connectExternal)?(await((h=this.connectionControllerClient)==null?void 0:h.connectExternal({id:$.CONNECTOR_ID.AUTH,info:{name:$.CONNECTOR_ID.AUTH},type:tt.CONNECTOR_TYPE_AUTH,provider:e,chainId:(d=E.state.activeCaipNetwork)==null?void 0:d.id,chain:n})),this.setStatus("connected",n)):K.getConnectorId(n)===$.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),H.removeConnectedNamespace(n))}this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){var n,r;try{if(!ie.isTelegram())return;const s=H.getTelegramSocialProvider();if(!s||!ie.isClient())return;const o=new URL(window.location.href).searchParams.get("result_uri");if(!o)return;ce.setSocialProvider(s,e),await((n=this.authProvider)==null?void 0:n.init());const a=K.getAuthConnector();s&&a&&(this.setLoading(!0,e),await J.connectExternal({id:a.id,type:a.type,socialUri:o},a.chain),H.setConnectedSocialProvider(s),H.removeTelegramSocialProvider(),qe.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:s,caipNetworkId:(r=E.getActiveCaipNetwork())==null?void 0:r.caipNetworkId}}))}catch(s){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",s)}try{const s=new URL(window.location.href);s.searchParams.delete("result_uri"),window.history.replaceState({},document.title,s.toString())}catch(s){console.error("tma social login failed",s)}}createAuthProvider(e){var u,l,d,h;if(!$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=(u=this.remoteFeatures)==null?void 0:u.email,s=Array.isArray((l=this.remoteFeatures)==null?void 0:l.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=At.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((d=this.options)!=null&&d.projectId)&&i&&(this.authProvider=li.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(h=this.getCaipNetwork(a))==null?void 0:h.caipNetworkId,abortController:it.EmbeddedWalletAbortController,onTimeout:f=>{f==="iframe_load_failed"?et.open(it.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):f==="iframe_request_timeout"?et.open(it.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):f==="unverified_domain"&&et.open(it.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:f=>E.getActiveCaipNetwork(f)}),Cr.subscribeOpen(f=>{var p;!f&&this.isTransactionStackEmpty()&&((p=this.authProvider)==null||p.rejectRpcRequests())}));const c=e===E.state.activeChain&&F.state.enableReconnect;F.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var n,r,s;this.createAuthProvider(e),this.authProvider&&((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setAuthProvider)==null||s.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&le.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,a;if(!e)return;const n=E.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&s){const c=this.getAdapter(r),u=Ve.getProvider(r),l=Ve.getProviderId(r);await(c==null?void 0:c.switchNetwork({caipNetwork:e,provider:u,providerType:l})),this.setCaipNetwork(e)}else{const u=Ve.getProviderId(n)===tt.CONNECTOR_TYPE_AUTH,l=Ve.getProviderId(r),d=l===tt.CONNECTOR_TYPE_AUTH,h=$.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((u&&l===void 0||d)&&h)try{if(E.state.activeChain=e.chainNamespace,s){const f=this.getAdapter(r);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:l}))}else await((a=(o=this.connectionControllerClient)==null?void 0:o.connectExternal)==null?void 0:a.call(o,{id:$.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:tt.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const p=this.getAdapter(r);await(p==null?void 0:p.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:l}))}else if(l===tt.CONNECTOR_TYPE_WALLET_CONNECT){if(!E.state.noAdapters){const f=this.getAdapter(r),p=Ve.getProvider(r),g=Ve.getProviderId(r);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:p,providerType:g}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){var n;await super.initialize(e),(n=this.chainNamespaces)==null||n.forEach(r=>{this.createAuthProviderForAdapter(r)}),await this.injectModalUi(),Cr.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){var o;const s=`${r}:${n}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(r!==$.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});this.setProfileName(a,r),this.setProfileImage(c,r)}catch{await this.syncReownName(e,r),n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=Ve.getProviderId(e);if(n===tt.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=H.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(ie.isClient()&&!s0)try{const e={...Be.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),ie.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!F.state.disableAppend&&!F.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}s0=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!ie.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(Ht(()=>import("./DnAqqwf4.js"),__vite__mapDeps([6,7,8,9,10,11,12,13,14,15,16,17,18]),import.meta.url)),n.email&&r.push(Ht(()=>import("./DA4wh6vk.js"),__vite__mapDeps([19,7,8,18,12,17,11,16,20,13]),import.meta.url)),n.socials&&r.push(Ht(()=>import("./DTETl9Ch.js"),__vite__mapDeps([21,7,8,22,11,23,24,17,25,16,12,18,26,10,27]),import.meta.url)),n.swaps&&n.swaps.length>0&&r.push(Ht(()=>import("./NC_6RwF3.js"),__vite__mapDeps([28,7,8,16,12,29,30,31,10,17,27,13,11]),import.meta.url)),e.send&&r.push(Ht(()=>import("./DSGET4GS.js"),__vite__mapDeps([32,7,8,16,12,17,11,23,18,31,10,13,33,34]),import.meta.url)),e.receive&&r.push(Ht(()=>import("./DyHj-ff_.js"),__vite__mapDeps([35,7,8,36,10,26]),import.meta.url)),n.onramp&&n.onramp.length>0&&r.push(Ht(()=>import("./CVby7M2N.js"),__vite__mapDeps([37,7,8,38,10,12,17,22,11,23,39,18,16,25,13]),import.meta.url)),n.activity&&r.push(Ht(()=>import("./753QrkIx.js"),__vite__mapDeps([40,7,8,41,1,17,18,10,27]),import.meta.url)),e.pay&&r.push(Ht(()=>import("./Dv5IYN-j.js"),__vite__mapDeps([42,7,8,16,12,43,10,17,14,38,34,25]),import.meta.url)),await Promise.all([...r,Ht(()=>import("./BQAvWlWe.js"),__vite__mapDeps([44,7,8,10,12,33,17,45,30,14,38,16,15,43,41,1,18,27,29,34,11,13,20,22,23,24,9,25,36,26,39]),import.meta.url),Ht(()=>import("./CWJ0pDpQ.js"),__vite__mapDeps([46,7,8,14,10,17,15,12,30,45]),import.meta.url)])}}const sj="1.7.15";function GW(t){return new rj({...t,sdkVersion:ie.generateSdkVersion(t.adapters??[],"html",sj)})}function Ln(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}const Hu="2.17.3",ij=()=>`@wagmi/core@${Hu}`;var wC=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Al,bC;class or extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return ij()}constructor(e,n={}){var i;super(),Al.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const r=n.cause instanceof or?n.cause.details:(i=n.cause)!=null&&i.message?n.cause.message:n.details,s=n.cause instanceof or&&n.cause.docsPath||n.docsPath;this.message=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}walk(e){return wC(this,Al,"m",bC).call(this,this,e)}}Al=new WeakSet,bC=function t(e,n){return n!=null&&n(e)?e:e.cause?wC(this,Al,"m",t).call(this,e.cause,n):e};class Tc extends or{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class oj extends or{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class aj extends or{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class cj extends or{constructor({address:e,connector:n}){super(`Account "${e}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class uj extends or{constructor({connectionChainId:e,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class lj extends or{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function bh(t,e){var r;let n;if(typeof e.connector=="function"?n=t._internal.connectors.setup(e.connector):n=e.connector,n.uid===t.state.current)throw new oj;try{t.setState(c=>({...c,status:"connecting"})),n.emitter.emit("message",{type:"connecting"});const{connector:s,...i}=e,o=await n.connect(i),a=o.accounts;return n.emitter.off("connect",t._internal.events.connect),n.emitter.on("change",t._internal.events.change),n.emitter.on("disconnect",t._internal.events.disconnect),await((r=t.storage)==null?void 0:r.setItem("recentConnectorId",n.id)),t.setState(c=>({...c,connections:new Map(c.connections).set(n.uid,{accounts:a,chainId:o.chainId,connector:n}),current:n.uid,status:"connected"})),{accounts:a,chainId:o.chainId}}catch(s){throw t.setState(i=>({...i,status:i.current?"connected":"disconnected"})),s}}async function ud(t,e={}){let n;if(e.connector){const{connector:u}=e;if(t.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new lj({connector:u});const[l,d]=await Promise.all([u.getAccounts().catch(h=>{if(e.account===null)return[];throw h}),u.getChainId()]);n={accounts:l,chainId:d,connector:u}}else n=t.state.connections.get(t.state.current);if(!n)throw new aj;const r=e.chainId??n.chainId,s=await n.connector.getChainId();if(s!==n.chainId)throw new uj({connectionChainId:n.chainId,connectorChainId:s});const i=n.connector;if(i.getClient)return i.getClient({chainId:r});const o=Rr(e.account??n.accounts[0]);if(o&&(o.address=ei(o.address)),e.account&&!n.accounts.some(u=>u.toLowerCase()===o.address.toLowerCase()))throw new cj({address:o.address,connector:i});const a=t.chains.find(u=>u.id===r),c=await n.connector.getProvider({chainId:r});return Gb({account:o,chain:a,name:"Connector Client",transport:u=>SS(c)({...u,retryCount:0})})}async function i0(t,e={}){var s,i;let n;if(e.connector)n=e.connector;else{const{connections:o,current:a}=t.state,c=o.get(a);n=c==null?void 0:c.connector}const r=t.state.connections;n&&(await n.disconnect(),n.emitter.off("change",t._internal.events.change),n.emitter.off("disconnect",t._internal.events.disconnect),n.emitter.on("connect",t._internal.events.connect),r.delete(n.uid)),t.setState(o=>{if(r.size===0)return{...o,connections:new Map,current:null,status:"disconnected"};const a=r.values().next().value;return{...o,connections:new Map(r),current:a.connector.uid}});{const o=t.state.current;if(!o)return;const a=(s=t.state.connections.get(o))==null?void 0:s.connector;if(!a)return;await((i=t.storage)==null?void 0:i.setItem("recentConnectorId",a.id))}}async function dj(t,e){const{chainId:n,connector:r,...s}=e;let i;e.account?i=e.account:i=(await ud(t,{account:e.account,chainId:n,connector:r})).account;const o=t.getClient({chainId:n});return Ln(o,Tb,"estimateGas")({...s,account:i})}function vC(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(HI[t])}function ka(t){const e=t.state.current,n=t.state.connections.get(e),r=n==null?void 0:n.accounts,s=r==null?void 0:r[0],i=t.chains.find(a=>a.id===(n==null?void 0:n.chainId)),o=t.state.status;switch(o){case"connected":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}async function hj(t,e){const{allowFailure:n=!0,chainId:r,contracts:s,...i}=e,o=t.getClient({chainId:r});return Ln(o,US,"multicall")({allowFailure:n,contracts:s,...i})}function fj(t,e){const{chainId:n,...r}=e,s=t.getClient({chainId:n});return Ln(s,zb,"readContract")(r)}async function pj(t,e){var a;const{allowFailure:n=!0,blockNumber:r,blockTag:s,...i}=e,o=e.contracts;try{const c={};for(const[h,f]of o.entries()){const p=f.chainId??t.state.chainId;c[p]||(c[p]=[]),(a=c[p])==null||a.push({contract:f,index:h})}const u=()=>Object.entries(c).map(([h,f])=>hj(t,{...i,allowFailure:n,blockNumber:r,blockTag:s,chainId:Number.parseInt(h),contracts:f.map(({contract:p})=>p)})),l=(await Promise.all(u())).flat(),d=Object.values(c).flatMap(h=>h.map(({index:f})=>f));return l.reduce((h,f,p)=>(h&&(h[d[p]]=f),h),[])}catch(c){if(c instanceof db)throw c;const u=()=>o.map(l=>fj(t,{...l,blockNumber:r,blockTag:s}));return n?(await Promise.allSettled(u())).map(l=>l.status==="fulfilled"?{result:l.value,status:"success"}:{error:l.reason,result:void 0,status:"failure"}):await Promise.all(u())}}async function gj(t,e){const{address:n,blockNumber:r,blockTag:s,chainId:i,token:o,unit:a="ether"}=e;if(o)try{return await o0(t,{balanceAddress:n,chainId:i,symbolType:"string",tokenAddress:o})}catch(h){if(h.name==="ContractFunctionExecutionError"){const f=await o0(t,{balanceAddress:n,chainId:i,symbolType:"bytes32",tokenAddress:o}),p=Yf(Is(f.symbol,{dir:"right"}));return{...f,symbol:p}}throw h}const c=t.getClient({chainId:i}),l=await Ln(c,Nb,"getBalance")(r?{address:n,blockNumber:r}:{address:n,blockTag:s}),d=t.chains.find(h=>h.id===i)??c.chain;return{decimals:d.nativeCurrency.decimals,formatted:Ro(l,vC(a)),symbol:d.nativeCurrency.symbol,value:l}}async function o0(t,e){const{balanceAddress:n,chainId:r,symbolType:s,tokenAddress:i,unit:o}=e,a={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:s}]}],address:i},[c,u,l]=await pj(t,{allowFailure:!1,contracts:[{...a,functionName:"balanceOf",args:[n],chainId:r},{...a,functionName:"decimals",chainId:r},{...a,functionName:"symbol",chainId:r}]}),d=Ro(c??"0",vC(o??u));return{decimals:u,formatted:d,symbol:l,value:c}}function xc(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,r;if(Array.isArray(t)&&Array.isArray(e)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!xc(t[r],e[r]))return!1;return!0}if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(i&&!xc(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}let Su=[];function Hr(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||xc(Su,e)?Su:(Su=e,e)}async function mj(t,e){const{account:n,chainId:r,...s}=e,i=n??ka(t).address,o=t.getClient({chainId:r});return Ln(o,fp,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}let vh=!1;async function a0(t,e={}){var u,l;if(vh)return[];vh=!0,t.setState(d=>({...d,status:d.current?"reconnecting":"connecting"}));const n=[];if((u=e.connectors)!=null&&u.length)for(const d of e.connectors){let h;typeof d=="function"?h=t._internal.connectors.setup(d):h=d,n.push(h)}else n.push(...t.connectors);let r;try{r=await((l=t.storage)==null?void 0:l.getItem("recentConnectorId"))}catch{}const s={};for(const[,d]of t.state.connections)s[d.connector.id]=1;r&&(s[r]=0);const i=Object.keys(s).length>0?[...n].sort((d,h)=>(s[d.id]??10)-(s[h.id]??10)):n;let o=!1;const a=[],c=[];for(const d of i){const h=await d.getProvider().catch(()=>{});if(!h||c.some(g=>g===h)||!await d.isAuthorized())continue;const p=await d.connect({isReconnecting:!0}).catch(()=>null);p&&(d.emitter.off("connect",t._internal.events.connect),d.emitter.on("change",t._internal.events.change),d.emitter.on("disconnect",t._internal.events.disconnect),t.setState(g=>{const m=new Map(o?g.connections:new Map).set(d.uid,{accounts:p.accounts,chainId:p.chainId,connector:d});return{...g,current:o?g.current:d.uid,connections:m}}),a.push({accounts:p.accounts,chainId:p.chainId,connector:d}),c.push(h),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(d=>({...d,status:"connected"})):t.setState(d=>({...d,connections:new Map,current:null,status:"disconnected"}))),vh=!1,a}async function yj(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?o=t.getClient({chainId:r}):o=await ud(t,{account:n??void 0,chainId:r,connector:s}),await Ln(o,Hb,"sendTransaction")({...i,...n?{account:n}:{},chain:r?{id:r}:null,gas:i.gas??void 0})}async function wj(t,e){const{account:n,connector:r,...s}=e;let i;return typeof n=="object"&&n.type==="local"?i=t.getClient():i=await ud(t,{account:n,connector:r}),Ln(i,FS,"signMessage")({...s,...n?{account:n}:{}})}class ws extends or{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class bj extends or{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function c0(t,e){var o;const{addEthereumChainParameter:n,chainId:r}=e,s=t.state.connections.get(((o=e.connector)==null?void 0:o.uid)??t.state.current);if(s){const a=s.connector;if(!a.switchChain)throw new bj({connector:a});return await a.switchChain({addEthereumChainParameter:n,chainId:r})}const i=t.chains.find(a=>a.id===r);if(!i)throw new Tc;return t.setState(a=>({...a,chainId:r})),i}function vj(t,e){const{onChange:n}=e;return t.subscribe(()=>ka(t),n,{equalityFn(r,s){const{connector:i,...o}=r,{connector:a,...c}=s;return xc(o,c)&&(i==null?void 0:i.id)===(a==null?void 0:a.id)&&(i==null?void 0:i.uid)===(a==null?void 0:a.uid)}})}function Ej(t,e){const{onChange:n}=e;return t.subscribe(()=>Hr(t),n,{equalityFn:xc})}function Cj(t,e){const{onChange:n}=e;return t._internal.connectors.subscribe((r,s)=>{n(Object.values(r),s)})}function _j(t,e){const{syncConnectedChain:n=t._internal.syncConnectedChain,...r}=e;let s;const i=c=>{s&&s();const u=t.getClient({chainId:c});return s=Ln(u,BS,"watchPendingTransactions")(r),s},o=i(e.chainId);let a;return n&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o==null||o(),a==null||a()}}async function Aj(t,e){const{chainId:n,timeout:r=0,...s}=e,i=t.getClient({chainId:n}),a=await Ln(i,LS,"waitForTransactionReceipt")({...s,timeout:r});if(a.status==="reverted"){const u=await Ln(i,Yb,"getTransaction")({hash:a.transactionHash}),d=await Ln(i,jb,"call")({...u,data:u.input,gasPrice:u.type!=="eip1559"?u.gasPrice:void 0,maxFeePerGas:u.type==="eip1559"?u.maxFeePerGas:void 0,maxPriorityFeePerGas:u.type==="eip1559"?u.maxPriorityFeePerGas:void 0}),h=d!=null&&d.data?Yf(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}async function Ij(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?o=t.getClient({chainId:r}):o=await ud(t,{account:n??void 0,chainId:r,connector:s}),await Ln(o,ES,"writeContract")({...i,...n?{account:n}:{},chain:r?{id:r}:null})}function KW(t){return t}ld.type="injected";function ld(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:n}=t;function r(){const c=t.target;if(typeof c=="function"){const u=c();if(u)return u}return typeof c=="object"?c:typeof c=="string"?{...Sj[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(u){return u==null?void 0:u.ethereum}}}let s,i,o,a;return c=>({get icon(){return r().icon},get id(){return r().id},get name(){return r().name},get supportsSimulation(){return!0},type:ld.type,async setup(){const u=await this.getProvider();u!=null&&u.on&&t.target&&(o||(o=this.onConnect.bind(this),u.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),u.on("accountsChanged",s)))},async connect({chainId:u,isReconnecting:l}={}){var f,p,g,m,v,w;const d=await this.getProvider();if(!d)throw new ws;let h=[];if(l)h=await this.getAccounts().catch(()=>[]);else if(e)try{h=(m=(g=(p=(f=(await d.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0])==null?void 0:f.caveats)==null?void 0:p[0])==null?void 0:g.value)==null?void 0:m.map(S=>ei(S)),h.length>0&&(h=await this.getAccounts())}catch(b){const S=b;if(S.code===gt.code)throw new gt(S);if(S.code===Ss.code)throw S}try{!(h!=null&&h.length)&&!l&&(h=(await d.request({method:"eth_requestAccounts"})).map(_=>ei(_))),o&&(d.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),d.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),d.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),d.on("disconnect",a));let b=await this.getChainId();if(u&&b!==u){const S=await this.switchChain({chainId:u}).catch(_=>{if(_.code===gt.code)throw _;return{id:b}});b=(S==null?void 0:S.id)??b}return e&&await((v=c.storage)==null?void 0:v.removeItem(`${this.id}.disconnected`)),t.target||await((w=c.storage)==null?void 0:w.setItem("injected.connected",!0)),{accounts:h,chainId:b}}catch(b){const S=b;throw S.code===gt.code?new gt(S):S.code===Ss.code?new Ss(S):S}},async disconnect(){var l,d;const u=await this.getProvider();if(!u)throw new ws;i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o));try{await Kb(()=>u.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await((l=c.storage)==null?void 0:l.setItem(`${this.id}.disconnected`,!0)),t.target||await((d=c.storage)==null?void 0:d.removeItem("injected.connected"))},async getAccounts(){const u=await this.getProvider();if(!u)throw new ws;return(await u.request({method:"eth_accounts"})).map(d=>ei(d))},async getChainId(){const u=await this.getProvider();if(!u)throw new ws;const l=await u.request({method:"eth_chainId"});return Number(l)},async getProvider(){if(typeof window>"u")return;let u;const l=r();return typeof l.provider=="function"?u=l.provider(window):typeof l.provider=="string"?u=Wu(window,l.provider):u=l.provider,u&&!u.removeListener&&("off"in u&&typeof u.off=="function"?u.removeListener=u.off:u.removeListener=()=>{}),u},async isAuthorized(){var u,l;try{if(e&&await((u=c.storage)==null?void 0:u.getItem(`${this.id}.disconnected`))||!t.target&&!await((l=c.storage)==null?void 0:l.getItem("injected.connected")))return!1;if(!await this.getProvider()){if(n!==void 0&&n!==!1){const p=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",p),!!await this.getProvider()),g=typeof n=="number"?n:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(v=>window.addEventListener("ethereum#initialized",()=>v(p()),{once:!0}))]:[],new Promise(v=>setTimeout(()=>v(p()),g))]))return!0}throw new ws}return!!(await tl(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:u,chainId:l}){var p,g,m,v;const d=await this.getProvider();if(!d)throw new ws;const h=c.chains.find(w=>w.id===l);if(!h)throw new Tr(new Tc);const f=new Promise(w=>{const b=S=>{"chainId"in S&&S.chainId===l&&(c.emitter.off("change",b),w())};c.emitter.on("change",b)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:Ae(l)}]}).then(async()=>{await this.getChainId()===l&&c.emitter.emit("change",{chainId:l})}),f]),h}catch(w){const b=w;if(b.code===4902||((g=(p=b==null?void 0:b.data)==null?void 0:p.originalError)==null?void 0:g.code)===4902)try{const{default:S,..._}=h.blockExplorers??{};let T;u!=null&&u.blockExplorerUrls?T=u.blockExplorerUrls:S&&(T=[S.url,...Object.values(_).map(A=>A.url)]);let N;(m=u==null?void 0:u.rpcUrls)!=null&&m.length?N=u.rpcUrls:N=[((v=h.rpcUrls.default)==null?void 0:v.http[0])??""];const D={blockExplorerUrls:T,chainId:Ae(l),chainName:(u==null?void 0:u.chainName)??h.name,iconUrls:u==null?void 0:u.iconUrls,nativeCurrency:(u==null?void 0:u.nativeCurrency)??h.nativeCurrency,rpcUrls:N};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[D]}).then(async()=>{if(await this.getChainId()===l)c.emitter.emit("change",{chainId:l});else throw new gt(new Error("User rejected switch after adding network."))}),f]),h}catch(S){throw new gt(S)}throw b.code===gt.code?new gt(b):new Tr(b)}},async onAccountsChanged(u){var l;if(u.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const d=(await this.getChainId()).toString();this.onConnect({chainId:d}),e&&await((l=c.storage)==null?void 0:l.removeItem(`${this.id}.disconnected`))}else c.emitter.emit("change",{accounts:u.map(d=>ei(d))})},onChainChanged(u){const l=Number(u);c.emitter.emit("change",{chainId:l})},async onConnect(u){const l=await this.getAccounts();if(l.length===0)return;const d=Number(u.chainId);c.emitter.emit("connect",{accounts:l,chainId:d});const h=await this.getProvider();h&&(o&&(h.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),h.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),h.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),h.on("disconnect",a)))},async onDisconnect(u){const l=await this.getProvider();u&&u.code===1013&&l&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),l&&(i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o))))}})}const Sj={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t!=null&&t.coinbaseWalletExtension?t.coinbaseWalletExtension:Wu(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return Wu(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const n=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const r of n)if(e[r])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){var e,n;return(e=t==null?void 0:t.phantom)!=null&&e.ethereum?(n=t.phantom)==null?void 0:n.ethereum:Wu(t,"isPhantom")}}};function Wu(t,e){function n(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const r=t.ethereum;if(r!=null&&r.providers)return r.providers.find(s=>n(s));if(r&&n(r))return r}function Nj(t){if(typeof window>"u")return;const e=n=>t(n.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function Tj(){const t=new Set;let e=[];const n=()=>Nj(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let r=n();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),r==null||r()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),r==null||r(),r=n()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const xj=t=>(e,n,r)=>{const s=r.subscribe;return r.subscribe=(o,a,c)=>{let u=o;if(a){const l=(c==null?void 0:c.equalityFn)||Object.is;let d=o(r.getState());u=h=>{const f=o(h);if(!l(d,f)){const p=d;a(d=f,p)}},c!=null&&c.fireImmediately&&a(d,d)}return s(u)},t(e,n,r)},Pj=xj;function Oj(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const Vf=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return Vf(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Vf(r)(n)}}}},Rj=(t,e)=>(n,r,s)=>{let i={storage:Oj(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const a=new Set,c=new Set;let u=i.storage;if(!u)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...g)},r,s);const l=()=>{const g=i.partialize({...r()});return u.setItem(i.name,{state:g,version:i.version})},d=s.setState;s.setState=(g,m)=>{d(g,m),l()};const h=t((...g)=>{n(...g),l()},r,s);s.getInitialState=()=>h;let f;const p=()=>{var g,m;if(!u)return;o=!1,a.forEach(w=>{var b;return w((b=r())!=null?b:h)});const v=((m=i.onRehydrateStorage)==null?void 0:m.call(i,(g=r())!=null?g:h))||void 0;return Vf(u.getItem.bind(u))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate)return[!0,i.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var b;const[S,_]=w;if(f=i.merge(_,(b=r())!=null?b:h),n(f,!0),S)return l()}).then(()=>{v==null||v(f,void 0),f=r(),o=!0,c.forEach(w=>w(f))}).catch(w=>{v==null||v(void 0,w)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(u=g.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(a.add(g),()=>{a.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||p(),f||h},Dj=Rj,u0=t=>{let e;const n=new Set,r=(u,l)=>{const d=typeof u=="function"?u(e):u;if(!Object.is(d,e)){const h=e;e=l??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>c,subscribe:u=>(n.add(u),()=>n.delete(u))},c=e=t(r,s,a);return a},Eh=t=>t?u0(t):u0;var EC={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,u,l){this.fn=c,this.context=u,this.once=l||!1}function i(c,u,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var f=new s(l,d||c,h),p=n?n+u:u;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var u=[],l,d;if(this._eventsCount===0)return u;for(d in l=this._events)e.call(l,d)&&u.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(l)):u},a.prototype.listeners=function(u){var l=n?n+u:u,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(u){var l=n?n+u:u,d=this._events[l];return d?d.fn?1:d.length:0},a.prototype.emit=function(u,l,d,h,f,p){var g=n?n+u:u;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,w,b;if(m.fn){switch(m.once&&this.removeListener(u,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,l),!0;case 3:return m.fn.call(m.context,l,d),!0;case 4:return m.fn.call(m.context,l,d,h),!0;case 5:return m.fn.call(m.context,l,d,h,f),!0;case 6:return m.fn.call(m.context,l,d,h,f,p),!0}for(b=1,w=new Array(v-1);b<v;b++)w[b-1]=arguments[b];m.fn.apply(m.context,w)}else{var S=m.length,_;for(b=0;b<S;b++)switch(m[b].once&&this.removeListener(u,m[b].fn,void 0,!0),v){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,l);break;case 3:m[b].fn.call(m[b].context,l,d);break;case 4:m[b].fn.call(m[b].context,l,d,h);break;default:if(!w)for(_=1,w=new Array(v-1);_<v;_++)w[_-1]=arguments[_];m[b].fn.apply(m[b].context,w)}}return!0},a.prototype.on=function(u,l,d){return i(this,u,l,d,!1)},a.prototype.once=function(u,l,d){return i(this,u,l,d,!0)},a.prototype.removeListener=function(u,l,d,h){var f=n?n+u:u;if(!this._events[f])return this;if(!l)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===l&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==l||h&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(u){var l;return u?(l=n?n+u:u,this._events[l]&&o(this,l)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(EC);var $j=EC.exports;const kj=Il($j);class Uj{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new kj})}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,...n){const r=n[0];this._emitter.emit(e,{uid:this.uid,...r})}listenerCount(e){return this._emitter.listenerCount(e)}}function Mj(t){return new Uj(t)}function Lj(t,e){return JSON.parse(t,(n,r)=>{let s=r;return(s==null?void 0:s.__type)==="bigint"&&(s=BigInt(s.value)),(s==null?void 0:s.__type)==="Map"&&(s=new Map(s.value)),(e==null?void 0:e(n,s))??s})}function l0(t,e){return t.slice(0,e).join(".")||"."}function d0(t,e){const{length:n}=t;for(let r=0;r<n;++r)if(t[r]===e)return r+1;return 0}function Bj(t,e){const n=typeof t=="function",r=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const u=d0(s,this);u===0?s[s.length]=this:(s.splice(u),i.splice(u)),i[i.length]=a;const l=d0(s,c);if(l!==0)return r?e.call(this,a,c,l0(i,l)):`[ref=${l0(i,l)}]`}else s[0]=c,i[0]=a;return n?t.call(this,a,c):c}}function Fj(t,e,n,r){return JSON.stringify(t,Bj((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),(e==null?void 0:e(s,o))??o},r),n??void 0)}function jj(t){const{deserialize:e=Lj,key:n="wagmi",serialize:r=Fj,storage:s=CC}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:n,async getItem(o,a){const c=s.getItem(`${n}.${o}`),u=await i(c);return u?e(u)??null:a??null},async setItem(o,a){const c=`${n}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,r(a)))},async removeItem(o){await i(s.removeItem(`${n}.${o}`))}}}const CC={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function zj(){const t=typeof window<"u"&&window.localStorage?window.localStorage:CC;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,n){try{t.setItem(e,n)}catch{}}}}const Gf=256;let Nu=Gf,Tu;function qj(t=11){if(!Tu||Nu+t>Gf*2){Tu="",Nu=0;for(let e=0;e<Gf;e++)Tu+=(256+Math.random()*256|0).toString(16).substring(1)}return Tu.substring(Nu,Nu+++t)}function Hj(t){const{multiInjectedProviderDiscovery:e=!0,storage:n=jj({storage:zj()}),syncConnectedChain:r=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?Tj():void 0,a=Eh(()=>i.chains),c=Eh(()=>{const _=[],T=new Set;for(const N of i.connectors??[]){const D=u(N);if(_.push(D),!s&&D.rdns){const A=typeof D.rdns=="string"?[D.rdns]:D.rdns;for(const U of A)T.add(U)}}if(!s&&o){const N=o.getProviders();for(const D of N)T.has(D.info.rdns)||_.push(u(l(D)))}return _});function u(_){var D;const T=Mj(qj()),N={..._({emitter:T,chains:a.getState(),storage:n,transports:i.transports}),emitter:T,uid:T.uid};return T.on("connect",b),(D=N.setup)==null||D.call(N),N}function l(_){const{info:T}=_,N=_.provider;return ld({target:{...T,id:T.rdns,provider:N}})}const d=new Map;function h(_={}){const T=_.chainId??m.getState().chainId,N=a.getState().find(A=>A.id===T);if(_.chainId&&!N)throw new Tc;{const A=d.get(m.getState().chainId);if(A&&!N)return A;if(!N)throw new Tc}{const A=d.get(T);if(A)return A}let D;if(i.client)D=i.client({chain:N});else{const A=N.id,U=a.getState().map(L=>L.id),P={},k=Object.entries(i);for(const[L,B]of k)if(!(L==="chains"||L==="client"||L==="connectors"||L==="transports"))if(typeof B=="object")if(A in B)P[L]=B[A];else{if(U.some(I=>I in B))continue;P[L]=B}else P[L]=B;D=Gb({...P,chain:N,batch:P.batch??{multicall:!0},transport:L=>i.transports[A]({...L,connectors:c})})}return d.set(T,D),D}function f(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const g="0.0.0-canary-";Hu.startsWith(g)?p=Number.parseInt(Hu.replace(g,"")):p=Number.parseInt(Hu.split(".")[0]??"0");const m=Eh(Pj(n?Dj(f,{migrate(_,T){if(T===p)return _;const N=f(),D=v(_,N.chainId);return{...N,chainId:D}},name:"store",partialize(_){return{connections:{__type:"Map",value:Array.from(_.connections.entries()).map(([T,N])=>{const{id:D,name:A,type:U,uid:P}=N.connector;return[T,{...N,connector:{id:D,name:A,type:U,uid:P}}]})},chainId:_.chainId,current:_.current}},merge(_,T){typeof _=="object"&&_&&"status"in _&&delete _.status;const N=v(_,T.chainId);return{...T,..._,chainId:N}},skipHydration:s,storage:n,version:p}):f));m.setState(f());function v(_,T){return _&&typeof _=="object"&&"chainId"in _&&typeof _.chainId=="number"&&a.getState().some(N=>N.id===_.chainId)?_.chainId:T}r&&m.subscribe(({connections:_,current:T})=>{var N;return T?(N=_.get(T))==null?void 0:N.chainId:void 0},_=>{if(a.getState().some(N=>N.id===_))return m.setState(N=>({...N,chainId:_??N.chainId}))}),o==null||o.subscribe(_=>{const T=new Set,N=new Set;for(const A of c.getState())if(T.add(A.id),A.rdns){const U=typeof A.rdns=="string"?[A.rdns]:A.rdns;for(const P of U)N.add(P)}const D=[];for(const A of _){if(N.has(A.info.rdns))continue;const U=u(l(A));T.has(U.id)||D.push(U)}n&&!m.persist.hasHydrated()||c.setState(A=>[...A,...D],!0)});function w(_){m.setState(T=>{const N=T.connections.get(_.uid);return N?{...T,connections:new Map(T.connections).set(_.uid,{accounts:_.accounts??N.accounts,chainId:_.chainId??N.chainId,connector:N.connector})}:T})}function b(_){m.getState().status==="connecting"||m.getState().status==="reconnecting"||m.setState(T=>{const N=c.getState().find(D=>D.uid===_.uid);return N?(N.emitter.listenerCount("connect")&&N.emitter.off("connect",w),N.emitter.listenerCount("change")||N.emitter.on("change",w),N.emitter.listenerCount("disconnect")||N.emitter.on("disconnect",S),{...T,connections:new Map(T.connections).set(_.uid,{accounts:_.accounts,chainId:_.chainId,connector:N}),current:_.uid,status:"connected"}):T})}function S(_){m.setState(T=>{const N=T.connections.get(_.uid);if(N){const A=N.connector;A.emitter.listenerCount("change")&&N.connector.emitter.off("change",w),A.emitter.listenerCount("disconnect")&&N.connector.emitter.off("disconnect",S),A.emitter.listenerCount("connect")||N.connector.emitter.on("connect",b)}if(T.connections.delete(_.uid),T.connections.size===0)return{...T,connections:new Map,current:null,status:"disconnected"};const D=T.connections.values().next().value;return{...T,connections:new Map(T.connections),current:D.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:n,getClient:h,get state(){return m.getState()},setState(_){let T;typeof _=="function"?T=_(m.getState()):T=_;const N=f();typeof T!="object"&&(T=N),Object.keys(N).some(A=>!(A in T))&&(T=N),m.setState(T,!0)},subscribe(_,T,N){return m.subscribe(_,T,N?{...N,fireImmediately:N.emitImmediately}:void 0)},_internal:{mipd:o,store:m,ssr:!!s,syncConnectedChain:r,transports:i.transports,chains:{setState(_){const T=typeof _=="function"?_(a.getState()):_;if(T.length!==0)return a.setState(T,!0)},subscribe(_){return a.subscribe(_)}},connectors:{providerDetailToConnector:l,setup:u,setState(_){return c.setState(typeof _=="function"?_(c.getState()):_,!0)},subscribe(_){return c.subscribe(_)}},events:{change:w,connect:b,disconnect:S}}}}function Wj(t){let e=[],n,r;function s(a){return La.parseEvmChainId(a)||1}function i(){var a;return n||(n=li.getInstance({projectId:t.options.projectId,chainId:(a=E.getActiveCaipNetwork())==null?void 0:a.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:c=>{c==="iframe_load_failed"?et.open(it.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?et.open(it.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&et.open(it.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:it.EmbeddedWalletAbortController,getActiveCaipNetwork:c=>E.getActiveCaipNetwork(c)})),n}async function o(a={}){var g;const c=i();let u=a.chainId;if(a.isReconnecting){const m=La.parseEvmChainId(c.getLastUsedChainId()||""),v=(g=t.chains)==null?void 0:g[0].id;if(u=m||v,!u)throw new Error("ChainId not found in provider")}const l=In("eip155"),{address:d,chainId:h,accounts:f}=await Un.authConnectorAuthenticate({authConnector:c,chainId:u,preferredAccountType:l,socialUri:a.socialUri,chainNamespace:$.CHAIN.EVM});e=(f==null?void 0:f.map(m=>m.address))||[d];const p=s(h);return{accounts:e,account:d,chainId:p,chain:{id:p,unsuported:!1}}}return a=>({id:$.CONNECTOR_ID.AUTH,name:$.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:$.CHAIN.EVM,async connect(c={}){if(r)return r;r||(r=new Promise(l=>{l(o(c))}));const u=await r;return r=void 0,u},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e!=null&&e.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){var c;return this.provider||(this.provider=li.getInstance({projectId:t.options.projectId,chainId:(c=E.getActiveCaipNetwork())==null?void 0:c.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:it.EmbeddedWalletAbortController,onTimeout:u=>{u==="iframe_load_failed"?et.open(it.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):u==="iframe_request_timeout"?et.open(it.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):u==="unverified_domain"&&et.open(it.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:u=>E.getActiveCaipNetwork(u)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:u}=await c.getChainId();return s(u)},async isAuthorized(){const u=E.state.activeChain===$.CHAIN.EVM;if($.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(h=>K.getConnectorId(h)===$.CONNECTOR_ID.AUTH)&&!u)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){var u;try{const l=a.chains.find(p=>p.id===c);if(!l)throw new Tr(new Error("chain not found on connector."));const d=await this.getProvider(),h=In("eip155"),f=await d.connect({chainId:c,preferredAccountType:h});return e=((u=f==null?void 0:f.accounts)==null?void 0:u.map(p=>p.address))||[f.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),l}catch(l){throw l instanceof Error?new Tr(l):l}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(ei)})},onChainChanged(c){const u=Number(c);a.emitter.emit("change",{chainId:u})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}sg.type="walletConnect";function sg(t,e){const n=t.isNewChainsStale??!0;let r,s,i,o,a,c,u;return l=>({id:"walletConnect",name:"WalletConnect",type:sg.type,async setup(){const d=await this.getProvider().catch(()=>null);d&&(o||(o=this.onConnect.bind(this),d.on("connect",o)),c||(c=this.onSessionDelete.bind(this),d.on("session_delete",c)))},async connect({...d}={}){var h,f,p;try{const g=E.getCaipNetworks(),m=await this.getProvider();if(!m)throw new ws;a||(a=this.onDisplayUri,m.on("display_uri",a));const v=await this.isChainsStale();m.session&&v&&await m.disconnect();const w=F.state.universalProviderConfigOverride;if(!m.session||v){const A=Sr.createNamespaces(g,w);await m.connect({optionalNamespaces:A,..."pairingTopic"in d?{pairingTopic:d.pairingTopic}:{}}),this.setRequestedChainsIds(g.map(U=>Number(U.id)))}const b=await this.getAccounts(),S=await this.getChainId(),_=(p=(f=(h=m.session)==null?void 0:h.namespaces)==null?void 0:f.eip155)==null?void 0:p.chains,T=_==null?void 0:_.some(A=>Number(A.split(":")[1])===S);let N=1;T?N=S:_!=null&&_[0]&&(N=Number(_[0].split(":")[1])),a&&(m.removeListener("display_uri",a),a=void 0),o&&(m.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),m.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),m.on("chainChanged",i)),u||(u=this.onDisconnect.bind(this),m.on("disconnect",u)),c||(c=this.onSessionDelete.bind(this),m.on("session_delete",c));const D=w==null?void 0:w.defaultChain;return m.setDefaultChain(D??`eip155:${N}`),{accounts:b,chainId:N}}catch(g){throw/(user rejected|connection request reset)/i.test(g==null?void 0:g.message)?new gt(g):g}},async disconnect(){const d=await this.getProvider();try{await(d==null?void 0:d.disconnect())}catch(h){if(!/No matching key/i.test(h.message))throw h}finally{i&&(d==null||d.removeListener("chainChanged",i),i=void 0),u&&(d==null||d.removeListener("disconnect",u),u=void 0),o||(o=this.onConnect.bind(this),d==null||d.on("connect",o)),s&&(d==null||d.removeListener("accountsChanged",s),s=void 0),c&&(d==null||d.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){var m,v,w;const d=await this.getProvider();if(!((m=d==null?void 0:d.session)!=null&&m.namespaces))return[];const h=(w=(v=d==null?void 0:d.session)==null?void 0:v.namespaces[$.CHAIN.EVM])==null?void 0:w.accounts,f=(h==null?void 0:h.map(b=>b.split(":")[2]))??[],p=new Set;return f.filter(b=>{const S=b==null?void 0:b.toLowerCase();return p.has(S)?!1:(p.add(S),!0)})},async getProvider({chainId:d}={}){var p,g;r||(r=await e.getUniversalProvider(),r==null||r.events.setMaxListeners(Number.POSITIVE_INFINITY));const h=H.getActiveNamespace(),f=(p=e.getCaipNetwork())==null?void 0:p.id;if(d&&f!==d&&h){const m=H.getStoredActiveCaipNetworkId(),v=h?e.getCaipNetworks(h):[],w=v==null?void 0:v.find(b=>b.id===m);w&&w.chainNamespace===$.CHAIN.EVM&&await((g=this.switchChain)==null?void 0:g.call(this,{chainId:Number(w.id)}))}return r},async getChainId(){var g,m,v,w;const d=(g=e.getCaipNetwork($.CHAIN.EVM))==null?void 0:g.id;if(d)return d;const f=(w=(v=(m=(await this.getProvider()).session)==null?void 0:m.namespaces[$.CHAIN.EVM])==null?void 0:v.chains)==null?void 0:w[0],p=E.getCaipNetworks().find(b=>b.id===f);return p==null?void 0:p.id},async isAuthorized(){try{const[d,h]=await Promise.all([this.getAccounts(),this.getProvider()]);return d.length?await this.isChainsStale()&&h.session?(await h.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:d,chainId:h}){var g,m,v,w;const f=await this.getProvider();if(!f)throw new ws;const p=E.getCaipNetworks().find(b=>b.id===h);if(!p)throw new Tr(new Tc);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:Ae(h)}]}),p!=null&&p.caipNetworkId&&f.setDefaultChain(p==null?void 0:p.caipNetworkId),l.emitter.emit("change",{chainId:Number(h)});const b=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...b,h]),{...p,id:p.id}}catch(b){const S=b;if(/(?:user rejected)/iu.test(S.message))throw new gt(S);try{let _;d!=null&&d.blockExplorerUrls?_=d.blockExplorerUrls:_=(g=p.blockExplorers)!=null&&g.default.url?[(m=p.blockExplorers)==null?void 0:m.default.url]:[];const T=((w=(v=p.rpcUrls)==null?void 0:v.chainDefault)==null?void 0:w.http)||[],N={blockExplorerUrls:_,chainId:Ae(h),chainName:p.name,iconUrls:d==null?void 0:d.iconUrls,nativeCurrency:p.nativeCurrency,rpcUrls:T};await f.request({method:"wallet_addEthereumChain",params:[N]});const D=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...D,h]),{...p,id:p.id}}catch(_){throw new gt(_)}}},onAccountsChanged(d){d.length===0?this.onDisconnect():l.emitter.emit("change",{accounts:d.map(h=>ei(h))})},onChainChanged(d){const h=Number(d);l.emitter.emit("change",{chainId:h})},onConnect(d){this.setRequestedChainsIds(E.getCaipNetworks().map(h=>Number(h.id)))},async onDisconnect(d){this.setRequestedChainsIds([]),l.emitter.emit("disconnect");const h=await this.getProvider();s&&(h.removeListener("accountsChanged",s),s=void 0),i&&(h.removeListener("chainChanged",i),i=void 0),u&&(h.removeListener("disconnect",u),u=void 0),c&&(h.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),h.on("connect",o))},onDisplayUri(d){l.emitter.emit("message",{type:"display_uri",data:d})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){var f,p,g;if(!((f=r==null?void 0:r.session)!=null&&f.namespaces))return[];const d=(g=(p=r==null?void 0:r.session)==null?void 0:p.namespaces[$.CHAIN.EVM])==null?void 0:g.accounts;return(d==null?void 0:d.map(m=>Number.parseInt(m.split(":")[1]??"")))??[]},async getRequestedChainsIds(){var h;const d=await((h=l.storage)==null?void 0:h.getItem(this.requestedChainsStorageKey))??[];return[...new Set(d)]},async isChainsStale(){if(!n)return!1;const d=l.chains.map(p=>p.id),h=this.getNamespaceChainsIds();if(h.length&&!h.some(p=>d.includes(p)))return!1;const f=await this.getRequestedChainsIds();return!d.every(p=>f.includes(Number(p)))},async setRequestedChainsIds(d){var h;await((h=l.storage)==null?void 0:h.setItem(this.requestedChainsStorageKey,d))},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const da=Ye({pendingTransactions:0}),h0={state:da,subscribeKey(t,e){return $t(da,t,e)},increase(t){da[t]+=1},decrease(t){da[t]-=1},reset(t){da[t]=0}};function Vj(t){try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}}async function Gj(t){if(ie.isSafeApp()){const{safe:e}=await Ht(async()=>{const{safe:n}=await import("./DyuJDvCh.js");return{safe:n}},__vite__mapDeps([47,8]),import.meta.url);if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function Kj(t){try{const{coinbaseWallet:e}=await Ht(async()=>{const{coinbaseWallet:n}=await import("./DyuJDvCh.js");return{coinbaseWallet:n}},__vite__mapDeps([47,8]),import.meta.url);if(e&&!t.some(n=>n.id==="coinbaseWalletSDK"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const Yj={enable:!1,pollingInterval:3e4};class YW extends yC{constructor(e){const n=br.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=$.CHAIN.EVM,this.adapterType=$.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...Yj,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===$.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!(i!=null&&i.user))return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>ie.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=ka(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>ie.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=ka(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===$.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{var a,c;const i=(a=e.transports)==null?void 0:a[s.id],o=br.getCaipNetworkId(s);i?n[s.id]=br.extendWagmiTransports(s,e.projectId,i):n[s.id]=br.getViemTransport(s,e.projectId,(c=e.customRpcUrls)==null?void 0:c[o])}),this.wagmiConfig=Hj({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=_j(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),h0.increase("pendingTransactions")}});const e=h0.subscribeKey("pendingTransactions",n=>{var r;n>=$.LIMITS.PENDING_TRANSACTIONS&&((r=this.unwatchPendingTransactions)==null||r.call(this),e())})}setupWatchers(){vj(this.wagmiConfig,{onChange:(e,n)=>{var r;if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e!=null&&e.chainId&&(e==null?void 0:e.chainId)!==(n==null?void 0:n.chainId)&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const s=e.address!==(n==null?void 0:n.address),i=e.connector.id!==((r=n.connector)==null?void 0:r.id),o=n.status!=="connected";(s||i||o)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}}),Ej(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===$.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:i})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:H.getConnectedSocialProvider(),username:H.getConnectedSocialUsername()}:void 0}}))}})}async addThirdPartyConnectors(e){const n=[];if(e.enableCoinbase!==!1){const s=await Kj(this.wagmiConfig.connectors);s&&n.push(s)}const r=await Gj(this.wagmiConfig.connectors);r&&n.push(r),await Promise.all(n.map(s=>{const i=this.wagmiConfig._internal.connectors.setup(s);return this.wagmiConfig._internal.connectors.setState(o=>[...o,i]),this.addWagmiConnector(i,e)}))}addWagmiConnectors(e,n){var o,a,c,u;const r=[];e.enableWalletConnect!==!1&&r.push(sg(e,n)),e.enableEIP6963!==!1&&r.push(ld({shimDisconnect:!0}));const s=((o=n==null?void 0:n.remoteFeatures)==null?void 0:o.email)??!0,i=Array.isArray((a=n==null?void 0:n.remoteFeatures)==null?void 0:a.socials)&&((u=(c=n==null?void 0:n.remoteFeatures)==null?void 0:c.socials)==null?void 0:u.length)>0;(s||i)&&r.push(Wj({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),r.forEach(l=>{const d=this.wagmiConfig._internal.connectors.setup(l);this.wagmiConfig._internal.connectors.setState(h=>[...h,d])})}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:e,chainId:n,connector:{id:r.id,name:vn.ConnectorNamesMap[r.id]??r.name,imageId:vn.ConnectorImageIds[r.id],type:vn.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===$.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async signMessage(e){try{return{signature:await wj(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:n,address:r}=ka(this.wagmiConfig),s={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chainId:n,type:"legacy",parameters:["nonce"]};await mj(this.wagmiConfig,s);const i=await yj(this.wagmiConfig,s);return await Aj(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){var o;const{caipNetwork:n,...r}=e,s=Number(La.caipNetworkIdToNumber(n.caipNetworkId));return{hash:await Ij(this.wagmiConfig,{chain:(o=this.wagmiChains)==null?void 0:o[s],chainId:s,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await dj(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return kS(e.value,e.decimals)}formatUnits(e){return Ro(e.value,e.decimals)}async addWagmiConnector(e,n){var s;if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");if(e.type===$.CONNECTOR_ID.INJECTED&&n.enableEIP6963===!1||e.id===$.CONNECTOR_ID.AUTH||e.id===$.CONNECTOR_ID.WALLET_CONNECT)return;const r=await e.getProvider().catch(()=>{});this.addConnector({id:e.id,explorerId:vn.ConnectorExplorerIds[e.id],imageUrl:((s=n==null?void 0:n.connectorImages)==null?void 0:s[e.id])??e.icon,name:vn.ConnectorNamesMap[e.id]??e.name,imageId:vn.ConnectorImageIds[e.id],type:vn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===$.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(e,n){Cj(this.wagmiConfig,{onChange:r=>{r.forEach(s=>this.addWagmiConnector(s,e))}}),this.addWagmiConnectors(e,n),await Promise.all(this.wagmiConfig.connectors.map(r=>this.addWagmiConnector(r,e))),this.addThirdPartyConnectors(e)}async syncConnections(){return Promise.resolve()}async syncConnection(e){var u,l;const{id:n,chainId:r}=e,i=Hr(this.wagmiConfig).find(d=>d.connector.id===n),o=this.getWagmiConnector(n),a=await(o==null?void 0:o.getProvider());if(ie.isSafeApp()&&n===$.CONNECTOR_ID.SAFE&&!(i!=null&&i.accounts.length)){const d=this.getWagmiConnector("safe");if(d){const h=await bh(this.wagmiConfig,{connector:d,chainId:Number(r)}),f=await d.getProvider();return{chainId:Number(r),address:h.accounts[0],provider:f,type:(u=i==null?void 0:i.connector.type)==null?void 0:u.toUpperCase(),id:i==null?void 0:i.connector.id}}}return{chainId:Number(i==null?void 0:i.chainId),address:i==null?void 0:i.accounts[0],provider:a,type:(l=i==null?void 0:i.connector.type)==null?void 0:l.toUpperCase(),id:i==null?void 0:i.connector.id}}async connectWalletConnect(e){const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await bh(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await c0(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}async connect(e){var h,f,p,g,m;const{id:n,address:r,provider:s,type:i,info:o,chainId:a,socialUri:c}=e,u=this.getWagmiConnector(n);if(!u)throw new Error("connectionControllerClient:connectExternal - connector is undefined");s&&o&&u.id===$.CONNECTOR_ID.EIP6963&&((h=u.setEip6963Wallet)==null||h.call(u,{provider:s,info:o}));const l=(p=(f=this.wagmiConfig.state)==null?void 0:f.connections)==null?void 0:p.get(u.uid);if(l){await((g=this.wagmiConfig.storage)==null?void 0:g.setItem("recentConnectorId",u.id));const v=[...l.accounts].sort((w,b)=>At.isLowerCaseMatch(w,r)?-1:At.isLowerCaseMatch(b,r)?1:0);return(m=this.wagmiConfig)==null||m.setState(w=>({...w,connections:new Map(w.connections).set(u.uid,{accounts:v,chainId:l.chainId,connector:l.connector}),current:u.uid,status:"connected"})),{address:v[0],chainId:l.chainId,provider:s,type:i,id:n}}const d=await bh(this.wagmiConfig,{connector:u,chainId:a?Number(a):void 0,socialUri:c});return{address:d.accounts[0],chainId:d.chainId,provider:s,type:i,id:n}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:n})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await a0(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=H.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{var c,u;try{const l=Number(e.chainId),d=await gj(this.wagmiConfig,{address:e.address,chainId:l,token:(u=(c=e.tokens)==null?void 0:c[r.caipNetworkId])==null?void 0:u.address});H.updateNativeBalanceCache({caipAddress:s,balance:d.formatted,symbol:d.symbol,timestamp:Date.now()}),a({balance:d.formatted,symbol:d.symbol})}catch(l){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",l),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){var e;return(e=this.getWagmiConnector("walletConnect"))==null?void 0:e.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=Hr(this.wagmiConfig).find(i=>At.isLowerCaseMatch(i.connector.id,e.id));return await i0(this.wagmiConfig,{connector:n}),F.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:i})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=Hr(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await i0(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:s})),connectorId:r.connector.id}))}}async switchNetwork(e){var s,i,o,a,c,u,l,d,h,f;const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(p=>p.id.toString()===n.id.toString());await c0(this.wagmiConfig,{chainId:n.id,addEthereumChainParameter:{chainName:(r==null?void 0:r.name)??n.name,nativeCurrency:(r==null?void 0:r.nativeCurrency)??n.nativeCurrency,rpcUrls:[((o=(i=(s=n.rpcUrls)==null?void 0:s.chainDefault)==null?void 0:i.http)==null?void 0:o[0])??((u=(c=(a=r==null?void 0:r.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:u[0])??""],blockExplorerUrls:[((d=(l=r==null?void 0:r.blockExplorers)==null?void 0:l.default)==null?void 0:d.url)??((f=(h=n.blockExplorers)==null?void 0:h.default)==null?void 0:f.url)??""]}}),await super.switchNetwork(e)}async getCapabilities(e){var a,c;if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=Hr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");const o=(c=(a=i.session)==null?void 0:a.sessionProperties)==null?void 0:c.capabilities;if(o){const l=Vj(o)[e];if(l)return l}return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=Hr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=Hr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=Hr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:$.CONNECTOR_ID.AUTH,type:"AUTH",name:$.CONNECTOR_NAMES.AUTH,provider:e,imageId:vn.ConnectorImageIds[$.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){return e.on("connect",()=>{const n=Hr(this.wagmiConfig),r=this.getWagmiConnector("walletConnect");if(r&&!n.find(s=>s.connector.id===r.id)){if(E.state.activeChain==="eip155")return;a0(this.wagmiConfig,{connectors:[r]})}}),this.addConnector(new rg({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}}const ZW="0884ac76a4fd711a06280ccd6ed32db7";export{yp as $,Ye as A,j as B,P7 as C,$t as D,_t as E,Dt as F,ka as G,va as H,vr as I,J,$ as K,qe as L,$e as M,l_ as N,In as O,ZW as P,wt as Q,ge as R,Tr as S,E as T,gt as U,he as V,YW as W,ie as X,z_ as Y,ce as Z,et as _,zu as a,xb as a$,Be as a0,E0 as a1,K as a2,b0 as a3,cn as a4,Yu as a5,tp as a6,Ds as a7,cz as a8,kl as a9,Ve as aA,p_ as aB,Cn as aC,tt as aD,Vh as aE,Jn as aF,$l as aG,Un as aH,le as aI,zW as aJ,Le as aK,lC as aL,Wf as aM,To as aN,xu as aO,vA as aP,RA as aQ,P0 as aR,ez as aS,az as aT,Jf as aU,Pl as aV,NI as aW,st as aX,Tb as aY,Rr as aZ,Zu as a_,np as aa,oz as ab,iz as ac,Dl as ad,Ku as ae,FA as af,HA as ag,RH as ah,PI as ai,H as aj,Dc as ak,mi as al,wI as am,Nr as an,yi as ao,vz as ap,yt as aq,uz as ar,xl as as,Yt as at,F as au,x7 as av,it as aw,Gr as ax,Ca as ay,En as az,jW as b,IH as b$,$2 as b0,Ob as b1,V2 as b2,Do as b3,pp as b4,Qu as b5,qb as b6,mS as b7,gS as b8,Ha as b9,rS as bA,LA as bB,Oo as bC,W0 as bD,bz as bE,lz as bF,sr as bG,Ol as bH,E2 as bI,Yb as bJ,J2 as bK,gb as bL,wb as bM,Tl as bN,ip as bO,cp as bP,Ul as bQ,J0 as bR,W2 as bS,TH as bT,NH as bU,SH as bV,G_ as bW,_o as bX,Wr as bY,AH as bZ,Db as b_,yS as ba,R2 as bb,xh as bc,j0 as bd,Ja as be,rc as bf,Hb as bg,gi as bh,bS as bi,ks as bj,CS as bk,Is as bl,yI as bm,Bb as bn,e2 as bo,xI as bp,V0 as bq,Lb as br,UH as bs,DH as bt,zb as bu,kH as bv,$H as bw,Bl as bx,Ll as by,up as bz,GW as c,rp as c$,G2 as c0,Q2 as c1,MH as c2,Mb as c3,qH as c4,ZA as c5,c2 as c6,QI as c7,sc as c8,BS as c9,Qj as cA,tz as cB,Xn as cC,nz as cD,ES as cE,Fb as cF,$g as cG,Wg as cH,Nz as cI,Sz as cJ,HH as cK,y2 as cL,Ju as cM,Xu as cN,N2 as cO,CH as cP,I2 as cQ,_H as cR,Iz as cS,P2 as cT,ap as cU,Eb as cV,A2 as cW,Cb as cX,x2 as cY,Cz as cZ,pz as c_,MS as ca,LS as cb,vS as cc,fp as cd,US as ce,Vg as cf,vH as cg,bb as ch,EH as ci,Ib as cj,Nb as ck,RS as cl,Gb as cm,gp as cn,kj as co,k0 as cp,$c as cq,hn as cr,t2 as cs,db as ct,Wb as cu,DS as cv,nu as cw,Yf as cx,LH as cy,pi as cz,WW as d,Va as d$,_z as d0,Az as d1,As as d2,kS as d3,zI as d4,qI as d5,Rl as d6,Ad as d7,wS as d8,FS as d9,Qa as dA,lp as dB,h2 as dC,ni as dD,Rh as dE,KI as dF,Uh as dG,H0 as dH,wi as dI,Mh as dJ,Lh as dK,qA as dL,zA as dM,pA as dN,GA as dO,$S as dP,WA as dQ,fA as dR,KA as dS,hA as dT,lA as dU,qa as dV,wA as dW,ja as dX,YI as dY,Po as dZ,mA as d_,xS as da,mp as db,op as dc,kA as dd,Ig as de,_2 as df,sz as dg,L0 as dh,UA as di,MA as dj,B0 as dk,BA as dl,F0 as dm,WI as dn,nc as dp,w2 as dq,mb as dr,tc as ds,Za as dt,qh as du,tS as dv,nS as dw,yA as dx,Ub as dy,n2 as dz,HW as e,Rz as e$,Co as e0,b2 as e1,za as e2,ti as e3,kh as e4,Dh as e5,$h as e6,Fa as e7,Ya as e8,Tn as e9,ab as eA,mI as eB,SS as eC,bH as eD,wH as eE,WH as eF,Pz as eG,eS as eH,FH as eI,BH as eJ,zH as eK,jH as eL,Hg as eM,sp as eN,dp as eO,Ro as eP,Ez as eQ,yz as eR,pI as eS,xz as eT,qz as eU,Hz as eV,Wz as eW,Vz as eX,Gz as eY,Kz as eZ,Yz as e_,Wa as ea,Ss as eb,pn as ec,q0 as ed,YA as ee,z0 as ef,dA as eg,VI as eh,ZI as ei,ub as ej,lb as ek,Eo as el,Bh as em,Ga as en,ec as eo,s2 as ep,gA as eq,cA as er,Xa as es,Ka as et,JI as eu,eI as ev,ib as ew,ob as ex,_r as ey,Tz as ez,KW as f,Tq as f$,Zz as f0,Jz as f1,Xz as f2,Qz as f3,eq as f4,tq as f5,nq as f6,rq as f7,sq as f8,iq as f9,lH as fA,dH as fB,hH as fC,fH as fD,pH as fE,gH as fF,qq as fG,mH as fH,yH as fI,Hq as fJ,Wq as fK,Vq as fL,Gq as fM,Kq as fN,Yq as fO,jq as fP,Zq as fQ,Jq as fR,Xq as fS,Eq as fT,Cq as fU,_q as fV,Aq as fW,Iq as fX,Sq as fY,Nq as fZ,lq as f_,Dz as fa,oq as fb,aq as fc,cq as fd,$z as fe,kz as ff,Uz as fg,Mz as fh,Lz as fi,Bz as fj,Oz as fk,Fz as fl,jz as fm,zz as fn,Qq as fo,eH as fp,tH as fq,nH as fr,rH as fs,sH as ft,iH as fu,zq as fv,oH as fw,aH as fx,cH as fy,uH as fz,ei as g,xq as g0,Pq as g1,Oq as g2,Rq as g3,Dq as g4,$q as g5,kq as g6,Uq as g7,Mq as g8,dq as g9,yb as gA,HI as gB,fS as gC,tl as gD,zn as gE,Fu as gF,Gu as gG,At as gH,Hf as gI,br as gJ,zS as gK,$j as gL,Lq as ga,Bq as gb,Fq as gc,hq as gd,fq as ge,pq as gf,gq as gg,mq as gh,yq as gi,uq as gj,wq as gk,bq as gl,vq as gm,zh as gn,tI as go,VA as gp,TI as gq,a2 as gr,VH as gs,p2 as gt,rz as gu,C2 as gv,NS as gw,tb as gx,T2 as gy,X0 as gz,Tc as h,mo as i,ws as j,ld as k,kc as l,VW as m,Ae as n,An as o,jI as p,O2 as q,qW as r,wj as s,jb as t,vo as u,nb as v,Kb as w,FW as x,$s as y,Nn as z};
