import{e as D,f as R,r as m,c as U,C as F,M as P}from"./CKxxabAx.js";const b=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),x=new Uint32Array(80);class G extends R{constructor(){super(64,20,8,!1),this.A=b[0]|0,this.B=b[1]|0,this.C=b[2]|0,this.D=b[3]|0,this.E=b[4]|0}get(){const{A:r,B:s,C:t,D:i,E:e}=this;return[r,s,t,i,e]}set(r,s,t,i,e){this.A=r|0,this.B=s|0,this.C=t|0,this.D=i|0,this.E=e|0}process(r,s){for(let h=0;h<16;h++,s+=4)x[h]=r.getUint32(s,!1);for(let h=16;h<80;h++)x[h]=m(x[h-3]^x[h-8]^x[h-14]^x[h-16],1);let{A:t,B:i,C:e,D:o,E:a}=this;for(let h=0;h<80;h++){let f,l;h<20?(f=F(i,e,o),l=1518500249):h<40?(f=i^e^o,l=1859775393):h<60?(f=P(i,e,o),l=2400959708):(f=i^e^o,l=3395469782);const u=m(t,5)+f+a+l+x[h]|0;a=o,o=e,e=m(i,30),i=t,t=u}t=t+this.A|0,i=i+this.B|0,e=e+this.C|0,o=o+this.D|0,a=a+this.E|0,this.set(t,i,e,o,a)}roundClean(){U(x)}destroy(){this.set(0,0,0,0,0),U(this.buffer)}}const O=D(()=>new G),T=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),B=Uint8Array.from(new Array(16).fill(0).map((n,r)=>r)),V=B.map(n=>(9*n+5)%16),E=(()=>{const s=[[B],[V]];for(let t=0;t<4;t++)for(let i of s)i.push(i[t].map(e=>T[e]));return s})(),w=E[0],H=E[1],L=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(n=>Uint8Array.from(n)),W=w.map((n,r)=>n.map(s=>L[r][s])),k=H.map((n,r)=>n.map(s=>L[r][s])),q=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),v=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function y(n,r,s,t){return n===0?r^s^t:n===1?r&s|~r&t:n===2?(r|~s)^t:n===3?r&t|s&~t:r^(s|~t)}const p=new Uint32Array(16);class J extends R{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:r,h1:s,h2:t,h3:i,h4:e}=this;return[r,s,t,i,e]}set(r,s,t,i,e){this.h0=r|0,this.h1=s|0,this.h2=t|0,this.h3=i|0,this.h4=e|0}process(r,s){for(let c=0;c<16;c++,s+=4)p[c]=r.getUint32(s,!0);let t=this.h0|0,i=t,e=this.h1|0,o=e,a=this.h2|0,h=a,f=this.h3|0,l=f,u=this.h4|0,A=u;for(let c=0;c<5;c++){const _=4-c,M=q[c],I=v[c],K=w[c],S=H[c],g=W[c],j=k[c];for(let d=0;d<16;d++){const C=m(t+y(c,e,a,f)+p[K[d]]+M,g[d])+u|0;t=u,u=f,f=m(a,10)|0,a=e,e=C}for(let d=0;d<16;d++){const C=m(i+y(_,o,h,l)+p[S[d]]+I,j[d])+A|0;i=A,A=l,l=m(h,10)|0,h=o,o=C}}this.set(this.h1+a+l|0,this.h2+f+A|0,this.h3+u+i|0,this.h4+t+o|0,this.h0+e+h|0)}roundClean(){U(p)}destroy(){this.destroyed=!0,U(this.buffer),this.set(0,0,0,0,0)}}const Q=D(()=>new J);export{Q as r,O as s};
