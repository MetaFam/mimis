import"./CWj6FrbW.js";import{p as J,aj as q,g as K,k as u,al as D,ak as E,f as _,b as m,c as L,s as A,d as h,r as z,a as M,t as O}from"./obqp2paV.js";import{d as Q,e as F}from"./BSrLC8Pd.js";import{i as I}from"./bj9lDj3h.js";import{e as T,i as V}from"./0qJetFIX.js";import{r as X,s as N}from"./BMo-HCLs.js";import{s as Y}from"./BJoZluEW.js";import{c as Z}from"./D8bKBw2r.js";import{b as x}from"./6Q-wSCzq.js";import{p as ee}from"./mQReW7E_.js";import{s as te}from"./D1e6ghzX.js";function se(d,v,e,o){v&&console.debug({"Replacing From":[...e]}),e.length>0&&o(e.pop()??[""])}var le=_('<li class="svelte-1fu48zf"><button id="clear" class="svelte-1fu48zf"><span>∅</span></button></li>'),oe=function(d,v,e){var o;if(d.key==="Enter"){d.preventDefault();const a=new Event("submit",{bubbles:!0,cancelable:!0});a.submitter=this,(o=u(v))==null||o.dispatchEvent(a),e&&console.debug({Fired:a})}},ne=_('<button type="button" class="minus svelte-1fu48zf"><span class="svelte-1fu48zf">⨯</span></button>'),re=_('<li class="svelte-1fu48zf"><button type="button" class="slash svelte-1fu48zf"><span>/</span></button></li>'),ae=_('<li><input class="svelte-1fu48zf"/> <!></li> <!>',1),ie=_('<li class="svelte-1fu48zf"><button type="button" class="svelte-1fu48zf"><span>↺</span></button></li>'),ue=_('<form><ol class="svelte-1fu48zf"><!> <li class="svelte-1fu48zf"><button id="before" class="svelte-1fu48zf"><span>+</span></button></li> <!> <li class="svelte-1fu48zf"><button id="more" class="svelte-1fu48zf"><span>+</span></button></li> <!></ol></form>');function ke(d,v){J(v,!0);let e=ee(v,"elements",31,()=>q([""])),o=q([]),a=D(null),{debugging:f}=te,k=D(null),w=D(null);function y(t,{clear:s=!1}={}){const l=s?[]:e().slice(0,t),c=s?[]:e().slice(t),r=[...l,"",...c];o.push([...e()]),f&&console.debug({Replacing:o.at(-1),With:[...r]}),e(r),E(a,t,!0)}K(()=>{var t,s;u(a)!=null&&((s=(t=u(k))==null?void 0:t.querySelectorAll("input")[u(a)])==null||s.focus(),E(a,null))});var g=ue(),P=h(g),R=h(P);{var U=t=>{var s=le();m(t,s)};I(R,t=>{(e().length>1||e()[0]!=="")&&t(U)})}var S=A(R,4);T(S,17,e,V,(t,s,l)=>{var c=ae(),r=M(c);let i;var p=h(r);X(p),N(p,"id",`text-${l}`),p.__keydown=[oe,k,f];var B=A(p,2);{var C=n=>{var b=ne();b.__click=()=>{o.push([...e()]),e().splice(l,1)},N(b,"tabindex",-1),m(n,b)};I(B,n=>{e().length>1&&n(C)})}z(r);var G=A(r,2);{var H=n=>{var b=re(),j=h(b);j.__click=()=>y(l+1),N(j,"tabindex",-1),z(b),m(n,b)};I(G,n=>{l<e().length-1&&n(H)})}O(n=>i=Y(r,1,"svelte-1fu48zf",null,i,n),[()=>({single:e().length<=1})]),F("focus",p,()=>{E(w,e()[l],!0)}),F("blur",p,()=>{u(w)&&u(w)!==e()[l]&&(f&&console.debug({from:u(w),to:e()[l]}),o.push([...e()]))}),Z(p,()=>e()[l],n=>e(e()[l]=n,!0)),m(t,c)});var W=A(S,4);{var $=t=>{var s=ie(),l=h(s);l.__click=[se,f,o,e],z(s),m(t,s)};I(W,t=>{o.length>0&&t($)})}z(P),z(g),x(g,t=>E(k,t),()=>u(k)),F("submit",g,t=>{var r;t.preventDefault();const s=(r=t.submitter)==null?void 0:r.id;if(!s)throw new Error("No submitter.");f&&console.debug({submitter:s});const[l,c]=Array.from(s.match(/^text-(\d+)$/)??[]);if(c){const i=Number(c)+1;f&&console.debug({"Inserting At":i}),y(i)}else if(["before","more"].includes(s)){const i=s==="before"?0:e().length;f&&console.debug({idx:i}),y(i)}else if(s==="clear")y(0,{clear:!0});else throw new Error(`Unrecognized Submitter Id: "${s}"`)}),m(d,g),L()}Q(["keydown","click"]);export{ke as P};
