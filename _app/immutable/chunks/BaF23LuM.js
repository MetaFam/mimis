var En=Object.defineProperty;var vn=(e,n,t)=>n in e?En(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var p=(e,n,t)=>vn(e,typeof n!="symbol"?n+"":n,t);const An=new Uint8Array(0);function mo(e){const n=e.match(/../g);return n!=null?new Uint8Array(n.map(t=>parseInt(t,16))):An}function Tn(e,n){if(e===n)return!0;if(e.byteLength!==n.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==n[t])return!1;return!0}function ee(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function xo(e){return new TextEncoder().encode(e)}function bo(e){return new TextDecoder().decode(e)}function kn(e,n){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),a=i.charCodeAt(0);if(t[a]!==255)throw new TypeError(i+" is ambiguous");t[a]=o}var u=e.length,h=e.charAt(0),g=Math.log(u)/Math.log(256),m=Math.log(256)/Math.log(u);function xe(w){if(w instanceof Uint8Array||(ArrayBuffer.isView(w)?w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength):Array.isArray(w)&&(w=Uint8Array.from(w))),!(w instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(w.length===0)return"";for(var b=0,M=0,T=0,N=w.length;T!==N&&w[T]===0;)T++,b++;for(var _=(N-T)*m+1>>>0,E=new Uint8Array(_);T!==N;){for(var S=w[T],C=0,k=_-1;(S!==0||C<M)&&k!==-1;k--,C++)S+=256*E[k]>>>0,E[k]=S%u>>>0,S=S/u>>>0;if(S!==0)throw new Error("Non-zero carry");M=C,T++}for(var $=_-M;$!==_&&E[$]===0;)$++;for(var oe=h.repeat(b);$<_;++$)oe+=e.charAt(E[$]);return oe}function re(w){if(typeof w!="string")throw new TypeError("Expected String");if(w.length===0)return new Uint8Array;var b=0;if(w[b]!==" "){for(var M=0,T=0;w[b]===h;)M++,b++;for(var N=(w.length-b)*g+1>>>0,_=new Uint8Array(N);w[b];){var E=t[w.charCodeAt(b)];if(E===255)return;for(var S=0,C=N-1;(E!==0||S<T)&&C!==-1;C--,S++)E+=u*_[C]>>>0,_[C]=E%256>>>0,E=E/256>>>0;if(E!==0)throw new Error("Non-zero carry");T=S,b++}if(w[b]!==" "){for(var k=N-T;k!==N&&_[k]===0;)k++;for(var $=new Uint8Array(M+(N-k)),oe=M;k!==N;)$[oe++]=_[k++];return $}}}function bn(w){var b=re(w);if(b)return b;throw new Error(`Non-${n} character`)}return{encode:xe,decodeUnsafe:re,decode:bn}}var Bn=kn,Nn=Bn;class _n{constructor(n,t,r){p(this,"name");p(this,"prefix");p(this,"baseEncode");this.name=n,this.prefix=t,this.baseEncode=r}encode(n){if(n instanceof Uint8Array)return`${this.prefix}${this.baseEncode(n)}`;throw Error("Unknown type, must be binary type")}}class Sn{constructor(n,t,r){p(this,"name");p(this,"prefix");p(this,"baseDecode");p(this,"prefixCodePoint");this.name=n,this.prefix=t;const o=t.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=r}decode(n){if(typeof n=="string"){if(n.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(n)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(n.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(n){return We(this,n)}}class In{constructor(n){p(this,"decoders");this.decoders=n}or(n){return We(this,n)}decode(n){const t=n[0],r=this.decoders[t];if(r!=null)return r.decode(n);throw RangeError(`Unable to decode multibase string ${JSON.stringify(n)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function We(e,n){return new In({...e.decoders??{[e.prefix]:e},...n.decoders??{[n.prefix]:n}})}class $n{constructor(n,t,r,o){p(this,"name");p(this,"prefix");p(this,"baseEncode");p(this,"baseDecode");p(this,"encoder");p(this,"decoder");this.name=n,this.prefix=t,this.baseEncode=r,this.baseDecode=o,this.encoder=new _n(n,t,r),this.decoder=new Sn(n,t,o)}encode(n){return this.encoder.encode(n)}decode(n){return this.decoder.decode(n)}}function Xe({name:e,prefix:n,encode:t,decode:r}){return new $n(e,n,t,r)}function we({name:e,prefix:n,alphabet:t}){const{encode:r,decode:o}=Nn(t,e);return Xe({prefix:n,name:e,encode:r,decode:i=>ee(o(i))})}function zn(e,n,t,r){let o=e.length;for(;e[o-1]==="=";)--o;const i=new Uint8Array(o*t/8|0);let a=0,u=0,h=0;for(let g=0;g<o;++g){const m=n[e[g]];if(m===void 0)throw new SyntaxError(`Non-${r} character`);u=u<<t|m,a+=t,a>=8&&(a-=8,i[h++]=255&u>>a)}if(a>=t||255&u<<8-a)throw new SyntaxError("Unexpected end of data");return i}function Dn(e,n,t){const r=n[n.length-1]==="=",o=(1<<t)-1;let i="",a=0,u=0;for(let h=0;h<e.length;++h)for(u=u<<8|e[h],a+=8;a>t;)a-=t,i+=n[o&u>>a];if(a!==0&&(i+=n[o&u<<t-a]),r)for(;i.length*t&7;)i+="=";return i}function Un(e){const n={};for(let t=0;t<e.length;++t)n[e[t]]=t;return n}function U({name:e,prefix:n,bitsPerChar:t,alphabet:r}){const o=Un(r);return Xe({prefix:n,name:e,encode(i){return Dn(i,r,t)},decode(i){return zn(i,o,t,e)}})}const W=U({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Cn=U({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ln=U({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),On=U({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Mn=U({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Pn=U({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jn=U({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Fn=U({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Hn=U({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Eo=Object.freeze(Object.defineProperty({__proto__:null,base32:W,base32hex:Mn,base32hexpad:jn,base32hexpadupper:Fn,base32hexupper:Pn,base32pad:Ln,base32padupper:On,base32upper:Cn,base32z:Hn},Symbol.toStringTag,{value:"Module"})),ie=we({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Rn=we({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),vo=Object.freeze(Object.defineProperty({__proto__:null,base36:ie,base36upper:Rn},Symbol.toStringTag,{value:"Module"})),D=we({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Gn=we({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Ao=Object.freeze(Object.defineProperty({__proto__:null,base58btc:D,base58flickr:Gn},Symbol.toStringTag,{value:"Module"})),Vn="raw",qn=85;function Kn(e){return ee(e)}function Jn(e){return ee(e)}const To=Object.freeze(Object.defineProperty({__proto__:null,code:qn,decode:Jn,encode:Kn,name:Vn},Symbol.toStringTag,{value:"Module"}));var Qn=Ze,Pe=128,Wn=-128,Xn=Math.pow(2,31);function Ze(e,n,t){n=n||[],t=t||0;for(var r=t;e>=Xn;)n[t++]=e&255|Pe,e/=128;for(;e&Wn;)n[t++]=e&255|Pe,e>>>=7;return n[t]=e|0,Ze.bytes=t-r+1,n}var Zn=Ee,Yn=128,je=127;function Ee(e,r){var t=0,r=r||0,o=0,i=r,a,u=e.length;do{if(i>=u)throw Ee.bytes=0,new RangeError("Could not decode varint");a=e[i++],t+=o<28?(a&je)<<o:(a&je)*Math.pow(2,o),o+=7}while(a>=Yn);return Ee.bytes=i-r,t}var et=Math.pow(2,7),nt=Math.pow(2,14),tt=Math.pow(2,21),rt=Math.pow(2,28),ot=Math.pow(2,35),it=Math.pow(2,42),st=Math.pow(2,49),at=Math.pow(2,56),ct=Math.pow(2,63),ft=function(e){return e<et?1:e<nt?2:e<tt?3:e<rt?4:e<ot?5:e<it?6:e<st?7:e<at?8:e<ct?9:10},ut={encode:Qn,decode:Zn,encodingLength:ft},ae=ut;function ve(e,n=0){return[ae.decode(e,n),ae.decode.bytes]}function ce(e,n,t=0){return ae.encode(e,n,t),n}function fe(e){return ae.encodingLength(e)}function Ae(e,n){const t=n.byteLength,r=fe(e),o=r+fe(t),i=new Uint8Array(o+t);return ce(e,i,0),ce(t,i,r),i.set(n,o),new Ne(e,t,n,i)}function dt(e){const n=ee(e),[t,r]=ve(n),[o,i]=ve(n.subarray(r)),a=n.subarray(r+i);if(a.byteLength!==o)throw new Error("Incorrect length");return new Ne(t,o,a,n)}function lt(e,n){if(e===n)return!0;{const t=n;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&Tn(e.bytes,t.bytes)}}class Ne{constructor(n,t,r,o){p(this,"code");p(this,"size");p(this,"digest");p(this,"bytes");this.code=n,this.size=t,this.digest=r,this.bytes=o}}function Ye({name:e,code:n,encode:t}){return new ht(e,n,t)}class ht{constructor(n,t,r){p(this,"name");p(this,"code");p(this,"encode");this.name=n,this.code=t,this.encode=r}digest(n){if(n instanceof Uint8Array){const t=this.encode(n);return t instanceof Uint8Array?Ae(this.code,t):t.then(r=>Ae(this.code,r))}else throw Error("Unknown type, must be binary type")}}function en(e){return async n=>new Uint8Array(await crypto.subtle.digest(e,n))}const pt=Ye({name:"sha2-256",code:18,encode:en("SHA-256")}),wt=Ye({name:"sha2-512",code:19,encode:en("SHA-512")}),ko=Object.freeze(Object.defineProperty({__proto__:null,sha256:pt,sha512:wt},Symbol.toStringTag,{value:"Module"}));function Fe(e,n){const{bytes:t,version:r}=e;switch(r){case 0:return gt(t,Te(e),n??D.encoder);default:return mt(t,Te(e),n??W.encoder)}}const He=new WeakMap;function Te(e){const n=He.get(e);if(n==null){const t=new Map;return He.set(e,t),t}return n}var Qe;class y{constructor(n,t,r,o){p(this,"code");p(this,"version");p(this,"multihash");p(this,"bytes");p(this,"/");p(this,Qe,"CID");this.code=t,this.version=n,this.multihash=r,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:n,multihash:t}=this;if(n!==Q)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==xt)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return y.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:n,digest:t}=this.multihash,r=Ae(n,t);return y.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(n){return y.equals(this,n)}static equals(n,t){const r=t;return r!=null&&n.code===r.code&&n.version===r.version&&lt(n.multihash,r.multihash)}toString(n){return Fe(this,n)}toJSON(){return{"/":Fe(this)}}link(){return this}[(Qe=Symbol.toStringTag,Symbol.for("nodejs.util.inspect.custom"))](){return`CID(${this.toString()})`}static asCID(n){if(n==null)return null;const t=n;if(t instanceof y)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:o,multihash:i,bytes:a}=t;return new y(r,o,i,a??Re(r,o,i.bytes))}else if(t[bt]===!0){const{version:r,multihash:o,code:i}=t,a=dt(o);return y.create(r,i,a)}else return null}static create(n,t,r){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(n){case 0:{if(t!==Q)throw new Error(`Version 0 CID must use dag-pb (code: ${Q}) block encoding`);return new y(n,t,r,r.bytes)}case 1:{const o=Re(n,t,r.bytes);return new y(n,t,r,o)}default:throw new Error("Invalid version")}}static createV0(n){return y.create(0,Q,n)}static createV1(n,t){return y.create(1,n,t)}static decode(n){const[t,r]=y.decodeFirst(n);if(r.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(n){const t=y.inspectBytes(n),r=t.size-t.multihashSize,o=ee(n.subarray(r,r+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=o.subarray(t.multihashSize-t.digestSize),a=new Ne(t.multihashCode,t.digestSize,i,o);return[t.version===0?y.createV0(a):y.createV1(t.codec,a),n.subarray(t.size)]}static inspectBytes(n){let t=0;const r=()=>{const[xe,re]=ve(n.subarray(t));return t+=re,xe};let o=r(),i=Q;if(o===18?(o=0,t=0):i=r(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const a=t,u=r(),h=r(),g=t+h,m=g-a;return{version:o,codec:i,multihashCode:u,digestSize:h,multihashSize:m,size:g}}static parse(n,t){const[r,o]=yt(n,t),i=y.decode(o);if(i.version===0&&n[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Te(i).set(r,n),i}}function yt(e,n){switch(e[0]){case"Q":{const t=n??D;return[D.prefix,t.decode(`${D.prefix}${e}`)]}case D.prefix:{const t=n??D;return[D.prefix,t.decode(e)]}case W.prefix:{const t=n??W;return[W.prefix,t.decode(e)]}case ie.prefix:{const t=n??ie;return[ie.prefix,t.decode(e)]}default:{if(n==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],n.decode(e)]}}}function gt(e,n,t){const{prefix:r}=t;if(r!==D.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=n.get(r);if(o==null){const i=t.encode(e).slice(1);return n.set(r,i),i}else return o}function mt(e,n,t){const{prefix:r}=t,o=n.get(r);if(o==null){const i=t.encode(e);return n.set(r,i),i}else return o}const Q=112,xt=18;function Re(e,n,t){const r=fe(e),o=r+fe(n),i=new Uint8Array(o+t.byteLength);return ce(e,i,0),ce(n,i,r),i.set(t,o),i}const bt=Symbol.for("@ipld/js-cid/CID"),Et=["string","number","bigint","symbol"],vt=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function At(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const n=typeof e;if(Et.includes(n))return n;if(n==="function")return"Function";if(Array.isArray(e))return"Array";if(Tt(e))return"Buffer";const t=kt(e);return t||"Object"}function Tt(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function kt(e){const n=Object.prototype.toString.call(e).slice(8,-1);if(vt.includes(n))return n}class s{constructor(n,t,r){this.major=n,this.majorEncoded=n<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(n){return this.major<n.major?-1:this.major>n.major?1:0}}s.uint=new s(0,"uint",!0);s.negint=new s(1,"negint",!0);s.bytes=new s(2,"bytes",!0);s.string=new s(3,"string",!0);s.array=new s(4,"array",!1);s.map=new s(5,"map",!1);s.tag=new s(6,"tag",!1);s.float=new s(7,"float",!0);s.false=new s(7,"false",!0);s.true=new s(7,"true",!0);s.null=new s(7,"null",!0);s.undefined=new s(7,"undefined",!0);s.break=new s(7,"break",!0);class f{constructor(n,t,r){this.type=n,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const V=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Bt=new TextDecoder,Nt=new TextEncoder;function ue(e){return V&&globalThis.Buffer.isBuffer(e)}function nn(e){return e instanceof Uint8Array?ue(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const _t=V?(e,n,t)=>t-n>64?globalThis.Buffer.from(e.subarray(n,t)).toString("utf8"):Ve(e,n,t):(e,n,t)=>t-n>64?Bt.decode(e.subarray(n,t)):Ve(e,n,t),St=V?e=>e.length>64?globalThis.Buffer.from(e):Ge(e):e=>e.length>64?Nt.encode(e):Ge(e),z=e=>Uint8Array.from(e),_e=V?(e,n,t)=>ue(e)?new Uint8Array(e.subarray(n,t)):e.slice(n,t):(e,n,t)=>e.slice(n,t),It=V?(e,n)=>(e=e.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),nn(globalThis.Buffer.concat(e,n))):(e,n)=>{const t=new Uint8Array(n);let r=0;for(let o of e)r+o.length>t.length&&(o=o.subarray(0,t.length-r)),t.set(o,r),r+=o.length;return t},$t=V?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function zt(e,n){if(ue(e)&&ue(n))return e.compare(n);for(let t=0;t<e.length;t++)if(e[t]!==n[t])return e[t]<n[t]?-1:1;return 0}function Ge(e){const n=[];let t=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);o<128?n[t++]=o:o<2048?(n[t++]=o>>6|192,n[t++]=o&63|128):(o&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++r)&1023),n[t++]=o>>18|240,n[t++]=o>>12&63|128,n[t++]=o>>6&63|128,n[t++]=o&63|128):(n[t++]=o>>12|224,n[t++]=o>>6&63|128,n[t++]=o&63|128)}return n}function Ve(e,n,t){const r=[];for(;n<t;){const o=e[n];let i=null,a=o>239?4:o>223?3:o>191?2:1;if(n+a<=t){let u,h,g,m;switch(a){case 1:o<128&&(i=o);break;case 2:u=e[n+1],(u&192)===128&&(m=(o&31)<<6|u&63,m>127&&(i=m));break;case 3:u=e[n+1],h=e[n+2],(u&192)===128&&(h&192)===128&&(m=(o&15)<<12|(u&63)<<6|h&63,m>2047&&(m<55296||m>57343)&&(i=m));break;case 4:u=e[n+1],h=e[n+2],g=e[n+3],(u&192)===128&&(h&192)===128&&(g&192)===128&&(m=(o&15)<<18|(u&63)<<12|(h&63)<<6|g&63,m>65535&&m<1114112&&(i=m))}}i===null?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|i&1023),r.push(i),n+=a}return Dt(r)}const qe=4096;function Dt(e){const n=e.length;if(n<=qe)return String.fromCharCode.apply(String,e);let t="",r=0;for(;r<n;)t+=String.fromCharCode.apply(String,e.slice(r,r+=qe));return t}const Ut=256;class tn{constructor(n=Ut){this.chunkSize=n,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(n){let t=this.chunks[this.chunks.length-1];if(this.cursor+n.length<=this.maxCursor+1){const o=t.length-(this.maxCursor-this.cursor)-1;t.set(n,o)}else{if(t){const o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}n.length<64&&n.length<this.chunkSize?(t=$t(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(n,0)):(this.chunks.push(n),this.maxCursor+=n.length)}this.cursor+=n.length}toBytes(n=!1){let t;if(this.chunks.length===1){const r=this.chunks[0];n&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=_e(r,0,this.cursor)}else t=It(this.chunks,this.cursor);return n&&this.reset(),t}}const d="CBOR decode error:",rn="CBOR encode error:";function q(e,n,t){if(e.length-n<t)throw new Error(`${d} not enough data for type`)}const x=[24,256,65536,4294967296,BigInt("18446744073709551616")];function P(e,n,t){q(e,n,1);const r=e[n];if(t.strict===!0&&r<x[0])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return r}function j(e,n,t){q(e,n,2);const r=e[n]<<8|e[n+1];if(t.strict===!0&&r<x[1])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return r}function F(e,n,t){q(e,n,4);const r=e[n]*16777216+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];if(t.strict===!0&&r<x[2])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return r}function H(e,n,t){q(e,n,8);const r=e[n]*16777216+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3],o=e[n+4]*16777216+(e[n+5]<<16)+(e[n+6]<<8)+e[n+7],i=(BigInt(r)<<BigInt(32))+BigInt(o);if(t.strict===!0&&i<x[3])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(t.allowBigInt===!0)return i;throw new Error(`${d} integers outside of the safe integer range are not supported`)}function Ct(e,n,t,r){return new f(s.uint,P(e,n+1,r),2)}function Lt(e,n,t,r){return new f(s.uint,j(e,n+1,r),3)}function Ot(e,n,t,r){return new f(s.uint,F(e,n+1,r),5)}function Mt(e,n,t,r){return new f(s.uint,H(e,n+1,r),9)}function R(e,n){return A(e,0,n.value)}function A(e,n,t){if(t<x[0]){const r=Number(t);e.push([n|r])}else if(t<x[1]){const r=Number(t);e.push([n|24,r])}else if(t<x[2]){const r=Number(t);e.push([n|25,r>>>8,r&255])}else if(t<x[3]){const r=Number(t);e.push([n|26,r>>>24&255,r>>>16&255,r>>>8&255,r&255])}else{const r=BigInt(t);if(r<x[4]){const o=[n|27,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),a=Number(r>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${d} encountered BigInt larger than allowable range`)}}R.encodedSize=function(n){return A.encodedSize(n.value)};A.encodedSize=function(n){return n<x[0]?1:n<x[1]?2:n<x[2]?3:n<x[3]?5:9};R.compareTokens=function(n,t){return n.value<t.value?-1:n.value>t.value?1:0};function Pt(e,n,t,r){return new f(s.negint,-1-P(e,n+1,r),2)}function jt(e,n,t,r){return new f(s.negint,-1-j(e,n+1,r),3)}function Ft(e,n,t,r){return new f(s.negint,-1-F(e,n+1,r),5)}const Se=BigInt(-1),on=BigInt(1);function Ht(e,n,t,r){const o=H(e,n+1,r);if(typeof o!="bigint"){const i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new f(s.negint,i,9)}if(r.allowBigInt!==!0)throw new Error(`${d} integers outside of the safe integer range are not supported`);return new f(s.negint,Se-BigInt(o),9)}function Ie(e,n){const t=n.value,r=typeof t=="bigint"?t*Se-on:t*-1-1;A(e,n.type.majorEncoded,r)}Ie.encodedSize=function(n){const t=n.value,r=typeof t=="bigint"?t*Se-on:t*-1-1;return r<x[0]?1:r<x[1]?2:r<x[2]?3:r<x[3]?5:9};Ie.compareTokens=function(n,t){return n.value<t.value?1:n.value>t.value?-1:0};function ne(e,n,t,r){q(e,n,t+r);const o=_e(e,n+t,n+t+r);return new f(s.bytes,o,t+r)}function Rt(e,n,t,r){return ne(e,n,1,t)}function Gt(e,n,t,r){return ne(e,n,2,P(e,n+1,r))}function Vt(e,n,t,r){return ne(e,n,3,j(e,n+1,r))}function qt(e,n,t,r){return ne(e,n,5,F(e,n+1,r))}function Kt(e,n,t,r){const o=H(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer bytes lengths not supported`);return ne(e,n,9,o)}function de(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===s.string?St(e.value):e.value),e.encodedBytes}function ye(e,n){const t=de(n);A(e,n.type.majorEncoded,t.length),e.push(t)}ye.encodedSize=function(n){const t=de(n);return A.encodedSize(t.length)+t.length};ye.compareTokens=function(n,t){return Jt(de(n),de(t))};function Jt(e,n){return e.length<n.length?-1:e.length>n.length?1:zt(e,n)}function te(e,n,t,r,o){const i=t+r;q(e,n,i);const a=new f(s.string,_t(e,n+t,n+i),i);return o.retainStringBytes===!0&&(a.byteValue=_e(e,n+t,n+i)),a}function Qt(e,n,t,r){return te(e,n,1,t,r)}function Wt(e,n,t,r){return te(e,n,2,P(e,n+1,r),r)}function Xt(e,n,t,r){return te(e,n,3,j(e,n+1,r),r)}function Zt(e,n,t,r){return te(e,n,5,F(e,n+1,r),r)}function Yt(e,n,t,r){const o=H(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer string lengths not supported`);return te(e,n,9,o,r)}const er=ye;function K(e,n,t,r){return new f(s.array,r,t)}function nr(e,n,t,r){return K(e,n,1,t)}function tr(e,n,t,r){return K(e,n,2,P(e,n+1,r))}function rr(e,n,t,r){return K(e,n,3,j(e,n+1,r))}function or(e,n,t,r){return K(e,n,5,F(e,n+1,r))}function ir(e,n,t,r){const o=H(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer array lengths not supported`);return K(e,n,9,o)}function sr(e,n,t,r){if(r.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return K(e,n,1,1/0)}function $e(e,n){A(e,s.array.majorEncoded,n.value)}$e.compareTokens=R.compareTokens;$e.encodedSize=function(n){return A.encodedSize(n.value)};function J(e,n,t,r){return new f(s.map,r,t)}function ar(e,n,t,r){return J(e,n,1,t)}function cr(e,n,t,r){return J(e,n,2,P(e,n+1,r))}function fr(e,n,t,r){return J(e,n,3,j(e,n+1,r))}function ur(e,n,t,r){return J(e,n,5,F(e,n+1,r))}function dr(e,n,t,r){const o=H(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer map lengths not supported`);return J(e,n,9,o)}function lr(e,n,t,r){if(r.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return J(e,n,1,1/0)}function ze(e,n){A(e,s.map.majorEncoded,n.value)}ze.compareTokens=R.compareTokens;ze.encodedSize=function(n){return A.encodedSize(n.value)};function hr(e,n,t,r){return new f(s.tag,t,1)}function pr(e,n,t,r){return new f(s.tag,P(e,n+1,r),2)}function wr(e,n,t,r){return new f(s.tag,j(e,n+1,r),3)}function yr(e,n,t,r){return new f(s.tag,F(e,n+1,r),5)}function gr(e,n,t,r){return new f(s.tag,H(e,n+1,r),9)}function De(e,n){A(e,s.tag.majorEncoded,n.value)}De.compareTokens=R.compareTokens;De.encodedSize=function(n){return A.encodedSize(n.value)};const mr=20,xr=21,br=22,Er=23;function vr(e,n,t,r){if(r.allowUndefined===!1)throw new Error(`${d} undefined values are not supported`);return r.coerceUndefinedToNull===!0?new f(s.null,null,1):new f(s.undefined,void 0,1)}function Ar(e,n,t,r){if(r.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return new f(s.break,void 0,1)}function Ue(e,n,t){if(t){if(t.allowNaN===!1&&Number.isNaN(e))throw new Error(`${d} NaN values are not supported`);if(t.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${d} Infinity values are not supported`)}return new f(s.float,e,n)}function Tr(e,n,t,r){return Ue(Le(e,n+1),3,r)}function kr(e,n,t,r){return Ue(Oe(e,n+1),5,r)}function Br(e,n,t,r){return Ue(fn(e,n+1),9,r)}function Ce(e,n,t){const r=n.value;if(r===!1)e.push([s.float.majorEncoded|mr]);else if(r===!0)e.push([s.float.majorEncoded|xr]);else if(r===null)e.push([s.float.majorEncoded|br]);else if(r===void 0)e.push([s.float.majorEncoded|Er]);else{let o,i=!1;(!t||t.float64!==!0)&&(an(r),o=Le(B,1),r===o||Number.isNaN(r)?(B[0]=249,e.push(B.slice(0,3)),i=!0):(cn(r),o=Oe(B,1),r===o&&(B[0]=250,e.push(B.slice(0,5)),i=!0))),i||(Nr(r),o=fn(B,1),B[0]=251,e.push(B.slice(0,9)))}}Ce.encodedSize=function(n,t){const r=n.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){an(r);let o=Le(B,1);if(r===o||Number.isNaN(r))return 3;if(cn(r),o=Oe(B,1),r===o)return 5}return 9};const sn=new ArrayBuffer(9),v=new DataView(sn,1),B=new Uint8Array(sn,0);function an(e){if(e===1/0)v.setUint16(0,31744,!1);else if(e===-1/0)v.setUint16(0,64512,!1);else if(Number.isNaN(e))v.setUint16(0,32256,!1);else{v.setFloat32(0,e);const n=v.getUint32(0),t=(n&2139095040)>>23,r=n&8388607;if(t===255)v.setUint16(0,31744,!1);else if(t===0)v.setUint16(0,(e&2147483648)>>16|r>>13,!1);else{const o=t-127;o<-24?v.setUint16(0,0):o<-14?v.setUint16(0,(n&2147483648)>>16|1<<24+o,!1):v.setUint16(0,(n&2147483648)>>16|o+15<<10|r>>13,!1)}}}function Le(e,n){if(e.length-n<2)throw new Error(`${d} not enough data for float16`);const t=(e[n]<<8)+e[n+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;const r=t>>10&31,o=t&1023;let i;return r===0?i=o*2**-24:r!==31?i=(o+1024)*2**(r-25):i=o===0?1/0:NaN,t&32768?-i:i}function cn(e){v.setFloat32(0,e,!1)}function Oe(e,n){if(e.length-n<4)throw new Error(`${d} not enough data for float32`);const t=(e.byteOffset||0)+n;return new DataView(e.buffer,t,4).getFloat32(0,!1)}function Nr(e){v.setFloat64(0,e,!1)}function fn(e,n){if(e.length-n<8)throw new Error(`${d} not enough data for float64`);const t=(e.byteOffset||0)+n;return new DataView(e.buffer,t,8).getFloat64(0,!1)}Ce.compareTokens=R.compareTokens;function l(e,n,t){throw new Error(`${d} encountered invalid minor (${t}) for major ${e[n]>>>5}`)}function ge(e){return()=>{throw new Error(`${d} ${e}`)}}const c=[];for(let e=0;e<=23;e++)c[e]=l;c[24]=Ct;c[25]=Lt;c[26]=Ot;c[27]=Mt;c[28]=l;c[29]=l;c[30]=l;c[31]=l;for(let e=32;e<=55;e++)c[e]=l;c[56]=Pt;c[57]=jt;c[58]=Ft;c[59]=Ht;c[60]=l;c[61]=l;c[62]=l;c[63]=l;for(let e=64;e<=87;e++)c[e]=Rt;c[88]=Gt;c[89]=Vt;c[90]=qt;c[91]=Kt;c[92]=l;c[93]=l;c[94]=l;c[95]=ge("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)c[e]=Qt;c[120]=Wt;c[121]=Xt;c[122]=Zt;c[123]=Yt;c[124]=l;c[125]=l;c[126]=l;c[127]=ge("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)c[e]=nr;c[152]=tr;c[153]=rr;c[154]=or;c[155]=ir;c[156]=l;c[157]=l;c[158]=l;c[159]=sr;for(let e=160;e<=183;e++)c[e]=ar;c[184]=cr;c[185]=fr;c[186]=ur;c[187]=dr;c[188]=l;c[189]=l;c[190]=l;c[191]=lr;for(let e=192;e<=215;e++)c[e]=hr;c[216]=pr;c[217]=wr;c[218]=yr;c[219]=gr;c[220]=l;c[221]=l;c[222]=l;c[223]=l;for(let e=224;e<=243;e++)c[e]=ge("simple values are not supported");c[244]=l;c[245]=l;c[246]=l;c[247]=vr;c[248]=ge("simple values are not supported");c[249]=Tr;c[250]=kr;c[251]=Br;c[252]=l;c[253]=l;c[254]=l;c[255]=Ar;const I=[];for(let e=0;e<24;e++)I[e]=new f(s.uint,e,1);for(let e=-1;e>=-24;e--)I[31-e]=new f(s.negint,e,1);I[64]=new f(s.bytes,new Uint8Array(0),1);I[96]=new f(s.string,"",1);I[128]=new f(s.array,0,1);I[160]=new f(s.map,0,1);I[244]=new f(s.false,!1,1);I[245]=new f(s.true,!0,1);I[246]=new f(s.null,null,1);function _r(e){switch(e.type){case s.false:return z([244]);case s.true:return z([245]);case s.null:return z([246]);case s.bytes:return e.value.length?void 0:z([64]);case s.string:return e.value===""?z([96]):void 0;case s.array:return e.value===0?z([128]):void 0;case s.map:return e.value===0?z([160]):void 0;case s.uint:return e.value<24?z([Number(e.value)]):void 0;case s.negint:if(e.value>=-24)return z([31-Number(e.value)])}}const Sr={float64:!1,mapSorter:zr,quickEncodeToken:_r};function Ir(){const e=[];return e[s.uint.major]=R,e[s.negint.major]=Ie,e[s.bytes.major]=ye,e[s.string.major]=er,e[s.array.major]=$e,e[s.map.major]=ze,e[s.tag.major]=De,e[s.float.major]=Ce,e}const un=Ir(),be=new tn;class le{constructor(n,t){this.obj=n,this.parent=t}includes(n){let t=this;do if(t.obj===n)return!0;while(t=t.parent);return!1}static createCheck(n,t){if(n&&n.includes(t))throw new Error(`${rn} object contains circular references`);return new le(t,n)}}const L={null:new f(s.null,null),undefined:new f(s.undefined,void 0),true:new f(s.true,!0),false:new f(s.false,!1),emptyArray:new f(s.array,0),emptyMap:new f(s.map,0)},O={number(e,n,t,r){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new f(s.float,e):e>=0?new f(s.uint,e):new f(s.negint,e)},bigint(e,n,t,r){return e>=BigInt(0)?new f(s.uint,e):new f(s.negint,e)},Uint8Array(e,n,t,r){return new f(s.bytes,e)},string(e,n,t,r){return new f(s.string,e)},boolean(e,n,t,r){return e?L.true:L.false},null(e,n,t,r){return L.null},undefined(e,n,t,r){return L.undefined},ArrayBuffer(e,n,t,r){return new f(s.bytes,new Uint8Array(e))},DataView(e,n,t,r){return new f(s.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,n,t,r){if(!e.length)return t.addBreakTokens===!0?[L.emptyArray,new f(s.break)]:L.emptyArray;r=le.createCheck(r,e);const o=[];let i=0;for(const a of e)o[i++]=se(a,t,r);return t.addBreakTokens?[new f(s.array,e.length),o,new f(s.break)]:[new f(s.array,e.length),o]},Object(e,n,t,r){const o=n!=="Object",i=o?e.keys():Object.keys(e),a=o?e.size:i.length;if(!a)return t.addBreakTokens===!0?[L.emptyMap,new f(s.break)]:L.emptyMap;r=le.createCheck(r,e);const u=[];let h=0;for(const g of i)u[h++]=[se(g,t,r),se(o?e.get(g):e[g],t,r)];return $r(u,t),t.addBreakTokens?[new f(s.map,a),u,new f(s.break)]:[new f(s.map,a),u]}};O.Map=O.Object;O.Buffer=O.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))O[`${e}Array`]=O.DataView;function se(e,n={},t){const r=At(e),o=n&&n.typeEncoders&&n.typeEncoders[r]||O[r];if(typeof o=="function"){const a=o(e,r,n,t);if(a!=null)return a}const i=O[r];if(!i)throw new Error(`${rn} unsupported type: ${r}`);return i(e,r,n,t)}function $r(e,n){n.mapSorter&&e.sort(n.mapSorter)}function zr(e,n){const t=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(n[0])?n[0][0]:n[0];if(t.type!==r.type)return t.type.compare(r.type);const o=t.type.major,i=un[o].compareTokens(t,r);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function dn(e,n,t,r){if(Array.isArray(n))for(const o of n)dn(e,o,t,r);else t[n.type.major](e,n,r)}function Dr(e,n,t){const r=se(e,t);if(!Array.isArray(r)&&t.quickEncodeToken){const o=t.quickEncodeToken(r);if(o)return o;const i=n[r.type.major];if(i.encodedSize){const a=i.encodedSize(r,t),u=new tn(a);if(i(u,r,t),u.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return nn(u.chunks[0])}}return be.reset(),dn(be,r,n,t),be.toBytes(!0)}function Ur(e,n){return n=Object.assign({},Sr,n),Dr(e,un,n)}const Cr={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Lr{constructor(n,t={}){this._pos=0,this.data=n,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const n=this.data[this._pos];let t=I[n];if(t===void 0){const r=c[n];if(!r)throw new Error(`${d} no decoder for major type ${n>>>5} (byte 0x${n.toString(16).padStart(2,"0")})`);const o=n&31;t=r(this.data,this._pos,o,this.options)}return this._pos+=t.encodedLength,t}}const Z=Symbol.for("DONE"),me=Symbol.for("BREAK");function Or(e,n,t){const r=[];for(let o=0;o<e.value;o++){const i=Y(n,t);if(i===me){if(e.value===1/0)break;throw new Error(`${d} got unexpected break to lengthed array`)}if(i===Z)throw new Error(`${d} found array but not enough entries (got ${o}, expected ${e.value})`);r[o]=i}return r}function Mr(e,n,t){const r=t.useMaps===!0,o=r?void 0:{},i=r?new Map:void 0;for(let a=0;a<e.value;a++){const u=Y(n,t);if(u===me){if(e.value===1/0)break;throw new Error(`${d} got unexpected break to lengthed map`)}if(u===Z)throw new Error(`${d} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(r!==!0&&typeof u!="string")throw new Error(`${d} non-string keys not supported (got ${typeof u})`);if(t.rejectDuplicateMapKeys===!0&&(r&&i.has(u)||!r&&u in o))throw new Error(`${d} found repeat map key "${u}"`);const h=Y(n,t);if(h===Z)throw new Error(`${d} found map but not enough entries (got ${a} [no value], expected ${e.value})`);r?i.set(u,h):o[u]=h}return r?i:o}function Y(e,n){if(e.done())return Z;const t=e.next();if(t.type===s.break)return me;if(t.type.terminal)return t.value;if(t.type===s.array)return Or(t,e,n);if(t.type===s.map)return Mr(t,e,n);if(t.type===s.tag){if(n.tags&&typeof n.tags[t.value]=="function"){const r=Y(e,n);return n.tags[t.value](r)}throw new Error(`${d} tag not supported (${t.value})`)}throw new Error("unsupported")}function Pr(e,n){if(!(e instanceof Uint8Array))throw new Error(`${d} data to decode must be a Uint8Array`);n=Object.assign({},Cr,n);const t=n.tokenizer||new Lr(e,n),r=Y(t,n);if(r===Z)throw new Error(`${d} did not find any content to decode`);if(r===me)throw new Error(`${d} got unexpected break`);return[r,e.subarray(t.pos())]}function jr(e,n){const[t,r]=Pr(e,n);if(r.length>0)throw new Error(`${d} too many terminals, data makes no sense`);return t}const ln=42;function hn(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function Fr(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const n=y.asCID(e);if(!n)return null;const t=new Uint8Array(n.bytes.byteLength+1);return t.set(n.bytes,1),[new f(s.tag,ln),new f(s.bytes,t)]}function Hr(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function Rr(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const ke={float64:!0,typeEncoders:{Object:Fr,undefined:Hr,number:Rr}},Gr={...ke,typeEncoders:{...ke.typeEncoders}};function Vr(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return y.decode(e.subarray(1))}const he={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};he.tags[ln]=Vr;const qr={...he,tags:he.tags.slice()},Kr="dag-cbor",Jr=113,Qr=e=>Ur(e,ke),Wr=e=>jr(hn(e),he),Bo=Object.freeze(Object.defineProperty({__proto__:null,code:Jr,decode:Wr,decodeOptions:qr,encode:Qr,encodeOptions:Gr,name:Kr,toByteView:hn},Symbol.toStringTag,{value:"Module"})),Xr=new TextDecoder;function Me(e,n){let t=0;for(let r=0;;r+=7){if(r>=64)throw new Error("protobuf: varint overflow");if(n>=e.length)throw new Error("protobuf: unexpected end of data");const o=e[n++];if(t+=r<28?(o&127)<<r:(o&127)*2**r,o<128)break}return[t,n]}function pe(e,n){let t;[t,n]=Me(e,n);const r=n+t;if(t<0||r<0)throw new Error("protobuf: invalid length");if(r>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(n,r),r]}function pn(e,n){let t;return[t,n]=Me(e,n),[t&7,t>>3,n]}function Zr(e){const n={},t=e.length;let r=0;for(;r<t;){let o,i;if([o,i,r]=pn(e,r),i===1){if(n.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(n.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(n.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[n.Hash,r]=pe(e,r)}else if(i===2){if(n.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(n.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let a;[a,r]=pe(e,r),n.Name=Xr.decode(a)}else if(i===3){if(n.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[n.Tsize,r]=Me(e,r)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${i}`)}if(r>t)throw new Error("protobuf: (PBLink) unexpected end of data");return n}function Yr(e){const n=e.length;let t=0,r,o=!1,i;for(;t<n;){let u,h;if([u,h,t]=pn(e,t),u!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${u}`);if(h===1){if(i)throw new Error("protobuf: (PBNode) duplicate Data section");[i,t]=pe(e,t),r&&(o=!0)}else if(h===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");r||(r=[]);let g;[g,t]=pe(e,t),r.push(Zr(g))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${h}`)}if(t>n)throw new Error("protobuf: (PBNode) unexpected end of data");const a={};return i&&(a.Data=i),a.Links=r||[],a}const wn=new TextEncoder,Ke=2**32,eo=2**31;function no(e,n){let t=n.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");t=X(n,t,e.Tsize)-1,n[t]=24}if(typeof e.Name=="string"){const r=wn.encode(e.Name);t-=r.length,n.set(r,t),t=X(n,t,r.length)-1,n[t]=18}return e.Hash&&(t-=e.Hash.length,n.set(e.Hash,t),t=X(n,t,e.Hash.length)-1,n[t]=10),n.length-t}function to(e){const n=oo(e),t=new Uint8Array(n);let r=n;if(e.Data&&(r-=e.Data.length,t.set(e.Data,r),r=X(t,r,e.Data.length)-1,t[r]=10),e.Links)for(let o=e.Links.length-1;o>=0;o--){const i=no(e.Links[o],t.subarray(0,r));r-=i,r=X(t,r,i)-1,t[r]=18}return t}function ro(e){let n=0;if(e.Hash){const t=e.Hash.length;n+=1+t+G(t)}if(typeof e.Name=="string"){const t=wn.encode(e.Name).length;n+=1+t+G(t)}return typeof e.Tsize=="number"&&(n+=1+G(e.Tsize)),n}function oo(e){let n=0;if(e.Data){const t=e.Data.length;n+=1+t+G(t)}if(e.Links)for(const t of e.Links){const r=ro(t);n+=1+r+G(r)}return n}function X(e,n,t){n-=G(t);const r=n;for(;t>=eo;)e[n++]=t&127|128,t/=128;for(;t>=128;)e[n++]=t&127|128,t>>>=7;return e[n]=t,r}function G(e){return e%2===0&&e++,Math.floor((io(e)+6)/7)}function io(e){let n=0;return e>=Ke&&(e=Math.floor(e/Ke),n=32),e>=65536&&(e>>>=16,n+=16),e>=256&&(e>>>=8,n+=8),n+so[e]}const so=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],ao=["Data","Links"],co=["Hash","Name","Tsize"],Be=new TextEncoder;function yn(e,n){if(e===n)return 0;const t=e.Name?Be.encode(e.Name):[],r=n.Name?Be.encode(n.Name):[];let o=t.length,i=r.length;for(let a=0,u=Math.min(o,i);a<u;++a)if(t[a]!==r[a]){o=t[a],i=r[a];break}return o<i?-1:i<o?1:0}function Je(e,n){return!Object.keys(e).some(t=>!n.includes(t))}function gn(e){if(typeof e.asCID=="object"){const t=y.asCID(e);if(!t)throw new TypeError("Invalid DAG-PB form");return{Hash:t}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const n={};if(e.Hash){let t=y.asCID(e.Hash);try{t||(typeof e.Hash=="string"?t=y.parse(e.Hash):e.Hash instanceof Uint8Array&&(t=y.decode(e.Hash)))}catch(r){throw new TypeError(`Invalid DAG-PB form: ${r.message}`)}t&&(n.Hash=t)}if(!n.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(n.Name=e.Name),typeof e.Tsize=="number"&&(n.Tsize=e.Tsize),n}function mn(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const n={};if(e.Data!==void 0)if(typeof e.Data=="string")n.Data=Be.encode(e.Data);else if(e.Data instanceof Uint8Array)n.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))n.Links=e.Links.map(gn),n.Links.sort(yn);else throw new TypeError("Invalid DAG-PB form");else n.Links=[];return n}function xn(e){if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!Je(e,ao))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let n=0;n<e.Links.length;n++){const t=e.Links[n];if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!Je(t,co))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(t.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(t.Hash==null||!t.Hash["/"]||t.Hash["/"]!==t.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(t.Name!==void 0&&typeof t.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(t.Tsize!==void 0){if(typeof t.Tsize!="number"||t.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(t.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(n>0&&yn(t,e.Links[n-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function fo(e,n=[]){return mn({Data:e,Links:n})}function uo(e,n,t){return gn({Hash:t,Name:e,Tsize:n})}function lo(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}const ho="dag-pb",po=112;function wo(e){xn(e);const n={};return e.Links&&(n.Links=e.Links.map(t=>{const r={};return t.Hash&&(r.Hash=t.Hash.bytes),t.Name!==void 0&&(r.Name=t.Name),t.Tsize!==void 0&&(r.Tsize=t.Tsize),r})),e.Data&&(n.Data=e.Data),to(n)}function yo(e){const n=lo(e),t=Yr(n),r={};return t.Data&&(r.Data=t.Data),t.Links&&(r.Links=t.Links.map(o=>{const i={};try{i.Hash=y.decode(o.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return o.Name!==void 0&&(i.Name=o.Name),o.Tsize!==void 0&&(i.Tsize=o.Tsize),i})),r}const No=Object.freeze(Object.defineProperty({__proto__:null,code:po,createLink:uo,createNode:fo,decode:yo,encode:wo,name:ho,prepare:mn,validate:xn},Symbol.toStringTag,{value:"Module"}));export{ee as A,Ae as B,y as C,Ao as D,vo as E,Eo as F,ko as G,rn as H,St as I,nn as J,Dr as K,jr as L,d as M,Dt as N,No as O,Bo as P,To as R,f as T,dt as a,yo as b,po as c,Wr as d,Qr as e,wo as f,Ye as g,mo as h,D as i,ce as j,fe as k,ve as l,Ir as m,qn as n,Jr as o,mn as p,_r as q,Kr as r,pt as s,s as t,W as u,we as v,U as w,Xe as x,bo as y,xo as z};
