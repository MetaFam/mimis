const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D7ShErVm.js","./DSTOT4fw.js","./Ci5bNVgp.js","./Bmv5LrBQ.js","./CADC4eU6.js","./Bku9roCD.js","./DyudQPZA.js","./DtOm4NEL.js","./DRDJEAPC.js","./N8ZmQnvc.js","./BvzJc2UN.js","./PPVm8Dsz.js","./BVMZgy6Y.js","./CtmwZb_8.js","./CM0mOKsn.js","./iaSQj7lr.js","./CW2kEcsZ.js","./5o37v23G.js","./CbKQpjBq.js","./CxGiiovH.js","./D_llTcOA.js","./A_Nk8MfW.js","./DmfK5sOV.js","./BigzhV7c.js","./02KTgZY8.js","./BylOuJBE.js","./LtmbHffy.js","./BfrDb0sC.js","./BAzi8DGq.js","./DQQ5PI3X.js","./De88iMpS.js","./CE1G-McA.js","./D1tnaAHL.js","./BLzkjlvO.js","./C6Sp7O4C.js","./CKm5XvKv.js","./DYqtQnD2.js","./XFuF_Ikl.js","./xrkAYOJf.js","./CtQuecvI.js","./CrppZ8Up.js","./CzKhd3kD.js","./Bm6Wts52.js","./CjhTacgn.js","./By10OQRC.js","./BMBCIC-K.js","./ByKEUrKf.js","./DHSPB30N.js","./Ccz-rknN.js","./E_uh7ip1.js","./BsY4AnX6.js","./9RPqwTfQ.js","./DEn2m9BA.js","./nFfU2WcD.js","./DGwAGOgE.js","./BoikEvTK.js","./BuXhVEVZ.js","./BHZaTCdo.js","./BfOyLazv.js","./B_Rh8HH8.js","./CxeeJ3Mv.js","./DbHy8J_E.js"])))=>i.map(i=>d[i]);
import{_ as dt}from"./PPVm8Dsz.js";import{t as Yv,d as Zv,E as Jv}from"./CMbgCQxV.js";import{b as Xv}from"./Lj-dUBm2.js";import{g as Pf,a as Qv,c as fr}from"./CE1G-McA.js";import{m as eC,H as tC,a as Vp,u as nC,n as Kp,d as Gp,t as rC,e as Yp,o as sC,c as sw,p as iC,q as oC,v as aC,w as cC,x as lC,j as uC}from"./DSTOT4fw.js";const dC=Symbol(),Zp=Object.getPrototypeOf,rh=new WeakMap,hC=t=>t&&(rh.has(t)?rh.get(t):Zp(t)===Object.prototype||Zp(t)===Array.prototype),fC=t=>hC(t)&&t[dC]||null,Jp=(t,e=!0)=>{rh.set(t,e)},Cl={},xf=t=>typeof t=="object"&&t!==null,pC=t=>xf(t)&&!dc.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),iw=(t,e)=>{const n=sh.get(t);if(n?.[0]===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return Jp(r,!0),sh.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(dc.has(i))Jp(i,!1);else if(Ss.has(i)){const[c,l]=Ss.get(i);a.value=iw(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},gC=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Xp(l,o)||wa.has(o)&&Xp(l,wa.get(o))))return!0;n(i),xf(o)&&(o=fC(o)||o);const u=!Ss.has(o)&&yC(o)?Ye(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),Ss=new WeakMap,dc=new WeakSet,sh=new WeakMap,ol=[1],wa=new WeakMap;let Xp=Object.is,mC=(t,e)=>new Proxy(t,e),yC=pC,wC=iw,bC=gC;function Ye(t={}){if(!xf(t))throw new Error("object required");const e=wa.get(t);if(e)return e;let n=ol[0];const r=new Set,s=(m,b=++ol[0])=>{n!==b&&(i=n=b,r.forEach(v=>v(m,b)))};let i=n;const o=(m=ol[0])=>(i!==m&&(i=m,c.forEach(([b])=>{const v=b[1](m);v>n&&(n=v)})),n),a=m=>(b,v)=>{const C=[...b];C[1]=[m,...C[1]],s(C,v)},c=new Map,l=(m,b)=>{const v=!dc.has(b)&&Ss.get(b);if(v){if((Cl?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const C=v[2](a(m));c.set(m,[v,C])}else c.set(m,[v])}},u=m=>{var b;const v=c.get(m);v&&(c.delete(m),(b=v[1])==null||b.call(v))},d=m=>(r.add(m),r.size===1&&c.forEach(([v,C],N)=>{if((Cl?"production":void 0)!=="production"&&C)throw new Error("remove already exists");const y=v[2](a(N));c.set(N,[v,y])}),()=>{r.delete(m),r.size===0&&c.forEach(([v,C],N)=>{C&&(C(),c.set(N,[v]))})});let h=!0;const f=bC(()=>h,l,u,s),p=mC(t,f);wa.set(t,p);const g=[t,o,d];return Ss.set(p,g),Reflect.ownKeys(t).forEach(m=>{const b=Object.getOwnPropertyDescriptor(t,m);"value"in b&&b.writable&&(p[m]=t[m])}),h=!1,p}function Rt(t,e,n){const r=Ss.get(t);(Cl?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function ba(t){const e=Ss.get(t);(Cl?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return wC(n,r())}function so(t){return dc.add(t),t}function EC(){return{proxyStateMap:Ss,refSet:dc,snapCache:sh,versionHolder:ol,proxyCache:wa}}function _t(t,e,n,r){let s=t[e];return Rt(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:vC,snapCache:CC}=EC(),xc=t=>vC.has(t);function _C(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=CC.get(a),u=l?.[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:e,index:n,epoch:0,get size(){return xc(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!xc(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!xc(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!xc(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Ye(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var Qp={};const D={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos",sui:"Sui",stacks:"Stacks"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],SOLANA_SPL_TOKEN_ADDRESSES:{SOL:"So11111111111111111111111111111111111111112"},HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof Qp<"u"?Qp.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{displayMessage:"Multi-Wallet Not Enabled",debugMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}},IS_DEVELOPMENT:typeof process<"u"&&!1},Ea={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return t?.filter(n=>n.chainNamespace===e)||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){if(!e)return;const n=t.find(s=>s.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return D.CHAIN_NAME_MAP?.[r]||void 0}},ow=["eip155","solana","polkadot","bip122","cosmos","sui","stacks"];var AC=20,IC=1,ii=1e6,e0=1e6,SC=-7,NC=21,TC=!1,hc="[big.js] ",wi=hc+"Invalid ",su=wi+"decimal places",PC=wi+"rounding mode",aw=hc+"Division by zero",We={},Er=void 0,xC=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function cw(){function t(e){var n=this;if(!(n instanceof t))return e===Er?cw():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(wi+"value");e=e===0&&1/e<0?"-0":String(e)}RC(n,e)}n.constructor=t}return t.prototype=We,t.DP=AC,t.RM=IC,t.NE=SC,t.PE=NC,t.strict=TC,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function RC(t,e){var n,r,s;if(!xC.test(e))throw Error(wi+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function bi(t,e,n,r){var s=t.c;if(n===Er&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(PC);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==Er))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==Er||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function Ei(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}We.abs=function(){var t=new this.constructor(this);return t.s=1,t};We.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};We.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>ii)throw Error(su);if(!s[0])throw Error(aw);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),f=a=s.length,p=r.length,g=r.slice(0,a),m=g.length,b=t,v=b.c=[],C=0,N=o+(b.e=e.e-t.e)+1;for(b.s=i,i=N<0?0:N,h.unshift(0);m++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(m=g.length))u=a>m?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=m==a?s:h;m;){if(g[--m]<c[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}v[C++]=u?l:++l,g[0]&&u?g[m]=r[f]||0:g=[r[f]]}while((f++<p||g[0]!==Er)&&i--);return!v[0]&&C!=1&&(v.shift(),b.e--,N--),C>N&&bi(b,N,n.RM,g[0]!==Er),b};We.eq=function(t){return this.cmp(t)===0};We.gt=function(t){return this.cmp(t)>0};We.gte=function(t){return this.cmp(t)>-1};We.lt=function(t){return this.cmp(t)<0};We.lte=function(t){return this.cmp(t)<1};We.minus=We.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>a;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};We.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(aw);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};We.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};We.plus=We.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+l[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};We.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-e0||t>e0)throw Error(wi+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};We.prec=function(t,e){if(t!==~~t||t<1||t>ii)throw Error(wi+"precision");return bi(new this.constructor(this),t,e)};We.round=function(t,e){if(t===Er)t=0;else if(t!==~~t||t<-ii||t>ii)throw Error(su);return bi(new this.constructor(this),t+this.e+1,e)};We.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(hc+"No square root");i=Math.sqrt(+Ei(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return bi(t,(s.DP-=4)+t.e+1,s.RM)};We.times=We.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};We.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==Er){if(t!==~~t||t<0||t>ii)throw Error(su);for(n=bi(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return Ei(n,!0,!!r)};We.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==Er){if(t!==~~t||t<0||t>ii)throw Error(su);for(n=bi(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return Ei(n,!1,!!r)};We[Symbol.for("nodejs.util.inspect.custom")]=We.toJSON=We.toString=function(){var t=this,e=t.constructor;return Ei(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};We.toNumber=function(){var t=+Ei(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(hc+"Imprecise conversion");return t};We.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==Er){if(t!==~~t||t<1||t>ii)throw Error(wi+"precision");for(n=bi(new r(n),t,e);n.c.length<t;)n.c.push(0)}return Ei(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};We.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(hc+"valueOf disallowed");return Ei(t,t.e<=e.NE||t.e>=e.PE,!0)};var ts=cw();const OC={bigNumber(t){return t?new ts(t):new ts(0)},multiply(t,e){if(t===void 0||e===void 0)return new ts(0);const n=new ts(t),r=new ts(e);return n.times(r)},toFixed(t,e=2){return t===void 0||t===""?new ts(0).toFixed(e):new ts(t).toFixed(e)},formatNumberToLocalString(t,e=2){return t===void 0||t===""?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e,roundingMode:"floor"})},parseLocalStringToNumber(t){if(t===void 0||t==="")return 0;const e=t.replace(/,/gu,"");return new ts(e).toNumber()}},kC=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],DC=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],$C=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],UC={getERC20Abi:t=>D.USDT_CONTRACT_ADDRESSES.includes(t)?$C:kC,getSwapAbi:()=>DC},xt={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},mr={RPC_ERROR_CODE:{USER_REJECTED_REQUEST:4001},PROVIDER_RPC_ERROR_NAME:{PROVIDER_RPC:"ProviderRpcError",USER_REJECTED_REQUEST:"UserRejectedRequestError"},isRpcProviderError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.message=="string",r=typeof e.code=="number";return n&&r}return!1}catch{return!1}},isUserRejectedMessage(t){return t.toLowerCase().includes("user rejected")||t.toLowerCase().includes("user cancelled")||t.toLowerCase().includes("user canceled")},isUserRejectedRequestError(t){return mr.isRpcProviderError(t)?t.code===mr.RPC_ERROR_CODE.USER_REJECTED_REQUEST||mr.isUserRejectedMessage(t.message):t instanceof Error?mr.isUserRejectedMessage(t.message):!1}};let MC=class extends Error{constructor(e,n){super(n.message,{cause:e}),this.name=mr.PROVIDER_RPC_ERROR_NAME.PROVIDER_RPC,this.code=n.code}},Ji=class extends MC{constructor(e){super(e,{code:mr.RPC_ERROR_CODE.USER_REJECTED_REQUEST,message:"User rejected the request"}),this.name=mr.PROVIDER_RPC_ERROR_NAME.USER_REJECTED_REQUEST}};const ue={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",RECENT_WALLET:"@appkit/recent_wallet",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids",HISTORY_TRANSACTIONS_CACHE:"@appkit/history_transactions_cache",TOKEN_PRICE_CACHE:"@appkit/token_price_cache",RECENT_EMAILS:"@appkit/recent_emails",LATEST_APPKIT_VERSION:"@appkit/latest_version"};function Fu(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const ce={setItem(t,e){Qo()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(Qo())return localStorage.getItem(t)||void 0},removeItem(t){Qo()&&localStorage.removeItem(t)},clear(){Qo()&&localStorage.clear()}};function Qo(){return typeof window<"u"&&typeof localStorage<"u"}function va(t,e){return e==="light"?{"--w3m-accent":t?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":t?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#202020"}}var t0={};const ju=(typeof process<"u"&&typeof t0<"u"?t0.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",lw=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],LC="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",Pe={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:ju,SECURE_SITE_DASHBOARD:`${ju}/dashboard`,SECURE_SITE_FAVICON:`${ju}/images/favicon.png`,SOLANA_NATIVE_TOKEN_ADDRESS:"So11111111111111111111111111111111111111111",RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[D.CHAIN.EVM,D.CHAIN.SOLANA],SEND_PARAMS_SUPPORTED_CHAINS:[D.CHAIN.EVM],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[D.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[D.CHAIN.EVM,D.CHAIN.SOLANA],PAY_WITH_EXCHANGE_SUPPORTED_CHAIN_NAMESPACES:[D.CHAIN.EVM,D.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[D.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x",sui:"0x",stacks:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[D.CHAIN.EVM,D.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1,emailCapture:!1,payWithExchange:!1,payments:!1,reownAuthentication:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1,emailCapture:!1,reownAuthentication:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1,reownAuthentication:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},j={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5,transactionsHistory:15e3,tokenPrice:15e3,latestAppKitVersion:6048e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=j.getActiveNamespace(),e=j.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{ce.setItem(ue.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=ce.getItem(ue.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{ce.removeItem(ue.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{ce.setItem(ue.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{ce.setItem(ue.ACTIVE_CAIP_NETWORK_ID,t),j.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return ce.getItem(ue.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{ce.removeItem(ue.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=Fu(t);ce.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=j.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),ce.setItem(ue.RECENT_WALLETS,JSON.stringify(e)),ce.setItem(ue.RECENT_WALLET,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=ce.getItem(ue.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},getRecentWallet(){try{const t=ce.getItem(ue.RECENT_WALLET);return t?JSON.parse(t):null}catch{console.info("Unable to get AppKit recent")}return null},deleteRecentWallet(){try{ce.removeItem(ue.RECENT_WALLET)}catch{console.info("Unable to delete AppKit recent")}},setConnectedConnectorId(t,e){try{const n=Fu(t);ce.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return ce.getItem(ue.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=Fu(t);return ce.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{ce.setItem(ue.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return ce.getItem(ue.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{ce.removeItem(ue.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return ce.getItem(ue.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){return ce.getItem(ue.ACTIVE_CAIP_NETWORK_ID)?.split(":")?.[1]},setConnectionStatus(t){try{ce.setItem(ue.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return ce.getItem(ue.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=ce.getItem(ue.CONNECTED_NAMESPACES);return t?.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));ce.setItem(ue.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=j.getConnectedNamespaces();e.includes(t)||(e.push(t),j.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=j.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),j.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return ce.getItem(ue.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{ce.setItem(ue.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{ce.removeItem(ue.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=ce.getItem(ue.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=j.getBalanceCache();ce.setItem(ue.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=j.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;j.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=j.getBalanceCache();e[t.caipAddress]=t,ce.setItem(ue.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=ce.getItem(ue.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=j.getBalanceCache();ce.setItem(ue.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=j.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),j.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=j.getNativeBalanceCache();e[t.caipAddress]=t,ce.setItem(ue.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=ce.getItem(ue.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=j.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;j.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=j.getEnsCache();e[t.address]=t,ce.setItem(ue.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=j.getEnsCache();ce.setItem(ue.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=ce.getItem(ue.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=j.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;j.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=j.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},ce.setItem(ue.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=j.getIdentityCache();ce.setItem(ue.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{ce.removeItem(ue.PORTFOLIO_CACHE),ce.removeItem(ue.NATIVE_BALANCE_CACHE),ce.removeItem(ue.ENS_CACHE),ce.removeItem(ue.IDENTITY_CACHE),ce.removeItem(ue.HISTORY_TRANSACTIONS_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{ce.setItem(ue.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=ce.getItem(ue.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=j.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===D.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};ce.setItem(ue.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=ce.getItem(ue.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=j.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),ce.setItem(ue.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=ce.getItem(ue.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=j.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),ce.setItem(ue.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=j.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),ce.setItem(ue.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(j.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1},getTransactionsCache(){try{const t=ce.getItem(ue.HISTORY_TRANSACTIONS_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get transactions cache")}return{}},getTransactionsCacheForAddress({address:t,chainId:e=""}){try{const r=j.getTransactionsCache()[t]?.[e];if(r&&!this.isCacheExpired(r.timestamp,this.cacheExpiry.transactionsHistory))return r.transactions;j.removeTransactionsCache({address:t,chainId:e})}catch{console.info("Unable to get transactions cache")}},updateTransactionsCache({address:t,chainId:e="",timestamp:n,transactions:r}){try{const s=j.getTransactionsCache();s[t]={...s[t],[e]:{timestamp:n,transactions:r}},ce.setItem(ue.HISTORY_TRANSACTIONS_CACHE,JSON.stringify(s))}catch{console.info("Unable to update transactions cache",{address:t,chainId:e,timestamp:n,transactions:r})}},removeTransactionsCache({address:t,chainId:e}){try{const n=j.getTransactionsCache(),r=n?.[t]||{},{[e]:s,...i}=r;ce.setItem(ue.HISTORY_TRANSACTIONS_CACHE,JSON.stringify({...n,[t]:i}))}catch{console.info("Unable to remove transactions cache",{address:t,chainId:e})}},getTokenPriceCache(){try{const t=ce.getItem(ue.TOKEN_PRICE_CACHE);return t?JSON.parse(t):{}}catch{console.info("Unable to get token price cache")}return{}},getTokenPriceCacheForAddresses(t){try{const n=j.getTokenPriceCache()[t.join(",")];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.tokenPrice))return n.tokenPrice;j.removeTokenPriceCache(t)}catch{console.info("Unable to get token price cache for addresses",t)}},updateTokenPriceCache(t){try{const e=j.getTokenPriceCache();e[t.addresses.join(",")]={timestamp:t.timestamp,tokenPrice:t.tokenPrice},ce.setItem(ue.TOKEN_PRICE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update token price cache",t)}},removeTokenPriceCache(t){try{const e=j.getTokenPriceCache();ce.setItem(ue.TOKEN_PRICE_CACHE,JSON.stringify({...e,[t.join(",")]:void 0}))}catch{console.info("Unable to remove token price cache",t)}},getLatestAppKitVersion(){try{const t=this.getLatestAppKitVersionCache(),e=t?.version;return e&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.latestAppKitVersion)?e:void 0}catch{console.info("Unable to get latest AppKit version")}},getLatestAppKitVersionCache(){try{const t=ce.getItem(ue.LATEST_APPKIT_VERSION);return t?JSON.parse(t):{}}catch{console.info("Unable to get latest AppKit version cache")}return{}},updateLatestAppKitVersion(t){try{const e=j.getLatestAppKitVersionCache();e.timestamp=t.timestamp,e.version=t.version,ce.setItem(ue.LATEST_APPKIT_VERSION,JSON.stringify(e))}catch{console.info("Unable to update latest AppKit version on local storage",t)}}},ee={isMobile(){return this.isClient()?!!(window?.matchMedia&&typeof window.matchMedia=="function"&&window.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t?.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return ee.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window?.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window?.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=Pe.TEN_SEC_MS:!0},isAllowedRetry(t,e=Pe.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return window?.self!==window?.top}catch{return!1}},isSafeApp(){if(ee.isClient()&&window.self!==window.top)try{const t=window?.location?.ancestorOrigins?.[0],e="https://app.safe.global";if(t){const n=new URL(t),r=new URL(e);return n.hostname===r.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+Pe.FOUR_MINUTES_MS},getNetworkId(t){return t?.split(":")[1]},getPlainAddress(t){return t?.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(ee.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r&&(r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`)),s&&!s?.endsWith("/")&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!ee.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?j.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window?.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){if(typeof window>"u")return!1;const t=window?.matchMedia&&typeof window.matchMedia=="function"?window.matchMedia("(display-mode: standalone)")?.matches:!1,e=window?.navigator?.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,ee.wait(2e3)])},parseBalance(t,e){let n="0.000";if(typeof t=="string"){const c=Number(t);if(!isNaN(c)){const l=(Math.floor(c*1e3)/1e3).toFixed(3);l&&(n=l)}}const[r,s]=n.split("."),i=r||"0",o=s||"000";return{formattedText:`${i}.${o}${e?` ${e}`:""}`,value:i,decimals:o,symbol:e}},getApiUrl(){return D.W3M_API_URL},getBlockchainApiUrl(){return D.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return D.PULSE_API_URL},getUUID(){return crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){return typeof t=="string"?t:typeof t?.issues?.[0]?.message=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?Pe.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in D.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window?.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window?.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),l=t.substring(s),u=c+n;return a+u+l}},BC="1.1.0";let un=class ih extends Error{constructor(e,n={}){const r=n.cause instanceof ih?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof ih&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: abitype@${BC}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}};function es(t,e){return t.exec(e)?.groups}const uw=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,dw=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,hw=/^\(.+?\).*?$/,n0=/^tuple(?<array>(\[(\d*)\])*)$/;function oh(t){let e=t.type;if(n0.test(t.type)&&"components"in t){e="(";const n=t.components.length;for(let s=0;s<n;s++){const i=t.components[s];e+=oh(i),s<n-1&&(e+=", ")}const r=es(n0,t.type);return e+=`)${r?.array??""}`,oh({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function ko(t){let e="";const n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=oh(s),r!==n-1&&(e+=", ")}return e}function FC(t){return t.type==="function"?`function ${t.name}(${ko(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${t.outputs?.length?` returns (${ko(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${ko(t.inputs)})`:t.type==="error"?`error ${t.name}(${ko(t.inputs)})`:t.type==="constructor"?`constructor(${ko(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const fw=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function jC(t){return fw.test(t)}function HC(t){return es(fw,t)}const pw=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function qC(t){return pw.test(t)}function WC(t){return es(pw,t)}const gw=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function zC(t){return gw.test(t)}function VC(t){return es(gw,t)}const mw=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function yw(t){return mw.test(t)}function KC(t){return es(mw,t)}const ww=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function GC(t){return ww.test(t)}function YC(t){return es(ww,t)}const bw=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function ZC(t){return bw.test(t)}function JC(t){return es(bw,t)}const XC=/^receive\(\) external payable$/;function QC(t){return XC.test(t)}const rj=new Set(["memory","indexed","storage","calldata"]),e_=new Set(["indexed"]),ah=new Set(["calldata","memory","storage"]);class sj extends un{constructor({signature:e}){super("Failed to parse ABI item.",{details:`parseAbiItem(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiitem-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiItemError"})}}class t_ extends un{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class n_ extends un{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class ij extends un{constructor({params:e}){super("Failed to parse ABI parameters.",{details:`parseAbiParameters(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameters-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParametersError"})}}class r_ extends un{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class s_ extends un{constructor({param:e,name:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class i_ extends un{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class o_ extends un{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class a_ extends un{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class bo extends un{constructor({signature:e,type:n}){super(`Invalid ${n} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class c_ extends un{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class l_ extends un{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class u_ extends un{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class d_ extends un{constructor({current:e,depth:n}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function h_(t,e,n){let r="";if(n)for(const s of Object.entries(n)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;r+=`(${s[0]}{${i}})`}return e?`${e}:${t}${r}`:t}const Hu=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function f_(t,e={}){if(zC(t))return p_(t,e);if(qC(t))return g_(t,e);if(jC(t))return m_(t,e);if(GC(t))return y_(t,e);if(ZC(t))return w_(t);if(QC(t))return{type:"receive",stateMutability:"payable"};throw new c_({signature:t})}function p_(t,e={}){const n=VC(t);if(!n)throw new bo({signature:t,type:"function"});const r=Zn(n.parameters),s=[],i=r.length;for(let a=0;a<i;a++)s.push(oi(r[a],{modifiers:ah,structs:e,type:"function"}));const o=[];if(n.returns){const a=Zn(n.returns),c=a.length;for(let l=0;l<c;l++)o.push(oi(a[l],{modifiers:ah,structs:e,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:o}}function g_(t,e={}){const n=WC(t);if(!n)throw new bo({signature:t,type:"event"});const r=Zn(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(oi(r[o],{modifiers:e_,structs:e,type:"event"}));return{name:n.name,type:"event",inputs:s}}function m_(t,e={}){const n=HC(t);if(!n)throw new bo({signature:t,type:"error"});const r=Zn(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(oi(r[o],{structs:e,type:"error"}));return{name:n.name,type:"error",inputs:s}}function y_(t,e={}){const n=YC(t);if(!n)throw new bo({signature:t,type:"constructor"});const r=Zn(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(oi(r[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}function w_(t){const e=JC(t);if(!e)throw new bo({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const b_=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*(?:\spayable)?)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,E_=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,v_=/^u?int$/;function oi(t,e){const n=h_(t,e?.type,e?.structs);if(Hu.has(n))return Hu.get(n);const r=hw.test(t),s=es(r?E_:b_,t);if(!s)throw new r_({param:t});if(s.name&&__(s.name))throw new s_({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=e?.structs??{};let c,l={};if(r){c="tuple";const d=Zn(s.type),h=[],f=d.length;for(let p=0;p<f;p++)h.push(oi(d[p],{structs:a}));l={components:h}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(v_.test(s.type))c=`${s.type}256`;else if(s.type==="address payable")c="address";else if(c=s.type,e?.type!=="struct"&&!Ew(c))throw new n_({type:c});if(s.modifier){if(!e?.modifiers?.has?.(s.modifier))throw new i_({param:t,type:e?.type,modifier:s.modifier});if(ah.has(s.modifier)&&!A_(c,!!s.array))throw new o_({param:t,type:e?.type,modifier:s.modifier})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return Hu.set(n,u),u}function Zn(t,e=[],n="",r=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?Zn(a,[...e,n.trim()]):Zn(a,e,`${n}${o}`,r);case"(":return Zn(a,e,`${n}${o}`,r+1);case")":return Zn(a,e,`${n}${o}`,r-1);default:return Zn(a,e,`${n}${o}`,r)}}if(n==="")return e;if(r!==0)throw new d_({current:n,depth:r});return e.push(n.trim()),e}function Ew(t){return t==="address"||t==="bool"||t==="function"||t==="string"||uw.test(t)||dw.test(t)}const C_=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function __(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||uw.test(t)||dw.test(t)||C_.test(t)}function A_(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function I_(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!yw(a))continue;const c=KC(a);if(!c)throw new bo({signature:a,type:"struct"});const l=c.properties.split(";"),u=[],d=l.length;for(let h=0;h<d;h++){const p=l[h].trim();if(!p)continue;const g=oi(p,{type:"struct"});u.push(g)}if(!u.length)throw new l_({signature:a});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=vw(c,e)}return r}const S_=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function vw(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(hw.test(o.type))r.push(o);else{const c=es(S_,o.type);if(!c?.type)throw new a_({abiParameter:o});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new u_({type:u});r.push({...o,type:`tuple${l??""}`,components:vw(e[u]??[],e,new Set([...n,u]))})}else if(Ew(u))r.push(o);else throw new t_({type:u})}}return r}function Cw(t){const e=I_(t),n=[],r=t.length;for(let s=0;s<r;s++){const i=t[s];yw(i)||n.push(f_(i,e))}return n}function Je(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}function Ns(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new L_(t.type);return`${t.name}(${iu(t.inputs,{includeName:e})})`}function iu(t,{includeName:e=!1}={}){return t?t.map(n=>N_(n,{includeName:e})).join(e?", ":","):""}function N_(t,{includeName:e}){return t.type.startsWith("tuple")?`(${iu(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function Ts(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function wt(t){return Ts(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const _w="2.37.9";let qu={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${_w}`},W=class ch extends Error{constructor(e,n={}){const r=n.cause instanceof ch?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof ch&&n.cause.docsPath||n.docsPath,i=qu.getDocsUrl?.({...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...qu.version?[`Version: ${qu.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=_w}walk(e){return Aw(this,e)}};function Aw(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?Aw(t.cause,e):e?null:t}class T_ extends W{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class r0 extends W{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class Iw extends W{constructor({data:e,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${iu(n,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=n,this.size=r}}class ou extends W{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class P_ extends W{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class x_ extends W{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${wt(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class R_ extends W{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class oj extends W{constructor(e,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class aj extends W{constructor(e,{docsPath:n}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class Sw extends W{constructor(e,{docsPath:n}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class O_ extends W{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class Nw extends W{constructor(e,{docsPath:n}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class cj extends W{constructor(e,{docsPath:n}={}){super([`Event ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class _l extends W{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class k_ extends W{constructor(e,{docsPath:n}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class lj extends W{constructor(e,{docsPath:n}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class D_ extends W{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${Ns(e.abiItem)}\`, and`,`\`${n.type}\` in \`${Ns(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class uj extends W{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class lh extends W{constructor({abiItem:e,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${iu(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=n,this.params=r,this.size=s}}class Tw extends W{constructor({abiItem:e,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${Ns(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class $_ extends W{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class U_ extends W{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}class M_ extends W{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class L_ extends W{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class dj extends W{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}let Pw=class extends W{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}},xw=class extends W{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class s0 extends W{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function Eo(t,{dir:e,size:n=32}={}){return typeof t=="string"?Cs(t,{dir:e,size:n}):B_(t,{dir:e,size:n})}function Cs(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new xw({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function B_(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new xw({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let Rw=class extends W{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}};class F_ extends W{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class j_ extends W{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let H_=class extends W{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function _s(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function Bn(t,{size:e}){if(wt(t)>e)throw new H_({givenSize:wt(t),maxSize:e})}function io(t,e={}){const{signed:n}=e;e.size&&Bn(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function mj(t,e={}){let n=t;if(e.size&&(Bn(n,{size:e.size}),n=_s(n)),_s(n)==="0x00")return!1;if(_s(n)==="0x01")return!0;throw new j_(n)}function ai(t,e={}){return Number(io(t,e))}function Ow(t,e={}){let n=_r(t);return e.size&&(Bn(n,{size:e.size}),n=_s(n,{dir:"right"})),new TextDecoder().decode(n)}const q_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function oo(t,e={}){return typeof t=="number"||typeof t=="bigint"?Ae(t,e):typeof t=="string"?au(t,e):typeof t=="boolean"?kw(t,e):ln(t,e)}function kw(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Bn(n,{size:e.size}),Eo(n,{size:e.size})):n}function ln(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=q_[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Bn(r,{size:e.size}),Eo(r,{dir:"right",size:e.size})):r}function Ae(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new Rw({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Eo(a,{size:r}):a}const W_=new TextEncoder;function au(t,e={}){const n=W_.encode(t);return ln(n,e)}const z_=new TextEncoder;function cu(t,e={}){return typeof t=="number"||typeof t=="bigint"?K_(t,e):typeof t=="boolean"?V_(t,e):Ts(t)?_r(t,e):Dw(t,e)}function V_(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Bn(n,{size:e.size}),Eo(n,{size:e.size})):n}const xr={zero:48,nine:57,A:65,F:70,a:97,f:102};function i0(t){if(t>=xr.zero&&t<=xr.nine)return t-xr.zero;if(t>=xr.A&&t<=xr.F)return t-(xr.A-10);if(t>=xr.a&&t<=xr.f)return t-(xr.a-10)}function _r(t,e={}){let n=t;e.size&&(Bn(n,{size:e.size}),n=Eo(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=i0(r.charCodeAt(a++)),l=i0(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new W(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function K_(t,e){const n=Ae(t,e);return _r(n)}function Dw(t,e={}){const n=z_.encode(t);return typeof e.size=="number"?(Bn(n,{size:e.size}),Eo(n,{dir:"right",size:e.size})):n}const G_=BigInt(0),Do=BigInt(1),Y_=BigInt(2),Z_=BigInt(7),J_=BigInt(256),X_=BigInt(113),$w=[],Uw=[],Mw=[];for(let t=0,e=Do,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],$w.push(2*(5*r+n)),Uw.push((t+1)*(t+2)/2%64);let s=G_;for(let i=0;i<7;i++)e=(e<<Do^(e>>Z_)*X_)%J_,e&Y_&&(s^=Do<<(Do<<BigInt(i))-Do);Mw.push(s)}const Lw=lC(Mw,!0),Q_=Lw[0],eA=Lw[1],o0=(t,e,n)=>n>32?aC(t,e,n):iC(t,e,n),a0=(t,e,n)=>n>32?cC(t,e,n):oC(t,e,n);function tA(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=o0(l,u,1)^n[a],h=a0(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Uw[o],c=o0(s,i,a),l=a0(s,i,a),u=$w[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=Q_[r],t[1]^=eA[r]}sw(n)}class Rf extends tC{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Vp(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=nC(this.state)}clone(){return this._cloneInto()}keccak(){Kp(this.state32),tA(this.state32,this.rounds),Kp(this.state32),this.posOut=0,this.pos=0}update(e){Gp(this),e=rC(e),Yp(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Gp(this,!1),Yp(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Vp(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(sC(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,sw(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Rf(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const nA=(t,e,n)=>eC(()=>new Rf(e,t,n)),Bw=nA(1,136,256/8);function fc(t,e){const n=e||"hex",r=Bw(Ts(t,{strict:!1})?cu(t):t);return n==="bytes"?r:oo(r)}const rA=t=>fc(cu(t));function sA(t){return rA(t)}function iA(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new W("Unable to normalize signature.");return s}const oA=t=>{const e=typeof t=="string"?t:FC(t);return iA(e)};function Fw(t){return sA(oA(t))}const Of=Fw;class ci extends W{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}let lu=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Wu=new lu(8192);function pc(t,e){if(Wu.has(`${t}.${e}`))return Wu.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=fc(Dw(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Wu.set(`${t}.${e}`,i),i}function Ks(t,e){if(!Ar(t,{strict:!1}))throw new ci({address:t});return pc(t,e)}const aA=/^0x[a-fA-F0-9]{40}$/,zu=new lu(8192);function Ar(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if(zu.has(r))return zu.get(r);const s=aA.test(t)?t.toLowerCase()===t?!0:n?pc(t)===t:!0:!1;return zu.set(r,s),s}function ao(t){return typeof t[0]=="string"?uu(t):cA(t)}function cA(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function uu(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function Al(t,e,n,{strict:r}={}){return Ts(t,{strict:!1})?lA(t,e,n,{strict:r}):qw(t,e,n,{strict:r})}function jw(t,e){if(typeof e=="number"&&e>0&&e>wt(t)-1)throw new Pw({offset:e,position:"start",size:wt(t)})}function Hw(t,e,n){if(typeof e=="number"&&typeof n=="number"&&wt(t)!==n-e)throw new Pw({offset:n,position:"end",size:wt(t)})}function qw(t,e,n,{strict:r}={}){jw(t,e);const s=t.slice(e,n);return r&&Hw(s,e,n),s}function lA(t,e,n,{strict:r}={}){jw(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return r&&Hw(s,e,n),s}const wj=/^(.*)\[([0-9]*)\]$/,bj=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,uA=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Ww(t,e){if(t.length!==e.length)throw new R_({expectedLength:t.length,givenLength:e.length});const n=dA({params:t,values:e}),r=Df(n);return r.length===0?"0x":r}function dA({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(kf({param:t[r],value:e[r]}));return n}function kf({param:t,value:e}){const n=$f(t.type);if(n){const[r,s]=n;return fA(e,{length:r,param:{...t,type:s}})}if(t.type==="tuple")return wA(e,{param:t});if(t.type==="address")return hA(e);if(t.type==="bool")return gA(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=uA.exec(t.type)??[];return mA(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return pA(e,{param:t});if(t.type==="string")return yA(e);throw new $_(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function Df(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=wt(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(Ae(e+s,{size:32})),r.push(a),s+=wt(a)):n.push(a)}return ao([...n,...r])}function hA(t){if(!Ar(t))throw new ci({address:t});return{dynamic:!1,encoded:Cs(t.toLowerCase())}}function fA(t,{length:e,param:n}){const r=e===null;if(!Array.isArray(t))throw new M_(t);if(!r&&t.length!==e)throw new P_({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=kf({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=Df(i);if(r){const a=Ae(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?ao([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:ao(i.map(({encoded:o})=>o))}}function pA(t,{param:e}){const[,n]=e.type.split("bytes"),r=wt(t);if(!n){let s=t;return r%32!==0&&(s=Cs(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:ao([Cs(Ae(r,{size:32})),s])}}if(r!==Number.parseInt(n,10))throw new x_({expectedSize:Number.parseInt(n,10),value:t});return{dynamic:!1,encoded:Cs(t,{dir:"right"})}}function gA(t){if(typeof t!="boolean")throw new W(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:Cs(kw(t))}}function mA(t,{signed:e,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new Rw({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:Ae(t,{size:32,signed:e})}}function yA(t){const e=au(t),n=Math.ceil(wt(e)/32),r=[];for(let s=0;s<n;s++)r.push(Cs(Al(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:ao([Cs(Ae(wt(e),{size:32})),...r])}}function wA(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=kf({param:i,value:t[o]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?Df(r):ao(r.map(({encoded:s})=>s))}}function $f(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const Uf=t=>Al(Fw(t),0,4);function Mf(t){const{abi:e,args:n=[],name:r}=t,s=Ts(r,{strict:!1}),i=e.filter(a=>s?a.type==="function"?Uf(a)===r:a.type==="event"?Of(a)===r:!1:"name"in a&&a.name===r);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!n||n.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==n.length)continue;if(n.every((l,u)=>{const d="inputs"in a&&a.inputs[u];return d?uh(l,d):!1})){if(o&&"inputs"in o&&o.inputs){const l=zw(a.inputs,o.inputs,n);if(l)throw new D_({abiItem:a,type:l[0]},{abiItem:o,type:l[1]})}o=a}}return o||i[0]}function uh(t,e){const n=typeof t,r=e.type;switch(r){case"address":return Ar(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>uh(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>uh(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function zw(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return zw(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?Ar(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?Ar(n[r],{strict:!1}):!1)return o}}function bA(t,{method:e}){const n={};return t.transport.type==="fallback"&&t.transport.onResponse?.(({method:r,response:s,status:i,transport:o})=>{i==="success"&&e===r&&(n[s]=o.request)}),(r=>n[r]||t.request)}function Pr(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const c0="/docs/contract/encodeFunctionData";function EA(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=Mf({abi:e,args:n,name:r});if(!i)throw new _l(r,{docsPath:c0});s=i}if(s.type!=="function")throw new _l(void 0,{docsPath:c0});return{abi:[s],functionName:Uf(Ns(s))}}function du(t){const{args:e}=t,{abi:n,functionName:r}=t.abi.length===1&&t.functionName?.startsWith("0x")?t:EA(t),s=n[0],i=r,o="inputs"in s&&s.inputs?Ww(s.inputs,e??[]):void 0;return uu([i,o??"0x"])}const vA={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},CA={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},_A={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};class l0 extends W{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class Vw extends W{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class AA extends W{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const IA={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new AA({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new Vw({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new l0({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new l0({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function Lf(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(IA);return n.bytes=t,n.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}function SA(t,e={}){typeof e.size<"u"&&Bn(t,{size:e.size});const n=ln(t,e);return io(n,e)}function NA(t,e={}){let n=t;if(typeof e.size<"u"&&(Bn(n,{size:e.size}),n=_s(n)),n.length>1||n[0]>1)throw new F_(n);return!!n[0]}function Vr(t,e={}){typeof e.size<"u"&&Bn(t,{size:e.size});const n=ln(t,e);return ai(n,e)}function TA(t,e={}){let n=t;return typeof e.size<"u"&&(Bn(n,{size:e.size}),n=_s(n,{dir:"right"})),new TextDecoder().decode(n)}function hu(t,e){const n=typeof e=="string"?_r(e):e,r=Lf(n);if(wt(n)===0&&t.length>0)throw new ou;if(wt(e)&&wt(e)<32)throw new Iw({data:typeof e=="string"?e:ln(e),params:t,size:wt(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];r.setPosition(s);const[c,l]=to(r,a,{staticPosition:0});s+=l,i.push(c)}return i}function to(t,e,{staticPosition:n}){const r=$f(e.type);if(r){const[s,i]=r;return xA(t,{...e,type:i},{length:s,staticPosition:n})}if(e.type==="tuple")return DA(t,e,{staticPosition:n});if(e.type==="address")return PA(t);if(e.type==="bool")return RA(t);if(e.type.startsWith("bytes"))return OA(t,e,{staticPosition:n});if(e.type.startsWith("uint")||e.type.startsWith("int"))return kA(t,e);if(e.type==="string")return $A(t,{staticPosition:n});throw new U_(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const u0=32,dh=32;function PA(t){const e=t.readBytes(32);return[pc(ln(qw(e,-20))),32]}function xA(t,e,{length:n,staticPosition:r}){if(!n){const o=Vr(t.readBytes(dh)),a=r+o,c=a+u0;t.setPosition(a);const l=Vr(t.readBytes(u0)),u=Ca(e);let d=0;const h=[];for(let f=0;f<l;++f){t.setPosition(c+(u?f*32:d));const[p,g]=to(t,e,{staticPosition:c});d+=g,h.push(p)}return t.setPosition(r+32),[h,32]}if(Ca(e)){const o=Vr(t.readBytes(dh)),a=r+o,c=[];for(let l=0;l<n;++l){t.setPosition(a+l*32);const[u]=to(t,e,{staticPosition:a});c.push(u)}return t.setPosition(r+32),[c,32]}let s=0;const i=[];for(let o=0;o<n;++o){const[a,c]=to(t,e,{staticPosition:r+s});s+=c,i.push(a)}return[i,s]}function RA(t){return[NA(t.readBytes(32),{size:32}),32]}function OA(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=Vr(t.readBytes(32));t.setPosition(n+o);const a=Vr(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[ln(c),32]}return[ln(t.readBytes(Number.parseInt(s,10),32)),32]}function kA(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256",10),s=t.readBytes(32);return[r>48?SA(s,{signed:n}):Vr(s,{signed:n}),32]}function DA(t,e,{staticPosition:n}){const r=e.components.length===0||e.components.some(({name:o})=>!o),s=r?[]:{};let i=0;if(Ca(e)){const o=Vr(t.readBytes(dh)),a=n+o;for(let c=0;c<e.components.length;++c){const l=e.components[c];t.setPosition(a+i);const[u,d]=to(t,l,{staticPosition:a});i+=d,s[r?c:l?.name]=u}return t.setPosition(n+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,l]=to(t,a,{staticPosition:n});s[r?o:a?.name]=c,i+=l}return[s,i]}function $A(t,{staticPosition:e}){const n=Vr(t.readBytes(32)),r=e+n;t.setPosition(r);const s=Vr(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=TA(_s(i));return t.setPosition(e+32),[o,32]}function Ca(t){const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return t.components?.some(Ca);const n=$f(t.type);return!!(n&&Ca({...t,type:n[1]}))}function UA(t){const{abi:e,data:n}=t,r=Al(n,0,4);if(r==="0x")throw new ou;const i=[...e||[],CA,_A].find(o=>o.type==="error"&&r===Uf(Ns(o)));if(!i)throw new Sw(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?hu(i.inputs,Al(n,4)):void 0,errorName:i.name}}const Dn=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n);function Kw({abiItem:t,args:e,includeFunctionName:n=!0,includeName:r=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${n?t.name:""}(${t.inputs.map((s,i)=>`${r&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?Dn(e[i]):e[i]}`).join(", ")})`}const MA={gwei:9,wei:18},LA={ether:-9,wei:9},BA={ether:-18,gwei:-9};function vi(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function Bf(t,e="wei"){return vi(t,MA[e])}function an(t,e="wei"){return vi(t,LA[e])}class FA extends W{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class jA extends W{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function d0(t){return t.reduce((e,{slot:n,value:r})=>`${e}        ${n}: ${r}
`,"")}function HA(t){return t.reduce((e,{address:n,...r})=>{let s=`${e}    ${n}:
`;return r.nonce&&(s+=`      nonce: ${r.nonce}
`),r.balance&&(s+=`      balance: ${r.balance}
`),r.code&&(s+=`      code: ${r.code}
`),r.state&&(s+=`      state:
`,s+=d0(r.state)),r.stateDiff&&(s+=`      stateDiff:
`,s+=d0(r.stateDiff)),s},`  State Override:
`).slice(0,-1)}function gc(t){const e=Object.entries(t).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=e.reduce((r,[s])=>Math.max(r,s.length),0);return e.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class qA extends W{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}}class WA extends W{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",gc(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class zA extends W{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h}){const f=gc({chain:s&&`${s?.name} (id: ${s?.id})`,from:n?.address,to:d,value:typeof h<"u"&&`${Bf(h)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${an(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${an(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${an(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",f].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Gw extends W{constructor({blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){let o="Transaction";r&&i!==void 0&&(o=`Transaction at block time "${r}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),n&&i!==void 0&&(o=`Transaction at block number "${n}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class Yw extends W{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class VA extends W{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const KA=t=>t,Ff=t=>t;class GA extends W{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h,stateOverride:f}){const p=n?Pr(n):void 0;let g=gc({from:p?.address,to:d,value:typeof h<"u"&&`${Bf(h)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${an(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${an(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${an(l)} gwei`,nonce:u});f&&(g+=`
${HA(f)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",g].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Zw extends W{constructor(e,{abi:n,args:r,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=Mf({abi:n,args:r,name:o}),l=c?Kw({abiItem:c,args:r,includeFunctionName:!1,includeName:!1}):void 0,u=c?Ns(c,{includeName:!0}):void 0,d=gc({address:s&&KA(s),function:u,args:l&&l!=="()"&&`${[...Array(o?.length??0).keys()].map(()=>" ").join("")}${l}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=r,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class YA extends W{constructor({abi:e,data:n,functionName:r,message:s}){let i,o,a,c;if(n&&n!=="0x")try{o=UA({abi:e,data:n});const{abiItem:u,errorName:d,args:h}=o;if(d==="Error")c=h[0];else if(d==="Panic"){const[f]=h;c=vA[f]}else{const f=u?Ns(u,{includeName:!0}):void 0,p=u&&h?Kw({abiItem:u,args:h,includeFunctionName:!1,includeName:!1}):void 0;a=[f?`Error: ${f}`:"",p&&p!=="()"?`       ${[...Array(d?.length??0).keys()].map(()=>" ").join("")}${p}`:""]}}catch(u){i=u}else s&&(c=s);let l;i instanceof Sw&&(l=i.signature,a=[`Unable to decode signature "${l}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${l}.`]),super(c&&c!=="execution reverted"||l?[`The contract function "${r}" reverted with the following ${l?"signature":"reason"}:`,c||l].join(`
`):`The contract function "${r}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=n,this.reason=c,this.signature=l}}class ZA extends W{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class JA extends W{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class jf extends W{constructor({data:e,message:n}){super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class sa extends W{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${Ff(o)}`,e&&`Request body: ${Dn(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class Hf extends W{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${Ff(r)}`,`Request body: ${Dn(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class h0 extends W{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${Ff(n)}`,`Request body: ${Dn(e)}`],name:"TimeoutError"})}}const XA=-1;class dn extends W{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||e?.metaMessages,name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof Hf?e.code:n??XA}}class vn extends dn{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class _a extends dn{constructor(e){super(e,{code:_a.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(_a,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Aa extends dn{constructor(e){super(e,{code:Aa.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(Aa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Ia extends dn{constructor(e,{method:n}={}){super(e,{code:Ia.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(Ia,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Sa extends dn{constructor(e){super(e,{code:Sa.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Sa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class li extends dn{constructor(e){super(e,{code:li.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(li,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Na extends dn{constructor(e){super(e,{code:Na.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(Na,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Ta extends dn{constructor(e){super(e,{code:Ta.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Ta,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class As extends dn{constructor(e){super(e,{code:As.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(As,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class co extends dn{constructor(e){super(e,{code:co.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(co,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class Gs extends dn{constructor(e,{method:n}={}){super(e,{code:Gs.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(Gs,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class lo extends dn{constructor(e){super(e,{code:lo.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(lo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class Pa extends dn{constructor(e){super(e,{code:Pa.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(Pa,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class ot extends vn{constructor(e){super(e,{code:ot.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(ot,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class xa extends vn{constructor(e){super(e,{code:xa.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(xa,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class Ra extends vn{constructor(e,{method:n}={}){super(e,{code:Ra.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(Ra,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class Oa extends vn{constructor(e){super(e,{code:Oa.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(Oa,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class ka extends vn{constructor(e){super(e,{code:ka.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(ka,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Ir extends vn{constructor(e){super(e,{code:Ir.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Ir,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class Da extends vn{constructor(e){super(e,{code:Da.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(Da,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class $a extends vn{constructor(e){super(e,{code:$a.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty($a,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Ua extends vn{constructor(e){super(e,{code:Ua.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Ua,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class Ma extends vn{constructor(e){super(e,{code:Ma.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(Ma,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class La extends vn{constructor(e){super(e,{code:La.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(La,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class Ba extends vn{constructor(e){super(e,{code:Ba.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(Ba,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class Fa extends vn{constructor(e){super(e,{code:Fa.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(Fa,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class QA extends dn{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const eI=3;function Il(t,{abi:e,address:n,args:r,docsPath:s,functionName:i,sender:o}){const a=t instanceof jf?t:t instanceof W?t.walk(p=>"data"in p)||t.walk():{},{code:c,data:l,details:u,message:d,shortMessage:h}=a,f=t instanceof ou?new ZA({functionName:i}):[eI,li.code].includes(c)&&(l||u||d||h)?new YA({abi:e,data:typeof l=="object"?l.data:l,functionName:i,message:a instanceof Hf?u:h??d}):t;return new Zw(f,{abi:e,args:r,contractAddress:n,docsPath:s,functionName:i,sender:o})}function tI(t){const e=fc(`0x${t.substring(4)}`).substring(26);return pc(`0x${e}`)}async function nI({hash:t,signature:e}){const n=Ts(t)?t:oo(t),{secp256k1:r}=await dt(async()=>{const{secp256k1:o}=await import("./D7ShErVm.js");return{secp256k1:o}},__vite__mapDeps([0,1,2]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),p=f0(f);return new r.Signature(io(l),io(u)).addRecoveryBit(p)}const o=Ts(e)?e:oo(e);if(wt(o)!==65)throw new Error("invalid signature length");const a=ai(`0x${o.slice(130)}`),c=f0(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function f0(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function rI({hash:t,signature:e}){return tI(await nI({hash:t,signature:e}))}function sI(t,e="hex"){const n=Jw(t),r=Lf(new Uint8Array(n.length));return n.encode(r),e==="hex"?ln(r.bytes):r.bytes}function Jw(t){return Array.isArray(t)?iI(t.map(e=>Jw(e))):oI(t)}function iI(t){const e=t.reduce((s,i)=>s+i.length,0),n=Xw(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),n===1?s.pushUint8(e):n===2?s.pushUint16(e):n===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function oI(t){const e=typeof t=="string"?_r(t):t,n=Xw(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+n),n===1?s.pushUint8(e.length):n===2?s.pushUint16(e.length):n===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function Xw(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new W("Length is too large.")}function aI(t){const{chainId:e,nonce:n,to:r}=t,s=t.contractAddress??t.address,i=fc(uu(["0x05",sI([e?Ae(e):"0x",s,n?Ae(n):"0x"])]));return r==="bytes"?_r(i):i}async function Qw(t){const{authorization:e,signature:n}=t;return rI({hash:aI(e),signature:n??e})}class cI extends W{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h}){const f=gc({from:n?.address,to:d,value:typeof h<"u"&&`${Bf(h)} ${s?.nativeCurrency?.symbol||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${an(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${an(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${an(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",f].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Ys extends W{constructor({cause:e,message:n}={}){const r=n?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(Ys,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(Ys,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Sl extends W{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${an(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(Sl,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class hh extends W{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${an(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(hh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class fh extends W{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(fh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class ph extends W{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(ph,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class gh extends W{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(gh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class mh extends W{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(mh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class yh extends W{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(yh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class wh extends W{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(wh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class bh extends W{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(bh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class Nl extends W{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${an(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${an(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(Nl,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class fu extends W{constructor({cause:e}){super(`An error occurred while executing: ${e?.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function qf(t,e){const n=(t.details||"").toLowerCase(),r=t instanceof W?t.walk(s=>s?.code===Ys.code):t;return r instanceof W?new Ys({cause:t,message:r.details}):Ys.nodeMessage.test(n)?new Ys({cause:t,message:t.details}):Sl.nodeMessage.test(n)?new Sl({cause:t,maxFeePerGas:e?.maxFeePerGas}):hh.nodeMessage.test(n)?new hh({cause:t,maxFeePerGas:e?.maxFeePerGas}):fh.nodeMessage.test(n)?new fh({cause:t,nonce:e?.nonce}):ph.nodeMessage.test(n)?new ph({cause:t,nonce:e?.nonce}):gh.nodeMessage.test(n)?new gh({cause:t,nonce:e?.nonce}):mh.nodeMessage.test(n)?new mh({cause:t}):yh.nodeMessage.test(n)?new yh({cause:t,gas:e?.gas}):wh.nodeMessage.test(n)?new wh({cause:t,gas:e?.gas}):bh.nodeMessage.test(n)?new bh({cause:t}):Nl.nodeMessage.test(n)?new Nl({cause:t,maxFeePerGas:e?.maxFeePerGas,maxPriorityFeePerGas:e?.maxPriorityFeePerGas}):new fu({cause:t})}function lI(t,{docsPath:e,...n}){const r=(()=>{const s=qf(t,n);return s instanceof fu?t:s})();return new cI(r,{docsPath:e,...n})}function Wf(t,{format:e}){if(!e)return{};const n={};function r(i){const o=Object.keys(i);for(const a of o)a in t&&(n[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&r(i[a])}const s=e(t||{});return r(s),n}const uI={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function zf(t){const e={};return typeof t.authorizationList<"u"&&(e.authorizationList=dI(t.authorizationList)),typeof t.accessList<"u"&&(e.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(e.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?e.blobs=t.blobs.map(n=>ln(n)):e.blobs=t.blobs),typeof t.data<"u"&&(e.data=t.data),typeof t.from<"u"&&(e.from=t.from),typeof t.gas<"u"&&(e.gas=Ae(t.gas)),typeof t.gasPrice<"u"&&(e.gasPrice=Ae(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(e.maxFeePerBlobGas=Ae(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(e.maxFeePerGas=Ae(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(e.maxPriorityFeePerGas=Ae(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(e.nonce=Ae(t.nonce)),typeof t.to<"u"&&(e.to=t.to),typeof t.type<"u"&&(e.type=uI[t.type]),typeof t.value<"u"&&(e.value=Ae(t.value)),e}function dI(t){return t.map(e=>({address:e.address,r:e.r?Ae(BigInt(e.r)):e.r,s:e.s?Ae(BigInt(e.s)):e.s,chainId:Ae(e.chainId),nonce:Ae(e.nonce),...typeof e.yParity<"u"?{yParity:Ae(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:Ae(e.v)}:{}}))}function p0(t){if(!(!t||t.length===0))return t.reduce((e,{slot:n,value:r})=>{if(n.length!==66)throw new s0({size:n.length,targetSize:66,type:"hex"});if(r.length!==66)throw new s0({size:r.length,targetSize:66,type:"hex"});return e[n]=r,e},{})}function hI(t){const{balance:e,nonce:n,state:r,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=Ae(e)),n!==void 0&&(o.nonce=Ae(n)),r!==void 0&&(o.state=p0(r)),s!==void 0){if(o.state)throw new jA;o.stateDiff=p0(s)}return o}function eb(t){if(!t)return;const e={};for(const{address:n,...r}of t){if(!Ar(n,{strict:!1}))throw new ci({address:n});if(e[n])throw new FA({address:n});e[n]=hI(r)}return e}const fI=2n**256n-1n;function pu(t){const{account:e,gasPrice:n,maxFeePerGas:r,maxPriorityFeePerGas:s,to:i}=t,o=e?Pr(e):void 0;if(o&&!Ar(o.address))throw new ci({address:o.address});if(i&&!Ar(i))throw new ci({address:i});if(typeof n<"u"&&(typeof r<"u"||typeof s<"u"))throw new qA;if(r&&r>fI)throw new Sl({maxFeePerGas:r});if(s&&r&&s>r)throw new Nl({maxFeePerGas:r,maxPriorityFeePerGas:s})}class pI extends W{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class Vf extends W{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class gI extends W{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${an(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class tb extends W{constructor({blockHash:e,blockNumber:n}){let r="Block";e&&(r=`Block at hash "${e}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`,{name:"BlockNotFoundError"})}}const nb={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function rb(t){const e={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?ai(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?ai(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?nb[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(e.authorizationList=mI(t.authorizationList)),e.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof e.v=="bigint"){if(e.v===0n||e.v===27n)return 0;if(e.v===1n||e.v===28n)return 1;if(e.v>=35n)return e.v%2n===0n?1:0}})(),e.type==="legacy"&&(delete e.accessList,delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas,delete e.yParity),e.type==="eip2930"&&(delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas),e.type==="eip1559"&&delete e.maxFeePerBlobGas,e}function mI(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function yI(t){const e=(t.transactions??[]).map(n=>typeof n=="string"?n:rb(n));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:e,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}async function ja(t,{blockHash:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest",includeTransactions:s}={}){const i=s??!1,o=n!==void 0?Ae(n):void 0;let a=null;if(e?a=await t.request({method:"eth_getBlockByHash",params:[e,i]},{dedupe:!0}):a=await t.request({method:"eth_getBlockByNumber",params:[o||r,i]},{dedupe:!!o}),!a)throw new tb({blockHash:e,blockNumber:n});return(t.chain?.formatters?.block?.format||yI)(a)}async function sb(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function Ej(t,e){return ib(t,e)}async function ib(t,e){const{block:n,chain:r=t.chain,request:s}=e||{};try{const i=r?.fees?.maxPriorityFeePerGas??r?.fees?.defaultPriorityFee;if(typeof i=="function"){const a=n||await Je(t,ja,"getBlock")({}),c=await i({block:a,client:t,request:s});if(c===null)throw new Error;return c}if(typeof i<"u")return i;const o=await t.request({method:"eth_maxPriorityFeePerGas"});return io(o)}catch{const[i,o]=await Promise.all([n?Promise.resolve(n):Je(t,ja,"getBlock")({}),Je(t,sb,"getGasPrice")({})]);if(typeof i.baseFeePerGas!="bigint")throw new Vf;const a=o-i.baseFeePerGas;return a<0n?0n:a}}async function vj(t,e){return Eh(t,e)}async function Eh(t,e){const{block:n,chain:r=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>typeof r?.fees?.baseFeeMultiplier=="function"?r.fees.baseFeeMultiplier({block:n,client:t,request:s}):r?.fees?.baseFeeMultiplier??1.2)();if(o<1)throw new pI;const c=10**(o.toString().split(".")[1]?.length??0),l=h=>h*BigInt(Math.ceil(o*c))/BigInt(c),u=n||await Je(t,ja,"getBlock")({});if(typeof r?.fees?.estimateFeesPerGas=="function"){const h=await r.fees.estimateFeesPerGas({block:n,client:t,multiply:l,request:s,type:i});if(h!==null)return h}if(i==="eip1559"){if(typeof u.baseFeePerGas!="bigint")throw new Vf;const h=typeof s?.maxPriorityFeePerGas=="bigint"?s.maxPriorityFeePerGas:await ib(t,{block:u,chain:r,request:s}),f=l(u.baseFeePerGas);return{maxFeePerGas:s?.maxFeePerGas??f+h,maxPriorityFeePerGas:h}}return{gasPrice:s?.gasPrice??l(await Je(t,sb,"getGasPrice")({}))}}async function wI(t,{address:e,blockTag:n="latest",blockNumber:r}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof r=="bigint"?Ae(r):n]},{dedupe:!!r});return ai(s)}function ob(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(i=>_r(i)):t.blobs,s=[];for(const i of r)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return n==="bytes"?s:s.map(i=>ln(i))}function ab(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(o=>_r(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>_r(o)):t.commitments,i=[];for(let o=0;o<r.length;o++){const a=r[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return n==="bytes"?i:i.map(o=>ln(o))}function bI(t,e){return uC(Ts(t,{strict:!1})?cu(t):t)}function EI(t){const{commitment:e,version:n=1}=t,r=t.to??(typeof e=="string"?"hex":"bytes"),s=bI(e);return s.set([n],0),r==="bytes"?s:ln(s)}function vI(t){const{commitments:e,version:n}=t,r=t.to,s=[];for(const i of e)s.push(EI({commitment:i,to:r,version:n}));return s}const g0=6,cb=32,Kf=4096,lb=cb*Kf,m0=lb*g0-1-1*Kf*g0;class CI extends W{constructor({maxSize:e,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class _I extends W{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function AI(t){const e=typeof t.data=="string"?_r(t.data):t.data,n=wt(e);if(!n)throw new _I;if(n>m0)throw new CI({maxSize:m0,size:n});const r=[];let s=!0,i=0;for(;s;){const o=Lf(new Uint8Array(lb));let a=0;for(;a<Kf;){const c=e.slice(i,i+(cb-1));if(o.pushByte(0),o.pushBytes(c),c.length<31){o.pushByte(128),s=!1;break}a++,i+=31}r.push(o)}return r.map(o=>ln(o.bytes))}function II(t){const{data:e,kzg:n,to:r}=t,s=t.blobs??AI({data:e}),i=t.commitments??ob({blobs:s,kzg:n,to:r}),o=t.proofs??ab({blobs:s,commitments:i,kzg:n,to:r}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function SI(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new WA({transaction:t})}async function ub(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return ai(e)}const db=["blobVersionedHashes","chainId","fees","gas","nonce","type"],y0=new Map;async function Gf(t,e){const{account:n=t.account,blobs:r,chain:s,gas:i,kzg:o,nonce:a,nonceManager:c,parameters:l=db,type:u}=e,d=n&&Pr(n),h={...e,...d?{from:d?.address}:{}};let f;async function p(){return f||(f=await Je(t,ja,"getBlock")({blockTag:"latest"}),f)}let g;async function m(){return g||(s?s.id:typeof e.chainId<"u"?e.chainId:(g=await Je(t,ub,"getChainId")({}),g))}if(l.includes("nonce")&&typeof a>"u"&&d)if(c){const b=await m();h.nonce=await c.consume({address:d.address,chainId:b,client:t})}else h.nonce=await Je(t,wI,"getTransactionCount")({address:d.address,blockTag:"pending"});if((l.includes("blobVersionedHashes")||l.includes("sidecars"))&&r&&o){const b=ob({blobs:r,kzg:o});if(l.includes("blobVersionedHashes")){const v=vI({commitments:b,to:"hex"});h.blobVersionedHashes=v}if(l.includes("sidecars")){const v=ab({blobs:r,commitments:b,kzg:o}),C=II({blobs:r,commitments:b,proofs:v,to:"hex"});h.sidecars=C}}if(l.includes("chainId")&&(h.chainId=await m()),(l.includes("fees")||l.includes("type"))&&typeof u>"u")try{h.type=SI(h)}catch{let b=y0.get(t.uid);typeof b>"u"&&(b=typeof(await p())?.baseFeePerGas=="bigint",y0.set(t.uid,b)),h.type=b?"eip1559":"legacy"}if(l.includes("fees"))if(h.type!=="legacy"&&h.type!=="eip2930"){if(typeof h.maxFeePerGas>"u"||typeof h.maxPriorityFeePerGas>"u"){const b=await p(),{maxFeePerGas:v,maxPriorityFeePerGas:C}=await Eh(t,{block:b,chain:s,request:h});if(typeof e.maxPriorityFeePerGas>"u"&&e.maxFeePerGas&&e.maxFeePerGas<C)throw new gI({maxPriorityFeePerGas:C});h.maxPriorityFeePerGas=C,h.maxFeePerGas=v}}else{if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")throw new Vf;if(typeof e.gasPrice>"u"){const b=await p(),{gasPrice:v}=await Eh(t,{block:b,chain:s,request:h,type:"legacy"});h.gasPrice=v}}return l.includes("gas")&&typeof i>"u"&&(h.gas=await Je(t,hb,"estimateGas")({...h,account:d&&{address:d.address,type:"json-rpc"}})),pu(h),delete h.parameters,h}async function hb(t,e){const{account:n=t.account}=e,r=n?Pr(n):void 0;try{const{accessList:s,authorizationList:i,blobs:o,blobVersionedHashes:a,blockNumber:c,blockTag:l,data:u,gas:d,gasPrice:h,maxFeePerBlobGas:f,maxFeePerGas:p,maxPriorityFeePerGas:g,nonce:m,value:b,stateOverride:v,...C}=await Gf(t,{...e,parameters:r?.type==="local"?void 0:["blobVersionedHashes"]}),y=(typeof c=="bigint"?Ae(c):void 0)||l,w=eb(v),S=await(async()=>{if(C.to)return C.to;if(i&&i.length>0)return await Qw({authorization:i[0]}).catch(()=>{throw new W("`to` is required. Could not infer from `authorizationList`")})})();pu(e);const P=t.chain?.formatters?.transactionRequest?.format,x=(P||zf)({...Wf(C,{format:P}),from:r?.address,accessList:s,authorizationList:i,blobs:o,blobVersionedHashes:a,data:u,gas:d,gasPrice:h,maxFeePerBlobGas:f,maxFeePerGas:p,maxPriorityFeePerGas:g,nonce:m,to:S,value:b});return BigInt(await t.request({method:"eth_estimateGas",params:w?[x,y??t.experimental_blockTag??"latest",w]:y?[x,y]:[x]}))}catch(s){throw lI(s,{...e,account:r,chain:t.chain})}}function NI(t,e){if(!Ar(t,{strict:!1}))throw new ci({address:t});if(!Ar(e,{strict:!1}))throw new ci({address:e});return t.toLowerCase()===e.toLowerCase()}const w0="/docs/contract/decodeEventLog";function TI(t){const{abi:e,data:n,strict:r,topics:s}=t,i=r??!0,[o,...a]=s;if(!o)throw new O_({docsPath:w0});const c=e.find(g=>g.type==="event"&&o===Of(Ns(g)));if(!(c&&"name"in c)||c.type!=="event")throw new Nw(o,{docsPath:w0});const{name:l,inputs:u}=c,d=u?.some(g=>!("name"in g&&g.name)),h=d?[]:{},f=u.map((g,m)=>[g,m]).filter(([g])=>"indexed"in g&&g.indexed);for(let g=0;g<f.length;g++){const[m,b]=f[g],v=a[g];if(!v)throw new Tw({abiItem:c,param:m});h[d?b:m.name||b]=PI({param:m,value:v})}const p=u.filter(g=>!("indexed"in g&&g.indexed));if(p.length>0){if(n&&n!=="0x")try{const g=hu(p,n);if(g)if(d)for(let m=0;m<u.length;m++)h[m]=h[m]??g.shift();else for(let m=0;m<p.length;m++)h[p[m].name]=g[m]}catch(g){if(i)throw g instanceof Iw||g instanceof Vw?new lh({abiItem:c,data:n,params:p,size:wt(n)}):g}else if(i)throw new lh({abiItem:c,data:"0x",params:p,size:0})}return{eventName:l,args:Object.values(h).length>0?h:void 0}}function PI({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(hu([t],e)||[])[0]}function xI(t){const{abi:e,args:n,logs:r,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return r.map(o=>{try{const a=e.find(l=>l.type==="event"&&o.topics[0]===Of(l));if(!a)return null;const c=TI({...o,abi:[a],strict:s});return i&&!i.includes(c.eventName)||!RI({args:c.args,inputs:a.inputs,matchArgs:n})?null:{...c,...o}}catch(a){let c,l;if(a instanceof Nw)return null;if(a instanceof lh||a instanceof Tw){if(s)return null;c=a.abiItem.name,l=a.abiItem.inputs?.some(u=>!("name"in u&&u.name))}return{...o,args:l?[]:{},eventName:c}}}).filter(Boolean)}function RI(t){const{args:e,inputs:n,matchArgs:r}=t;if(!r)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?NI(o,a):i.type==="string"||i.type==="bytes"?fc(cu(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(r)?r.every((i,o)=>{if(i==null)return!0;const a=n[o];return a?(Array.isArray(i)?i:[i]).some(l=>s(a,l,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).every(([i,o])=>{if(o==null)return!0;const a=n.find(l=>l.name===i);return a?(Array.isArray(o)?o:[o]).some(l=>s(a,l,e[i])):!1}):!1}function fb(t,{args:e,eventName:n}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...n?{args:e,eventName:n}:{}}}const Vu="/docs/contract/decodeFunctionResult";function Yf(t){const{abi:e,args:n,functionName:r,data:s}=t;let i=e[0];if(r){const a=Mf({abi:e,args:n,name:r});if(!a)throw new _l(r,{docsPath:Vu});i=a}if(i.type!=="function")throw new _l(void 0,{docsPath:Vu});if(!i.outputs)throw new k_(i.name,{docsPath:Vu});const o=hu(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const OI="0.1.1";function kI(){return OI}let vo=class vh extends Error{constructor(e,n={}){const r=(()=>{if(n.cause instanceof vh){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:n.cause?.message?n.cause.message:n.details})(),s=n.cause instanceof vh&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${kI()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return pb(this,e)}};function pb(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?pb(t.cause,e):e?null:t}function Zf(t,e){if(uo(t)>e)throw new WI({givenSize:uo(t),maxSize:e})}function DI(t,e){if(typeof e=="number"&&e>0&&e>uo(t)-1)throw new yb({offset:e,position:"start",size:uo(t)})}function $I(t,e,n){if(typeof e=="number"&&typeof n=="number"&&uo(t)!==n-e)throw new yb({offset:n,position:"end",size:uo(t)})}function gb(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new zI({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}const UI="#__bigint";function MI(t,e,n){return JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString()+UI:s,n)}const LI=new TextEncoder,BI=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function FI(t,e={}){const{strict:n=!1}=e;if(!t)throw new b0(t);if(typeof t!="string")throw new b0(t);if(n&&!/^0x[0-9a-fA-F]*$/.test(t))throw new E0(t);if(!t.startsWith("0x"))throw new E0(t)}function Cj(...t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function _j(t){return t instanceof Uint8Array?Ch(t):Array.isArray(t)?Ch(new Uint8Array(t)):t}function Aj(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Zf(n,e.size),mb(n,e.size)):n}function Ch(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=BI[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Zf(r,e.size),jI(r,e.size)):r}function qr(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new qI({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?mb(c,r):c}function Ij(t,e={}){return Ch(LI.encode(t),e)}function mb(t,e){return gb(t,{dir:"left",size:e})}function jI(t,e){return gb(t,{dir:"right",size:e})}function Sj(t,e,n,r={}){const{strict:s}=r;DI(t,e);const i=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return s&&$I(i,e,n),i}function uo(t){return Math.ceil((t.length-2)/2)}function HI(t,e={}){const{signed:n}=e;e.size&&Zf(t,e.size);const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n)-1n,o=i>>1n;return r<=o?r:r-i-1n}function Nj(t,e={}){const{signed:n,size:r}=e;return Number(!n&&!r?t:HI(t,e))}function Tj(t,e={}){const{strict:n=!1}=e;try{return FI(t,{strict:n}),!0}catch{return!1}}let qI=class extends vo{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}};class b0 extends vo{constructor(e){super(`Value \`${typeof e=="object"?MI(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class E0 extends vo{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}let WI=class extends vo{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed \`${n}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}};class yb extends vo{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}let zI=class extends vo{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};function VI(t){return{address:t.address,amount:qr(t.amount),index:qr(t.index),validatorIndex:qr(t.validatorIndex)}}function KI(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:qr(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:qr(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:qr(t.gasLimit)},...typeof t.number=="bigint"&&{number:qr(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:qr(t.prevRandao)},...typeof t.time=="bigint"&&{time:qr(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(VI)}}}const _h=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"getCurrentBlockTimestamp",outputs:[{internalType:"uint256",name:"timestamp",type:"uint256"}],stateMutability:"view",type:"function"}],Oj=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],wb=[{inputs:[{name:"dns",type:"bytes"}],name:"DNSDecodingFailed",type:"error"},{inputs:[{name:"ens",type:"string"}],name:"DNSEncodingFailed",type:"error"},{inputs:[],name:"EmptyAddress",type:"error"},{inputs:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"HttpError",type:"error"},{inputs:[],name:"InvalidBatchGatewayResponse",type:"error"},{inputs:[{name:"errorData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{name:"name",type:"bytes"},{name:"resolver",type:"address"}],name:"ResolverNotContract",type:"error"},{inputs:[{name:"name",type:"bytes"}],name:"ResolverNotFound",type:"error"},{inputs:[{name:"primary",type:"string"},{name:"primaryAddress",type:"bytes"}],name:"ReverseAddressMismatch",type:"error"},{inputs:[{internalType:"bytes4",name:"selector",type:"bytes4"}],name:"UnsupportedResolverProfile",type:"error"}],kj=[...wb,{name:"resolveWithGateways",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],Dj=[...wb,{name:"reverseWithGateways",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"uint256",name:"coinType"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolver"},{type:"address",name:"reverseResolver"}]}],$j=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],Uj=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],Mj=[{name:"isValidSignature",type:"function",stateMutability:"view",inputs:[{name:"hash",type:"bytes32"},{name:"signature",type:"bytes"}],outputs:[{name:"",type:"bytes4"}]}],Lj=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],Rc=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],GI="0x82ad56cb",YI="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",ZI="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",Bj="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572",bb="0x608060405234801561001057600080fd5b506115b9806100206000396000f3fe6080604052600436106100f35760003560e01c80634d2301cc1161008a578063a8b0574e11610059578063a8b0574e14610325578063bce38bd714610350578063c3077fa914610380578063ee82ac5e146103b2576100f3565b80634d2301cc1461026257806372425d9d1461029f57806382ad56cb146102ca57806386d516e8146102fa576100f3565b80633408e470116100c65780633408e470146101af578063399542e9146101da5780633e64a6961461020c57806342cbb15c14610237576100f3565b80630f28c97d146100f8578063174dea7114610123578063252dba421461015357806327e86d6e14610184575b600080fd5b34801561010457600080fd5b5061010d6103ef565b60405161011a9190610c0a565b60405180910390f35b61013d60048036038101906101389190610c94565b6103f7565b60405161014a9190610e94565b60405180910390f35b61016d60048036038101906101689190610f0c565b610615565b60405161017b92919061101b565b60405180910390f35b34801561019057600080fd5b506101996107ab565b6040516101a69190611064565b60405180910390f35b3480156101bb57600080fd5b506101c46107b7565b6040516101d19190610c0a565b60405180910390f35b6101f460048036038101906101ef91906110ab565b6107bf565b6040516102039392919061110b565b60405180910390f35b34801561021857600080fd5b506102216107e1565b60405161022e9190610c0a565b60405180910390f35b34801561024357600080fd5b5061024c6107e9565b6040516102599190610c0a565b60405180910390f35b34801561026e57600080fd5b50610289600480360381019061028491906111a7565b6107f1565b6040516102969190610c0a565b60405180910390f35b3480156102ab57600080fd5b506102b4610812565b6040516102c19190610c0a565b60405180910390f35b6102e460048036038101906102df919061122a565b61081a565b6040516102f19190610e94565b60405180910390f35b34801561030657600080fd5b5061030f6109e4565b60405161031c9190610c0a565b60405180910390f35b34801561033157600080fd5b5061033a6109ec565b6040516103479190611286565b60405180910390f35b61036a600480360381019061036591906110ab565b6109f4565b6040516103779190610e94565b60405180910390f35b61039a60048036038101906103959190610f0c565b610ba6565b6040516103a99392919061110b565b60405180910390f35b3480156103be57600080fd5b506103d960048036038101906103d491906112cd565b610bca565b6040516103e69190611064565b60405180910390f35b600042905090565b60606000808484905090508067ffffffffffffffff81111561041c5761041b6112fa565b5b60405190808252806020026020018201604052801561045557816020015b610442610bd5565b81526020019060019003908161043a5790505b5092503660005b828110156105c957600085828151811061047957610478611329565b5b6020026020010151905087878381811061049657610495611329565b5b90506020028101906104a89190611367565b925060008360400135905080860195508360000160208101906104cb91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16818580606001906104f2919061138f565b604051610500929190611431565b60006040518083038185875af1925050503d806000811461053d576040519150601f19603f3d011682016040523d82523d6000602084013e610542565b606091505b5083600001846020018290528215151515815250505081516020850135176105bc577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260846000fd5b826001019250505061045c565b5082341461060c576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610603906114a7565b60405180910390fd5b50505092915050565b6000606043915060008484905090508067ffffffffffffffff81111561063e5761063d6112fa565b5b60405190808252806020026020018201604052801561067157816020015b606081526020019060019003908161065c5790505b5091503660005b828110156107a157600087878381811061069557610694611329565b5b90506020028101906106a791906114c7565b92508260000160208101906106bc91906111a7565b73ffffffffffffffffffffffffffffffffffffffff168380602001906106e2919061138f565b6040516106f0929190611431565b6000604051808303816000865af19150503d806000811461072d576040519150601f19603f3d011682016040523d82523d6000602084013e610732565b606091505b5086848151811061074657610745611329565b5b60200260200101819052819250505080610795576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161078c9061153b565b60405180910390fd5b81600101915050610678565b5050509250929050565b60006001430340905090565b600046905090565b6000806060439250434091506107d68686866109f4565b905093509350939050565b600048905090565b600043905090565b60008173ffffffffffffffffffffffffffffffffffffffff16319050919050565b600044905090565b606060008383905090508067ffffffffffffffff81111561083e5761083d6112fa565b5b60405190808252806020026020018201604052801561087757816020015b610864610bd5565b81526020019060019003908161085c5790505b5091503660005b828110156109db57600084828151811061089b5761089a611329565b5b602002602001015190508686838181106108b8576108b7611329565b5b90506020028101906108ca919061155b565b92508260000160208101906108df91906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060400190610905919061138f565b604051610913929190611431565b6000604051808303816000865af19150503d8060008114610950576040519150601f19603f3d011682016040523d82523d6000602084013e610955565b606091505b5082600001836020018290528215151515815250505080516020840135176109cf577f08c379a000000000000000000000000000000000000000000000000000000000600052602060045260176024527f4d756c746963616c6c333a2063616c6c206661696c656400000000000000000060445260646000fd5b8160010191505061087e565b50505092915050565b600045905090565b600041905090565b606060008383905090508067ffffffffffffffff811115610a1857610a176112fa565b5b604051908082528060200260200182016040528015610a5157816020015b610a3e610bd5565b815260200190600190039081610a365790505b5091503660005b82811015610b9c576000848281518110610a7557610a74611329565b5b60200260200101519050868683818110610a9257610a91611329565b5b9050602002810190610aa491906114c7565b9250826000016020810190610ab991906111a7565b73ffffffffffffffffffffffffffffffffffffffff16838060200190610adf919061138f565b604051610aed929190611431565b6000604051808303816000865af19150503d8060008114610b2a576040519150601f19603f3d011682016040523d82523d6000602084013e610b2f565b606091505b508260000183602001829052821515151581525050508715610b90578060000151610b8f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b869061153b565b60405180910390fd5b5b81600101915050610a58565b5050509392505050565b6000806060610bb7600186866107bf565b8093508194508295505050509250925092565b600081409050919050565b6040518060400160405280600015158152602001606081525090565b6000819050919050565b610c0481610bf1565b82525050565b6000602082019050610c1f6000830184610bfb565b92915050565b600080fd5b600080fd5b600080fd5b600080fd5b600080fd5b60008083601f840112610c5457610c53610c2f565b5b8235905067ffffffffffffffff811115610c7157610c70610c34565b5b602083019150836020820283011115610c8d57610c8c610c39565b5b9250929050565b60008060208385031215610cab57610caa610c25565b5b600083013567ffffffffffffffff811115610cc957610cc8610c2a565b5b610cd585828601610c3e565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b60008115159050919050565b610d2281610d0d565b82525050565b600081519050919050565b600082825260208201905092915050565b60005b83811015610d62578082015181840152602081019050610d47565b83811115610d71576000848401525b50505050565b6000601f19601f8301169050919050565b6000610d9382610d28565b610d9d8185610d33565b9350610dad818560208601610d44565b610db681610d77565b840191505092915050565b6000604083016000830151610dd96000860182610d19565b5060208301518482036020860152610df18282610d88565b9150508091505092915050565b6000610e0a8383610dc1565b905092915050565b6000602082019050919050565b6000610e2a82610ce1565b610e348185610cec565b935083602082028501610e4685610cfd565b8060005b85811015610e825784840389528151610e638582610dfe565b9450610e6e83610e12565b925060208a01995050600181019050610e4a565b50829750879550505050505092915050565b60006020820190508181036000830152610eae8184610e1f565b905092915050565b60008083601f840112610ecc57610ecb610c2f565b5b8235905067ffffffffffffffff811115610ee957610ee8610c34565b5b602083019150836020820283011115610f0557610f04610c39565b5b9250929050565b60008060208385031215610f2357610f22610c25565b5b600083013567ffffffffffffffff811115610f4157610f40610c2a565b5b610f4d85828601610eb6565b92509250509250929050565b600081519050919050565b600082825260208201905092915050565b6000819050602082019050919050565b6000610f918383610d88565b905092915050565b6000602082019050919050565b6000610fb182610f59565b610fbb8185610f64565b935083602082028501610fcd85610f75565b8060005b858110156110095784840389528151610fea8582610f85565b9450610ff583610f99565b925060208a01995050600181019050610fd1565b50829750879550505050505092915050565b60006040820190506110306000830185610bfb565b81810360208301526110428184610fa6565b90509392505050565b6000819050919050565b61105e8161104b565b82525050565b60006020820190506110796000830184611055565b92915050565b61108881610d0d565b811461109357600080fd5b50565b6000813590506110a58161107f565b92915050565b6000806000604084860312156110c4576110c3610c25565b5b60006110d286828701611096565b935050602084013567ffffffffffffffff8111156110f3576110f2610c2a565b5b6110ff86828701610eb6565b92509250509250925092565b60006060820190506111206000830186610bfb565b61112d6020830185611055565b818103604083015261113f8184610e1f565b9050949350505050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061117482611149565b9050919050565b61118481611169565b811461118f57600080fd5b50565b6000813590506111a18161117b565b92915050565b6000602082840312156111bd576111bc610c25565b5b60006111cb84828501611192565b91505092915050565b60008083601f8401126111ea576111e9610c2f565b5b8235905067ffffffffffffffff81111561120757611206610c34565b5b60208301915083602082028301111561122357611222610c39565b5b9250929050565b6000806020838503121561124157611240610c25565b5b600083013567ffffffffffffffff81111561125f5761125e610c2a565b5b61126b858286016111d4565b92509250509250929050565b61128081611169565b82525050565b600060208201905061129b6000830184611277565b92915050565b6112aa81610bf1565b81146112b557600080fd5b50565b6000813590506112c7816112a1565b92915050565b6000602082840312156112e3576112e2610c25565b5b60006112f1848285016112b8565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052603260045260246000fd5b600080fd5b600080fd5b600080fd5b60008235600160800383360303811261138357611382611358565b5b80830191505092915050565b600080833560016020038436030381126113ac576113ab611358565b5b80840192508235915067ffffffffffffffff8211156113ce576113cd61135d565b5b6020830192506001820236038313156113ea576113e9611362565b5b509250929050565b600081905092915050565b82818337600083830152505050565b600061141883856113f2565b93506114258385846113fd565b82840190509392505050565b600061143e82848661140c565b91508190509392505050565b600082825260208201905092915050565b7f4d756c746963616c6c333a2076616c7565206d69736d61746368000000000000600082015250565b6000611491601a8361144a565b915061149c8261145b565b602082019050919050565b600060208201905081810360008301526114c081611484565b9050919050565b6000823560016040038336030381126114e3576114e2611358565b5b80830191505092915050565b7f4d756c746963616c6c333a2063616c6c206661696c6564000000000000000000600082015250565b600061152560178361144a565b9150611530826114ef565b602082019050919050565b6000602082019050818103600083015261155481611518565b9050919050565b60008235600160600383360303811261157757611576611358565b5b8083019150509291505056fea264697066735822122020c1bc9aacf8e4a6507193432a895a8e77094f45a1395583f07b24e860ef06cd64736f6c634300080c0033";class Ah extends W{constructor({blockNumber:e,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class JI extends W{constructor({chain:e,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${e.id}  ${e.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e.id}  ${e.name}`],name:"ChainMismatchError"})}}class XI extends W{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class Eb extends W{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}const Ku="/docs/contract/encodeDeployData";function vb(t){const{abi:e,args:n,bytecode:r}=t;if(!n||n.length===0)return r;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new T_({docsPath:Ku});if(!("inputs"in s))throw new r0({docsPath:Ku});if(!s.inputs||s.inputs.length===0)throw new r0({docsPath:Ku});const i=Ww(s.inputs,n);return uu([r,i])}function Cb({blockNumber:t,chain:e,contract:n}){const r=e?.contracts?.[n];if(!r)throw new Ah({chain:e,contract:{name:n}});if(t&&r.blockCreated&&r.blockCreated>t)throw new Ah({blockNumber:t,chain:e,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function QI(t,{docsPath:e,...n}){const r=(()=>{const s=qf(t,n);return s instanceof fu?t:s})();return new GA(r,{docsPath:e,...n})}function _b(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const Gu=new Map;function Ab({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&t(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let f=0;f<u.length;f++){const{resolve:p}=u[f];p?.([h[f],h])}}).catch(h=>{for(let f=0;f<u.length;f++){const{reject:p}=u[f];p?.(h)}})},o=()=>Gu.delete(e),a=()=>c().map(({args:u})=>u),c=()=>Gu.get(e)||[],l=u=>Gu.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:f}=_b();return n?.([...a(),u])&&i(),c().length>0?(l({args:u,resolve:h,reject:f}),d):(l({args:u,resolve:h,reject:f}),setTimeout(i,r),d)}}}async function Ib(t,e){const{account:n=t.account,authorizationList:r,batch:s=!!t.batch?.multicall,blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",accessList:a,blobs:c,blockOverrides:l,code:u,data:d,factory:h,factoryData:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:b,maxPriorityFeePerGas:v,nonce:C,to:N,value:y,stateOverride:w,...S}=e,P=n?Pr(n):void 0;if(u&&(h||f))throw new W("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(u&&N)throw new W("Cannot provide both `code` & `to` as parameters.");const A=u&&d,x=h&&f&&N&&d,R=A||x,O=A?Sb({code:u,data:d}):x?n2({data:d,factory:h,factoryData:f,to:N}):d;try{pu(e);const $=(typeof i=="bigint"?Ae(i):void 0)||o,I=l?KI(l):void 0,T=eb(w),k=t.chain?.formatters?.transactionRequest?.format,U=(k||zf)({...Wf(S,{format:k}),from:P?.address,accessList:a,authorizationList:r,blobs:c,data:O,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:b,maxPriorityFeePerGas:v,nonce:C,to:R?void 0:N,value:y});if(s&&e2({request:U})&&!T&&!I)try{return await t2(t,{...U,blockNumber:i,blockTag:o})}catch(z){if(!(z instanceof Eb)&&!(z instanceof Ah))throw z}const M=(()=>{const z=[U,$];return T&&I?[...z,T,I]:T?[...z,T]:I?[...z,{},I]:z})(),H=await t.request({method:"eth_call",params:M});return H==="0x"?{data:void 0}:{data:H}}catch(L){const $=r2(L),{offchainLookup:I,offchainLookupSignature:T}=await dt(async()=>{const{offchainLookup:k,offchainLookupSignature:B}=await import("./Bmv5LrBQ.js");return{offchainLookup:k,offchainLookupSignature:B}},__vite__mapDeps([3,4]),import.meta.url);if(t.ccipRead!==!1&&$?.slice(0,10)===T&&N)return{data:await I(t,{data:$,to:N})};throw R&&$?.slice(0,10)==="0x101bb98d"?new JA({factory:h}):QI(L,{...e,account:P,chain:t.chain})}}function e2({request:t}){const{data:e,to:n,...r}=t;return!(!e||e.startsWith(GI)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function t2(t,e){const{batchSize:n=1024,deployless:r=!1,wait:s=0}=typeof t.batch?.multicall=="object"?t.batch.multicall:{},{blockNumber:i,blockTag:o=t.experimental_blockTag??"latest",data:a,to:c}=e,l=(()=>{if(r)return null;if(e.multicallAddress)return e.multicallAddress;if(t.chain)return Cb({blockNumber:i,chain:t.chain,contract:"multicall3"});throw new Eb})(),d=(typeof i=="bigint"?Ae(i):void 0)||o,{schedule:h}=Ab({id:`${t.uid}.${d}`,wait:s,shouldSplitBatch(g){return g.reduce((b,{data:v})=>b+(v.length-2),0)>n*2},fn:async g=>{const m=g.map(C=>({allowFailure:!0,callData:C.data,target:C.to})),b=du({abi:_h,args:[m],functionName:"aggregate3"}),v=await t.request({method:"eth_call",params:[{...l===null?{data:Sb({code:bb,data:b})}:{to:l,data:b}},d]});return Yf({abi:_h,args:[m],functionName:"aggregate3",data:v||"0x"})}}),[{returnData:f,success:p}]=await h({data:a,to:c});if(!p)throw new jf({data:f});return f==="0x"?{data:void 0}:{data:f}}function Sb(t){const{code:e,data:n}=t;return vb({abi:Cw(["constructor(bytes, bytes)"]),bytecode:YI,args:[e,n]})}function n2(t){const{data:e,factory:n,factoryData:r,to:s}=t;return vb({abi:Cw(["constructor(address, bytes, address, bytes)"]),bytecode:ZI,args:[s,e,n,r]})}function r2(t){if(!(t instanceof W))return;const e=t.walk();return typeof e?.data=="object"?e.data?.data:e.data}async function Nb(t,e){const{abi:n,address:r,args:s,functionName:i,...o}=e,a=du({abi:n,args:s,functionName:i});try{const{data:c}=await Je(t,Ib,"call")({...o,data:a,to:r});return Yf({abi:n,args:s,functionName:i,data:c||"0x"})}catch(c){throw Il(c,{abi:n,address:r,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}const Yu=new Map,v0=new Map;let s2=0;function Tl(t,e,n){const r=++s2,s=()=>Yu.get(t)||[],i=()=>{const u=s();Yu.set(t,u.filter(d=>d.id!==r))},o=()=>{const u=s();if(!u.some(h=>h.id===r))return;const d=v0.get(t);if(u.length===1&&d){const h=d();h instanceof Promise&&h.catch(()=>{})}i()},a=s();if(Yu.set(t,[...a,{id:r,fns:e}]),a&&a.length>0)return o;const c={};for(const u in e)c[u]=((...d)=>{const h=s();if(h.length!==0)for(const f of h)f.fns[u]?.(...d)});const l=n(c);return typeof l=="function"&&v0.set(t,l),o}async function Pl(t){return new Promise(e=>setTimeout(e,t))}function Tb(t,{emitOnBegin:e,initialWaitTime:n,interval:r}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await n?.(a)??r;await Pl(c);const l=async()=>{s&&(await t({unpoll:i}),await Pl(r),l())};l()})(),i}const i2=new Map,o2=new Map;function a2(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),n=e(t,i2),r=e(t,o2);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function c2(t,{cacheKey:e,cacheTime:n=Number.POSITIVE_INFINITY}){const r=a2(e),s=r.response.get();if(s&&n>0&&Date.now()-s.created.getTime()<n)return s.data;let i=r.promise.get();i||(i=t(),r.promise.set(i));try{const o=await i;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const l2=t=>`blockNumber.${t}`;async function u2(t,{cacheTime:e=t.cacheTime}={}){const n=await c2(()=>t.request({method:"eth_blockNumber"}),{cacheKey:l2(t.uid),cacheTime:e});return BigInt(n)}async function d2(t,{filter:e}){const n="strict"in e&&e.strict,r=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof r[0]=="string")return r;const s=r.map(i=>fb(i));return!("abi"in e)||!e.abi?s:xI({abi:e.abi,logs:s,strict:n})}async function h2(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}class Jf extends W{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class Zu extends W{constructor({docsPath:e,metaMessages:n,type:r}){super(`Account type "${r}" is not supported.`,{docsPath:e,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function f2({chain:t,currentChainId:e}){if(!t)throw new XI;if(e!==t.id)throw new JI({chain:t,currentChainId:e})}function p2(t,{docsPath:e,...n}){const r=(()=>{const s=qf(t,n);return s instanceof fu?t:s})();return new zA(r,{docsPath:e,...n})}async function g2(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const Ju=new lu(128);async function Pb(t,e){const{account:n=t.account,chain:r=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,type:p,value:g,...m}=e;if(typeof n>"u")throw new Jf({docsPath:"/docs/actions/wallet/sendTransaction"});const b=n?Pr(n):null;try{pu(e);const v=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await Qw({authorization:i[0]}).catch(()=>{throw new W("`to` is required. Could not infer from `authorizationList`.")})})();if(b?.type==="json-rpc"||b===null){let C;r!==null&&(C=await Je(t,ub,"getChainId")({}),f2({currentChainId:C,chain:r}));const N=t.chain?.formatters?.transactionRequest?.format,w=(N||zf)({...Wf(m,{format:N}),accessList:s,authorizationList:i,blobs:o,chainId:C,data:a,from:b?.address,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,to:v,type:p,value:g}),S=Ju.get(t.uid),P=S?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:P,params:[w]},{retryCount:0})}catch(A){if(S===!1)throw A;const x=A;if(x.name==="InvalidInputRpcError"||x.name==="InvalidParamsRpcError"||x.name==="MethodNotFoundRpcError"||x.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[w]},{retryCount:0}).then(R=>(Ju.set(t.uid,!0),R)).catch(R=>{const O=R;throw O.name==="MethodNotFoundRpcError"||O.name==="MethodNotSupportedRpcError"?(Ju.set(t.uid,!1),x):O});throw x}}if(b?.type==="local"){const C=await Je(t,Gf,"prepareTransactionRequest")({account:b,accessList:s,authorizationList:i,blobs:o,chain:r,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,nonceManager:b.nonceManager,parameters:[...db,"sidecars"],type:p,value:g,...m,to:v}),N=r?.serializers?.transaction,y=await b.signTransaction(C,{serializer:N});return await Je(t,g2,"sendRawTransaction")({serializedTransaction:y})}throw b?.type==="smart"?new Zu({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new Zu({docsPath:"/docs/actions/wallet/sendTransaction",type:b?.type})}catch(v){throw v instanceof Zu?v:p2(v,{...e,account:b,chain:e.chain||void 0})}}async function m2(t,e){const{abi:n,account:r=t.account,address:s,args:i,dataSuffix:o,functionName:a,...c}=e;if(typeof r>"u")throw new Jf({docsPath:"/docs/contract/writeContract"});const l=r?Pr(r):null,u=du({abi:n,args:i,functionName:a});try{return await Je(t,Pb,"sendTransaction")({data:`${u}${o?o.replace("0x",""):""}`,to:s,account:l,...c})}catch(d){throw Il(d,{abi:n,address:s,args:i,docsPath:"/docs/contract/writeContract",functionName:a,sender:l?.address})}}function xl(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await Pl(u),o({count:a+1})};try{const l=await t();s(l)}catch(l){if(a<n&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}const y2={"0x0":"reverted","0x1":"success"};function w2(t){const e={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(n=>fb(n)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?ai(t.transactionIndex):null,status:t.status?y2[t.status]:null,type:t.type?nb[t.type]||t.type:null};return t.blobGasPrice&&(e.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(e.blobGasUsed=BigInt(t.blobGasUsed)),e}const Ih=256;let Oc=Ih,kc;function xb(t=11){if(!kc||Oc+t>Ih*2){kc="",Oc=0;for(let e=0;e<Ih;e++)kc+=(256+Math.random()*256|0).toString(16).substring(1)}return kc.substring(Oc,Oc+++t)}function Rb(t){const{batch:e,chain:n,ccipRead:r,key:s="base",name:i="Base Client",type:o="base"}=t,a=t.experimental_blockTag??(typeof n?.experimental_preconfirmationTime=="number"?"pending":void 0),c=n?.blockTime??12e3,l=Math.min(Math.max(Math.floor(c/2),500),4e3),u=t.pollingInterval??l,d=t.cacheTime??u,h=t.account?Pr(t.account):void 0,{config:f,request:p,value:g}=t.transport({chain:n,pollingInterval:u}),m={...f,...g},b={account:h,batch:e,cacheTime:d,ccipRead:r,chain:n,key:s,name:i,pollingInterval:u,request:p,transport:m,type:o,uid:xb(),...a?{experimental_blockTag:a}:{}};function v(C){return N=>{const y=N(C);for(const S in b)delete y[S];const w={...C,...y};return Object.assign(w,{extend:v(w)})}}return Object.assign(b,{extend:v(b)})}async function b2(t){const e=bA(t,{method:"eth_newPendingTransactionFilter"}),n=await t.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:e(n),type:"transaction"}}async function E2(t,{address:e,blockNumber:n,blockTag:r=t.experimental_blockTag??"latest"}){const s=typeof n=="bigint"?Ae(n):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||r]});return BigInt(i)}const Dc=new lu(8192);function v2(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(Dc.get(n))return Dc.get(n);const r=t().finally(()=>Dc.delete(n));return Dc.set(n,r),r}function C2(t,e={}){return async(n,r={})=>{const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:l}=n;if(i?.exclude?.includes(l))throw new Gs(new Error("method not supported"),{method:l});if(i?.include&&!i.include.includes(l))throw new Gs(new Error("method not supported"),{method:l});const u=s?au(`${c}.${Dn(n)}`):void 0;return v2(()=>xl(async()=>{try{return await t(n)}catch(d){const h=d;switch(h.code){case _a.code:throw new _a(h);case Aa.code:throw new Aa(h);case Ia.code:throw new Ia(h,{method:n.method});case Sa.code:throw new Sa(h);case li.code:throw new li(h);case Na.code:throw new Na(h);case Ta.code:throw new Ta(h);case As.code:throw new As(h);case co.code:throw new co(h);case Gs.code:throw new Gs(h,{method:n.method});case lo.code:throw new lo(h);case Pa.code:throw new Pa(h);case ot.code:throw new ot(h);case xa.code:throw new xa(h);case Ra.code:throw new Ra(h);case Oa.code:throw new Oa(h);case ka.code:throw new ka(h);case Ir.code:throw new Ir(h);case Da.code:throw new Da(h);case $a.code:throw new $a(h);case Ua.code:throw new Ua(h);case Ma.code:throw new Ma(h);case La.code:throw new La(h);case Ba.code:throw new Ba(h);case Fa.code:throw new Fa(h);case 5e3:throw new ot(h);default:throw d instanceof W?d:new QA(h)}}},{delay:({count:d,error:h})=>{if(h&&h instanceof sa){const f=h?.headers?.get("Retry-After");if(f?.match(/\d/))return Number.parseInt(f,10)*1e3}return~~(1<<d)*o},retryCount:a,shouldRetry:({error:d})=>_2(d)}),{enabled:s,id:u})}}function _2(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===lo.code||t.code===li.code:t instanceof sa&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function A2(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}function Ob(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r?a.abort():i(e)},n)),s(await t({signal:a?.signal||null}))}catch(a){a?.name==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function I2(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const C0=I2();function S2(t,e={}){return{async request(n){const{body:r,fetchFn:s=e.fetchFn??fetch,onRequest:i=e.onRequest,onResponse:o=e.onResponse,timeout:a=e.timeout??1e4}=n,c={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:l,method:u,signal:d}=c;try{const h=await Ob(async({signal:p})=>{const g={...c,body:Array.isArray(r)?Dn(r.map(C=>({jsonrpc:"2.0",id:C.id??C0.take(),...C}))):Dn({jsonrpc:"2.0",id:r.id??C0.take(),...r}),headers:{"Content-Type":"application/json",...l},method:u||"POST",signal:d||(a>0?p:null)},m=new Request(t,g),b=await i?.(m,g)??{...g,url:t};return await s(b.url??t,b)},{errorInstance:new h0({body:r,url:t}),timeout:a,signal:!0});o&&await o(h);let f;if(h.headers.get("Content-Type")?.startsWith("application/json"))f=await h.json();else{f=await h.text();try{f=JSON.parse(f||"{}")}catch(p){if(h.ok)throw p;f={error:f}}}if(!h.ok)throw new sa({body:r,details:Dn(f.error)||h.statusText,headers:h.headers,status:h.status,url:t});return f}catch(h){throw h instanceof sa||h instanceof h0?h:new sa({body:r,cause:h,url:t})}}}}class N2 extends W{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function T2(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new N2({value:t});let[n,r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[i,o,a]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],c=Math.round(+`${o}.${a}`);c>9?r=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):r=`${i}${c}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}async function kb(t,{blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){const o=r||"latest",a=n!==void 0?Ae(n):void 0;let c=null;if(s?c=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?c=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,Ae(i)]},{dedupe:!0}):c=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[a||o,Ae(i)]},{dedupe:!!a}),!c)throw new Gw({blockHash:e,blockNumber:n,blockTag:o,hash:s,index:i});return(t.chain?.formatters?.transaction?.format||rb)(c)}async function Xu(t,{hash:e}){const n=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!n)throw new Yw({hash:e});return(t.chain?.formatters?.transactionReceipt?.format||w2)(n)}async function P2(t,e){const{account:n,authorizationList:r,allowFailure:s=!0,blockNumber:i,blockOverrides:o,blockTag:a,stateOverride:c}=e,l=e.contracts,{batchSize:u=e.batchSize??1024,deployless:d=e.deployless??!1}=typeof t.batch?.multicall=="object"?t.batch.multicall:{},h=(()=>{if(e.multicallAddress)return e.multicallAddress;if(d)return null;if(t.chain)return Cb({blockNumber:i,chain:t.chain,contract:"multicall3"});throw new Error("client chain not configured. multicallAddress is required.")})(),f=[[]];let p=0,g=0;for(let v=0;v<l.length;v++){const{abi:C,address:N,args:y,functionName:w}=l[v];try{const S=du({abi:C,args:y,functionName:w});g+=(S.length-2)/2,u>0&&g>u&&f[p].length>0&&(p++,g=(S.length-2)/2,f[p]=[]),f[p]=[...f[p],{allowFailure:!0,callData:S,target:N}]}catch(S){const P=Il(S,{abi:C,address:N,args:y,docsPath:"/docs/contract/multicall",functionName:w,sender:n});if(!s)throw P;f[p]=[...f[p],{allowFailure:!0,callData:"0x",target:N}]}}const m=await Promise.allSettled(f.map(v=>Je(t,Nb,"readContract")({...h===null?{code:bb}:{address:h},abi:_h,account:n,args:[v],authorizationList:r,blockNumber:i,blockOverrides:o,blockTag:a,functionName:"aggregate3",stateOverride:c}))),b=[];for(let v=0;v<m.length;v++){const C=m[v];if(C.status==="rejected"){if(!s)throw C.reason;for(let y=0;y<f[v].length;y++)b.push({status:"failure",error:C.reason,result:void 0});continue}const N=C.value;for(let y=0;y<N.length;y++){const{returnData:w,success:S}=N[y],{callData:P}=f[v][y],{abi:A,address:x,functionName:R,args:O}=l[b.length];try{if(P==="0x")throw new ou;if(!S)throw new jf({data:w});const L=Yf({abi:A,args:O,data:w,functionName:R});b.push(s?{result:L,status:"success"}:L)}catch(L){const $=Il(L,{abi:A,address:x,args:O,docsPath:"/docs/contract/multicall",functionName:R});if(!s)throw $;b.push({error:$,result:void 0,status:"failure"})}}}if(b.length!==l.length)throw new W("multicall results mismatch");return b}function x2(t,{emitOnBegin:e=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc"));let c;return a?(()=>{const d=Dn(["watchBlockNumber",t.uid,e,n,o]);return Tl(d,{onBlockNumber:r,onError:s},h=>Tb(async()=>{try{const f=await Je(t,u2,"getBlockNumber")({cacheTime:0});if(c!==void 0){if(f===c)return;if(f-c>1&&n)for(let p=c+1n;p<f;p++)h.onBlockNumber(p,c),c=p}(c===void 0||f>c)&&(h.onBlockNumber(f,c),c=f)}catch(f){h.onError?.(f)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=Dn(["watchBlockNumber",t.uid,e,n]);return Tl(d,{onBlockNumber:r,onError:s},h=>{let f=!0,p=()=>f=!1;return(async()=>{try{const g=(()=>{if(t.transport.type==="fallback"){const b=t.transport.transports.find(v=>v.config.type==="webSocket"||v.config.type==="ipc");return b?b.value:t.transport}return t.transport})(),{unsubscribe:m}=await g.subscribe({params:["newHeads"],onData(b){if(!f)return;const v=io(b.result?.number);h.onBlockNumber(v,c),c=v},onError(b){h.onError?.(b)}});p=m,f||p()}catch(g){s?.(g)}})(),()=>p()})})()}async function R2(t,e){const{checkReplacement:n=!0,confirmations:r=1,hash:s,onReplaced:i,retryCount:o=6,retryDelay:a=({count:y})=>~~(1<<y)*200,timeout:c=18e4}=e,l=Dn(["waitForTransactionReceipt",t.uid,s]),u=e.pollingInterval?e.pollingInterval:t.chain?.experimental_preconfirmationTime?t.chain.experimental_preconfirmationTime:t.pollingInterval;let d,h,f,p=!1,g,m;const{promise:b,resolve:v,reject:C}=_b(),N=c?setTimeout(()=>{m?.(),g?.(),C(new VA({hash:s}))},c):void 0;return g=Tl(l,{onReplaced:i,resolve:v,reject:C},async y=>{if(f=await Je(t,Xu,"getTransactionReceipt")({hash:s}).catch(()=>{}),f&&r<=1){clearTimeout(N),y.resolve(f),g?.();return}m=Je(t,x2,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:u,async onBlockNumber(w){const S=A=>{clearTimeout(N),m?.(),A(),g?.()};let P=w;if(!p)try{if(f){if(r>1&&(!f.blockNumber||P-f.blockNumber+1n<r))return;S(()=>y.resolve(f));return}if(n&&!d&&(p=!0,await xl(async()=>{d=await Je(t,kb,"getTransaction")({hash:s}),d.blockNumber&&(P=d.blockNumber)},{delay:a,retryCount:o}),p=!1),f=await Je(t,Xu,"getTransactionReceipt")({hash:s}),r>1&&(!f.blockNumber||P-f.blockNumber+1n<r))return;S(()=>y.resolve(f))}catch(A){if(A instanceof Gw||A instanceof Yw){if(!d){p=!1;return}try{h=d,p=!0;const x=await xl(()=>Je(t,ja,"getBlock")({blockNumber:P,includeTransactions:!0}),{delay:a,retryCount:o,shouldRetry:({error:L})=>L instanceof tb});p=!1;const R=x.transactions.find(({from:L,nonce:$})=>L===h.from&&$===h.nonce);if(!R||(f=await Je(t,Xu,"getTransactionReceipt")({hash:R.hash}),r>1&&(!f.blockNumber||P-f.blockNumber+1n<r)))return;let O="replaced";R.to===h.to&&R.value===h.value&&R.input===h.input?O="repriced":R.from===R.to&&R.value===0n&&(O="cancelled"),S(()=>{y.onReplaced?.({reason:O,replacedTransaction:h,transaction:R,transactionReceipt:f}),y.resolve(f)})}catch(x){S(()=>y.reject(x))}}else S(()=>y.reject(A))}}})}),b}function O2(t,{batch:e=!0,onError:n,onTransactions:r,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket"&&t.transport.type!=="ipc")?(()=>{const l=Dn(["watchPendingTransactions",t.uid,e,i]);return Tl(l,{onTransactions:r,onError:n},u=>{let d;const h=Tb(async()=>{try{if(!d)try{d=await Je(t,b2,"createPendingTransactionFilter")({});return}catch(p){throw h(),p}const f=await Je(t,d2,"getFilterChanges")({filter:d});if(f.length===0)return;if(e)u.onTransactions(f);else for(const p of f)u.onTransactions([p])}catch(f){u.onError?.(f)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await Je(t,h2,"uninstallFilter")({filter:d}),h()}})})():(()=>{let l=!0,u=()=>l=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(h){if(!l)return;const f=h.result;r([f])},onError(h){n?.(h)}});u=d,l||u()}catch(d){n?.(d)}})(),()=>u()})()}async function k2(t,{account:e=t.account,message:n}){if(!e)throw new Jf({docsPath:"/docs/actions/wallet/signMessage"});const r=Pr(e);if(r.signMessage)return r.signMessage({message:n});const s=typeof n=="string"?au(n):n.raw instanceof Uint8Array?oo(n.raw):n.raw;return t.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}function Xf({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=xb();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:C2(r,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function D2(t,e={}){const{key:n="custom",methods:r,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>Xf({key:n,methods:r,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function _0(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=$2,retryCount:o,retryDelay:a}=e;return(({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=t,f=()=>{};const p=Xf({key:n,name:r,async request({method:g,params:m}){let b;const v=async(C=0)=>{const N=h[C]({...d,chain:c,retryCount:0,timeout:u});try{const y=await N.request({method:g,params:m});return f({method:g,params:m,response:y,transport:N,status:"success"}),y}catch(y){if(f({error:y,method:g,params:m,transport:N,status:"error"}),i(y)||C===h.length-1||(b??=h.slice(C+1).some(w=>{const{include:S,exclude:P}=w({chain:c}).config.methods||{};return S?S.includes(g):P?!P.includes(g):!0}),!b))throw y;return v(C+1)}};return v()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>f=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};U2({chain:c,interval:g.interval??l,onTransports:m=>h=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return p})}function $2(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===co.code||t.code===ot.code||Ys.nodeMessage.test(t.message)||t.code===5e3))}function U2({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const m=g({chain:t,retryCount:0,timeout:i}),b=Date.now();let v,C;try{await(r?r({transport:m}):m.request({method:"net_listening"})),C=1}catch{C=0}finally{v=Date.now()}return{latency:v-b,success:C}}));u.push(h),u.length>s&&u.shift();const f=Math.max(...u.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const b=u.map(w=>w[m].latency),C=1-b.reduce((w,S)=>w+S,0)/b.length/f,N=u.map(w=>w[m].success),y=N.reduce((w,S)=>w+S,0)/N.length;return y===0?[0,m]:[l*C+c*y,m]}).sort((g,m)=>m[0]-g[0]);n(p.map(([,g])=>o[g])),await Pl(e),d()};d()}class M2 extends W{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function $c(t,e={}){const{batch:n,fetchFn:r,fetchOptions:s,key:i="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:l,retryDelay:u,raw:d}=e;return({chain:h,retryCount:f,timeout:p})=>{const{batchSize:g=1e3,wait:m=0}=typeof n=="object"?n:{},b=e.retryCount??f,v=p??e.timeout??1e4,C=t||h?.rpcUrls.default.http[0];if(!C)throw new M2;const N=S2(C,{fetchFn:r,fetchOptions:s,onRequest:c,onResponse:l,timeout:v});return Xf({key:i,methods:o,name:a,async request({method:y,params:w}){const S={method:y,params:w},{schedule:P}=Ab({id:C,wait:m,shouldSplitBatch(O){return O.length>g},fn:O=>N.request({body:O}),sort:(O,L)=>O.id-L.id}),A=async O=>n?P(O):[await N.request({body:O})],[{error:x,result:R}]=await A(S);if(d)return{error:x,result:R};if(x)throw new Hf({body:S,error:x,url:C});return R},retryCount:b,retryDelay:u,timeout:v,type:"http"},{fetchOptions:s,url:C})}}async function $o(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class mc{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await $o(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await $o(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await $o(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await $o(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await $o(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}sendBeacon({body:e,...n}){const r=this.createUrl(n);return navigator.sendBeacon(r.toString(),e?JSON.stringify(e):void 0)}}const L2={getFeatureValue(t,e){const n=e?.[t];return n===void 0?Pe.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(ee.isTelegram()){if(ee.isIos())return t.filter(e=>e!=="google");if(ee.isMac())return t.filter(e=>e!=="x");if(ee.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},le=Ye({features:Pe.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:Pe.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{},enableMobileFullScreen:!1}),F={state:le,subscribeKey(t,e){return _t(le,t,e)},setOptions(t){Object.assign(le,t)},setRemoteFeatures(t){if(!t)return;const e={...le.remoteFeatures,...t};le.remoteFeatures=e,le.remoteFeatures?.socials&&(le.remoteFeatures.socials=L2.filterSocialsByPlatform(le.remoteFeatures.socials)),le.features?.pay&&(le.remoteFeatures.email=!1,le.remoteFeatures.socials=!1)},setFeatures(t){if(!t)return;le.features||(le.features=Pe.DEFAULT_FEATURES);const e={...le.features,...t};le.features=e,le.features?.pay&&le.remoteFeatures&&(le.remoteFeatures.email=!1,le.remoteFeatures.socials=!1)},setProjectId(t){le.projectId=t},setCustomRpcUrls(t){le.customRpcUrls=t},setAllWallets(t){le.allWallets=t},setIncludeWalletIds(t){le.includeWalletIds=t},setExcludeWalletIds(t){le.excludeWalletIds=t},setFeaturedWalletIds(t){le.featuredWalletIds=t},setTokens(t){le.tokens=t},setTermsConditionsUrl(t){le.termsConditionsUrl=t},setPrivacyPolicyUrl(t){le.privacyPolicyUrl=t},setCustomWallets(t){le.customWallets=t},setIsSiweEnabled(t){le.isSiweEnabled=t},setIsUniversalProvider(t){le.isUniversalProvider=t},setSdkVersion(t){le.sdkVersion=t},setMetadata(t){le.metadata=t},setDisableAppend(t){le.disableAppend=t},setEIP6963Enabled(t){le.enableEIP6963=t},setDebug(t){le.debug=t},setEnableWalletGuide(t){le.enableWalletGuide=t},setEnableAuthLogger(t){le.enableAuthLogger=t},setEnableWallets(t){le.enableWallets=t},setPreferUniversalLinks(t){le.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(Pe.SIWX_DEFAULTS))t[e]??=n;le.siwx=t},setConnectMethodsOrder(t){le.features={...le.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){le.features={...le.features,walletFeaturesOrder:t}},setSocialsOrder(t){le.remoteFeatures={...le.remoteFeatures,socials:t}},setCollapseWallets(t){le.features={...le.features,collapseWallets:t}},setEnableEmbedded(t){le.enableEmbedded=t},setAllowUnsupportedChain(t){le.allowUnsupportedChain=t},setManualWCControl(t){le.manualWCControl=t},setEnableNetworkSwitch(t){le.enableNetworkSwitch=t},setEnableMobileFullScreen(t){le.enableMobileFullScreen=ee.isMobile()&&t},setEnableReconnect(t){le.enableReconnect=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(le.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){le.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return le.universalProviderConfigOverride},getSnapshot(){return ba(le)}},js=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),ft=Ye({...js}),B2={state:ft,subscribeKey(t,e){return _t(ft,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=ee.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){ft.message=js.message,ft.variant=js.variant,ft.svg=js.svg,ft.open=js.open,ft.autoClose=js.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=js.autoClose}){ft.open?(ft.open=!1,setTimeout(()=>{ft.message=t,ft.variant=n,ft.svg=e,ft.open=!0,ft.autoClose=r},150)):(ft.message=t,ft.variant=n,ft.svg=e,ft.open=!0,ft.autoClose=r)}},yr=B2,F2={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},Db=ee.getBlockchainApiUrl(),Kt=Ye({clientId:null,api:new mc({baseUrl:Db,clientId:null}),supportedChains:{http:[],ws:[]}}),ge={state:Kt,async get(t){const{st:e,sv:n}=ge.getSdkProperties(),r=F.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return Kt.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=F.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{Kt.supportedChains.http.length||await ge.getSupportedNetworks()}catch{return!1}return Kt.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await ge.get({path:"v1/supported-chains"});return Kt.supportedChains=t,t}catch{return Kt.supportedChains}},async fetchIdentity({address:t}){const e=j.getIdentityFromCacheForAddress(t);if(e)return e;const n=await ge.get({path:`/v1/identity/${t}`,params:{sender:_.state.activeCaipAddress?ee.getPlainAddress(_.state.activeCaipAddress):void 0}});return j.updateIdentityCache({address:t,identity:n,timestamp:Date.now()}),n},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))return{data:[],next:void 0};const o=j.getTransactionsCacheForAddress({address:t,chainId:s});if(o)return o;const a=await ge.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r});return j.updateTransactionsCache({address:t,chainId:s,timestamp:Date.now(),transactions:a}),a},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?ge.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?ge.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))return{fungibles:[]};const n=j.getTokenPriceCacheForAddresses(t);if(n)return n;const r=await Kt.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:F.state.projectId},headers:{"Content-Type":"application/json"}});return j.updateTokenPriceCache({addresses:t,timestamp:Date.now(),tokenPrice:r}),r},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?ge.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){const{st:e,sv:n}=ge.getSdkProperties();if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Gas Price");return ge.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return Kt.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:Pe.CONVERT_SLIPPAGE_TOLERANCE},projectId:F.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){const{st:r,sv:s}=ge.getSdkProperties();if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))throw new Error("Network not supported for Swaps");return ge.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){const{st:r,sv:s}=ge.getSdkProperties();if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))return yr.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=j.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await ge.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return j.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?ge.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))return[];const n=_.getAccountData()?.address;return ge.get({path:`/v1/profile/reverse/${t}`,params:{sender:n,apiVersion:"2"}})},async getEnsNameSuggestions(t){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?ge.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?Kt.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?(await Kt.api.post({path:"/v1/generators/onrampurl",params:{projectId:F.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){if(!await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await ge.get({path:"/v1/onramp/options"})}catch{return F2}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){try{return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?await Kt.api.post({path:"/v1/onramp/quote",params:{projectId:F.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?ge.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){return await ge.isNetworkSupported(_.state.activeCaipNetwork?.caipNetworkId)?Kt.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:F.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){Kt.clientId=t,Kt.api=new mc({baseUrl:Db,clientId:t})}};var ho={};const j2="https://secure.walletconnect.org/sdk",H2=(typeof process<"u"&&typeof ho<"u"?ho.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||j2,q2=(typeof process<"u"&&typeof ho<"u"?ho.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",W2=(typeof process<"u"&&typeof ho<"u"?ho.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",oe={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},lt={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Sn={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"},BINANCE:{id:"2fafea35bb471d22889ccb49c08d99dd0a18a37982602c33f696a5723934ba25",appId:"yFK5FCqYprrXDiVFbhyRx7",deeplink:"bnc://app.binance.com/mp/app",url:"https://app.binance.com/en/download"}},z2={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===Sn.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${Sn.PHANTOM.url}/ul/browse/${r}?ref=${o}`}if(t===Sn.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${Sn.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===D.CHAIN.SOLANA&&t===Sn.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${Sn.COINBASE.url}/dapp?cb_url=${r}`),e===D.CHAIN.BITCOIN&&t===Sn.BINANCE.id&&!("binancew3w"in window)){const s=_.state.activeCaipNetwork,i=window.btoa("/pages/browser/index"),o=window.btoa(`url=${r}&defaultChainId=${s?.id??1}`),a=new URL(Sn.BINANCE.deeplink);a.searchParams.set("appId",Sn.BINANCE.appId),a.searchParams.set("startPagePath",i),a.searchParams.set("startPageQuery",o);const c=new URL(Sn.BINANCE.url);c.searchParams.set("_dp",window.btoa(a.toString())),window.location.href=c.toString()}}},V2=Object.freeze({enabled:!0,events:[]}),K2=new mc({baseUrl:ee.getAnalyticsUrl(),clientId:null}),G2=5,Y2=60*1e3,ns=Ye({...V2}),Z2={state:ns,subscribeKey(t,e){return _t(ns,t,e)},async sendError(t,e){if(!ns.enabled)return;const n=Date.now();if(ns.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<Y2}).length>=G2)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};ns.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=F.state;await K2.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:ee.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){ns.enabled=!0},disable(){ns.enabled=!1},clearEvents(){ns.events=[]}};class ui extends Error{constructor(e,n,r){super(e),this.originalName="AppKitError",this.name="AppKitError",this.category=n,this.originalError=r,r&&r instanceof Error&&(this.originalName=r.name),Object.setPrototypeOf(this,ui.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,ui):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function A0(t,e){let n="";try{t instanceof Error?n=t.message:typeof t=="string"?n=t:typeof t=="object"&&t!==null?Object.keys(t).length===0?n="Unknown error":n=t?.message||JSON.stringify(t):n=String(t)}catch(s){n="Unknown error",console.error("Error parsing error message",s)}const r=t instanceof ui?t:new ui(n,e,t);throw Z2.sendError(r,r.category),r}function Fn(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return A0(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return A0(a,e)}},n[r]=i}else n[r]=s}),n}const fn=Ye({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),J2={state:fn,subscribeNetworkImages(t){return Rt(fn.networkImages,()=>t(fn.networkImages))},subscribeKey(t,e){return _t(fn,t,e)},subscribe(t){return Rt(fn,()=>t(fn))},setWalletImage(t,e){fn.walletImages[t]=e},setNetworkImage(t,e){fn.networkImages[t]=e},setChainImage(t,e){fn.chainImages[t]=e},setConnectorImage(t,e){fn.connectorImages={...fn.connectorImages,[t]:e}},setTokenImage(t,e){fn.tokenImages[t]=e},setCurrencyImage(t,e){fn.currencyImages[t]=e}},xn=Fn(J2),X2={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:"",sui:"",stacks:""},Qu=Ye({networkImagePromises:{}}),$b={async fetchWalletImage(t){if(t)return await de._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(Qu.networkImagePromises[t]||(Qu.networkImagePromises[t]=de._fetchNetworkImage(t)),await Qu.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return xn.state.walletImages[t]},getWalletImage(t){if(t?.image_url)return t?.image_url;if(t?.image_id)return xn.state.walletImages[t.image_id]},getNetworkImage(t){if(t?.assets?.imageUrl)return t?.assets?.imageUrl;if(t?.assets?.imageId)return xn.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return xn.state.networkImages[t]},getConnectorImage(t){if(t?.imageUrl)return t.imageUrl;if(t?.info?.icon)return t.info.icon;if(t?.imageId)return xn.state.connectorImages[t.imageId]},getChainImage(t){return xn.state.networkImages[X2[t]]},getTokenImage(t){if(t)return xn.state.tokenImages[t]}},Q2=ee.getAnalyticsUrl(),eS=new mc({baseUrl:Q2,clientId:null}),tS=["MODAL_CREATED"],nS=45,Ht=Ye({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"},pendingEvents:[],subscribedToVisibilityChange:!1}),Se={state:Ht,subscribe(t){return Rt(Ht,()=>t(Ht))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=F.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},_setPendingEvent(t){try{let e=_.getAccountData()?.address;if("address"in t.data&&t.data.address&&(e=t.data.address),tS.includes(t.data.event)||typeof window>"u")return;const n=_.getActiveCaipNetwork()?.caipNetworkId;this.state.pendingEvents.push({eventId:ee.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e,properties:{..."properties"in t.data?t.data.properties:{},caipNetworkId:n}}}),Ht.reportedErrors.FORBIDDEN=!1,JSON.stringify(Ht.pendingEvents).length/1024>nS&&Se._submitPendingEvents()}catch(e){console.warn("_setPendingEvent",e)}},sendEvent(t){Ht.timestamp=Date.now(),Ht.data=t;const e=["INITIALIZE","CONNECT_SUCCESS","SOCIAL_LOGIN_SUCCESS"];(F.state.features?.analytics||e.includes(t.event))&&Se._setPendingEvent(Ht),this._subscribeToVisibilityChange()},_submitPendingEvents(){if(Ht.pendingEvents.length!==0)try{eS.sendBeacon({path:"/batch",params:Se.getSdkProperties(),body:Ht.pendingEvents}),Ht.reportedErrors.FORBIDDEN=!1,Ht.pendingEvents=[]}catch{Ht.reportedErrors.FORBIDDEN=!0}},_subscribeToVisibilityChange(){Ht.subscribedToVisibilityChange||typeof document>"u"||(Ht.subscribedToVisibilityChange=!0,document?.addEventListener?.("visibilitychange",()=>{document.visibilityState==="hidden"&&Se._submitPendingEvents()}))}},rS=ee.getApiUrl(),Gt=new mc({baseUrl:rS,clientId:null}),sS=40,I0=4,iS=20,ye=Ye({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1,explorerWallets:[],explorerFilteredWallets:[]}),de={state:ye,subscribeKey(t,e){return _t(ye,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=F.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return F.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${Gt.baseUrl}/getWalletImage/${t}`,n=await Gt.getBlob({path:e,params:de._getSdkProperties()});xn.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${Gt.baseUrl}/public/getAssetImage/${t}`,n=await Gt.getBlob({path:e,params:de._getSdkProperties()});xn.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${Gt.baseUrl}/public/getAssetImage/${t}`,n=await Gt.getBlob({path:e,params:de._getSdkProperties()});xn.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${Gt.baseUrl}/public/getCurrencyImage/${t}`,n=await Gt.getBlob({path:e,params:de._getSdkProperties()});xn.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${Gt.baseUrl}/public/getTokenImage/${t}`,n=await Gt.getBlob({path:e,params:de._getSdkProperties()});xn.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){const e=t.length,n=ee.isMobile()?t?.filter(s=>s.mobile_link||s.webapp_link?!0:Object.values(Sn).map(o=>o.id).includes(s.id)):t,r=e-n.length;return{filteredWallets:n,mobileFilteredOutWalletsLength:r}},async fetchProjectConfig(){return(await Gt.get({path:"/appkit/v1/config",params:de._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await Gt.get({path:"/projects/v1/origins",params:de._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===D.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=D.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const e=_.getAllRequestedCaipNetworks()?.map(({assets:n})=>n?.imageId).filter(Boolean).filter(n=>!$b.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>de._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=K.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>de._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>de._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>de._fetchTokenImage(e)))},async fetchWallets(t){const e=t.exclude??[];de._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(Sn).map(o=>o.id));const r=await Gt.get({path:"/getWallets",params:{...de._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:t.include?.join(","),exclude:e.join(",")}}),{filteredWallets:s,mobileFilteredOutWalletsLength:i}=de._filterWalletsByPlatform(r?.data);return{data:s||[],count:r?.count,mobileFilteredOutWalletsLength:i}},async prefetchWalletRanks(){const t=K.state.connectors;if(!t?.length)return;const e={page:1,entries:20,badge:"certified"};if(e.names=t.map(s=>s.name).join(","),_.state.activeChain===D.CHAIN.EVM){const s=[...t.flatMap(i=>i.connectors?.map(o=>o.info?.rdns)||[]),...t.map(i=>i.info?.rdns)].filter(i=>typeof i=="string"&&i.length>0);s.length&&(e.rdns=s.join(","))}const{data:n}=await de.fetchWallets(e);ye.explorerWallets=n;const r=_.getRequestedCaipNetworkIds().join(",");ye.explorerFilteredWallets=n.filter(s=>s.chains?.some(i=>r.includes(i)))},async fetchFeaturedWallets(){const{featuredWalletIds:t}=F.state;if(t?.length){const e={...de._getSdkProperties(),page:1,entries:t?.length??I0,include:t},{data:n}=await de.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>de._fetchWalletImage(i))),ye.featured=r,ye.allFeatured=r}},async fetchRecommendedWallets(){try{ye.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=F.state,r=[...e??[],...n??[]].filter(Boolean),s=_.getRequestedCaipNetworkIds().join(","),i={page:1,entries:I0,include:t,exclude:r,chains:s},{data:o,count:a}=await de.fetchWallets(i),c=j.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>de._fetchWalletImage(d))),ye.recommended=o,ye.allRecommended=o,ye.count=a??0}catch{}finally{ye.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=F.state,s=_.getRequestedCaipNetworkIds().join(","),i=[...ye.recommended.map(({id:d})=>d),...n??[],...r??[]].filter(Boolean),o={page:t,entries:sS,include:e,exclude:i,chains:s},{data:a,count:c,mobileFilteredOutWalletsLength:l}=await de.fetchWallets(o);ye.mobileFilteredOutWalletsLength=l+(ye.mobileFilteredOutWalletsLength??0);const u=a.slice(0,iS).map(d=>d.image_id).filter(Boolean);await Promise.allSettled(u.map(d=>de._fetchWalletImage(d))),ye.wallets=ee.uniqueBy([...ye.wallets,...de._filterOutExtensions(a)],"id").filter(d=>d.chains?.some(h=>s.includes(h))),ye.count=c>ye.count?c:ye.count,ye.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await de.fetchWallets(e);n&&n.forEach(r=>{ye.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=F.state,s=_.getRequestedCaipNetworkIds().join(",");ye.search=[];const i={page:1,entries:100,search:t?.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await de.fetchWallets(i);Se.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>de._fetchWalletImage(c)),ee.wait(300)]),ye.search=de._filterOutExtensions(o)},initPromise(t,e){const n=ye.promises[t];return n||(ye.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0,fetchWalletRanks:s=!0}={}){const i=[t&&de.initPromise("connectorImages",de.fetchConnectorImages),e&&de.initPromise("featuredWallets",de.fetchFeaturedWallets),n&&de.initPromise("recommendedWallets",de.fetchRecommendedWallets),r&&de.initPromise("networkImages",de.fetchNetworkImages),s&&de.initPromise("walletRanks",de.prefetchWalletRanks)].filter(Boolean);return Promise.allSettled(i)},prefetchAnalyticsConfig(){F.state.features?.analytics&&de.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await Gt.get({path:"/getAnalyticsConfig",params:de._getSdkProperties()});F.setFeatures({analytics:t})}catch{F.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!t?.length){ye.featured=ye.allFeatured,ye.recommended=ye.allRecommended;return}const e=_.getRequestedCaipNetworkIds().join(",");ye.featured=ye.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),ye.recommended=ye.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),ye.filteredWallets=ye.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))},clearFilterByNamespaces(){ye.filteredWallets=[]},setFilterByNamespace(t){if(!t){ye.featured=ye.allFeatured,ye.recommended=ye.allRecommended;return}const e=_.getRequestedCaipNetworkIds().join(",");ye.featured=ye.allFeatured.filter(n=>n.chains?.some(r=>e.includes(r))),ye.recommended=ye.allRecommended.filter(n=>n.chains?.some(r=>e.includes(r))),ye.filteredWallets=ye.wallets.filter(n=>n.chains?.some(r=>e.includes(r)))}},Fe=Ye({view:"Connect",history:["Connect"],transactionStack:[]}),oS={state:Fe,subscribeKey(t,e){return _t(Fe,t,e)},pushTransactionStack(t){Fe.transactionStack.push(t)},popTransactionStack(t){const e=Fe.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n?.();break;case"error":r?.(),he.goBack();break;case"cancel":s?.(),he.goBack();break}},push(t,e){t!==Fe.view&&(Fe.view=t,Fe.history.push(t),Fe.data=e)},reset(t,e){Fe.view=t,Fe.history=[t],Fe.data=e},replace(t,e){Fe.history.at(-1)===t||(Fe.view=t,Fe.history[Fe.history.length-1]=t,Fe.data=e)},goBack(){const t=_.state.activeCaipAddress,e=he.state.view==="ConnectingFarcaster",n=!t&&e;if(Fe.history.length>1){Fe.history.pop();const[r]=Fe.history.slice(-1);r&&(t&&r==="Connect"?Fe.view="Account":Fe.view=r)}else _e.close();Fe.data?.wallet&&(Fe.data.wallet=void 0),Fe.data?.redirectView&&(Fe.data.redirectView=void 0),setTimeout(()=>{if(n){_.setAccountProp("farcasterUrl",void 0,_.state.activeChain);const r=K.getAuthConnector();r?.provider?.reload();const s=ba(F.state);r?.provider?.syncDappData?.({metadata:s.metadata,sdkVersion:s.sdkVersion,projectId:s.projectId,sdkType:s.sdkType})}},100)},goBackToIndex(t){if(Fe.history.length>1){Fe.history=Fe.history.slice(0,t+1);const[e]=Fe.history.slice(-1);e&&(Fe.view=e)}},goBackOrCloseModal(){he.state.history.length>1?he.goBack():_e.close()}},he=Fn(oS),Rr=Ye({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),Sh={state:Rr,subscribe(t){return Rt(Rr,()=>t(Rr))},setThemeMode(t){Rr.themeMode=t;try{const e=K.getAuthConnector();if(e){const n=Sh.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:va(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){Rr.themeVariables={...Rr.themeVariables,...t};try{const e=K.getAuthConnector();if(e){const n=Sh.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:va(Rr.themeVariables,Rr.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return ba(Rr)}},tn=Fn(Sh),Ub=Object.fromEntries(ow.map(t=>[t,void 0])),aS=Object.fromEntries(ow.map(t=>[t,!0])),Oe=Ye({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:Ub,filterByNamespaceMap:aS}),cS={state:Oe,subscribe(t){return Rt(Oe,()=>{t(Oe)})},subscribeKey(t,e){return _t(Oe,t,e)},initialize(t){t.forEach(e=>{const n=j.getConnectedConnectorId(e);n&&K.setConnectorId(n,e)})},setActiveConnector(t){t&&(Oe.activeConnector=so(t))},setConnectors(t){t.filter(s=>!Oe.allConnectors.some(i=>i.id===s.id&&K.getConnectorName(i.name)===K.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&Oe.allConnectors.push(so(s))});const n=K.getEnabledNamespaces(),r=K.getEnabledConnectors(n);Oe.connectors=K.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys(Oe.filterByNamespaceMap).forEach(e=>{Oe.filterByNamespaceMap[e]=!1}),t.forEach(e=>{Oe.filterByNamespaceMap[e]=!0}),K.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){Oe.filterByNamespaceMap[t]=e,K.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=K.getEnabledNamespaces(),e=K.getEnabledConnectors(t),n=K.areAllNamespacesEnabled();Oe.connectors=K.mergeMultiChainConnectors(e),n?de.clearFilterByNamespaces():de.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries(Oe.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return Oe.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values(Oe.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=K.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=s?.id===D.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:s?.id||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=K.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){if(t.id===D.CONNECTOR_ID.AUTH){const e=t,n=ba(F.state),r=tn.getSnapshot().themeMode,s=tn.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,projectId:n.projectId,sdkType:n.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:va(s,r)}),K.setConnectors([t])}else K.setConnectors([t])},getAuthConnector(t){const e=t||_.state.activeChain,n=Oe.connectors.find(r=>r.id===D.CONNECTOR_ID.AUTH);if(n)return n?.connectors?.length?n.connectors.find(s=>s.chain===e):n},getAnnouncedConnectorRdns(){return Oe.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>t.info?.rdns)},getConnectorById(t){return Oe.allConnectors.find(e=>e.id===t)},getConnector({id:t,rdns:e,namespace:n}){const r=n||_.state.activeChain;return Oe.allConnectors.filter(i=>i.chain===r).find(i=>i.explorerId===t||i.info?.rdns===e)},syncIfAuthConnector(t){if(t.id!=="ID_AUTH")return;const e=t,n=ba(F.state),r=tn.getSnapshot().themeMode,s=tn.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:va(s,r)})},getConnectorsByNamespace(t){const e=Oe.allConnectors.filter(n=>n.chain===t);return K.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return _.checkIfSmartAccountEnabled()&&qt(t)===lt.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=he.state.data?.redirectView,n=K.getConnector({id:t.id,rdns:t.rdns});z2.handleMobileDeeplinkRedirect(n?.explorerId||t.id,_.state.activeChain),n?he.push("ConnectingExternal",{connector:n,wallet:t,redirectView:e}):he.push("ConnectingWalletConnect",{wallet:t,redirectView:e})},getConnectors(t){return t?K.getConnectorsByNamespace(t):K.mergeMultiChainConnectors(Oe.allConnectors)},setFilterByNamespace(t){Oe.filterByNamespace=t,Oe.connectors=K.getConnectors(t),de.setFilterByNamespace(t)},setConnectorId(t,e){t&&(Oe.activeConnectorIds={...Oe.activeConnectorIds,[e]:t},j.setConnectedConnectorId(e,t))},removeConnectorId(t){Oe.activeConnectorIds={...Oe.activeConnectorIds,[t]:void 0},j.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return Oe.activeConnectorIds[t]},isConnected(t){return t?!!Oe.activeConnectorIds[t]:Object.values(Oe.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){Oe.activeConnectorIds={...Ub}}},K=Fn(cS),lS=1e3,Uo={checkNamespaceConnectorId(t,e){return K.getConnectorId(t)===e},isSocialProvider(t){return Pe.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&K.setActiveConnector(e),s?.(ee.isMobile()&&t),r){const l=_e.subscribeKey("open",u=>{u||(he.state.view!==r&&he.replace(r),l(),a(new Error("Modal closed")))})}const c=_.subscribeKey("activeCaipAddress",l=>{l&&(i?.(),n&&_e.close(),c(),o(xt.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,n)=>{const r=_.subscribeKey("activeCaipAddress",s=>{s&&(_e.close(),r(),e(xt.parseCaipAddress(s)))});X.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,namespace:e,closeModalOnConnect:n=!0,onOpenFarcaster:r,onConnect:s}){const i=_.getAccountData(e);let o=i?.socialWindow,a=i?.socialProvider,c=!1,l=null;const u=e||_.state.activeChain,d=_.subscribeKey("activeCaipAddress",h=>{h&&(n&&_e.close(),d())});return new Promise((h,f)=>{async function p(m){if(m.data?.resultUri)if(m.origin===D.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",p,!1);try{const b=K.getAuthConnector(u);if(b&&!c){const v=_.getAccountData(u);o&&(o.close(),_.setAccountProp("socialWindow",void 0,u),o=v?.socialWindow),c=!0;const C=m.data.resultUri;if(a&&Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:a}}),a){j.setConnectedSocialProvider(a),await X.connectExternal({id:b.id,type:b.type,socialUri:C},b.chain);const N=_.state.activeCaipAddress;if(!N){f(new Error("Failed to connect"));return}h(xt.parseCaipAddress(N)),Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:a}})}}}catch(b){a&&Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:a,message:ee.parseError(b)}}),f(new Error("Failed to connect"))}}else a&&Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:a,message:"Untrusted Origin"}})}async function g(){if(t){const m=_.getAccountData(u);_.setAccountProp("socialProvider",t,u),a=m?.socialProvider,Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:a}})}if(a==="farcaster"){r?.();const m=_e.subscribeKey("open",v=>{!v&&t==="farcaster"&&(f(new Error("Popup closed")),s?.(),m())}),b=K.getAuthConnector();if(b&&!_.getAccountData(u)?.farcasterUrl)try{const{url:C}=await b.provider.getFarcasterUri();_.setAccountProp("farcasterUrl",C,u)}catch{f(new Error("Failed to connect to farcaster"))}}else{const m=K.getAuthConnector();l=ee.returnOpenHref(`${D.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(m&&a){const{uri:b}=await m.provider.getSocialRedirectUri({provider:a});if(l&&b){_.setAccountProp("socialWindow",so(l),u),o=i?.socialWindow,l.location.href=b;const v=setInterval(()=>{o?.closed&&!c&&(f(new Error("Popup closed")),clearInterval(v))},1e3);window.addEventListener("message",p,!1)}else l?.close(),f(new Error("Failed to initiate social connection"))}}catch{f(new Error("Failed to initiate social connection")),l?.close()}}}g()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n?.(),e){const a=_e.subscribeKey("open",c=>{c||(he.state.view!==e&&he.replace(e),a(),i(new Error("Modal closed")))})}const o=_.subscribeKey("activeCaipAddress",a=>{a&&(r?.(),t&&_e.close(),o(),s(xt.parseCaipAddress(a)))})})},async updateEmail(){const t=j.getConnectedConnectorId(_.state.activeChain),e=K.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==D.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return await _e.open({view:"UpdateEmailWallet",data:{email:n,redirectView:void 0}}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(_e.close(),clearInterval(i),o(),r({email:a}))},lS),o=_e.subscribeKey("open",a=>{a||(he.state.view!=="Connect"&&he.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return _.checkIfSmartAccountEnabled()&&qt(t)===lt.ACCOUNT_TYPES.EOA}};function Mb(){const t=_.state.activeCaipNetwork?.chainNamespace||"eip155",e=_.state.activeCaipNetwork?.id||1,n=Pe.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function qt(t){return _.getAccountData(t)?.preferredAccountType}function zr(t){return t?_.state.chains.get(t)?.networkState?.caipNetwork:_.state.activeCaipNetwork}const Rl={getConnectionStatus(t,e){const n=K.state.activeConnectorIds[e],r=X.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){const e=!!F.state.remoteFeatures?.multiWallet,n=K.state.activeConnectorIds[t],r=X.getConnections(t),i=(X.state.recentConnections.get(t)??[]).filter(a=>K.getConnectorById(a.connectorId)),o=Rl.excludeExistingConnections([...r.map(a=>a.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(a=>a.connectorId.toLowerCase()===n?.toLowerCase()),recentConnections:[]}}},Xe=Ye({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),uS={state:Xe,subscribe(t){return Rt(Xe,()=>t(Xe))},setLastNetworkInView(t){Xe.lastNetworkInView=t},async fetchTransactions(t){if(!t)throw new Error("Transactions can't be fetched without an accountAddress");Xe.loading=!0;try{const e=await ge.fetchTransactions({account:t,cursor:Xe.next,chainId:_.state.activeCaipNetwork?.caipNetworkId}),n=al.filterSpamTransactions(e.data),r=al.filterByConnectedChain(n),s=[...Xe.transactions,...r];Xe.loading=!1,Xe.transactions=s,Xe.transactionsByYear=al.groupTransactionsByYearAndMonth(Xe.transactionsByYear,r),Xe.empty=s.length===0,Xe.next=e.next?e.next:void 0}catch{const n=_.state.activeChain;Se.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:F.state.projectId,cursor:Xe.next,isSmartAccount:qt(n)===lt.ACCOUNT_TYPES.SMART_ACCOUNT}}),yr.showError("Failed to fetch transactions"),Xe.loading=!1,Xe.empty=!0,Xe.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>r.nft_info?.flags.is_spam===!0))},filterByConnectedChain(t){const e=_.state.activeCaipNetwork?.caipNetworkId;return t.filter(r=>r.metadata.chain===e)},clearCursor(){Xe.next=void 0},resetTransactions(){Xe.transactions=[],Xe.transactionsByYear={},Xe.lastNetworkInView=void 0,Xe.loading=!1,Xe.empty=!1,Xe.next=void 0}},al=Fn(uS,"API_ERROR"),ke=Ye({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let $s;const dS={state:ke,subscribe(t){return Rt(ke,()=>t(ke))},subscribeKey(t,e){return _t(ke,t,e)},_getClient(){return ke._client},setClient(t){ke._client=so(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);X.syncStorageConnections(e)},syncStorageConnections(t){const e=j.getConnections(),n=t??Array.from(_.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(ke.recentConnections);i.set(r,s),ke.recentConnections=i}},getConnections(t){return t?ke.connections.get(t)??[]:[]},hasAnyConnection(t){const e=X.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect({cache:t="auto"}={}){const e=ee.isTelegram()||ee.isSafari()&&ee.isIos();if(t==="always"||t==="auto"&&e){if($s){await $s,$s=void 0;return}if(!ee.isPairingExpired(ke?.wcPairingExpiry)){const n=ke.wcUri;ke.wcUri=n;return}$s=X._getClient()?.connectWalletConnect?.().catch(()=>{}),X.state.status="connecting",await $s,$s=void 0,ke.wcPairingExpiry=void 0,X.state.status="connected"}else await X._getClient()?.connectWalletConnect?.()},async connectExternal(t,e,n=!0){const r=await X._getClient()?.connectExternal?.(t);return n&&_.setActiveNamespace(e),r},async reconnectExternal(t){await X._getClient()?.reconnectExternal?.(t);const e=t.chain||_.state.activeChain;e&&K.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){if(!e)return;_e.setLoading(!0,_.state.activeChain);const n=K.getAuthConnector();n&&(_.setAccountProp("preferredAccountType",t,e),await n.provider.setPreferredAccount(t),j.setPreferredAccountTypes(Object.entries(_.state.chains).reduce((r,[s,i])=>{const o=s,a=qt(o);return a!==void 0&&(r[o]=a),r},{})),await X.reconnectExternal(n),_e.setLoading(!1,_.state.activeChain),Se.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:_.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(t){return X._getClient()?.signMessage(t)},parseUnits(t,e){return X._getClient()?.parseUnits(t,e)},formatUnits(t,e){return X._getClient()?.formatUnits(t,e)},updateBalance(t){return X._getClient()?.updateBalance(t)},async sendTransaction(t){return X._getClient()?.sendTransaction(t)},async getCapabilities(t){return X._getClient()?.getCapabilities(t)},async grantPermissions(t){return X._getClient()?.grantPermissions(t)},async walletGetAssets(t){return X._getClient()?.walletGetAssets(t)??{}},async estimateGas(t){return X._getClient()?.estimateGas(t)},async writeContract(t){return X._getClient()?.writeContract(t)},async getEnsAddress(t){return X._getClient()?.getEnsAddress(t)},async getEnsAvatar(t){return X._getClient()?.getEnsAvatar(t)},checkInstalled(t){return X._getClient()?.checkInstalled?.(t)||!1},resetWcConnection(){ke.wcUri=void 0,ke.wcPairingExpiry=void 0,ke.wcLinking=void 0,ke.recentWallet=void 0,ke.status="disconnected",al.resetTransactions(),j.deleteWalletConnectDeepLink(),j.deleteRecentWallet()},resetUri(){ke.wcUri=void 0,ke.wcPairingExpiry=void 0,$s=void 0},finalizeWcConnection(t){const{wcLinking:e,recentWallet:n}=X.state;e&&j.setWalletConnectDeepLink(e),n&&j.setAppKitRecent(n),t&&Se.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:t,properties:{method:e?"mobile":"qrcode",name:he.state.data?.wallet?.name||"Unknown",view:he.state.view,walletRank:n?.order}})},setWcBasic(t){ke.wcBasic=t},setUri(t){ke.wcUri=t,ke.wcPairingExpiry=ee.getPairingExpiry()},setWcLinking(t){ke.wcLinking=t},setWcError(t){ke.wcError=t,ke.buffering=!1},setRecentWallet(t){ke.recentWallet=t},setBuffering(t){ke.buffering=t},setStatus(t){ke.status=t},setIsSwitchingConnection(t){ke.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){try{await X._getClient()?.disconnect({id:t,chainNamespace:e,initialDisconnect:n})}catch(r){throw new ui("Failed to disconnect","INTERNAL_SDK_ERROR",r)}},async disconnectConnector({id:t,namespace:e}){try{await X._getClient()?.disconnectConnector({id:t,namespace:e})}catch(n){throw new ui("Failed to disconnect connector","INTERNAL_SDK_ERROR",n)}},setConnections(t,e){const n=new Map(ke.connections);n.set(e,t),ke.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){const r=_.getAccountData(e)?.user?.accounts?.find(i=>i.type==="smartAccount"),s=r&&r.address.toLowerCase()===t.toLowerCase()&&Uo.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await X.setPreferredAccountType(s,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=K.getConnectorById(t.connectorId),s=t.connectorId===D.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)s&&n&&await X.handleAuthAccountSwitch({address:n,namespace:e});else return(await X.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e))?.address;return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){const s=K.getConnectorById(t.connectorId),i=t.auth?.name?.toLowerCase(),o=t.connectorId===D.CONNECTOR_ID.AUTH,a=t.connectorId===D.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&Uo.isSocialProvider(i)){const{address:l}=await Uo.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){_e.open({view:"ConnectingFarcaster"})},onConnect(){he.replace("ProfileWallets")}});c=l}else{const{address:l}=await Uo.connectEmail({closeModalOnConnect:r,onOpen(){_e.open({view:"EmailLogin"})},onConnect(){he.replace("ProfileWallets")}});c=l}else if(a){const{address:l}=await Uo.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(u){const d=u?"AllWallets":"ConnectingWalletConnect";_e.state.open?he.push(d):_e.open({view:d})},onConnect(){he.replace("ProfileWallets")}});c=l}else{const l=await X.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);l&&(c=l.address)}return o&&n&&await X.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=_.getAccountData(n)?.caipAddress;if(o){const{address:c}=xt.parseCaipAddress(o);i=c}const a=Rl.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await X.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s?.({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await X.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&s?.({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0});break}default:throw new Error(`Invalid connection status: ${a}`)}}},X=Fn(dS),ed={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return vi(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}};let td;async function S0(){if(!td){const{createPublicClient:t,http:e,defineChain:n}=await dt(async()=>{const{createPublicClient:r,http:s,defineChain:i}=await import("./Bku9roCD.js");return{createPublicClient:r,http:s,defineChain:i}},__vite__mapDeps([5,6,4,0,1,2,7,8,3]),import.meta.url);td={createPublicClient:t,http:e,defineChain:n}}return td}const Nh={getBlockchainApiRpcUrl(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()},async getViemChain(t){const{defineChain:e}=await S0(),{chainId:n}=xt.parseCaipNetworkId(t.caipNetworkId);return e({...t,id:Number(n)})},async createViemPublicClient(t){const{createPublicClient:e,http:n}=await S0(),r=F.state.projectId,s=await Nh.getViemChain(t);if(!s)throw new Error(`Chain ${t.caipNetworkId} not found in viem/chains`);return e({chain:s,transport:n(Nh.getBlockchainApiRpcUrl(t.caipNetworkId,r))})}},Qf={async getMyTokensWithBalance(t){const e=_.getAccountData()?.address,n=_.state.activeCaipNetwork,r=K.getConnectorId("eip155")===D.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=j.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===D.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,n);if(a)return this.filterLowQualityTokens(a)}const o=await ge.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){try{const n=ed.getChainIdHexFromCAIP2ChainId(e.caipNetworkId);if(!(await X.getCapabilities(t))?.[n]?.assetDiscovery?.supported)return null;const s=await X.walletGetAssets({account:t,chainFilter:[n]});if(!ed.isWalletGetAssetsResponse(s))return null;const o=(s[n]||[]).map(a=>ed.createBalance(a,e.caipNetworkId));return j.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:o},timestamp:Date.now()}),o}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")},async fetchERC20Balance({caipAddress:t,assetAddress:e,caipNetwork:n}){const r=await Nh.createViemPublicClient(n),{address:s}=xt.parseCaipAddress(t),[{result:i},{result:o},{result:a},{result:c}]=await r.multicall({contracts:[{address:e,functionName:"name",args:[],abi:Rc},{address:e,functionName:"symbol",args:[],abi:Rc},{address:e,functionName:"balanceOf",args:[s],abi:Rc},{address:e,functionName:"decimals",args:[],abi:Rc}]});return{name:i,symbol:o,decimals:c,balance:a&&c?vi(a,c):"0"}}},Ti=Ye({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Xn={state:Ti,subscribe(t){return Rt(Ti,()=>t(Ti))},subscribeOpen(t){return _t(Ti,"open",t)},set(t){Object.assign(Ti,{...Ti,...t})}},hS={async getTokenList(t){return(await ge.fetchSwapTokens({chainId:t}))?.tokens?.map(r=>({...r,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0}))||[]},async fetchGasPrice(){const t=_.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const e=(await X?.estimateGas({chainNamespace:"solana"}))?.toString();return{standard:e,fast:e,instant:e};case"eip155":default:return await ge.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await ge.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s?.allowance&&n&&r){const i=X.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await Qf.getMyTokensWithBalance(t);return _.setAccountProp("tokenBalance",e,_.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return t?.map(e=>({...e,address:e?.address?e.address:Mb(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]},async handleSwapError(t){try{const e=t?.cause;return e?.json&&(await e.json())?.reasons?.[0]?.description?.includes("insufficient liquidity")?"Insufficient liquidity":void 0}catch{return}}},xe=Ye({tokenBalances:[],loading:!1}),fS={state:xe,subscribe(t){return Rt(xe,()=>t(xe))},subscribeKey(t,e){return _t(xe,t,e)},setToken(t){t&&(xe.token=so(t))},setTokenAmount(t){xe.sendTokenAmount=t},setReceiverAddress(t){xe.receiverAddress=t},setReceiverProfileImageUrl(t){xe.receiverProfileImageUrl=t},setReceiverProfileName(t){xe.receiverProfileName=t},setNetworkBalanceInUsd(t){xe.networkBalanceInUSD=t},setLoading(t){xe.loading=t},getSdkEventProperties(t){return{message:ee.parseError(t),isSmartAccount:qt(_.state.activeChain)===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:xe.token?.symbol||"",amount:xe.sendTokenAmount??0,network:_.state.activeCaipNetwork?.caipNetworkId||""}},async sendToken(){try{switch(Ce.setLoading(!0),_.state.activeCaipNetwork?.chainNamespace){case"eip155":await Ce.sendEvmToken();return;case"solana":await Ce.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}catch(t){throw mr.isUserRejectedRequestError(t)?new Ji(t):t}finally{Ce.setLoading(!1)}},async sendEvmToken(){const t=_.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=qt(t);if(!Ce.state.sendTokenAmount||!Ce.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!Ce.state.token)throw new Error("A token is required");if(Ce.state.token?.address){Se.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ce.state.token.address,amount:Ce.state.sendTokenAmount,network:_.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await Ce.sendERC20Token({receiverAddress:Ce.state.receiverAddress,tokenAddress:Ce.state.token.address,sendTokenAmount:Ce.state.sendTokenAmount,decimals:Ce.state.token.quantity.decimals});n&&(xe.hash=n)}else{Se.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ce.state.token.symbol||"",amount:Ce.state.sendTokenAmount,network:_.state.activeCaipNetwork?.caipNetworkId||""}});const{hash:n}=await Ce.sendNativeToken({receiverAddress:Ce.state.receiverAddress,sendTokenAmount:Ce.state.sendTokenAmount,decimals:Ce.state.token.quantity.decimals});n&&(xe.hash=n)}},async fetchTokenBalance(t){xe.loading=!0;const e=_.state.activeChain,n=_.state.activeCaipNetwork?.caipNetworkId,r=_.state.activeCaipNetwork?.chainNamespace,s=_.getAccountData(e)?.caipAddress??_.state.activeCaipAddress,i=s?ee.getPlainAddress(s):void 0;if(xe.lastRetry&&!ee.isAllowedRetry(xe.lastRetry,30*Pe.ONE_SEC_MS))return xe.loading=!1,[];try{if(i&&n&&r){const o=await Qf.getMyTokensWithBalance();return xe.tokenBalances=o,xe.lastRetry=void 0,o}}catch(o){xe.lastRetry=Date.now(),t?.(o),yr.showError("Token Balance Unavailable")}finally{xe.loading=!1}return[]},fetchNetworkBalance(){if(xe.tokenBalances.length===0)return;const t=hS.mapBalancesToSwapTokens(xe.tokenBalances);if(!t)return;const e=t.find(n=>n.address===Mb());e&&(xe.networkBalanceInUSD=e?OC.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){he.pushTransactionStack({});const e=t.receiverAddress,n=_.getAccountData()?.address,r=X.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),i=await X.sendTransaction({chainNamespace:D.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)});return Se.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:qt("eip155")===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ce.state.token?.symbol||"",amount:t.sendTokenAmount,network:_.state.activeCaipNetwork?.caipNetworkId||"",hash:i||""}}),X._getClient()?.updateBalance("eip155"),Ce.resetSend(),{hash:i}},async sendERC20Token(t){he.pushTransactionStack({onSuccess(){he.replace("Account")}});const e=X.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals)),n=_.getAccountData()?.address;if(n&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const r=ee.getPlainAddress(t.tokenAddress);if(!r)throw new Error("SendController:sendERC20Token - tokenAddress is required");const s=await X.writeContract({fromAddress:n,tokenAddress:r,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:UC.getERC20Abi(r),chainNamespace:D.CHAIN.EVM});return Se.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:qt("eip155")===lt.ACCOUNT_TYPES.SMART_ACCOUNT,token:Ce.state.token?.symbol||"",amount:t.sendTokenAmount,network:_.state.activeCaipNetwork?.caipNetworkId||"",hash:s||""}}),Ce.resetSend(),{hash:s}}return{hash:void 0}},async sendSolanaToken(){if(!Ce.state.sendTokenAmount||!Ce.state.receiverAddress)throw new Error("An amount and receiver address are required");he.pushTransactionStack({onSuccess(){he.replace("Account")}});let t;Ce.state.token&&Ce.state.token.address!==Pe.SOLANA_NATIVE_TOKEN_ADDRESS&&(ee.isCaipAddress(Ce.state.token.address)?t=ee.getPlainAddress(Ce.state.token.address):t=Ce.state.token.address);const e=await X.sendTransaction({chainNamespace:"solana",tokenMint:t,to:Ce.state.receiverAddress,value:Ce.state.sendTokenAmount});e&&(xe.hash=e),X._getClient()?.updateBalance("solana"),Ce.resetSend()},resetSend(){xe.token=void 0,xe.sendTokenAmount=void 0,xe.receiverAddress=void 0,xe.receiverProfileImageUrl=void 0,xe.receiverProfileName=void 0,xe.loading=!1,xe.tokenBalances=[]}},Ce=Fn(fS),nd={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},Uc={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},J=Ye({chains:_C(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),Lb={state:J,subscribe(t){return Rt(J,()=>{t(J)})},subscribeKey(t,e){return _t(J,t,e)},subscribeAccountStateProp(t,e,n){const r=n||J.activeChain;return r?_t(J.chains.get(r)?.accountState||{},t,e):()=>{}},subscribeChainProp(t,e,n){let r;return Rt(J.chains,()=>{const s=n||J.activeChain;if(s){const i=J.chains.get(s)?.[t];r!==i&&(r=i,e(i))}})},initialize(t,e,n){const{chainId:r,namespace:s}=j.getActiveNetworkProps(),i=e?.find(u=>u.id.toString()===r?.toString()),a=t.find(u=>u?.namespace===s)||t?.[0],c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=F.state.enableEmbedded?new Set([...c]):new Set([...e?.map(u=>u.chainNamespace)??[]]);(t?.length===0||!a)&&(J.noAdapters=!0),J.noAdapters||(J.activeChain=a?.namespace,J.activeCaipNetwork=i,_.setChainNetworkData(a?.namespace,{caipNetwork:i}),J.activeChain&&Xn.set({activeChain:a?.namespace})),l.forEach(u=>{const d=e?.filter(p=>p.chainNamespace===u),h=j.getPreferredAccountTypes()||{},f={...F.state.defaultAccountTypes,...h};_.state.chains.set(u,{namespace:u,networkState:Ye({...Uc,caipNetwork:d?.[0]}),accountState:Ye({...nd,preferredAccountType:f[u]}),caipNetworks:d??[],...n}),_.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){if(J.activeChain===t){const e=Array.from(J.chains.entries()).find(([n])=>n!==t);if(e){const n=e[1]?.caipNetworks?.[0];n&&_.setActiveCaipNetwork(n)}}J.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:n},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");J.chains.set(t.namespace,{namespace:t.namespace,networkState:{...Uc,caipNetwork:r[0]},accountState:{...nd},caipNetworks:r,connectionControllerClient:n,networkControllerClient:e}),_.setRequestedCaipNetworks(r?.filter(s=>s.chainNamespace===t.namespace)??[],t.namespace)},addNetwork(t){const e=J.chains.get(t.chainNamespace);if(e){const n=[...e.caipNetworks||[]];e.caipNetworks?.find(r=>r.id===t.id)||n.push(t),J.chains.set(t.chainNamespace,{...e,caipNetworks:n}),_.setRequestedCaipNetworks(n,t.chainNamespace),K.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){const n=J.chains.get(t);if(n){const r=J.activeCaipNetwork?.id===e,s=[...n.caipNetworks?.filter(i=>i.id!==e)||[]];r&&n?.caipNetworks?.[0]&&_.setActiveCaipNetwork(n.caipNetworks[0]),J.chains.set(t,{...n,caipNetworks:s}),_.setRequestedCaipNetworks(s||[],t),s.length===0&&K.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=J.chains.get(t);n&&(n.networkState={...n.networkState||Uc,...e},J.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=J.chains.get(t);if(r){const s={...r.accountState||nd,...e};J.chains.set(t,{...r,accountState:s}),(J.chains.size===1||J.activeChain===t)&&e.caipAddress&&(J.activeCaipAddress=e.caipAddress)}},setChainNetworkData(t,e){if(!t)return;const n=J.chains.get(t);if(n){const r={...n.networkState||Uc,...e};J.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){_.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){J.activeChain=t;const e=t?J.chains.get(t):void 0,n=e?.networkState?.caipNetwork;n?.id&&t&&(J.activeCaipAddress=e?.accountState?.caipAddress,J.activeCaipNetwork=n,_.setChainNetworkData(t,{caipNetwork:n}),j.setActiveCaipNetworkId(n?.caipNetworkId),Xn.set({activeChain:t,selectedNetworkId:n?.caipNetworkId}))},setActiveCaipNetwork(t){if(!t)return;const e=J.activeChain===t.chainNamespace;e||_.setIsSwitchingNamespace(!0);const n=J.chains.get(t.chainNamespace);J.activeChain=t.chainNamespace,J.activeCaipNetwork=t,_.setChainNetworkData(t.chainNamespace,{caipNetwork:t});let r=n?.accountState?.address;if(r)J.activeCaipAddress=`${t.chainNamespace}:${t.id}:${r}`;else if(e&&J.activeCaipAddress){const{address:i}=xt.parseCaipAddress(J.activeCaipAddress);r=i,J.activeCaipAddress=`${t.caipNetworkId}:${r}`}else J.activeCaipAddress=void 0;_.setChainAccountData(t.chainNamespace,{address:r,caipAddress:J.activeCaipAddress}),Ce.resetSend(),Xn.set({activeChain:J.activeChain,selectedNetworkId:J.activeCaipNetwork?.caipNetworkId}),j.setActiveCaipNetworkId(t.caipNetworkId),!_.checkIfSupportedNetwork(t.chainNamespace)&&F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&!X.state.wcBasic&&_.showUnsupportedChainUI()},addCaipNetwork(t){if(!t)return;const e=J.chains.get(t.chainNamespace);e&&e?.caipNetworks?.push(t)},async switchActiveNamespace(t){if(!t)return;const e=t!==_.state.activeChain,n=_.getNetworkData(t)?.caipNetwork,r=_.getCaipNetworkByNamespace(t,n?.id);e&&r&&await _.switchActiveNetwork(r)},async switchActiveNetwork(t,{throwOnFailure:e=!1}={}){const n=_.state.activeChain;if(!n)throw new Error("ChainController:switchActiveNetwork - namespace is required");const s=!_.state.chains.get(n)?.caipNetworks?.some(o=>o.id===J.activeCaipNetwork?.id),i=_.getNetworkControllerClient(t.chainNamespace);if(i){try{await i.switchCaipNetwork(t),s&&_e.close()}catch(o){if(e)throw o;he.goBack()}Se.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||J.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=J.chains.get(e);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(t){const e=t||J.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=J.chains.get(e);if(!n?.connectionControllerClient)throw new Error("ConnectionController client not set");return n.connectionControllerClient},getNetworkProp(t,e){const n=J.chains.get(e)?.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=J.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=e?.networkState||{};return ee.sortRequestedNetworks(n,r).filter(o=>o?.id)},getAllRequestedCaipNetworks(){const t=[];return J.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=_.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){_.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=_.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));K.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return J.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=_.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){return t?J.chains.get(t)?.networkState?.caipNetwork:J.activeCaipNetwork},getActiveCaipAddress(){return J.activeCaipAddress},getApprovedCaipNetworkIds(t){return J.chains.get(t)?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(t){const n=await _.getNetworkControllerClient()?.getApprovedCaipNetworksData();_.setAdapterNetworkState(t,{approvedCaipNetworkIds:n?.approvedCaipNetworkIds,supportsAllNetworks:n?.supportsAllNetworks})},checkIfSupportedNetwork(t,e){const n=e||J.activeCaipNetwork?.caipNetworkId,r=_.getRequestedCaipNetworks(t);return r.length?r?.some(s=>s.caipNetworkId===n):!0},checkIfSupportedChainId(t){return J.activeChain?_.getRequestedCaipNetworks(J.activeChain)?.some(n=>n.id===t):!0},setSmartAccountEnabledNetworks(t,e){_.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){const t=Ea.caipNetworkIdToNumber(J.activeCaipNetwork?.caipNetworkId),e=J.activeChain;return!e||!t?!1:!!_.getNetworkProp("smartAccountEnabledNetworks",e)?.includes(Number(t))},showUnsupportedChainUI(){_e.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=J.activeCaipNetwork;return!!(t?.chainNamespace&&Pe.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){_.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=_.state.chains.get(e)?.accountState?.preferredAccountType,r=F.state.defaultAccountTypes[e];J.activeCaipAddress=void 0,_.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:r||n,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),K.removeConnectorId(e)},setIsSwitchingNamespace(t){J.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){const t=[];let e;if(J.chains.forEach(n=>{D.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(r=>r===n.namespace)&&n.namespace&&t.push(n.namespace)}),t.length>0){const n=t[0];return e=n?J.chains.get(n)?.caipNetworks?.[0]:void 0,e}},getAccountData(t){const e=t||J.activeChain;if(e)return _.state.chains.get(e)?.accountState},getNetworkData(t){const e=t||J.activeChain;if(e)return _.state.chains.get(e)?.networkState},getCaipNetworkByNamespace(t,e){if(!t)return;const n=_.state.chains.get(t),r=n?.caipNetworks?.find(s=>s.id===e);return r||n?.networkState?.caipNetwork||n?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){const t=K.state.filterByNamespace;return(t?[J.chains.get(t)]:Array.from(J.chains.values())).flatMap(n=>n?.caipNetworks||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?_.getRequestedCaipNetworks(t):_.getAllRequestedCaipNetworks()},getCaipNetworkById(t,e){return Lb.getCaipNetworks(e).find(n=>n.id.toString()===t.toString()||n.caipNetworkId.toString()===t.toString())},setLastConnectedSIWECaipNetwork(t){J.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return J.lastConnectedSIWECaipNetwork},async fetchTokenBalance(t){const e=_.getAccountData();if(!e)return[];const n=_.state.activeCaipNetwork?.caipNetworkId,r=_.state.activeCaipNetwork?.chainNamespace,s=_.state.activeCaipAddress,i=s?ee.getPlainAddress(s):void 0;if(_.setAccountProp("balanceLoading",!0,r),e.lastRetry&&!ee.isAllowedRetry(e.lastRetry,30*Pe.ONE_SEC_MS))return _.setAccountProp("balanceLoading",!1,r),[];try{if(i&&n&&r){const o=await Qf.getMyTokensWithBalance();return _.setAccountProp("tokenBalance",o,r),_.setAccountProp("lastRetry",void 0,r),_.setAccountProp("balanceLoading",!1,r),o}}catch(o){_.setAccountProp("lastRetry",Date.now(),r),t?.(o),yr.showError("Token Balance Unavailable")}finally{_.setAccountProp("balanceLoading",!1,r)}return[]}},_=Fn(Lb),pS={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=_.state.activeCaipNetwork,r=_.state.activeChain,s=he.state.data;if(t.id===n?.id)return;const o=!!_.getAccountData(r)?.address,a=!!_.getAccountData(t.chainNamespace)?.address,c=t.chainNamespace!==r,u=K.getConnectorId(r)===D.CONNECTOR_ID.AUTH,d=D.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(h=>h===t.chainNamespace);e||u&&d?he.push("SwitchNetwork",{...s,network:t}):o&&c&&!a?he.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):he.push("SwitchNetwork",{...s,network:t})}},Yt=Ye({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),gS={state:Yt,subscribe(t){return Rt(Yt,()=>t(Yt))},subscribeKey(t,e){return _t(Yt,t,e)},async open(t){const e=t?.namespace,n=_.state.activeChain,r=e&&e!==n,s=_.getAccountData(t?.namespace)?.caipAddress,i=_.state.noAdapters;if(X.state.wcBasic?de.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1,fetchWalletRanks:!1}):await de.prefetch(),K.setFilterByNamespace(t?.namespace),_e.setLoading(!0,e),e&&r){const o=_.getNetworkData(e)?.caipNetwork||_.getRequestedCaipNetworks(e)[0];o&&(i?(await _.switchActiveNetwork(o),he.push("ConnectingWalletConnectBasic")):pS.onSwitchNetwork({network:o,ignoreSwitchConfirmation:!0}))}else F.state.manualWCControl||i&&!s?ee.isMobile()?he.reset("AllWallets"):he.reset("ConnectingWalletConnectBasic"):t?.view?he.reset(t.view,t.data):s?he.reset("Account"):he.reset("Connect");Yt.open=!0,Xn.set({open:!0}),Se.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=F.state.enableEmbedded,e=!!_.state.activeCaipAddress;Yt.open&&Se.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),Yt.open=!1,he.reset("Connect"),_e.clearLoading(),t?e?he.replace("Account"):he.push("Connect"):Xn.set({open:!1}),X.resetUri()},setLoading(t,e){e&&Yt.loadingNamespaceMap.set(e,t),Yt.loading=t,Xn.set({loading:t})},clearLoading(){Yt.loadingNamespaceMap.clear(),Yt.loading=!1,Xn.set({loading:!1})},shake(){Yt.shake||(Yt.shake=!0,setTimeout(()=>{Yt.shake=!1},500))}},_e=Fn(gS),Ol={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0,sui:void 0,stacks:void 0},Zt=Ye({providers:{...Ol},providerIds:{...Ol}}),He={state:Zt,subscribeKey(t,e){return _t(Zt,t,e)},subscribe(t){return Rt(Zt,()=>{t(Zt)})},subscribeProviders(t){return Rt(Zt.providers,()=>t(Zt.providers))},setProvider(t,e){t&&e&&(Zt.providers[t]=so(e))},getProvider(t){if(t)return Zt.providers[t]},setProviderId(t,e){e&&(Zt.providerIds[t]=e)},getProviderId(t){if(t)return Zt.providerIds[t]},reset(){Zt.providers={...Ol},Zt.providerIds={...Ol}},resetChain(t){Zt.providers[t]=void 0,Zt.providerIds[t]=void 0}},ia={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},Th={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},mS={providers:lw,selectedProvider:null,error:null,purchaseCurrency:ia,paymentCurrency:Th,purchaseCurrencies:[ia],paymentCurrencies:[],quotesLoading:!1},Re=Ye(mS),yS={state:Re,subscribe(t){return Rt(Re,()=>t(Re))},subscribeKey(t,e){return _t(Re,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=_.state.activeChain,n=e===D.CHAIN.SOLANA?"SOL":"USDC",r=e?_.state.chains.get(e)?.accountState?.address??"":"",s=new URL(t.url);s.searchParams.append("publicKey",LC),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",F.state.projectId),Re.selectedProvider={...t,url:s.toString()}}else Re.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=lw.filter(r=>e.includes(r.name));Re.providers=n}else Re.providers=[]},setPurchaseCurrency(t){Re.purchaseCurrency=t},setPaymentCurrency(t){Re.paymentCurrency=t},setPurchaseAmount(t){Ph.state.purchaseAmount=t},setPaymentAmount(t){Ph.state.paymentAmount=t},async getAvailableCurrencies(){const t=await ge.getOnrampOptions();Re.purchaseCurrencies=t.purchaseCurrencies,Re.paymentCurrencies=t.paymentCurrencies,Re.paymentCurrency=t.paymentCurrencies[0]||Th,Re.purchaseCurrency=t.purchaseCurrencies[0]||ia,await de.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await de.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){Re.quotesLoading=!0;try{const t=await ge.getOnrampQuote({purchaseCurrency:Re.purchaseCurrency,paymentCurrency:Re.paymentCurrency,amount:Re.paymentAmount?.toString()||"0",network:Re.purchaseCurrency?.symbol});return Re.quotesLoading=!1,Re.purchaseAmount=Number(t?.purchaseAmount.amount),t}catch(t){return Re.error=t.message,Re.quotesLoading=!1,null}finally{Re.quotesLoading=!1}},resetState(){Re.selectedProvider=null,Re.error=null,Re.purchaseCurrency=ia,Re.paymentCurrency=Th,Re.purchaseCurrencies=[ia],Re.paymentCurrencies=[],Re.paymentAmount=void 0,Re.purchaseAmount=void 0,Re.quotesLoading=!1}},Ph=Fn(yS),Wn=Ye({message:"",variant:"info",open:!1}),wS={state:Wn,subscribeKey(t,e){return _t(Wn,t,e)},open(t,e){const{debug:n}=F.state,{code:r,displayMessage:s,debugMessage:i}=t;s&&n&&(Wn.message=s,Wn.variant=e,Wn.open=!0),i&&console.error(typeof i=="function"?i():i,r?{code:r}:void 0)},warn(t,e,n){Wn.open=!0,Wn.message=t,Wn.variant="warning",e&&console.warn(e,n)},close(){Wn.open=!1,Wn.message="",Wn.variant="info"}},rt=Fn(wS),N0=2147483648,bS={convertEVMChainIdToCoinType(t){if(t>=N0)throw new Error("Invalid chainId");return(N0|t)>>>0}},Cn=Ye({suggestions:[],loading:!1}),ES={state:Cn,subscribe(t){return Rt(Cn,()=>t(Cn))},subscribeKey(t,e){return _t(Cn,t,e)},async resolveName(t){try{return await ge.lookupEnsName(t)}catch(e){const n=e;throw new Error(n?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(t){try{return await ge.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{Cn.loading=!0,Cn.suggestions=[];const e=await ge.getEnsNameSuggestions(t);return Cn.suggestions=e.suggestions||[],Cn.suggestions}catch(e){const n=oa.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{Cn.loading=!1}},async getNamesForAddress(t){try{if(!_.state.activeCaipNetwork)return[];const n=j.getEnsFromCacheForAddress(t);if(n)return n;const r=await ge.reverseLookupEnsName({address:t});return j.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=oa.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=_.state.activeCaipNetwork,n=_.getAccountData(e?.chainNamespace)?.address,r=K.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");Cn.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});he.pushTransactionStack({onCancel(){he.replace("RegisterAccountName")}});const i=await X.signMessage(s);Cn.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=bS.convertEVMChainIdToCoinType(Number(o));await ge.registerEnsName({coinType:a,address:n,signature:i,message:s}),_.setAccountProp("profileName",t,e.chainNamespace),j.updateEnsCache({address:n,ens:[{name:t,registered_at:new Date().toISOString(),updated_at:void 0,addresses:{},attributes:[]}],timestamp:Date.now()}),he.replace("RegisterAccountNameSuccess")}catch(s){const i=oa.parseEnsApiError(s,`Error registering name ${t}`);throw he.replace("RegisterAccountName"),new Error(i)}finally{Cn.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){return t?.reasons?.[0]?.description||e}},oa=Fn(ES),vS={eip155:{native:{assetNamespace:"slip44",assetReference:"60"},defaultTokenNamespace:"erc20"},solana:{native:{assetNamespace:"slip44",assetReference:"501"},defaultTokenNamespace:"token"}};class CS extends Error{}function _S(){const{sdkType:t,sdkVersion:e,projectId:n}=F.getSnapshot(),r=new URL("https://rpc.walletconnect.org/v1/json-rpc");return r.searchParams.set("projectId",n),r.searchParams.set("st",t),r.searchParams.set("sv",e),r.searchParams.set("source","fund-wallet"),r.toString()}async function ep(t,e){const n=_S(),{projectId:r}=F.getSnapshot(),s={jsonrpc:"2.0",id:1,method:t,params:{...e||{},projectId:r}},o=await(await fetch(n,{method:"POST",body:JSON.stringify(s),headers:{"Content-Type":"application/json"}})).json();if(o.error)throw new CS(o.error.message);return o}async function Fj(t){return(await ep("reown_getExchanges",t)).result}async function jj(t){return(await ep("reown_getExchangePayUrl",t)).result}async function Hj(t){return(await ep("reown_getExchangeBuyStatus",t)).result}function qj(t,e){const{chainNamespace:n,chainId:r}=xt.parseCaipNetworkId(t),s=vS[n];if(!s)throw new Error(`Unsupported chain namespace for CAIP-19 formatting: ${n}`);let i=s.native.assetNamespace,o=s.native.assetReference;return e!=="native"&&(i=s.defaultTokenNamespace,o=e),`${`${n}:${r}`}/${i}:${o}`}const AS={network:"eip155:1",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},IS={network:"eip155:8453",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},Bb={network:"eip155:8453",asset:"0x833589fcd6edb6e08f4c7c32d4f71b54bda02913",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},SS={asset:"0x036CbD53842c5426634e7929541eC2318f3dCF7e"},NS={network:"eip155:84532",asset:"native",metadata:{name:"Ethereum",symbol:"ETH",decimals:18}},TS={network:"eip155:1",asset:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},PS={network:"eip155:42161",asset:"0xaf88d065e77c8cC2239327C5EDb3A432268e5831",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},xS={network:"eip155:137",asset:"0x2791bca1f2de4661ed88a30c99a7a9449aa84174",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},RS={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v",metadata:{name:"USD Coin",symbol:"USDC",decimals:6}},OS={network:"eip155:1",asset:"0xdAC17F958D2ee523a2206206994597C13D831ec7",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},kS={network:"eip155:10",asset:"0x94b008aA00579c1307B0EF2c499aD98a8ce58e58",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},DS={network:"eip155:42161",asset:"0xFd086bC7CD5C481DCC9C85ebE478A1C0b69FCbb9",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},$S={network:"eip155:137",asset:"0xc2132d05d31c914a87c6611c10748aeb04b58e8f",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},US={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB",metadata:{name:"Tether USD",symbol:"USDT",decimals:6}},MS={network:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",asset:"native",metadata:{name:"Solana",symbol:"SOL",decimals:9}},LS={ethereumETH:AS,baseETH:IS,baseUSDC:Bb,baseSepoliaETH:NS,ethereumUSDC:TS,arbitrumUSDC:PS,polygonUSDC:xS,solanaUSDC:RS,ethereumUSDT:OS,optimismUSDT:kS,arbitrumUSDT:DS,polygonUSDT:$S,solanaUSDT:US,solanaSOL:MS};function Wj(t){return Object.values(LS).filter(e=>e.network===t)}var Mc={exports:{}},T0;function BS(){if(T0)return Mc.exports;T0=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(y,w,S){return Function.prototype.apply.call(y,w,S)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(y){return Object.getOwnPropertyNames(y).concat(Object.getOwnPropertySymbols(y))}:n=function(y){return Object.getOwnPropertyNames(y)};function r(N){console&&console.warn&&console.warn(N)}var s=Number.isNaN||function(y){return y!==y};function i(){i.init.call(this)}Mc.exports=i,Mc.exports.once=b,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var o=10;function a(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(N){if(typeof N!="number"||N<0||s(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");o=N}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(y){if(typeof y!="number"||y<0||s(y))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+y+".");return this._maxListeners=y,this};function c(N){return N._maxListeners===void 0?i.defaultMaxListeners:N._maxListeners}i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(y){for(var w=[],S=1;S<arguments.length;S++)w.push(arguments[S]);var P=y==="error",A=this._events;if(A!==void 0)P=P&&A.error===void 0;else if(!P)return!1;if(P){var x;if(w.length>0&&(x=w[0]),x instanceof Error)throw x;var R=new Error("Unhandled error."+(x?" ("+x.message+")":""));throw R.context=x,R}var O=A[y];if(O===void 0)return!1;if(typeof O=="function")e(O,this,w);else for(var L=O.length,$=p(O,L),S=0;S<L;++S)e($[S],this,w);return!0};function l(N,y,w,S){var P,A,x;if(a(w),A=N._events,A===void 0?(A=N._events=Object.create(null),N._eventsCount=0):(A.newListener!==void 0&&(N.emit("newListener",y,w.listener?w.listener:w),A=N._events),x=A[y]),x===void 0)x=A[y]=w,++N._eventsCount;else if(typeof x=="function"?x=A[y]=S?[w,x]:[x,w]:S?x.unshift(w):x.push(w),P=c(N),P>0&&x.length>P&&!x.warned){x.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(y)+" listeners added. Use emitter.setMaxListeners() to increase limit");R.name="MaxListenersExceededWarning",R.emitter=N,R.type=y,R.count=x.length,r(R)}return N}i.prototype.addListener=function(y,w){return l(this,y,w,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(y,w){return l(this,y,w,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(N,y,w){var S={fired:!1,wrapFn:void 0,target:N,type:y,listener:w},P=u.bind(S);return P.listener=w,S.wrapFn=P,P}i.prototype.once=function(y,w){return a(w),this.on(y,d(this,y,w)),this},i.prototype.prependOnceListener=function(y,w){return a(w),this.prependListener(y,d(this,y,w)),this},i.prototype.removeListener=function(y,w){var S,P,A,x,R;if(a(w),P=this._events,P===void 0)return this;if(S=P[y],S===void 0)return this;if(S===w||S.listener===w)--this._eventsCount===0?this._events=Object.create(null):(delete P[y],P.removeListener&&this.emit("removeListener",y,S.listener||w));else if(typeof S!="function"){for(A=-1,x=S.length-1;x>=0;x--)if(S[x]===w||S[x].listener===w){R=S[x].listener,A=x;break}if(A<0)return this;A===0?S.shift():g(S,A),S.length===1&&(P[y]=S[0]),P.removeListener!==void 0&&this.emit("removeListener",y,R||w)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(y){var w,S,P;if(S=this._events,S===void 0)return this;if(S.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):S[y]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete S[y]),this;if(arguments.length===0){var A=Object.keys(S),x;for(P=0;P<A.length;++P)x=A[P],x!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(w=S[y],typeof w=="function")this.removeListener(y,w);else if(w!==void 0)for(P=w.length-1;P>=0;P--)this.removeListener(y,w[P]);return this};function h(N,y,w){var S=N._events;if(S===void 0)return[];var P=S[y];return P===void 0?[]:typeof P=="function"?w?[P.listener||P]:[P]:w?m(P):p(P,P.length)}i.prototype.listeners=function(y){return h(this,y,!0)},i.prototype.rawListeners=function(y){return h(this,y,!1)},i.listenerCount=function(N,y){return typeof N.listenerCount=="function"?N.listenerCount(y):f.call(N,y)},i.prototype.listenerCount=f;function f(N){var y=this._events;if(y!==void 0){var w=y[N];if(typeof w=="function")return 1;if(w!==void 0)return w.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function p(N,y){for(var w=new Array(y),S=0;S<y;++S)w[S]=N[S];return w}function g(N,y){for(;y+1<N.length;y++)N[y]=N[y+1];N.pop()}function m(N){for(var y=new Array(N.length),w=0;w<y.length;++w)y[w]=N[w].listener||N[w];return y}function b(N,y){return new Promise(function(w,S){function P(x){N.removeListener(y,A),S(x)}function A(){typeof N.removeListener=="function"&&N.removeListener("error",P),w([].slice.call(arguments))}C(N,y,A,{once:!0}),y!=="error"&&v(N,P,{once:!0})})}function v(N,y,w){typeof N.on=="function"&&C(N,"error",y,w)}function C(N,y,w,S){if(typeof N.on=="function")S.once?N.once(y,w):N.on(y,w);else if(typeof N.addEventListener=="function")N.addEventListener(y,function P(A){S.once&&N.removeEventListener(y,P),w(A)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}return Mc.exports}var jn=BS();const tp=Pf(jn);var rd={};const yc=Qv(Yv);var sd={},Mo={},P0;function FS(){if(P0)return Mo;P0=1,Object.defineProperty(Mo,"__esModule",{value:!0}),Mo.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return Mo.delay=t,Mo}var Us={},id={},Ms={},x0;function jS(){return x0||(x0=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.ONE_THOUSAND=Ms.ONE_HUNDRED=void 0,Ms.ONE_HUNDRED=100,Ms.ONE_THOUSAND=1e3),Ms}var od={},R0;function HS(){return R0||(R0=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(od)),od}var O0;function Fb(){return O0||(O0=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yc;e.__exportStar(jS(),t),e.__exportStar(HS(),t)})(id)),id}var k0;function qS(){if(k0)return Us;k0=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.fromMiliseconds=Us.toMiliseconds=void 0;const t=Fb();function e(r){return r*t.ONE_THOUSAND}Us.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return Us.fromMiliseconds=n,Us}var D0;function WS(){return D0||(D0=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yc;e.__exportStar(FS(),t),e.__exportStar(qS(),t)})(sd)),sd}var Pi={},$0;function zS(){if($0)return Pi;$0=1,Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Pi.Watch=t,Pi.default=t,Pi}var ad={},Lo={},U0;function VS(){if(U0)return Lo;U0=1,Object.defineProperty(Lo,"__esModule",{value:!0}),Lo.IWatch=void 0;class t{}return Lo.IWatch=t,Lo}var M0;function KS(){return M0||(M0=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0}),yc.__exportStar(VS(),t)})(ad)),ad}var L0;function GS(){return L0||(L0=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yc;e.__exportStar(WS(),t),e.__exportStar(zS(),t),e.__exportStar(KS(),t),e.__exportStar(Fb(),t)})(rd)),rd}var Y=GS();class Ci{}let YS=class extends Ci{constructor(e){super()}};const B0=Y.FIVE_SECONDS,_i={pulse:"heartbeat_pulse"};let ZS=class jb extends YS{constructor(e){super(e),this.events=new jn.EventEmitter,this.interval=B0,this.interval=e?.interval||B0}static async init(e){const n=new jb(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Y.toMiliseconds(this.interval))}pulse(){this.events.emit(_i.pulse)}};const JS=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,XS=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,QS=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function e5(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){t5(t);return}return e}function t5(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Lc(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!QS.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(JS.test(t)||XS.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,e5)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function n5(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Et(t,...e){try{return n5(t(...e))}catch(n){return Promise.reject(n)}}function r5(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function s5(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function cl(t){if(r5(t))return String(t);if(s5(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return cl(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const xh="base64:";function i5(t){return typeof t=="string"?t:xh+c5(t)}function o5(t){return typeof t!="string"||!t.startsWith(xh)?t:a5(t.slice(xh.length))}function a5(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function c5(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function Qt(t){return t&&t.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function l5(...t){return Qt(t.join(":"))}function Bc(t){return t=Qt(t),t?t+":":""}function u5(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function d5(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const h5="memory",f5=()=>{const t=new Map;return{name:h5,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function p5(t={}){const e={mounts:{"":t.driver||f5()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=Qt(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await F0(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,f=p=>{let g=h.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},h.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",m=Qt(g?p:p.key),b=g?void 0:p.value,v=g||!p.options?u:{...u,...p.options},C=n(m);f(C).items.push({key:m,value:b,relativeKey:C.relativeKey,options:v})}return Promise.all([...h.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=Qt(l);const{relativeKey:d,driver:h}=n(l);return Et(h.hasItem,d,u)},getItem(l,u={}){l=Qt(l);const{relativeKey:d,driver:h}=n(l);return Et(h.getItem,d,u).then(f=>Lc(f))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Et(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(f=>({key:l5(d.base,f.key),value:Lc(f.value)}))):Promise.all(d.items.map(h=>Et(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:Lc(f)})))))},getItemRaw(l,u={}){l=Qt(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?Et(h.getItemRaw,d,u):Et(h.getItem,d,u).then(f=>o5(f))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=Qt(l);const{relativeKey:h,driver:f}=n(l);f.setItem&&(await Et(f.setItem,h,cl(u),d),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Et(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:cl(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>Et(d.driver.setItem,h.relativeKey,cl(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=Qt(l);const{relativeKey:h,driver:f}=n(l);if(f.setItemRaw)await Et(f.setItemRaw,h,u,d);else if(f.setItem)await Et(f.setItem,h,i5(u),d);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=Qt(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await Et(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Et(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=Qt(l);const{relativeKey:d,driver:h}=n(l),f=Object.create(null);if(h.getMeta&&Object.assign(f,await Et(h.getMeta,d,u)),!u.nativeOnly){const p=await Et(h.getItem,d+"$",u).then(g=>Lc(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){l=Bc(l);const d=r(l,!0);let h=[];const f=[];let p=!0;for(const m of d){m.driver.flags?.maxDepth||(p=!1);const b=await Et(m.driver.getKeys,m.relativeBase,u);for(const v of b){const C=m.mountpoint+Qt(v);h.some(N=>C.startsWith(N))||f.push(C)}h=[m.mountpoint,...h.filter(v=>!v.startsWith(m.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return f.filter(m=>(!g||u5(m,u.maxDepth))&&d5(m,l))},async clear(l,u={}){l=Bc(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return Et(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(f=>d.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>j0(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=Bc(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(F0(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){l=Bc(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&(e.unwatch[l]?.(),delete e.unwatch[l]),u&&await j0(e.mounts[l]),e.mountpoints=e.mountpoints.filter(d=>d!==l),delete e.mounts[l])},getMount(l=""){l=Qt(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=Qt(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function F0(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function j0(t){typeof t.dispose=="function"&&await Et(t.dispose)}function Ai(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function Hb(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=Ai(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let cd;function wc(){return cd||(cd=Hb("keyval-store","keyval")),cd}function H0(t,e=wc()){return e("readonly",n=>Ai(n.get(t)))}function g5(t,e,n=wc()){return n("readwrite",r=>(r.put(e,t),Ai(r.transaction)))}function m5(t,e=wc()){return e("readwrite",n=>(n.delete(t),Ai(n.transaction)))}function y5(t=wc()){return t("readwrite",e=>(e.clear(),Ai(e.transaction)))}function w5(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Ai(t.transaction)}function b5(t=wc()){return t("readonly",e=>{if(e.getAllKeys)return Ai(e.getAllKeys());const n=[];return w5(e,r=>n.push(r.key)).then(()=>n)})}const E5=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),v5=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function di(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return v5(t)}catch{return t}}function Zr(t){return typeof t=="string"?t:E5(t)||""}const C5="idb-keyval";var _5=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=Hb(t.dbName,t.storeName)),{name:C5,options:t,async hasItem(s){return!(typeof await H0(n(s),r)>"u")},async getItem(s){return await H0(n(s),r)??null},setItem(s,i){return g5(n(s),i,r)},removeItem(s){return m5(n(s),r)},getKeys(){return b5(r)},clear(){return y5(r)}}};const A5="WALLET_CONNECT_V2_INDEXED_DB",I5="keyvaluestorage";let S5=class{constructor(){this.indexedDb=p5({driver:_5({dbName:A5,storeName:I5})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,Zr(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ll={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof ld<"u"&&ld.localStorage?ll.exports=ld.localStorage:typeof window<"u"&&window.localStorage?ll.exports=window.localStorage:ll.exports=new e})();function N5(t){var e;return[t[0],di((e=t[1])!=null?e:"")]}let T5=class{constructor(){this.localStorage=ll.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(N5)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return di(n)}async setItem(e,n){this.localStorage.setItem(e,Zr(n))}async removeItem(e){this.localStorage.removeItem(e)}};const P5="wc_storage_version",q0=1,x5=async(t,e,n)=>{const r=P5,s=await e.getItem(r);if(s&&s>=q0){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,q0),n(e),R5(t,o)},R5=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let O5=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new T5;this.storage=e;try{const n=new S5;x5(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};var ud,W0;function k5(){if(W0)return ud;W0=1;function t(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}ud=e;function e(n,r,s){var i=s&&s.stringify||t,o=1;if(typeof n=="object"&&n!==null){var a=r.length+o;if(a===1)return n;var c=new Array(a);c[0]=i(n);for(var l=1;l<a;l++)c[l]=i(r[l]);return c.join(" ")}if(typeof n!="string")return n;var u=r.length;if(u===0)return n;for(var d="",h=1-o,f=-1,p=n&&n.length||0,g=0;g<p;){if(n.charCodeAt(g)===37&&g+1<p){switch(f=f>-1?f:0,n.charCodeAt(g+1)){case 100:case 102:if(h>=u||r[h]==null)break;f<g&&(d+=n.slice(f,g)),d+=Number(r[h]),f=g+2,g++;break;case 105:if(h>=u||r[h]==null)break;f<g&&(d+=n.slice(f,g)),d+=Math.floor(Number(r[h])),f=g+2,g++;break;case 79:case 111:case 106:if(h>=u||r[h]===void 0)break;f<g&&(d+=n.slice(f,g));var m=typeof r[h];if(m==="string"){d+="'"+r[h]+"'",f=g+2,g++;break}if(m==="function"){d+=r[h].name||"<anonymous>",f=g+2,g++;break}d+=i(r[h]),f=g+2,g++;break;case 115:if(h>=u)break;f<g&&(d+=n.slice(f,g)),d+=String(r[h]),f=g+2,g++;break;case 37:f<g&&(d+=n.slice(f,g)),d+="%",f=g+2,g++,h--;break}++h}++g}return f===-1?n:(f<p&&(d+=n.slice(f)),d)}return ud}var dd,z0;function D5(){if(z0)return dd;z0=1;const t=k5();dd=s;const e=y().console||{},n={mapHttpRequest:p,mapHttpResponse:p,wrapRequestSerializer:g,wrapResponseSerializer:g,wrapErrorSerializer:g,req:p,res:p,err:h};function r(w,S){return Array.isArray(w)?w.filter(function(A){return A!=="!stdSerializers.err"}):w===!0?Object.keys(S):!1}function s(w){w=w||{},w.browser=w.browser||{};const S=w.browser.transmit;if(S&&typeof S.send!="function")throw Error("pino: transmit option must have a send function");const P=w.browser.write||e;w.browser.write&&(w.browser.asObject=!0);const A=w.serializers||{},x=r(w.browser.serialize,A);let R=w.browser.serialize;Array.isArray(w.browser.serialize)&&w.browser.serialize.indexOf("!stdSerializers.err")>-1&&(R=!1);const O=["error","fatal","warn","info","debug","trace"];typeof P=="function"&&(P.error=P.fatal=P.warn=P.info=P.debug=P.trace=P),w.enabled===!1&&(w.level="silent");const L=w.level||"info",$=Object.create(P);$.log||($.log=m),Object.defineProperty($,"levelVal",{get:T}),Object.defineProperty($,"level",{get:k,set:B});const I={transmit:S,serialize:x,asObject:w.browser.asObject,levels:O,timestamp:f(w)};$.levels=s.levels,$.level=L,$.setMaxListeners=$.getMaxListeners=$.emit=$.addListener=$.on=$.prependListener=$.once=$.prependOnceListener=$.removeListener=$.removeAllListeners=$.listeners=$.listenerCount=$.eventNames=$.write=$.flush=m,$.serializers=A,$._serialize=x,$._stdErrSerialize=R,$.child=U,S&&($._logEvent=d());function T(){return this.level==="silent"?1/0:this.levels.values[this.level]}function k(){return this._level}function B(M){if(M!=="silent"&&!this.levels.values[M])throw Error("unknown level "+M);this._level=M,i(I,$,"error","log"),i(I,$,"fatal","error"),i(I,$,"warn","error"),i(I,$,"info","log"),i(I,$,"debug","log"),i(I,$,"trace","log")}function U(M,H){if(!M)throw new Error("missing bindings for child Pino");H=H||{},x&&M.serializers&&(H.serializers=M.serializers);const z=H.serializers;if(x&&z){var te=Object.assign({},A,z),Z=w.browser.serialize===!0?Object.keys(te):x;delete M.serializers,c([M],Z,te,this._stdErrSerialize)}function ae(pe){this._childLevel=(pe._childLevel|0)+1,this.error=l(pe,M,"error"),this.fatal=l(pe,M,"fatal"),this.warn=l(pe,M,"warn"),this.info=l(pe,M,"info"),this.debug=l(pe,M,"debug"),this.trace=l(pe,M,"trace"),te&&(this.serializers=te,this._serialize=Z),S&&(this._logEvent=d([].concat(pe._logEvent.bindings,M)))}return ae.prototype=this,new ae(this)}return $}s.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},s.stdSerializers=n,s.stdTimeFunctions=Object.assign({},{nullTime:b,epochTime:v,unixTime:C,isoTime:N});function i(w,S,P,A){const x=Object.getPrototypeOf(S);S[P]=S.levelVal>S.levels.values[P]?m:x[P]?x[P]:e[P]||e[A]||m,o(w,S,P)}function o(w,S,P){!w.transmit&&S[P]===m||(S[P]=(function(A){return function(){const R=w.timestamp(),O=new Array(arguments.length),L=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var $=0;$<O.length;$++)O[$]=arguments[$];if(w.serialize&&!w.asObject&&c(O,this._serialize,this.serializers,this._stdErrSerialize),w.asObject?A.call(L,a(this,P,O,R)):A.apply(L,O),w.transmit){const I=w.transmit.level||S.level,T=s.levels.values[I],k=s.levels.values[P];if(k<T)return;u(this,{ts:R,methodLevel:P,methodValue:k,transmitValue:s.levels.values[w.transmit.level||S.level],send:w.transmit.send,val:S.levelVal},O)}}})(S[P]))}function a(w,S,P,A){w._serialize&&c(P,w._serialize,w.serializers,w._stdErrSerialize);const x=P.slice();let R=x[0];const O={};A&&(O.time=A),O.level=s.levels.values[S];let L=(w._childLevel|0)+1;if(L<1&&(L=1),R!==null&&typeof R=="object"){for(;L--&&typeof x[0]=="object";)Object.assign(O,x.shift());R=x.length?t(x.shift(),x):void 0}else typeof R=="string"&&(R=t(x.shift(),x));return R!==void 0&&(O.msg=R),O}function c(w,S,P,A){for(const x in w)if(A&&w[x]instanceof Error)w[x]=s.stdSerializers.err(w[x]);else if(typeof w[x]=="object"&&!Array.isArray(w[x]))for(const R in w[x])S&&S.indexOf(R)>-1&&R in P&&(w[x][R]=P[R](w[x][R]))}function l(w,S,P){return function(){const A=new Array(1+arguments.length);A[0]=S;for(var x=1;x<A.length;x++)A[x]=arguments[x-1];return w[P].apply(this,A)}}function u(w,S,P){const A=S.send,x=S.ts,R=S.methodLevel,O=S.methodValue,L=S.val,$=w._logEvent.bindings;c(P,w._serialize||Object.keys(w.serializers),w.serializers,w._stdErrSerialize===void 0?!0:w._stdErrSerialize),w._logEvent.ts=x,w._logEvent.messages=P.filter(function(I){return $.indexOf(I)===-1}),w._logEvent.level.label=R,w._logEvent.level.value=O,A(R,w._logEvent,L),w._logEvent=d($)}function d(w){return{ts:0,messages:[],bindings:w||[],level:{label:"",value:0}}}function h(w){const S={type:w.constructor.name,msg:w.message,stack:w.stack};for(const P in w)S[P]===void 0&&(S[P]=w[P]);return S}function f(w){return typeof w.timestamp=="function"?w.timestamp:w.timestamp===!1?b:v}function p(){return{}}function g(w){return w}function m(){}function b(){return!1}function v(){return Date.now()}function C(){return Math.round(Date.now()/1e3)}function N(){return new Date(Date.now()).toISOString()}function y(){function w(S){return typeof S<"u"&&S}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return w(self)||w(window)||w(this)||{}}}return dd}var Gi=D5();const bc=Pf(Gi),$5={level:"info"},Ec="custom_context",np=1e3*1024;let U5=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},V0=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new U5(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}},qb=class{constructor(e,n=np){this.level=e??"error",this.levelValue=Gi.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new V0(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===Gi.levels.values.error?console.error(e):n===Gi.levels.values.warn?console.warn(e):n===Gi.levels.values.debug?console.debug(e):n===Gi.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Zr({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new V0(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(Zr({extraMetadata:e})),new Blob(n,{type:"application/json"})}},M5=class{constructor(e,n=np){this.baseChunkLogger=new qb(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},L5=class{constructor(e,n=np){this.baseChunkLogger=new qb(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var B5=Object.defineProperty,F5=Object.defineProperties,j5=Object.getOwnPropertyDescriptors,K0=Object.getOwnPropertySymbols,H5=Object.prototype.hasOwnProperty,q5=Object.prototype.propertyIsEnumerable,G0=(t,e,n)=>e in t?B5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kl=(t,e)=>{for(var n in e||(e={}))H5.call(e,n)&&G0(t,n,e[n]);if(K0)for(var n of K0(e))q5.call(e,n)&&G0(t,n,e[n]);return t},Dl=(t,e)=>F5(t,j5(e));function Co(t){return Dl(kl({},t),{level:t?.level||$5.level})}function W5(t,e=Ec){return t[e]||""}function z5(t,e,n=Ec){return t[n]=e,t}function hn(t,e=Ec){let n="";return typeof t.bindings>"u"?n=W5(t,e):n=t.bindings().context||"",n}function V5(t,e,n=Ec){const r=hn(t,n);return r.trim()?`${r}/${e}`:e}function jt(t,e,n=Ec){const r=V5(t,e,n),s=t.child({context:r});return z5(s,r,n)}function K5(t){var e,n;const r=new M5((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:bc(Dl(kl({},t.opts),{level:"trace",browser:Dl(kl({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function G5(t){var e;const n=new L5((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:bc(Dl(kl({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function rp(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?K5(t):G5(t)}var Y5=Object.defineProperty,Z5=(t,e,n)=>e in t?Y5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Y0=(t,e,n)=>Z5(t,typeof e!="symbol"?e+"":e,n);let J5=class extends Ci{constructor(e){super(),this.opts=e,Y0(this,"protocol","wc"),Y0(this,"version",2)}};var X5=Object.defineProperty,Q5=(t,e,n)=>e in t?X5(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,e6=(t,e,n)=>Q5(t,e+"",n);let t6=class extends Ci{constructor(e,n){super(),this.core=e,this.logger=n,e6(this,"records",new Map)}},n6=class{constructor(e,n){this.logger=e,this.core=n}},r6=class extends Ci{constructor(e,n){super(),this.relayer=e,this.logger=n}},s6=class extends Ci{constructor(e){super()}},i6=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},o6=class extends Ci{constructor(e,n){super(),this.relayer=e,this.logger=n}},a6=class extends Ci{constructor(e,n){super(),this.core=e,this.logger=n}},c6=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},l6=class{constructor(e,n){this.projectId=e,this.logger=n}},u6=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var d6=Object.defineProperty,h6=(t,e,n)=>e in t?d6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Z0=(t,e,n)=>h6(t,typeof e!="symbol"?e+"":e,n);let f6=class{constructor(e){this.opts=e,Z0(this,"protocol","wc"),Z0(this,"version",2)}},p6=class{constructor(e){this.client=e}};function g6(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Wb(t,...e){if(!g6(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function J0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function m6(t,e){Wb(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const xi=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hd=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function y6(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function zb(t){return typeof t=="string"&&(t=y6(t)),Wb(t),t}let w6=class{clone(){return this._cloneInto()}};function b6(t){const e=r=>t().update(zb(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function Vb(t=32){if(xi&&typeof xi.getRandomValues=="function")return xi.getRandomValues(new Uint8Array(t));if(xi&&typeof xi.randomBytes=="function")return xi.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function E6(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}let v6=class extends w6{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=hd(this.buffer)}update(e){J0(this);const{view:n,buffer:r,blockLen:s}=this;e=zb(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=hd(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){J0(this),m6(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;E6(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=hd(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const Fc=BigInt(2**32-1),Rh=BigInt(32);function Kb(t,e=!1){return e?{h:Number(t&Fc),l:Number(t>>Rh&Fc)}:{h:Number(t>>Rh&Fc)|0,l:Number(t&Fc)|0}}function C6(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=Kb(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const _6=(t,e)=>BigInt(t>>>0)<<Rh|BigInt(e>>>0),A6=(t,e,n)=>t>>>n,I6=(t,e,n)=>t<<32-n|e>>>n,S6=(t,e,n)=>t>>>n|e<<32-n,N6=(t,e,n)=>t<<32-n|e>>>n,T6=(t,e,n)=>t<<64-n|e>>>n-32,P6=(t,e,n)=>t>>>n-32|e<<64-n,x6=(t,e)=>e,R6=(t,e)=>t,O6=(t,e,n)=>t<<n|e>>>32-n,k6=(t,e,n)=>e<<n|t>>>32-n,D6=(t,e,n)=>e<<n-32|t>>>64-n,$6=(t,e,n)=>t<<n-32|e>>>64-n;function U6(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const M6=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),L6=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,B6=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),F6=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,j6=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),H6=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Ee={fromBig:Kb,split:C6,toBig:_6,shrSH:A6,shrSL:I6,rotrSH:S6,rotrSL:N6,rotrBH:T6,rotrBL:P6,rotr32H:x6,rotr32L:R6,rotlSH:O6,rotlSL:k6,rotlBH:D6,rotlBL:$6,add:U6,add3L:M6,add3H:L6,add4L:B6,add4H:F6,add5H:H6,add5L:j6},[q6,W6]=Ee.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rs=new Uint32Array(80),ss=new Uint32Array(80);let z6=class extends v6{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let C=0;C<16;C++,n+=4)rs[C]=e.getUint32(n),ss[C]=e.getUint32(n+=4);for(let C=16;C<80;C++){const N=rs[C-15]|0,y=ss[C-15]|0,w=Ee.rotrSH(N,y,1)^Ee.rotrSH(N,y,8)^Ee.shrSH(N,y,7),S=Ee.rotrSL(N,y,1)^Ee.rotrSL(N,y,8)^Ee.shrSL(N,y,7),P=rs[C-2]|0,A=ss[C-2]|0,x=Ee.rotrSH(P,A,19)^Ee.rotrBH(P,A,61)^Ee.shrSH(P,A,6),R=Ee.rotrSL(P,A,19)^Ee.rotrBL(P,A,61)^Ee.shrSL(P,A,6),O=Ee.add4L(S,R,ss[C-7],ss[C-16]),L=Ee.add4H(O,w,x,rs[C-7],rs[C-16]);rs[C]=L|0,ss[C]=O|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:b,Hl:v}=this;for(let C=0;C<80;C++){const N=Ee.rotrSH(d,h,14)^Ee.rotrSH(d,h,18)^Ee.rotrBH(d,h,41),y=Ee.rotrSL(d,h,14)^Ee.rotrSL(d,h,18)^Ee.rotrBL(d,h,41),w=d&f^~d&g,S=h&p^~h&m,P=Ee.add5L(v,y,S,W6[C],ss[C]),A=Ee.add5H(P,b,N,w,q6[C],rs[C]),x=P|0,R=Ee.rotrSH(r,s,28)^Ee.rotrBH(r,s,34)^Ee.rotrBH(r,s,39),O=Ee.rotrSL(r,s,28)^Ee.rotrBL(r,s,34)^Ee.rotrBL(r,s,39),L=r&i^r&a^i&a,$=s&o^s&c^o&c;b=g|0,v=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Ee.add(l|0,u|0,A|0,x|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const I=Ee.add3L(x,O,$);r=Ee.add3H(I,A,R,L),s=I|0}({h:r,l:s}=Ee.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ee.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ee.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ee.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Ee.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Ee.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Ee.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:b,l:v}=Ee.add(this.Hh|0,this.Hl|0,b|0,v|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,b,v)}roundClean(){rs.fill(0),ss.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const V6=b6(()=>new z6);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const sp=BigInt(0),Gb=BigInt(1),K6=BigInt(2);function ip(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function op(t){if(!ip(t))throw new Error("Uint8Array expected")}function fd(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const G6=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ap(t){op(t);let e="";for(let n=0;n<t.length;n++)e+=G6[t[n]];return e}function Yb(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?sp:BigInt("0x"+t)}const Or={_0:48,_9:57,A:65,F:70,a:97,f:102};function X0(t){if(t>=Or._0&&t<=Or._9)return t-Or._0;if(t>=Or.A&&t<=Or.F)return t-(Or.A-10);if(t>=Or.a&&t<=Or.f)return t-(Or.a-10)}function Zb(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=X0(t.charCodeAt(i)),a=X0(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function Y6(t){return Yb(ap(t))}function ul(t){return op(t),Yb(ap(Uint8Array.from(t).reverse()))}function Jb(t,e){return Zb(t.toString(16).padStart(e*2,"0"))}function Oh(t,e){return Jb(t,e).reverse()}function kr(t,e,n){let r;if(typeof e=="string")try{r=Zb(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(ip(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function Q0(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];op(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const pd=t=>typeof t=="bigint"&&sp<=t;function Z6(t,e,n){return pd(t)&&pd(e)&&pd(n)&&e<=t&&t<n}function Bo(t,e,n,r){if(!Z6(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function J6(t){let e;for(e=0;t>sp;t>>=Gb,e+=1);return e}const X6=t=>(K6<<BigInt(t-1))-Gb,Q6={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||ip(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function cp(t,e,n={}){const r=(s,i,o)=>{const a=Q6[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function eg(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Ct=BigInt(0),ct=BigInt(1),qs=BigInt(2),eN=BigInt(3),kh=BigInt(4),tg=BigInt(5),ng=BigInt(8);function mt(t,e){const n=t%e;return n>=Ct?n:e+n}function tN(t,e,n){if(e<Ct)throw new Error("invalid exponent, negatives unsupported");if(n<=Ct)throw new Error("invalid modulus");if(n===ct)return Ct;let r=ct;for(;e>Ct;)e&ct&&(r=r*t%n),t=t*t%n,e>>=ct;return r}function or(t,e,n){let r=t;for(;e-- >Ct;)r*=r,r%=n;return r}function rg(t,e){if(t===Ct)throw new Error("invert: expected non-zero number");if(e<=Ct)throw new Error("invert: expected positive modulus, got "+e);let n=mt(t,e),r=e,s=Ct,i=ct;for(;n!==Ct;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==ct)throw new Error("invert: does not exist");return mt(s,e)}function nN(t){const e=(t-ct)/qs;let n,r,s;for(n=t-ct,r=0;n%qs===Ct;n/=qs,r++);for(s=qs;s<t&&tN(s,e,t)!==t-ct;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+ct)/kh;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+ct)/qs;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(l,ct<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function rN(t){if(t%kh===eN){const e=(t+ct)/kh;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%ng===tg){const e=(t-tg)/ng;return function(n,r){const s=n.mul(r,qs),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,qs),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return nN(t)}const sN=(t,e)=>(mt(t,e)&ct)===ct,iN=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function oN(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=iN.reduce((r,s)=>(r[s]="function",r),e);return cp(t,n)}function aN(t,e,n){if(n<Ct)throw new Error("invalid exponent, negatives unsupported");if(n===Ct)return t.ONE;if(n===ct)return e;let r=t.ONE,s=e;for(;n>Ct;)n&ct&&(r=t.mul(r,s)),s=t.sqr(s),n>>=ct;return r}function cN(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function Xb(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Qb(t,e,n=!1,r={}){if(t<=Ct)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=Xb(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:X6(s),ZERO:Ct,ONE:ct,create:c=>mt(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ct<=c&&c<t},is0:c=>c===Ct,isOdd:c=>(c&ct)===ct,neg:c=>mt(-c,t),eql:(c,l)=>c===l,sqr:c=>mt(c*c,t),add:(c,l)=>mt(c+l,t),sub:(c,l)=>mt(c-l,t),mul:(c,l)=>mt(c*l,t),pow:(c,l)=>aN(a,c,l),div:(c,l)=>mt(c*rg(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>rg(c,t),sqrt:r.sqrt||(c=>(o||(o=rN(t)),o(a,c))),invertBatch:c=>cN(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Oh(c,i):Jb(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?ul(c):Y6(c)}});return Object.freeze(a)}const sg=BigInt(0),jc=BigInt(1);function gd(t,e){const n=e.negate();return t?n:e}function e1(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function md(t,e){e1(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function lN(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function uN(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const yd=new WeakMap,t1=new WeakMap;function wd(t){return t1.get(t)||1}function dN(t,e){return{constTimeNegate:gd,hasPrecomputes(n){return wd(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>sg;)r&jc&&(s=s.add(i)),i=i.double(),r>>=jc;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=md(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=md(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=jc);const g=f,m=f+Math.abs(p)-1,b=h%2!==0,v=p<0;p===0?c=c.add(gd(b,r[g])):a=a.add(gd(v,r[m]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=md(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===sg)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=jc),f===0)continue;let p=r[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=yd.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&yd.set(r,s(i))),i},wNAFCached(n,r,s){const i=wd(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=wd(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){e1(r,e),t1.set(n,r),yd.delete(n)}}}function hN(t,e,n,r){if(lN(n,t),uN(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=J6(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function fN(t){return oN(t.Fp),cp(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Xb(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const zn=BigInt(0),Jt=BigInt(1),Hc=BigInt(2),pN=BigInt(8),gN={zip215:!0};function mN(t){const e=fN(t);return cp(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function yN(t){const e=mN(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Hc<<BigInt(a*8)-Jt,u=n.create,d=Qb(e.n,e.nBitLength),h=e.uvRatio||((I,T)=>{try{return{isValid:!0,value:n.sqrt(I*n.inv(T))}}catch{return{isValid:!1,value:zn}}}),f=e.adjustScalarBytes||(I=>I),p=e.domain||((I,T,k)=>{if(fd("phflag",k),T.length||k)throw new Error("Contexts/pre-hash are not supported");return I});function g(I,T){Bo("coordinate "+I,T,zn,l)}function m(I){if(!(I instanceof C))throw new Error("ExtendedPoint expected")}const b=eg((I,T)=>{const{ex:k,ey:B,ez:U}=I,M=I.is0();T==null&&(T=M?pN:n.inv(U));const H=u(k*T),z=u(B*T),te=u(U*T);if(M)return{x:zn,y:Jt};if(te!==Jt)throw new Error("invZ was invalid");return{x:H,y:z}}),v=eg(I=>{const{a:T,d:k}=e;if(I.is0())throw new Error("bad point: ZERO");const{ex:B,ey:U,ez:M,et:H}=I,z=u(B*B),te=u(U*U),Z=u(M*M),ae=u(Z*Z),pe=u(z*T),Be=u(Z*u(pe+te)),Le=u(ae+u(k*u(z*te)));if(Be!==Le)throw new Error("bad point: equation left != right (1)");const Ie=u(B*U),it=u(M*H);if(Ie!==it)throw new Error("bad point: equation left != right (2)");return!0});class C{constructor(T,k,B,U){this.ex=T,this.ey=k,this.ez=B,this.et=U,g("x",T),g("y",k),g("z",B),g("t",U),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(T){if(T instanceof C)throw new Error("extended point not allowed");const{x:k,y:B}=T||{};return g("x",k),g("y",B),new C(k,B,Jt,u(k*B))}static normalizeZ(T){const k=n.invertBatch(T.map(B=>B.ez));return T.map((B,U)=>B.toAffine(k[U])).map(C.fromAffine)}static msm(T,k){return hN(C,d,T,k)}_setWindowSize(T){w.setWindowSize(this,T)}assertValidity(){v(this)}equals(T){m(T);const{ex:k,ey:B,ez:U}=this,{ex:M,ey:H,ez:z}=T,te=u(k*z),Z=u(M*U),ae=u(B*z),pe=u(H*U);return te===Z&&ae===pe}is0(){return this.equals(C.ZERO)}negate(){return new C(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:T}=e,{ex:k,ey:B,ez:U}=this,M=u(k*k),H=u(B*B),z=u(Hc*u(U*U)),te=u(T*M),Z=k+B,ae=u(u(Z*Z)-M-H),pe=te+H,Be=pe-z,Le=te-H,Ie=u(ae*Be),it=u(pe*Le),At=u(ae*Le),Ds=u(Be*pe);return new C(Ie,it,Ds,At)}add(T){m(T);const{a:k,d:B}=e,{ex:U,ey:M,ez:H,et:z}=this,{ex:te,ey:Z,ez:ae,et:pe}=T;if(k===BigInt(-1)){const Bp=u((M-U)*(Z+te)),Fp=u((M+U)*(Z-te)),Bu=u(Fp-Bp);if(Bu===zn)return this.double();const jp=u(H*Hc*pe),Hp=u(z*Hc*ae),qp=Hp+jp,Wp=Fp+Bp,zp=Hp-jp,zv=u(qp*Bu),Vv=u(Wp*zp),Kv=u(qp*zp),Gv=u(Bu*Wp);return new C(zv,Vv,Gv,Kv)}const Be=u(U*te),Le=u(M*Z),Ie=u(z*B*pe),it=u(H*ae),At=u((U+M)*(te+Z)-Be-Le),Ds=it-Ie,Pc=it+Ie,Ni=u(Le-k*Be),Lu=u(At*Ds),Hv=u(Pc*Ni),qv=u(At*Ni),Wv=u(Ds*Pc);return new C(Lu,Hv,Wv,qv)}subtract(T){return this.add(T.negate())}wNAF(T){return w.wNAFCached(this,T,C.normalizeZ)}multiply(T){const k=T;Bo("scalar",k,Jt,r);const{p:B,f:U}=this.wNAF(k);return C.normalizeZ([B,U])[0]}multiplyUnsafe(T,k=C.ZERO){const B=T;return Bo("scalar",B,zn,r),B===zn?y:this.is0()||B===Jt?this:w.wNAFCachedUnsafe(this,B,C.normalizeZ,k)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return w.unsafeLadder(this,r).is0()}toAffine(T){return b(this,T)}clearCofactor(){const{h:T}=e;return T===Jt?this:this.multiplyUnsafe(T)}static fromHex(T,k=!1){const{d:B,a:U}=e,M=n.BYTES;T=kr("pointHex",T,M),fd("zip215",k);const H=T.slice(),z=T[M-1];H[M-1]=z&-129;const te=ul(H),Z=k?l:n.ORDER;Bo("pointHex.y",te,zn,Z);const ae=u(te*te),pe=u(ae-Jt),Be=u(B*ae-U);let{isValid:Le,value:Ie}=h(pe,Be);if(!Le)throw new Error("Point.fromHex: invalid y coordinate");const it=(Ie&Jt)===Jt,At=(z&128)!==0;if(!k&&Ie===zn&&At)throw new Error("Point.fromHex: x=0 and x_0=1");return At!==it&&(Ie=u(-Ie)),C.fromAffine({x:Ie,y:te})}static fromPrivateKey(T){return A(T).point}toRawBytes(){const{x:T,y:k}=this.toAffine(),B=Oh(k,n.BYTES);return B[B.length-1]|=T&Jt?128:0,B}toHex(){return ap(this.toRawBytes())}}C.BASE=new C(e.Gx,e.Gy,Jt,u(e.Gx*e.Gy)),C.ZERO=new C(zn,Jt,Jt,zn);const{BASE:N,ZERO:y}=C,w=dN(C,a*8);function S(I){return mt(I,r)}function P(I){return S(ul(I))}function A(I){const T=n.BYTES;I=kr("private key",I,T);const k=kr("hashed private key",i(I),2*T),B=f(k.slice(0,T)),U=k.slice(T,2*T),M=P(B),H=N.multiply(M),z=H.toRawBytes();return{head:B,prefix:U,scalar:M,point:H,pointBytes:z}}function x(I){return A(I).pointBytes}function R(I=new Uint8Array,...T){const k=Q0(...T);return P(i(p(k,kr("context",I),!!s)))}function O(I,T,k={}){I=kr("message",I),s&&(I=s(I));const{prefix:B,scalar:U,pointBytes:M}=A(T),H=R(k.context,B,I),z=N.multiply(H).toRawBytes(),te=R(k.context,z,M,I),Z=S(H+te*U);Bo("signature.s",Z,zn,r);const ae=Q0(z,Oh(Z,n.BYTES));return kr("result",ae,n.BYTES*2)}const L=gN;function $(I,T,k,B=L){const{context:U,zip215:M}=B,H=n.BYTES;I=kr("signature",I,2*H),T=kr("message",T),k=kr("publicKey",k,H),M!==void 0&&fd("zip215",M),s&&(T=s(T));const z=ul(I.slice(H,2*H));let te,Z,ae;try{te=C.fromHex(k,M),Z=C.fromHex(I.slice(0,H),M),ae=N.multiplyUnsafe(z)}catch{return!1}if(!M&&te.isSmallOrder())return!1;const pe=R(U,Z.toRawBytes(),te.toRawBytes(),T);return Z.add(te.multiplyUnsafe(pe)).subtract(ae).clearCofactor().equals(C.ZERO)}return N._setWindowSize(8),{CURVE:e,getPublicKey:x,sign:O,verify:$,ExtendedPoint:C,utils:{getExtendedPublicKey:A,randomPrivateKey:()=>o(n.BYTES),precompute(I=8,T=C.BASE){return T._setWindowSize(I),T.multiply(BigInt(3)),T}}}}BigInt(0),BigInt(1);const lp=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),ig=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const wN=BigInt(1),og=BigInt(2);BigInt(3);const bN=BigInt(5),EN=BigInt(8);function vN(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=lp,o=t*t%i*t%i,a=or(o,og,i)*o%i,c=or(a,wN,i)*t%i,l=or(c,bN,i)*c%i,u=or(l,e,i)*l%i,d=or(u,n,i)*u%i,h=or(d,r,i)*d%i,f=or(h,s,i)*h%i,p=or(f,s,i)*h%i,g=or(p,e,i)*l%i;return{pow_p_5_8:or(g,og,i)*t%i,b2:o}}function CN(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function _N(t,e){const n=lp,r=mt(e*e*e,n),s=mt(r*r*e,n),i=vN(t*s).pow_p_5_8;let o=mt(t*r*i,n);const a=mt(e*o*o,n),c=o,l=mt(o*ig,n),u=a===t,d=a===mt(-t,n),h=a===mt(-t*ig,n);return u&&(o=c),(d||h)&&(o=l),sN(o,n)&&(o=mt(-o,n)),{isValid:u||d,value:o}}const AN=Qb(lp,void 0,!0),IN={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:AN,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:EN,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:V6,randomBytes:Vb,adjustScalarBytes:CN,uvRatio:_N},n1=yN(IN),SN="EdDSA",NN="JWT",$l=".",gu="base64url",r1="utf8",s1="utf8",TN=":",PN="did",xN="key",ag="base58btc",RN="z",ON="K36",kN=32;function up(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function i1(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?up(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function o1(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=i1(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return up(n)}function DN(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,b=0,v=p.length;b!==v&&p[b]===0;)b++,g++;for(var C=(v-b)*u+1>>>0,N=new Uint8Array(C);b!==v;){for(var y=p[b],w=0,S=C-1;(y!==0||w<m)&&S!==-1;S--,w++)y+=256*N[S]>>>0,N[S]=y%a>>>0,y=y/a>>>0;if(y!==0)throw new Error("Non-zero carry");m=w,b++}for(var P=C-m;P!==C&&N[P]===0;)P++;for(var A=c.repeat(g);P<C;++P)A+=t.charAt(N[P]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,b=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,C=new Uint8Array(v);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var y=0,w=v-1;(N!==0||y<b)&&w!==-1;w--,y++)N+=a*C[w]>>>0,C[w]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");b=y,g++}if(p[g]!==" "){for(var S=v-b;S!==v&&C[S]===0;)S++;for(var P=new Uint8Array(m+(v-S)),A=m;S!==v;)P[A++]=C[S++];return P}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var $N=DN,UN=$N;const a1=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},MN=t=>new TextEncoder().encode(t),LN=t=>new TextDecoder().decode(t);let BN=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},FN=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return c1(this,e)}},jN=class{constructor(e){this.decoders=e}or(e){return c1(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const c1=(t,e)=>new jN({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let HN=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new BN(e,n,r),this.decoder=new FN(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const mu=({name:t,prefix:e,encode:n,decode:r})=>new HN(t,e,n,r),vc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=UN(n,e);return mu({prefix:t,name:e,encode:r,decode:i=>a1(s(i))})},qN=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},WN=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ot=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>mu({prefix:e,name:t,encode(s){return WN(s,r,n)},decode(s){return qN(s,r,n,t)}}),zN=mu({prefix:"\0",name:"identity",encode:t=>LN(t),decode:t=>MN(t)});var VN=Object.freeze({__proto__:null,identity:zN});const KN=Ot({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var GN=Object.freeze({__proto__:null,base2:KN});const YN=Ot({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ZN=Object.freeze({__proto__:null,base8:YN});const JN=vc({prefix:"9",name:"base10",alphabet:"0123456789"});var XN=Object.freeze({__proto__:null,base10:JN});const QN=Ot({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),eT=Ot({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var tT=Object.freeze({__proto__:null,base16:QN,base16upper:eT});const nT=Ot({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),rT=Ot({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sT=Ot({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),iT=Ot({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),oT=Ot({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),aT=Ot({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),cT=Ot({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),lT=Ot({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),uT=Ot({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var dT=Object.freeze({__proto__:null,base32:nT,base32upper:rT,base32pad:sT,base32padupper:iT,base32hex:oT,base32hexupper:aT,base32hexpad:cT,base32hexpadupper:lT,base32z:uT});const hT=vc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),fT=vc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var pT=Object.freeze({__proto__:null,base36:hT,base36upper:fT});const gT=vc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),mT=vc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var yT=Object.freeze({__proto__:null,base58btc:gT,base58flickr:mT});const wT=Ot({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),bT=Ot({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ET=Ot({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),vT=Ot({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var CT=Object.freeze({__proto__:null,base64:wT,base64pad:bT,base64url:ET,base64urlpad:vT});const l1=Array.from(""),_T=l1.reduce((t,e,n)=>(t[n]=e,t),[]),AT=l1.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function IT(t){return t.reduce((e,n)=>(e+=_T[n],e),"")}function ST(t){const e=[];for(const n of t){const r=AT[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const NT=mu({prefix:"",name:"base256emoji",encode:IT,decode:ST});var TT=Object.freeze({__proto__:null,base256emoji:NT}),PT=u1,cg=128,xT=-128,RT=Math.pow(2,31);function u1(t,e,n){e=e||[],n=n||0;for(var r=n;t>=RT;)e[n++]=t&255|cg,t/=128;for(;t&xT;)e[n++]=t&255|cg,t>>>=7;return e[n]=t|0,u1.bytes=n-r+1,e}var OT=Dh,kT=128,lg=127;function Dh(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw Dh.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&lg)<<s:(o&lg)*Math.pow(2,s),s+=7}while(o>=kT);return Dh.bytes=i-r,n}var DT=Math.pow(2,7),$T=Math.pow(2,14),UT=Math.pow(2,21),MT=Math.pow(2,28),LT=Math.pow(2,35),BT=Math.pow(2,42),FT=Math.pow(2,49),jT=Math.pow(2,56),HT=Math.pow(2,63),qT=function(t){return t<DT?1:t<$T?2:t<UT?3:t<MT?4:t<LT?5:t<BT?6:t<FT?7:t<jT?8:t<HT?9:10},WT={encode:PT,decode:OT,encodingLength:qT},d1=WT;const ug=(t,e,n=0)=>(d1.encode(t,e,n),e),dg=t=>d1.encodingLength(t),$h=(t,e)=>{const n=e.byteLength,r=dg(t),s=r+dg(n),i=new Uint8Array(s+n);return ug(t,i,0),ug(n,i,r),i.set(e,s),new zT(t,n,e,i)};let zT=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const h1=({name:t,code:e,encode:n})=>new VT(t,e,n);let VT=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?$h(this.code,n):n.then(r=>$h(this.code,r))}else throw Error("Unknown type, must be binary type")}};const f1=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),KT=h1({name:"sha2-256",code:18,encode:f1("SHA-256")}),GT=h1({name:"sha2-512",code:19,encode:f1("SHA-512")});var YT=Object.freeze({__proto__:null,sha256:KT,sha512:GT});const p1=0,ZT="identity",g1=a1,JT=t=>$h(p1,g1(t)),XT={code:p1,name:ZT,encode:g1,digest:JT};var QT=Object.freeze({__proto__:null,identity:XT});new TextEncoder,new TextDecoder;const hg={...VN,...GN,...ZN,...XN,...tT,...dT,...pT,...yT,...CT,...TT};({...YT,...QT});function m1(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const fg=m1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),bd=m1("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=i1(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),y1={utf8:fg,"utf-8":fg,hex:hg.base16,latin1:bd,ascii:bd,binary:bd,...hg};function yu(t,e="utf8"){const n=y1[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function _o(t,e="utf8"){const n=y1[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?up(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function pg(t){return di(yu(_o(t,gu),r1))}function Ul(t){return yu(_o(Zr(t),r1),gu)}function w1(t){const e=_o(ON,ag),n=RN+yu(o1([e,t]),ag);return[PN,xN,n].join(TN)}function eP(t){return yu(t,gu)}function tP(t){return _o(t,gu)}function nP(t){return _o([Ul(t.header),Ul(t.payload)].join($l),s1)}function rP(t){return[Ul(t.header),Ul(t.payload),eP(t.signature)].join($l)}function Uh(t){const e=t.split($l),n=pg(e[0]),r=pg(e[1]),s=tP(e[2]),i=_o(e.slice(0,2).join($l),s1);return{header:n,payload:r,signature:s,data:i}}function gg(t=Vb(kN)){const e=n1.getPublicKey(t);return{secretKey:o1([t,e]),publicKey:e}}async function sP(t,e,n,r,s=Y.fromMiliseconds(Date.now())){const i={alg:SN,typ:NN},o=w1(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=nP({header:i,payload:c}),u=n1.sign(l,r.secretKey.slice(0,32));return rP({header:i,payload:c,signature:u})}var Ve={},mg;function b1(){if(mg)return Ve;mg=1,Object.defineProperty(Ve,"__esModule",{value:!0}),Ve.getLocalStorage=Ve.getLocalStorageOrThrow=Ve.getCrypto=Ve.getCryptoOrThrow=Ve.getLocation=Ve.getLocationOrThrow=Ve.getNavigator=Ve.getNavigatorOrThrow=Ve.getDocument=Ve.getDocumentOrThrow=Ve.getFromWindowOrThrow=Ve.getFromWindow=void 0;function t(h){let f;return typeof window<"u"&&typeof window[h]<"u"&&(f=window[h]),f}Ve.getFromWindow=t;function e(h){const f=t(h);if(!f)throw new Error(`${h} is not defined in Window`);return f}Ve.getFromWindowOrThrow=e;function n(){return e("document")}Ve.getDocumentOrThrow=n;function r(){return t("document")}Ve.getDocument=r;function s(){return e("navigator")}Ve.getNavigatorOrThrow=s;function i(){return t("navigator")}Ve.getNavigator=i;function o(){return e("location")}Ve.getLocationOrThrow=o;function a(){return t("location")}Ve.getLocation=a;function c(){return e("crypto")}Ve.getCryptoOrThrow=c;function l(){return t("crypto")}Ve.getCrypto=l;function u(){return e("localStorage")}Ve.getLocalStorageOrThrow=u;function d(){return t("localStorage")}return Ve.getLocalStorage=d,Ve}var Jr=b1(),Fo={},yg;function iP(){if(yg)return Fo;yg=1,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.getWindowMetadata=void 0;const t=b1();function e(){let n,r;try{n=t.getDocumentOrThrow(),r=t.getLocationOrThrow()}catch{return null}function s(){const f=n.getElementsByTagName("link"),p=[];for(let g=0;g<f.length;g++){const m=f[g],b=m.getAttribute("rel");if(b&&b.toLowerCase().indexOf("icon")>-1){const v=m.getAttribute("href");if(v)if(v.toLowerCase().indexOf("https:")===-1&&v.toLowerCase().indexOf("http:")===-1&&v.indexOf("//")!==0){let C=r.protocol+"//"+r.host;if(v.indexOf("/")===0)C+=v;else{const N=r.pathname.split("/");N.pop();const y=N.join("/");C+=y+"/"+v}p.push(C)}else if(v.indexOf("//")===0){const C=r.protocol+v;p.push(C)}else p.push(v)}}return p}function i(...f){const p=n.getElementsByTagName("meta");for(let g=0;g<p.length;g++){const m=p[g],b=["itemprop","property","name"].map(v=>m.getAttribute(v)).filter(v=>v?f.includes(v):!1);if(b.length&&b){const v=m.getAttribute("content");if(v)return v}}return""}function o(){let f=i("name","og:site_name","og:title","twitter:title");return f||(f=n.title),f}function a(){return i("description","og:description","twitter:description","keywords")}const c=o(),l=a(),u=r.origin,d=s();return{description:l,url:u,icons:d,name:c}}return Fo.getWindowMetadata=e,Fo}var oP=iP();function Ha(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Mh(t){return Ha(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const E1="2.31.0";let Ed={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${E1}`},wu=class Lh extends Error{constructor(e,n={}){const r=n.cause instanceof Lh?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof Lh&&n.cause.docsPath||n.docsPath,i=Ed.getDocsUrl?.({...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...Ed.version?[`Version: ${Ed.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=E1}walk(e){return v1(this,e)}};function v1(t,e){return e?.(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?v1(t.cause,e):e?null:t}class C1 extends wu{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Ao(t,{dir:e,size:n=32}={}){return typeof t=="string"?aP(t,{dir:e,size:n}):cP(t,{dir:e,size:n})}function aP(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new C1({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function cP(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new C1({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}class lP extends wu{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class uP extends wu{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Io(t,{size:e}){if(Mh(t)>e)throw new uP({givenSize:Mh(t),maxSize:e})}function Bh(t,e={}){const{signed:n}=e;e.size&&Io(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function dP(t,e={}){return Number(Bh(t,e))}const hP=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Fh(t,e={}){return typeof t=="number"||typeof t=="bigint"?A1(t,e):typeof t=="string"?gP(t,e):typeof t=="boolean"?fP(t,e):_1(t,e)}function fP(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Io(n,{size:e.size}),Ao(n,{size:e.size})):n}function _1(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=hP[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Io(r,{size:e.size}),Ao(r,{dir:"right",size:e.size})):r}function A1(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new lP({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Ao(a,{size:r}):a}const pP=new TextEncoder;function gP(t,e={}){const n=pP.encode(t);return _1(n,e)}const mP=new TextEncoder;function yP(t,e={}){return typeof t=="number"||typeof t=="bigint"?bP(t,e):typeof t=="boolean"?wP(t,e):Ha(t)?I1(t,e):S1(t,e)}function wP(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Io(n,{size:e.size}),Ao(n,{size:e.size})):n}const Dr={zero:48,nine:57,A:65,F:70,a:97,f:102};function wg(t){if(t>=Dr.zero&&t<=Dr.nine)return t-Dr.zero;if(t>=Dr.A&&t<=Dr.F)return t-(Dr.A-10);if(t>=Dr.a&&t<=Dr.f)return t-(Dr.a-10)}function I1(t,e={}){let n=t;e.size&&(Io(n,{size:e.size}),n=Ao(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=wg(r.charCodeAt(a++)),l=wg(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new wu(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function bP(t,e){const n=A1(t,e);return I1(n)}function S1(t,e={}){const n=mP.encode(t);return typeof e.size=="number"?(Io(n,{size:e.size}),Ao(n,{dir:"right",size:e.size})):n}function N1(t,e){const n=e||"hex",r=Bw(Ha(t,{strict:!1})?yP(t):t);return n==="bytes"?r:Fh(r)}class EP extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const vd=new EP(8192);function vP(t,e){if(vd.has(`${t}.${e}`))return vd.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),r=N1(S1(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return vd.set(`${t}.${e}`,i),i}function CP(t){const e=N1(`0x${t.substring(4)}`).substring(26);return vP(`0x${e}`)}async function _P({hash:t,signature:e}){const n=Ha(t)?t:Fh(t),{secp256k1:r}=await dt(async()=>{const{secp256k1:o}=await import("./D7ShErVm.js");return{secp256k1:o}},__vite__mapDeps([0,1,2]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),p=bg(f);return new r.Signature(Bh(l),Bh(u)).addRecoveryBit(p)}const o=Ha(e)?e:Fh(e);if(Mh(o)!==65)throw new Error("invalid signature length");const a=dP(`0x${o.slice(130)}`),c=bg(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function bg(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function AP({hash:t,signature:e}){return CP(await _P({hash:t,signature:e}))}function IP(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const f=l.length;for(;h!==f&&l[h]===0;)h++,u++;const p=(f-h)*i+1>>>0,g=new Uint8Array(p);for(;h!==f;){let v=l[h],C=0;for(let N=p-1;(v!==0||C<d)&&N!==-1;N--,C++)v+=256*g[N]>>>0,g[N]=v%n>>>0,v=v/n>>>0;if(v!==0)throw new Error("Non-zero carry");d=C,h++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let b=r.repeat(u);for(;m<p;++m)b+=t.charAt(g[m]);return b}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const f=(l.length-u)*s+1>>>0,p=new Uint8Array(f);for(;u<l.length;){const v=l.charCodeAt(u);if(v>255)return;let C=e[v];if(C===255)return;let N=0;for(let y=f-1;(C!==0||N<h)&&y!==-1;y--,N++)C+=n*p[y]>>>0,p[y]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");h=N,u++}let g=f-h;for(;g!==f&&p[g]===0;)g++;const m=new Uint8Array(d+(f-g));let b=d;for(;g!==f;)m[b++]=p[g++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var SP="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const So=IP(SP);function NP(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if((s&4294967168)===0){n++;continue}else if((s&4294965248)===0)n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}(s&4294901760)===0?n+=3:n+=4}}return n}function TP(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if((o&4294967168)===0){e[s++]=o;continue}else if((o&4294965248)===0)e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}(o&4294901760)===0?(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128):(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128)}e[s++]=o&63|128}}const PP=new TextEncoder,xP=50;function RP(t,e,n){PP.encodeInto(t,e.subarray(n))}function OP(t,e,n){t.length>xP?RP(t,e,n):TP(t,e,n)}const kP=4096;function T1(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if((a&128)===0)i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,l=t[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[r++]&63,l=t[r++]&63,u=t[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=kP&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const DP=new TextDecoder,$P=200;function UP(t,e,n){const r=t.subarray(e,e+n);return DP.decode(r)}function MP(t,e,n){return n>$P?UP(t,e,n):T1(t,e,n)}class qc{constructor(e,n){this.type=e,this.data=n}}class mn extends Error{constructor(e){super(e);const n=Object.create(mn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:mn.name})}}const jo=4294967295;function LP(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function P1(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function x1(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function BP(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const FP=-1,jP=4294967296-1,HP=17179869184-1;function qP({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=HP)if(e===0&&t<=jP){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),P1(r,4,t),n}}function WP(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function zP(t){if(t instanceof Date){const e=WP(t);return qP(e)}else return null}function VP(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=x1(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new mn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function KP(t){const e=VP(t);return new Date(e.sec*1e3+e.nsec/1e6)}const GP={type:FP,encode:zP,decode:KP};class Ml{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(GP)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new qc(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new qc(o,i)}}}return e instanceof qc?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new qc(n,e)}}Ml.defaultCodec=new Ml;function YP(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function jh(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):YP(t)?new Uint8Array(t):Uint8Array.from(t)}const ZP=100,JP=2048;let XP=class R1{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??Ml.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??ZP,this.initialBufferSize=e?.initialBufferSize??JP,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new R1({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=NP(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),OP(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=jh(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),LP(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),P1(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function QP(t,e){return new XP(e).encodeSharedRef(t)}function Cd(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const ex=16,tx=16;class nx{constructor(e=ex,n=tx){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=T1(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const Hh="array",aa="map_key",O1="map_value",rx=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new mn("The type of key must be string or number but "+typeof t)};class sx{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Hh,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=aa,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Hh){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===aa||e.type===O1){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const Ho=-1,dp=new DataView(new ArrayBuffer(0)),ix=new Uint8Array(dp.buffer);try{dp.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const Eg=new RangeError("Insufficient data"),ox=new nx;let ax=class k1{constructor(e){this.totalPos=0,this.pos=0,this.view=dp,this.bytes=ix,this.headByte=Ho,this.stack=new sx,this.entered=!1,this.extensionCodec=e?.extensionCodec??Ml.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??jo,this.maxBinLength=e?.maxBinLength??jo,this.maxArrayLength=e?.maxArrayLength??jo,this.maxMapLength=e?.maxMapLength??jo,this.maxExtLength=e?.maxExtLength??jo,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:ox,this.mapKeyConverter=e?.mapKeyConverter??rx}clone(){return new k1({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=Ho,this.stack.reset()}setBuffer(e){const n=jh(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===Ho&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=jh(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${Cd(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new mn(`Unrecognized type byte: ${Cd(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===Hh)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===aa){if(n==="__proto__")throw new mn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=O1;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=aa;continue e}}return n}}readHeadByte(){return this.headByte===Ho&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=Ho}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new mn(`Unrecognized array type byte: ${Cd(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new mn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new mn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){if(e>this.maxStrLength)throw new mn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw Eg;const r=this.pos+n;let s;return this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?s=this.keyDecoder.decode(this.bytes,r,e):s=MP(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===aa:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new mn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw Eg;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new mn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=BP(this.view,this.pos);return this.pos+=8,e}readI64(){const e=x1(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function cx(t,e){return new ax(e).decode(t)}function hp(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function D1(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?hp(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function ca(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=D1(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return hp(n)}function lx(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,b=0,v=p.length;b!==v&&p[b]===0;)b++,g++;for(var C=(v-b)*u+1>>>0,N=new Uint8Array(C);b!==v;){for(var y=p[b],w=0,S=C-1;(y!==0||w<m)&&S!==-1;S--,w++)y+=256*N[S]>>>0,N[S]=y%a>>>0,y=y/a>>>0;if(y!==0)throw new Error("Non-zero carry");m=w,b++}for(var P=C-m;P!==C&&N[P]===0;)P++;for(var A=c.repeat(g);P<C;++P)A+=t.charAt(N[P]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,b=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,C=new Uint8Array(v);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var y=0,w=v-1;(N!==0||y<b)&&w!==-1;w--,y++)N+=a*C[w]>>>0,C[w]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");b=y,g++}if(p[g]!==" "){for(var S=v-b;S!==v&&C[S]===0;)S++;for(var P=new Uint8Array(m+(v-S)),A=m;S!==v;)P[A++]=C[S++];return P}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var ux=lx,dx=ux;const hx=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},fx=t=>new TextEncoder().encode(t),px=t=>new TextDecoder().decode(t);class gx{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class mx{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return $1(this,e)}}class yx{constructor(e){this.decoders=e}or(e){return $1(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const $1=(t,e)=>new yx({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class wx{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new gx(e,n,r),this.decoder=new mx(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bu=({name:t,prefix:e,encode:n,decode:r})=>new wx(t,e,n,r),Cc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=dx(n,e);return bu({prefix:t,name:e,encode:r,decode:i=>hx(s(i))})},bx=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Ex=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},kt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>bu({prefix:e,name:t,encode(s){return Ex(s,r,n)},decode(s){return bx(s,r,n,t)}}),vx=bu({prefix:"\0",name:"identity",encode:t=>px(t),decode:t=>fx(t)}),Cx=Object.freeze(Object.defineProperty({__proto__:null,identity:vx},Symbol.toStringTag,{value:"Module"})),_x=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),Ax=Object.freeze(Object.defineProperty({__proto__:null,base2:_x},Symbol.toStringTag,{value:"Module"})),Ix=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),Sx=Object.freeze(Object.defineProperty({__proto__:null,base8:Ix},Symbol.toStringTag,{value:"Module"})),Nx=Cc({prefix:"9",name:"base10",alphabet:"0123456789"}),Tx=Object.freeze(Object.defineProperty({__proto__:null,base10:Nx},Symbol.toStringTag,{value:"Module"})),Px=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xx=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),Rx=Object.freeze(Object.defineProperty({__proto__:null,base16:Px,base16upper:xx},Symbol.toStringTag,{value:"Module"})),Ox=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kx=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Dx=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),$x=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ux=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Mx=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Lx=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Bx=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Fx=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),jx=Object.freeze(Object.defineProperty({__proto__:null,base32:Ox,base32hex:Ux,base32hexpad:Lx,base32hexpadupper:Bx,base32hexupper:Mx,base32pad:Dx,base32padupper:$x,base32upper:kx,base32z:Fx},Symbol.toStringTag,{value:"Module"})),Hx=Cc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),qx=Cc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),Wx=Object.freeze(Object.defineProperty({__proto__:null,base36:Hx,base36upper:qx},Symbol.toStringTag,{value:"Module"})),zx=Cc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Vx=Cc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Kx=Object.freeze(Object.defineProperty({__proto__:null,base58btc:zx,base58flickr:Vx},Symbol.toStringTag,{value:"Module"})),Gx=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Yx=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Zx=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Jx=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),Xx=Object.freeze(Object.defineProperty({__proto__:null,base64:Gx,base64pad:Yx,base64url:Zx,base64urlpad:Jx},Symbol.toStringTag,{value:"Module"})),U1=Array.from(""),Qx=U1.reduce((t,e,n)=>(t[n]=e,t),[]),eR=U1.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function tR(t){return t.reduce((e,n)=>(e+=Qx[n],e),"")}function nR(t){const e=[];for(const n of t){const r=eR[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const rR=bu({prefix:"",name:"base256emoji",encode:tR,decode:nR}),sR=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:rR},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const vg={...Cx,...Ax,...Sx,...Tx,...Rx,...jx,...Wx,...Kx,...Xx,...sR};function M1(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Cg=M1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),_d=M1("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=D1(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),L1={utf8:Cg,"utf-8":Cg,hex:vg.base16,latin1:_d,ascii:_d,binary:_d,...vg};function kn(t,e="utf8"){const n=L1[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?hp(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function cn(t,e="utf8"){const n=L1[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const iR={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var Ad,_g;function B1(){if(_g)return Ad;_g=1;const t="Input must be an string, Buffer or Uint8Array";function e(o){let a;if(o instanceof Uint8Array)a=o;else if(typeof o=="string")a=new TextEncoder().encode(o);else throw new Error(t);return a}function n(o){return Array.prototype.map.call(o,function(a){return(a<16?"0":"")+a.toString(16)}).join("")}function r(o){return(4294967296+o).toString(16).substring(1)}function s(o,a,c){let l=`
`+o+" = ";for(let u=0;u<a.length;u+=2){if(c===32)l+=r(a[u]).toUpperCase(),l+=" ",l+=r(a[u+1]).toUpperCase();else if(c===64)l+=r(a[u+1]).toUpperCase(),l+=r(a[u]).toUpperCase();else throw new Error("Invalid size "+c);u%6===4?l+=`
`+new Array(o.length+4).join(" "):u<a.length-2&&(l+=" ")}console.log(l)}function i(o,a,c){let l=new Date().getTime();const u=new Uint8Array(a);for(let h=0;h<a;h++)u[h]=h%256;const d=new Date().getTime();console.log("Generated random input in "+(d-l)+"ms"),l=d;for(let h=0;h<c;h++){const f=o(u),p=new Date().getTime(),g=p-l;l=p,console.log("Hashed in "+g+"ms: "+f.substring(0,20)+"..."),console.log(Math.round(a/(1<<20)/(g/1e3)*100)/100+" MB PER SECOND")}}return Ad={normalizeInput:e,toHex:n,debugPrint:s,testSpeed:i},Ad}var Id,Ag;function oR(){if(Ag)return Id;Ag=1;const t=B1();function e(b,v,C){const N=b[v]+b[C];let y=b[v+1]+b[C+1];N>=4294967296&&y++,b[v]=N,b[v+1]=y}function n(b,v,C,N){let y=b[v]+C;C<0&&(y+=4294967296);let w=b[v+1]+N;y>=4294967296&&w++,b[v]=y,b[v+1]=w}function r(b,v){return b[v]^b[v+1]<<8^b[v+2]<<16^b[v+3]<<24}function s(b,v,C,N,y,w){const S=l[y],P=l[y+1],A=l[w],x=l[w+1];e(c,b,v),n(c,b,S,P);let R=c[N]^c[b],O=c[N+1]^c[b+1];c[N]=O,c[N+1]=R,e(c,C,N),R=c[v]^c[C],O=c[v+1]^c[C+1],c[v]=R>>>24^O<<8,c[v+1]=O>>>24^R<<8,e(c,b,v),n(c,b,A,x),R=c[N]^c[b],O=c[N+1]^c[b+1],c[N]=R>>>16^O<<16,c[N+1]=O>>>16^R<<16,e(c,C,N),R=c[v]^c[C],O=c[v+1]^c[C+1],c[v]=O>>>31^R<<1,c[v+1]=R>>>31^O<<1}const i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),o=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],a=new Uint8Array(o.map(function(b){return b*2})),c=new Uint32Array(32),l=new Uint32Array(32);function u(b,v){let C=0;for(C=0;C<16;C++)c[C]=b.h[C],c[C+16]=i[C];for(c[24]=c[24]^b.t,c[25]=c[25]^b.t/4294967296,v&&(c[28]=~c[28],c[29]=~c[29]),C=0;C<32;C++)l[C]=r(b.b,4*C);for(C=0;C<12;C++)s(0,8,16,24,a[C*16+0],a[C*16+1]),s(2,10,18,26,a[C*16+2],a[C*16+3]),s(4,12,20,28,a[C*16+4],a[C*16+5]),s(6,14,22,30,a[C*16+6],a[C*16+7]),s(0,10,20,30,a[C*16+8],a[C*16+9]),s(2,12,22,24,a[C*16+10],a[C*16+11]),s(4,14,16,26,a[C*16+12],a[C*16+13]),s(6,8,18,28,a[C*16+14],a[C*16+15]);for(C=0;C<16;C++)b.h[C]=b.h[C]^c[C]^c[C+16]}const d=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function h(b,v,C,N){if(b===0||b>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(v&&v.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(C&&C.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(N&&N.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const y={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:b};d.fill(0),d[0]=b,v&&(d[1]=v.length),d[2]=1,d[3]=1,C&&d.set(C,32),N&&d.set(N,48);for(let w=0;w<16;w++)y.h[w]=i[w]^r(d,w*4);return v&&(f(y,v),y.c=128),y}function f(b,v){for(let C=0;C<v.length;C++)b.c===128&&(b.t+=b.c,u(b,!1),b.c=0),b.b[b.c++]=v[C]}function p(b){for(b.t+=b.c;b.c<128;)b.b[b.c++]=0;u(b,!0);const v=new Uint8Array(b.outlen);for(let C=0;C<b.outlen;C++)v[C]=b.h[C>>2]>>8*(C&3);return v}function g(b,v,C,N,y){C=C||64,b=t.normalizeInput(b),N&&(N=t.normalizeInput(N)),y&&(y=t.normalizeInput(y));const w=h(C,v,N,y);return f(w,b),p(w)}function m(b,v,C,N,y){const w=g(b,v,C,N,y);return t.toHex(w)}return Id={blake2b:g,blake2bHex:m,blake2bInit:h,blake2bUpdate:f,blake2bFinal:p},Id}var Sd,Ig;function aR(){if(Ig)return Sd;Ig=1;const t=B1();function e(p,g){return p[g]^p[g+1]<<8^p[g+2]<<16^p[g+3]<<24}function n(p,g,m,b,v,C){o[p]=o[p]+o[g]+v,o[b]=r(o[b]^o[p],16),o[m]=o[m]+o[b],o[g]=r(o[g]^o[m],12),o[p]=o[p]+o[g]+C,o[b]=r(o[b]^o[p],8),o[m]=o[m]+o[b],o[g]=r(o[g]^o[m],7)}function r(p,g){return p>>>g^p<<32-g}const s=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),o=new Uint32Array(16),a=new Uint32Array(16);function c(p,g){let m=0;for(m=0;m<8;m++)o[m]=p.h[m],o[m+8]=s[m];for(o[12]^=p.t,o[13]^=p.t/4294967296,g&&(o[14]=~o[14]),m=0;m<16;m++)a[m]=e(p.b,4*m);for(m=0;m<10;m++)n(0,4,8,12,a[i[m*16+0]],a[i[m*16+1]]),n(1,5,9,13,a[i[m*16+2]],a[i[m*16+3]]),n(2,6,10,14,a[i[m*16+4]],a[i[m*16+5]]),n(3,7,11,15,a[i[m*16+6]],a[i[m*16+7]]),n(0,5,10,15,a[i[m*16+8]],a[i[m*16+9]]),n(1,6,11,12,a[i[m*16+10]],a[i[m*16+11]]),n(2,7,8,13,a[i[m*16+12]],a[i[m*16+13]]),n(3,4,9,14,a[i[m*16+14]],a[i[m*16+15]]);for(m=0;m<8;m++)p.h[m]^=o[m]^o[m+8]}function l(p,g){if(!(p>0&&p<=32))throw new Error("Incorrect output length, should be in [1, 32]");const m=g?g.length:0;if(g&&!(m>0&&m<=32))throw new Error("Incorrect key length, should be in [1, 32]");const b={h:new Uint32Array(s),b:new Uint8Array(64),c:0,t:0,outlen:p};return b.h[0]^=16842752^m<<8^p,m>0&&(u(b,g),b.c=64),b}function u(p,g){for(let m=0;m<g.length;m++)p.c===64&&(p.t+=p.c,c(p,!1),p.c=0),p.b[p.c++]=g[m]}function d(p){for(p.t+=p.c;p.c<64;)p.b[p.c++]=0;c(p,!0);const g=new Uint8Array(p.outlen);for(let m=0;m<p.outlen;m++)g[m]=p.h[m>>2]>>8*(m&3)&255;return g}function h(p,g,m){m=m||32,p=t.normalizeInput(p);const b=l(m,g);return u(b,p),d(b)}function f(p,g,m){const b=h(p,g,m);return t.toHex(b)}return Sd={blake2s:h,blake2sHex:f,blake2sInit:l,blake2sUpdate:u,blake2sFinal:d},Sd}var Nd,Sg;function cR(){if(Sg)return Nd;Sg=1;const t=oR(),e=aR();return Nd={blake2b:t.blake2b,blake2bHex:t.blake2bHex,blake2bInit:t.blake2bInit,blake2bUpdate:t.blake2bUpdate,blake2bFinal:t.blake2bFinal,blake2s:e.blake2s,blake2sHex:e.blake2sHex,blake2sInit:e.blake2sInit,blake2sUpdate:e.blake2sUpdate,blake2sFinal:e.blake2sFinal},Nd}var lR=cR(),uR={};const dR=":";function ni(t){const[e,n]=t.split(dR);return{namespace:e,reference:n}}function F1(t,e){return t.includes(":")?[t]:e.chains||[]}var hR=Object.defineProperty,fR=Object.defineProperties,pR=Object.getOwnPropertyDescriptors,Ng=Object.getOwnPropertySymbols,gR=Object.prototype.hasOwnProperty,mR=Object.prototype.propertyIsEnumerable,qh=(t,e,n)=>e in t?hR(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Tg=(t,e)=>{for(var n in e||(e={}))gR.call(e,n)&&qh(t,n,e[n]);if(Ng)for(var n of Ng(e))mR.call(e,n)&&qh(t,n,e[n]);return t},yR=(t,e)=>fR(t,pR(e)),Pg=(t,e,n)=>qh(t,typeof e!="symbol"?e+"":e,n);const wR="ReactNative",bn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},bR="js";function Ll(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ks(){return!Jr.getDocument()&&!!Jr.getNavigator()&&navigator.product===wR}function ER(){return ks()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function vR(){return ks()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function No(){return!Ll()&&!!Jr.getNavigator()&&!!Jr.getDocument()}function _c(){return ks()?bn.reactNative:Ll()?bn.node:No()?bn.browser:bn.unknown}function xg(){var t;try{return ks()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function CR(t,e){const n=new URLSearchParams(t);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&n.set(r,s)}return n.toString()}function _R(t){var e,n;const r=j1();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t?.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),yR(Tg(Tg({},r),t),{url:t?.url||r.url,name:t?.name||r.name,description:t?.description||r.description,icons:(n=t?.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function j1(){return oP.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function AR(){if(_c()===bn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=Zv();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function IR(){var t;const e=_c();return e===bn.browser?[e,((t=Jr.getLocation())==null?void 0:t.host)||"unknown"].join(":"):e}function H1(t,e,n){const r=AR(),s=IR();return[[t,e].join("-"),[bR,n].join("-"),r,s].join("/")}function SR({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=H1(t,e,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=CR(l[1]||"",d);return l[0]+"?"+h}function Zs(t,e){return t.filter(n=>e.includes(n)).length===t.length}function Wh(t){return Object.fromEntries(t.entries())}function zh(t){return new Map(Object.entries(t))}function Hs(t=Y.FIVE_MINUTES,e){const n=Y.toMiliseconds(t||Y.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function wr(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function q1(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function NR(t){return q1("topic",t)}function TR(t){return q1("id",t)}function W1(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function gt(t,e){return Y.fromMiliseconds(Date.now()+Y.toMiliseconds(t))}function hs(t){return Date.now()>=Y.toMiliseconds(t)}function je(t,e){return`${t}${e?`:${e}`:""}`}function vr(t=[],e=[]){return[...new Set([...t,...e])]}async function PR({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s?.href;if(typeof i!="string")return;const o=xR(i,t,e),a=_c();if(a===bn.browser){if(!((r=Jr.getDocument())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}RR(o)}else a===bn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function xR(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${$R(r,!0)}`}else s=`${s}/wc?${r}`;return s}function RR(t){let e="_self";DR()?e="_top":(kR()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function OR(t,e){let n="";try{if(No()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function Rg(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function Og(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function fp(){return typeof process<"u"&&uR.IS_VITEST==="true"}function kR(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function DR(){try{return window.self!==window.top}catch{return!1}}function $R(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function z1(t){return Buffer.from(t,"base64").toString("utf-8")}function UR(t){return new Promise(e=>setTimeout(e,t))}let MR=class{constructor({limit:e}){Pg(this,"limit"),Pg(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){const n=this.set.values().next().value;n&&this.set.delete(n)}this.set.add(e)}}has(e){return this.set.has(e)}};const Wc=BigInt(2**32-1),kg=BigInt(32);function V1(t,e=!1){return e?{h:Number(t&Wc),l:Number(t>>kg&Wc)}:{h:Number(t>>kg&Wc)|0,l:Number(t&Wc)|0}}function K1(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=V1(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const Dg=(t,e,n)=>t>>>n,$g=(t,e,n)=>t<<32-n|e>>>n,fs=(t,e,n)=>t>>>n|e<<32-n,ps=(t,e,n)=>t<<32-n|e>>>n,ea=(t,e,n)=>t<<64-n|e>>>n-32,ta=(t,e,n)=>t>>>n-32|e<<64-n,LR=(t,e)=>e,BR=(t,e)=>t,FR=(t,e,n)=>t<<n|e>>>32-n,jR=(t,e,n)=>e<<n|t>>>32-n,HR=(t,e,n)=>e<<n-32|t>>>64-n,qR=(t,e,n)=>t<<n-32|e>>>64-n;function Gn(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const pp=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),gp=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,WR=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),zR=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,VR=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),KR=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Ri=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function mp(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Xr(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Mn(t,...e){if(!mp(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function yp(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");Xr(t.outputLen),Xr(t.blockLen)}function Ps(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function wp(t,e){Mn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function qa(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Ln(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function Td(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ar(t,e){return t<<32-e|t>>>e}const G1=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Y1(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Lr=G1?t=>t:t=>Y1(t);function GR(t){for(let e=0;e<t.length;e++)t[e]=Y1(t[e]);return t}const gs=G1?t=>t:GR,Z1=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",YR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Wa(t){if(Mn(t),Z1)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=YR[t[n]];return e}const $r={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ug(t){if(t>=$r._0&&t<=$r._9)return t-$r._0;if(t>=$r.A&&t<=$r.F)return t-($r.A-10);if(t>=$r.a&&t<=$r.f)return t-($r.a-10)}function bp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(Z1)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Ug(t.charCodeAt(i)),a=Ug(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function ZR(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function er(t){return typeof t=="string"&&(t=ZR(t)),Mn(t),t}function Js(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Mn(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let Eu=class{};function Ac(t){const e=r=>t().update(er(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function JR(t){const e=(r,s)=>t(s).update(er(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function To(t=32){if(Ri&&typeof Ri.getRandomValues=="function")return Ri.getRandomValues(new Uint8Array(t));if(Ri&&typeof Ri.randomBytes=="function")return Uint8Array.from(Ri.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const XR=BigInt(0),qo=BigInt(1),QR=BigInt(2),eO=BigInt(7),tO=BigInt(256),nO=BigInt(113),J1=[],X1=[],Q1=[];for(let t=0,e=qo,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],J1.push(2*(5*r+n)),X1.push((t+1)*(t+2)/2%64);let s=XR;for(let i=0;i<7;i++)e=(e<<qo^(e>>eO)*nO)%tO,e&QR&&(s^=qo<<(qo<<BigInt(i))-qo);Q1.push(s)}const eE=K1(Q1,!0),rO=eE[0],sO=eE[1],Mg=(t,e,n)=>n>32?HR(t,e,n):FR(t,e,n),Lg=(t,e,n)=>n>32?qR(t,e,n):jR(t,e,n);function iO(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Mg(l,u,1)^n[a],h=Lg(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=X1[o],c=Mg(s,i,a),l=Lg(s,i,a),u=J1[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=rO[r],t[1]^=sO[r]}Ln(n)}let oO=class tE extends Eu{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,Xr(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=qa(this.state)}clone(){return this._cloneInto()}keccak(){gs(this.state32),iO(this.state32,this.rounds),gs(this.state32),this.posOut=0,this.pos=0}update(e){Ps(this),e=er(e),Mn(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,(n&128)!==0&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ps(this,!1),Mn(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Xr(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(wp(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Ln(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new tE(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const aO=(t,e,n)=>Ac(()=>new oO(e,t,n)),cO=aO(1,136,256/8);function lO(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function uO(t,e,n){return t&e^~t&n}function dO(t,e,n){return t&e^t&n^e&n}let nE=class extends Eu{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=Td(this.buffer)}update(e){Ps(this),e=er(e),Mn(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=Td(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ps(this),wp(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Ln(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;lO(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=Td(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const is=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$t=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Ut=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),hO=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),os=new Uint32Array(64);let fO=class extends nE{constructor(e=32){super(64,e,8,!1),this.A=is[0]|0,this.B=is[1]|0,this.C=is[2]|0,this.D=is[3]|0,this.E=is[4]|0,this.F=is[5]|0,this.G=is[6]|0,this.H=is[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)os[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=os[d-15],f=os[d-2],p=ar(h,7)^ar(h,18)^h>>>3,g=ar(f,17)^ar(f,19)^f>>>10;os[d]=g+os[d-7]+p+os[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=ar(a,6)^ar(a,11)^ar(a,25),f=u+h+uO(a,c,l)+hO[d]+os[d]|0,p=(ar(r,2)^ar(r,13)^ar(r,22))+dO(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Ln(os)}destroy(){this.set(0,0,0,0,0,0,0,0),Ln(this.buffer)}};const rE=K1(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),pO=rE[0],gO=rE[1],as=new Uint32Array(80),cs=new Uint32Array(80);let Ep=class extends nE{constructor(e=64){super(128,e,16,!1),this.Ah=Ut[0]|0,this.Al=Ut[1]|0,this.Bh=Ut[2]|0,this.Bl=Ut[3]|0,this.Ch=Ut[4]|0,this.Cl=Ut[5]|0,this.Dh=Ut[6]|0,this.Dl=Ut[7]|0,this.Eh=Ut[8]|0,this.El=Ut[9]|0,this.Fh=Ut[10]|0,this.Fl=Ut[11]|0,this.Gh=Ut[12]|0,this.Gl=Ut[13]|0,this.Hh=Ut[14]|0,this.Hl=Ut[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let C=0;C<16;C++,n+=4)as[C]=e.getUint32(n),cs[C]=e.getUint32(n+=4);for(let C=16;C<80;C++){const N=as[C-15]|0,y=cs[C-15]|0,w=fs(N,y,1)^fs(N,y,8)^Dg(N,y,7),S=ps(N,y,1)^ps(N,y,8)^$g(N,y,7),P=as[C-2]|0,A=cs[C-2]|0,x=fs(P,A,19)^ea(P,A,61)^Dg(P,A,6),R=ps(P,A,19)^ta(P,A,61)^$g(P,A,6),O=WR(S,R,cs[C-7],cs[C-16]),L=zR(O,w,x,as[C-7],as[C-16]);as[C]=L|0,cs[C]=O|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:b,Hl:v}=this;for(let C=0;C<80;C++){const N=fs(d,h,14)^fs(d,h,18)^ea(d,h,41),y=ps(d,h,14)^ps(d,h,18)^ta(d,h,41),w=d&f^~d&g,S=h&p^~h&m,P=VR(v,y,S,gO[C],cs[C]),A=KR(P,b,N,w,pO[C],as[C]),x=P|0,R=fs(r,s,28)^ea(r,s,34)^ea(r,s,39),O=ps(r,s,28)^ta(r,s,34)^ta(r,s,39),L=r&i^r&a^i&a,$=s&o^s&c^o&c;b=g|0,v=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Gn(l|0,u|0,A|0,x|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const I=pp(x,O,$);r=gp(I,A,R,L),s=I|0}({h:r,l:s}=Gn(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Gn(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Gn(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Gn(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Gn(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Gn(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Gn(this.Gh|0,this.Gl|0,g|0,m|0),{h:b,l:v}=Gn(this.Hh|0,this.Hl|0,b|0,v|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,b,v)}roundClean(){Ln(as,cs)}destroy(){Ln(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},mO=class extends Ep{constructor(){super(48),this.Ah=$t[0]|0,this.Al=$t[1]|0,this.Bh=$t[2]|0,this.Bl=$t[3]|0,this.Ch=$t[4]|0,this.Cl=$t[5]|0,this.Dh=$t[6]|0,this.Dl=$t[7]|0,this.Eh=$t[8]|0,this.El=$t[9]|0,this.Fh=$t[10]|0,this.Fl=$t[11]|0,this.Gh=$t[12]|0,this.Gl=$t[13]|0,this.Hh=$t[14]|0,this.Hl=$t[15]|0}};const Mt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class yO extends Ep{constructor(){super(32),this.Ah=Mt[0]|0,this.Al=Mt[1]|0,this.Bh=Mt[2]|0,this.Bl=Mt[3]|0,this.Ch=Mt[4]|0,this.Cl=Mt[5]|0,this.Dh=Mt[6]|0,this.Dl=Mt[7]|0,this.Eh=Mt[8]|0,this.El=Mt[9]|0,this.Fh=Mt[10]|0,this.Fl=Mt[11]|0,this.Gh=Mt[12]|0,this.Gl=Mt[13]|0,this.Hh=Mt[14]|0,this.Hl=Mt[15]|0}}const vu=Ac(()=>new fO),wO=Ac(()=>new Ep),bO=Ac(()=>new mO),EO=Ac(()=>new yO),vO=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),pt=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Q=new Uint32Array(32);function ls(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=Q[2*t],l=Q[2*t+1],u=Q[2*e],d=Q[2*e+1],h=Q[2*n],f=Q[2*n+1],p=Q[2*r],g=Q[2*r+1],m=pp(c,u,o);l=gp(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:LR(g,p),Dl:BR(g)},{h:f,l:h}=Gn(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:fs(d,u,24),Bl:ps(d,u,24)},Q[2*t]=c,Q[2*t+1]=l,Q[2*e]=u,Q[2*e+1]=d,Q[2*n]=h,Q[2*n+1]=f,Q[2*r]=p,Q[2*r+1]=g}function us(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=Q[2*t],l=Q[2*t+1],u=Q[2*e],d=Q[2*e+1],h=Q[2*n],f=Q[2*n+1],p=Q[2*r],g=Q[2*r+1],m=pp(c,u,o);l=gp(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:fs(g,p,16),Dl:ps(g,p,16)},{h:f,l:h}=Gn(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:ea(d,u,63),Bl:ta(d,u,63)},Q[2*t]=c,Q[2*t+1]=l,Q[2*e]=u,Q[2*e+1]=d,Q[2*n]=h,Q[2*n+1]=f,Q[2*r]=p,Q[2*r+1]=g}function CO(t,e={},n,r,s){if(Xr(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class _O extends Eu{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,Xr(e),Xr(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=qa(this.buffer)}update(e){Ps(this),e=er(e),Mn(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(gs(s),this.compress(s,0,!1),gs(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));gs(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);gs(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Ps(this),wp(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Ln(this.buffer.subarray(n)),gs(r),this.compress(r,0,!0),gs(r);const s=qa(e);this.get().forEach((i,o)=>s[o]=Lr(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class AO extends _O{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=pt[0]|0,this.v0h=pt[1]|0,this.v1l=pt[2]|0,this.v1h=pt[3]|0,this.v2l=pt[4]|0,this.v2h=pt[5]|0,this.v3l=pt[6]|0,this.v3h=pt[7]|0,this.v4l=pt[8]|0,this.v4h=pt[9]|0,this.v5l=pt[10]|0,this.v5h=pt[11]|0,this.v6l=pt[12]|0,this.v6h=pt[13]|0,this.v7l=pt[14]|0,this.v7h=pt[15]|0,CO(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=er(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=er(i);const a=qa(i);this.v4l^=Lr(a[0]),this.v4h^=Lr(a[1]),this.v5l^=Lr(a[2]),this.v5h^=Lr(a[3])}if(s!==void 0){s=er(s);const a=qa(s);this.v6l^=Lr(a[0]),this.v6h^=Lr(a[1]),this.v7l^=Lr(a[2]),this.v7h^=Lr(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,n,r){this.get().forEach((c,l)=>Q[l]=c),Q.set(pt,16);let{h:s,l:i}=V1(BigInt(this.length));Q[24]=pt[8]^i,Q[25]=pt[9]^s,r&&(Q[28]=~Q[28],Q[29]=~Q[29]);let o=0;const a=vO;for(let c=0;c<12;c++)ls(0,4,8,12,e,n+2*a[o++]),us(0,4,8,12,e,n+2*a[o++]),ls(1,5,9,13,e,n+2*a[o++]),us(1,5,9,13,e,n+2*a[o++]),ls(2,6,10,14,e,n+2*a[o++]),us(2,6,10,14,e,n+2*a[o++]),ls(3,7,11,15,e,n+2*a[o++]),us(3,7,11,15,e,n+2*a[o++]),ls(0,5,10,15,e,n+2*a[o++]),us(0,5,10,15,e,n+2*a[o++]),ls(1,6,11,12,e,n+2*a[o++]),us(1,6,11,12,e,n+2*a[o++]),ls(2,7,8,13,e,n+2*a[o++]),us(2,7,8,13,e,n+2*a[o++]),ls(3,4,9,14,e,n+2*a[o++]),us(3,4,9,14,e,n+2*a[o++]);this.v0l^=Q[0]^Q[16],this.v0h^=Q[1]^Q[17],this.v1l^=Q[2]^Q[18],this.v1h^=Q[3]^Q[19],this.v2l^=Q[4]^Q[20],this.v2h^=Q[5]^Q[21],this.v3l^=Q[6]^Q[22],this.v3h^=Q[7]^Q[23],this.v4l^=Q[8]^Q[24],this.v4h^=Q[9]^Q[25],this.v5l^=Q[10]^Q[26],this.v5h^=Q[11]^Q[27],this.v6l^=Q[12]^Q[28],this.v6h^=Q[13]^Q[29],this.v7l^=Q[14]^Q[30],this.v7h^=Q[15]^Q[31],Ln(Q)}destroy(){this.destroyed=!0,Ln(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const IO=JR(t=>new AO(t)),SO="https://rpc.walletconnect.org/v1";function sE(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(cO(n)).toString("hex")}async function NO(t,e,n,r,s,i){switch(n.t){case"eip191":return await TO(t,e,n.s);case"eip1271":return await PO(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function TO(t,e,n){return(await AP({hash:sE(e),signature:n})).toLowerCase()===t.toLowerCase()}async function PO(t,e,n,r,s,i){const o=ni(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:sE(e)).substring(2),h=a+d+c+u+l,f=await fetch(`${i||SO}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:xO(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function xO(){return Date.now()+Math.floor(Math.random()*1e3)}function RO(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return So.encode(i)}function OO(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=IO(r,{dkLen:32});return So.encode(s)}function Bg(t){const e=new Uint8Array(vu(kO(t)));return So.encode(e)}function kO(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function Fg(t){const e=Buffer.from(t,"base64"),n=cx(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=QP(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=EO(i);return Xv.encode(o).replace(/=+$/,"")}function Pd(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function DO(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(Pd(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(Pd(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(Pd(r.length)),s.push(r);const i=Buffer.concat(s),o=vu(i);return Buffer.from(o).toString("hex").toUpperCase()}var $O=Object.defineProperty,UO=Object.defineProperties,MO=Object.getOwnPropertyDescriptors,jg=Object.getOwnPropertySymbols,LO=Object.prototype.hasOwnProperty,BO=Object.prototype.propertyIsEnumerable,Hg=(t,e,n)=>e in t?$O(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,FO=(t,e)=>{for(var n in e||(e={}))LO.call(e,n)&&Hg(t,n,e[n]);if(jg)for(var n of jg(e))BO.call(e,n)&&Hg(t,n,e[n]);return t},jO=(t,e)=>UO(t,MO(e));const HO="did:pkh:",vp=t=>t?.split(":"),qO=t=>{const e=t&&vp(t);if(e)return t.includes(HO)?e[3]:e[1]},Vh=t=>{const e=t&&vp(t);if(e)return e[2]+":"+e[3]},Bl=t=>{const e=t&&vp(t);if(e)return e.pop()};async function qg(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=iE(s,s.iss),o=Bl(s.iss);return await NO(o,i,r,Vh(s.iss),n)}const iE=(t,e)=>{const n=`${t.domain} wants you to sign in with your Ethereum account:`,r=Bl(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${qO(e)}`,c=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,f=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=dl(t.resources);if(p){const g=za(p);s=XO(s,g)}return[n,r,"",s,"",i,o,a,c,l,u,d,h,f].filter(g=>g!=null).join(`
`)};function WO(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function zO(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function hi(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function VO(t,e,n,r={}){return n?.sort((s,i)=>s.localeCompare(i)),{att:{[t]:KO(e,n,r)}}}function KO(t,e,n={}){e=e?.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function oE(t){return hi(t),`urn:recap:${WO(t).replace(/=/g,"")}`}function za(t){const e=zO(t.replace("urn:recap:",""));return hi(e),e}function GO(t,e,n){const r=VO(t,e,n);return oE(r)}function YO(t){return t&&t.includes("urn:recap:")}function ZO(t,e){const n=za(t),r=za(e),s=JO(n,r);return oE(s)}function JO(t,e){hi(t),hi(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=jO(FO({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function XO(t="",e){hi(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function Wg(t){var e;const n=za(t);hi(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function zg(t){const e=za(t);hi(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s?.[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function dl(t){if(!t)return;const e=t?.[t.length-1];return YO(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function aE(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Kh(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function xd(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function rn(t,...e){if(!aE(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Vg(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function QO(t,e){rn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Is(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function fo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function e3(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const t3=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function n3(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Gh(t){if(typeof t=="string")t=n3(t);else if(aE(t))t=Yh(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function r3(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function s3(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const i3=(t,e)=>{function n(r,...s){if(rn(r),!t3)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?rn(l):rn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&rn(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");rn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,rn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(rn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,t),n};function Kg(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!a3(e))throw new Error("invalid output, must be aligned");return e}function Gg(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function o3(t,e,n){Kh(n);const r=new Uint8Array(16),s=e3(r);return Gg(s,0,BigInt(e),n),Gg(s,8,BigInt(t),n),r}function a3(t){return t.byteOffset%4===0}function Yh(t){return Uint8Array.from(t)}const cE=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),c3=cE("expand 16-byte k"),l3=cE("expand 32-byte k"),u3=Is(c3),d3=Is(l3);function De(t,e){return t<<e|t>>>32-e}function Zh(t){return t.byteOffset%4===0}const zc=64,h3=16,lE=2**32-1,Yg=new Uint32Array;function f3(t,e,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(zc),u=Is(l),d=Zh(s)&&Zh(i),h=d?Is(s):Yg,f=d?Is(i):Yg;for(let p=0;p<c;o++){if(t(e,n,r,u,o,a),o>=lE)throw new Error("arx: counter overflow");const g=Math.min(zc,c-p);if(d&&g===zc){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let b=0,v;b<h3;b++)v=m+b,f[v]=h[v]^u[b];p+=zc;continue}for(let m=0,b;m<g;m++)b=p+m,i[b]=s[b]^l[m];p+=g}}function p3(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=r3({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return xd(s),xd(o),Kh(i),Kh(n),(a,c,l,u,d=0)=>{rn(a),rn(c),rn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),rn(u),xd(d),d<0||d>=lE)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const f=[];let p=a.length,g,m;if(p===32)f.push(g=Yh(a)),m=d3;else if(p===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),m=u3,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Zh(c)||f.push(c=Yh(c));const b=Is(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,b,Is(c.subarray(0,16)),b),c=c.subarray(16)}const v=16-s;if(v!==c.length)throw new Error(`arx: nonce must be ${v} or 16 bytes`);if(v!==12){const N=new Uint8Array(12);N.set(c,i?0:12-c.length),c=N,f.push(c)}const C=Is(c);return f3(t,m,b,C,l,u,d,o),fo(...f),u}}const It=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class g3{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Gh(e),rn(e,32);const n=It(e,0),r=It(e,2),s=It(e,4),i=It(e,6),o=It(e,8),a=It(e,10),c=It(e,12),l=It(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=It(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],b=It(e,n+0),v=It(e,n+2),C=It(e,n+4),N=It(e,n+6),y=It(e,n+8),w=It(e,n+10),S=It(e,n+12),P=It(e,n+14);let A=i[0]+(b&8191),x=i[1]+((b>>>13|v<<3)&8191),R=i[2]+((v>>>10|C<<6)&8191),O=i[3]+((C>>>7|N<<9)&8191),L=i[4]+((N>>>4|y<<12)&8191),$=i[5]+(y>>>1&8191),I=i[6]+((y>>>14|w<<2)&8191),T=i[7]+((w>>>11|S<<5)&8191),k=i[8]+((S>>>8|P<<8)&8191),B=i[9]+(P>>>5|s),U=0,M=U+A*a+x*(5*m)+R*(5*g)+O*(5*p)+L*(5*f);U=M>>>13,M&=8191,M+=$*(5*h)+I*(5*d)+T*(5*u)+k*(5*l)+B*(5*c),U+=M>>>13,M&=8191;let H=U+A*c+x*a+R*(5*m)+O*(5*g)+L*(5*p);U=H>>>13,H&=8191,H+=$*(5*f)+I*(5*h)+T*(5*d)+k*(5*u)+B*(5*l),U+=H>>>13,H&=8191;let z=U+A*l+x*c+R*a+O*(5*m)+L*(5*g);U=z>>>13,z&=8191,z+=$*(5*p)+I*(5*f)+T*(5*h)+k*(5*d)+B*(5*u),U+=z>>>13,z&=8191;let te=U+A*u+x*l+R*c+O*a+L*(5*m);U=te>>>13,te&=8191,te+=$*(5*g)+I*(5*p)+T*(5*f)+k*(5*h)+B*(5*d),U+=te>>>13,te&=8191;let Z=U+A*d+x*u+R*l+O*c+L*a;U=Z>>>13,Z&=8191,Z+=$*(5*m)+I*(5*g)+T*(5*p)+k*(5*f)+B*(5*h),U+=Z>>>13,Z&=8191;let ae=U+A*h+x*d+R*u+O*l+L*c;U=ae>>>13,ae&=8191,ae+=$*a+I*(5*m)+T*(5*g)+k*(5*p)+B*(5*f),U+=ae>>>13,ae&=8191;let pe=U+A*f+x*h+R*d+O*u+L*l;U=pe>>>13,pe&=8191,pe+=$*c+I*a+T*(5*m)+k*(5*g)+B*(5*p),U+=pe>>>13,pe&=8191;let Be=U+A*p+x*f+R*h+O*d+L*u;U=Be>>>13,Be&=8191,Be+=$*l+I*c+T*a+k*(5*m)+B*(5*g),U+=Be>>>13,Be&=8191;let Le=U+A*g+x*p+R*f+O*h+L*d;U=Le>>>13,Le&=8191,Le+=$*u+I*l+T*c+k*a+B*(5*m),U+=Le>>>13,Le&=8191;let Ie=U+A*m+x*g+R*p+O*f+L*h;U=Ie>>>13,Ie&=8191,Ie+=$*d+I*u+T*l+k*c+B*a,U+=Ie>>>13,Ie&=8191,U=(U<<2)+U|0,U=U+M|0,M=U&8191,U=U>>>13,H+=U,i[0]=M,i[1]=H,i[2]=z,i[3]=te,i[4]=Z,i[5]=ae,i[6]=pe,i[7]=Be,i[8]=Le,i[9]=Ie}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;fo(r)}update(e){Vg(this),e=Gh(e),rn(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){fo(this.h,this.r,this.buffer,this.pad)}digestInto(e){Vg(this),QO(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function m3(t){const e=(r,s)=>t(s).update(Gh(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const y3=m3(t=>new g3(t));function w3(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],b=e[7],v=s,C=n[0],N=n[1],y=n[2],w=o,S=a,P=c,A=l,x=u,R=d,O=h,L=f,$=p,I=g,T=m,k=b,B=v,U=C,M=N,H=y;for(let te=0;te<i;te+=2)w=w+x|0,B=De(B^w,16),$=$+B|0,x=De(x^$,12),w=w+x|0,B=De(B^w,8),$=$+B|0,x=De(x^$,7),S=S+R|0,U=De(U^S,16),I=I+U|0,R=De(R^I,12),S=S+R|0,U=De(U^S,8),I=I+U|0,R=De(R^I,7),P=P+O|0,M=De(M^P,16),T=T+M|0,O=De(O^T,12),P=P+O|0,M=De(M^P,8),T=T+M|0,O=De(O^T,7),A=A+L|0,H=De(H^A,16),k=k+H|0,L=De(L^k,12),A=A+L|0,H=De(H^A,8),k=k+H|0,L=De(L^k,7),w=w+R|0,H=De(H^w,16),T=T+H|0,R=De(R^T,12),w=w+R|0,H=De(H^w,8),T=T+H|0,R=De(R^T,7),S=S+O|0,B=De(B^S,16),k=k+B|0,O=De(O^k,12),S=S+O|0,B=De(B^S,8),k=k+B|0,O=De(O^k,7),P=P+L|0,U=De(U^P,16),$=$+U|0,L=De(L^$,12),P=P+L|0,U=De(U^P,8),$=$+U|0,L=De(L^$,7),A=A+x|0,M=De(M^A,16),I=I+M|0,x=De(x^I,12),A=A+x|0,M=De(M^A,8),I=I+M|0,x=De(x^I,7);let z=0;r[z++]=o+w|0,r[z++]=a+S|0,r[z++]=c+P|0,r[z++]=l+A|0,r[z++]=u+x|0,r[z++]=d+R|0,r[z++]=h+O|0,r[z++]=f+L|0,r[z++]=p+$|0,r[z++]=g+I|0,r[z++]=m+T|0,r[z++]=b+k|0,r[z++]=v+B|0,r[z++]=C+U|0,r[z++]=N+M|0,r[z++]=y+H|0}const b3=p3(w3,{counterRight:!1,counterLength:4,allowShortKeys:!1}),E3=new Uint8Array(16),Zg=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(E3.subarray(n))},v3=new Uint8Array(32);function Jg(t,e,n,r,s){const i=t(e,n,v3),o=y3.create(i);s&&Zg(o,s),Zg(o,r);const a=o3(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return fo(i,a),c}const C3=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=Kg(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=Jg(t,e,n,a,r);return i.set(c,o),fo(c),i},decrypt(s,i){i=Kg(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=Jg(t,e,n,o,r);if(!s3(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),fo(c),i}}),uE=i3({blockSize:64,nonceLength:12,tagLength:16},C3(b3));let dE=class extends Eu{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,yp(e);const r=er(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Ln(i)}update(e){return Ps(this),this.iHash.update(e),this}digestInto(e){Ps(this),Mn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Cu=(t,e,n)=>new dE(t,e).update(n).digest();Cu.create=(t,e)=>new dE(t,e);function _3(t,e,n){return yp(t),n===void 0&&(n=new Uint8Array(t.outputLen)),Cu(t,er(n),er(e))}const Rd=Uint8Array.from([0]),Xg=Uint8Array.of();function A3(t,e,n,r=32){yp(t),Xr(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=Xg);const o=new Uint8Array(i*s),a=Cu.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)Rd[0]=u+1,c.update(u===0?Xg:l).update(n).update(Rd).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Ln(l,Rd),o.slice(0,r)}const I3=(t,e,n,r,s)=>A3(t,_3(t,e,n),r,s),_u=vu,Cp=BigInt(0),Jh=BigInt(1);function Fl(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function Vc(t){const e=t.toString(16);return e.length&1?"0"+e:e}function hE(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Cp:BigInt("0x"+t)}function Au(t){return hE(Wa(t))}function jl(t){return Mn(t),hE(Wa(Uint8Array.from(t).reverse()))}function _p(t,e){return bp(t.toString(16).padStart(e*2,"0"))}function Ap(t,e){return _p(t,e).reverse()}function nn(t,e,n){let r;if(typeof e=="string")try{r=bp(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(mp(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const Od=t=>typeof t=="bigint"&&Cp<=t;function S3(t,e,n){return Od(t)&&Od(e)&&Od(n)&&e<=t&&t<n}function Xh(t,e,n,r){if(!S3(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function N3(t){let e;for(e=0;t>Cp;t>>=Jh,e+=1);return e}const Iu=t=>(Jh<<BigInt(t))-Jh;function T3(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){i=l();const p=i.slice();f.push(p),h+=i.length}return Js(...f)};return(h,f)=>{c(),u(h);let p;for(;!(p=f(d()));)u();return c(),p}}function Su(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function Qg(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const on=BigInt(0),Wt=BigInt(1),Xs=BigInt(2),P3=BigInt(3),fE=BigInt(4),pE=BigInt(5),gE=BigInt(8);function Rn(t,e){const n=t%e;return n>=on?n:e+n}function Kn(t,e,n){let r=t;for(;e-- >on;)r*=r,r%=n;return r}function em(t,e){if(t===on)throw new Error("invert: expected non-zero number");if(e<=on)throw new Error("invert: expected positive modulus, got "+e);let n=Rn(t,e),r=e,s=on,i=Wt;for(;n!==on;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==Wt)throw new Error("invert: does not exist");return Rn(s,e)}function mE(t,e){const n=(t.ORDER+Wt)/fE,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function x3(t,e){const n=(t.ORDER-pE)/gE,r=t.mul(e,Xs),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Xs),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function R3(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-Wt,n=0;for(;e%Xs===on;)e/=Xs,n++;let r=Xs;const s=Po(t);for(;tm(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return mE;let i=s.pow(r,e);const o=(e+Wt)/Xs;return function(a,c){if(a.is0(c))return c;if(tm(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");const g=Wt<<BigInt(l-f-1),m=a.pow(u,g);l=f,u=a.sqr(m),d=a.mul(d,u),h=a.mul(h,m)}return h}}function O3(t){return t%fE===P3?mE:t%gE===pE?x3:R3(t)}const k3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function D3(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=k3.reduce((r,s)=>(r[s]="function",r),e);return Su(t,n),t}function $3(t,e,n){if(n<on)throw new Error("invalid exponent, negatives unsupported");if(n===on)return t.ONE;if(n===Wt)return e;let r=t.ONE,s=e;for(;n>on;)n&Wt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=Wt;return r}function yE(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function tm(t,e){const n=(t.ORDER-Wt)/Xs,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function U3(t,e){e!==void 0&&Xr(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Po(t,e,n=!1,r={}){if(t<=on)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=U3(t,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:a,MASK:Iu(o),ZERO:on,ONE:Wt,create:u=>Rn(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return on<=u&&u<t},is0:u=>u===on,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&Wt)===Wt,neg:u=>Rn(-u,t),eql:(u,d)=>u===d,sqr:u=>Rn(u*u,t),add:(u,d)=>Rn(u+d,t),sub:(u,d)=>Rn(u-d,t),mul:(u,d)=>Rn(u*d,t),pow:(u,d)=>$3(l,u,d),div:(u,d)=>Rn(u*em(d,t),t),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>em(u,t),sqrt:i||(u=>(c||(c=O3(t)),c(l,u))),toBytes:u=>n?Ap(u,a):_p(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return n?jl(u):Au(u)},invertBatch:u=>yE(l,u),cmov:(u,d,h)=>h?d:u});return Object.freeze(l)}function wE(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function bE(t){const e=wE(t);return e+Math.ceil(e/2)}function M3(t,e,n=!1){const r=t.length,s=wE(e),i=bE(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?jl(t):Au(t),a=Rn(o,e-Wt)+Wt;return n?Ap(a,s):_p(a,s)}const po=BigInt(0),Qs=BigInt(1);function la(t,e){const n=e.negate();return t?n:e}function L3(t,e,n){const r=i=>i.pz,s=yE(t.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(t.fromAffine)}function EE(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function kd(t,e){EE(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=Iu(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function nm(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Qs);const l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:l}}function B3(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function F3(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const Dd=new WeakMap,vE=new WeakMap;function $d(t){return vE.get(t)||1}function rm(t){if(t!==po)throw new Error("invalid wNAF")}function j3(t,e){return{constTimeNegate:la,hasPrecomputes(n){return $d(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>po;)r&Qs&&(s=s.add(i)),i=i.double(),r>>=Qs;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=kd(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=kd(n,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:p}=nm(s,c,a);s=l,d?o=o.add(la(f,r[p])):i=i.add(la(h,r[u]))}return rm(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=kd(n,e);for(let a=0;a<o.windows&&s!==po;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=nm(s,a,o);if(s=c,!u){const h=r[l];i=i.add(d?h.negate():h)}}return rm(s),i},getPrecomputes(n,r,s){let i=Dd.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),Dd.set(r,i))),i},wNAFCached(n,r,s){const i=$d(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=$d(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){EE(r,e),vE.set(n,r),Dd.delete(n)}}}function H3(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>po||r>po;)n&Qs&&(i=i.add(s)),r&Qs&&(o=o.add(s)),s=s.double(),n>>=Qs,r>>=Qs;return{p1:i,p2:o}}function q3(t,e,n,r){B3(n,t),F3(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=N3(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=Iu(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let f=d;f>=0;f-=c){u.fill(o);for(let g=0;g<i;g++){const m=r[g],b=Number(m>>BigInt(f)&l);u[b]=u[b].add(n[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(h=h.add(p),f!==0)for(let g=0;g<c;g++)h=h.double()}return h}function sm(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return D3(e),e}else return Po(t)}function W3(t,e,n={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>po))throw new Error(`CURVE.${o} must be positive bigint`)}const r=sm(e.p,n.Fp),s=sm(e.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Wo=BigInt(0),Oi=BigInt(1),Kc=BigInt(2);function z3(t){return Su(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function V3(t){const e=z3(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||To,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?Kc**BigInt(254):Kc**BigInt(447),p=a?BigInt(8)*Kc**BigInt(251)-Oi:BigInt(4)*Kc**BigInt(445)-Oi,g=f+p+Oi,m=A=>Rn(A,n),b=v(d);function v(A){return Ap(m(A),u)}function C(A){const x=nn("u coordinate",A,u);return a&&(x[31]&=127),m(jl(x))}function N(A){return jl(s(nn("scalar",A,u)))}function y(A,x){const R=P(C(x),N(A));if(R===Wo)throw new Error("invalid private or public key received");return v(R)}function w(A){return y(A,b)}function S(A,x,R){const O=m(A*(x-R));return x=m(x-O),R=m(R+O),{x_2:x,x_3:R}}function P(A,x){Xh("u",A,Wo,n),Xh("scalar",x,f,g);const R=x,O=A;let L=Oi,$=Wo,I=A,T=Oi,k=Wo;for(let U=BigInt(l-1);U>=Wo;U--){const M=R>>U&Oi;k^=M,{x_2:L,x_3:I}=S(k,L,I),{x_2:$,x_3:T}=S(k,$,T),k=M;const H=L+$,z=m(H*H),te=L-$,Z=m(te*te),ae=z-Z,pe=I+T,Be=I-T,Le=m(Be*H),Ie=m(pe*te),it=Le+Ie,At=Le-Ie;I=m(it*it),T=m(O*m(At*At)),L=m(z*Z),$=m(ae*(z+m(h*ae)))}({x_2:L,x_3:I}=S(k,L,I)),{x_2:$,x_3:T}=S(k,$,T);const B=i($);return m(L*B)}return{scalarMult:y,scalarMultBase:w,getSharedSecret:(A,x)=>y(A,x),getPublicKey:A=>w(A),utils:{randomPrivateKey:()=>c(u)},GuBytes:b.slice()}}BigInt(0);const K3=BigInt(1),im=BigInt(2),G3=BigInt(3),Y3=BigInt(5);BigInt(8);const CE={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Z3(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=CE.p,o=t*t%i*t%i,a=Kn(o,im,i)*o%i,c=Kn(a,K3,i)*t%i,l=Kn(c,Y3,i)*c%i,u=Kn(l,e,i)*l%i,d=Kn(u,n,i)*u%i,h=Kn(d,r,i)*d%i,f=Kn(h,s,i)*h%i,p=Kn(f,s,i)*h%i,g=Kn(p,e,i)*l%i;return{pow_p_5_8:Kn(g,im,i)*t%i,b2:o}}function J3(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Qh=(()=>{const t=CE.p;return V3({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=Z3(e);return Rn(Kn(n,G3,t)*r,t)},adjustScalarBytes:J3})})();function om(t){t.lowS!==void 0&&Fl("lowS",t.lowS),t.prehash!==void 0&&Fl("prehash",t.prehash)}class X3 extends Error{constructor(e=""){super(e)}}const Wr={Err:X3,_tlv:{encode:(t,e)=>{const{Err:n}=Wr;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=Vc(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?Vc(s.length/2|128):"";return Vc(t)+i+s+e},decode(t,e){const{Err:n}=Wr;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=Wr;if(t<ua)throw new e("integer: negative integers are not allowed");let n=Vc(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=Wr;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return Au(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=Wr,s=nn("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=Wr,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},ua=BigInt(0),da=BigInt(1),Q3=BigInt(2),Gc=BigInt(3),e8=BigInt(4);function t8(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function _E(t,e,n){const{BYTES:r}=t;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=nn("private key",i);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=t.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function n8(t,e={}){const{Fp:n,Fn:r}=W3("weierstrass",t,e),{h:s,n:i}=t;Su(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!n.is0(t.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(P,A,x){const{x:R,y:O}=A.toAffine(),L=n.toBytes(R);if(Fl("isCompressed",x),x){a();const $=!n.isOdd(O);return Js(AE($),L)}else return Js(Uint8Array.of(4),L,n.toBytes(O))}function l(P){Mn(P);const A=n.BYTES,x=A+1,R=2*A+1,O=P.length,L=P[0],$=P.subarray(1);if(O===x&&(L===2||L===3)){const I=n.fromBytes($);if(!n.isValid(I))throw new Error("bad point: is not on curve, wrong x");const T=h(I);let k;try{k=n.sqrt(T)}catch(U){const M=U instanceof Error?": "+U.message:"";throw new Error("bad point: is not on curve, sqrt error"+M)}a();const B=n.isOdd(k);return(L&1)===1!==B&&(k=n.neg(k)),{x:I,y:k}}else if(O===R&&L===4){const I=n.fromBytes($.subarray(A*0,A*1)),T=n.fromBytes($.subarray(A*1,A*2));if(!f(I,T))throw new Error("bad point: is not on curve");return{x:I,y:T}}else throw new Error(`bad point: got length ${O}, expected compressed=${x} or uncompressed=${R}`)}const u=e.toBytes||c,d=e.fromBytes||l,h=t8(n,t.a,t.b);function f(P,A){const x=n.sqr(A),R=h(P);return n.eql(x,R)}if(!f(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const p=n.mul(n.pow(t.a,Gc),e8),g=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(p,g)))throw new Error("bad curve params: a or b");function m(P,A,x=!1){if(!n.isValid(A)||x&&n.is0(A))throw new Error(`bad point coordinate ${P}`);return A}function b(P){if(!(P instanceof y))throw new Error("ProjectivePoint expected")}const v=Qg((P,A)=>{const{px:x,py:R,pz:O}=P;if(n.eql(O,n.ONE))return{x,y:R};const L=P.is0();A==null&&(A=L?n.ONE:n.inv(O));const $=n.mul(x,A),I=n.mul(R,A),T=n.mul(O,A);if(L)return{x:n.ZERO,y:n.ZERO};if(!n.eql(T,n.ONE))throw new Error("invZ was invalid");return{x:$,y:I}}),C=Qg(P=>{if(P.is0()){if(e.allowInfinityPoint&&!n.is0(P.py))return;throw new Error("bad point: ZERO")}const{x:A,y:x}=P.toAffine();if(!n.isValid(A)||!n.isValid(x))throw new Error("bad point: x or y not field elements");if(!f(A,x))throw new Error("bad point: equation left != right");if(!P.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function N(P,A,x,R,O){return x=new y(n.mul(x.px,P),x.py,x.pz),A=la(R,A),x=la(O,x),A.add(x)}class y{constructor(A,x,R){this.px=m("x",A),this.py=m("y",x,!0),this.pz=m("z",R),Object.freeze(this)}static fromAffine(A){const{x,y:R}=A||{};if(!A||!n.isValid(x)||!n.isValid(R))throw new Error("invalid affine point");if(A instanceof y)throw new Error("projective point not allowed");return n.is0(x)&&n.is0(R)?y.ZERO:new y(x,R,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(A){return L3(y,"pz",A)}static fromBytes(A){return Mn(A),y.fromHex(A)}static fromHex(A){const x=y.fromAffine(d(nn("pointHex",A)));return x.assertValidity(),x}static fromPrivateKey(A){const x=_E(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return y.BASE.multiply(x(A))}static msm(A,x){return q3(y,r,A,x)}precompute(A=8,x=!0){return S.setWindowSize(this,A),x||this.multiply(Gc),this}_setWindowSize(A){this.precompute(A)}assertValidity(){C(this)}hasEvenY(){const{y:A}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(A)}equals(A){b(A);const{px:x,py:R,pz:O}=this,{px:L,py:$,pz:I}=A,T=n.eql(n.mul(x,I),n.mul(L,O)),k=n.eql(n.mul(R,I),n.mul($,O));return T&&k}negate(){return new y(this.px,n.neg(this.py),this.pz)}double(){const{a:A,b:x}=t,R=n.mul(x,Gc),{px:O,py:L,pz:$}=this;let I=n.ZERO,T=n.ZERO,k=n.ZERO,B=n.mul(O,O),U=n.mul(L,L),M=n.mul($,$),H=n.mul(O,L);return H=n.add(H,H),k=n.mul(O,$),k=n.add(k,k),I=n.mul(A,k),T=n.mul(R,M),T=n.add(I,T),I=n.sub(U,T),T=n.add(U,T),T=n.mul(I,T),I=n.mul(H,I),k=n.mul(R,k),M=n.mul(A,M),H=n.sub(B,M),H=n.mul(A,H),H=n.add(H,k),k=n.add(B,B),B=n.add(k,B),B=n.add(B,M),B=n.mul(B,H),T=n.add(T,B),M=n.mul(L,$),M=n.add(M,M),B=n.mul(M,H),I=n.sub(I,B),k=n.mul(M,U),k=n.add(k,k),k=n.add(k,k),new y(I,T,k)}add(A){b(A);const{px:x,py:R,pz:O}=this,{px:L,py:$,pz:I}=A;let T=n.ZERO,k=n.ZERO,B=n.ZERO;const U=t.a,M=n.mul(t.b,Gc);let H=n.mul(x,L),z=n.mul(R,$),te=n.mul(O,I),Z=n.add(x,R),ae=n.add(L,$);Z=n.mul(Z,ae),ae=n.add(H,z),Z=n.sub(Z,ae),ae=n.add(x,O);let pe=n.add(L,I);return ae=n.mul(ae,pe),pe=n.add(H,te),ae=n.sub(ae,pe),pe=n.add(R,O),T=n.add($,I),pe=n.mul(pe,T),T=n.add(z,te),pe=n.sub(pe,T),B=n.mul(U,ae),T=n.mul(M,te),B=n.add(T,B),T=n.sub(z,B),B=n.add(z,B),k=n.mul(T,B),z=n.add(H,H),z=n.add(z,H),te=n.mul(U,te),ae=n.mul(M,ae),z=n.add(z,te),te=n.sub(H,te),te=n.mul(U,te),ae=n.add(ae,te),H=n.mul(z,ae),k=n.add(k,H),H=n.mul(pe,ae),T=n.mul(Z,T),T=n.sub(T,H),H=n.mul(Z,z),B=n.mul(pe,B),B=n.add(B,H),new y(T,k,B)}subtract(A){return this.add(A.negate())}is0(){return this.equals(y.ZERO)}multiply(A){const{endo:x}=e;if(!r.isValidNot0(A))throw new Error("invalid scalar: out of range");let R,O;const L=$=>S.wNAFCached(this,$,y.normalizeZ);if(x){const{k1neg:$,k1:I,k2neg:T,k2:k}=x.splitScalar(A),{p:B,f:U}=L(I),{p:M,f:H}=L(k);O=U.add(H),R=N(x.beta,B,M,$,T)}else{const{p:$,f:I}=L(A);R=$,O=I}return y.normalizeZ([R,O])[0]}multiplyUnsafe(A){const{endo:x}=e,R=this;if(!r.isValid(A))throw new Error("invalid scalar: out of range");if(A===ua||R.is0())return y.ZERO;if(A===da)return R;if(S.hasPrecomputes(this))return this.multiply(A);if(x){const{k1neg:O,k1:L,k2neg:$,k2:I}=x.splitScalar(A),{p1:T,p2:k}=H3(y,R,L,I);return N(x.beta,T,k,O,$)}else return S.wNAFCachedUnsafe(R,A)}multiplyAndAddUnsafe(A,x,R){const O=this.multiplyUnsafe(x).add(A.multiplyUnsafe(R));return O.is0()?void 0:O}toAffine(A){return v(this,A)}isTorsionFree(){const{isTorsionFree:A}=e;return s===da?!0:A?A(y,this):S.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:A}=e;return s===da?this:A?A(y,this):this.multiplyUnsafe(s)}toBytes(A=!0){return Fl("isCompressed",A),this.assertValidity(),u(y,this,A)}toRawBytes(A=!0){return this.toBytes(A)}toHex(A=!0){return Wa(this.toBytes(A))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}y.BASE=new y(t.Gx,t.Gy,n.ONE),y.ZERO=new y(n.ZERO,n.ONE,n.ZERO),y.Fp=n,y.Fn=r;const w=r.BITS,S=j3(y,e.endo?Math.ceil(w/2):w);return y}function AE(t){return Uint8Array.of(t?2:3)}function r8(t,e,n={}){Su(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||To,s=e.hmac||((R,...O)=>Cu(e.hash,R,Js(...O))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o;function l(R){const O=a>>da;return R>O}function u(R){return l(R)?o.neg(R):R}function d(R,O){if(!o.isValidNot0(O))throw new Error(`invalid signature ${R}: out of range 1..CURVE.n`)}class h{constructor(O,L,$){d("r",O),d("s",L),this.r=O,this.s=L,$!=null&&(this.recovery=$),Object.freeze(this)}static fromCompact(O){const L=o.BYTES,$=nn("compactSignature",O,L*2);return new h(o.fromBytes($.subarray(0,L)),o.fromBytes($.subarray(L,L*2)))}static fromDER(O){const{r:L,s:$}=Wr.toSig(nn("DER",O));return new h(L,$)}assertValidity(){}addRecoveryBit(O){return new h(this.r,this.s,O)}recoverPublicKey(O){const L=i.ORDER,{r:$,s:I,recovery:T}=this;if(T==null||![0,1,2,3].includes(T))throw new Error("recovery id invalid");if(a*Q3<L&&T>1)throw new Error("recovery id is ambiguous for h>1 curve");const k=T===2||T===3?$+a:$;if(!i.isValid(k))throw new Error("recovery id 2 or 3 invalid");const B=i.toBytes(k),U=t.fromHex(Js(AE((T&1)===0),B)),M=o.inv(k),H=C(nn("msgHash",O)),z=o.create(-H*M),te=o.create(I*M),Z=t.BASE.multiplyUnsafe(z).add(U.multiplyUnsafe(te));if(Z.is0())throw new Error("point at infinify");return Z.assertValidity(),Z}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes(O){if(O==="compact")return Js(o.toBytes(this.r),o.toBytes(this.s));if(O==="der")return bp(Wr.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Wa(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Wa(this.toBytes("compact"))}}const f=_E(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),p={isValidPrivateKey(R){try{return f(R),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const R=a;return M3(r(bE(R)),R)},precompute(R=8,O=t.BASE){return O.precompute(R,!1)}};function g(R,O=!0){return t.fromPrivateKey(R).toBytes(O)}function m(R){if(typeof R=="bigint")return!1;if(R instanceof t)return!0;const O=nn("key",R).length,L=i.BYTES,$=L+1,I=2*L+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===$))return O===$||O===I}function b(R,O,L=!0){if(m(R)===!0)throw new Error("first arg must be private key");if(m(O)===!1)throw new Error("second arg must be public key");return t.fromHex(O).multiply(f(R)).toBytes(L)}const v=e.bits2int||function(R){if(R.length>8192)throw new Error("input is too large");const O=Au(R),L=R.length*8-c;return L>0?O>>BigInt(L):O},C=e.bits2int_modN||function(R){return o.create(v(R))},N=Iu(c);function y(R){return Xh("num < 2^"+c,R,ua,N),o.toBytes(R)}function w(R,O,L=S){if(["recovered","canonical"].some(Z=>Z in L))throw new Error("sign() legacy options not supported");const{hash:$}=e;let{lowS:I,prehash:T,extraEntropy:k}=L;I==null&&(I=!0),R=nn("msgHash",R),om(L),T&&(R=nn("prehashed msgHash",$(R)));const B=C(R),U=f(O),M=[y(U),y(B)];if(k!=null&&k!==!1){const Z=k===!0?r(i.BYTES):k;M.push(nn("extraEntropy",Z))}const H=Js(...M),z=B;function te(Z){const ae=v(Z);if(!o.isValidNot0(ae))return;const pe=o.inv(ae),Be=t.BASE.multiply(ae).toAffine(),Le=o.create(Be.x);if(Le===ua)return;const Ie=o.create(pe*o.create(z+Le*U));if(Ie===ua)return;let it=(Be.x===Le?0:2)|Number(Be.y&da),At=Ie;return I&&l(Ie)&&(At=u(Ie),it^=1),new h(Le,At,it)}return{seed:H,k2sig:te}}const S={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function A(R,O,L=S){const{seed:$,k2sig:I}=w(R,O,L);return T3(e.hash.outputLen,o.BYTES,s)($,I)}t.BASE.precompute(8);function x(R,O,L,$=P){const I=R;O=nn("msgHash",O),L=nn("publicKey",L),om($);const{lowS:T,prehash:k,format:B}=$;if("strict"in $)throw new Error("options.strict was renamed to lowS");if(B!==void 0&&!["compact","der","js"].includes(B))throw new Error('format must be "compact", "der" or "js"');const U=typeof I=="string"||mp(I),M=!U&&!B&&typeof I=="object"&&I!==null&&typeof I.r=="bigint"&&typeof I.s=="bigint";if(!U&&!M)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let H,z;try{if(M)if(B===void 0||B==="js")H=new h(I.r,I.s);else throw new Error("invalid format");if(U){try{B!=="compact"&&(H=h.fromDER(I))}catch(it){if(!(it instanceof Wr.Err))throw it}!H&&B!=="der"&&(H=h.fromCompact(I))}z=t.fromHex(L)}catch{return!1}if(!H||T&&H.hasHighS())return!1;k&&(O=e.hash(O));const{r:te,s:Z}=H,ae=C(O),pe=o.inv(Z),Be=o.create(ae*pe),Le=o.create(te*pe),Ie=t.BASE.multiplyUnsafe(Be).add(z.multiplyUnsafe(Le));return Ie.is0()?!1:o.create(Ie.x)===te}return Object.freeze({getPublicKey:g,getSharedSecret:b,sign:A,verify:x,utils:p,Point:t,Signature:h})}function s8(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=Po(e.n,t.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function i8(t){const{CURVE:e,curveOpts:n}=s8(t),r={hash:t.hash,hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,ecdsaOpts:r}}function o8(t,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:t})}function a8(t){const{CURVE:e,curveOpts:n,ecdsaOpts:r}=i8(t),s=n8(e,n),i=r8(s,r,n);return o8(t,i)}function ef(t,e){const n=r=>a8({...t,hash:r});return{...n(e),create:n}}const IE={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},SE={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},NE={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},c8=Po(IE.p),l8=Po(SE.p),u8=Po(NE.p),d8=ef({...IE,Fp:c8,lowS:!1},vu);ef({...SE,Fp:l8,lowS:!1},bO),ef({...NE,Fp:u8,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},wO);const h8=d8,TE="base10",zt="base16",sn="base64pad",ys="base64url",Ic="utf8",PE=0,Kr=1,Sc=2,f8=0,am=1,ha=12,Ip=32;function p8(){const t=Qh.utils.randomPrivateKey(),e=Qh.getPublicKey(t);return{privateKey:cn(t,zt),publicKey:cn(e,zt)}}function tf(){const t=To(Ip);return cn(t,zt)}function g8(t,e){const n=Qh.getSharedSecret(kn(t,zt),kn(e,zt)),r=I3(_u,n,void 0,void 0,Ip);return cn(r,zt)}function hl(t){const e=_u(kn(t,zt));return cn(e,zt)}function Tn(t){const e=_u(kn(t,Ic));return cn(e,zt)}function xE(t){return kn(`${t}`,TE)}function fi(t){return Number(cn(t,TE))}function RE(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function OE(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function m8(t){const e=xE(typeof t.type<"u"?t.type:PE);if(fi(e)===Kr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?kn(t.senderPublicKey,zt):void 0,r=typeof t.iv<"u"?kn(t.iv,zt):To(ha),s=kn(t.symKey,zt),i=uE(s,r).encrypt(kn(t.message,Ic)),o=kE({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===ys?RE(o):o}function y8(t){const e=kn(t.symKey,zt),{sealed:n,iv:r}=Va({encoded:t.encoded,encoding:t.encoding}),s=uE(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return cn(s,Ic)}function w8(t,e){const n=xE(Sc),r=To(ha),s=kn(t,Ic),i=kE({type:n,sealed:s,iv:r});return e===ys?RE(i):i}function b8(t,e){const{sealed:n}=Va({encoded:t,encoding:e});return cn(n,Ic)}function kE(t){if(fi(t.type)===Sc)return cn(ca([t.type,t.sealed]),sn);if(fi(t.type)===Kr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return cn(ca([t.type,t.senderPublicKey,t.iv,t.sealed]),sn)}return cn(ca([t.type,t.iv,t.sealed]),sn)}function Va(t){const e=(t.encoding||sn)===ys?OE(t.encoded):t.encoded,n=kn(e,sn),r=n.slice(f8,am),s=am;if(fi(r)===Kr){const c=s+Ip,l=c+ha,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(fi(r)===Sc){const c=n.slice(s),l=To(ha);return{type:r,sealed:c,iv:l}}const i=s+ha,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function E8(t,e){const n=Va({encoded:t,encoding:e?.encoding});return DE({type:fi(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?cn(n.senderPublicKey,zt):void 0,receiverPublicKey:e?.receiverPublicKey})}function DE(t){const e=t?.type||PE;if(e===Kr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function cm(t){return t.type===Kr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function lm(t){return t.type===Sc}function v8(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return ca([new Uint8Array([4]),e,n])}function C8(t,e){const[n,r,s]=t.split("."),i=Buffer.from(OE(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=_u(c),u=v8(e);if(!h8.verify(ca([o,a]),l,u))throw new Error("Invalid signature");return Uh(t).payload}const _8="irn";function Hl(t){return t?.relay||{protocol:_8}}function Xi(t){const e=iR[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function A8(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function um(t){if(!t.includes("wc:")){const l=z1(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:I8(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:A8(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function I8(t){return t.startsWith("//")?t.substring(2):t}function S8(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function dm(t){const e=new URLSearchParams,n=S8(t.relay);Object.keys(n).sort().forEach(s=>{e.set(s,n[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const r=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${r}`}function Yc(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var N8=Object.defineProperty,T8=Object.defineProperties,P8=Object.getOwnPropertyDescriptors,hm=Object.getOwnPropertySymbols,x8=Object.prototype.hasOwnProperty,R8=Object.prototype.propertyIsEnumerable,fm=(t,e,n)=>e in t?N8(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,O8=(t,e)=>{for(var n in e||(e={}))x8.call(e,n)&&fm(t,n,e[n]);if(hm)for(var n of hm(e))R8.call(e,n)&&fm(t,n,e[n]);return t},k8=(t,e)=>T8(t,P8(e));function xo(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function D8(t){const e=[];return Object.values(t).forEach(n=>{e.push(...xo(n.accounts))}),e}function $8(t,e){const n=[];return Object.values(t).forEach(r=>{xo(r.accounts).includes(e)&&n.push(...r.methods)}),n}function U8(t,e){const n=[];return Object.values(t).forEach(r=>{xo(r.accounts).includes(e)&&n.push(...r.events)}),n}function Nu(t){return t.includes(":")}function Qi(t){return Nu(t)?t.split(":")[0]:t}function pm(t){var e,n,r;const s={};if(!Cr(t))return s;for(const[i,o]of Object.entries(t)){const a=Nu(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Qi(i);s[u]=k8(O8({},s[u]),{chains:vr(a,(e=s[u])==null?void 0:e.chains),methods:vr(c,(n=s[u])==null?void 0:n.methods),events:vr(l,(r=s[u])==null?void 0:r.events)})}return s}function M8(t){const e={};return t?.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function gm(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=M8(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=vr(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function L8(t,e){var n,r,s,i,o,a;const c=pm(t),l=pm(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:vr((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:vr((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:vr((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const B8={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},F8={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function G(t,e){const{message:n,code:r}=F8[t];return{message:e?`${n} ${e}`:n,code:r}}function Qe(t,e){const{message:n,code:r}=B8[t];return{message:e?`${n} ${e}`:n,code:r}}function Gr(t,e){return!!Array.isArray(t)}function Cr(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function yt(t){return typeof t>"u"}function ht(t,e){return e&&yt(t)?!0:typeof t=="string"&&!!t.trim().length}function Sp(t,e){return e&&yt(t)?!0:typeof t=="number"&&!isNaN(t)}function j8(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return Zs(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=xo(a),d=n[o];(!Zs(F1(o,d),u)||!Zs(d.methods,c)||!Zs(d.events,l))&&(i=!1)}),i):!1}function ql(t){return ht(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function H8(t){if(ht(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&ql(n)}}return!1}function q8(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(ht(t,!1)){if(e(t))return!0;const n=z1(t);return e(n)}}catch{}return!1}function W8(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function z8(t){return t?.topic}function V8(t,e){let n=null;return ht(t?.publicKey,!1)||(n=G("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function mm(t){let e=!0;return Gr(t)?t.length&&(e=t.every(n=>ht(n,!1))):e=!1,e}function K8(t,e,n){let r=null;return Gr(e)&&e.length?e.forEach(s=>{r||ql(s)||(r=Qe("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):ql(t)||(r=Qe("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function G8(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=K8(s,F1(s,i),`${e} ${n}`);o&&(r=o)}),r}function Y8(t,e){let n=null;return Gr(t)?t.forEach(r=>{n||H8(r)||(n=Qe("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=Qe("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function Z8(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=Y8(r?.accounts,`${e} namespace`);s&&(n=s)}),n}function J8(t,e){let n=null;return mm(t?.methods)?mm(t?.events)||(n=Qe("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=Qe("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function $E(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=J8(r,`${e}, namespace`);s&&(n=s)}),n}function X8(t,e,n){let r=null;if(t&&Cr(t)){const s=$E(t,e);s&&(r=s);const i=G8(t,e,n);i&&(r=i)}else r=G("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function Ud(t,e){let n=null;if(t&&Cr(t)){const r=$E(t,e);r&&(n=r);const s=Z8(t,e);s&&(n=s)}else n=G("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function UE(t){return ht(t.protocol,!0)}function Q8(t,e){let n=!1;return t?t&&Gr(t)&&t.length&&t.forEach(r=>{n=UE(r)}):n=!0,n}function ek(t){return typeof t=="number"}function en(t){return typeof t<"u"&&typeof t!==null}function tk(t){return!(!t||typeof t!="object"||!t.code||!Sp(t.code,!1)||!t.message||!ht(t.message,!1))}function nk(t){return!(yt(t)||!ht(t.method,!1))}function rk(t){return!(yt(t)||yt(t.result)&&yt(t.error)||!Sp(t.id,!1)||!ht(t.jsonrpc,!1))}function sk(t){return!(yt(t)||!ht(t.name,!1))}function ym(t,e){return!(!ql(e)||!D8(t).includes(e))}function ik(t,e,n){return ht(n,!1)?$8(t,e).includes(n):!1}function ok(t,e,n){return ht(n,!1)?U8(t,e).includes(n):!1}function wm(t,e,n){let r=null;const s=ak(t),i=ck(e),o=Object.keys(s),a=Object.keys(i),c=bm(Object.keys(t)),l=bm(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),Zs(o,a)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const h=xo(e[d].accounts);h.includes(d)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(Zs(s[d].methods,i[d].methods)?Zs(s[d].events,i[d].events)||(r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=G("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function ak(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function bm(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function ck(t){const e={};return Object.keys(t).forEach(n=>{n.includes(":")?e[n]=t[n]:xo(t[n].accounts)?.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}),e}function lk(t,e){return Sp(t,!1)&&t<=e.max&&t>=e.min}function Em(){const t=_c();return new Promise(e=>{switch(t){case bn.browser:e(uk());break;case bn.reactNative:e(dk());break;case bn.node:e(hk());break;default:e(!0)}})}function uk(){return No()&&navigator?.onLine}async function dk(){return ks()&&typeof global<"u"&&global!=null&&global.NetInfo?(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected:!0}function hk(){return!0}function fk(t){switch(_c()){case bn.browser:pk(t);break;case bn.reactNative:gk(t);break}}function pk(t){!ks()&&No()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function gk(t){ks()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener(e=>t(e?.isConnected))}function mk(){var t;return No()&&Jr.getDocument()?((t=Jr.getDocument())==null?void 0:t.visibilityState)==="visible":!0}const Md={};class zo{static get(e){return Md[e]}static set(e,n){Md[e]=n}static delete(e){delete Md[e]}}function yk(t){const e=So.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function wk({publicKey:t,signature:e,payload:n}){var r;const s=nf(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=vk(n.address),a=n.era==="00"?new Uint8Array([0]):nf(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${Ek(n.tip)}`),d=_k(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),f=Ck(h.length+1);return new Uint8Array([...f,i,...h])}function bk(t){const e=nf(t),n=lR.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function nf(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function Ek(t){return t.startsWith("0x")?t.slice(2):t}function vk(t){const e=So.decode(t)[0];return e===42?0:e===60?2:1}function Ck(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function _k(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function Ak(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=yk(t.transaction.address),r=wk({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return bk(s)}const Ik="PARSE_ERROR",Sk="INVALID_REQUEST",Nk="METHOD_NOT_FOUND",Tk="INVALID_PARAMS",ME="INTERNAL_ERROR",Np="SERVER_ERROR",Pk=[-32700,-32600,-32601,-32602,-32603],fa={[Ik]:{code:-32700,message:"Parse error"},[Sk]:{code:-32600,message:"Invalid Request"},[Nk]:{code:-32601,message:"Method not found"},[Tk]:{code:-32602,message:"Invalid params"},[ME]:{code:-32603,message:"Internal error"},[Np]:{code:-32e3,message:"Server error"}},LE=Np;function xk(t){return Pk.includes(t)}function vm(t){return Object.keys(fa).includes(t)?fa[t]:fa[LE]}function Rk(t){const e=Object.values(fa).find(n=>n.code===t);return e||fa[LE]}function BE(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var Ld={},Ur={},Cm;function Ok(){if(Cm)return Ur;Cm=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.isBrowserCryptoAvailable=Ur.getSubtleCrypto=Ur.getBrowerCrypto=void 0;function t(){return(fr===null||fr===void 0?void 0:fr.crypto)||(fr===null||fr===void 0?void 0:fr.msCrypto)||{}}Ur.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Ur.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Ur.isBrowserCryptoAvailable=n,Ur}var Mr={},_m;function kk(){if(_m)return Mr;_m=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.isBrowser=Mr.isNode=Mr.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Mr.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Mr.isNode=e;function n(){return!t()&&!e()}return Mr.isBrowser=n,Mr}var Am;function Dk(){return Am||(Am=1,(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=yc;e.__exportStar(Ok(),t),e.__exportStar(kk(),t)})(Ld)),Ld}var $k=Dk();function dr(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function vs(t=6){return BigInt(dr(t))}function pr(t,e,n){return{id:n||dr(),jsonrpc:"2.0",method:t,params:e}}function Ka(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Tu(t,e,n){return{id:t,jsonrpc:"2.0",error:Uk(e)}}function Uk(t,e){return typeof t>"u"?vm(ME):(typeof t=="string"&&(t=Object.assign(Object.assign({},vm(Np)),{message:t})),xk(t.code)&&(t=Rk(t.code)),t)}let Mk=class{},Lk=class extends Mk{constructor(){super()}},Bk=class extends Lk{constructor(e){super()}};const Fk="^https?:",jk="^wss?:";function Hk(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function FE(t,e){const n=Hk(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function Im(t){return FE(t,Fk)}function Sm(t){return FE(t,jk)}function qk(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function jE(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Tp(t){return jE(t)&&"method"in t}function Pu(t){return jE(t)&&(hr(t)||Pn(t))}function hr(t){return"result"in t}function Pn(t){return"error"in t}let Hn=class extends Bk{constructor(e){super(e),this.events=new jn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(pr(e.method,e.params||[],e.id||vs().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{Pn(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Pu(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const Wk=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),zk=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Nm=t=>t.split("?")[0],Tm=10,Vk=Wk();let Kk=class{constructor(e){if(this.url=e,this.events=new jn.EventEmitter,this.registering=!1,!Sm(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Zr(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!Sm(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=$k.isReactNative()?void 0:{rejectUnauthorized:!qk(e)},i=new Vk(e,[],s);zk()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?di(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Tu(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return BE(e,Nm(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Tm&&this.events.setMaxListeners(Tm)}emitError(e){const n=this.parseError(new Error(e?.message||`WebSocket connection failed for host: ${Nm(this.url)}`));return this.events.emit("register_error",n),n}};var Gk={};const HE="wc",qE=2,rf="core",Sr=`${HE}@2:${rf}:`,Yk={logger:"error"},Zk={database:":memory:"},Jk="crypto",Pm="client_ed25519_seed",Xk=Y.ONE_DAY,Qk="keychain",eD="0.3",tD="messages",nD="0.3",rD=Y.SIX_HOURS,sD="publisher",WE="irn",iD="error",zE="wss://relay.walletconnect.org",oD="relayer",at={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},aD="_subscription",_n={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},cD=.1,sf="2.21.7",Ze={link_mode:"link_mode",relay:"relay"},fl={inbound:"inbound",outbound:"outbound"},lD="0.3",uD="WALLETCONNECT_CLIENT_ID",xm="WALLETCONNECT_LINK_MODE_APPS",gn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},dD="subscription",hD="0.3",fD="pairing",pD="0.3",Vo={wc_pairingDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:0},res:{ttl:Y.ONE_DAY,prompt:!1,tag:0}}},Ws={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Vn={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},gD="history",mD="0.3",yD="expirer",Nn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},wD="0.3",bD="verify-api",ED="https://verify.walletconnect.com",VE="https://verify.walletconnect.org",pa=VE,vD=`${pa}/v3`,CD=[ED,VE],_D="echo",AD="https://echo.walletconnect.com",ur={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Br={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},ds={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Ko={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Ls={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Go={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},ID=.1,SD="event-client",ND=86400,TD="https://pulse.walletconnect.org/batch";function PD(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,b=0,v=p.length;b!==v&&p[b]===0;)b++,g++;for(var C=(v-b)*u+1>>>0,N=new Uint8Array(C);b!==v;){for(var y=p[b],w=0,S=C-1;(y!==0||w<m)&&S!==-1;S--,w++)y+=256*N[S]>>>0,N[S]=y%a>>>0,y=y/a>>>0;if(y!==0)throw new Error("Non-zero carry");m=w,b++}for(var P=C-m;P!==C&&N[P]===0;)P++;for(var A=c.repeat(g);P<C;++P)A+=t.charAt(N[P]);return A}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,b=0;p[g]===c;)m++,g++;for(var v=(p.length-g)*l+1>>>0,C=new Uint8Array(v);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var y=0,w=v-1;(N!==0||y<b)&&w!==-1;w--,y++)N+=a*C[w]>>>0,C[w]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");b=y,g++}if(p[g]!==" "){for(var S=v-b;S!==v&&C[S]===0;)S++;for(var P=new Uint8Array(m+(v-S)),A=m;S!==v;)P[A++]=C[S++];return P}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var xD=PD,RD=xD;const KE=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},OD=t=>new TextEncoder().encode(t),kD=t=>new TextDecoder().decode(t);class DD{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class $D{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return GE(this,e)}}class UD{constructor(e){this.decoders=e}or(e){return GE(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const GE=(t,e)=>new UD({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class MD{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new DD(e,n,r),this.decoder=new $D(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const xu=({name:t,prefix:e,encode:n,decode:r})=>new MD(t,e,n,r),Nc=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=RD(n,e);return xu({prefix:t,name:e,encode:r,decode:i=>KE(s(i))})},LD=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},BD=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Dt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>xu({prefix:e,name:t,encode(s){return BD(s,r,n)},decode(s){return LD(s,r,n,t)}}),FD=xu({prefix:"\0",name:"identity",encode:t=>kD(t),decode:t=>OD(t)});var jD=Object.freeze({__proto__:null,identity:FD});const HD=Dt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var qD=Object.freeze({__proto__:null,base2:HD});const WD=Dt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var zD=Object.freeze({__proto__:null,base8:WD});const VD=Nc({prefix:"9",name:"base10",alphabet:"0123456789"});var KD=Object.freeze({__proto__:null,base10:VD});const GD=Dt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),YD=Dt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var ZD=Object.freeze({__proto__:null,base16:GD,base16upper:YD});const JD=Dt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),XD=Dt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),QD=Dt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),e$=Dt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),t$=Dt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),n$=Dt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),r$=Dt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),s$=Dt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),i$=Dt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var o$=Object.freeze({__proto__:null,base32:JD,base32upper:XD,base32pad:QD,base32padupper:e$,base32hex:t$,base32hexupper:n$,base32hexpad:r$,base32hexpadupper:s$,base32z:i$});const a$=Nc({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),c$=Nc({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var l$=Object.freeze({__proto__:null,base36:a$,base36upper:c$});const u$=Nc({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),d$=Nc({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var h$=Object.freeze({__proto__:null,base58btc:u$,base58flickr:d$});const f$=Dt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),p$=Dt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),g$=Dt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),m$=Dt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var y$=Object.freeze({__proto__:null,base64:f$,base64pad:p$,base64url:g$,base64urlpad:m$});const YE=Array.from(""),w$=YE.reduce((t,e,n)=>(t[n]=e,t),[]),b$=YE.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function E$(t){return t.reduce((e,n)=>(e+=w$[n],e),"")}function v$(t){const e=[];for(const n of t){const r=b$[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const C$=xu({prefix:"",name:"base256emoji",encode:E$,decode:v$});var _$=Object.freeze({__proto__:null,base256emoji:C$}),A$=ZE,Rm=128,I$=-128,S$=Math.pow(2,31);function ZE(t,e,n){e=e||[],n=n||0;for(var r=n;t>=S$;)e[n++]=t&255|Rm,t/=128;for(;t&I$;)e[n++]=t&255|Rm,t>>>=7;return e[n]=t|0,ZE.bytes=n-r+1,e}var N$=of,T$=128,Om=127;function of(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw of.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Om)<<s:(o&Om)*Math.pow(2,s),s+=7}while(o>=T$);return of.bytes=i-r,n}var P$=Math.pow(2,7),x$=Math.pow(2,14),R$=Math.pow(2,21),O$=Math.pow(2,28),k$=Math.pow(2,35),D$=Math.pow(2,42),$$=Math.pow(2,49),U$=Math.pow(2,56),M$=Math.pow(2,63),L$=function(t){return t<P$?1:t<x$?2:t<R$?3:t<O$?4:t<k$?5:t<D$?6:t<$$?7:t<U$?8:t<M$?9:10},B$={encode:A$,decode:N$,encodingLength:L$},JE=B$;const km=(t,e,n=0)=>(JE.encode(t,e,n),e),Dm=t=>JE.encodingLength(t),af=(t,e)=>{const n=e.byteLength,r=Dm(t),s=r+Dm(n),i=new Uint8Array(s+n);return km(t,i,0),km(n,i,r),i.set(e,s),new F$(t,n,e,i)};class F${constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const XE=({name:t,code:e,encode:n})=>new j$(t,e,n);class j${constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?af(this.code,n):n.then(r=>af(this.code,r))}else throw Error("Unknown type, must be binary type")}}const QE=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),H$=XE({name:"sha2-256",code:18,encode:QE("SHA-256")}),q$=XE({name:"sha2-512",code:19,encode:QE("SHA-512")});var W$=Object.freeze({__proto__:null,sha256:H$,sha512:q$});const ev=0,z$="identity",tv=KE,V$=t=>af(ev,tv(t)),K$={code:ev,name:z$,encode:tv,digest:V$};var G$=Object.freeze({__proto__:null,identity:K$});new TextEncoder,new TextDecoder;const $m={...jD,...qD,...zD,...KD,...ZD,...o$,...l$,...h$,...y$,..._$};({...W$,...G$});function nv(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Y$(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?nv(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function rv(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Um=rv("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Bd=rv("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=Y$(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),Z$={utf8:Um,"utf-8":Um,hex:$m.base16,latin1:Bd,ascii:Bd,binary:Bd,...$m};function J$(t,e="utf8"){const n=Z$[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?nv(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var X$=Object.defineProperty,Q$=(t,e,n)=>e in t?X$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cr=(t,e,n)=>Q$(t,typeof e!="symbol"?e+"":e,n);class e4{constructor(e,n){this.core=e,this.logger=n,cr(this,"keychain",new Map),cr(this,"name",Qk),cr(this,"version",eD),cr(this,"initialized",!1),cr(this,"storagePrefix",Sr),cr(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),cr(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),cr(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),cr(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=G("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),cr(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=jt(n,this.name)}get context(){return hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Wh(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?zh(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var t4=Object.defineProperty,n4=(t,e,n)=>e in t?t4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,St=(t,e,n)=>n4(t,typeof e!="symbol"?e+"":e,n);class r4{constructor(e,n,r){this.core=e,this.logger=n,St(this,"name",Jk),St(this,"keychain"),St(this,"randomSessionIdentifier",tf()),St(this,"initialized",!1),St(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),St(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),St(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=gg(s);return w1(i.publicKey)}),St(this,"generateKeyPair",()=>{this.isInitialized();const s=p8();return this.setPrivateKey(s.publicKey,s.privateKey)}),St(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=gg(i),a=this.randomSessionIdentifier;return await sP(a,s,Xk,o)}),St(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=g8(a,i);return this.setSymKey(c,o)}),St(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||hl(s);return await this.keychain.set(o,s),o}),St(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),St(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),St(this,"encode",async(s,i,o)=>{this.isInitialized();const a=DE(o),c=Zr(i);if(lm(a))return w8(c,o?.encoding);if(cm(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return m8({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o?.encoding})}),St(this,"decode",async(s,i,o)=>{this.isInitialized();const a=E8(i,o);if(lm(a)){const c=b8(i,o?.encoding);return di(c)}if(cm(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=y8({symKey:c,encoded:i,encoding:o?.encoding});return di(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),St(this,"getPayloadType",(s,i=sn)=>{const o=Va({encoded:s,encoding:i});return fi(o.type)}),St(this,"getPayloadSenderPublicKey",(s,i=sn)=>{const o=Va({encoded:s,encoding:i});return o.senderPublicKey?cn(o.senderPublicKey,zt):void 0}),this.core=e,this.logger=jt(n,this.name),this.keychain=r||new e4(this.core,this.logger)}get context(){return hn(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Pm)}catch{e=tf(),await this.keychain.set(Pm,e)}return J$(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var s4=Object.defineProperty,i4=Object.defineProperties,o4=Object.getOwnPropertyDescriptors,Mm=Object.getOwnPropertySymbols,a4=Object.prototype.hasOwnProperty,c4=Object.prototype.propertyIsEnumerable,cf=(t,e,n)=>e in t?s4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,l4=(t,e)=>{for(var n in e||(e={}))a4.call(e,n)&&cf(t,n,e[n]);if(Mm)for(var n of Mm(e))c4.call(e,n)&&cf(t,n,e[n]);return t},u4=(t,e)=>i4(t,o4(e)),pn=(t,e,n)=>cf(t,typeof e!="symbol"?e+"":e,n);class d4 extends n6{constructor(e,n){super(e,n),this.logger=e,this.core=n,pn(this,"messages",new Map),pn(this,"messagesWithoutClientAck",new Map),pn(this,"name",tD),pn(this,"version",nD),pn(this,"initialized",!1),pn(this,"storagePrefix",Sr),pn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),pn(this,"set",async(r,s,i)=>{this.isInitialized();const o=Tn(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===fl.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,u4(l4({},c),{[o]:s}))}return await this.persist(),o}),pn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),pn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),pn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=Tn(s);return typeof i[o]<"u"}),pn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=Tn(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),pn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=jt(e,this.name),this.core=n}get context(){return hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Wh(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Wh(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?zh(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?zh(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var h4=Object.defineProperty,f4=Object.defineProperties,p4=Object.getOwnPropertyDescriptors,Lm=Object.getOwnPropertySymbols,g4=Object.prototype.hasOwnProperty,m4=Object.prototype.propertyIsEnumerable,lf=(t,e,n)=>e in t?h4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ki=(t,e)=>{for(var n in e||(e={}))g4.call(e,n)&&lf(t,n,e[n]);if(Lm)for(var n of Lm(e))m4.call(e,n)&&lf(t,n,e[n]);return t},Bm=(t,e)=>f4(t,p4(e)),An=(t,e,n)=>lf(t,typeof e!="symbol"?e+"":e,n);class y4 extends r6{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,An(this,"events",new jn.EventEmitter),An(this,"name",sD),An(this,"queue",new Map),An(this,"publishTimeout",Y.toMiliseconds(Y.ONE_MINUTE)),An(this,"initialPublishTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),An(this,"needsTransportRestart",!1),An(this,"publish",async(r,s,i)=>{var o,a,c,l,u;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const d=i?.ttl||rD,h=i?.prompt||!1,f=i?.tag||0,p=i?.id||vs().toString(),g=Xi(Hl().protocol),m={id:p,method:i?.publishMethod||g.publish,params:ki({topic:r,message:s,ttl:d,prompt:h,tag:f,attestation:i?.attestation},i?.tvf&&{tvf:i.tvf})},b=`Failed to publish payload, please try again. id:${p} tag:${f}`;try{yt((o=m.params)==null?void 0:o.prompt)&&((a=m.params)==null||delete a.prompt),yt((c=m.params)==null?void 0:c.tag)&&((l=m.params)==null||delete l.tag);const v=new Promise(async C=>{const N=({id:w})=>{var S;((S=m.id)==null?void 0:S.toString())===w.toString()&&(this.removeRequestFromQueue(w),this.relayer.events.removeListener(at.publish,N),C())};this.relayer.events.on(at.publish,N);const y=wr(new Promise((w,S)=>{this.rpcPublish(m,i).then(w).catch(P=>{this.logger.warn(P,P?.message),S(P)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${p} tag:${f}`);try{await y,this.events.removeListener(at.publish,N)}catch(w){this.queue.set(p,{request:m,opts:i,attempt:1}),this.logger.warn(w,w?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,topic:r,message:s,opts:i}}),await wr(v,this.publishTimeout,b)}catch(v){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(v),(u=i?.internal)!=null&&u.throwOnFailedPublish)throw v}finally{this.queue.delete(p)}}),An(this,"publishCustom",async r=>{var s,i,o,a,c;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:r});const{payload:l,opts:u={}}=r,{attestation:d,tvf:h,publishMethod:f,prompt:p,tag:g,ttl:m=Y.FIVE_MINUTES}=u,b=u.id||vs().toString(),v=Xi(Hl().protocol),C=f||v.publish,N={id:b,method:C,params:ki(Bm(ki({},l),{ttl:m,prompt:p,tag:g,attestation:d}),h)},y=`Failed to publish custom payload, please try again. id:${b} tag:${g}`;try{yt((s=N.params)==null?void 0:s.prompt)&&((i=N.params)==null||delete i.prompt),yt((o=N.params)==null?void 0:o.tag)&&((a=N.params)==null||delete a.tag);const w=new Promise(async S=>{const P=({id:x})=>{var R;((R=N.id)==null?void 0:R.toString())===x.toString()&&(this.removeRequestFromQueue(x),this.relayer.events.removeListener(at.publish,P),S())};this.relayer.events.on(at.publish,P);const A=wr(new Promise((x,R)=>{this.rpcPublish(N,u).then(x).catch(O=>{this.logger.warn(O,O?.message),R(O)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${C} id:${b} tag:${g}`);try{await A,this.events.removeListener(at.publish,P)}catch(x){this.queue.set(b,{request:N,opts:u,attempt:1}),this.logger.warn(x,x?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:b,payload:l,opts:u}}),await wr(w,this.publishTimeout,y)}catch(w){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(w),(c=u?.internal)!=null&&c.throwOnFailedPublish)throw w}finally{this.queue.delete(b)}}),An(this,"on",(r,s)=>{this.events.on(r,s)}),An(this,"once",(r,s)=>{this.events.once(r,s)}),An(this,"off",(r,s)=>{this.events.off(r,s)}),An(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=jt(n,this.name),this.registerEventListeners()}get context(){return hn(this.logger)}async rpcPublish(e,n){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});const r=await this.relayer.request(e);return this.relayer.events.emit(at.publish,ki(ki({},e),n)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{var r;const s=e.attempt+1;this.queue.set(n,Bm(ki({},e),{attempt:s})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${(r=e.request.params)==null?void 0:r.tag}, attempt: ${s}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(_i.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(at.connection_stalled);return}this.checkQueue()}),this.relayer.on(at.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var w4=Object.defineProperty,b4=(t,e,n)=>e in t?w4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Di=(t,e,n)=>b4(t,typeof e!="symbol"?e+"":e,n);class E4{constructor(){Di(this,"map",new Map),Di(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),Di(this,"get",e=>this.map.get(e)||[]),Di(this,"exists",(e,n)=>this.get(e).includes(n)),Di(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),Di(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var v4=Object.defineProperty,C4=Object.defineProperties,_4=Object.getOwnPropertyDescriptors,Fm=Object.getOwnPropertySymbols,A4=Object.prototype.hasOwnProperty,I4=Object.prototype.propertyIsEnumerable,uf=(t,e,n)=>e in t?v4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Yo=(t,e)=>{for(var n in e||(e={}))A4.call(e,n)&&uf(t,n,e[n]);if(Fm)for(var n of Fm(e))I4.call(e,n)&&uf(t,n,e[n]);return t},Fd=(t,e)=>C4(t,_4(e)),Ke=(t,e,n)=>uf(t,typeof e!="symbol"?e+"":e,n);class S4 extends o6{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Ke(this,"subscriptions",new Map),Ke(this,"topicMap",new E4),Ke(this,"events",new jn.EventEmitter),Ke(this,"name",dD),Ke(this,"version",hD),Ke(this,"pending",new Map),Ke(this,"cached",[]),Ke(this,"initialized",!1),Ke(this,"storagePrefix",Sr),Ke(this,"subscribeTimeout",Y.toMiliseconds(Y.ONE_MINUTE)),Ke(this,"initialSubscribeTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),Ke(this,"clientId"),Ke(this,"batchSubscribeTopicsLimit",500),Ke(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Ke(this,"subscribe",async(r,s)=>{var i;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const o=Hl(s),a={topic:r,relay:o,transportType:s?.transportType};(i=s?.internal)!=null&&i.skipSubscribe||this.pending.set(r,a);const c=await this.rpcSubscribe(r,o,s);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),c}catch(o){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(o),o}}),Ke(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof s?.id<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),Ke(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),Ke(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),Ke(this,"on",(r,s)=>{this.events.on(r,s)}),Ke(this,"once",(r,s)=>{this.events.once(r,s)}),Ke(this,"off",(r,s)=>{this.events.off(r,s)}),Ke(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),Ke(this,"start",async()=>{await this.onConnect()}),Ke(this,"stop",async()=>{await this.onDisconnect()}),Ke(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Ke(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),Ke(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(_i.pulse,async()=>{await this.checkPending()}),this.events.on(gn.created,async r=>{const s=gn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(gn.deleted,async r=>{const s=gn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=jt(n,this.name),this.clientId=""}get context(){return hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=Hl(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=Qe("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s,i;const o=await this.getSubscriptionId(e);if((s=r?.internal)!=null&&s.skipSubscribe)return o;(!r||r?.transportType===Ze.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const a={method:Xi(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a});const c=(i=r?.internal)==null?void 0:i.throwOnFailedPublish;try{if(r?.transportType===Ze.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(a).catch(d=>this.logger.warn(d))},Y.toMiliseconds(Y.ONE_SECOND)),o;const l=new Promise(async d=>{const h=f=>{f.topic===e&&(this.events.removeListener(gn.created,h),d(f.id))};this.events.on(gn.created,h);try{const f=await wr(new Promise((p,g)=>{this.relayer.request(a).catch(m=>{this.logger.warn(m,m?.message),g(m)}).then(p)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(gn.created,h),d(f)}catch{}}),u=await wr(l,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&c)throw new Error(`Subscribing to ${e} failed, please try again`);return u?o:null}catch(l){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(at.connection_stalled),c)throw l}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:Xi(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await wr(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(at.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:Xi(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await wr(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(at.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:Xi(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,Fd(Yo({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,Yo({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,Yo({},n)),this.topicMap.set(n.topic,e),this.events.emit(gn.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(gn.deleted,Fd(Yo({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(gn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(gn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(n=>{var r;return n.topic===((r=this.subscriptions.get(n.id))==null?void 0:r.topic)})){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>Fd(Yo({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await UR(Y.toMiliseconds(Y.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return Tn(e+await this.getClientId())}}var N4=Object.defineProperty,jm=Object.getOwnPropertySymbols,T4=Object.prototype.hasOwnProperty,P4=Object.prototype.propertyIsEnumerable,df=(t,e,n)=>e in t?N4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hm=(t,e)=>{for(var n in e||(e={}))T4.call(e,n)&&df(t,n,e[n]);if(jm)for(var n of jm(e))P4.call(e,n)&&df(t,n,e[n]);return t},$e=(t,e,n)=>df(t,typeof e!="symbol"?e+"":e,n);class x4 extends s6{constructor(e){super(e),$e(this,"protocol","wc"),$e(this,"version",2),$e(this,"core"),$e(this,"logger"),$e(this,"events",new jn.EventEmitter),$e(this,"provider"),$e(this,"messages"),$e(this,"subscriber"),$e(this,"publisher"),$e(this,"name",oD),$e(this,"transportExplicitlyClosed",!1),$e(this,"initialized",!1),$e(this,"connectionAttemptInProgress",!1),$e(this,"relayUrl"),$e(this,"projectId"),$e(this,"packageName"),$e(this,"bundleId"),$e(this,"hasExperiencedNetworkDisruption",!1),$e(this,"pingTimeout"),$e(this,"heartBeatTimeout",Y.toMiliseconds(Y.THIRTY_SECONDS+Y.FIVE_SECONDS)),$e(this,"reconnectTimeout"),$e(this,"connectPromise"),$e(this,"reconnectInProgress",!1),$e(this,"requestsInFlight",[]),$e(this,"connectTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),$e(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||vs().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),$e(this,"resetPingTimeout",()=>{Ll()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o?.message)}},this.heartBeatTimeout))}),$e(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),$e(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(at.connect)}),$e(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()}),$e(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(at.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),$e(this,"registerProviderListeners",()=>{this.provider.on(_n.payload,this.onPayloadHandler),this.provider.on(_n.connect,this.onConnectHandler),this.provider.on(_n.disconnect,this.onDisconnectHandler),this.provider.on(_n.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?jt(e.logger,this.name):bc(Co({level:e.logger||iD})),this.messages=new d4(this.logger,e.core),this.subscriber=new S4(this,this.logger),this.publisher=new y4(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||zE,ER()?this.packageName=xg():vR()&&(this.bundleId=xg()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return hn(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:Ze.relay},fl.outbound)}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||n?.transportType==="relay")&&await this.toEstablishConnection();const o=typeof((r=n?.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n?.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(gn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(gn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,Hm({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await wr(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.info("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Em())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+s?.message)}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=gt(Y.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(at.message,e),await this.recordMessageEvent(e,fl.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(_n.disconnect,i),await wr(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(_n.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(_n.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(_n.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Y.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(Ll())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Hn(new Kk(SR({sdkVersion:sf,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Tp(e)){if(!e.method.endsWith(aD))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:Ze.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Hm({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else Pu(e)&&this.events.emit(at.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,fl.inbound),this.events.emit(at.message,e))}async acknowledgePayload(e){const n=Ka(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(_n.payload,this.onPayloadHandler),this.provider.off(_n.connect,this.onConnectHandler),this.provider.off(_n.disconnect,this.onDisconnectHandler),this.provider.off(_n.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Em();fk(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(_i.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&mk())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(at.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Y.toMiliseconds(cD)))))}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function R4(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function qm(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Wm(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const O4="[object RegExp]",k4="[object String]",D4="[object Number]",$4="[object Boolean]",zm="[object Arguments]",U4="[object Symbol]",M4="[object Date]",L4="[object Map]",B4="[object Set]",F4="[object Array]",j4="[object Function]",H4="[object ArrayBuffer]",jd="[object Object]",q4="[object Error]",W4="[object DataView]",z4="[object Uint8Array]",V4="[object Uint8ClampedArray]",K4="[object Uint16Array]",G4="[object Uint32Array]",Y4="[object BigUint64Array]",Z4="[object Int8Array]",J4="[object Int16Array]",X4="[object Int32Array]",Q4="[object BigInt64Array]",eU="[object Float32Array]",tU="[object Float64Array]";function nU(){}function Vm(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function rU(t,e,n){return na(t,e,void 0,void 0,void 0,void 0,n)}function na(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return ga(t,e,i,o)}return ga(t,e,i,o)}function ga(t,e,n,r){if(Object.is(t,e))return!0;let s=Wm(t),i=Wm(e);if(s===zm&&(s=jd),i===zm&&(i=jd),s!==i)return!1;switch(s){case k4:return t.toString()===e.toString();case D4:{const c=t.valueOf(),l=e.valueOf();return R4(c,l)}case $4:case M4:case U4:return Object.is(t.valueOf(),e.valueOf());case O4:return t.source===e.source&&t.flags===e.flags;case j4:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case L4:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!na(l,e.get(c),c,t,e,n,r))return!1;return!0}case B4:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(f=>na(d,f,void 0,t,e,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case F4:case z4:case V4:case K4:case G4:case Y4:case Z4:case J4:case X4:case Q4:case eU:case tU:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!na(t[c],e[c],c,t,e,n,r))return!1;return!0}case H4:return t.byteLength!==e.byteLength?!1:ga(new Uint8Array(t),new Uint8Array(e),n,r);case W4:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:ga(new Uint8Array(t),new Uint8Array(e),n,r);case q4:return t.name===e.name&&t.message===e.message;case jd:{if(!(ga(t.constructor,e.constructor,n,r)||Vm(t)&&Vm(e)))return!1;const c=[...Object.keys(t),...qm(t)],l=[...Object.keys(e),...qm(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!na(h,f,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function sU(t,e){return rU(t,e,nU)}var iU=Object.defineProperty,Km=Object.getOwnPropertySymbols,oU=Object.prototype.hasOwnProperty,aU=Object.prototype.propertyIsEnumerable,hf=(t,e,n)=>e in t?iU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gm=(t,e)=>{for(var n in e||(e={}))oU.call(e,n)&&hf(t,n,e[n]);if(Km)for(var n of Km(e))aU.call(e,n)&&hf(t,n,e[n]);return t},Xt=(t,e,n)=>hf(t,typeof e!="symbol"?e+"":e,n);class Ii extends i6{constructor(e,n,r,s=Sr,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,Xt(this,"map",new Map),Xt(this,"version",lD),Xt(this,"cached",[]),Xt(this,"initialized",!1),Xt(this,"getKey"),Xt(this,"storagePrefix",Sr),Xt(this,"recentlyDeleted",[]),Xt(this,"recentlyDeletedLimit",200),Xt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!yt(o)?this.map.set(this.getKey(o),o):W8(o)?this.map.set(o.id,o):z8(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),Xt(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),Xt(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),Xt(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>sU(a[c],o[c]))):this.values)),Xt(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Gm(Gm({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),Xt(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=jt(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=G("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var cU=Object.defineProperty,lU=(t,e,n)=>e in t?cU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ne=(t,e,n)=>lU(t,typeof e!="symbol"?e+"":e,n);class uU{constructor(e,n){this.core=e,this.logger=n,Ne(this,"name",fD),Ne(this,"version",pD),Ne(this,"events",new tp),Ne(this,"pairings"),Ne(this,"initialized",!1),Ne(this,"storagePrefix",Sr),Ne(this,"ignoredPayloadTypes",[Kr]),Ne(this,"registeredMethods",[]),Ne(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Ne(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Ne(this,"create",async r=>{this.isInitialized();const s=tf(),i=await this.core.crypto.setSymKey(s),o=gt(Y.FIVE_MINUTES),a={protocol:WE},c={topic:i,expiry:o,relay:a,active:!1,methods:r?.methods},l=dm({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r?.methods});return this.events.emit(Ws.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r?.transportType,internal:r?.internal}),{topic:i,uri:l}}),Ne(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r?.uri,trace:[ur.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=um(r.uri);s.props.properties.topic=i,s.addTrace(ur.pairing_uri_validation_success),s.addTrace(ur.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(ur.existing_pairing),u.active)throw s.setError(Br.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(ur.pairing_not_expired)}const d=c||gt(Y.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(ur.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(Ws.create,h),s.addTrace(ur.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(ur.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Br.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(Br.subscribe_pairing_topic_failure),f}return s.addTrace(ur.subscribe_pairing_topic_success),h}),Ne(this,"activate",async({topic:r})=>{this.isInitialized();const s=gt(Y.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),Ne(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=Hs();this.events.once(je("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),Ne(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),Ne(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),Ne(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Ne(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",Qe("USER_DISCONNECTED")),await this.deletePairing(s))}),Ne(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return dm({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Ne(this,"sendRequest",async(r,s,i)=>{const o=pr(s,i),a=await this.core.crypto.encode(r,o),c=Vo[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Ne(this,"sendResult",async(r,s,i)=>{const o=Ka(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Vo[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Ne(this,"sendError",async(r,s,i)=>{const o=Tu(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Vo[c]?Vo[c].res:Vo.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Ne(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,Qe("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),Ne(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>hs(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),Ne(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Ne(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Ne(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(Ws.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Ne(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{hr(s)?this.events.emit(je("pairing_ping",i),{}):Pn(s)&&this.events.emit(je("pairing_ping",i),{error:s.error})},500)}),Ne(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(Ws.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Ne(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=Qe("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),Ne(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(Qe("WC_METHOD_UNSUPPORTED",r))}),Ne(this,"isValidPair",(r,s)=>{var i;if(!en(r)){const{message:a}=G("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Br.malformed_pairing_uri),new Error(a)}if(!q8(r.uri)){const{message:a}=G("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Br.malformed_pairing_uri),new Error(a)}const o=um(r?.uri);if(!((i=o?.relay)!=null&&i.protocol)){const{message:a}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Br.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=G("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Br.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Y.toMiliseconds(o?.expiryTimestamp)<Date.now()){s.setError(Br.pairing_expired);const{message:a}=G("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Ne(this,"isValidPing",async r=>{if(!en(r)){const{message:i}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Ne(this,"isValidDisconnect",async r=>{if(!en(r)){const{message:i}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Ne(this,"isValidPairingTopic",async r=>{if(!ht(r,!1)){const{message:s}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(hs(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=G("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=jt(n,this.name),this.pairings=new Ii(this.core,this.logger,this.name,this.storagePrefix)}get context(){return hn(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(at.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==Ze.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);Tp(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):Pu(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Nn.expired,async e=>{const{topic:n}=W1(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(Ws.expire,{topic:n}))})}}var dU=Object.defineProperty,hU=(t,e,n)=>e in t?dU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nt=(t,e,n)=>hU(t,typeof e!="symbol"?e+"":e,n);class fU extends t6{constructor(e,n){super(e,n),this.core=e,this.logger=n,Nt(this,"records",new Map),Nt(this,"events",new jn.EventEmitter),Nt(this,"name",gD),Nt(this,"version",mD),Nt(this,"cached",[]),Nt(this,"initialized",!1),Nt(this,"storagePrefix",Sr),Nt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Nt(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:gt(Y.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(Vn.created,o)}),Nt(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=Pn(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(Vn.updated,s))}),Nt(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Nt(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(Vn.deleted,i)}}),this.persist()}),Nt(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Nt(this,"on",(r,s)=>{this.events.on(r,s)}),Nt(this,"once",(r,s)=>{this.events.once(r,s)}),Nt(this,"off",(r,s)=>{this.events.off(r,s)}),Nt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=jt(n,this.name)}get context(){return hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:pr(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Vn.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(Vn.created,e=>{const n=Vn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Vn.updated,e=>{const n=Vn.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(Vn.deleted,e=>{const n=Vn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(_i.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{Y.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(Vn.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var pU=Object.defineProperty,gU=(t,e,n)=>e in t?pU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lt=(t,e,n)=>gU(t,typeof e!="symbol"?e+"":e,n);class mU extends a6{constructor(e,n){super(e,n),this.core=e,this.logger=n,Lt(this,"expirations",new Map),Lt(this,"events",new jn.EventEmitter),Lt(this,"name",yD),Lt(this,"version",wD),Lt(this,"cached",[]),Lt(this,"initialized",!1),Lt(this,"storagePrefix",Sr),Lt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Lt(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Lt(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Nn.created,{target:i,expiration:o})}),Lt(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),Lt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Nn.deleted,{target:s,expiration:i})}}),Lt(this,"on",(r,s)=>{this.events.on(r,s)}),Lt(this,"once",(r,s)=>{this.events.once(r,s)}),Lt(this,"off",(r,s)=>{this.events.off(r,s)}),Lt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=jt(n,this.name)}get context(){return hn(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return NR(e);if(typeof e=="number")return TR(e);const{message:n}=G("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Nn.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=G("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;Y.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(Nn.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(_i.pulse,()=>this.checkExpirations()),this.events.on(Nn.created,e=>{const n=Nn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Nn.expired,e=>{const n=Nn.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Nn.deleted,e=>{const n=Nn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}}var yU=Object.defineProperty,wU=(t,e,n)=>e in t?yU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ut=(t,e,n)=>wU(t,typeof e!="symbol"?e+"":e,n);class bU extends c6{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,ut(this,"name",bD),ut(this,"abortController"),ut(this,"isDevEnv"),ut(this,"verifyUrlV3",vD),ut(this,"storagePrefix",Sr),ut(this,"version",qE),ut(this,"publicKey"),ut(this,"fetchPromise"),ut(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Y.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ut(this,"register",async s=>{if(!No()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=Jr.getDocument(),u=this.startAbortTimer(Y.ONE_SECOND*5),d=await new Promise((h,f)=>{const p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=b=>{if(b.data&&typeof b.data=="string")try{const v=JSON.parse(b.data);if(v.type==="verify_attestation"){if(Uh(v.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(v.attestation===null?"":v.attestation)}}catch(v){this.logger.warn(v)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),ut(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(Uh(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s?.verifyUrl);return this.fetchAttestation(o,c)}),ut(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Y.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),ut(this,"getVerifyUrl",s=>{let i=s||pa;return CD.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${pa}`),i=pa),i}),ut(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Y.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),ut(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),ut(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ut(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),ut(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ut(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),ut(this,"validateAttestation",(s,i)=>{const o=C8(s,i.publicKey),a={hasExpired:Y.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=jt(n,this.name),this.abortController=new AbortController,this.isDevEnv=fp(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return hn(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Y.toMiliseconds(e))}}var EU=Object.defineProperty,vU=(t,e,n)=>e in t?EU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ym=(t,e,n)=>vU(t,typeof e!="symbol"?e+"":e,n);class CU extends l6{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,Ym(this,"context",_D),Ym(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${AD}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=jt(n,this.context)}}var _U=Object.defineProperty,Zm=Object.getOwnPropertySymbols,AU=Object.prototype.hasOwnProperty,IU=Object.prototype.propertyIsEnumerable,ff=(t,e,n)=>e in t?_U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Zo=(t,e)=>{for(var n in e||(e={}))AU.call(e,n)&&ff(t,n,e[n]);if(Zm)for(var n of Zm(e))IU.call(e,n)&&ff(t,n,e[n]);return t},bt=(t,e,n)=>ff(t,typeof e!="symbol"?e+"":e,n);class SU extends u6{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,bt(this,"context",SD),bt(this,"storagePrefix",Sr),bt(this,"storageVersion",ID),bt(this,"events",new Map),bt(this,"shouldPersist",!1),bt(this,"init",async()=>{if(!fp())try{const s={eventId:Og(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:H1(this.core.relayer.protocol,this.core.relayer.version,sf)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),bt(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=Og(),u=this.core.projectId||"",d=Date.now(),h=Zo({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),bt(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Zo(Zo({},a),this.setMethods(a.eventId))}),bt(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),bt(this,"setEventListeners",()=>{this.core.heartbeat.on(_i.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Y.fromMiliseconds(Date.now())-Y.fromMiliseconds(s.timestamp)>ND&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),bt(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),bt(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),bt(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),bt(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),bt(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Zo(Zo({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),bt(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),bt(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${TD}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${sf}${i}`,{method:"POST",body:JSON.stringify(s)})}),bt(this,"getAppDomain",()=>j1().url),this.logger=jt(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var NU=Object.defineProperty,Jm=Object.getOwnPropertySymbols,TU=Object.prototype.hasOwnProperty,PU=Object.prototype.propertyIsEnumerable,pf=(t,e,n)=>e in t?NU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xm=(t,e)=>{for(var n in e||(e={}))TU.call(e,n)&&pf(t,n,e[n]);if(Jm)for(var n of Jm(e))PU.call(e,n)&&pf(t,n,e[n]);return t},Ge=(t,e,n)=>pf(t,typeof e!="symbol"?e+"":e,n);let xU=class sv extends J5{constructor(e){var n;super(e),Ge(this,"protocol",HE),Ge(this,"version",qE),Ge(this,"name",rf),Ge(this,"relayUrl"),Ge(this,"projectId"),Ge(this,"customStoragePrefix"),Ge(this,"events",new jn.EventEmitter),Ge(this,"logger"),Ge(this,"heartbeat"),Ge(this,"relayer"),Ge(this,"crypto"),Ge(this,"storage"),Ge(this,"history"),Ge(this,"expirer"),Ge(this,"pairing"),Ge(this,"verify"),Ge(this,"echoClient"),Ge(this,"linkModeSupportedApps"),Ge(this,"eventClient"),Ge(this,"initialized",!1),Ge(this,"logChunkController"),Ge(this,"on",(a,c)=>this.events.on(a,c)),Ge(this,"once",(a,c)=>this.events.once(a,c)),Ge(this,"off",(a,c)=>this.events.off(a,c)),Ge(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Ge(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:Ze.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e?.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||zE,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Co({level:typeof e?.logger=="string"&&e.logger?e.logger:Yk.logger,name:rf}),{logger:i,chunkLoggerController:o}=rp({opts:s,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=jt(i,this.name),this.heartbeat=new ZS,this.crypto=new r4(this,this.logger,e?.keychain),this.history=new fU(this,this.logger),this.expirer=new mU(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new O5(Xm(Xm({},Zk),e?.storageOptions)),this.relayer=new x4({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new uU(this,this.logger),this.verify=new bU(this,this.logger,this.storage),this.echoClient=new CU(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new SU(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new sv(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(uD,r),n}get context(){return hn(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(xm,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(xm)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&Gk.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const RU=xU,iv="wc",ov=2,av="client",Pp=`${iv}@${ov}:${av}:`,Hd={name:av,logger:"error"},Qm="WALLETCONNECT_DEEPLINK_CHOICE",OU="proposal",ey="Proposal expired",kU="session",$i=Y.SEVEN_DAYS,DU="engine",Tt={wc_sessionPropose:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Y.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Y.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1119}}},qd={min:Y.FIVE_MINUTES,max:Y.SEVEN_DAYS},lr={idle:"IDLE",active:"ACTIVE"},$U={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},UU="request",MU=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],LU="wc",BU="auth",FU="authKeys",jU="pairingTopics",HU="requests",Ru=`${LU}@${1.5}:${BU}:`,pl=`${Ru}:PUB_KEY`;var qU=Object.defineProperty,WU=Object.defineProperties,zU=Object.getOwnPropertyDescriptors,ty=Object.getOwnPropertySymbols,VU=Object.prototype.hasOwnProperty,KU=Object.prototype.propertyIsEnumerable,gf=(t,e,n)=>e in t?qU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qe=(t,e)=>{for(var n in e||(e={}))VU.call(e,n)&&gf(t,n,e[n]);if(ty)for(var n of ty(e))KU.call(e,n)&&gf(t,n,e[n]);return t},Bt=(t,e)=>WU(t,zU(e)),q=(t,e,n)=>gf(t,typeof e!="symbol"?e+"":e,n);class GU extends p6{constructor(e){super(e),q(this,"name",DU),q(this,"events",new tp),q(this,"initialized",!1),q(this,"requestQueue",{state:lr.idle,queue:[]}),q(this,"sessionRequestQueue",{state:lr.idle,queue:[]}),q(this,"emittedSessionRequests",new MR({limit:500})),q(this,"requestQueueDelay",Y.ONE_SECOND),q(this,"expectedPairingMethodMap",new Map),q(this,"recentlyDeletedMap",new Map),q(this,"recentlyDeletedLimit",200),q(this,"relayMessageCache",[]),q(this,"pendingSessions",new Map),q(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(Tt)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Y.toMiliseconds(this.requestQueueDelay)))}),q(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=Bt(qe({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=L8(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let u=s,d,h=!1;try{if(u){const w=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=w.active}}catch(w){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),w}if(!u||!h){const{topic:w,uri:S}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});u=w,d=S}if(!u){const{message:w}=G("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(w)}const f=await this.client.core.crypto.generateKeyPair(),p=Tt.wc_sessionPropose.req.ttl||Y.FIVE_MINUTES,g=gt(p),m=Bt(qe(qe({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:WE}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:dr()}),b=je("session_connect",m.id),{reject:v,resolve:C,done:N}=Hs(p,ey),y=({id:w})=>{w===m.id&&(this.client.events.off("proposal_expire",y),this.pendingSessions.delete(m.id),this.events.emit(b,{error:{message:ey,code:0}}))};return this.client.events.on("proposal_expire",y),this.events.once(b,({error:w,session:S})=>{this.client.events.off("proposal_expire",y),w?v(w):S&&C(S)}),await this.sendProposeSession({proposal:m,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:m.id}}}),await this.setProposal(m.id,m),{uri:d,approval:N}}),q(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),q(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n?.id)==null?void 0:r.toString(),trace:[ds.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(A){throw o.setError(Ko.no_internet_connection),A}try{await this.isValidProposalId(n?.id)}catch(A){throw this.client.logger.error(`approve() -> proposal.get(${n?.id}) failed`),o.setError(Ko.proposal_not_found),A}try{await this.isValidApprove(n)}catch(A){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(Ko.session_approve_namespace_validation_failure),A}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:b}=f;let v=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});v||(v=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:ds.session_approve_started,properties:{topic:p,trace:[ds.session_approve_started,ds.session_namespaces_validation_success]}}));const C=await this.client.core.crypto.generateKeyPair(),N=g.publicKey,y=await this.client.core.crypto.generateSharedKey(C,N),w=qe(qe(qe({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:C,metadata:this.client.metadata},expiry:gt($i)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),S=Ze.relay;v.addTrace(ds.subscribing_session_topic);try{await this.client.core.relayer.subscribe(y,{transportType:S,internal:{skipSubscribe:!0}})}catch(A){throw v.setError(Ko.subscribe_session_topic_failure),A}v.addTrace(ds.subscribe_session_topic_success);const P=Bt(qe({},w),{topic:y,requiredNamespaces:m,optionalNamespaces:b,pairingTopic:p,acknowledged:!1,self:w.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:C,transportType:Ze.relay});await this.client.session.set(y,P),v.addTrace(ds.store_session);try{await this.sendApproveSession({sessionTopic:y,proposal:f,pairingProposalResponse:{relay:{protocol:c??"irn"},responderPublicKey:C},sessionSettleRequest:w,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:a}}}),v.addTrace(ds.session_approve_publish_success)}catch(A){throw this.client.logger.error(A),this.client.session.delete(y,Qe("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(y),A}return this.client.core.eventClient.deleteEvent({eventId:v.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(y,gt($i)),{topic:y,acknowledged:()=>Promise.resolve(this.client.session.get(y))}}),q(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:Tt.wc_sessionPropose.reject}),await this.deleteProposal(r)}),q(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=Hs(),c=dr(),l=vs().toString(),u=this.client.session.get(r).namespaces;return this.events.once(je("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),q(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=dr(),{done:i,resolve:o,reject:a}=Hs();return this.events.once(je("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,gt($i)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),q(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:r,request:s,topic:i,expiry:o=Tt.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);a?.transportType===Ze.relay&&await this.confirmOnlineStateOrThrow();const c=dr(),l=vs().toString(),{done:u,resolve:d,reject:h}=Hs(o,"Request expired. Please try again.");this.events.once(je("session_request",c),({error:m,result:b})=>{m?h(m):d(b)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:Bt(qe({},s),{expiryTimestamp:gt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>h(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:Bt(qe({},s),{expiryTimestamp:gt(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(b=>h(b)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),m()}),new Promise(async m=>{var b;if(!((b=a.sessionConfig)!=null&&b.disableDeepLink)){const v=await OR(this.client.core.storage,Qm);await PR({id:c,topic:i,wcDeepLink:v})}m()}),u()]).then(m=>m[2])}),q(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===Ze.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);hr(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):Pn(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),q(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=dr(),i=vs().toString(),{done:o,resolve:a,reject:c}=Hs();this.events.once(je("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),q(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=vs().toString(),a=dr();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),q(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:Qe("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=G("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),q(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>j8(r,n)))),q(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),q(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?Ze.link_mode:Ze.relay;o===Ze.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=n,b=[...n.resources||[]],{topic:v,uri:C}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:C}});const N=await this.client.core.crypto.generateKeyPair(),y=hl(N);if(await Promise.all([this.client.auth.authKeys.set(pl,{responseTopic:y,publicKey:N}),this.client.auth.pairingTopics.set(y,{topic:y,pairingTopic:v})]),await this.client.core.relayer.subscribe(y,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${v}`),g.length>0){const{namespace:U}=ni(a[0]);let M=GO(U,"request",g);dl(b)&&(M=ZO(M,b.pop())),b.push(M)}const w=m&&m>Tt.wc_sessionAuthenticate.req.ttl?m:Tt.wc_sessionAuthenticate.req.ttl,S={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:b},requester:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:gt(w)},P={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},A={requiredNamespaces:{},optionalNamespaces:P,relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:gt(Tt.wc_sessionPropose.req.ttl),id:dr()},{done:x,resolve:R,reject:O}=Hs(w,"Request expired"),L=dr(),$=je("session_connect",A.id),I=je("session_request",L),T=async({error:U,session:M})=>{this.events.off(I,k),U?O(U):M&&R({session:M})},k=async U=>{var M,H,z;if(await this.deletePendingAuthRequest(L,{message:"fulfilled",code:0}),U.error){const Ie=Qe("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return U.error.code===Ie.code?void 0:(this.events.off($,T),O(U.error.message))}await this.deleteProposal(A.id),this.events.off($,T);const{cacaos:te,responder:Z}=U.result,ae=[],pe=[];for(const Ie of te){await qg({cacao:Ie,projectId:this.client.core.projectId})||(this.client.logger.error(Ie,"Signature verification failed"),O(Qe("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:it}=Ie,At=dl(it.resources),Ds=[Vh(it.iss)],Pc=Bl(it.iss);if(At){const Ni=Wg(At),Lu=zg(At);ae.push(...Ni),Ds.push(...Lu)}for(const Ni of Ds)pe.push(`${Ni}:${Pc}`)}const Be=await this.client.core.crypto.generateSharedKey(N,Z.publicKey);let Le;ae.length>0&&(Le={topic:Be,acknowledged:!0,self:{publicKey:N,metadata:this.client.metadata},peer:Z,controller:Z.publicKey,expiry:gt($i),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:gm([...new Set(ae)],[...new Set(pe)]),transportType:o},await this.client.core.relayer.subscribe(Be,{transportType:o}),await this.client.session.set(Be,Le),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:Z.metadata}),Le=this.client.session.get(Be)),(M=this.client.metadata.redirect)!=null&&M.linkMode&&(H=Z.metadata.redirect)!=null&&H.linkMode&&(z=Z.metadata.redirect)!=null&&z.universal&&r&&(this.client.core.addLinkModeSupportedApp(Z.metadata.redirect.universal),this.client.session.update(Be,{transportType:Ze.link_mode})),R({auths:te,session:Le})};this.events.once($,T),this.events.once(I,k);let B;try{if(i){const U=pr("wc_sessionAuthenticate",S,L);this.client.core.history.set(v,U);const M=await this.client.core.crypto.encode("",U,{type:Sc,encoding:ys});B=Yc(r,v,M)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:S,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:L}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:A,expiry:Tt.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:A.id})])}catch(U){throw this.events.off($,T),this.events.off(I,k),U}return await this.setProposal(A.id,A),await this.setAuthRequest(L,{request:Bt(qe({},S),{verifyContext:{}}),pairingTopic:v,transportType:o}),{uri:B??C,response:x}}),q(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[Ls.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(Go.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(Go.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||Ze.relay;a===Ze.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=hl(c),d={type:Kr,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(const m of s){if(!await qg({cacao:m,projectId:this.client.core.projectId})){i.setError(Go.invalid_cacao);const y=Qe("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:y,encodeOpts:d}),new Error(y.message)}i.addTrace(Ls.cacaos_verified);const{p:b}=m,v=dl(b.resources),C=[Vh(b.iss)],N=Bl(b.iss);if(v){const y=Wg(v),w=zg(v);h.push(...y),C.push(...w)}for(const y of C)f.push(`${y}:${N}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(Ls.create_authenticated_session_topic);let g;if(h?.length>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:gt($i),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:gm([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(Ls.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(Go.subscribe_authenticated_session_topic_failure),m}i.addTrace(Ls.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(Ls.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(Ls.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(Go.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),q(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===Ze.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=hl(o),l={type:Kr,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:Tt.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),q(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return iE(r,s)}),q(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),q(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),q(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,Qe("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Qm).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,Qe("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=lr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),q(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n);this.client.core.eventClient.getEvent({topic:s.pairingTopic})?.setError(Ko.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,Qe("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),q(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=lr.idle,this.client.events.emit("session_request_expire",{id:n}))}),q(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),q(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),q(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,gt(Tt.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),q(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=Ze.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),q(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||gt(Tt.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),q(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d,publishOpts:h={}}=n,f=pr(s,i,c);let p;const g=!!u;try{const v=g?ys:sn;p=await this.client.core.crypto.encode(r,f,{encoding:v})}catch(v){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),v}let m;if(MU.includes(s)){const v=Tn(JSON.stringify(f)),C=Tn(p);m=await this.client.core.verify.register({id:C,decryptedId:v})}const b=qe(qe({},Tt[s].req),h);if(b.attestation=m,o&&(b.ttl=o),a&&(b.id=a),this.client.core.history.set(r,f),g){const v=Yc(u,r,p);await global.Linking.openURL(v,this.client.name)}else b.tvf=Bt(qe({},d),{correlationId:f.id}),l?(b.internal=Bt(qe({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,p,b)):this.client.core.relayer.publish(r,p,b).catch(v=>this.client.logger.error(v));return f.id}),q(this,"sendProposeSession",async n=>{const{proposal:r,publishOpts:s}=n,i=pr("wc_sessionPropose",r,r.id);this.client.core.history.set(r.pairingTopic,i);const o=await this.client.core.crypto.encode(r.pairingTopic,i,{encoding:sn}),a=Tn(JSON.stringify(i)),c=Tn(o),l=await this.client.core.verify.register({id:c,decryptedId:a});await this.client.core.relayer.publishCustom({payload:{pairingTopic:r.pairingTopic,sessionProposal:o},opts:Bt(qe({},s),{publishMethod:"wc_proposeSession",attestation:l})})}),q(this,"sendApproveSession",async n=>{const{sessionTopic:r,pairingProposalResponse:s,proposal:i,sessionSettleRequest:o,publishOpts:a}=n,c=Ka(i.id,s),l=await this.client.core.crypto.encode(i.pairingTopic,c,{encoding:sn}),u=pr("wc_sessionSettle",o,a?.id),d=await this.client.core.crypto.encode(r,u,{encoding:sn});this.client.core.history.set(r,u),await this.client.core.relayer.publishCustom({payload:{sessionTopic:r,pairingTopic:i.pairingTopic,sessionProposalResponse:l,sessionSettlementRequest:d},opts:Bt(qe({},a),{publishMethod:"wc_approveSession"})})}),q(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=Ka(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?ys:sn;u=await this.client.core.crypto.encode(s,l,Bt(qe({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,f;try{h=await this.client.core.history.get(s,r);const p=h.request;try{f=this.getTVFParams(r,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g?.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(d){const p=Yc(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,g=Tt[p].res;g.tvf=Bt(qe({},f),{correlationId:r}),o?(g.internal=Bt(qe({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),q(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=Tu(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?ys:sn;u=await this.client.core.crypto.encode(s,l,Bt(qe({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),f}if(d){const f=Yc(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,p=a||Tt[f].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),q(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;hs(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{hs(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),q(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),q(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),q(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===lr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=lr.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=lr.idle}),q(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),q(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),q(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=G("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),q(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),q(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l?.setError(Br.proposal_listener_not_found)),this.isValidConnect(qe({},s.params));const u=a.expiryTimestamp||gt(Tt.wc_sessionPropose.req.ttl),d=qe({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:Tn(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l?.addTrace(ur.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:Tt.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),q(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(hr(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(Pn(r)){await this.deleteProposal(i);const o=je("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),q(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===n);if(!f)return this.client.logger.error(`Pending session not found for topic ${n}`);const p=this.client.proposal.get(f.proposalId),g=Bt(qe(qe(qe({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:Ze.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(je("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;hr(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(je("session_approve",s),{})):Pn(r)&&(await this.client.session.delete(n,Qe("USER_DISCONNECTED")),this.events.emit(je("session_approve",s),{error:r.error}))}),q(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=zo.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:Qe("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(qe({topic:n},s));try{zo.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw zo.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),q(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=je("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);hr(r)?this.events.emit(je("session_update",s),{}):Pn(r)&&this.events.emit(je("session_update",s),{error:r.error})}),q(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,gt($i)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=je("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);hr(r)?this.events.emit(je("session_extend",s),{}):Pn(r)&&this.events.emit(je("session_extend",s),{error:r.error})}),q(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=je("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);hr(r)?this.events.emit(je("session_ping",s),{}):Pn(r)&&this.events.emit(je("session_ping",s),{error:r.error})},500)}),q(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),await Promise.all([new Promise(i=>{this.client.core.relayer.once(at.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:Qe("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),q(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(qe({topic:o},h));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:Tn(JSON.stringify(pr("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),u===Ze.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),q(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=je("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);hr(r)?this.events.emit(je("session_request",s),{result:r.result}):Pn(r)&&this.events.emit(je("session_request",s),{error:r.error})}),q(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=zo.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(qe({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),zo.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),hr(r)?this.events.emit(je("session_request",s),{result:r.result}):Pn(r)&&this.events.emit(je("session_request",s),{error:r.error})}),q(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:Tn(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===Ze.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:Kr,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:Tt.wc_sessionAuthenticate.autoReject,appLink:h})}}),q(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),q(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=lr.idle,this.processSessionRequestQueue()},Y.toMiliseconds(this.requestQueueDelay))}),q(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=je("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(je("session_request",i.request.id),{error:r})})}),q(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===lr.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),q(this,"emitSessionRequest",n=>{if(this.emittedSessionRequests.has(n.id)){this.client.logger.warn({id:n.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${n.id}`);return}this.sessionRequestQueue.state=lr.active,this.emittedSessionRequests.add(n.id),this.client.events.emit("session_request",n)}),q(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:pr("wc_sessionPropose",Bt(qe({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),q(this,"isValidConnect",async n=>{if(!en(n)){const{message:l}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(yt(r)||await this.isValidPairingTopic(r),!Q8(c)){const{message:l}=G("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!yt(s)&&Cr(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!yt(i)&&Cr(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),yt(o)||this.validateSessionProps(o,"sessionProperties"),!yt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u.split(":")[0])))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),q(this,"validateNamespaces",(n,r)=>{const s=X8(n,"connect()",r);if(s)throw new Error(s.message)}),q(this,"isValidApprove",async n=>{if(!en(n))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=Ud(s,"approve()");if(l)throw new Error(l.message);const u=wm(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!ht(i,!0)){const{message:d}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(yt(o)||this.validateSessionProps(o,"sessionProperties"),!yt(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h.split(":")[0])))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),q(this,"isValidReject",async n=>{if(!en(n)){const{message:i}=G("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!tk(s)){const{message:i}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),q(this,"isValidSessionSettleRequest",n=>{if(!en(n)){const{message:l}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!UE(r)){const{message:l}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=V8(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=Ud(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(hs(o)){const{message:l}=G("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),q(this,"isValidUpdate",async n=>{if(!en(n)){const{message:c}=G("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=Ud(s,"update()");if(o)throw new Error(o.message);const a=wm(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),q(this,"isValidExtend",async n=>{if(!en(n)){const{message:s}=G("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),q(this,"isValidRequest",async n=>{if(!en(n)){const{message:c}=G("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!ym(a,i)){const{message:c}=G("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!nk(s)){const{message:c}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!ik(a,i,s.method)){const{message:c}=G("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!lk(o,qd)){const{message:c}=G("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${qd.min} and ${qd.max}`);throw new Error(c)}}),q(this,"isValidRespond",async n=>{var r;if(!en(n)){const{message:o}=G("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n?.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!rk(i)){const{message:o}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),q(this,"isValidPing",async n=>{if(!en(n)){const{message:s}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidEmit",async n=>{if(!en(n)){const{message:a}=G("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!ym(o,i)){const{message:a}=G("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!sk(s)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!ok(o,i,s.name)){const{message:a}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),q(this,"isValidDisconnect",async n=>{if(!en(n)){const{message:s}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!ht(s,!1))throw new Error("uri is required parameter");if(!ht(i,!1))throw new Error("domain is required parameter");if(!ht(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>ni(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=ni(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),q(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||pa,validation:"UNKNOWN",origin:o.url||""}};try{if(a===Ze.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),q(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=G("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),q(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),q(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),q(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=G("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),q(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==Ze.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n?.redirect)==null?void 0:u.universal)!==void 0&&((d=n?.redirect)==null?void 0:d.universal)!==""&&((h=n?.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),q(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n?.redirect)==null?void 0:s.universal:void 0}),q(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=Rg(n,"topic")||"",s=decodeURIComponent(Rg(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:Ze.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),q(this,"registerLinkModeListeners",async()=>{var n;if(fp()||ks()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),q(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),q(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=n?.data||((r=n?.[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),q(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=$U[i];if(i==="sui_signTransaction")return[OO(r.transactionBytes)];if(i==="near_signTransaction")return[Bg(r)];if(i==="near_signTransactions")return r.map(c=>Bg(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[Ak({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return Gr(r)?r.map(c=>Fg(c)):[Fg(r)];if(i==="cosmos_signDirect")return[DO(r)];if(typeof r=="string")return[r];const a=r[o.key];if(Gr(a))return i==="solana_signAllTransactions"?a.map(c=>RO(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=G("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(at.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(pl)?this.client.auth.authKeys.get(pl):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===Ze.link_mode?ys:sn});Tp(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:Tn(r)})):Pu(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Nn.expired,async e=>{const{topic:n,id:r}=W1(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,G("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,G("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(Ws.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(Ws.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!ht(e,!1)){const{message:n}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(hs(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=G("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!ht(e,!1)){const{message:n}=G("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(hs(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=G("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=G("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(ht(e,!1)){const{message:n}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!ek(e)){const{message:n}=G("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(hs(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=G("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}}class YU extends Ii{constructor(e,n){super(e,n,OU,Pp),this.core=e,this.logger=n}}let ZU=class extends Ii{constructor(e,n){super(e,n,kU,Pp),this.core=e,this.logger=n}};class JU extends Ii{constructor(e,n){super(e,n,UU,Pp,r=>r.id),this.core=e,this.logger=n}}class XU extends Ii{constructor(e,n){super(e,n,FU,Ru,()=>pl),this.core=e,this.logger=n}}class QU extends Ii{constructor(e,n){super(e,n,jU,Ru),this.core=e,this.logger=n}}class e9 extends Ii{constructor(e,n){super(e,n,HU,Ru,r=>r.id),this.core=e,this.logger=n}}var t9=Object.defineProperty,n9=(t,e,n)=>e in t?t9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wd=(t,e,n)=>n9(t,typeof e!="symbol"?e+"":e,n);class r9{constructor(e,n){this.core=e,this.logger=n,Wd(this,"authKeys"),Wd(this,"pairingTopics"),Wd(this,"requests"),this.authKeys=new XU(this.core,this.logger),this.pairingTopics=new QU(this.core,this.logger),this.requests=new e9(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var s9=Object.defineProperty,i9=(t,e,n)=>e in t?s9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Te=(t,e,n)=>i9(t,typeof e!="symbol"?e+"":e,n);let o9=class cv extends f6{constructor(e){super(e),Te(this,"protocol",iv),Te(this,"version",ov),Te(this,"name",Hd.name),Te(this,"metadata"),Te(this,"core"),Te(this,"logger"),Te(this,"events",new jn.EventEmitter),Te(this,"engine"),Te(this,"session"),Te(this,"proposal"),Te(this,"pendingRequest"),Te(this,"auth"),Te(this,"signConfig"),Te(this,"on",(r,s)=>this.events.on(r,s)),Te(this,"once",(r,s)=>this.events.once(r,s)),Te(this,"off",(r,s)=>this.events.off(r,s)),Te(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Te(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Te(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Te(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Te(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Te(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=e?.name||Hd.name,this.metadata=_R(e?.metadata),this.signConfig=e?.signConfig;const n=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:bc(Co({level:e?.logger||Hd.logger}));this.core=e?.core||new RU(e),this.logger=jt(n,this.name),this.session=new ZU(this.core,this.logger),this.proposal=new YU(this.core,this.logger),this.pendingRequest=new JU(this.core,this.logger),this.engine=new GU(this),this.auth=new r9(this.core,this.logger)}static async init(e){const n=new cv(e);return await n.initialize(),n}get context(){return hn(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Zc={exports:{}},ny;function a9(){return ny||(ny=1,(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof fr<"u"&&fr,r=(function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i})();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof fr<"u"&&fr||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&(function(){try{return new Blob,!0}catch{return!1}})(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(I){return I&&DataView.prototype.isPrototypeOf(I)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(I){return I&&u.indexOf(Object.prototype.toString.call(I))>-1};function h(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(I)||I==="")throw new TypeError('Invalid character in header field name: "'+I+'"');return I.toLowerCase()}function f(I){return typeof I!="string"&&(I=String(I)),I}function p(I){var T={next:function(){var k=I.shift();return{done:k===void 0,value:k}}};return c.iterable&&(T[Symbol.iterator]=function(){return T}),T}function g(I){this.map={},I instanceof g?I.forEach(function(T,k){this.append(k,T)},this):Array.isArray(I)?I.forEach(function(T){if(T.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+T.length);this.append(T[0],T[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(T){this.append(T,I[T])},this)}g.prototype.append=function(I,T){I=h(I),T=f(T);var k=this.map[I];this.map[I]=k?k+", "+T:T},g.prototype.delete=function(I){delete this.map[h(I)]},g.prototype.get=function(I){return I=h(I),this.has(I)?this.map[I]:null},g.prototype.has=function(I){return this.map.hasOwnProperty(h(I))},g.prototype.set=function(I,T){this.map[h(I)]=f(T)},g.prototype.forEach=function(I,T){for(var k in this.map)this.map.hasOwnProperty(k)&&I.call(T,this.map[k],k,this)},g.prototype.keys=function(){var I=[];return this.forEach(function(T,k){I.push(k)}),p(I)},g.prototype.values=function(){var I=[];return this.forEach(function(T){I.push(T)}),p(I)},g.prototype.entries=function(){var I=[];return this.forEach(function(T,k){I.push([k,T])}),p(I)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(I){if(!I._noBody){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}}function b(I){return new Promise(function(T,k){I.onload=function(){T(I.result)},I.onerror=function(){k(I.error)}})}function v(I){var T=new FileReader,k=b(T);return T.readAsArrayBuffer(I),k}function C(I){var T=new FileReader,k=b(T),B=/charset=([A-Za-z0-9_-]+)/.exec(I.type),U=B?B[1]:"utf-8";return T.readAsText(I,U),k}function N(I){for(var T=new Uint8Array(I),k=new Array(T.length),B=0;B<T.length;B++)k[B]=String.fromCharCode(T[B]);return k.join("")}function y(I){if(I.slice)return I.slice(0);var T=new Uint8Array(I.byteLength);return T.set(new Uint8Array(I)),T.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(I){this.bodyUsed=this.bodyUsed,this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:c.blob&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:c.formData&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():c.arrayBuffer&&c.blob&&l(I)?(this._bodyArrayBuffer=y(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(I)||d(I))?this._bodyArrayBuffer=y(I):this._bodyText=I=Object.prototype.toString.call(I):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var I=m(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var I=m(this);return I||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(v);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var I=m(this);if(I)return I;if(this._bodyBlob)return C(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(N(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(x)}),this.json=function(){return this.text().then(JSON.parse)},this}var S=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function P(I){var T=I.toUpperCase();return S.indexOf(T)>-1?T:I}function A(I,T){if(!(this instanceof A))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');T=T||{};var k=T.body;if(I instanceof A){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,T.headers||(this.headers=new g(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,!k&&I._bodyInit!=null&&(k=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=T.credentials||this.credentials||"same-origin",(T.headers||!this.headers)&&(this.headers=new g(T.headers)),this.method=P(T.method||this.method||"GET"),this.mode=T.mode||this.mode||null,this.signal=T.signal||this.signal||(function(){if("AbortController"in a){var M=new AbortController;return M.signal}})(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&k)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(k),(this.method==="GET"||this.method==="HEAD")&&(T.cache==="no-store"||T.cache==="no-cache")){var B=/([?&])_=[^&]*/;if(B.test(this.url))this.url=this.url.replace(B,"$1_="+new Date().getTime());else{var U=/\?/;this.url+=(U.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}A.prototype.clone=function(){return new A(this,{body:this._bodyInit})};function x(I){var T=new FormData;return I.trim().split("&").forEach(function(k){if(k){var B=k.split("="),U=B.shift().replace(/\+/g," "),M=B.join("=").replace(/\+/g," ");T.append(decodeURIComponent(U),decodeURIComponent(M))}}),T}function R(I){var T=new g,k=I.replace(/\r?\n[\t ]+/g," ");return k.split("\r").map(function(B){return B.indexOf(`
`)===0?B.substr(1,B.length):B}).forEach(function(B){var U=B.split(":"),M=U.shift().trim();if(M){var H=U.join(":").trim();try{T.append(M,H)}catch(z){console.warn("Response "+z.message)}}}),T}w.call(A.prototype);function O(I,T){if(!(this instanceof O))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(T||(T={}),this.type="default",this.status=T.status===void 0?200:T.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=T.statusText===void 0?"":""+T.statusText,this.headers=new g(T.headers),this.url=T.url||"",this._initBody(I)}w.call(O.prototype),O.prototype.clone=function(){return new O(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},O.error=function(){var I=new O(null,{status:200,statusText:""});return I.ok=!1,I.status=0,I.type="error",I};var L=[301,302,303,307,308];O.redirect=function(I,T){if(L.indexOf(T)===-1)throw new RangeError("Invalid status code");return new O(null,{status:T,headers:{location:I}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(T,k){this.message=T,this.name=k;var B=Error(T);this.stack=B.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function $(I,T){return new Promise(function(k,B){var U=new A(I,T);if(U.signal&&U.signal.aborted)return B(new o.DOMException("Aborted","AbortError"));var M=new XMLHttpRequest;function H(){M.abort()}M.onload=function(){var Z={statusText:M.statusText,headers:R(M.getAllResponseHeaders()||"")};U.url.indexOf("file://")===0&&(M.status<200||M.status>599)?Z.status=200:Z.status=M.status,Z.url="responseURL"in M?M.responseURL:Z.headers.get("X-Request-URL");var ae="response"in M?M.response:M.responseText;setTimeout(function(){k(new O(ae,Z))},0)},M.onerror=function(){setTimeout(function(){B(new TypeError("Network request failed"))},0)},M.ontimeout=function(){setTimeout(function(){B(new TypeError("Network request timed out"))},0)},M.onabort=function(){setTimeout(function(){B(new o.DOMException("Aborted","AbortError"))},0)};function z(Z){try{return Z===""&&a.location.href?a.location.href:Z}catch{return Z}}if(M.open(U.method,z(U.url),!0),U.credentials==="include"?M.withCredentials=!0:U.credentials==="omit"&&(M.withCredentials=!1),"responseType"in M&&(c.blob?M.responseType="blob":c.arrayBuffer&&(M.responseType="arraybuffer")),T&&typeof T.headers=="object"&&!(T.headers instanceof g||a.Headers&&T.headers instanceof a.Headers)){var te=[];Object.getOwnPropertyNames(T.headers).forEach(function(Z){te.push(h(Z)),M.setRequestHeader(Z,f(T.headers[Z]))}),U.headers.forEach(function(Z,ae){te.indexOf(ae)===-1&&M.setRequestHeader(ae,Z)})}else U.headers.forEach(function(Z,ae){M.setRequestHeader(ae,Z)});U.signal&&(U.signal.addEventListener("abort",H),M.onreadystatechange=function(){M.readyState===4&&U.signal.removeEventListener("abort",H)}),M.send(typeof U._bodyInit>"u"?null:U._bodyInit)})}return $.polyfill=!0,a.fetch||(a.fetch=$,a.Headers=g,a.Request=A,a.Response=O),o.Headers=g,o.Request=A,o.Response=O,o.fetch=$,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(Zc,Zc.exports)),Zc.exports}var c9=a9();const ry=Pf(c9);var l9=Object.defineProperty,u9=Object.defineProperties,d9=Object.getOwnPropertyDescriptors,sy=Object.getOwnPropertySymbols,h9=Object.prototype.hasOwnProperty,f9=Object.prototype.propertyIsEnumerable,iy=(t,e,n)=>e in t?l9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,oy=(t,e)=>{for(var n in e||(e={}))h9.call(e,n)&&iy(t,n,e[n]);if(sy)for(var n of sy(e))f9.call(e,n)&&iy(t,n,e[n]);return t},ay=(t,e)=>u9(t,d9(e));const p9={Accept:"application/json","Content-Type":"application/json"},g9="POST",cy={headers:p9,method:g9},ly=10;let ir=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new jn.EventEmitter,this.isAvailable=!1,this.registering=!1,!Im(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=Zr(e),r=await(await ry(this.url,ay(oy({},cy),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!Im(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=Zr({id:1,jsonrpc:"2.0",method:"test",params:[]});await ry(e,ay(oy({},cy),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?di(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Tu(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return BE(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>ly&&this.events.setMaxListeners(ly)}};const uy="error",m9="wss://relay.walletconnect.org",y9="wc",w9="universal_provider",Jc=`${y9}@2:${w9}:`,lv="https://rpc.walletconnect.org/v1/",uv="generic",b9=`${lv}bundler`,qn={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function xp(t){return t==null||typeof t!="object"&&typeof t!="function"}function dv(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function hv(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const E9="[object RegExp]",fv="[object String]",pv="[object Number]",gv="[object Boolean]",mv="[object Arguments]",v9="[object Symbol]",C9="[object Date]",_9="[object Map]",A9="[object Set]",I9="[object Array]",S9="[object ArrayBuffer]",N9="[object Object]",T9="[object DataView]",P9="[object Uint8Array]",x9="[object Uint8ClampedArray]",R9="[object Uint16Array]",O9="[object Uint32Array]",k9="[object Int8Array]",D9="[object Int16Array]",$9="[object Int32Array]",U9="[object Float32Array]",M9="[object Float64Array]";function Rp(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function L9(t,e){return eo(t,void 0,t,new Map,e)}function eo(t,e,n,r=new Map,s=void 0){const i=s?.(t,e,n,r);if(i!=null)return i;if(xp(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=eo(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,eo(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(eo(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Rp(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=eo(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),zs(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),zs(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),zs(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,zs(o,t,n,r,s),o}if(typeof t=="object"&&B9(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),zs(o,t,n,r,s),o}return t}function zs(t,e,n=t,r,s){const i=[...Object.keys(e),...dv(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=eo(e[a],a,n,r,s))}}function B9(t){switch(hv(t)){case mv:case I9:case S9:case T9:case gv:case C9:case U9:case M9:case k9:case D9:case $9:case _9:case pv:case N9:case E9:case A9:case fv:case v9:case P9:case x9:case R9:case O9:return!0;default:return!1}}function F9(t,e){return L9(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case pv:case fv:case gv:{const o=new t.constructor(t?.valueOf());return zs(o,t),o}case mv:{const o={};return zs(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function dy(t){return F9(t)}function hy(t){return t!==null&&typeof t=="object"&&hv(t)==="[object Arguments]"}function fy(t){return typeof t=="object"&&t!==null}function j9(){}function H9(t){return Rp(t)}function q9(t){if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const n=t[Symbol.toStringTag];return n==null||!Object.getOwnPropertyDescriptor(t,Symbol.toStringTag)?.writable?!1:t.toString()===`[object ${n}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function W9(t){if(xp(t))return t;if(Array.isArray(t)||Rp(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function z9(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=mf(s,o,r,new Map)}return s}function mf(t,e,n,r){if(xp(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return W9(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...dv(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(hy(a)&&(a={...a}),hy(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=dy(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];u[f]=c[f]}c=u}else c=[];const l=n(c,a,o,t,e,r);l!=null?t[o]=l:Array.isArray(a)||fy(c)&&fy(a)?t[o]=mf(c,a,n,r):c==null&&q9(a)?t[o]=mf({},a,n,r):c==null&&H9(a)?t[o]=dy(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function V9(t,...e){return z9(t,...e,j9)}var K9=Object.defineProperty,G9=Object.defineProperties,Y9=Object.getOwnPropertyDescriptors,py=Object.getOwnPropertySymbols,Z9=Object.prototype.hasOwnProperty,J9=Object.prototype.propertyIsEnumerable,gy=(t,e,n)=>e in t?K9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Xc=(t,e)=>{for(var n in e||(e={}))Z9.call(e,n)&&gy(t,n,e[n]);if(py)for(var n of py(e))J9.call(e,n)&&gy(t,n,e[n]);return t},X9=(t,e)=>G9(t,Y9(e));function En(t,e,n){var r;const s=ni(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${lv}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function Si(t){return t.includes(":")?t.split(":")[1]:t}function yv(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function Q9(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function my(t){return Object.fromEntries(Object.entries(t).filter(([e,n])=>{var r,s;return((r=n?.chains)==null?void 0:r.length)&&((s=n?.chains)==null?void 0:s.length)>0}))}function Qc(t={},e={}){const n=my(yy(t)),r=my(yy(e));return V9(n,r)}function yy(t){var e,n,r,s,i;const o={};if(!Cr(t))return o;for(const[a,c]of Object.entries(t)){const l=Nu(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=Qi(a);o[f]=X9(Xc(Xc({},o[f]),c),{chains:vr(l,(e=o[f])==null?void 0:e.chains),methods:vr(u,(n=o[f])==null?void 0:n.methods),events:vr(d,(r=o[f])==null?void 0:r.events)}),(Cr(h)||Cr(((s=o[f])==null?void 0:s.rpcMap)||{}))&&(o[f].rpcMap=Xc(Xc({},h),(i=o[f])==null?void 0:i.rpcMap))}return o}function wy(t){return t.includes(":")?t.split(":")[2]:t}function by(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=Nu(n)?[n]:r.chains?r.chains:yv(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function zd(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const wv={},Me=t=>wv[t],Vd=(t,e)=>{wv[t]=e};var eM=Object.defineProperty,Ey=Object.getOwnPropertySymbols,tM=Object.prototype.hasOwnProperty,nM=Object.prototype.propertyIsEnumerable,vy=(t,e,n)=>e in t?eM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cy=(t,e)=>{for(var n in e||(e={}))tM.call(e,n)&&vy(t,n,e[n]);if(Ey)for(var n of Ey(e))nM.call(e,n)&&vy(t,n,e[n]);return t};const _y="eip155",rM=["atomic","flow-control","paymasterService","sessionKeys","auxiliaryFunds"],sM=t=>t&&t.startsWith("0x")?BigInt(t).toString(10):t,Kd=t=>t&&t.startsWith("0x")?t:`0x${BigInt(t).toString(16)}`,Ay=t=>Object.keys(t).filter(e=>rM.includes(e)).reduce((e,n)=>(e[n]=t[n],e),{}),iM=(t,e,n)=>{const{sessionProperties:r={},scopedProperties:s={}}=t,i={};if(!Cr(s)&&!Cr(r))return;const o=Ay(r);for(const a of n){const c=sM(a);if(!c)continue;i[Kd(c)]=o;const l=s?.[`${_y}:${c}`];if(l){const u=l?.[`${_y}:${c}:${e}`];i[Kd(c)]=Cy(Cy({},i[Kd(c)]),Ay(u||l))}}for(const[a,c]of Object.entries(i))Object.keys(c).length===0&&delete i[a];return Object.keys(i).length>0?i:void 0};var oM=Object.defineProperty,aM=(t,e,n)=>e in t?oM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ui=(t,e,n)=>aM(t,typeof e!="symbol"?e+"":e,n);class cM{constructor(e){Ui(this,"name","polkadot"),Ui(this,"client"),Ui(this,"httpProviders"),Ui(this,"events"),Ui(this,"namespace"),Ui(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Si(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var lM=Object.defineProperty,uM=Object.defineProperties,dM=Object.getOwnPropertyDescriptors,Iy=Object.getOwnPropertySymbols,hM=Object.prototype.hasOwnProperty,fM=Object.prototype.propertyIsEnumerable,yf=(t,e,n)=>e in t?lM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Sy=(t,e)=>{for(var n in e||(e={}))hM.call(e,n)&&yf(t,n,e[n]);if(Iy)for(var n of Iy(e))fM.call(e,n)&&yf(t,n,e[n]);return t},Ny=(t,e)=>uM(t,dM(e)),Mi=(t,e,n)=>yf(t,typeof e!="symbol"?e+"":e,n);class pM{constructor(e){Mi(this,"name","eip155"),Mi(this,"client"),Mi(this,"chainId"),Mi(this,"namespace"),Mi(this,"httpProviders"),Mi(this,"events"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n),this.chainId=parseInt(e),this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||En(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(Si(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const l=this.client.session.get(e.topic),u=((o=l?.sessionProperties)==null?void 0:o.capabilities)||{},d=`${a}${c.join(",")}`,h=u?.[d];if(h)return h;let f;try{f=iM(l,a,c)}catch(g){console.warn("Failed to extract capabilities from session",g)}if(f)return f;const p=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:Ny(Sy({},l.sessionProperties||{}),{capabilities:Ny(Sy({},u||{}),{[d]:p})})})}catch(g){console.warn("Failed to update session with capabilities",g)}return p}async getCallStatus(e){var n,r;const s=this.client.session.get(e.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pr("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${b9}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}}var gM=Object.defineProperty,mM=(t,e,n)=>e in t?gM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Li=(t,e,n)=>mM(t,typeof e!="symbol"?e+"":e,n);class yM{constructor(e){Li(this,"name","solana"),Li(this,"client"),Li(this,"httpProviders"),Li(this,"events"),Li(this,"namespace"),Li(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Si(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var wM=Object.defineProperty,bM=(t,e,n)=>e in t?wM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Bi=(t,e,n)=>bM(t,typeof e!="symbol"?e+"":e,n);class EM{constructor(e){Bi(this,"name","cosmos"),Bi(this,"client"),Bi(this,"httpProviders"),Bi(this,"events"),Bi(this,"namespace"),Bi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Si(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var vM=Object.defineProperty,CM=(t,e,n)=>e in t?vM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fi=(t,e,n)=>CM(t,typeof e!="symbol"?e+"":e,n);class _M{constructor(e){Fi(this,"name","algorand"),Fi(this,"client"),Fi(this,"httpProviders"),Fi(this,"events"),Fi(this,"namespace"),Fi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(!this.httpProviders[e]){const r=n||En(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Hn(new ir(r,Me("disableProviderPing")))}}var AM=Object.defineProperty,IM=(t,e,n)=>e in t?AM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ji=(t,e,n)=>IM(t,typeof e!="symbol"?e+"":e,n);class SM{constructor(e){ji(this,"name","cip34"),ji(this,"client"),ji(this,"httpProviders"),ji(this,"events"),ji(this,"namespace"),ji(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=Si(n);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}getCardanoRPCUrl(e){const n=this.namespace.rpcMap;if(n)return n[e]}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var NM=Object.defineProperty,TM=(t,e,n)=>e in t?NM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hi=(t,e,n)=>TM(t,typeof e!="symbol"?e+"":e,n);class PM{constructor(e){Hi(this,"name","elrond"),Hi(this,"client"),Hi(this,"httpProviders"),Hi(this,"events"),Hi(this,"namespace"),Hi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Si(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var xM=Object.defineProperty,RM=(t,e,n)=>e in t?xM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qi=(t,e,n)=>RM(t,typeof e!="symbol"?e+"":e,n);class OM{constructor(e){qi(this,"name","multiversx"),qi(this,"client"),qi(this,"httpProviders"),qi(this,"events"),qi(this,"namespace"),qi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Si(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var kM=Object.defineProperty,DM=(t,e,n)=>e in t?kM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wi=(t,e,n)=>DM(t,typeof e!="symbol"?e+"":e,n);class $M{constructor(e){Wi(this,"name","near"),Wi(this,"client"),Wi(this,"httpProviders"),Wi(this,"events"),Wi(this,"namespace"),Wi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||En(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace);return typeof r>"u"?void 0:new Hn(new ir(r,Me("disableProviderPing")))}}var UM=Object.defineProperty,MM=(t,e,n)=>e in t?UM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zi=(t,e,n)=>MM(t,typeof e!="symbol"?e+"":e,n);class LM{constructor(e){zi(this,"name","tezos"),zi(this,"client"),zi(this,"httpProviders"),zi(this,"events"),zi(this,"namespace"),zi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||En(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{e[n]=this.createHttpProvider(n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace);return typeof r>"u"?void 0:new Hn(new ir(r))}}var BM=Object.defineProperty,FM=(t,e,n)=>e in t?BM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Vi=(t,e,n)=>FM(t,typeof e!="symbol"?e+"":e,n);class jM{constructor(e){Vi(this,"name",uv),Vi(this,"client"),Vi(this,"httpProviders"),Vi(this,"events"),Vi(this,"namespace"),Vi(this,"chainId"),this.namespace=e.namespace,this.events=Me("events"),this.client=Me("client"),this.chainId=this.getDefaultChain(),this.name=this.getNamespaceName(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(qn.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getNamespaceName(){const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return ni(e).namespace}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{const i=ni(s);r[i.reference]=this.createHttpProvider(s)}),r}getHttpProvider(e){const n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||En(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Hn(new ir(r,Me("disableProviderPing")))}}var HM=Object.defineProperty,qM=Object.defineProperties,WM=Object.getOwnPropertyDescriptors,Ty=Object.getOwnPropertySymbols,zM=Object.prototype.hasOwnProperty,VM=Object.prototype.propertyIsEnumerable,wf=(t,e,n)=>e in t?HM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,el=(t,e)=>{for(var n in e||(e={}))zM.call(e,n)&&wf(t,n,e[n]);if(Ty)for(var n of Ty(e))VM.call(e,n)&&wf(t,n,e[n]);return t},Gd=(t,e)=>qM(t,WM(e)),In=(t,e,n)=>wf(t,typeof e!="symbol"?e+"":e,n);let KM=class bv{constructor(e){In(this,"client"),In(this,"namespaces"),In(this,"optionalNamespaces"),In(this,"sessionProperties"),In(this,"scopedProperties"),In(this,"events",new tp),In(this,"rpcProviders",{}),In(this,"session"),In(this,"providerOpts"),In(this,"logger"),In(this,"uri"),In(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:bc(Co({level:e?.logger||uy})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){const n=new bv(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:el({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,Ka(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:Qe("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=by(this.session.namespaces);this.namespaces=Qc(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){const{uri:n,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=by(s.namespaces);return this.namespaces=Qc(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e);this.getProvider(r).setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){try{this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(!Gr(n))return;for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}catch(n){this.logger.warn("Failed to cleanup pending pairings",n)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await o9.init({core:this.providerOpts.core,logger:this.providerOpts.logger||uy,relayUrl:this.providerOpts.relayUrl||m9,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>Qi(n)))];Vd("client",this.client),Vd("events",this.events),Vd("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=Q9(n,this.session);if(r?.length===0)return;const s=yv(r),i=Qc(this.namespaces,this.optionalNamespaces),o=Gd(el({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new pM({namespace:o});break;case"algorand":this.rpcProviders[n]=new _M({namespace:o});break;case"solana":this.rpcProviders[n]=new yM({namespace:o});break;case"cosmos":this.rpcProviders[n]=new EM({namespace:o});break;case"polkadot":this.rpcProviders[n]=new cM({namespace:o});break;case"cip34":this.rpcProviders[n]=new SM({namespace:o});break;case"elrond":this.rpcProviders[n]=new PM({namespace:o});break;case"multiversx":this.rpcProviders[n]=new OM({namespace:o});break;case"near":this.rpcProviders[n]=new $M({namespace:o});break;case"tezos":this.rpcProviders[n]=new LM({namespace:o});break;default:this.rpcProviders[n]=new jM({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&Gr(o)&&this.events.emit("accountsChanged",o.map(wy))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Qi(o),l=zd(o)!==zd(a)?`${c}:${zd(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Gd(el({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Gd(el({},Qe("USER_DISCONNECTED")),{data:e.topic})))}),this.on(qn.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[uv]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=Qc(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Qi(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Qi(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s);const i=this.getProvider(r).getDefaultChain();n?(this.events.emit("chainChanged",s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e})):this.getProvider(r).setDefaultChain(s),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(wy);if(!Gr(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Jc}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${Jc}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${Jc}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(Jc)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}},Bs=null;const On={getSIWX(){return F.state.siwx},async initializeIfEnabled(t=_.getActiveCaipAddress()){const e=F.state.siwx;if(!(e&&t))return;const[n,r,s]=t.split(":");if(_.checkIfSupportedNetwork(n,`${n}:${r}`))try{if(F.state.remoteFeatures?.emailCapture){const o=_.getAccountData(n)?.user;await _e.open({view:"DataCapture",data:{email:o?.email??void 0}});return}if(Bs&&await Bs,(await e.getSessions(`${n}:${r}`,s)).length)return;await _e.open({view:"SIWXSignMessage"})}catch(i){console.error("SIWXUtil:initializeIfEnabled",i),Se.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(i)}),await X._getClient()?.disconnect().catch(console.error),he.reset("Connect"),yr.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=F.state.siwx,e=ee.getPlainAddress(_.getActiveCaipAddress()),n=zr(),r=X._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),i=s.toString();K.getConnectorId(n.chainNamespace)===D.CONNECTOR_ID.AUTH&&he.pushTransactionStack({});const a=await r.signMessage(i);await t.addSession({data:s,message:i,signature:a}),_.setLastConnectedSIWECaipNetwork(n),_e.close(),Se.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){(!_e.state.open||he.state.view==="ApproveTransaction")&&await _e.open({view:"SIWXSignMessage"}),yr.showError("Error signing message"),Se.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties(s)}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){try{const t=this.getSIWX();if(t?.getRequired?.()){const n=_.getLastConnectedSIWECaipNetwork();if(n){const r=await t?.getSessions(n?.caipNetworkId,ee.getPlainAddress(_.getActiveCaipAddress())||"");r&&r.length>0?await _.switchActiveNetwork(n):await X.disconnect()}else await X.disconnect()}else _e.close();_e.close(),Se.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(t){console.error("SIWXUtil:cancelSignMessage",t)}},async getAllSessions(){const t=this.getSIWX(),e=_.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await t?.getSessions(r.caipNetworkId,ee.getPlainAddress(_.getActiveCaipAddress())||"");s&&n.push(...s)})),n},async getSessions(t){const e=F.state.siwx;let n=t?.address;if(!n){const s=_.getActiveCaipAddress();n=ee.getPlainAddress(s)}let r=t?.caipNetworkId;return r||(r=_.getActiveCaipNetwork()?.caipNetworkId),e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){const t=this.getSIWX();if(t){const e=he.state.view==="ApproveTransaction",n=he.state.view==="SIWXSignMessage";if(e||n)return t.getRequired?.()&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){const i=On.getSIWX(),o=zr();if(!i||!s.includes(D.CHAIN.EVM)||F.state.remoteFeatures?.emailCapture){const d=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:d.address,chainId:d.chainId,accounts:d.accounts}}const a=`${s}:${e}`,c=await i.createMessage({chainId:a,accountAddress:"<<AccountAddress>>"}),l={accountAddress:c.accountAddress,chainId:c.chainId,domain:c.domain,uri:c.uri,version:c.version,nonce:c.nonce,notBefore:c.notBefore,statement:c.statement,resources:c.resources,requestId:c.requestId,issuedAt:c.issuedAt,expirationTime:c.expirationTime,serializedMessage:c.toString()},u=await t.connect({chainId:e,socialUri:n,siwxMessage:l,preferredAccountType:r});return l.accountAddress=u.address,l.serializedMessage=u.message||"",u.signature&&u.message&&await On.addEmbeddedWalletSession(l,u.message,u.signature),_.setLastConnectedSIWECaipNetwork(o),{address:u.address,chainId:u.chainId,accounts:u.accounts}},async addEmbeddedWalletSession(t,e,n){if(Bs)return Bs;const r=On.getSIWX();return r?(Bs=r.addSession({data:t,message:e,signature:n}).finally(()=>{Bs=null}),Bs):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){const r=On.getSIWX(),s=zr(),i=new Set(e.map(l=>l.split(":")[0]));if(!r||i.size!==1||!i.has("eip155"))return!1;const o=await r.createMessage({chainId:zr()?.caipNetworkId||"",accountAddress:""}),a=await t.authenticate({nonce:o.nonce,domain:o.domain,uri:o.uri,exp:o.expirationTime,iat:o.issuedAt,nbf:o.notBefore,requestId:o.requestId,version:o.version,resources:o.resources,statement:o.statement,chainId:o.chainId,methods:n,chains:[o.chainId,...e.filter(l=>l!==o.chainId)]});yr.showLoading("Authenticating...",{autoClose:!1});const c={...a.session.peer.metadata,name:a.session.peer.metadata.name,icon:a.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"};if(_.setAccountProp("connectedWalletInfo",c,Array.from(i)[0]),a?.auths?.length){const l=a.auths.map(u=>{const d=t.client.formatAuthMessage({request:u.p,iss:u.p.iss});return{data:{...u.p,accountAddress:u.p.iss.split(":").slice(-1).join(""),chainId:u.p.iss.split(":").slice(2,4).join(":"),uri:u.p.aud,version:u.p.version||o.version,expirationTime:u.p.exp,issuedAt:u.p.iat,notBefore:u.p.nbf},message:d,signature:u.s.s,cacao:u}});try{await r.setSessions(l),s&&_.setLastConnectedSIWECaipNetwork(s),Se.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:On.getSIWXEventProperties()})}catch(u){throw console.error("SIWX:universalProviderAuth - failed to set sessions",u),Se.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:On.getSIWXEventProperties(u)}),await t.disconnect().catch(console.error),u}finally{yr.hide()}}return!0},getSIWXEventProperties(t){const e=_.state.activeChain;if(!e)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:_.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:qt(e)===lt.ACCOUNT_TYPES.SMART_ACCOUNT,message:t?ee.parseError(t):void 0}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},ze={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",OKX_CONNECTOR_NAME:"OKX Wallet",EIP155:D.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH",getSDKVersionWarningMessage(t,e){return`
     @@@@@@@           @@@@@@@@@@@@@@@@@@      
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@   @@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@   @@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@  @@@@@@@@@@@@@
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@   @@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@   @@@@@@@@@@@@@@    
 @@@@@@   @@@@@@  @@@@@@@@@@@  @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@   @@@@@@@@@@@@@@@ 
 @@@@@@@@@@@@@@@  @@@@@@@@@@@@@@@@@@@@@@@@@@@  
  @@@@@@@@@@@@@    @@@@@@@@@@@@@@@@@@@@@@@@@@  
   @@@@@@@@@@@      @@@@@@@@@@@@@@@@@@@@@@@@   
      @@@@@            @@@@@@@@@@@@@@@@@@  
      
AppKit SDK version ${t} is outdated. Latest version is ${e}. Please update to the latest version for bug fixes and new features.
            
Changelog: https://github.com/reown-com/appkit/releases
NPM Registry: https://www.npmjs.com/package/@reown/appkit`}},yn={ConnectorExplorerIds:{[D.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[D.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[D.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[D.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[D.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[ze.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[ze.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[ze.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[ze.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[ze.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[ze.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[ze.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[ze.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[ze.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[ze.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[ze.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13",[ze.OKX_CONNECTOR_NAME]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200","00000008819873e925422c1ff0f99f7c":"b3406e4a-bbfc-44fb-e3a6-89673c78b700"},ConnectorImageIds:{[D.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[D.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[D.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[D.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[D.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[D.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[D.CONNECTOR_ID.INJECTED]:"Browser Wallet",[D.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[D.CONNECTOR_ID.COINBASE]:"Coinbase",[D.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[D.CONNECTOR_ID.LEDGER]:"Ledger",[D.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[D.CONNECTOR_ID.INJECTED]:"INJECTED",[D.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[D.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[D.CONNECTOR_ID.AUTH]:"AUTH",[ze.CONNECTOR_TYPE_AUTH]:"AUTH"}},st={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${ze.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return t?.toLowerCase()===e?.toLowerCase()},getActiveNamespaceConnectedToAuth(){const t=_.state.activeChain;return D.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>K.getConnectorId(e)===D.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})},userChainIdToChainNamespace(t){if(typeof t=="number")return D.CHAIN.EVM;const[e]=t.split(":");return e},getOtherAuthNamespaces(t){return t?D.AUTH_CONNECTOR_SUPPORTED_CHAINS.filter(r=>r!==t):[]},getConnectorStorageInfo(t,e){const r=j.getConnections()[e]??[];return{hasDisconnected:j.isConnectorDisconnected(t,e),hasConnected:r.some(s=>st.isLowerCaseMatch(s.connectorId,t))}}},GM={extractVersion(t){if(!t||typeof t!="string")return null;const e=/(?:[~^>=<]+\s*)?(?<version>\d+(?:\.\d+){0,2})(?:-[a-zA-Z]+\.\d+)?/u;return t.match(e)?.groups?.version||null},checkSDKVersion(t){this.extractVersion(t)},isValidVersion(t){return typeof t=="string"&&/^\d+\.\d+\.\d+$/u.test(t)},isOlder(t,e){const n=this.extractVersion(t),r=this.extractVersion(e);if(!n||!r)return!1;function s(a){const c=a.split(".").map(Number);for(;c.length<3;)c.push(0);return c}const i=s(n),o=s(r);for(let a=0;a<Math.max(i.length,o.length);a+=1){const c=i[a]||0,l=o[a]||0;if(c<l)return!0;if(c>l)return!1}return!1}},YM=new AbortController,et={EmbeddedWalletAbortController:YM,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{code:"APKT001",displayMessage:"Network Not Found",debugMessage:"The specified network is not recognized. Please ensure it is included in the `networks` array of your `createAppKit` configuration."},ORIGIN_NOT_ALLOWED:{code:"APKT002",displayMessage:"Invalid App Configuration",debugMessage:()=>`The origin ${Qo()?window.origin:"unknown"} is not in your allow list. Please update your allowed domains at https://dashboard.reown.com.`},IFRAME_LOAD_FAILED:{code:"APKT003",displayMessage:"Network Error: Wallet Load Failed",debugMessage:()=>"Failed to load the embedded wallet. This may be due to network issues or server downtime. Please check your network connection and try again shortly. Contact support if the issue persists."},IFRAME_REQUEST_TIMEOUT:{code:"APKT004",displayMessage:"Wallet Request Timeout",debugMessage:()=>"The request to the embedded wallet timed out. Please check your network connection and try again shortly. Contact support if the issue persists."},UNVERIFIED_DOMAIN:{code:"APKT005",displayMessage:"Unverified Domain",debugMessage:()=>"Embedded wallet load failed. Ensure your domain is verified in https://dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{code:"APKT006",displayMessage:"Session Expired",debugMessage:"Your session is invalid or expired. Please check your systems date and time settings, then reconnect."},INVALID_PROJECT_ID:{code:"APKT007",displayMessage:"Invalid Project ID",debugMessage:"The specified project ID is invalid. Please visit https://dashboard.reown.com to obtain a valid project ID."},PROJECT_ID_NOT_CONFIGURED:{code:"APKT008",displayMessage:"Project ID Missing",debugMessage:"No project ID is configured. You can create and configure a project ID at https://dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{code:"APKT009",displayMessage:"Server Error",debugMessage:t=>`Unable to fetch App Configuration. ${t}. Please check your network connection and try again shortly. Contact support if the issue persists.`},RATE_LIMITED_APP_CONFIGURATION:{code:"APKT010",displayMessage:"Rate Limited",debugMessage:"You have been rate limited while retrieving App Configuration. Please wait a few minutes and try again. Contact support if the issue persists."}},ALERT_WARNINGS:{LOCAL_CONFIGURATION_IGNORED:{debugMessage:t=>`[Reown Config Notice] ${t}`},INACTIVE_NAMESPACE_NOT_CONNECTED:{code:"APKTW001",displayMessage:"Inactive Namespace Not Connected",debugMessage:(t,e)=>`An error occurred while connecting an inactive namespace ${t}: "${e}"`},INVALID_EMAIL:{code:"APKTW002",displayMessage:"Invalid Email Address",debugMessage:"Please enter a valid email address"}}},Ev={TOKEN_ADDRESSES_BY_SYMBOL:{USDC:{8453:Bb.asset,84532:SS.asset}},getTokenSymbolByAddress(t){if(!t)return;const[e]=Object.entries(Ev.TOKEN_ADDRESSES_BY_SYMBOL).find(([n,r])=>Object.values(r).includes(t))??[];return e}},ZM={createLogger(t,e="error"){const n=Co({level:e}),{logger:r}=rp({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},JM="rpc.walletconnect.org";function Py(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const Yd=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","eip155:80094","eip155:80069","eip155:560048","eip155:31","eip155:2818","eip155:57054","eip155:911867","eip155:534351","eip155:1112","eip155:534352","eip155:1111","eip155:146","eip155:130","eip155:1284","eip155:30","eip155:2810","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],gr={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===JM}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:D.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${D.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){const r=t.rpcUrls?.default?.http?.[0];return Yd.includes(e)?Py(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=t.rpcUrls?.default?.http?.[0],a=this.getDefaultRpcUrl(t,i,n),c=t?.rpcUrls?.chainDefault?.http?.[0]||o,l=r?.[i]?.map(h=>h.url)||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:yn.NetworkImageIds[t.id],imageUrl:e?.[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>gr.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){const r=[];return n?.forEach(s=>{r.push($c(s.url,s.config))}),Yd.includes(t.caipNetworkId)&&r.push($c(Py(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),t?.rpcUrls?.default?.http?.forEach(s=>{r.push($c(s))}),_0(r)},extendWagmiTransports(t,e,n){if(Yd.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return _0([n,$c(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:D.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){const e=j.getActiveCaipNetworkId(),n=_.getAllRequestedCaipNetworks(),r=Array.from(_.state.chains?.keys()||[]),s=e?.split(":")[0],i=s?r.includes(s):!1,o=n?.find(c=>c.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||n?.[0]}},vv={BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org"},XM={validateCaipAddress(t){if(t.split(":")?.length!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},xy={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Pt={set(t,e){wn.isClient&&localStorage.setItem(`${oe.STORAGE_KEY}${t}`,e)},get(t){return wn.isClient?localStorage.getItem(`${oe.STORAGE_KEY}${t}`):null},delete(t,e){wn.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${oe.STORAGE_KEY}${t}`))}},tl=30*1e3,wn={checkIfAllowedToTriggerEmail(){const t=Pt.get(oe.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<tl){const n=Math.ceil((tl-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Pt.get(oe.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<tl)return Math.ceil((tl-e)/1e3)}return 0},checkIfRequestExists(t){return lt.NOT_SAFE_RPC_METHODS.includes(t.method)||lt.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&(t?.match(xy.transactionHash)||t?.match(xy.signedMessage))?oe.RPC_RESPONSE_TYPE_TX:oe.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return lt.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Ue;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Ue||(Ue={}));var bf;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(bf||(bf={}));const ne=Ue.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ws=t=>{switch(typeof t){case"undefined":return ne.undefined;case"string":return ne.string;case"number":return isNaN(t)?ne.nan:ne.number;case"boolean":return ne.boolean;case"function":return ne.function;case"bigint":return ne.bigint;case"symbol":return ne.symbol;case"object":return Array.isArray(t)?ne.array:t===null?ne.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ne.promise:typeof Map<"u"&&t instanceof Map?ne.map:typeof Set<"u"&&t instanceof Set?ne.set:typeof Date<"u"&&t instanceof Date?ne.date:ne.object;default:return ne.unknown}},V=Ue.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),QM=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class tr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ue.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}tr.create=t=>new tr(t);const Ga=(t,e)=>{let n;switch(t.code){case V.invalid_type:t.received===ne.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case V.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Ue.jsonStringifyReplacer)}`;break;case V.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ue.joinValues(t.keys,", ")}`;break;case V.invalid_union:n="Invalid input";break;case V.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ue.joinValues(t.options)}`;break;case V.invalid_enum_value:n=`Invalid enum value. Expected ${Ue.joinValues(t.options)}, received '${t.received}'`;break;case V.invalid_arguments:n="Invalid function arguments";break;case V.invalid_return_type:n="Invalid function return type";break;case V.invalid_date:n="Invalid date";break;case V.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Ue.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case V.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case V.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case V.custom:n="Invalid input";break;case V.invalid_intersection_types:n="Intersection results could not be merged";break;case V.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case V.not_finite:n="Number must be finite";break;default:n=e.defaultError,Ue.assertNever(t)}return{message:n}};let Cv=Ga;function eL(t){Cv=t}function Wl(){return Cv}const zl=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},tL=[];function ie(t,e){const n=zl({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Wl(),Ga].filter(r=>!!r)});t.common.issues.push(n)}class Ft{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return we;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return Ft.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return we;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const we=Object.freeze({status:"aborted"}),_v=t=>({status:"dirty",value:t}),Vt=t=>({status:"valid",value:t}),Ef=t=>t.status==="aborted",vf=t=>t.status==="dirty",Ya=t=>t.status==="valid",Vl=t=>typeof Promise<"u"&&t instanceof Promise;var fe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(fe||(fe={}));class Nr{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Ry=(t,e)=>{if(Ya(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new tr(t.common.issues);return this._error=n,this._error}}};function be(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class ve{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ws(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ws(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ft,ctx:{common:e.parent.common,data:e.data,parsedType:ws(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Vl(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ws(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Ry(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ws(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(Vl(s)?s:Promise.resolve(s));return Ry(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:V.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new rr({schema:this,typeName:me.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Yr.create(this,this._def)}nullable(){return mi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nr.create(this,this._def)}promise(){return mo.create(this,this._def)}or(e){return Qa.create([this,e],this._def)}and(e){return ec.create(this,e,this._def)}transform(e){return new rr({...be(this._def),schema:this,typeName:me.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new ic({...be(this._def),innerType:this,defaultValue:n,typeName:me.ZodDefault})}brand(){return new Iv({typeName:me.ZodBranded,type:this,...be(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Zl({...be(this._def),innerType:this,catchValue:n,typeName:me.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return Tc.create(this,e)}readonly(){return Xl.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const nL=/^c[^\s-]{8,}$/i,rL=/^[a-z][a-z0-9]*$/,sL=/^[0-9A-HJKMNP-TV-Z]{26}$/,iL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,oL=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,aL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Zd;const cL=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,lL=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,uL=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function dL(t,e){return!!((e==="v4"||!e)&&cL.test(t)||(e==="v6"||!e)&&lL.test(t))}class Qn extends ve{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ne.string){const i=this._getOrReturnCtx(e);return ie(i,{code:V.invalid_type,expected:ne.string,received:i.parsedType}),we}const r=new Ft;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:V.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:V.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?ie(s,{code:V.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&ie(s,{code:V.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")oL.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"email",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Zd||(Zd=new RegExp(aL,"u")),Zd.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"emoji",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")iL.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"uuid",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")nL.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"cuid",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")rL.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"cuid2",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")sL.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"ulid",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),ie(s,{validation:"url",code:V.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"regex",code:V.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),ie(s,{code:V.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),ie(s,{code:V.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),ie(s,{code:V.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?uL(i).test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{code:V.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?dL(e.data,i.version)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"ip",code:V.invalid_string,message:i.message}),r.dirty()):Ue.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:V.invalid_string,...fe.errToObj(r)})}_addCheck(e){return new Qn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...fe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...fe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...fe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...fe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...fe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...fe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...fe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...fe.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,...fe.errToObj(e?.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...fe.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...fe.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...fe.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...fe.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...fe.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...fe.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...fe.errToObj(n)})}nonempty(e){return this.min(1,fe.errToObj(e))}trim(){return new Qn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Qn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Qn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Qn.create=t=>{var e;return new Qn({checks:[],typeName:me.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...be(t)})};function hL(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class xs extends ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ne.number){const i=this._getOrReturnCtx(e);return ie(i,{code:V.invalid_type,expected:ne.number,received:i.parsedType}),we}let r;const s=new Ft;for(const i of this._def.checks)i.kind==="int"?Ue.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:V.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:V.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:V.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?hL(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),ie(r,{code:V.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:V.not_finite,message:i.message}),s.dirty()):Ue.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,fe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,fe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,fe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,fe.toString(n))}setLimit(e,n,r,s){return new xs({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:fe.toString(s)}]})}_addCheck(e){return new xs({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:fe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:fe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:fe.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:fe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:fe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:fe.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Ue.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}xs.create=t=>new xs({checks:[],typeName:me.ZodNumber,coerce:t?.coerce||!1,...be(t)});class Rs extends ve{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ne.bigint){const i=this._getOrReturnCtx(e);return ie(i,{code:V.invalid_type,expected:ne.bigint,received:i.parsedType}),we}let r;const s=new Ft;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:V.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:V.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:V.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Ue.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,fe.toString(n))}gt(e,n){return this.setLimit("min",e,!1,fe.toString(n))}lte(e,n){return this.setLimit("max",e,!0,fe.toString(n))}lt(e,n){return this.setLimit("max",e,!1,fe.toString(n))}setLimit(e,n,r,s){return new Rs({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:fe.toString(s)}]})}_addCheck(e){return new Rs({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:fe.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:fe.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Rs.create=t=>{var e;return new Rs({checks:[],typeName:me.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...be(t)})};class Za extends ve{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ne.boolean){const r=this._getOrReturnCtx(e);return ie(r,{code:V.invalid_type,expected:ne.boolean,received:r.parsedType}),we}return Vt(e.data)}}Za.create=t=>new Za({typeName:me.ZodBoolean,coerce:t?.coerce||!1,...be(t)});class pi extends ve{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ne.date){const i=this._getOrReturnCtx(e);return ie(i,{code:V.invalid_type,expected:ne.date,received:i.parsedType}),we}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return ie(i,{code:V.invalid_date}),we}const r=new Ft;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:V.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:V.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Ue.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new pi({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:fe.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:fe.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}pi.create=t=>new pi({checks:[],coerce:t?.coerce||!1,typeName:me.ZodDate,...be(t)});class Kl extends ve{_parse(e){if(this._getType(e)!==ne.symbol){const r=this._getOrReturnCtx(e);return ie(r,{code:V.invalid_type,expected:ne.symbol,received:r.parsedType}),we}return Vt(e.data)}}Kl.create=t=>new Kl({typeName:me.ZodSymbol,...be(t)});class Ja extends ve{_parse(e){if(this._getType(e)!==ne.undefined){const r=this._getOrReturnCtx(e);return ie(r,{code:V.invalid_type,expected:ne.undefined,received:r.parsedType}),we}return Vt(e.data)}}Ja.create=t=>new Ja({typeName:me.ZodUndefined,...be(t)});class Xa extends ve{_parse(e){if(this._getType(e)!==ne.null){const r=this._getOrReturnCtx(e);return ie(r,{code:V.invalid_type,expected:ne.null,received:r.parsedType}),we}return Vt(e.data)}}Xa.create=t=>new Xa({typeName:me.ZodNull,...be(t)});class go extends ve{constructor(){super(...arguments),this._any=!0}_parse(e){return Vt(e.data)}}go.create=t=>new go({typeName:me.ZodAny,...be(t)});class ri extends ve{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Vt(e.data)}}ri.create=t=>new ri({typeName:me.ZodUnknown,...be(t)});class Qr extends ve{_parse(e){const n=this._getOrReturnCtx(e);return ie(n,{code:V.invalid_type,expected:ne.never,received:n.parsedType}),we}}Qr.create=t=>new Qr({typeName:me.ZodNever,...be(t)});class Gl extends ve{_parse(e){if(this._getType(e)!==ne.undefined){const r=this._getOrReturnCtx(e);return ie(r,{code:V.invalid_type,expected:ne.void,received:r.parsedType}),we}return Vt(e.data)}}Gl.create=t=>new Gl({typeName:me.ZodVoid,...be(t)});class nr extends ve{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==ne.array)return ie(n,{code:V.invalid_type,expected:ne.array,received:n.parsedType}),we;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(ie(n,{code:o?V.too_big:V.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(ie(n,{code:V.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(ie(n,{code:V.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Nr(n,o,n.path,a)))).then(o=>Ft.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Nr(n,o,n.path,a)));return Ft.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new nr({...this._def,minLength:{value:e,message:fe.toString(n)}})}max(e,n){return new nr({...this._def,maxLength:{value:e,message:fe.toString(n)}})}length(e,n){return new nr({...this._def,exactLength:{value:e,message:fe.toString(n)}})}nonempty(e){return this.min(1,e)}}nr.create=(t,e)=>new nr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:me.ZodArray,...be(e)});function Yi(t){if(t instanceof tt){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Yr.create(Yi(r))}return new tt({...t._def,shape:()=>e})}else return t instanceof nr?new nr({...t._def,type:Yi(t.element)}):t instanceof Yr?Yr.create(Yi(t.unwrap())):t instanceof mi?mi.create(Yi(t.unwrap())):t instanceof Tr?Tr.create(t.items.map(e=>Yi(e))):t}class tt extends ve{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Ue.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==ne.object){const l=this._getOrReturnCtx(e);return ie(l,{code:V.invalid_type,expected:ne.object,received:l.parsedType}),we}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Qr&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Nr(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof Qr){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(ie(s,{code:V.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Nr(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>Ft.mergeObjectSync(r,l)):Ft.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return fe.errToObj,new tt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=fe.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new tt({...this._def,unknownKeys:"strip"})}passthrough(){return new tt({...this._def,unknownKeys:"passthrough"})}extend(e){return new tt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new tt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:me.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new tt({...this._def,catchall:e})}pick(e){const n={};return Ue.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new tt({...this._def,shape:()=>n})}omit(e){const n={};return Ue.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new tt({...this._def,shape:()=>n})}deepPartial(){return Yi(this)}partial(e){const n={};return Ue.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new tt({...this._def,shape:()=>n})}required(e){const n={};return Ue.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Yr;)i=i._def.innerType;n[r]=i}}),new tt({...this._def,shape:()=>n})}keyof(){return Av(Ue.objectKeys(this.shape))}}tt.create=(t,e)=>new tt({shape:()=>t,unknownKeys:"strip",catchall:Qr.create(),typeName:me.ZodObject,...be(e)});tt.strictCreate=(t,e)=>new tt({shape:()=>t,unknownKeys:"strict",catchall:Qr.create(),typeName:me.ZodObject,...be(e)});tt.lazycreate=(t,e)=>new tt({shape:t,unknownKeys:"strip",catchall:Qr.create(),typeName:me.ZodObject,...be(e)});class Qa extends ve{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new tr(a.ctx.common.issues));return ie(n,{code:V.invalid_union,unionErrors:o}),we}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new tr(c));return ie(n,{code:V.invalid_union,unionErrors:a}),we}}get options(){return this._def.options}}Qa.create=(t,e)=>new Qa({options:t,typeName:me.ZodUnion,...be(e)});const gl=t=>t instanceof nc?gl(t.schema):t instanceof rr?gl(t.innerType()):t instanceof rc?[t.value]:t instanceof Os?t.options:t instanceof sc?Object.keys(t.enum):t instanceof ic?gl(t._def.innerType):t instanceof Ja?[void 0]:t instanceof Xa?[null]:null;class Ou extends ve{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.object)return ie(n,{code:V.invalid_type,expected:ne.object,received:n.parsedType}),we;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(ie(n,{code:V.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),we)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=gl(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Ou({typeName:me.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...be(r)})}}function Cf(t,e){const n=ws(t),r=ws(e);if(t===e)return{valid:!0,data:t};if(n===ne.object&&r===ne.object){const s=Ue.objectKeys(e),i=Ue.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=Cf(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===ne.array&&r===ne.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=Cf(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===ne.date&&r===ne.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class ec extends ve{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(Ef(i)||Ef(o))return we;const a=Cf(i.value,o.value);return a.valid?((vf(i)||vf(o))&&n.dirty(),{status:n.value,value:a.data}):(ie(r,{code:V.invalid_intersection_types}),we)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}ec.create=(t,e,n)=>new ec({left:t,right:e,typeName:me.ZodIntersection,...be(n)});class Tr extends ve{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.array)return ie(r,{code:V.invalid_type,expected:ne.array,received:r.parsedType}),we;if(r.data.length<this._def.items.length)return ie(r,{code:V.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),we;!this._def.rest&&r.data.length>this._def.items.length&&(ie(r,{code:V.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Nr(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>Ft.mergeArray(n,o)):Ft.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Tr({...this._def,rest:e})}}Tr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Tr({items:t,typeName:me.ZodTuple,rest:null,...be(e)})};class tc extends ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.object)return ie(r,{code:V.invalid_type,expected:ne.object,received:r.parsedType}),we;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Nr(r,a,r.path,a)),value:o._parse(new Nr(r,r.data[a],r.path,a))});return r.common.async?Ft.mergeObjectAsync(n,s):Ft.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof ve?new tc({keyType:e,valueType:n,typeName:me.ZodRecord,...be(r)}):new tc({keyType:Qn.create(),valueType:e,typeName:me.ZodRecord,...be(n)})}}class Yl extends ve{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.map)return ie(r,{code:V.invalid_type,expected:ne.map,received:r.parsedType}),we;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Nr(r,a,r.path,[l,"key"])),value:i._parse(new Nr(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return we;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return we;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}Yl.create=(t,e,n)=>new Yl({valueType:e,keyType:t,typeName:me.ZodMap,...be(n)});class gi extends ve{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==ne.set)return ie(r,{code:V.invalid_type,expected:ne.set,received:r.parsedType}),we;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(ie(r,{code:V.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(ie(r,{code:V.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return we;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Nr(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new gi({...this._def,minSize:{value:e,message:fe.toString(n)}})}max(e,n){return new gi({...this._def,maxSize:{value:e,message:fe.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}gi.create=(t,e)=>new gi({valueType:t,minSize:null,maxSize:null,typeName:me.ZodSet,...be(e)});class no extends ve{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.function)return ie(n,{code:V.invalid_type,expected:ne.function,received:n.parsedType}),we;function r(a,c){return zl({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Wl(),Ga].filter(l=>!!l),issueData:{code:V.invalid_arguments,argumentsError:c}})}function s(a,c){return zl({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Wl(),Ga].filter(l=>!!l),issueData:{code:V.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof mo){const a=this;return Vt(async function(...c){const l=new tr([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(r(c,f)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw l.addIssue(s(d,f)),l})})}else{const a=this;return Vt(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new tr([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new tr([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new no({...this._def,args:Tr.create(e).rest(ri.create())})}returns(e){return new no({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new no({args:e||Tr.create([]).rest(ri.create()),returns:n||ri.create(),typeName:me.ZodFunction,...be(r)})}}class nc extends ve{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}nc.create=(t,e)=>new nc({getter:t,typeName:me.ZodLazy,...be(e)});class rc extends ve{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ie(n,{received:n.data,code:V.invalid_literal,expected:this._def.value}),we}return{status:"valid",value:e.data}}get value(){return this._def.value}}rc.create=(t,e)=>new rc({value:t,typeName:me.ZodLiteral,...be(e)});function Av(t,e){return new Os({values:t,typeName:me.ZodEnum,...be(e)})}class Os extends ve{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ie(n,{expected:Ue.joinValues(r),received:n.parsedType,code:V.invalid_type}),we}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return ie(n,{received:n.data,code:V.invalid_enum_value,options:r}),we}return Vt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Os.create(e)}exclude(e){return Os.create(this.options.filter(n=>!e.includes(n)))}}Os.create=Av;class sc extends ve{_parse(e){const n=Ue.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ne.string&&r.parsedType!==ne.number){const s=Ue.objectValues(n);return ie(r,{expected:Ue.joinValues(s),received:r.parsedType,code:V.invalid_type}),we}if(n.indexOf(e.data)===-1){const s=Ue.objectValues(n);return ie(r,{received:r.data,code:V.invalid_enum_value,options:s}),we}return Vt(e.data)}get enum(){return this._def.values}}sc.create=(t,e)=>new sc({values:t,typeName:me.ZodNativeEnum,...be(e)});class mo extends ve{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==ne.promise&&n.common.async===!1)return ie(n,{code:V.invalid_type,expected:ne.promise,received:n.parsedType}),we;const r=n.parsedType===ne.promise?n.data:Promise.resolve(n.data);return Vt(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}mo.create=(t,e)=>new mo({type:t,typeName:me.ZodPromise,...be(e)});class rr extends ve{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===me.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{ie(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?we:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?we:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ya(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Ya(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);Ue.assertNever(s)}}rr.create=(t,e,n)=>new rr({schema:t,typeName:me.ZodEffects,effect:e,...be(n)});rr.createWithPreprocess=(t,e,n)=>new rr({schema:e,effect:{type:"preprocess",transform:t},typeName:me.ZodEffects,...be(n)});class Yr extends ve{_parse(e){return this._getType(e)===ne.undefined?Vt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Yr.create=(t,e)=>new Yr({innerType:t,typeName:me.ZodOptional,...be(e)});class mi extends ve{_parse(e){return this._getType(e)===ne.null?Vt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}mi.create=(t,e)=>new mi({innerType:t,typeName:me.ZodNullable,...be(e)});class ic extends ve{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===ne.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}ic.create=(t,e)=>new ic({innerType:t,typeName:me.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...be(e)});class Zl extends ve{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Vl(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new tr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new tr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Zl.create=(t,e)=>new Zl({innerType:t,typeName:me.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...be(e)});class Jl extends ve{_parse(e){if(this._getType(e)!==ne.nan){const r=this._getOrReturnCtx(e);return ie(r,{code:V.invalid_type,expected:ne.nan,received:r.parsedType}),we}return{status:"valid",value:e.data}}}Jl.create=t=>new Jl({typeName:me.ZodNaN,...be(t)});const fL=Symbol("zod_brand");class Iv extends ve{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class Tc extends ve{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?we:i.status==="dirty"?(n.dirty(),_v(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?we:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new Tc({in:e,out:n,typeName:me.ZodPipeline})}}class Xl extends ve{_parse(e){const n=this._def.innerType._parse(e);return Ya(n)&&(n.value=Object.freeze(n.value)),n}}Xl.create=(t,e)=>new Xl({innerType:t,typeName:me.ZodReadonly,...be(e)});const Sv=(t,e={},n)=>t?go.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):go.create(),pL={object:tt.lazycreate};var me;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(me||(me={}));const gL=(t,e={message:`Input not instance of ${t.name}`})=>Sv(n=>n instanceof t,e),Nv=Qn.create,Tv=xs.create,mL=Jl.create,yL=Rs.create,Pv=Za.create,wL=pi.create,bL=Kl.create,EL=Ja.create,vL=Xa.create,CL=go.create,_L=ri.create,AL=Qr.create,IL=Gl.create,SL=nr.create,NL=tt.create,TL=tt.strictCreate,PL=Qa.create,xL=Ou.create,RL=ec.create,OL=Tr.create,kL=tc.create,DL=Yl.create,$L=gi.create,UL=no.create,ML=nc.create,LL=rc.create,BL=Os.create,FL=sc.create,jL=mo.create,Oy=rr.create,HL=Yr.create,qL=mi.create,WL=rr.createWithPreprocess,zL=Tc.create,VL=()=>Nv().optional(),KL=()=>Tv().optional(),GL=()=>Pv().optional(),YL={string:(t=>Qn.create({...t,coerce:!0})),number:(t=>xs.create({...t,coerce:!0})),boolean:(t=>Za.create({...t,coerce:!0})),bigint:(t=>Rs.create({...t,coerce:!0})),date:(t=>pi.create({...t,coerce:!0}))},ZL=we;var E=Object.freeze({__proto__:null,defaultErrorMap:Ga,setErrorMap:eL,getErrorMap:Wl,makeIssue:zl,EMPTY_PATH:tL,addIssueToContext:ie,ParseStatus:Ft,INVALID:we,DIRTY:_v,OK:Vt,isAborted:Ef,isDirty:vf,isValid:Ya,isAsync:Vl,get util(){return Ue},get objectUtil(){return bf},ZodParsedType:ne,getParsedType:ws,ZodType:ve,ZodString:Qn,ZodNumber:xs,ZodBigInt:Rs,ZodBoolean:Za,ZodDate:pi,ZodSymbol:Kl,ZodUndefined:Ja,ZodNull:Xa,ZodAny:go,ZodUnknown:ri,ZodNever:Qr,ZodVoid:Gl,ZodArray:nr,ZodObject:tt,ZodUnion:Qa,ZodDiscriminatedUnion:Ou,ZodIntersection:ec,ZodTuple:Tr,ZodRecord:tc,ZodMap:Yl,ZodSet:gi,ZodFunction:no,ZodLazy:nc,ZodLiteral:rc,ZodEnum:Os,ZodNativeEnum:sc,ZodPromise:mo,ZodEffects:rr,ZodTransformer:rr,ZodOptional:Yr,ZodNullable:mi,ZodDefault:ic,ZodCatch:Zl,ZodNaN:Jl,BRAND:fL,ZodBranded:Iv,ZodPipeline:Tc,ZodReadonly:Xl,custom:Sv,Schema:ve,ZodSchema:ve,late:pL,get ZodFirstPartyTypeKind(){return me},coerce:YL,any:CL,array:SL,bigint:yL,boolean:Pv,date:wL,discriminatedUnion:xL,effect:Oy,enum:BL,function:UL,instanceof:gL,intersection:RL,lazy:ML,literal:LL,map:DL,nan:mL,nativeEnum:FL,never:AL,null:vL,nullable:qL,number:Tv,object:NL,oboolean:GL,onumber:KL,optional:HL,ostring:VL,pipeline:zL,preprocess:WL,promise:jL,record:kL,set:$L,strictObject:TL,string:Nv,symbol:bL,transformer:Oy,tuple:OL,undefined:EL,union:PL,unknown:_L,void:IL,NEVER:ZL,ZodIssueCode:V,quotelessJson:QM,ZodError:tr});const nt=E.object({message:E.string()});function re(t){return E.literal(oe[t])}const ku=E.object({serializedMessage:E.string().optional(),accountAddress:E.string(),chainId:E.string(),notBefore:E.string().optional(),domain:E.string(),uri:E.string(),version:E.string(),nonce:E.string(),statement:E.string().optional(),resources:E.array(E.string()).optional(),requestId:E.string().optional(),issuedAt:E.string().optional(),expirationTime:E.string().optional()});E.object({accessList:E.array(E.string()),blockHash:E.string().nullable(),blockNumber:E.string().nullable(),chainId:E.string().or(E.number()),from:E.string(),gas:E.string(),hash:E.string(),input:E.string().nullable(),maxFeePerGas:E.string(),maxPriorityFeePerGas:E.string(),nonce:E.string(),r:E.string(),s:E.string(),to:E.string(),transactionIndex:E.string().nullable(),type:E.string(),v:E.string(),value:E.string()});const JL=E.object({chainId:E.string().or(E.number()),rpcUrl:E.optional(E.string())}),XL=E.object({email:E.string().email()}),QL=E.object({otp:E.string()}),eB=E.object({uri:E.string(),preferredAccountType:E.optional(E.string()),chainId:E.optional(E.string().or(E.number())),siwxMessage:E.optional(ku),rpcUrl:E.optional(E.string())}),tB=E.object({chainId:E.optional(E.string().or(E.number())),preferredAccountType:E.optional(E.string()),socialUri:E.optional(E.string()),siwxMessage:E.optional(ku),rpcUrl:E.optional(E.string())}),nB=E.object({provider:E.enum(["google","github","apple","facebook","x","discord"])}),rB=E.object({email:E.string().email()}),sB=E.object({otp:E.string()}),iB=E.object({otp:E.string()}),oB=E.object({themeMode:E.optional(E.enum(["light","dark"])),themeVariables:E.optional(E.record(E.string(),E.string().or(E.number()))),w3mThemeVariables:E.optional(E.record(E.string(),E.string()))}),aB=E.object({metadata:E.object({name:E.string(),description:E.string(),url:E.string(),icons:E.array(E.string())}).optional(),sdkVersion:E.string().optional(),sdkType:E.string().optional(),projectId:E.string()}),cB=E.object({type:E.string()}),lB=E.object({action:E.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),uB=E.object({url:E.string()}),dB=E.object({userName:E.string()}),hB=E.object({email:E.string().optional().nullable(),address:E.string(),chainId:E.string().or(E.number()),accounts:E.array(E.object({address:E.string(),type:E.enum([lt.ACCOUNT_TYPES.EOA,lt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:E.string().optional().nullable(),preferredAccountType:E.optional(E.string()),signature:E.string().optional(),message:E.string().optional(),siwxMessage:E.optional(ku)}),fB=E.object({action:E.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),pB=E.object({email:E.string().email().optional().nullable(),address:E.string(),chainId:E.string().or(E.number()),smartAccountDeployed:E.optional(E.boolean()),accounts:E.array(E.object({address:E.string(),type:E.enum([lt.ACCOUNT_TYPES.EOA,lt.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:E.optional(E.string()),signature:E.string().optional(),message:E.string().optional(),siwxMessage:E.optional(ku)}),gB=E.object({uri:E.string()}),mB=E.object({isConnected:E.boolean()}),yB=E.object({chainId:E.string().or(E.number())}),wB=E.object({chainId:E.string().or(E.number())}),bB=E.object({newEmail:E.string().email()}),EB=E.object({smartAccountEnabledNetworks:E.array(E.number())});E.object({address:E.string(),isDeployed:E.boolean()});const vB=E.object({version:E.string().optional()}),CB=E.object({type:E.string(),address:E.string()}),_B=E.any(),AB=E.object({method:E.literal("eth_accounts")}),IB=E.object({method:E.literal("eth_blockNumber")}),SB=E.object({method:E.literal("eth_call"),params:E.array(E.any())}),NB=E.object({method:E.literal("eth_chainId")}),TB=E.object({method:E.literal("eth_estimateGas"),params:E.array(E.any())}),PB=E.object({method:E.literal("eth_feeHistory"),params:E.array(E.any())}),xB=E.object({method:E.literal("eth_gasPrice")}),RB=E.object({method:E.literal("eth_getAccount"),params:E.array(E.any())}),OB=E.object({method:E.literal("eth_getBalance"),params:E.array(E.any())}),kB=E.object({method:E.literal("eth_getBlockByHash"),params:E.array(E.any())}),DB=E.object({method:E.literal("eth_getBlockByNumber"),params:E.array(E.any())}),$B=E.object({method:E.literal("eth_getBlockReceipts"),params:E.array(E.any())}),UB=E.object({method:E.literal("eth_getBlockTransactionCountByHash"),params:E.array(E.any())}),MB=E.object({method:E.literal("eth_getBlockTransactionCountByNumber"),params:E.array(E.any())}),LB=E.object({method:E.literal("eth_getCode"),params:E.array(E.any())}),BB=E.object({method:E.literal("eth_getFilterChanges"),params:E.array(E.any())}),FB=E.object({method:E.literal("eth_getFilterLogs"),params:E.array(E.any())}),jB=E.object({method:E.literal("eth_getLogs"),params:E.array(E.any())}),HB=E.object({method:E.literal("eth_getProof"),params:E.array(E.any())}),qB=E.object({method:E.literal("eth_getStorageAt"),params:E.array(E.any())}),WB=E.object({method:E.literal("eth_getTransactionByBlockHashAndIndex"),params:E.array(E.any())}),zB=E.object({method:E.literal("eth_getTransactionByBlockNumberAndIndex"),params:E.array(E.any())}),VB=E.object({method:E.literal("eth_getTransactionByHash"),params:E.array(E.any())}),KB=E.object({method:E.literal("eth_getTransactionCount"),params:E.array(E.any())}),GB=E.object({method:E.literal("eth_getTransactionReceipt"),params:E.array(E.any())}),YB=E.object({method:E.literal("eth_getUncleCountByBlockHash"),params:E.array(E.any())}),ZB=E.object({method:E.literal("eth_getUncleCountByBlockNumber"),params:E.array(E.any())}),JB=E.object({method:E.literal("eth_maxPriorityFeePerGas")}),XB=E.object({method:E.literal("eth_newBlockFilter")}),QB=E.object({method:E.literal("eth_newFilter"),params:E.array(E.any())}),eF=E.object({method:E.literal("eth_newPendingTransactionFilter")}),tF=E.object({method:E.literal("eth_sendRawTransaction"),params:E.array(E.any())}),nF=E.object({method:E.literal("eth_syncing"),params:E.array(E.any())}),rF=E.object({method:E.literal("eth_uninstallFilter"),params:E.array(E.any())}),ky=E.object({method:E.literal("personal_sign"),params:E.array(E.any())}),sF=E.object({method:E.literal("eth_signTypedData_v4"),params:E.array(E.any())}),iF=E.object({method:E.literal("eth_sendTransaction"),params:E.array(E.any())}),oF=E.object({method:E.literal("solana_signMessage"),params:E.object({message:E.string(),pubkey:E.string()})}),aF=E.object({method:E.literal("solana_signTransaction"),params:E.object({transaction:E.string()})}),cF=E.object({method:E.literal("solana_signAllTransactions"),params:E.object({transactions:E.array(E.string())})}),lF=E.object({method:E.literal("solana_signAndSendTransaction"),params:E.object({transaction:E.string(),options:E.object({skipPreflight:E.boolean().optional(),preflightCommitment:E.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:E.number().optional(),minContextSlot:E.number().optional()}).optional()})}),uF=E.object({method:E.literal("wallet_sendCalls"),params:E.array(E.object({chainId:E.string().or(E.number()).optional(),from:E.string().optional(),version:E.string().optional(),capabilities:E.any().optional(),calls:E.array(E.object({to:E.string().startsWith("0x"),data:E.string().startsWith("0x").optional(),value:E.string().optional()}))}))}),dF=E.object({method:E.literal("wallet_getCallsStatus"),params:E.array(E.string())}),hF=E.object({method:E.literal("wallet_getCapabilities"),params:E.array(E.string().or(E.number()).optional()).optional()}),fF=E.object({method:E.literal("wallet_grantPermissions"),params:E.array(E.any())}),pF=E.object({method:E.literal("wallet_revokePermissions"),params:E.any()}),gF=E.object({method:E.literal("wallet_getAssets"),params:E.any()}),Dy=E.object({token:E.string()}),se=E.object({id:E.string().optional()}),Jd={appEvent:se.extend({type:re("APP_SWITCH_NETWORK"),payload:JL}).or(se.extend({type:re("APP_CONNECT_EMAIL"),payload:XL})).or(se.extend({type:re("APP_CONNECT_DEVICE")})).or(se.extend({type:re("APP_CONNECT_OTP"),payload:QL})).or(se.extend({type:re("APP_CONNECT_SOCIAL"),payload:eB})).or(se.extend({type:re("APP_GET_FARCASTER_URI")})).or(se.extend({type:re("APP_CONNECT_FARCASTER")})).or(se.extend({type:re("APP_GET_USER"),payload:E.optional(tB)})).or(se.extend({type:re("APP_GET_SOCIAL_REDIRECT_URI"),payload:nB})).or(se.extend({type:re("APP_SIGN_OUT")})).or(se.extend({type:re("APP_IS_CONNECTED"),payload:E.optional(Dy)})).or(se.extend({type:re("APP_GET_CHAIN_ID")})).or(se.extend({type:re("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(se.extend({type:re("APP_INIT_SMART_ACCOUNT")})).or(se.extend({type:re("APP_SET_PREFERRED_ACCOUNT"),payload:cB})).or(se.extend({type:re("APP_RPC_REQUEST"),payload:ky.or(gF).or(AB).or(IB).or(SB).or(NB).or(TB).or(PB).or(xB).or(RB).or(OB).or(kB).or(DB).or($B).or(UB).or(MB).or(LB).or(BB).or(FB).or(jB).or(HB).or(qB).or(WB).or(zB).or(VB).or(KB).or(GB).or(YB).or(ZB).or(JB).or(XB).or(QB).or(eF).or(tF).or(nF).or(rF).or(ky).or(sF).or(iF).or(oF).or(aF).or(cF).or(lF).or(dF).or(uF).or(hF).or(fF).or(pF).and(E.object({chainId:E.string().or(E.number()).optional(),chainNamespace:E.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:E.string().optional()}))})).or(se.extend({type:re("APP_UPDATE_EMAIL"),payload:rB})).or(se.extend({type:re("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:sB})).or(se.extend({type:re("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:iB})).or(se.extend({type:re("APP_SYNC_THEME"),payload:oB})).or(se.extend({type:re("APP_SYNC_DAPP_DATA"),payload:aB})).or(se.extend({type:re("APP_RELOAD")})).or(se.extend({type:re("APP_RPC_ABORT")})),frameEvent:se.extend({type:re("FRAME_SWITCH_NETWORK_ERROR"),payload:nt}).or(se.extend({type:re("FRAME_SWITCH_NETWORK_SUCCESS"),payload:wB})).or(se.extend({type:re("FRAME_CONNECT_EMAIL_SUCCESS"),payload:lB})).or(se.extend({type:re("FRAME_CONNECT_EMAIL_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:uB})).or(se.extend({type:re("FRAME_GET_FARCASTER_URI_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:dB})).or(se.extend({type:re("FRAME_CONNECT_FARCASTER_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_CONNECT_OTP_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_CONNECT_OTP_SUCCESS")})).or(se.extend({type:re("FRAME_CONNECT_DEVICE_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_CONNECT_DEVICE_SUCCESS")})).or(se.extend({type:re("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:hB})).or(se.extend({type:re("FRAME_CONNECT_SOCIAL_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_GET_USER_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_GET_USER_SUCCESS"),payload:pB})).or(se.extend({type:re("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:gB})).or(se.extend({type:re("FRAME_SIGN_OUT_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_SIGN_OUT_SUCCESS")})).or(se.extend({type:re("FRAME_IS_CONNECTED_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_IS_CONNECTED_SUCCESS"),payload:mB})).or(se.extend({type:re("FRAME_GET_CHAIN_ID_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_GET_CHAIN_ID_SUCCESS"),payload:yB})).or(se.extend({type:re("FRAME_RPC_REQUEST_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_RPC_REQUEST_SUCCESS"),payload:_B})).or(se.extend({type:re("FRAME_SESSION_UPDATE"),payload:Dy})).or(se.extend({type:re("FRAME_UPDATE_EMAIL_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_UPDATE_EMAIL_SUCCESS"),payload:fB})).or(se.extend({type:re("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(se.extend({type:re("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:bB})).or(se.extend({type:re("FRAME_SYNC_THEME_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_SYNC_THEME_SUCCESS")})).or(se.extend({type:re("FRAME_SYNC_DAPP_DATA_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(se.extend({type:re("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:EB})).or(se.extend({type:re("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:CB})).or(se.extend({type:re("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_READY"),payload:vB})).or(se.extend({type:re("FRAME_RELOAD_ERROR"),payload:nt})).or(se.extend({type:re("FRAME_RELOAD_SUCCESS")}))};function Xd(t,e={}){return typeof e?.type=="string"&&e?.type?.includes(t)}function mF({projectId:t,chainId:e,enableLogger:n,rpcUrl:r=vv.BLOCKCHAIN_API_RPC_URL,enableCloudAuthAccount:s=!1}){const i=new URL(H2);return i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",W2),i.searchParams.set("enableLogger",String(n)),i.searchParams.set("rpcUrl",r),s&&i.searchParams.set("enableCloudAuthAccount","true"),i.toString()}class yF{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,enableCloudAuthAccount:i=!1,rpcUrl:o=vv.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const a=document.getElementById("w3m-iframe");this.iframe&&!a&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(a,c,l)=>{function u({data:d}){if(!Xd(oe.FRAME_EVENT_KEY,d))return;const h=Jd.frameEvent.safeParse(d);if(!h.success){console.warn("W3mFrame: invalid frame event",h.error.message);return}h.data?.id===a&&(c(h.data),window.removeEventListener("message",u))}wn.isClient&&(window.addEventListener("message",u),l.addEventListener("abort",()=>{window.removeEventListener("message",u)}))},onFrameEvent:a=>{wn.isClient&&window.addEventListener("message",({data:c})=>{if(!Xd(oe.FRAME_EVENT_KEY,c))return;const l=Jd.frameEvent.safeParse(c);l.success?a(l.data):console.warn("W3mFrame: invalid frame event",l.error.message)})},onAppEvent:a=>{wn.isClient&&window.addEventListener("message",({data:c})=>{if(!Xd(oe.APP_EVENT_KEY,c))return;const l=Jd.appEvent.safeParse(c);l.success||console.warn("W3mFrame: invalid app event",l.error.message),a(c)})},postAppEvent:a=>{if(wn.isClient){if(!this.iframe?.contentWindow)throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(a,"*")}},postFrameEvent:a=>{if(wn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(a,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),this.rpcUrl=o,n&&(this.frameLoadPromise=new Promise((a,c)=>{this.frameLoadPromiseResolver={resolve:a,reject:c}}),wn.isClient)){const a=document.createElement("iframe");a.id="w3m-iframe",a.src=mF({projectId:e,chainId:r,enableLogger:s,rpcUrl:this.rpcUrl,enableCloudAuthAccount:i}),a.name="w3m-secure-iframe",a.style.position="fixed",a.style.zIndex="999999",a.style.display="none",a.style.border="none",a.style.animationDelay="0s, 50ms",a.style.borderBottomLeftRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",a.style.borderBottomRightRadius="clamp(0px, var(--apkt-borderRadius-8), 44px)",this.iframe=a,this.iframe.onerror=()=>{this.frameLoadPromiseResolver?.reject("Unable to load email login dependency")},this.events.onFrameEvent(c=>{c.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,this.frameLoadPromiseResolver?.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}class wF{constructor(e){const n=Co({level:q2}),{logger:r,chunkLoggerController:s}=rp({opts:n});this.logger=jt(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&this.chunkLoggerController?.downloadLogsBlobInBrowser&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{this.chunkLoggerController?.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class bF{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:c}){this.openRpcRequests=new Map,this.isInitialized=!1,r&&(this.w3mLogger=new wF(e)),this.abortController=i,this.getActiveCaipNetwork=o,this.getCaipNetworks=a;const l=this.getRpcUrl(n);this.w3mFrame=new yF({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:l,enableCloudAuthAccount:c}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Pt.get(oe.EMAIL_LOGIN_USED_KEY)}getEmail(){return Pt.get(oe.EMAIL)}getUsername(){return Pt.get(oe.SOCIAL_USERNAME)}async reload(){try{await this.appEvent({type:oe.APP_RELOAD})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error reloading iframe"),e}}async connectEmail(e){try{wn.checkIfAllowedToTriggerEmail(),await this.init();const n=await this.appEvent({type:oe.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting email"),n}}async connectDevice(){try{return this.appEvent({type:oe.APP_CONNECT_DEVICE})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting device"),e}}async connectOtp(e){try{return this.appEvent({type:oe.APP_CONNECT_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting otp"),n}}async isConnected(){try{if(!this.getLoginEmailUsed())return{isConnected:!1};const e=await this.appEvent({type:oe.APP_IS_CONNECTED});return e?.isConnected||this.deleteAuthLoginCache(),e}catch(e){throw this.deleteAuthLoginCache(),this.w3mLogger?.logger.error({error:e},"Error checking connection"),e}}async getChainId(){try{const e=await this.appEvent({type:oe.APP_GET_CHAIN_ID});return this.setLastUsedChainId(e.chainId),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting chain id"),e}}async getSocialRedirectUri(e){try{return await this.init(),this.appEvent({type:oe.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error getting social redirect uri"),n}}async updateEmail(e){try{const n=await this.appEvent({type:oe.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email"),n}}async updateEmailPrimaryOtp(e){try{return this.appEvent({type:oe.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email primary otp"),n}}async updateEmailSecondaryOtp(e){try{const n=await this.appEvent({type:oe.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(n.newEmail),n}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error updating email secondary otp"),n}}async syncTheme(e){try{return this.appEvent({type:oe.APP_SYNC_THEME,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing theme"),n}}async syncDappData(e){try{return this.appEvent({type:oe.APP_SYNC_DAPP_DATA,payload:e})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error syncing dapp data"),n}}async getSmartAccountEnabledNetworks(){try{const e=await this.appEvent({type:oe.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(e.smartAccountEnabledNetworks),e}catch(e){throw this.persistSmartAccountEnabledNetworks([]),this.w3mLogger?.logger.error({error:e},"Error getting smart account enabled networks"),e}}async setPreferredAccount(e){try{return this.appEvent({type:oe.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error setting preferred account"),n}}async connect(e){if(e?.socialUri)try{await this.init();const n=this.getRpcUrl(e.chainId),r=await this.appEvent({type:oe.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:n}});return r.userName&&this.setSocialLoginSuccess(r.userName),this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting social"),n}else try{const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.getUser({chainId:n,preferredAccountType:e?.preferredAccountType,siwxMessage:e?.siwxMessage,rpcUrl:this.getRpcUrl(n)});return this.setLoginSuccess(r.email),this.setLastUsedChainId(r.chainId),this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async getUser(e){try{await this.init();const n=e?.chainId||this.getLastUsedChainId()||1,r=await this.appEvent({type:oe.APP_GET_USER,payload:{...e,chainId:n,rpcUrl:this.getRpcUrl(n)}});return this.user=r,r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error connecting"),n}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){try{await this.init();const s=this.getRpcUrl(n),i=await this.appEvent({type:oe.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:s,preferredAccountType:r}});return i.userName&&this.setSocialLoginSuccess(i.userName),i}catch(s){throw this.w3mLogger?.logger.error({error:s},"Error connecting social"),s}}async getFarcasterUri(){try{return await this.init(),await this.appEvent({type:oe.APP_GET_FARCASTER_URI})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error getting farcaster uri"),e}}async connectFarcaster(){try{const e=await this.appEvent({type:oe.APP_CONNECT_FARCASTER});return e.userName&&this.setSocialLoginSuccess(e.userName),e}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error connecting farcaster"),e}}async switchNetwork({chainId:e}){try{const n=this.getRpcUrl(e),r=await this.appEvent({type:oe.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:n}});return this.setLastUsedChainId(r.chainId),r}catch(n){throw this.w3mLogger?.logger.error({error:n},"Error switching network"),n}}async disconnect(){try{return this.deleteAuthLoginCache(),await new Promise(async n=>{const r=setTimeout(()=>{n()},3e3);await this.appEvent({type:oe.APP_SIGN_OUT}),clearTimeout(r),n()})}catch(e){throw this.w3mLogger?.logger.error({error:e},"Error disconnecting"),e}}async request(e){const n=e;try{if(lt.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const r=e.chainNamespace||"eip155",s=this.getActiveCaipNetwork(r)?.id;n.chainNamespace=r,n.chainId=s,n.rpcUrl=this.getRpcUrl(s),this.rpcRequestHandler?.(e);const i=await this.appEvent({type:oe.APP_RPC_REQUEST,payload:n});return this.rpcSuccessHandler?.(i,n),i}catch(r){throw this.rpcErrorHandler?.(r,n),this.w3mLogger?.logger.error({error:r},"Error requesting"),r}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_IS_CONNECTED_ERROR&&e(),n.type===oe.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===oe.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===oe.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:lt.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){try{await Promise.all(Array.from(this.openRpcRequests.values()).map(async({abortController:e,method:n})=>{lt.SAFE_RPC_METHODS.includes(n)||e.abort(),await this.appEvent({type:oe.APP_RPC_ABORT})})),this.openRpcRequests.clear()}catch(e){this.w3mLogger?.logger.error({error:e},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[oe.APP_SYNC_DAPP_DATA,oe.APP_SYNC_THEME,oe.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{this.onTimeout?.("iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[oe.APP_CONNECT_EMAIL,oe.APP_CONNECT_DEVICE,oe.APP_CONNECT_OTP,oe.APP_CONNECT_SOCIAL,oe.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{this.onTimeout?.("iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{const u=Math.random().toString(36).substring(7);this.w3mLogger?.logger.info?.({event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const f=e;this.openRpcRequests.set(u,{...f.payload,abortController:d})}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});const h=(f,p)=>{f.id===u&&(p?.logger.info?.({framEvent:f,id:u},"Received frame response"),this.openRpcRequests.delete(f.id),f.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in f&&c(f.payload),c(void 0)):f.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in f&&l(new Error(f.payload?.message||"An error occurred")),l(new Error("An error occurred"))))};this.w3mFrame.events.registerFrameEventHandler(u,f=>h(f,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Pt.set(oe.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Pt.set(oe.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Pt.set(oe.EMAIL,e),Pt.set(oe.EMAIL_LOGIN_USED_KEY,"true"),Pt.delete(oe.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Pt.delete(oe.EMAIL_LOGIN_USED_KEY),Pt.delete(oe.EMAIL),Pt.delete(oe.LAST_USED_CHAIN_KEY),Pt.delete(oe.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Pt.set(oe.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Pt.get(oe.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Pt.set(oe.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=XM.parseCaipNetworkId(e)?.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getCaipNetworks(n);return(e?r.find(i=>String(i.id)===String(e)||i.caipNetworkId===e):r[0])?.rpcUrls.default.http?.[0]}}class si{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a}){return si.instance||(si.instance=new bF({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o,getCaipNetworks:a,enableCloudAuthAccount:!!F.state.remoteFeatures?.emailCapture})),si.instance}}var $y={};const EF={ACCOUNT_TABS:[{label:"Tokens"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof $y<"u"?$y.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120},VIEWS_WITH_LEGAL_FOOTER:["Connect","ConnectWallets","OnRampTokenSelect","OnRampFiatSelect","OnRampProviders"],VIEWS_WITH_DEFAULT_FOOTER:["Networks"]},_f={filterOutDuplicatesByRDNS(t){const e=F.state.enableEIP6963?K.state.connectors:[],n=j.getRecentWallets(),r=e.map(a=>a.info?.rdns).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&ee.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a?.rdns&&i.includes(String(a.rdns))||!a?.rdns&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=K.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=j.getRecentWallets(),r=e.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a?.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=K.state,{featuredWalletIds:n}=F.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>(a.info?.rdns&&(o[a.info.rdns]=!0),o),{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n?.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){const n=t?.connectMethodsOrder||F.state.features?.connectMethodsOrder,r=e||K.state.connectors;if(n)return n;const{injected:s,announced:i}=ml.getConnectorsByType(r,de.state.recommended,de.state.featured),o=s.filter(ml.showConnector),a=i.filter(ml.showConnector);return o.length||a.length?["wallet","email","social"]:EF.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&de.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&de.state.excludedWallets.some(r=>st.isLowerCaseMatch(r.name,t.name));return e||n},markWalletsWithDisplayIndex(t){return t.map((e,n)=>({...e,display_index:n}))}},ml={getConnectorsByType(t,e,n){const{customWallets:r}=F.state,s=j.getRecentWallets(),i=_f.filterOutDuplicateWallets(e),o=_f.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){const e=t.info?.rdns,n=!!e&&de.state.excludedWallets.some(s=>!!s.rdns&&s.rdns===e),r=!!t.name&&de.state.excludedWallets.some(s=>st.isLowerCaseMatch(s.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!ee.isMobile()||ee.isMobile()&&!e&&!X.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(_.state.chains.values()).some(n=>K.getConnectorId(n.namespace)===D.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=F.state.features?.connectorTypeOrder??[]}){const u=[{type:"walletConnect",isEnabled:!0},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(p=>p.isEnabled),d=new Set(u.map(p=>p.type)),h=c.filter(p=>d.has(p)).map(p=>({type:p,isEnabled:!0})),f=u.filter(({type:p})=>!h.some(({type:m})=>m===p));return Array.from(new Set([...h,...f].map(({type:p})=>p)))},sortConnectorsByExplorerWallet(t){return[...t].sort((e,n)=>e.explorerWallet&&n.explorerWallet?(e.explorerWallet.order??0)-(n.explorerWallet.order??0):e.explorerWallet?-1:n.explorerWallet?1:0)},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){try{if(t.name==="Browser Wallet"&&!ee.isMobile())return{accounts:[],chainId:void 0};if(t.id===D.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[e,n]=await Promise.all([t.provider?.request({method:"eth_accounts"}),t.provider?.request({method:"eth_chainId"}).then(r=>Number(r))]);return{accounts:e,chainId:n}}catch(e){return console.warn(`Failed to fetch provider data for ${t.name}`,e),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const yl=globalThis,Op=yl.ShadowRoot&&(yl.ShadyCSS===void 0||yl.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,kp=Symbol(),Uy=new WeakMap;let xv=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==kp)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(Op&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=Uy.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&Uy.set(n,e))}return e}toString(){return this.cssText}};const Yn=t=>new xv(typeof t=="string"?t:t+"",void 0,kp),bs=(t,...e)=>{const n=t.length===1?t[0]:e.reduce(((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1]),t[0]);return new xv(n,t,kp)},vF=(t,e)=>{if(Op)t.adoptedStyleSheets=e.map((n=>n instanceof CSSStyleSheet?n:n.styleSheet));else for(const n of e){const r=document.createElement("style"),s=yl.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},My=Op?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return Yn(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:CF,defineProperty:_F,getOwnPropertyDescriptor:AF,getOwnPropertyNames:IF,getOwnPropertySymbols:SF,getPrototypeOf:NF}=Object,Du=globalThis,Ly=Du.trustedTypes,TF=Ly?Ly.emptyScript:"",PF=Du.reactiveElementPolyfillSupport,ma=(t,e)=>t,Af={toAttribute(t,e){switch(e){case Boolean:t=t?TF:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},Rv=(t,e)=>!CF(t,e),By={attribute:!0,type:String,converter:Af,reflect:!1,useDefault:!1,hasChanged:Rv};Symbol.metadata??=Symbol("metadata"),Du.litPropertyMetadata??=new WeakMap;let Zi=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=By){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&_F(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=AF(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s?.call(this);i?.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??By}static _$Ei(){if(this.hasOwnProperty(ma("elementProperties")))return;const e=NF(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(ma("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(ma("properties"))){const n=this.properties,r=[...IF(n),...SF(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(My(s))}else e!==void 0&&n.push(My(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),this.renderRoot!==void 0&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return vF(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const i=(r.converter?.toAttribute!==void 0?r.converter:Af).toAttribute(n,r.type);this._$Em=e,i==null?this.removeAttribute(s):this.setAttribute(s,i),this._$Em=null}}_$AK(e,n){const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const i=r.getPropertyOptions(s),o=typeof i.converter=="function"?{fromAttribute:i.converter}:i.converter?.fromAttribute!==void 0?i.converter:Af;this._$Em=s;const a=o.fromAttribute(n,i.type);this[s]=a??this._$Ej?.get(s)??a,this._$Em=null}}requestUpdate(e,n,r){if(e!==void 0){const s=this.constructor,i=this[e];if(r??=s.getPropertyOptions(e),!((r.hasChanged??Rv)(i,n)||r.useDefault&&r.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(s._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[s,i]of this._$Ep)this[s]=i;this._$Ep=void 0}const r=this.constructor.elementProperties;if(r.size>0)for(const[s,i]of r){const{wrapped:o}=i,a=this[s];o!==!0||this._$AL.has(s)||a===void 0||this.C(s,void 0,i,a)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),this._$EO?.forEach((r=>r.hostUpdate?.())),this.update(n)):this._$EM()}catch(r){throw e=!1,this._$EM(),r}e&&this._$AE(n)}willUpdate(e){}_$AE(e){this._$EO?.forEach((n=>n.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach((n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};Zi.elementStyles=[],Zi.shadowRootOptions={mode:"open"},Zi[ma("elementProperties")]=new Map,Zi[ma("finalized")]=new Map,PF?.({ReactiveElement:Zi}),(Du.reactiveElementVersions??=[]).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Dp=globalThis,Ql=Dp.trustedTypes,Fy=Ql?Ql.createPolicy("lit-html",{createHTML:t=>t}):void 0,Ov="$lit$",Es=`lit$${Math.random().toFixed(9).slice(2)}$`,kv="?"+Es,xF=`<${kv}>`,yi=document,oc=()=>yi.createComment(""),ac=t=>t===null||typeof t!="object"&&typeof t!="function",$p=Array.isArray,RF=t=>$p(t)||typeof t?.[Symbol.iterator]=="function",Qd=`[ 	
\f\r]`,Jo=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,jy=/-->/g,Hy=/>/g,Fs=RegExp(`>|${Qd}(?:([^\\s"'>=/]+)(${Qd}*=${Qd}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),qy=/'/g,Wy=/"/g,Dv=/^(?:script|style|textarea|title)$/i,$v=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),LH=$v(1),BH=$v(2),yo=Symbol.for("lit-noChange"),vt=Symbol.for("lit-nothing"),zy=new WeakMap,ei=yi.createTreeWalker(yi,129);function Uv(t,e){if(!$p(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Fy!==void 0?Fy.createHTML(e):e}const OF=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=Jo;for(let a=0;a<n;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===Jo?u[1]==="!--"?o=jy:u[1]!==void 0?o=Hy:u[2]!==void 0?(Dv.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=Fs):u[3]!==void 0&&(o=Fs):o===Fs?u[0]===">"?(o=s??Jo,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?Fs:u[3]==='"'?Wy:qy):o===Wy||o===qy?o=Fs:o===jy||o===Hy?o=Jo:(o=Fs,s=void 0);const f=o===Fs&&t[a+1].startsWith("/>")?" ":"";i+=o===Jo?c+xF:d>=0?(r.push(l),c.slice(0,d)+Ov+c.slice(d)+Es+f):c+Es+(d===-2?a:f)}return[Uv(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class cc{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=OF(e,n);if(this.el=cc.createElement(l,r),ei.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=ei.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(Ov)){const h=u[o++],f=s.getAttribute(d).split(Es),p=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?DF:p[1]==="?"?$F:p[1]==="@"?UF:$u}),s.removeAttribute(d)}else d.startsWith(Es)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(Dv.test(s.tagName)){const d=s.textContent.split(Es),h=d.length-1;if(h>0){s.textContent=Ql?Ql.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],oc()),ei.nextNode(),c.push({type:2,index:++i});s.append(d[h],oc())}}}else if(s.nodeType===8)if(s.data===kv)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Es,d+1))!==-1;)c.push({type:7,index:i}),d+=Es.length-1}i++}}static createElement(e,n){const r=yi.createElement("template");return r.innerHTML=e,r}}function wo(t,e,n=t,r){if(e===yo)return e;let s=r!==void 0?n._$Co?.[r]:n._$Cl;const i=ac(e)?void 0:e._$litDirective$;return s?.constructor!==i&&(s?._$AO?.(!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??=[])[r]=s:n._$Cl=s),s!==void 0&&(e=wo(t,s._$AS(t,e.values),s,r)),e}class kF{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=(e?.creationScope??yi).importNode(n,!0);ei.currentNode=s;let i=ei.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new Ro(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new MF(i,this,e)),this._$AV.push(l),c=r[++a]}o!==c?.index&&(i=ei.nextNode(),o++)}return ei.currentNode=yi,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class Ro{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=vt,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=s?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&e?.nodeType===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=wo(this,e,n),ac(e)?e===vt||e==null||e===""?(this._$AH!==vt&&this._$AR(),this._$AH=vt):e!==this._$AH&&e!==yo&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):RF(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==vt&&ac(this._$AH)?this._$AA.nextSibling.data=e:this.T(yi.createTextNode(e)),this._$AH=e}$(e){const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=cc.createElement(Uv(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===s)this._$AH.p(n);else{const i=new kF(s,this),o=i.u(this.options);i.p(n),this.T(o),this._$AH=i}}_$AC(e){let n=zy.get(e.strings);return n===void 0&&zy.set(e.strings,n=new cc(e)),n}k(e){$p(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new Ro(this.O(oc()),this.O(oc()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){for(this._$AP?.(!1,!0,n);e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){this._$AM===void 0&&(this._$Cv=e,this._$AP?.(e))}}class $u{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=vt,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=vt}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=wo(this,e,n,0),o=!ac(e)||e!==this._$AH&&e!==yo,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=wo(this,a[r+c],n,c),l===yo&&(l=this._$AH[c]),o||=!ac(l)||l!==this._$AH[c],l===vt?e=vt:e!==vt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===vt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class DF extends $u{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===vt?void 0:e}}class $F extends $u{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==vt)}}class UF extends $u{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=wo(this,e,n,0)??vt)===yo)return;const r=this._$AH,s=e===vt&&r!==vt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==vt&&(r===vt||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){typeof this._$AH=="function"?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class MF{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){wo(this,e)}}const FH={I:Ro},LF=Dp.litHtmlPolyfillSupport;LF?.(cc,Ro),(Dp.litHtmlVersions??=[]).push("3.3.1");const BF=(t,e,n)=>{const r=n?.renderBefore??e;let s=r._$litPart$;if(s===void 0){const i=n?.renderBefore??null;r._$litPart$=s=new Ro(e.insertBefore(oc(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Up=globalThis;class wl extends Zi{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=BF(n,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return yo}}wl._$litElement$=!0,wl.finalized=!0,Up.litElementHydrateSupport?.({LitElement:wl});const FF=Up.litElementPolyfillSupport;FF?.({LitElement:wl});(Up.litElementVersions??=[]).push("4.2.1");const jF={black:"#202020",white:"#FFFFFF",white010:"rgba(255, 255, 255, 0.1)",accent010:"rgba(9, 136, 240, 0.1)",accent020:"rgba(9, 136, 240, 0.2)",accent030:"rgba(9, 136, 240, 0.3)",accent040:"rgba(9, 136, 240, 0.4)",accent050:"rgba(9, 136, 240, 0.5)",accent060:"rgba(9, 136, 240, 0.6)",accent070:"rgba(9, 136, 240, 0.7)",accent080:"rgba(9, 136, 240, 0.8)",accent090:"rgba(9, 136, 240, 0.9)",accent100:"rgba(9, 136, 240, 1.0)",accentSecondary010:"rgba(199, 185, 148, 0.1)",accentSecondary020:"rgba(199, 185, 148, 0.2)",accentSecondary030:"rgba(199, 185, 148, 0.3)",accentSecondary040:"rgba(199, 185, 148, 0.4)",accentSecondary050:"rgba(199, 185, 148, 0.5)",accentSecondary060:"rgba(199, 185, 148, 0.6)",accentSecondary070:"rgba(199, 185, 148, 0.7)",accentSecondary080:"rgba(199, 185, 148, 0.8)",accentSecondary090:"rgba(199, 185, 148, 0.9)",accentSecondary100:"rgba(199, 185, 148, 1.0)",productWalletKit:"#FFB800",productAppKit:"#FF573B",productCloud:"#0988F0",productDocumentation:"#008847",neutrals050:"#F6F6F6",neutrals100:"#F3F3F3",neutrals200:"#E9E9E9",neutrals300:"#D0D0D0",neutrals400:"#BBB",neutrals500:"#9A9A9A",neutrals600:"#6C6C6C",neutrals700:"#4F4F4F",neutrals800:"#363636",neutrals900:"#2A2A2A",neutrals1000:"#252525",semanticSuccess010:"rgba(48, 164, 107, 0.1)",semanticSuccess020:"rgba(48, 164, 107, 0.2)",semanticSuccess030:"rgba(48, 164, 107, 0.3)",semanticSuccess040:"rgba(48, 164, 107, 0.4)",semanticSuccess050:"rgba(48, 164, 107, 0.5)",semanticSuccess060:"rgba(48, 164, 107, 0.6)",semanticSuccess070:"rgba(48, 164, 107, 0.7)",semanticSuccess080:"rgba(48, 164, 107, 0.8)",semanticSuccess090:"rgba(48, 164, 107, 0.9)",semanticSuccess100:"rgba(48, 164, 107, 1.0)",semanticError010:"rgba(223, 74, 52, 0.1)",semanticError020:"rgba(223, 74, 52, 0.2)",semanticError030:"rgba(223, 74, 52, 0.3)",semanticError040:"rgba(223, 74, 52, 0.4)",semanticError050:"rgba(223, 74, 52, 0.5)",semanticError060:"rgba(223, 74, 52, 0.6)",semanticError070:"rgba(223, 74, 52, 0.7)",semanticError080:"rgba(223, 74, 52, 0.8)",semanticError090:"rgba(223, 74, 52, 0.9)",semanticError100:"rgba(223, 74, 52, 1.0)",semanticWarning010:"rgba(243, 161, 63, 0.1)",semanticWarning020:"rgba(243, 161, 63, 0.2)",semanticWarning030:"rgba(243, 161, 63, 0.3)",semanticWarning040:"rgba(243, 161, 63, 0.4)",semanticWarning050:"rgba(243, 161, 63, 0.5)",semanticWarning060:"rgba(243, 161, 63, 0.6)",semanticWarning070:"rgba(243, 161, 63, 0.7)",semanticWarning080:"rgba(243, 161, 63, 0.8)",semanticWarning090:"rgba(243, 161, 63, 0.9)",semanticWarning100:"rgba(243, 161, 63, 1.0)"},eu={core:{backgroundAccentPrimary:"#0988F0",backgroundAccentCertified:"#C7B994",backgroundWalletKit:"#FFB800",backgroundAppKit:"#FF573B",backgroundCloud:"#0988F0",backgroundDocumentation:"#008847",backgroundSuccess:"rgba(48, 164, 107, 0.20)",backgroundError:"rgba(223, 74, 52, 0.20)",backgroundWarning:"rgba(243, 161, 63, 0.20)",textAccentPrimary:"#0988F0",textAccentCertified:"#C7B994",textWalletKit:"#FFB800",textAppKit:"#FF573B",textCloud:"#0988F0",textDocumentation:"#008847",textSuccess:"#30A46B",textError:"#DF4A34",textWarning:"#F3A13F",borderAccentPrimary:"#0988F0",borderSecondary:"#C7B994",borderSuccess:"#30A46B",borderError:"#DF4A34",borderWarning:"#F3A13F",foregroundAccent010:"rgba(9, 136, 240, 0.1)",foregroundAccent020:"rgba(9, 136, 240, 0.2)",foregroundAccent040:"rgba(9, 136, 240, 0.4)",foregroundAccent060:"rgba(9, 136, 240, 0.6)",foregroundSecondary020:"rgba(199, 185, 148, 0.2)",foregroundSecondary040:"rgba(199, 185, 148, 0.4)",foregroundSecondary060:"rgba(199, 185, 148, 0.6)",iconAccentPrimary:"#0988F0",iconAccentCertified:"#C7B994",iconSuccess:"#30A46B",iconError:"#DF4A34",iconWarning:"#F3A13F",glass010:"rgba(255, 255, 255, 0.1)",zIndex:"9999"},dark:{overlay:"rgba(0, 0, 0, 0.50)",backgroundPrimary:"#202020",backgroundInvert:"#FFFFFF",textPrimary:"#FFFFFF",textSecondary:"#9A9A9A",textTertiary:"#BBBBBB",textInvert:"#202020",borderPrimary:"#2A2A2A",borderPrimaryDark:"#363636",borderSecondary:"#4F4F4F",foregroundPrimary:"#252525",foregroundSecondary:"#2A2A2A",foregroundTertiary:"#363636",iconDefault:"#9A9A9A",iconInverse:"#FFFFFF"},light:{overlay:"rgba(230 , 230, 230, 0.5)",backgroundPrimary:"#FFFFFF",borderPrimaryDark:"#E9E9E9",backgroundInvert:"#202020",textPrimary:"#202020",textSecondary:"#9A9A9A",textTertiary:"#6C6C6C",textInvert:"#FFFFFF",borderPrimary:"#E9E9E9",borderSecondary:"#D0D0D0",foregroundPrimary:"#F3F3F3",foregroundSecondary:"#E9E9E9",foregroundTertiary:"#D0D0D0",iconDefault:"#9A9A9A",iconInverse:"#202020"}},HF={1:"4px",2:"8px",10:"10px",3:"12px",4:"16px",6:"24px",5:"20px",8:"32px",16:"64px",20:"80px",32:"128px",64:"256px",128:"512px",round:"9999px"},qF={0:"0px","01":"2px",1:"4px",2:"8px",3:"12px",4:"16px",5:"20px",6:"24px",7:"28px",8:"32px",9:"36px",10:"40px",12:"48px",14:"56px",16:"64px",20:"80px",32:"128px",64:"256px"},WF={regular:"KHTeka",mono:"KHTekaMono"},zF={regular:"400",medium:"500"},VF={h1:"50px",h2:"44px",h3:"38px",h4:"32px",h5:"26px",h6:"20px",large:"16px",medium:"14px",small:"12px"},KF={"h1-regular-mono":{lineHeight:"50px",letterSpacing:"-3px"},"h1-regular":{lineHeight:"50px",letterSpacing:"-1px"},"h1-medium":{lineHeight:"50px",letterSpacing:"-0.84px"},"h2-regular-mono":{lineHeight:"44px",letterSpacing:"-2.64px"},"h2-regular":{lineHeight:"44px",letterSpacing:"-0.88px"},"h2-medium":{lineHeight:"44px",letterSpacing:"-0.88px"},"h3-regular-mono":{lineHeight:"38px",letterSpacing:"-2.28px"},"h3-regular":{lineHeight:"38px",letterSpacing:"-0.76px"},"h3-medium":{lineHeight:"38px",letterSpacing:"-0.76px"},"h4-regular-mono":{lineHeight:"32px",letterSpacing:"-1.92px"},"h4-regular":{lineHeight:"32px",letterSpacing:"-0.32px"},"h4-medium":{lineHeight:"32px",letterSpacing:"-0.32px"},"h5-regular-mono":{lineHeight:"26px",letterSpacing:"-1.56px"},"h5-regular":{lineHeight:"26px",letterSpacing:"-0.26px"},"h5-medium":{lineHeight:"26px",letterSpacing:"-0.26px"},"h6-regular-mono":{lineHeight:"20px",letterSpacing:"-1.2px"},"h6-regular":{lineHeight:"20px",letterSpacing:"-0.6px"},"h6-medium":{lineHeight:"20px",letterSpacing:"-0.6px"},"lg-regular-mono":{lineHeight:"16px",letterSpacing:"-0.96px"},"lg-regular":{lineHeight:"18px",letterSpacing:"-0.16px"},"lg-medium":{lineHeight:"18px",letterSpacing:"-0.16px"},"md-regular-mono":{lineHeight:"14px",letterSpacing:"-0.84px"},"md-regular":{lineHeight:"16px",letterSpacing:"-0.14px"},"md-medium":{lineHeight:"16px",letterSpacing:"-0.14px"},"sm-regular-mono":{lineHeight:"12px",letterSpacing:"-0.72px"},"sm-regular":{lineHeight:"14px",letterSpacing:"-0.12px"},"sm-medium":{lineHeight:"14px",letterSpacing:"-0.12px"}},GF={"ease-out-power-2":"cubic-bezier(0.23, 0.09, 0.08, 1.13)","ease-out-power-1":"cubic-bezier(0.12, 0.04, 0.2, 1.06)","ease-in-power-2":"cubic-bezier(0.92, -0.13, 0.77, 0.91)","ease-in-power-1":"cubic-bezier(0.88, -0.06, 0.8, 0.96)","ease-inout-power-2":"cubic-bezier(0.77, 0.09, 0.23, 1.13)","ease-inout-power-1":"cubic-bezier(0.88, 0.04, 0.12, 1.06)"},YF={xl:"400ms",lg:"200ms",md:"125ms",sm:"75ms"},If={colors:jF,fontFamily:WF,fontWeight:zF,textSize:VF,typography:KF,tokens:{core:eu.core,theme:eu.dark},borderRadius:HF,spacing:qF,durations:YF,easings:GF},Vy="--apkt",Hr={createCSSVariables(t){const e={},n={};function r(i,o,a=""){for(const[c,l]of Object.entries(i)){const u=a?`${a}-${c}`:c;l&&typeof l=="object"&&Object.keys(l).length?(o[c]={},r(l,o[c],u)):typeof l=="string"&&(o[c]=`${Vy}-${u}`)}}function s(i,o){for(const[a,c]of Object.entries(i))c&&typeof c=="object"?(o[a]={},s(c,o[a])):typeof c=="string"&&(o[a]=`var(${c})`)}return r(t,e),s(e,n),{cssVariables:e,cssVariablesVarPrefix:n}},assignCSSVariables(t,e){const n={};function r(s,i,o){for(const[a,c]of Object.entries(s)){const l=o?`${o}-${a}`:a,u=i[a];c&&typeof c=="object"?r(c,u,l):typeof u=="string"&&(n[`${Vy}-${l}`]=u)}}return r(t,e),n},createRootStyles(t,e){const n={...If,tokens:{...If.tokens,theme:t==="light"?eu.light:eu.dark}},{cssVariables:r}=Hr.createCSSVariables(n),s=Hr.assignCSSVariables(r,n),i=Hr.generateW3MVariables(e),o=Hr.generateW3MOverrides(e),a=Hr.generateScaledVariables(e),c=Hr.generateBaseVariables(s),l={...s,...c,...i,...o,...a},u=Hr.applyColorMixToVariables(e,l),d={...l,...u};return`:root {${Object.entries(d).map(([f,p])=>`${f}:${p.replace("/[:;{}</>]/g","")};`).join("")}}`},generateW3MVariables(t){if(!t)return{};const e={};return e["--w3m-font-family"]=t["--w3m-font-family"]||"KHTeka",e["--w3m-accent"]=t["--w3m-accent"]||"#0988F0",e["--w3m-color-mix"]=t["--w3m-color-mix"]||"#000",e["--w3m-color-mix-strength"]=`${t["--w3m-color-mix-strength"]||0}%`,e["--w3m-font-size-master"]=t["--w3m-font-size-master"]||"10px",e["--w3m-border-radius-master"]=t["--w3m-border-radius-master"]||"4px",e},generateW3MOverrides(t){if(!t)return{};const e={};if(t["--w3m-accent"]){const n=t["--w3m-accent"];e["--apkt-tokens-core-iconAccentPrimary"]=n,e["--apkt-tokens-core-borderAccentPrimary"]=n,e["--apkt-tokens-core-textAccentPrimary"]=n,e["--apkt-tokens-core-backgroundAccentPrimary"]=n}return t["--w3m-font-family"]&&(e["--apkt-fontFamily-regular"]=t["--w3m-font-family"]),t["--w3m-z-index"]&&(e["--apkt-tokens-core-zIndex"]=`${t["--w3m-z-index"]}`),e},generateScaledVariables(t){if(!t)return{};const e={};if(t["--w3m-font-size-master"]){const n=parseFloat(t["--w3m-font-size-master"].replace("px",""));e["--apkt-textSize-h1"]=`${Number(n)*5}px`,e["--apkt-textSize-h2"]=`${Number(n)*4.4}px`,e["--apkt-textSize-h3"]=`${Number(n)*3.8}px`,e["--apkt-textSize-h4"]=`${Number(n)*3.2}px`,e["--apkt-textSize-h5"]=`${Number(n)*2.6}px`,e["--apkt-textSize-h6"]=`${Number(n)*2}px`,e["--apkt-textSize-large"]=`${Number(n)*1.6}px`,e["--apkt-textSize-medium"]=`${Number(n)*1.4}px`,e["--apkt-textSize-small"]=`${Number(n)*1.2}px`}if(t["--w3m-border-radius-master"]){const n=parseFloat(t["--w3m-border-radius-master"].replace("px",""));e["--apkt-borderRadius-1"]=`${Number(n)}px`,e["--apkt-borderRadius-2"]=`${Number(n)*2}px`,e["--apkt-borderRadius-3"]=`${Number(n)*3}px`,e["--apkt-borderRadius-4"]=`${Number(n)*4}px`,e["--apkt-borderRadius-5"]=`${Number(n)*5}px`,e["--apkt-borderRadius-6"]=`${Number(n)*6}px`,e["--apkt-borderRadius-8"]=`${Number(n)*8}px`,e["--apkt-borderRadius-16"]=`${Number(n)*16}px`,e["--apkt-borderRadius-20"]=`${Number(n)*20}px`,e["--apkt-borderRadius-32"]=`${Number(n)*32}px`,e["--apkt-borderRadius-64"]=`${Number(n)*64}px`,e["--apkt-borderRadius-128"]=`${Number(n)*128}px`}return e},generateColorMixCSS(t,e){if(!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return"";const n=t["--w3m-color-mix"],r=t["--w3m-color-mix-strength"];if(!r||r===0)return"";const s=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return s.length===0?"":` @supports (background: color-mix(in srgb, white 50%, black)) {
      :root {
        ${s.map(o=>{const a=e?.[o]||"";return a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?`${o}: color-mix(in srgb, ${n} ${r}%, ${a});`:`${o}: color-mix(in srgb, ${n} ${r}%, var(${o}-base, ${a}));`}).join("")}
      }
    }`},generateBaseVariables(t){const e={},n=t["--apkt-tokens-theme-backgroundPrimary"];n&&(e["--apkt-tokens-theme-backgroundPrimary-base"]=n);const r=t["--apkt-tokens-core-backgroundAccentPrimary"];return r&&(e["--apkt-tokens-core-backgroundAccentPrimary-base"]=r),e},applyColorMixToVariables(t,e){const n={};if(e?.["--apkt-tokens-theme-backgroundPrimary"]&&(n["--apkt-tokens-theme-backgroundPrimary"]="var(--apkt-tokens-theme-backgroundPrimary-base)"),e?.["--apkt-tokens-core-backgroundAccentPrimary"]&&(n["--apkt-tokens-core-backgroundAccentPrimary"]="var(--apkt-tokens-core-backgroundAccentPrimary-base)"),!t?.["--w3m-color-mix"]||!t["--w3m-color-mix-strength"])return n;const r=t["--w3m-color-mix"],s=t["--w3m-color-mix-strength"];if(!s||s===0)return n;const i=Object.keys(e||{}).filter(o=>{const a=o.includes("-tokens-core-background")||o.includes("-tokens-core-text")||o.includes("-tokens-core-border")||o.includes("-tokens-core-foreground")||o.includes("-tokens-core-icon")||o.includes("-tokens-theme-background")||o.includes("-tokens-theme-text")||o.includes("-tokens-theme-border")||o.includes("-tokens-theme-foreground")||o.includes("-tokens-theme-icon")||o.includes("-tokens-theme-overlay"),c=o.includes("-borderRadius-")||o.includes("-spacing-")||o.includes("-textSize-")||o.includes("-fontFamily-")||o.includes("-fontWeight-")||o.includes("-typography-")||o.includes("-duration-")||o.includes("-ease-")||o.includes("-path-")||o.includes("-width-")||o.includes("-height-")||o.includes("-visual-size-")||o.includes("-modal-width")||o.includes("-cover");return a&&!c});return i.length===0||i.forEach(o=>{const a=e?.[o]||"";o.endsWith("-base")||(o==="--apkt-tokens-theme-backgroundPrimary"||o==="--apkt-tokens-core-backgroundAccentPrimary"?n[o]=`color-mix(in srgb, ${r} ${s}%, var(${o}-base))`:a.includes("color-mix")||a.startsWith("#")||a.startsWith("rgb")?n[o]=`color-mix(in srgb, ${r} ${s}%, ${a})`:n[o]=`color-mix(in srgb, ${r} ${s}%, var(${o}-base, ${a}))`)}),n}},{cssVariablesVarPrefix:ZF}=Hr.createCSSVariables(If);function jH(t,...e){return bs(t,...e.map(n=>Yn(typeof n=="function"?n(ZF):n)))}let Vs,ti,br,Jn,tu;const Fr={"KHTeka-500-woff2":"https://fonts.reown.com/KHTeka-Medium.woff2","KHTeka-400-woff2":"https://fonts.reown.com/KHTeka-Regular.woff2","KHTeka-300-woff2":"https://fonts.reown.com/KHTeka-Light.woff2","KHTekaMono-400-woff2":"https://fonts.reown.com/KHTekaMono-Regular.woff2","KHTeka-500-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTeka-400-woff":"https://fonts.reown.com/KHTeka-Regular.woff","KHTeka-300-woff":"https://fonts.reown.com/KHTeka-Light.woff","KHTekaMono-400-woff":"https://fonts.reown.com/KHTekaMono-Regular.woff"};function nu(t,e="dark"){Vs&&document.head.removeChild(Vs),Vs=document.createElement("style"),Vs.textContent=Hr.createRootStyles(e,t),document.head.appendChild(Vs)}function HH(t,e="dark"){if(tu=t,ti=document.createElement("style"),br=document.createElement("style"),Jn=document.createElement("style"),ti.textContent=ro(t).core.cssText,br.textContent=ro(t).dark.cssText,Jn.textContent=ro(t).light.cssText,document.head.appendChild(ti),document.head.appendChild(br),document.head.appendChild(Jn),nu(t,e),Sf(e),!t?.["--w3m-font-family"])for(const[n,r]of Object.entries(Fr)){const s=document.createElement("link");s.rel="preload",s.href=r,s.as="font",s.type=n.includes("woff2")?"font/woff2":"font/woff",s.crossOrigin="anonymous",document.head.appendChild(s)}Sf(e)}function Sf(t="dark"){br&&Jn&&Vs&&(t==="light"?(nu(tu,t),br.removeAttribute("media"),Jn.media="enabled"):(nu(tu,t),Jn.removeAttribute("media"),br.media="enabled"))}function JF(t){if(tu=t,ti&&br&&Jn&&(ti.textContent=ro(t).core.cssText,br.textContent=ro(t).dark.cssText,Jn.textContent=ro(t).light.cssText,t?.["--w3m-font-family"])){const e=t["--w3m-font-family"];ti.textContent=ti.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),br.textContent=br.textContent?.replace("font-family: KHTeka",`font-family: ${e}`),Jn.textContent=Jn.textContent?.replace("font-family: KHTeka",`font-family: ${e}`)}if(Vs){const e=Jn?.media==="enabled"?"light":"dark";nu(t,e)}}function ro(t){const e=!!t?.["--w3m-font-family"];return{core:bs`
      ${e?bs``:bs`
            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Yn(Fr["KHTeka-400-woff2"])}) format('woff2'),
                url(${Yn(Fr["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
              font-display: swap;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Yn(Fr["KHTeka-300-woff2"])}) format('woff2'),
                url(${Yn(Fr["KHTeka-300-woff"])}) format('woff');
              font-weight: 300;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTekaMono';
              src:
                url(${Yn(Fr["KHTekaMono-400-woff2"])}) format('woff2'),
                url(${Yn(Fr["KHTekaMono-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }

            @font-face {
              font-family: 'KHTeka';
              src:
                url(${Yn(Fr["KHTeka-400-woff2"])}) format('woff2'),
                url(${Yn(Fr["KHTeka-400-woff"])}) format('woff');
              font-weight: 400;
              font-style: normal;
            }
          `}

      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --apkt-modal-width: 370px;

        --apkt-visual-size-inherit: inherit;
        --apkt-visual-size-sm: 40px;
        --apkt-visual-size-md: 55px;
        --apkt-visual-size-lg: 80px;

        --apkt-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --apkt-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --apkt-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --apkt-width-network-sm: 36px;
        --apkt-width-network-md: 48px;
        --apkt-width-network-lg: 86px;

        --apkt-duration-dynamic: 0ms;
        --apkt-height-network-sm: 40px;
        --apkt-height-network-md: 54px;
        --apkt-height-network-lg: 96px;
      }
    `,dark:bs`
      :root {
      }
    `,light:bs`
      :root {
      }
    `}}const qH=bs`
  div,
  span,
  iframe,
  a,
  img,
  form,
  button,
  label,
  *::after,
  *::before {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    backface-visibility: hidden;
  }

  :host {
    font-family: var(--apkt-fontFamily-regular);
  }
`,WH=bs`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;

    will-change: background-color, color, border, box-shadow, width, height, transform, opacity;
    outline: none;
    border: none;
    text-decoration: none;
    transition:
      background-color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      color var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      box-shadow var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      width var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      height var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      transform var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      opacity var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      scale var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2),
      border-radius var(--apkt-durations-lg) var(--apkt-easings-ease-out-power-2);
    will-change:
      background-color, color, border, box-shadow, width, height, transform, opacity, scale,
      border-radius;
  }

  a:active:not([disabled]),
  button:active:not([disabled]) {
    scale: 0.975;
    transform-origin: center;
  }

  button:disabled {
    cursor: default;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,bl={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([bl.getAddresses(t),bl.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){const n=e.rpcUrls.chainDefault?.http||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:bl.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[e.blockExplorers?.default.url],iconUrls:[yn.NetworkImageIds[e.id]]}]})}},Ki={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},zH=A2({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},blockTime:12e3,rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensUniversalResolver:{address:"0xeeeeeeee14d718c2b47d9923deab1335e144eeee",blockCreated:23085558},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function Oo(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const Ky=Oo({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),Gy=Oo({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});Oo({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});Oo({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});Oo({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});Oo({id:"00000008819873e925422c1ff0f99f7c",caipNetworkId:"bip122:00000008819873e925422c1ff0f99f7c",chainNamespace:"bip122",name:"Bitcoin Signet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const XF={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},$n={RPC_ERROR_CODE:{USER_REJECTED:5e3,USER_REJECTED_METHODS:5002},getMethodsByChainNamespace(t){return XF[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case Ky.caipNetworkId:u.chains.push(Ky.deprecatedCaipNetworkId);break;case Gy.caipNetworkId:u.chains.push(Gy.deprecatedCaipNetworkId);break}return u?.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{const e=await oa.resolveName(t);return(Object.values(e?.addresses)||[])[0]?.address||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isUserRejectedRequestError(t){try{if(typeof t=="object"&&t!==null){const e=t,n=typeof e.code=="number",r=n&&e.code===$n.RPC_ERROR_CODE.USER_REJECTED_METHODS,s=n&&e.code===$n.RPC_ERROR_CODE.USER_REJECTED;return r||s}return!1}catch{return!1}},isOriginAllowed(t,e,n){for(const r of[...e,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(r).origin===t)return!0}catch{if(r===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=$n.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("accountsChanged",a=>{try{const c=t.session?.namespaces?.[e]?.accounts||[],l=t.rpcProviders?.[e]?.getDefaultChain(),u=a.map(d=>{const h=c.find(g=>g.includes(`${e}:${l}:${d}`));if(!h)return;const{chainId:f,chainNamespace:p}=xt.parseCaipAddress(h);return{address:d,chainId:f,chainNamespace:p}}).filter(d=>d!==void 0);u.length>0&&s(u)}catch(c){console.warn("Failed to parse accounts for namespace on accountsChanged event",e,a,c)}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){const n=new Set,r=t?.session?.namespaces?.[e]?.accounts?.map(s=>xt.parseCaipAddress(s)).filter(({address:s})=>n.has(s.toLowerCase())?!1:(n.add(s.toLowerCase()),!0));return r&&r.length>0?r:[]}};class QF{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case D.CHAIN.EVM:await this.syncEVMConnections(e);break;case D.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case D.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:a,hasConnected:c}=st.getConnectorStorageInfo(o.id,this.namespace);return!a&&c}).map(async o=>{if(o.id===D.CONNECTOR_ID.WALLET_CONNECT){const a=$n.getWalletConnectAccounts(r,this.namespace),c=n.find(l=>l.chainNamespace===this.namespace&&l.id.toString()===a[0]?.chainId?.toString());a.length>0&&s({connectorId:o.id,accounts:a.map(l=>({address:l.address})),caipNetwork:c})}else{const{accounts:a,chainId:c}=await ml.fetchProviderData(o);if(a.length>0&&c){const l=n.find(u=>u.chainNamespace===this.namespace&&u.id.toString()===c.toString());s({connectorId:o.id,accounts:a.map(u=>({address:u})),caipNetwork:l}),o.provider&&o.id!==D.CONNECTOR_ID.AUTH&&o.id!==D.CONNECTOR_ID.WALLET_CONNECT&&i(o.id,o.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:a,hasConnected:c}=st.getConnectorStorageInfo(o.id,this.namespace);return!a&&c}).map(async o=>{if(o.id===D.CONNECTOR_ID.WALLET_CONNECT){const a=$n.getWalletConnectAccounts(r,this.namespace);a.length>0&&s({connectorId:o.id,accounts:a.map(c=>({address:c.address})),caipNetwork:n})}else{const a=await o.connect({chainId:n?.id});a&&(s({connectorId:o.id,accounts:[{address:a}],caipNetwork:n}),i(o.id,o.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:n,universalProvider:r,onConnection:s,onListenProvider:i}){await Promise.all(e.filter(o=>{const{hasDisconnected:a,hasConnected:c}=st.getConnectorStorageInfo(o.id,this.namespace);return!a&&c}).map(async o=>{if(o.id===D.CONNECTOR_ID.WALLET_CONNECT){const d=$n.getWalletConnectAccounts(r,this.namespace);d.length>0&&s({connectorId:o.id,accounts:d.map(h=>({address:h.address})),caipNetwork:n});return}const a=await o.connect();let l=(await o.getAccountAddresses())?.map(d=>ee.createAccount(D.CHAIN.BITCOIN,d.address,d.purpose||"payment",d.publicKey,d.path));if(l&&l.length>1&&(l=[{namespace:D.CHAIN.BITCOIN,publicKey:l[Ki.ACCOUNT_INDEXES.PAYMENT]?.publicKey??"",path:l[Ki.ACCOUNT_INDEXES.PAYMENT]?.path??"",address:l[Ki.ACCOUNT_INDEXES.PAYMENT]?.address??"",type:"payment"},{namespace:D.CHAIN.BITCOIN,publicKey:l[Ki.ACCOUNT_INDEXES.ORDINAL]?.publicKey??"",path:l[Ki.ACCOUNT_INDEXES.ORDINAL]?.path??"",address:l[Ki.ACCOUNT_INDEXES.ORDINAL]?.address??"",type:"ordinal"}]),!(o.chains.find(d=>d.id===n?.id)||o.chains[0]))throw new Error("The connector does not support any of the requested chains");a&&(i(o.id,o.provider),s({connectorId:o.id,accounts:l.map(d=>({address:d.address,type:d.type,publicKey:d.publicKey,path:d.path})),caipNetwork:n}))}))}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>st.isLowerCaseMatch(l.connectorId,n));if(!o)return null;const a=s.find(l=>st.isLowerCaseMatch(l.id,o.connectorId)),c=e?o.accounts.find(l=>st.isLowerCaseMatch(l.address,e)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>st.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>st.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const ra={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class Mp{constructor({provider:e,namespace:n}){this.id=D.CONNECTOR_ID.WALLET_CONNECT,this.name=yn.ConnectorNamesMap[D.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=yn.ConnectorImageIds[D.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=_.getCaipNetworks.bind(_),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=F.state.universalProviderConfigOverride,s=$n.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return On.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:e7})}}const e7=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],t7=[D.CONNECTOR_ID.AUTH,D.CONNECTOR_ID.WALLET_CONNECT];class Mv{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>_.getCaipNetworks(n),this.getConnectorId=n=>K.getConnectorId(n),e&&this.construct(e),e?.namespace&&(this.connectionManager=new QF({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===n?.toString());e&&r&&this.addConnection({connectorId:D.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:D.CONNECTOR_ID.AUTH,type:"AUTH",name:D.CONNECTOR_NAMES.AUTH,provider:e,imageId:yn.ConnectorImageIds[D.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>!st.isLowerCaseMatch(n.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){_.setAccountProp("status",e,n)}on(e,n){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){try{return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}catch(n){throw $n.isUserRejectedRequestError(n)?new Ji(n):n}}async switchNetwork(e){const{caipNetwork:n,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=qt(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n instanceof Mp);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=ee.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===s?.toString()),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=ee.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){if(e.length>0){const{address:s}=ee.getAccount(e[0]),i=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});s&&st.isLowerCaseMatch(this.getConnectorId(D.CHAIN.EVM),n)&&this.emit("accountChanged",{address:s,chainId:i?.caipNetwork?.id,connector:i?.connector}),this.addConnection({connectorId:n,accounts:e.map(o=>{const{address:a}=ee.getAccount(o);return{address:a}}),caipNetwork:i?.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),st.isLowerCaseMatch(this.getConnectorId(D.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){const r=typeof e=="string"&&e.startsWith("0x")?bl.hexStringToNumber(e).toString():e.toString(),s=this.connectionManager?.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(o=>o.chainNamespace===this.namespace).find(o=>o.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),st.isLowerCaseMatch(this.getConnectorId(D.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(t7.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){const e=this.connectionManager?.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[n]=e.accounts;this.emit("accountChanged",{address:n?.address,chainId:e.caipNetwork?.id,connector:e.connector})}}}class n7 extends Mv{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new Mp({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){const r=this.provider?.session?.namespaces?.[e]?.accounts?.map(s=>{const[,,i]=s.split(":");return i}).filter((s,i,o)=>o.indexOf(s)===i)||[];return Promise.resolve({accounts:r.map(s=>ee.createAccount(e,s,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&Pe.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};const r=_.getAccountData();if(r?.balanceLoading&&e.chainId===_.state.activeCaipNetwork?.id)return{balance:r?.balance||"0.00",symbol:r?.balanceSymbol||""};const i=(await _.fetchTokenBalance()).find(o=>o.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&o.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:i?.quantity.numeric||"0.00",symbol:i?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return _.state.activeCaipNetwork?.chainNamespace===D.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:So.encode(new TextEncoder().encode(r)),pubkey:s}},_.state.activeCaipNetwork?.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},_.state.activeCaipNetwork?.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===D.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:oo(n.id)}]})}catch(s){if(s.code===ra.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||s.code===ra.ERROR_INVALID_CHAIN_ID||s.code===ra.ERROR_CODE_DEFAULT||s?.data?.originalError?.code===ra.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:oo(n.id),rpcUrls:[n?.rpcUrls.chainDefault?.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[n.blockExplorers?.default.url]}]})}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){return this.connectors.find(r=>r.type==="WALLET_CONNECT")?.provider}}const r7=["email","socials","swaps","onramp","activity","reownBranding","multiWallet","emailCapture","payWithExchange","payments","reownAuthentication"],nl={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?Pe.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?Pe.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!t?.config)return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?Pe.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?Pe.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},emailCapture:{apiFeatureName:"email_capture",localFeatureName:"emailCapture",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>t.isEnabled&&(t.config??[]),processFallback:t=>!1},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.multiWallet},payWithExchange:{apiFeatureName:"fund_from_exchange",localFeatureName:"payWithExchange",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.payWithExchange},payments:{apiFeatureName:"payments",localFeatureName:"payments",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>Pe.DEFAULT_REMOTE_FEATURES.payments},reownAuthentication:{apiFeatureName:"reown_authentication",localFeatureName:"reownAuthentication",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>typeof t>"u"?Pe.DEFAULT_REMOTE_FEATURES.reownAuthentication:!!t}},s7={localSettingsOverridden:new Set,getApiConfig(t,e){return e?.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=nl[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=nl[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return a?.config===null?this.processFallbackFeature(t,o):a?.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return nl[t].processApi(e)},processFallbackFeature(t,e){return nl[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await de.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?Pe.DEFAULT_REMOTE_FEATURES:Pe.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of r7){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),Pe.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;rt.open({debugMessage:et.ALERT_WARNINGS.LOCAL_CONFIGURATION_IGNORED.debugMessage(o)},"warning")}return i}};class i7{constructor(e){this.chainNamespaces=[],this.features={},this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{if(n){const s=_.getCaipNetworks(n)?.find(a=>a.id===r);if(s)return s;const i=_.getNetworkData(n)?.caipNetwork;return i||_.getRequestedCaipNetworks(n).filter(a=>a.chainNamespace===n)?.[0]}return _.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>_.getCaipNetworks(n),this.getActiveChainNamespace=()=>_.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{_.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>_.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>_.state.activeChain===n||!n?_.state.activeCaipAddress:_.state.chains.get(n)?.accountState?.caipAddress,this.setClientId=n=>{ge.setClientId(n)},this.getProvider=n=>He.getProvider(n),this.getProviderType=n=>He.getProviderId(n),this.getPreferredAccountType=n=>qt(n),this.setCaipAddress=(n,r,s=!1)=>{_.setAccountProp("caipAddress",n,r,s),_.setAccountProp("address",ee.getPlainAddress(n),r,s)},this.setBalance=(n,r,s)=>{_.setAccountProp("balance",n,s),_.setAccountProp("balanceSymbol",r,s)},this.setProfileName=(n,r)=>{_.setAccountProp("profileName",n,r)},this.setProfileImage=(n,r)=>{_.setAccountProp("profileImage",n,r)},this.setUser=(n,r)=>{_.setAccountProp("user",n,r)},this.resetAccount=n=>{_.resetAccount(n)},this.setCaipNetwork=n=>{_.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{_.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{_.setAccountProp("status",n,r),K.isConnected()?j.setConnectionStatus("connected"):j.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>_.getAccountData(n)?.address,this.setConnectors=n=>{const r=[...K.state.allConnectors,...n];K.setConnectors(r)},this.setConnections=(n,r)=>{j.setConnections(n,r),X.setConnections(n,r)},this.fetchIdentity=n=>ge.fetchIdentity(n),this.getReownName=n=>oa.getNamesForAddress(n),this.getConnectors=()=>K.getConnectors(),this.getConnectorImage=n=>$b.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?Rl.getConnectionsData(n).connections:(rt.open(D.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?Rl.getConnectionsData(n).recentConnections:(rt.open(D.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){rt.open(D.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await X.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){rt.open(D.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}j.deleteAddressFromConnection(n),X.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=He.getProviderId(r),i=n?{...n,type:s}:void 0;_.setAccountProp("connectedWalletInfo",i,r)},this.getIsConnectedState=()=>!!_.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{const i=_.getAccountData(s)?.addressLabels||{};_.setAccountProp("addressLabels",{...i,[n]:r},s)},this.removeAddressLabel=(n,r)=>{const s=_.getAccountData(r)?.addressLabels||{};_.setAccountProp("addressLabels",{...s,[n]:void 0},r)},this.getAddress=n=>{const r=n||_.state.activeChain;return _.getAccountData(r)?.address},this.setApprovedCaipNetworksData=n=>_.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{_.resetNetwork(n)},this.addConnector=n=>{K.addConnector(n)},this.resetWcConnection=()=>{X.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{_.setAccountProp("addressExplorerUrl",n,r)},this.setSmartAccountDeployed=(n,r)=>{_.setAccountProp("smartAccountDeployed",n,r)},this.setPreferredAccountType=(n,r)=>{_.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{F.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e),GM.checkSDKVersion(e.sdkVersion)}getChainNamespacesSet(e,n){const r=e?.map(i=>i.namespace).filter(i=>!!i);if(r?.length)return[...new Set(r)];const s=n?.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){if(this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),F.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await s7.fetchRemoteFeatures(e),F.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&Ph.setOnrampProviders(this.remoteFeatures.onramp),(F.state.remoteFeatures?.email||Array.isArray(F.state.remoteFeatures?.socials)&&F.state.remoteFeatures?.socials.length>0)&&await this.checkAllowedOrigins(),F.state.features?.reownAuthentication||F.state.remoteFeatures?.reownAuthentication){const{ReownAuthentication:n}=await dt(async()=>{const{ReownAuthentication:s}=await import("./BHZaTCdo.js");return{ReownAuthentication:s}},[],import.meta.url),r=F.state.siwx;r instanceof n||(r&&console.warn("ReownAuthentication option is enabled, SIWX configuration will be overridden."),F.setSIWX(new n))}}async openSend(e){const n=e.namespace||_.state.activeChain,r=this.getCaipAddress(n),s=this.getCaipNetwork(n)?.id;if(!r)throw new Error("openSend: caipAddress not found");if(s?.toString()!==e.chainId.toString()){const i=_.getCaipNetworkById(e.chainId,n);if(!i)throw new Error(`openSend: caipNetwork with chainId ${e.chainId} not found`);await this.switchNetwork(i,{throwOnFailure:!0})}try{const i=Ev.getTokenSymbolByAddress(e.assetAddress);i&&await de.fetchTokenImages([i])}catch{}return await _e.open({view:"WalletSend",data:{send:e}}),new Promise((i,o)=>{const a=Ce.subscribeKey("hash",u=>{u&&(l(),i({hash:u}))}),c=_e.subscribe(u=>{u.open||(l(),o(new Error("Modal closed")))}),l=this.createCleanupHandler([a,c])})}toModalOptions(){function e(r){return r?.view==="Swap"}function n(r){return r?.view==="WalletSend"}return{isSwap:e,isSend:n}}async checkAllowedOrigins(){try{const e=await de.fetchAllowedOrigins();if(!ee.isClient())return;const n=window.location.origin;$n.isOriginAllowed(n,e,ra.DEFAULT_ALLOWED_ANCESTORS)||rt.open(et.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error))return;switch(e.message){case"RATE_LIMITED":rt.open(et.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;rt.open({displayMessage:et.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.displayMessage,debugMessage:et.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.debugMessage(n.message)},"error");break}}}}createCleanupHandler(e){return()=>{e.forEach(n=>{try{n()}catch{}})}}sendInitializeEvent(e){const{...n}=e;delete n.adapters,delete n.universalProvider,Se.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(r=>r.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&tn.setThemeMode(e.themeMode),e.themeVariables&&tn.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");_.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&_.setActiveCaipNetwork(n)}initializeConnectionController(e){X.initialize(e.adapters??[]),X.setWcBasic(e.basic??!1)}initializeConnectorController(){K.initialize(this.chainNamespaces)}initializeProjectSettings(e){F.setProjectId(e.projectId),F.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){F.setDebug(e.debug!==!1),F.setEnableWalletGuide(e.enableWalletGuide!==!1),F.setEnableWallets(e.enableWallets!==!1),F.setEIP6963Enabled(e.enableEIP6963!==!1),F.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),F.setEnableReconnect(e.enableReconnect!==!1),F.setEnableMobileFullScreen(e.enableMobileFullScreen===!0),F.setEnableAuthLogger(e.enableAuthLogger!==!1),F.setCustomRpcUrls(e.customRpcUrls),F.setEnableEmbedded(e.enableEmbedded),F.setAllWallets(e.allWallets),F.setIncludeWalletIds(e.includeWalletIds),F.setExcludeWalletIds(e.excludeWalletIds),F.setFeaturedWalletIds(e.featuredWalletIds),F.setTokens(e.tokens),F.setTermsConditionsUrl(e.termsConditionsUrl),F.setPrivacyPolicyUrl(e.privacyPolicyUrl),F.setCustomWallets(e.customWallets),F.setFeatures(e.features),F.setAllowUnsupportedChain(e.allowUnsupportedChain),F.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),F.setPreferUniversalLinks(e.experimental_preferUniversalLinks),F.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),F.setMetadata(e.metadata),F.setDisableAppend(e.disableAppend),F.setEnableEmbedded(e.enableEmbedded),F.setSIWX(e.siwx),this.features=F.state.features??{},!e.projectId){rt.open(et.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(s=>s.namespace===D.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");F.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return ee.isClient()?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=gr.getUnsupportedNetwork(`${n}:${e}`);_.setActiveCaipNetwork(r)}}getDefaultNetwork(){return gr.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return gr.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return gr.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>s.id===e.defaultNetwork?.id);return n?gr.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectConnector(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e);return(_.state.chains.get(e)?.accountState?.caipAddress||!F.state.enableReconnect)&&s?.disconnect&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{const e=_.state.activeChain,n=this.getAdapter(e),r=this.getCaipNetwork(e)?.id,s=X.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId(a?.clientId||null),j.setConnectedNamespaces([..._.state.chains.keys()]),await this.syncWalletConnectAccount(),await On.initializeIfEnabled()},connectExternal:async e=>{const n=await this.onConnectExternal(e);return await this.connectInactiveNamespaces(e,n),n?{address:n.address}:void 0},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{const i=_.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o?.reconnect&&(await o?.reconnect({id:e,info:n,type:r,provider:s,chainId:this.getCaipNetwork()?.id}),j.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnectConnector:async e=>{await this.disconnectConnector(e.namespace,e.id)},disconnect:async e=>{const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||_.state.activeChain,o=K.getConnectorId(i),a=n===D.CONNECTOR_ID.AUTH||o===D.CONNECTOR_ID.AUTH,c=n===D.CONNECTOR_ID.WALLET_CONNECT||o===D.CONNECTOR_ID.WALLET_CONNECT;try{const l=Array.from(_.state.chains.keys());let u=r?[r]:l;(c||a)&&(u=l);const d=u.map(async p=>{const g=K.getConnectorId(p),m=n||g,b=await this.disconnectConnector(p,m);b&&(a&&j.deleteConnectedSocialProvider(),b.connections.forEach(v=>{j.addDisconnectedConnectorId(v.connectorId,p)})),s&&this.onDisconnectNamespace({chainNamespace:p,closeModal:!1})}),h=await Promise.allSettled(d);Ce.resetSend(),X.resetWcConnection(),On.getSIWX()?.signOutOnDisconnect&&await On.clearSessions(),K.setFilterByNamespace(void 0),X.syncStorageConnections();const f=h.filter(p=>p.status==="rejected");if(f.length>0)throw new Error(f.map(p=>p.reason.message).join(", "));Se.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(l){throw new Error(`Failed to disconnect chains: ${l.message}`)}},checkInstalled:e=>e?e.some(n=>!!window.ethereum?.[String(n)]):!!window.ethereum,signMessage:async e=>{const n=_.state.activeChain,r=this.getAdapter(_.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=this.getAddress(n);if(!s)throw new Error("signMessage: address not found");return(await r?.signMessage({message:e,address:s,provider:He.getProvider(n)}))?.signature||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(Pe.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=He.getProvider(n);return(await r?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}))?.hash||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===D.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=He.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");return(await r?.estimateGas({...e,provider:s,caipNetwork:i}))?.gas||0n}return 0n},getEnsAvatar:async()=>{const e=_.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");const n=this.getAddress(e);if(!n)throw new Error("getEnsAvatar: address not found");return await this.syncIdentity({address:n,chainId:Number(this.getCaipNetwork()?.id),chainNamespace:e}),_.getAccountData()?.profileImage||!1},getEnsAddress:async e=>await $n.resolveReownName(e),writeContract:async e=>{const n=_.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=He.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");return(await r?.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}))?.hash},parseUnits:(e,n)=>{const r=this.getAdapter(_.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return r?.parseUnits({value:e,decimals:n})??0n},formatUnits:(e,n)=>{const r=this.getAdapter(_.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return r?.formatUnits({value:e,decimals:n})??"0"},getCapabilities:async e=>{const n=this.getAdapter(_.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await n?.getCapabilities(e)},grantPermissions:async e=>{const n=this.getAdapter(_.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await n?.grantPermissions(e)},revokePermissions:async e=>{const n=this.getAdapter(_.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n?.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(_.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await n?.walletGetAssets(e)??{}},updateBalance:e=>{const n=this.getAddress(e),r=this.getCaipNetwork(e);!r||!n||this.updateNativeBalance(n,r?.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},X.setClient(this.connectionControllerClient)}async onConnectExternal(e){const n=_.state.activeChain,r=e.chain||n,s=this.getAdapter(r);let i=!0;if(e.type===ze.CONNECTOR_TYPE_AUTH&&D.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(d=>K.getConnectorId(d)===D.CONNECTOR_ID.AUTH)&&e.chain!==n&&(i=!1),e.chain&&e.chain!==n&&!e.caipNetwork){const l=this.getCaipNetworks().find(u=>u.chainNamespace===e.chain);l&&i&&this.setCaipNetwork(l)}if(!r)throw new Error("connectExternal: namespace not found");if(!s)throw new Error("connectExternal: adapter not found");const o=this.getCaipNetwork(r),a=e.caipNetwork||o,c=await s.connect({id:e.id,address:e.address,info:e.info,type:e.type,provider:e.provider,socialUri:e.socialUri,chainId:e.caipNetwork?.id||o?.id,rpcUrl:e.caipNetwork?.rpcUrls?.default?.http?.[0]||o?.rpcUrls?.default?.http?.[0]});if(c)return j.addConnectedNamespace(r),this.syncProvider({...c,chainNamespace:r}),this.setStatus("connected",r),this.syncConnectedWalletInfo(r),j.removeDisconnectedConnectorId(e.id,r),{address:c.address,connectedCaipNetwork:a}}async connectInactiveNamespaces(e,n){const r=e.type===ze.CONNECTOR_TYPE_AUTH,s=st.getOtherAuthNamespaces(n?.connectedCaipNetwork?.chainNamespace),i=_.state.activeCaipNetwork,o=this.getAdapter(i?.chainNamespace),a=He.getProvider(i?.chainNamespace);r&&(await Promise.all(s.map(async c=>{try{const l=He.getProvider(c),u=this.getCaipNetwork(c);await this.getAdapter(c)?.connect({...e,provider:l,socialUri:void 0,chainId:u?.id,rpcUrl:u?.rpcUrls?.default?.http?.[0]})&&(j.addConnectedNamespace(c),j.removeDisconnectedConnectorId(e.id,c),this.setStatus("connected",c),this.syncConnectedWalletInfo(c))}catch(l){rt.warn(et.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.displayMessage,et.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.debugMessage(c,l instanceof Error?l.message:void 0),et.ALERT_WARNINGS.INACTIVE_NAMESPACE_NOT_CONNECTED.code)}})),i&&await o?.switchNetwork({caipNetwork:i,provider:a,providerType:e.type}))}getApprovedCaipNetworksData(){if(He.getProviderId(_.state.activeChain)===ze.CONNECTOR_TYPE_WALLET_CONNECT){const n=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(n)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=He.getProvider(n),i=He.getProviderId(n);if(e.chainNamespace===_.state.activeChain)await this.getAdapter(n)?.switchNetwork({caipNetwork:e,provider:s,providerType:i});else if(this.setCaipNetwork(e),i===ze.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=xt.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{const s=e?.find(i=>i.namespace===r);return s?(s.construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:i})=>i===r)}),n[r]=s):n[r]=new n7({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),await this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){this.getAdapter(e)?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=j.getConnectionStatus();F.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(j.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=_.state.activeChain===e,c=_.state.chains.get(e)?.accountState?.address;if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{const s=this.remoteFeatures.multiWallet,i=Array.from(X.state.connections.values()).flat();this.onDisconnectNamespace({chainNamespace:e,closeModal:!s||i.length===0})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=this.getAddress(e),i=_.state.activeCaipNetwork;!s||!i?.id||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{this.handlePreviousConnectorConnection(o);const a=_.state.activeChain===e;o?.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o?.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e));const c=_.getNetworkData(e)?.caipNetwork?.id,l=i||c;a&&l?this.syncAccount({address:s,chainId:l,chainNamespace:e}):!a&&l?(this.syncAccountInfo(s,l,e),this.syncBalance({address:s,chainId:l,chainNamespace:e})):this.syncAccountInfo(s,i,e),j.addConnectedNamespace(e)})}async handlePreviousConnectorConnection(e){const n=e?.chain,r=e?.id,s=K.getConnectorId(n),i=F.state.remoteFeatures?.multiWallet,a=n&&r&&s&&s!==r&&!i;try{a&&await X.disconnect({id:s,namespace:n})}catch(c){console.warn("Error disconnecting previous connector",c)}}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&await this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>X.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async reconnectWalletConnect(){await this.syncWalletConnectAccount();const e=this.getAddress();this.getCaipAddress()||j.deleteRecentWallet();const n=j.getRecentWallet();Se.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:e,properties:{method:ee.isMobile()?"mobile":"qrcode",name:n?.name||"Unknown",reconnect:!0,view:he.state.view,walletRank:n?.order}})}async syncNamespaceConnection(e){try{e===D.CHAIN.EVM&&ee.isSafeApp()&&K.setConnectorId(D.CONNECTOR_ID.SAFE,e);const n=K.getConnectorId(e);switch(this.setStatus("connecting",e),n){case D.CONNECTOR_ID.WALLET_CONNECT:await this.reconnectWalletConnect();break;case D.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};_.resetAccount(n),_.resetNetwork(n),j.removeConnectedNamespace(n);const s=Array.from(_.state.chains.keys());(n?[n]:s).forEach(o=>j.addDisconnectedConnectorId(K.getConnectorId(o)||"",o)),K.removeConnectorId(n),He.resetChain(n),this.setUser(null,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(null,n),r!==!1&&_e.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{const n=this.getAdapter(e),r=this.getCaipAddress(e),s=this.getCaipNetwork(e);return n?.syncConnections({connectToFirstConnector:!r,caipNetwork:s})}))}async syncAdapterConnection(e){const n=this.getAdapter(e),r=this.getCaipNetwork(e),s=K.getConnectorId(e),o=K.getConnectors(e).find(a=>a.id===s);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!r?.id)throw new Error("CaipNetwork not found");const a=await n?.syncConnection({namespace:e,id:o.id,chainId:r.id,rpcUrl:r?.rpcUrls?.default?.http?.[0]});a?(this.syncProvider({...a,chainNamespace:e}),await this.syncAccount({...a,chainNamespace:e}),this.setStatus("connected",e),Se.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:a.address,properties:{method:"browser",name:o.info?.name||o.name||"Unknown",reconnect:!0,view:he.state.view,walletRank:void 0}})):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){const e=Object.keys(this.universalProvider?.session?.namespaces||{}),n=this.chainNamespaces.map(async r=>{const s=this.getAdapter(r);if(!s)return;const i=this.universalProvider?.session?.namespaces?.[r]?.accounts||[],o=_.state.activeCaipNetwork?.id,a=i.find(c=>{const{chainId:l}=xt.parseCaipAddress(c);return l===o?.toString()})||i[0];if(a){const c=xt.validateCaipAddress(a),{chainId:l,address:u}=xt.parseCaipAddress(c);if(He.setProviderId(r,ze.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&_.state.activeCaipNetwork&&s.namespace!==D.CHAIN.EVM){const d=s.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:_.state.activeCaipNetwork});He.setProvider(r,d)}else He.setProvider(r,this.universalProvider);K.setConnectorId(D.CONNECTOR_ID.WALLET_CONNECT,r),j.addConnectedNamespace(r),await this.syncAccount({address:u,chainId:l,chainNamespace:r})}else e.includes(r)&&this.setStatus("disconnected",r);this.syncConnectedWalletInfo(r),await _.setApprovedCaipNetworksData(r)});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){He.setProviderId(s,e),He.setProvider(s,n),K.setConnectorId(r,s)}async syncAccount(e){const n=e.chainNamespace===_.state.activeChain,r=_.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=j.getActiveNetworkProps(),c=i||a,l=_.state.activeCaipNetwork?.name===D.UNSUPPORTED_NETWORK_NAME,u=_.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let d=this.getCaipNetworks().find(g=>g.id.toString()===c.toString()),h=this.getCaipNetworks().find(g=>g.chainNamespace===o);if(!u&&!d&&!h){const g=this.getApprovedCaipNetworkIds()||[],m=g.find(v=>xt.parseCaipNetworkId(v)?.chainId===c.toString()),b=g.find(v=>xt.parseCaipNetworkId(v)?.chainNamespace===o);d=this.getCaipNetworks().find(v=>v.caipNetworkId===m),h=this.getCaipNetworks().find(v=>v.caipNetworkId===b||"deprecatedCaipNetworkId"in v&&v.deprecatedCaipNetworkId===b)}const f=d||h;f?.chainNamespace===_.state.activeChain?F.state.enableNetworkSwitch&&!F.state.allowUnsupportedChain&&_.state.activeCaipNetwork?.name===D.UNSUPPORTED_NETWORK_NAME?_.showUnsupportedChainUI():this.setCaipNetwork(f):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o);const p=this.getAddress(o);st.isLowerCaseMatch(s,p)||this.syncAccountInfo(s,f?.id,o),n?await this.syncBalance({address:s,chainId:f?.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r?.id,chainNamespace:o}),this.syncIdentity({address:s,chainId:i,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||s?.split(":")[1];if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r,!0),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){const n=K.getConnectorId(e),r=He.getProviderId(e);if(r===ze.CONNECTOR_TYPE_ANNOUNCED||r===ze.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{const a=o.id===n,c=o.info?.rdns===n,l=o.connectors?.some(u=>u.id===n||u.info?.rdns===n);return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(r===ze.CONNECTOR_TYPE_WALLET_CONNECT){const s=He.getProvider(e);s?.session&&this.setConnectedWalletInfo({...s.session.peer.metadata,name:s.session.peer.metadata.name,icon:s.session.peer.metadata.icons?.[0]},e)}else if(n&&(n===D.CONNECTOR_ID.COINBASE_SDK||n===D.CONNECTOR_ID.COINBASE)){const s=this.getConnectors().find(c=>c.id===n),i=s?.name||"Coinbase Wallet",o=s?.imageUrl||this.getConnectorImage(s),a=s?.info;this.setConnectedWalletInfo({...a,name:i,icon:o},e)}}async syncBalance(e){!Ea.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>r.id.toString()===e.chainId?.toString())||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=_.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){const e=ZM.createLogger((r,...s)=>{r&&this.handleAlertError(r),console.error(...s)}),n={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};F.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await KM.init(n),F.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{$n.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{X.setUri(n)},onConnect:n=>{const{address:r}=ee.getAccount(n[0]);X.finalizeWcConnection(r)},onDisconnect:()=>{_.state.noAdapters&&this.resetAccount(e),X.resetWcConnection()},onChainChanged:n=>{const r=_.state.activeChain,s=r&&K.state.activeConnectorIds[r]===D.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(_.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}o?.id.toString()!==i?.id.toString()&&o?.chainNamespace===i?.chainNamespace&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=_.state.activeChain,s=r&&K.state.activeConnectorIds[r]===D.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(_.state.noAdapters||s)){const i=n?.[0];i&&this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){return!this.universalProviderInitPromise&&ee.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Se.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const n=Object.entries(et.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=et.ALERT_ERRORS[o];a&&(rt.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:this.options?.projectId,networks:this.caipNetworks?.filter(({chainNamespace:s})=>s===n)}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){await this.injectModalUi(),e?.uri&&X.setUri(e.uri);const{isSwap:n,isSend:r}=this.toModalOptions();return n(e)?_e.open({...e,data:{swap:e.arguments}}):r(e)&&e.arguments?this.openSend(e.arguments):_e.open(e)}async close(){await this.injectModalUi(),_e.close()}setLoading(e,n){_e.setLoading(e,n)}async disconnect(e){await X.disconnect({namespace:e})}getSIWX(){return F.state.siwx}getError(){return""}getChainId(){return _.state.activeCaipNetwork?.id}async switchNetwork(e,{throwOnFailure:n=!1}={}){const r=this.getCaipNetworks().find(s=>s.id===e.id);if(!r){rt.open(et.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await _.switchActiveNetwork(r,{throwOnFailure:n})}getWalletProvider(){return _.state.activeChain?He.state.providers[_.state.activeChain]:null}getWalletProviderType(){return He.getProviderId(_.state.activeChain)}subscribeProviders(e){return He.subscribeProviders(e)}getThemeMode(){return tn.state.themeMode}getThemeVariables(){return tn.state.themeVariables}setThemeMode(e){tn.setThemeMode(e),Sf(tn.state.themeMode)}setTermsConditionsUrl(e){F.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){F.setPrivacyPolicyUrl(e)}setThemeVariables(e){tn.setThemeVariables(e),JF(tn.state.themeVariables)}subscribeTheme(e){return tn.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?X.subscribe(e):(rt.open(D.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?_.state.chains.get(e)?.accountState?.connectedWalletInfo:_.getAccountData()?.connectedWalletInfo}getAccount(e){const n=e||_.state.activeChain,r=K.getAuthConnector(n),s=_.getAccountData(n),i=j.getConnectedConnectorId(_.state.activeChain),o=X.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u,publicKey:d})=>ee.createAccount(n,l,u||"eoa",d)));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:ee.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===D.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:j.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:qt(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?_.subscribeChainProp("accountState",r,n):_.subscribe(r),K.subscribe(r)}subscribeNetwork(e){return _.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n?.id,caipNetworkId:n?.caipNetworkId})})}subscribeWalletInfo(e,n){return n?_.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo),n):_.subscribeChainProp("accountState",r=>e(r?.connectedWalletInfo))}subscribeShouldUpdateToAddress(e){_.subscribeChainProp("accountState",n=>e(n?.shouldUpdateToAddress))}subscribeCaipNetworkChange(e){_.subscribeKey("activeCaipNetwork",e)}getState(){return Xn.state}getRemoteFeatures(){return F.state.remoteFeatures}subscribeState(e){return Xn.subscribe(e)}subscribeRemoteFeatures(e){return F.subscribeKey("remoteFeatures",e)}showErrorMessage(e){yr.showError(e)}showSuccessMessage(e){yr.showSuccess(e)}getEvent(){return{...Se.state}}subscribeEvents(e){return Se.subscribe(e)}replace(e){he.replace(e)}redirect(e){he.push(e)}popTransactionStack(e){he.popTransactionStack(e)}isOpen(){return _e.state.open}isTransactionStackEmpty(){return he.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){F.setFeatures(e)}updateRemoteFeatures(e){F.setRemoteFeatures(e)}updateOptions(e){const r={...F.state||{},...e};F.setOptions(r)}setConnectMethodsOrder(e){F.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){F.setWalletFeaturesOrder(e)}setCollapseWallets(e){F.setCollapseWallets(e)}setSocialsOrder(e){F.setSocialsOrder(e)}getConnectMethodsOrder(){return _f.getConnectOrderMethod(F.state.features,K.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||_.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&_.removeNetwork(e,n)}}let Yy=!1;class o7 extends i7{async onAuthProviderConnected(e){const n=st.userChainIdToChainNamespace(e?.chainId);if(e.message&&e.signature&&e.siwxMessage&&await On.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature),!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===D.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=F.state.defaultAccountTypes[n],i=qt(n),o=e.preferredAccountType||i||s;this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:l,...u}=e,d=_.getAccountData(n);this.setUser({...d?.user||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{wn.checkIfRequestExists(n)?wn.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(lt.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(lt.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=wn.checkIfRequestIsSafe(r),i=this.getAddress(),o=_.state.activeCaipNetwork;s||(i&&o?.id&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=_.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");K.getConnectorId(n)===D.CONNECTOR_ID.AUTH&&(this.setCaipAddress(null,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=_.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=tn.getSnapshot(),r=F.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:va(n.themeVariables,n.themeMode)})])}async syncAuthConnector(e,n){const r=D.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===_.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername(),c=_.getAccountData(n)?.user||{};this.setUser({...c,username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:l}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),n&&r&&s){const u=await e.getSmartAccountEnabledNetworks();if(_.setSmartAccountEnabledNetworks(u?.smartAccountEnabledNetworks||[],n),l&&this.connectionControllerClient?.connectExternal){await this.connectionControllerClient?.connectExternal({id:D.CONNECTOR_ID.AUTH,info:{name:D.CONNECTOR_ID.AUTH},type:ze.CONNECTOR_TYPE_AUTH,provider:e,chainId:_.getNetworkData(n)?.caipNetwork?.id,chain:n}),this.setStatus("connected",n);const d=j.getConnectedSocialProvider();d?Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",address:this.getAddress(),properties:{provider:d,reconnect:!0}}):Se.sendEvent({type:"track",event:"CONNECT_SUCCESS",address:this.getAddress(),properties:{method:"email",name:this.universalProvider?.session?.peer?.metadata?.name||"Unknown",reconnect:!0,view:he.state.view,walletRank:void 0}})}else K.getConnectorId(n)===D.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),j.removeConnectedNamespace(n))}this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){try{if(!ee.isTelegram())return;const n=j.getTelegramSocialProvider();if(!n||!ee.isClient())return;const s=new URL(window.location.href).searchParams.get("result_uri");if(!s)return;n&&_.setAccountProp("socialProvider",n,e),await this.authProvider?.init();const i=K.getAuthConnector();n&&i&&(this.setLoading(!0,e),await X.connectExternal({id:i.id,type:i.type,socialUri:s},i.chain),j.setConnectedSocialProvider(n),j.removeTelegramSocialProvider(),Se.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:n}}))}catch(n){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",n)}try{const n=new URL(window.location.href);n.searchParams.delete("result_uri"),window.history.replaceState({},document.title,n.toString())}catch(n){console.error("tma social login failed",n)}}createAuthProvider(e){if(!D.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=this.remoteFeatures?.email,s=Array.isArray(this.remoteFeatures?.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=st.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&this.options?.projectId&&i&&(this.authProvider=si.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:this.getCaipNetwork(a)?.caipNetworkId,abortController:et.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?rt.open(et.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?rt.open(et.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&rt.open(et.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>zr(l),getCaipNetworks:l=>_.getCaipNetworks(l)}),Xn.subscribeOpen(l=>{!l&&this.isTransactionStackEmpty()&&this.authProvider?.rejectRpcRequests()}));const c=e===_.state.activeChain&&F.state.enableReconnect;F.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){this.createAuthProvider(e),this.authProvider&&this.chainAdapters?.[e]?.setAuthProvider?.(this.authProvider)}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&de.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){if(!e)return;const n=_.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&_.getAccountData(r)?.caipAddress){const o=this.getAdapter(r),a=He.getProvider(r),c=He.getProviderId(r);await o?.switchNetwork({caipNetwork:e,provider:a,providerType:c}),this.setCaipNetwork(e)}else{const a=He.getProviderId(n)===ze.CONNECTOR_TYPE_AUTH,c=He.getProviderId(r),l=c===ze.CONNECTOR_TYPE_AUTH,u=D.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((a&&c===void 0||l)&&u)try{_.state.activeChain=e.chainNamespace,s?await this.getAdapter(r)?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:c}):await this.connectionControllerClient?.connectExternal?.({id:D.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:ze.CONNECTOR_TYPE_AUTH,caipNetwork:e}),this.setCaipNetwork(e)}catch{await this.getAdapter(r)?.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:c})}else if(c===ze.CONNECTOR_TYPE_WALLET_CONNECT){if(!_.state.noAdapters){const d=this.getAdapter(r),h=He.getProvider(r),f=He.getProviderId(r);await d?.switchNetwork({caipNetwork:e,provider:h,providerType:f})}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){await super.initialize(e),this.chainNamespaces?.forEach(n=>{this.createAuthProviderForAdapter(n)}),await this.injectModalUi(),Xn.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){const s=`${r}:${n}`;if(this.caipNetworks?.find(a=>a.caipNetworkId===s)?.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}const o=K.getConnectorId(r)===D.CONNECTOR_ID.AUTH;try{const{name:a,avatar:c}=await this.fetchIdentity({address:e});!a&&o?await this.syncReownName(e,r):(this.setProfileName(a,r),this.setProfileImage(c,r))}catch{n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=He.getProviderId(e);if(n===ze.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=j.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(ee.isClient()&&!Yy)try{const e={...Pe.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),ee.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!F.state.disableAppend&&!F.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Yy=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!ee.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(dt(()=>import("./N8ZmQnvc.js"),__vite__mapDeps([9,10,11,12,13,14,15,16,17,18,19,20,21,22]),import.meta.url)),n.email&&r.push(dt(()=>import("./BigzhV7c.js"),__vite__mapDeps([23,10,11,24,21,15,20,13,14,19,25,17]),import.meta.url)),n.socials&&r.push(dt(()=>import("./LtmbHffy.js"),__vite__mapDeps([26,10,11,13,27,14,28,20,29,19,15,30,12,31,32]),import.meta.url)),n.swaps&&n.swaps.length>0&&r.push(dt(()=>import("./BLzkjlvO.js"),__vite__mapDeps([33,10,11,19,15,20,13,34,35,36,32,37,12,17,14]),import.meta.url)),e.send&&r.push(dt(()=>import("./xrkAYOJf.js"),__vite__mapDeps([38,10,11,19,15,20,13,39,14,40,21,37,12,32,36,17,41,42]),import.meta.url)),e.receive&&r.push(dt(()=>import("./CjhTacgn.js"),__vite__mapDeps([43,10,11,13,12,30,31]),import.meta.url)),n.onramp&&n.onramp.length>0&&r.push(dt(()=>import("./By10OQRC.js"),__vite__mapDeps([44,10,11,13,45,15,27,14,12,46,47,21,19,20,29,48,17]),import.meta.url)),n.payWithExchange&&r.push(dt(()=>import("./E_uh7ip1.js"),__vite__mapDeps([49,10,11,13,12,18,45,15,32,19,40,14,21,48,20,17,41,39]),import.meta.url)),n.activity&&r.push(dt(()=>import("./BsY4AnX6.js"),__vite__mapDeps([50,10,11,51,31,20,13,21,12,32]),import.meta.url)),(e.pay||n.payments)&&r.push(dt(()=>import("./DEn2m9BA.js"),__vite__mapDeps([52,10,11,13,19,15,53,18,12,45,54,39,55,20,29]),import.meta.url)),n.emailCapture&&r.push(dt(()=>import("./BuXhVEVZ.js"),__vite__mapDeps([56,10,11,24,21,15,57]),import.meta.url)),await Promise.all([...r,dt(()=>import("./BfOyLazv.js"),__vite__mapDeps([58,10,11,13,12,15,42,20,59,47,21,16,55,18,45,19,51,31,32,41,34,35,39,14,17,54,25,27,28,29,30,22,46]),import.meta.url),dt(()=>import("./CxeeJ3Mv.js"),__vite__mapDeps([60,10,11,13,53,12,16,15,20,35,59,47,21,55,36]),import.meta.url)])}}const a7="1.8.7";function VH(t){return new o7({...t,sdkVersion:ee.generateSdkVersion(t.adapters??[],"html",a7)})}function Un(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}const El="2.21.2",c7=()=>`@wagmi/core@${El}`;var Lv=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ru,Bv;class sr extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return c7()}constructor(e,n={}){super(),ru.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const r=n.cause instanceof sr?n.cause.details:n.cause?.message?n.cause.message:n.details,s=n.cause instanceof sr&&n.cause.docsPath||n.docsPath;this.message=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}walk(e){return Lv(this,ru,"m",Bv).call(this,this,e)}}ru=new WeakSet,Bv=function t(e,n){return n?.(e)?e:e.cause?Lv(this,ru,"m",t).call(this,e.cause,n):e};class lc extends sr{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class l7 extends sr{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class u7 extends sr{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class d7 extends sr{constructor({address:e,connector:n}){super(`Account "${e}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class h7 extends sr{constructor({connectionChainId:e,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class f7 extends sr{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function eh(t,e){let n;if(typeof e.connector=="function"?n=t._internal.connectors.setup(e.connector):n=e.connector,n.uid===t.state.current)throw new l7;try{t.setState(o=>({...o,status:"connecting"})),n.emitter.emit("message",{type:"connecting"});const{connector:r,...s}=e,i=await n.connect(s);return n.emitter.off("connect",t._internal.events.connect),n.emitter.on("change",t._internal.events.change),n.emitter.on("disconnect",t._internal.events.disconnect),await t.storage?.setItem("recentConnectorId",n.id),t.setState(o=>({...o,connections:new Map(o.connections).set(n.uid,{accounts:s.withCapabilities?i.accounts.map(a=>typeof a=="object"?a.address:a):i.accounts,chainId:i.chainId,connector:n}),current:n.uid,status:"connected"})),{accounts:s.withCapabilities?i.accounts.map(o=>typeof o=="object"?o:{address:o,capabilities:{}}):i.accounts,chainId:i.chainId}}catch(r){throw t.setState(s=>({...s,status:s.current?"connected":"disconnected"})),r}}async function Uu(t,e={}){const{assertChainId:n=!0}=e;let r;if(e.connector){const{connector:u}=e;if(t.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new f7({connector:u});const[d,h]=await Promise.all([u.getAccounts().catch(f=>{if(e.account===null)return[];throw f}),u.getChainId()]);r={accounts:d,chainId:h,connector:u}}else r=t.state.connections.get(t.state.current);if(!r)throw new u7;const s=e.chainId??r.chainId,i=await r.connector.getChainId();if(n&&i!==s)throw new h7({connectionChainId:s,connectorChainId:i});const o=r.connector;if(o.getClient)return o.getClient({chainId:s});const a=Pr(e.account??r.accounts[0]);if(a&&(a.address=Ks(a.address)),e.account&&!r.accounts.some(u=>u.toLowerCase()===a.address.toLowerCase()))throw new d7({address:a.address,connector:o});const c=t.chains.find(u=>u.id===s),l=await r.connector.getProvider({chainId:s});return Rb({account:a,chain:c,name:"Connector Client",transport:u=>D2(l)({...u,retryCount:0})})}async function Zy(t,e={}){let n;if(e.connector)n=e.connector;else{const{connections:s,current:i}=t.state;n=s.get(i)?.connector}const r=t.state.connections;n&&(await n.disconnect(),n.emitter.off("change",t._internal.events.change),n.emitter.off("disconnect",t._internal.events.disconnect),n.emitter.on("connect",t._internal.events.connect),r.delete(n.uid)),t.setState(s=>{if(r.size===0)return{...s,connections:new Map,current:null,status:"disconnected"};const i=r.values().next().value;return{...s,connections:new Map(r),current:i.connector.uid}});{const s=t.state.current;if(!s)return;const i=t.state.connections.get(s)?.connector;if(!i)return;await t.storage?.setItem("recentConnectorId",i.id)}}function Fv(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(BA[t])}async function p7(t,e){const{chainId:n,connector:r,...s}=e;let i;e.account?i=e.account:i=(await Uu(t,{account:e.account,assertChainId:!1,chainId:n,connector:r})).account;const o=t.getClient({chainId:n});return Un(o,hb,"estimateGas")({...s,account:i})}function ya(t){const e=t.state.current,n=t.state.connections.get(e),r=n?.accounts,s=r?.[0],i=t.chains.find(a=>a.id===n?.chainId),o=t.state.status;switch(o){case"connected":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:r,chain:i,chainId:n?.chainId,connector:n?.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}async function g7(t,e){const{allowFailure:n=!0,chainId:r,contracts:s,...i}=e,o=t.getClient({chainId:r});return Un(o,P2,"multicall")({allowFailure:n,contracts:s,...i})}function m7(t,e){const{chainId:n,...r}=e,s=t.getClient({chainId:n});return Un(s,Nb,"readContract")(r)}async function y7(t,e){const{allowFailure:n=!0,blockNumber:r,blockTag:s,...i}=e,o=e.contracts;try{const a={};for(const[d,h]of o.entries()){const f=h.chainId??t.state.chainId;a[f]||(a[f]=[]),a[f]?.push({contract:h,index:d})}const c=()=>Object.entries(a).map(([d,h])=>g7(t,{...i,allowFailure:n,blockNumber:r,blockTag:s,chainId:Number.parseInt(d,10),contracts:h.map(({contract:f})=>f)})),l=(await Promise.all(c())).flat(),u=Object.values(a).flatMap(d=>d.map(({index:h})=>h));return l.reduce((d,h,f)=>(d&&(d[u[f]]=h),d),[])}catch(a){if(a instanceof Zw)throw a;const c=()=>o.map(l=>m7(t,{...l,blockNumber:r,blockTag:s}));return n?(await Promise.allSettled(c())).map(l=>l.status==="fulfilled"?{result:l.value,status:"success"}:{error:l.reason,result:void 0,status:"failure"}):await Promise.all(c())}}async function w7(t,e){const{address:n,blockNumber:r,blockTag:s,chainId:i,token:o,unit:a="ether"}=e;if(o)try{return await Jy(t,{balanceAddress:n,chainId:i,symbolType:"string",tokenAddress:o})}catch(h){if(h.name==="ContractFunctionExecutionError"){const f=await Jy(t,{balanceAddress:n,chainId:i,symbolType:"bytes32",tokenAddress:o}),p=Ow(_s(f.symbol,{dir:"right"}));return{...f,symbol:p}}throw h}const c=t.getClient({chainId:i}),u=await Un(c,E2,"getBalance")(r?{address:n,blockNumber:r}:{address:n,blockTag:s}),d=t.chains.find(h=>h.id===i)??c.chain;return{decimals:d.nativeCurrency.decimals,formatted:vi(u,Fv(a)),symbol:d.nativeCurrency.symbol,value:u}}async function Jy(t,e){const{balanceAddress:n,chainId:r,symbolType:s,tokenAddress:i,unit:o}=e,a={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:s}]}],address:i},[c,l,u]=await y7(t,{allowFailure:!1,contracts:[{...a,functionName:"balanceOf",args:[n],chainId:r},{...a,functionName:"decimals",chainId:r},{...a,functionName:"symbol",chainId:r}]}),d=vi(c??"0",Fv(o??l));return{decimals:l,formatted:d,symbol:u,value:c}}function uc(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,r;if(Array.isArray(t)&&Array.isArray(e)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!uc(t[r],e[r]))return!1;return!0}if(typeof t.valueOf=="function"&&t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(typeof t.toString=="function"&&t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.hasOwn(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(i&&!uc(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}let rl=[];function jr(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||uc(rl,e)?rl:(rl=e,e)}async function b7(t,e){const{account:n,chainId:r,...s}=e,i=n??ya(t).address,o=t.getClient({chainId:r});return Un(o,Gf,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}let th=!1;async function Xy(t,e={}){if(th)return[];th=!0,t.setState(l=>({...l,status:l.current?"reconnecting":"connecting"}));const n=[];if(e.connectors?.length)for(const l of e.connectors){let u;typeof l=="function"?u=t._internal.connectors.setup(l):u=l,n.push(u)}else n.push(...t.connectors);let r;try{r=await t.storage?.getItem("recentConnectorId")}catch{}const s={};for(const[,l]of t.state.connections)s[l.connector.id]=1;r&&(s[r]=0);const i=Object.keys(s).length>0?[...n].sort((l,u)=>(s[l.id]??10)-(s[u.id]??10)):n;let o=!1;const a=[],c=[];for(const l of i){const u=await l.getProvider().catch(()=>{});if(!u||c.some(f=>f===u)||!await l.isAuthorized())continue;const h=await l.connect({isReconnecting:!0}).catch(()=>null);h&&(l.emitter.off("connect",t._internal.events.connect),l.emitter.on("change",t._internal.events.change),l.emitter.on("disconnect",t._internal.events.disconnect),t.setState(f=>{const p=new Map(o?f.connections:new Map).set(l.uid,{accounts:h.accounts,chainId:h.chainId,connector:l});return{...f,current:o?f.current:l.uid,connections:p}}),a.push({accounts:h.accounts,chainId:h.chainId,connector:l}),c.push(u),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(l=>({...l,status:"connected"})):t.setState(l=>({...l,connections:new Map,current:null,status:"disconnected"}))),th=!1,a}async function E7(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&n?.type==="local"?o=t.getClient({chainId:r}):o=await Uu(t,{account:n??void 0,assertChainId:!1,chainId:r,connector:s}),await Un(o,Pb,"sendTransaction")({...i,...n?{account:n}:{},chain:r?{id:r}:null,gas:i.gas??void 0})}async function v7(t,e){const{account:n,connector:r,...s}=e;let i;return typeof n=="object"&&n.type==="local"?i=t.getClient():i=await Uu(t,{account:n,connector:r}),Un(i,k2,"signMessage")({...s,...n?{account:n}:{}})}class ms extends sr{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class C7 extends sr{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function Qy(t,e){const{addEthereumChainParameter:n,chainId:r}=e,s=t.state.connections.get(e.connector?.uid??t.state.current);if(s){const o=s.connector;if(!o.switchChain)throw new C7({connector:o});return await o.switchChain({addEthereumChainParameter:n,chainId:r})}const i=t.chains.find(o=>o.id===r);if(!i)throw new lc;return t.setState(o=>({...o,chainId:r})),i}async function _7(t,e){const{chainId:n,timeout:r=0,...s}=e,i=t.getClient({chainId:n}),a=await Un(i,R2,"waitForTransactionReceipt")({...s,timeout:r});if(a.status==="reverted"){const l=await Un(i,kb,"getTransaction")({hash:a.transactionHash}),d=await Un(i,Ib,"call")({...l,data:l.input,gasPrice:l.type!=="eip1559"?l.gasPrice:void 0,maxFeePerGas:l.type==="eip1559"?l.maxFeePerGas:void 0,maxPriorityFeePerGas:l.type==="eip1559"?l.maxPriorityFeePerGas:void 0}),h=d?.data?Ow(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}function A7(t,e){const{onChange:n}=e;return t.subscribe(()=>ya(t),n,{equalityFn(r,s){const{connector:i,...o}=r,{connector:a,...c}=s;return uc(o,c)&&i?.id===a?.id&&i?.uid===a?.uid}})}function I7(t,e){const{onChange:n}=e;return t.subscribe(()=>jr(t),n,{equalityFn:uc})}function S7(t,e){const{onChange:n}=e;return t._internal.connectors.subscribe((r,s)=>{n(Object.values(r),s)})}function N7(t,e){const{syncConnectedChain:n=t._internal.syncConnectedChain,...r}=e;let s;const i=c=>{s&&s();const l=t.getClient({chainId:c});return s=Un(l,O2,"watchPendingTransactions")(r),s},o=i(e.chainId);let a;return n&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o?.(),a?.()}}async function T7(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&n?.type==="local"?o=t.getClient({chainId:r}):o=await Uu(t,{account:n??void 0,assertChainId:!1,chainId:r,connector:s}),await Un(o,m2,"writeContract")({...i,...n?{account:n}:{},chain:r?{id:r}:null})}function KH(t){return t}Mu.type="injected";function Mu(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:n}=t;function r(){const c=t.target;if(typeof c=="function"){const l=c();if(l)return l}return typeof c=="object"?c:typeof c=="string"?{...P7[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(l){return l?.ethereum}}}let s,i,o,a;return c=>({get icon(){return r().icon},get id(){return r().id},get name(){return r().name},get supportsSimulation(){return!0},type:Mu.type,async setup(){const l=await this.getProvider();l?.on&&t.target&&(o||(o=this.onConnect.bind(this),l.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),l.on("accountsChanged",s)))},async connect({chainId:l,isReconnecting:u,withCapabilities:d}={}){const h=await this.getProvider();if(!h)throw new ms;let f=[];if(u)f=await this.getAccounts().catch(()=>[]);else if(e)try{f=(await h.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0]?.caveats?.[0]?.value?.map(g=>Ks(g)),f.length>0&&(f=await this.getAccounts())}catch(p){const g=p;if(g.code===ot.code)throw new ot(g);if(g.code===As.code)throw g}try{!f?.length&&!u&&(f=(await h.request({method:"eth_requestAccounts"})).map(m=>Ks(m))),o&&(h.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),h.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),h.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),h.on("disconnect",a));let p=await this.getChainId();return l&&p!==l&&(p=(await this.switchChain({chainId:l}).catch(m=>{if(m.code===ot.code)throw m;return{id:p}}))?.id??p),e&&await c.storage?.removeItem(`${this.id}.disconnected`),t.target||await c.storage?.setItem("injected.connected",!0),{accounts:d?f.map(g=>({address:g,capabilities:{}})):f,chainId:p}}catch(p){const g=p;throw g.code===ot.code?new ot(g):g.code===As.code?new As(g):g}},async disconnect(){const l=await this.getProvider();if(!l)throw new ms;i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o));try{await Ob(()=>l.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await c.storage?.setItem(`${this.id}.disconnected`,!0),t.target||await c.storage?.removeItem("injected.connected")},async getAccounts(){const l=await this.getProvider();if(!l)throw new ms;return(await l.request({method:"eth_accounts"})).map(d=>Ks(d))},async getChainId(){const l=await this.getProvider();if(!l)throw new ms;const u=await l.request({method:"eth_chainId"});return Number(u)},async getProvider(){if(typeof window>"u")return;let l;const u=r();return typeof u.provider=="function"?l=u.provider(window):typeof u.provider=="string"?l=vl(window,u.provider):l=u.provider,l&&!l.removeListener&&("off"in l&&typeof l.off=="function"?l.removeListener=l.off:l.removeListener=()=>{}),l},async isAuthorized(){try{if(e&&await c.storage?.getItem(`${this.id}.disconnected`)||!t.target&&!await c.storage?.getItem("injected.connected"))return!1;if(!await this.getProvider()){if(n!==void 0&&n!==!1){const h=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",h),!!await this.getProvider()),f=typeof n=="number"?n:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(g=>window.addEventListener("ethereum#initialized",()=>g(h()),{once:!0}))]:[],new Promise(g=>setTimeout(()=>g(h()),f))]))return!0}throw new ms}return!!(await xl(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:l,chainId:u}){const d=await this.getProvider();if(!d)throw new ms;const h=c.chains.find(p=>p.id===u);if(!h)throw new Ir(new lc);const f=new Promise(p=>{const g=(m=>{"chainId"in m&&m.chainId===u&&(c.emitter.off("change",g),p())});c.emitter.on("change",g)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:Ae(u)}]}).then(async()=>{await this.getChainId()===u&&c.emitter.emit("change",{chainId:u})}),f]),h}catch(p){const g=p;if(g.code===4902||g?.data?.originalError?.code===4902)try{const{default:m,...b}=h.blockExplorers??{};let v;l?.blockExplorerUrls?v=l.blockExplorerUrls:m&&(v=[m.url,...Object.values(b).map(y=>y.url)]);let C;l?.rpcUrls?.length?C=l.rpcUrls:C=[h.rpcUrls.default?.http[0]??""];const N={blockExplorerUrls:v,chainId:Ae(u),chainName:l?.chainName??h.name,iconUrls:l?.iconUrls,nativeCurrency:l?.nativeCurrency??h.nativeCurrency,rpcUrls:C};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[N]}).then(async()=>{if(await this.getChainId()===u)c.emitter.emit("change",{chainId:u});else throw new ot(new Error("User rejected switch after adding network."))}),f]),h}catch(m){throw new ot(m)}throw g.code===ot.code?new ot(g):new Ir(g)}},async onAccountsChanged(l){if(l.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const u=(await this.getChainId()).toString();this.onConnect({chainId:u}),e&&await c.storage?.removeItem(`${this.id}.disconnected`)}else c.emitter.emit("change",{accounts:l.map(u=>Ks(u))})},onChainChanged(l){const u=Number(l);c.emitter.emit("change",{chainId:u})},async onConnect(l){const u=await this.getAccounts();if(u.length===0)return;const d=Number(l.chainId);c.emitter.emit("connect",{accounts:u,chainId:d});const h=await this.getProvider();h&&(o&&(h.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),h.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),h.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),h.on("disconnect",a)))},async onDisconnect(l){const u=await this.getProvider();l&&l.code===1013&&u&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),u&&(i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o))))}})}const P7={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t?.coinbaseWalletExtension?t.coinbaseWalletExtension:vl(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return vl(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const n=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const r of n)if(e[r])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){return t?.phantom?.ethereum?t.phantom?.ethereum:vl(t,"isPhantom")}}};function vl(t,e){function n(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const r=t.ethereum;if(r?.providers)return r.providers.find(s=>n(s));if(r&&n(r))return r}function x7(t){if(typeof window>"u")return;const e=n=>t(n.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function R7(){const t=new Set;let e=[];const n=()=>x7(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let r=n();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),r?.()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),r?.(),r=n()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const O7=t=>(e,n,r)=>{const s=r.subscribe;return r.subscribe=(o,a,c)=>{let l=o;if(a){const u=c?.equalityFn||Object.is;let d=o(r.getState());l=h=>{const f=o(h);if(!u(d,f)){const p=d;a(d=f,p)}},c?.fireImmediately&&a(d,d)}return s(l)},t(e,n,r)},k7=O7;function D7(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const Nf=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return Nf(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Nf(r)(n)}}}},$7=(t,e)=>(n,r,s)=>{let i={storage:D7(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const a=new Set,c=new Set;let l=i.storage;if(!l)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...g)},r,s);const u=()=>{const g=i.partialize({...r()});return l.setItem(i.name,{state:g,version:i.version})},d=s.setState;s.setState=(g,m)=>{d(g,m),u()};const h=t((...g)=>{n(...g),u()},r,s);s.getInitialState=()=>h;let f;const p=()=>{var g,m;if(!l)return;o=!1,a.forEach(v=>{var C;return v((C=r())!=null?C:h)});const b=((m=i.onRehydrateStorage)==null?void 0:m.call(i,(g=r())!=null?g:h))||void 0;return Nf(l.getItem.bind(l))(i.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==i.version){if(i.migrate)return[!0,i.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var C;const[N,y]=v;if(f=i.merge(y,(C=r())!=null?C:h),n(f,!0),N)return u()}).then(()=>{b?.(f,void 0),f=r(),o=!0,c.forEach(v=>v(f))}).catch(v=>{b?.(void 0,v)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(l=g.storage)},clearStorage:()=>{l?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(a.add(g),()=>{a.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||p(),f||h},U7=$7,ew=t=>{let e;const n=new Set,r=(l,u)=>{const d=typeof l=="function"?l(e):l;if(!Object.is(d,e)){const h=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(r,s,a);return a},nh=t=>t?ew(t):ew;class M7{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new Jv})}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,...n){const r=n[0];this._emitter.emit(e,{uid:this.uid,...r})}listenerCount(e){return this._emitter.listenerCount(e)}}function L7(t){return new M7(t)}function B7(t,e){return JSON.parse(t,(n,r)=>{let s=r;return s?.__type==="bigint"&&(s=BigInt(s.value)),s?.__type==="Map"&&(s=new Map(s.value)),e?.(n,s)??s})}function tw(t,e){return t.slice(0,e).join(".")||"."}function nw(t,e){const{length:n}=t;for(let r=0;r<n;++r)if(t[r]===e)return r+1;return 0}function F7(t,e){const n=typeof t=="function",r=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const l=nw(s,this);l===0?s[s.length]=this:(s.splice(l),i.splice(l)),i[i.length]=a;const u=nw(s,c);if(u!==0)return r?e.call(this,a,c,tw(i,u)):`[ref=${tw(i,u)}]`}else s[0]=c,i[0]=a;return n?t.call(this,a,c):c}}function j7(t,e,n,r){return JSON.stringify(t,F7((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),e?.(s,o)??o},r),n??void 0)}function H7(t){const{deserialize:e=B7,key:n="wagmi",serialize:r=j7,storage:s=jv}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:n,async getItem(o,a){const c=s.getItem(`${n}.${o}`),l=await i(c);return l?e(l)??null:a??null},async setItem(o,a){const c=`${n}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,r(a)))},async removeItem(o){await i(s.removeItem(`${n}.${o}`))}}}const jv={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function q7(){const t=typeof window<"u"&&window.localStorage?window.localStorage:jv;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,n){try{t.setItem(e,n)}catch{}}}}const Tf=256;let sl=Tf,il;function W7(t=11){if(!il||sl+t>Tf*2){il="",sl=0;for(let e=0;e<Tf;e++)il+=(256+Math.random()*256|0).toString(16).substring(1)}return il.substring(sl,sl+++t)}function z7(t){const{multiInjectedProviderDiscovery:e=!0,storage:n=H7({storage:q7()}),syncConnectedChain:r=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?R7():void 0,a=nh(()=>i.chains),c=nh(()=>{const y=[],w=new Set;for(const S of i.connectors??[]){const P=l(S);if(y.push(P),!s&&P.rdns){const A=typeof P.rdns=="string"?[P.rdns]:P.rdns;for(const x of A)w.add(x)}}if(!s&&o){const S=o.getProviders();for(const P of S)w.has(P.info.rdns)||y.push(l(u(P)))}return y});function l(y){const w=L7(W7()),S={...y({emitter:w,chains:a.getState(),storage:n,transports:i.transports}),emitter:w,uid:w.uid};return w.on("connect",C),S.setup?.(),S}function u(y){const{info:w}=y,S=y.provider;return Mu({target:{...w,id:w.rdns,provider:S}})}const d=new Map;function h(y={}){const w=y.chainId??m.getState().chainId,S=a.getState().find(A=>A.id===w);if(y.chainId&&!S)throw new lc;{const A=d.get(m.getState().chainId);if(A&&!S)return A;if(!S)throw new lc}{const A=d.get(w);if(A)return A}let P;if(i.client)P=i.client({chain:S});else{const A=S.id,x=a.getState().map(L=>L.id),R={},O=Object.entries(i);for(const[L,$]of O)if(!(L==="chains"||L==="client"||L==="connectors"||L==="transports"))if(typeof $=="object")if(A in $)R[L]=$[A];else{if(x.some(T=>T in $))continue;R[L]=$}else R[L]=$;P=Rb({...R,chain:S,batch:R.batch??{multicall:!0},transport:L=>i.transports[A]({...L,connectors:c})})}return d.set(w,P),P}function f(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const g="0.0.0-canary-";El.startsWith(g)?p=Number.parseInt(El.replace(g,""),10):p=Number.parseInt(El.split(".")[0]??"0",10);const m=nh(k7(n?U7(f,{migrate(y,w){if(w===p)return y;const S=f(),P=b(y,S.chainId);return{...S,chainId:P}},name:"store",partialize(y){return{connections:{__type:"Map",value:Array.from(y.connections.entries()).map(([w,S])=>{const{id:P,name:A,type:x,uid:R}=S.connector;return[w,{...S,connector:{id:P,name:A,type:x,uid:R}}]})},chainId:y.chainId,current:y.current}},merge(y,w){typeof y=="object"&&y&&"status"in y&&delete y.status;const S=b(y,w.chainId);return{...w,...y,chainId:S}},skipHydration:s,storage:n,version:p}):f));m.setState(f());function b(y,w){return y&&typeof y=="object"&&"chainId"in y&&typeof y.chainId=="number"&&a.getState().some(S=>S.id===y.chainId)?y.chainId:w}r&&m.subscribe(({connections:y,current:w})=>w?y.get(w)?.chainId:void 0,y=>{if(a.getState().some(S=>S.id===y))return m.setState(S=>({...S,chainId:y??S.chainId}))}),o?.subscribe(y=>{const w=new Set,S=new Set;for(const A of c.getState())if(w.add(A.id),A.rdns){const x=typeof A.rdns=="string"?[A.rdns]:A.rdns;for(const R of x)S.add(R)}const P=[];for(const A of y){if(S.has(A.info.rdns))continue;const x=l(u(A));w.has(x.id)||P.push(x)}n&&!m.persist.hasHydrated()||c.setState(A=>[...A,...P],!0)});function v(y){m.setState(w=>{const S=w.connections.get(y.uid);return S?{...w,connections:new Map(w.connections).set(y.uid,{accounts:y.accounts??S.accounts,chainId:y.chainId??S.chainId,connector:S.connector})}:w})}function C(y){m.getState().status==="connecting"||m.getState().status==="reconnecting"||m.setState(w=>{const S=c.getState().find(P=>P.uid===y.uid);return S?(S.emitter.listenerCount("connect")&&S.emitter.off("connect",v),S.emitter.listenerCount("change")||S.emitter.on("change",v),S.emitter.listenerCount("disconnect")||S.emitter.on("disconnect",N),{...w,connections:new Map(w.connections).set(y.uid,{accounts:y.accounts,chainId:y.chainId,connector:S}),current:y.uid,status:"connected"}):w})}function N(y){m.setState(w=>{const S=w.connections.get(y.uid);if(S){const A=S.connector;A.emitter.listenerCount("change")&&S.connector.emitter.off("change",v),A.emitter.listenerCount("disconnect")&&S.connector.emitter.off("disconnect",N),A.emitter.listenerCount("connect")||S.connector.emitter.on("connect",C)}if(w.connections.delete(y.uid),w.connections.size===0)return{...w,connections:new Map,current:null,status:"disconnected"};const P=w.connections.values().next().value;return{...w,connections:new Map(w.connections),current:P.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:n,getClient:h,get state(){return m.getState()},setState(y){let w;typeof y=="function"?w=y(m.getState()):w=y;const S=f();typeof w!="object"&&(w=S),Object.keys(S).some(A=>!(A in w))&&(w=S),m.setState(w,!0)},subscribe(y,w,S){return m.subscribe(y,w,S?{...S,fireImmediately:S.emitImmediately}:void 0)},_internal:{mipd:o,async revalidate(){const y=m.getState(),w=y.connections;let S=y.current;for(const[,P]of w){const A=P.connector;A.isAuthorized&&await A.isAuthorized()||(w.delete(A.uid),S===A.uid&&(S=null))}m.setState(P=>({...P,connections:w,current:S}))},store:m,ssr:!!s,syncConnectedChain:r,transports:i.transports,chains:{setState(y){const w=typeof y=="function"?y(a.getState()):y;if(w.length!==0)return a.setState(w,!0)},subscribe(y){return a.subscribe(y)}},connectors:{providerDetailToConnector:u,setup:l,setState(y){return c.setState(typeof y=="function"?y(c.getState()):y,!0)},subscribe(y){return c.subscribe(y)}},events:{change:v,connect:C,disconnect:N}}}}function V7(t){let e=[],n,r;function s(a){return Ea.parseEvmChainId(a)||1}function i(){return n||(n=si.getInstance({projectId:t.options.projectId,chainId:zr()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:a=>{a==="iframe_load_failed"?rt.open(et.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):a==="iframe_request_timeout"?rt.open(et.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):a==="unverified_domain"&&rt.open(et.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:et.EmbeddedWalletAbortController,getActiveCaipNetwork:a=>zr(a),getCaipNetworks:a=>_.getCaipNetworks(a)})),n}async function o(a={}){const c=i();let l=a.chainId;if(a.isReconnecting){const g=Ea.parseEvmChainId(c.getLastUsedChainId()||""),m=t.chains?.[0].id;if(l=g||m,!l)throw new Error("ChainId not found in provider")}const u=qt("eip155"),{address:d,chainId:h,accounts:f}=await On.authConnectorAuthenticate({authConnector:c,chainId:l,preferredAccountType:u,socialUri:a.socialUri,chainNamespace:D.CHAIN.EVM});e=f?.map(g=>g.address)||[d];const p=s(h);return{accounts:e,account:d,chainId:p,chain:{id:p,unsuported:!1}}}return a=>({id:D.CONNECTOR_ID.AUTH,name:D.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:D.CHAIN.EVM,async connect(c={}){if(r)return r;r||(r=new Promise(u=>{u(o(c))}));const l=await r;return r=void 0,l},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e?.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){return this.provider||(this.provider=si.getInstance({projectId:t.options.projectId,chainId:zr()?.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:et.EmbeddedWalletAbortController,onTimeout:c=>{c==="iframe_load_failed"?rt.open(et.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?rt.open(et.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&rt.open(et.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:c=>zr(c),getCaipNetworks:c=>_.getCaipNetworks(c)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:l}=await c.getChainId();return s(l)},async isAuthorized(){const l=_.state.activeChain===D.CHAIN.EVM;if(D.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(h=>K.getConnectorId(h)===D.CONNECTOR_ID.AUTH)&&!l)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){try{const l=a.chains.find(f=>f.id===c);if(!l)throw new Ir(new Error("chain not found on connector."));const u=await this.getProvider(),d=qt("eip155"),h=await u.connect({chainId:c,preferredAccountType:d});return e=h?.accounts?.map(f=>f.address)||[h.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),l}catch(l){throw l instanceof Error?new Ir(l):l}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(Ks)})},onChainChanged(c){const l=Number(c);a.emitter.emit("change",{chainId:l})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}Lp.type="walletConnect";function Lp(t,e){const n=t.isNewChainsStale??!0;let r,s,i,o,a,c,l;return u=>({id:"walletConnect",name:"WalletConnect",type:Lp.type,async setup(){const d=await this.getProvider().catch(()=>null);d&&(o||(o=this.onConnect.bind(this),d.on("connect",o)),c||(c=this.onSessionDelete.bind(this),d.on("session_delete",c)))},async connect({...d}={}){try{const h=_.getCaipNetworks(),f=await this.getProvider();if(!f)throw new ms;a||(a=this.onDisplayUri,f.on("display_uri",a));const p=await this.isChainsStale();f.session&&p&&await f.disconnect();const g=F.state.universalProviderConfigOverride;if(!f.session||p){const w=$n.createNamespaces(h,g);await f.connect({optionalNamespaces:w,..."pairingTopic"in d?{pairingTopic:d.pairingTopic}:{}}),this.setRequestedChainsIds(h.map(S=>Number(S.id)))}const m=await this.getAccounts(),b=await this.getChainId(),v=f.session?.namespaces?.eip155?.chains,C=v?.some(w=>Number(w.split(":")[1])===b);let N=1;C?N=b:v?.[0]&&(N=Number(v[0].split(":")[1])),a&&(f.removeListener("display_uri",a),a=void 0),o&&(f.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),f.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),f.on("chainChanged",i)),l||(l=this.onDisconnect.bind(this),f.on("disconnect",l)),c||(c=this.onSessionDelete.bind(this),f.on("session_delete",c));const y=g?.defaultChain;return f.setDefaultChain(y??`eip155:${N}`),{accounts:m,chainId:N}}catch(h){throw/(user rejected|connection request reset)/i.test(h?.message)?new ot(h):h}},async disconnect(){const d=await this.getProvider();try{await d?.disconnect()}catch(h){if(!/No matching key/i.test(h.message))throw h}finally{i&&(d?.removeListener("chainChanged",i),i=void 0),l&&(d?.removeListener("disconnect",l),l=void 0),o||(o=this.onConnect.bind(this),d?.on("connect",o)),s&&(d?.removeListener("accountsChanged",s),s=void 0),c&&(d?.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){const d=await this.getProvider();if(!d?.session?.namespaces)return[];const f=d?.session?.namespaces[D.CHAIN.EVM]?.accounts?.map(m=>m.split(":")[2])??[],p=new Set;return f.filter(m=>{const b=m?.toLowerCase();return p.has(b)?!1:(p.add(b),!0)})},async getProvider({chainId:d}={}){r||(r=await e.getUniversalProvider(),r?.events.setMaxListeners(Number.POSITIVE_INFINITY));const h=j.getActiveNamespace(),f=e.getCaipNetwork()?.id;if(d&&f!==d&&h){const p=j.getStoredActiveCaipNetworkId(),m=(h?e.getCaipNetworks(h):[])?.find(b=>b.id===p);m&&m.chainNamespace===D.CHAIN.EVM&&await this.switchChain?.({chainId:Number(m.id)})}return r},async getChainId(){const d=e.getCaipNetwork(D.CHAIN.EVM)?.id;if(d)return d;const f=(await this.getProvider()).session?.namespaces[D.CHAIN.EVM]?.chains?.[0];return _.getCaipNetworks().find(g=>g.id===f)?.id},async isAuthorized(){try{const[d,h]=await Promise.all([this.getAccounts(),this.getProvider()]);return d.length?await this.isChainsStale()&&h.session?(await h.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:d,chainId:h}){const f=await this.getProvider();if(!f)throw new ms;const p=_.getCaipNetworks().find(g=>g.id===h);if(!p)throw new Ir(new lc);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:Ae(h)}]}),p?.caipNetworkId&&f.setDefaultChain(p?.caipNetworkId),u.emitter.emit("change",{chainId:Number(h)});const g=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...g,h]),{...p,id:p.id}}catch(g){const m=g;if(/(?:user rejected)/iu.test(m.message))throw new ot(m);try{let b;d?.blockExplorerUrls?b=d.blockExplorerUrls:b=p.blockExplorers?.default.url?[p.blockExplorers?.default.url]:[];const v=p.rpcUrls?.chainDefault?.http||[],C={blockExplorerUrls:b,chainId:Ae(h),chainName:p.name,iconUrls:d?.iconUrls,nativeCurrency:p.nativeCurrency,rpcUrls:v};await f.request({method:"wallet_addEthereumChain",params:[C]});const N=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...N,h]),{...p,id:p.id}}catch(b){throw new ot(b)}}},onAccountsChanged(d){d.length===0?this.onDisconnect():u.emitter.emit("change",{accounts:d.map(h=>Ks(h))})},onChainChanged(d){const h=Number(d);u.emitter.emit("change",{chainId:h})},onConnect(d){this.setRequestedChainsIds(_.getCaipNetworks().map(h=>Number(h.id)))},async onDisconnect(d){this.setRequestedChainsIds([]),u.emitter.emit("disconnect");const h=await this.getProvider();s&&(h.removeListener("accountsChanged",s),s=void 0),i&&(h.removeListener("chainChanged",i),i=void 0),l&&(h.removeListener("disconnect",l),l=void 0),c&&(h.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),h.on("connect",o))},onDisplayUri(d){u.emitter.emit("message",{type:"display_uri",data:d})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){return r?.session?.namespaces?r?.session?.namespaces[D.CHAIN.EVM]?.accounts?.map(f=>Number.parseInt(f.split(":")[1]??""))??[]:[]},async getRequestedChainsIds(){const d=await u.storage?.getItem(this.requestedChainsStorageKey)??[];return[...new Set(d)]},async isChainsStale(){if(!n)return!1;const d=u.chains.map(p=>p.id),h=this.getNamespaceChainsIds();if(h.length&&!h.some(p=>d.includes(p)))return!1;const f=await this.getRequestedChainsIds();return!d.every(p=>f.includes(Number(p)))},async setRequestedChainsIds(d){await u.storage?.setItem(this.requestedChainsStorageKey,d)},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const Xo=Ye({pendingTransactions:0}),rw={state:Xo,subscribeKey(t,e){return _t(Xo,t,e)},increase(t){Xo[t]+=1},decrease(t){Xo[t]-=1},reset(t){Xo[t]=0}};async function K7(t){if(ee.isSafeApp()){const{safe:e}=await dt(async()=>{const{safe:n}=await import("./DbHy8J_E.js");return{safe:n}},__vite__mapDeps([61,11]),import.meta.url);if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function G7(t){try{const{coinbaseWallet:e}=await dt(async()=>{const{coinbaseWallet:n}=await import("./DbHy8J_E.js");return{coinbaseWallet:n}},__vite__mapDeps([61,11]),import.meta.url);if(e&&!t.some(n=>n.id==="coinbaseWalletSDK"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const Y7={enable:!1,pollingInterval:3e4};class GH extends Mv{constructor(e){const n=gr.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=D.CHAIN.EVM,this.adapterType=D.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...Y7,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===D.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!i?.user)return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>ee.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=ya(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>ee.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=ya(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===D.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{const i=e.transports?.[s.id],o=gr.getCaipNetworkId(s);i?n[s.id]=gr.extendWagmiTransports(s,e.projectId,i):n[s.id]=gr.getViemTransport(s,e.projectId,e.customRpcUrls?.[o])}),this.wagmiConfig=z7({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=N7(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),rw.increase("pendingTransactions")}});const e=rw.subscribeKey("pendingTransactions",n=>{n>=D.LIMITS.PENDING_TRANSACTIONS&&(this.unwatchPendingTransactions?.(),e())})}setupWatchers(){I7(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===D.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:this.toChecksummedAddress(i)})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:j.getConnectedSocialProvider(),username:j.getConnectedSocialUsername()}:void 0}}))}}),A7(this.wagmiConfig,{onChange:(e,n)=>{if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e?.chainId&&e?.chainId!==n?.chainId&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const r=e.address!==n?.address,s=e.connector.id!==n.connector?.id,i=n.status!=="connected";(r||s||i)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}})}async addThirdPartyConnectors(e){const n=[];if(e.enableCoinbase!==!1){const s=await G7(this.wagmiConfig.connectors);s&&n.push(s)}const r=await K7(this.wagmiConfig.connectors);r&&n.push(r),await Promise.all(n.map(s=>{const i=this.wagmiConfig._internal.connectors.setup(s);return this.wagmiConfig._internal.connectors.setState(o=>[...o,i]),this.addWagmiConnector(i,e)}))}addWagmiConnectors(e,n){const r=[];r.push(Lp(e,n)),e.enableInjected!==!1&&r.push(Mu({shimDisconnect:!0}));const s=n?.remoteFeatures?.email??n?.features?.email??!0,i=n?.remoteFeatures?.socials??n?.features?.socials,o=Array.isArray(i)&&i?.length>0;(s||o)&&r.push(V7({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),r.forEach(a=>{const c=this.wagmiConfig._internal.connectors.setup(a);this.wagmiConfig._internal.connectors.setState(l=>[...l,c])})}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:this.toChecksummedAddress(e),chainId:n,connector:{id:r.id,name:yn.ConnectorNamesMap[r.id]??r.name,imageId:yn.ConnectorImageIds[r.id],type:yn.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===D.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async signMessage(e){try{return{signature:await v7(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:n,address:r}=ya(this.wagmiConfig),s={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chainId:n,type:"legacy",parameters:["nonce"]};await b7(this.wagmiConfig,s);const i=await E7(this.wagmiConfig,s);return await _7(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){const{caipNetwork:n,...r}=e,s=Number(Ea.caipNetworkIdToNumber(n.caipNetworkId));return{hash:await T7(this.wagmiConfig,{chain:this.wagmiChains?.[s],chainId:s,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await p7(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return T2(e.value,e.decimals)}formatUnits(e){return vi(e.value,e.decimals)}async addWagmiConnector(e,n){if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");if(e.type===D.CONNECTOR_ID.INJECTED&&n.enableEIP6963===!1||e.id===D.CONNECTOR_ID.AUTH||e.id===D.CONNECTOR_ID.WALLET_CONNECT)return;const r=await e.getProvider().catch(()=>{});this.addConnector({id:e.id,explorerId:yn.ConnectorExplorerIds[e.id],imageUrl:n?.connectorImages?.[e.id]??e.icon,name:yn.ConnectorNamesMap[e.id]??e.name,imageId:yn.ConnectorImageIds[e.id],type:yn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===D.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(e,n){S7(this.wagmiConfig,{onChange:r=>{r.forEach(s=>this.addWagmiConnector(s,e))}}),this.addWagmiConnectors(e,n),await Promise.all(this.wagmiConfig.connectors.map(r=>this.addWagmiConnector(r,e))),this.addThirdPartyConnectors(e)}async syncConnections(){return Promise.resolve()}async syncConnection(e){const{id:n,chainId:r}=e,i=jr(this.wagmiConfig).find(l=>l.connector.id===n),a=await this.getWagmiConnector(n)?.getProvider();if(ee.isSafeApp()&&n===D.CONNECTOR_ID.SAFE&&!i?.accounts.length){const l=this.getWagmiConnector("safe");if(l){const u=await eh(this.wagmiConfig,{connector:l,chainId:Number(r)}),d=await l.getProvider();return{chainId:Number(r),address:this.toChecksummedAddress(u.accounts[0]),provider:d,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}}return{chainId:Number(i?.chainId),address:this.toChecksummedAddress(i?.accounts[0]),provider:a,type:i?.connector.type?.toUpperCase(),id:i?.connector.id}}async connectWalletConnect(e){try{const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await eh(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await Qy(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}catch(n){throw n instanceof ot?new Ji(n):mr.isUserRejectedRequestError(n)?new Ji(n):n}}async connect(e){try{const{id:n,address:r,provider:s,type:i,info:o,chainId:a,socialUri:c}=e,l=this.getWagmiConnector(n);if(!l)throw new Error("connectionControllerClient:connectExternal - connector is undefined");s&&o&&l.id===D.CONNECTOR_ID.EIP6963&&l.setEip6963Wallet?.({provider:s,info:o});const u=this.wagmiConfig.state?.connections?.get(l.uid);if(u){await this.wagmiConfig.storage?.setItem("recentConnectorId",l.id);const h=[...u.accounts].sort((f,p)=>st.isLowerCaseMatch(f,r)?-1:st.isLowerCaseMatch(p,r)?1:0);return this.wagmiConfig?.setState(f=>({...f,connections:new Map(f.connections).set(l.uid,{accounts:h,chainId:u.chainId,connector:u.connector}),current:l.uid,status:"connected"})),{address:this.toChecksummedAddress(h[0]),chainId:u.chainId,provider:s,type:i,id:n}}const d=await eh(this.wagmiConfig,{connector:l,chainId:a?Number(a):void 0,socialUri:c});return{address:this.toChecksummedAddress(d.accounts[0]),chainId:d.chainId,provider:s,type:i,id:n}}catch(n){throw n instanceof ot?new Ji(n):mr.isUserRejectedRequestError(n)?new Ji(n):n}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:this.toChecksummedAddress(n)})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await Xy(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=j.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{try{const c=Number(e.chainId),l=await w7(this.wagmiConfig,{address:e.address,chainId:c,token:e.tokens?.[r.caipNetworkId]?.address});j.updateNativeBalanceCache({caipAddress:s,balance:l.formatted,symbol:l.symbol,timestamp:Date.now()}),a({balance:l.formatted,symbol:l.symbol})}catch(c){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",c),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){return this.getWagmiConnector("walletConnect")?.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=jr(this.wagmiConfig).find(i=>st.isLowerCaseMatch(i.connector.id,e.id));return await Zy(this.wagmiConfig,{connector:n}),F.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:this.toChecksummedAddress(i)})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=jr(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await Zy(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:this.toChecksummedAddress(s)})),connectorId:r.connector.id}))}}async switchNetwork(e){const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(s=>s.id.toString()===n.id.toString());await Qy(this.wagmiConfig,{chainId:n.id,addEthereumChainParameter:{chainName:r?.name??n.name,nativeCurrency:r?.nativeCurrency??n.nativeCurrency,rpcUrls:[n.rpcUrls?.chainDefault?.http?.[0]??r?.rpcUrls?.default?.http?.[0]??""],blockExplorerUrls:[r?.blockExplorers?.default?.url??n.blockExplorers?.default?.url??""]}}),await super.switchNetwork(e)}async getCapabilities(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=jr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=jr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=jr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=jr(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:D.CONNECTOR_ID.AUTH,type:"AUTH",name:D.CONNECTOR_NAMES.AUTH,provider:e,imageId:yn.ConnectorImageIds[D.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){return e.on("connect",()=>{const n=jr(this.wagmiConfig),r=this.getWagmiConnector("walletConnect");if(r&&!n.find(s=>s.connector.id===r.id)){if(_.state.activeChain==="eip155")return;Xy(this.wagmiConfig,{connectors:[r]})}}),this.addConnector(new Mp({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}toChecksummedAddress(e){return pc(e.toLowerCase())}}const YH="0884ac76a4fd711a06280ccd6ed32db7";export{dj as $,T_ as A,r0 as B,u_ as C,Iw as D,ou as E,P_ as F,x_ as G,R_ as H,sj as I,oj as J,aj as K,Sw as L,cj as M,O_ as N,Nw as O,_l as P,k_ as Q,lj as R,s_ as S,uj as T,c_ as U,lh as V,Tw as W,U_ as X,$_ as Y,M_ as Z,L_ as _,ij as a,Da as a$,ci as a0,W as a1,tb as a2,Ah as a3,JI as a4,XI as a5,Eb as a6,GA as a7,Zw as a8,YA as a9,Hf as aA,h0 as aB,Fa as aC,Ba as aD,La as aE,ka as aF,Ua as aG,li as aH,Na as aI,Sa as aJ,Aa as aK,Pa as aL,lo as aM,Ia as aN,Gs as aO,_a as aP,Oa as aQ,vn as aR,Ta as aS,As as aT,dn as aU,Ir as aV,co as aW,xa as aX,Ma as aY,QA as aZ,$a as a_,ZA as aa,JA as ab,jf as ac,xw as ad,Pw as ae,Rw as af,F_ as ag,j_ as ah,H_ as ai,cI as aj,pI as ak,Vf as al,gI as am,Ys as an,Sl as ao,hh as ap,mh as aq,yh as ar,wh as as,gh as at,fh as au,ph as av,Nl as aw,bh as ax,fu as ay,sa as az,a_ as b,au as b$,Ra as b0,ot as b1,FA as b2,jA as b3,qA as b4,WA as b5,zA as b6,Gw as b7,Yw as b8,VA as b9,cA as bA,uu as bB,Ts as bC,Eo as bD,B_ as bE,Cs as bF,wt as bG,Al as bH,qw as bI,lA as bJ,_s as bK,SA as bL,NA as bM,Vr as bN,TA as bO,io as bP,mj as bQ,ai as bR,Ow as bS,V_ as bT,_r as bU,K_ as bV,Dw as bW,cu as bX,kw as bY,ln as bZ,Ae as b_,M2 as ba,N2 as bb,hu as bc,UA as bd,TI as be,Yf as bf,Ww as bg,vb as bh,du as bi,Mf as bj,xI as bk,EA as bl,pc as bm,Ks as bn,Ar as bo,NI as bp,ob as bq,ab as br,vI as bs,EI as bt,II as bu,AI as bv,f2 as bw,A2 as bx,Cb as by,ao as bz,o_ as c,D as c$,oo as c0,sI as c1,Il as c2,yI as c3,fb as c4,rb as c5,nb as c6,w2 as c7,zf as c8,uI as c9,qj as cA,Fj as cB,Pe as cC,F as cD,OC as cE,Mb as cF,ge as cG,Wj as cH,_t as cI,Rt as cJ,GH as cK,zH as cL,YH as cM,VH as cN,v7 as cO,jH as cP,qH as cQ,WH as cR,wl as cS,LH as cT,uA as cU,bj as cV,bs as cW,ZF as cX,Fn as cY,he as cZ,X as c_,fc as ca,bI as cb,Fw as cc,Of as cd,oA as ce,Uf as cf,c2 as cg,xl as ch,Ob as ci,rI as cj,nI as ck,Dn as cl,pu as cm,SI as cn,Bf as co,an as cp,vi as cq,T2 as cr,vt as cs,Ye as ct,Hj as cu,_ as cv,Se as cw,ee as cx,yr as cy,jj as cz,i_ as d,vo as d$,qt as d0,lt as d1,hS as d2,rt as d3,Qf as d4,K as d5,KH as d6,lc as d7,ms as d8,Mu as d9,He as dA,UC as dB,va as dC,oa as dD,Ph as dE,xn as dF,Ce as dG,ui as dH,mr as dI,On as dJ,de as dK,HH as dL,al as dM,Rv as dN,Af as dO,yo as dP,f_ as dQ,I_ as dR,yw as dS,Zn as dT,oi as dU,rj as dV,bA as dW,Je as dX,hb as dY,Zf as dZ,jI as d_,Ff as da,Ib as db,FH as dc,EF as dd,_e as de,$b as df,tn as dg,Ns as dh,Oj as di,CA as dj,so as dk,j as dl,BH as dm,wn as dn,Jf as dp,Pr as dq,Uu as dr,Un as ds,z7 as dt,ce as du,ue as dv,ze as dw,bF as dx,et as dy,xt as dz,r_ as e,Ea as e$,Ch as e0,Nj as e1,HI as e2,Tl as e3,Tb as e4,d2 as e5,u2 as e6,h2 as e7,y2 as e8,_b as e9,Tj as eA,FC as eB,bb as eC,Mj as eD,ja as eE,O2 as eF,x2 as eG,R2 as eH,g2 as eI,Gf as eJ,P2 as eK,Xu as eL,wI as eM,Ej as eN,sb as eO,vj as eP,ub as eQ,E2 as eR,b2 as eS,ml as eT,Rl as eU,st as eV,_f as eW,gr as eX,pS as eY,gc as eZ,BS as e_,Uj as ea,kj as eb,Nb as ec,$j as ed,Dj as ee,Wf as ef,QI as eg,wj as eh,Qw as ei,lu as ej,Bw as ek,uo as el,qr as em,Cj as en,mb as eo,Aj as ep,qI as eq,Ij as er,Sj as es,ko as et,MI as eu,_j as ev,kb as ew,KI as ex,eb as ey,qf as ez,d_ as f,zr as f0,bo as g,l_ as h,t_ as i,Rb as j,Xf as k,D2 as l,_0 as m,$c as n,Rc as o,Cw as p,Lj as q,_h as r,$2 as s,YI as t,ZI as u,Bj as v,fI as w,MA as x,LA as y,BA as z};
