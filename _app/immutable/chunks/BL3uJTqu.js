import{B as l,o as D,aj as p,u as E,v as T,ak as x,al as H,n as j,am as A,an as B,ao as C,ap as g,aq as N,ar as I,as as O}from"./BsreV6Dk.js";class R extends l{constructor({domain:t}){super(`Invalid domain "${D(t)}".`,{metaMessages:["Must be a valid EIP-712 domain."]})}}class W extends l{constructor({primaryType:t,types:s}){super(`Invalid primary type \`${t}\` must be one of \`${JSON.stringify(Object.keys(s))}\`.`,{docsPath:"/api/glossary/Errors#typeddatainvalidprimarytypeerror",metaMessages:["Check that the primary type is a key in `types`."]})}}class F extends l{constructor({type:t}){super(`Struct type "${t}" is invalid.`,{metaMessages:["Struct type must not be a Solidity type."],name:"InvalidStructTypeError"})}}function Q(e){const{domain:t={},message:s,primaryType:n}=e,r={EIP712Domain:$({domain:t}),...e.types};q({domain:t,message:s,primaryType:n,types:r});const a=["0x1901"];return t&&a.push(P({domain:t,types:r})),n!=="EIP712Domain"&&a.push(v({data:s,primaryType:n,types:r})),p(E(a))}function P({domain:e,types:t}){return v({data:e,primaryType:"EIP712Domain",types:t})}function v({data:e,primaryType:t,types:s}){const n=w({data:e,primaryType:t,types:s});return p(n)}function w({data:e,primaryType:t,types:s}){const n=[{type:"bytes32"}],r=[V({primaryType:t,types:s})];for(const a of s[t]){const[i,f]=M({types:s,name:a.name,type:a.type,value:e[a.name]});n.push(i),r.push(f)}return T(n,r)}function V({primaryType:e,types:t}){const s=x(_({primaryType:e,types:t}));return p(s)}function _({primaryType:e,types:t}){let s="";const n=S({primaryType:e,types:t});n.delete(e);const r=[e,...Array.from(n).sort()];for(const a of r)s+=`${a}(${t[a].map(({name:i,type:f})=>`${f} ${i}`).join(",")})`;return s}function S({primaryType:e,types:t},s=new Set){const n=e.match(/^\w*/u),r=n==null?void 0:n[0];if(s.has(r)||t[r]===void 0)return s;s.add(r);for(const a of t[r])S({primaryType:a.type,types:t},s);return s}function M({types:e,name:t,type:s,value:n}){if(e[s]!==void 0)return[{type:"bytes32"},p(w({data:n,primaryType:s,types:e}))];if(s==="bytes")return n=`0x${(n.length%2?"0":"")+n.slice(2)}`,[{type:"bytes32"},p(n)];if(s==="string")return[{type:"bytes32"},p(x(n))];if(s.lastIndexOf("]")===s.length-1){const r=s.slice(0,s.lastIndexOf("[")),a=n.map(i=>M({name:t,type:r,types:e,value:i}));return[{type:"bytes32"},p(T(a.map(([i])=>i),a.map(([,i])=>i)))]}return[{type:s},n]}function U(e){const{domain:t,message:s,primaryType:n,types:r}=e,a=(m,h)=>{const c={...h};for(const o of m){const{name:y,type:d}=o;d==="address"&&(c[y]=c[y].toLowerCase())}return c},i=r.EIP712Domain?t?a(r.EIP712Domain,t):{}:{},f=(()=>{if(n!=="EIP712Domain")return a(r[n],s)})();return D({domain:i,message:f,primaryType:n,types:r})}function q(e){const{domain:t,message:s,primaryType:n,types:r}=e,a=(i,f)=>{for(const m of i){const{name:h,type:c}=m,o=f[h],y=c.match(H);if(y&&(typeof o=="number"||typeof o=="bigint")){const[z,u,k]=y;j(o,{signed:u==="int",size:Number.parseInt(k)/8})}if(c==="address"&&typeof o=="string"&&!A(o))throw new B({address:o});const d=c.match(C);if(d){const[z,u]=d;if(u&&g(o)!==Number.parseInt(u))throw new N({expectedSize:Number.parseInt(u),givenSize:g(o)})}const b=r[c];b&&(J(c),a(b,o))}};if(r.EIP712Domain&&t){if(typeof t!="object")throw new R({domain:t});a(r.EIP712Domain,t)}if(n!=="EIP712Domain")if(r[n])a(r[n],s);else throw new W({primaryType:n,types:r})}function $({domain:e}){return[typeof(e==null?void 0:e.name)=="string"&&{name:"name",type:"string"},(e==null?void 0:e.version)&&{name:"version",type:"string"},(typeof(e==null?void 0:e.chainId)=="number"||typeof(e==null?void 0:e.chainId)=="bigint")&&{name:"chainId",type:"uint256"},(e==null?void 0:e.verifyingContract)&&{name:"verifyingContract",type:"address"},(e==null?void 0:e.salt)&&{name:"salt",type:"bytes32"}].filter(Boolean)}function X({domain:e}){return P({domain:e,types:{EIP712Domain:$({domain:e})}})}function J(e){if(e==="address"||e==="bool"||e==="string"||e.startsWith("bytes")||e.startsWith("uint")||e.startsWith("int"))throw new F({type:e})}const L=`Ethereum Signed Message:
`;function G(e){const t=typeof e=="string"?I(e):typeof e.raw=="string"?e.raw:O(e.raw),s=I(`${L}${g(t)}`);return E([s,t])}function Y(e,t){return p(G(e),t)}export{R as I,Q as a,W as b,F as c,X as d,P as e,v as f,$ as g,Y as h,L as p,U as s,G as t,q as v};
