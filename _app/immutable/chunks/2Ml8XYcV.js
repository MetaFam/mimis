import{c as code$1,e as encode$1,p as prepare,d as decode$2,s as sha256,f as from$4}from"./M1RXKuGZ.js";import{c as commonjsGlobal,g as getDefaultExportFromCjs}from"./CE1G-McA.js";import{C as CID,f as fromHex}from"./C6yTcgQs.js";var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=e;function e(t,n){for(var r=new Array(arguments.length-1),i=0,o=2,s=!0;o<arguments.length;)r[i++]=arguments[o++];return new Promise(function(u,l){r[i]=function(h){if(s)if(s=!1,h)l(h);else{for(var f=new Array(arguments.length-1),g=0;g<f.length;)f[g++]=arguments[g];u.apply(null,f)}};try{t.apply(n||null,r)}catch(y){s&&(s=!1,l(y))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,(function(e){var t=e;t.length=function(a){var u=a.length;if(!u)return 0;for(var l=0;--u%4>1&&a.charAt(u)==="=";)++l;return Math.ceil(a.length*3)/4-l};for(var n=new Array(64),r=new Array(123),i=0;i<64;)r[n[i]=i<26?i+65:i<52?i+71:i<62?i-4:i-59|43]=i++;t.encode=function(a,u,l){for(var y=null,h=[],f=0,g=0,m;u<l;){var c=a[u++];switch(g){case 0:h[f++]=n[c>>2],m=(c&3)<<4,g=1;break;case 1:h[f++]=n[m|c>>4],m=(c&15)<<2,g=2;break;case 2:h[f++]=n[m|c>>6],h[f++]=n[c&63],g=0;break}f>8191&&((y||(y=[])).push(String.fromCharCode.apply(String,h)),f=0)}return g&&(h[f++]=n[m],h[f++]=61,g===1&&(h[f++]=61)),y?(f&&y.push(String.fromCharCode.apply(String,h.slice(0,f))),y.join("")):String.fromCharCode.apply(String,h.slice(0,f))};var o="invalid encoding";t.decode=function(a,u,l){for(var y=l,h=0,f,g=0;g<a.length;){var m=a.charCodeAt(g++);if(m===61&&h>1)break;if((m=r[m])===void 0)throw Error(o);switch(h){case 0:f=m,h=1;break;case 1:u[l++]=f<<2|(m&48)>>4,f=m,h=2;break;case 2:u[l++]=(f&15)<<4|(m&60)>>2,f=m,h=3;break;case 3:u[l++]=(f&3)<<6|m,h=0;break}}if(h===1)throw Error(o);return l-y},t.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}})(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=e;function e(){this._listeners={}}return e.prototype.on=function(n,r,i){return(this._listeners[n]||(this._listeners[n]=[])).push({fn:r,ctx:i||this}),this},e.prototype.off=function(n,r){if(n===void 0)this._listeners={};else if(r===void 0)this._listeners[n]=[];else for(var i=this._listeners[n],o=0;o<i.length;)i[o].fn===r?i.splice(o,1):++o;return this},e.prototype.emit=function(n){var r=this._listeners[n];if(r){for(var i=[],o=1;o<arguments.length;)i.push(arguments[o++]);for(o=0;o<r.length;)r[o].fn.apply(r[o++].ctx,i)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=e(e);function e(o){return typeof Float32Array<"u"?(function(){var s=new Float32Array([-0]),a=new Uint8Array(s.buffer),u=a[3]===128;function l(g,m,c){s[0]=g,m[c]=a[0],m[c+1]=a[1],m[c+2]=a[2],m[c+3]=a[3]}function y(g,m,c){s[0]=g,m[c]=a[3],m[c+1]=a[2],m[c+2]=a[1],m[c+3]=a[0]}o.writeFloatLE=u?l:y,o.writeFloatBE=u?y:l;function h(g,m){return a[0]=g[m],a[1]=g[m+1],a[2]=g[m+2],a[3]=g[m+3],s[0]}function f(g,m){return a[3]=g[m],a[2]=g[m+1],a[1]=g[m+2],a[0]=g[m+3],s[0]}o.readFloatLE=u?h:f,o.readFloatBE=u?f:h})():(function(){function s(u,l,y,h){var f=l<0?1:0;if(f&&(l=-l),l===0)u(1/l>0?0:2147483648,y,h);else if(isNaN(l))u(2143289344,y,h);else if(l>34028234663852886e22)u((f<<31|2139095040)>>>0,y,h);else if(l<11754943508222875e-54)u((f<<31|Math.round(l/1401298464324817e-60))>>>0,y,h);else{var g=Math.floor(Math.log(l)/Math.LN2),m=Math.round(l*Math.pow(2,-g)*8388608)&8388607;u((f<<31|g+127<<23|m)>>>0,y,h)}}o.writeFloatLE=s.bind(null,t),o.writeFloatBE=s.bind(null,n);function a(u,l,y){var h=u(l,y),f=(h>>31)*2+1,g=h>>>23&255,m=h&8388607;return g===255?m?NaN:f*(1/0):g===0?f*1401298464324817e-60*m:f*Math.pow(2,g-150)*(m+8388608)}o.readFloatLE=a.bind(null,r),o.readFloatBE=a.bind(null,i)})(),typeof Float64Array<"u"?(function(){var s=new Float64Array([-0]),a=new Uint8Array(s.buffer),u=a[7]===128;function l(g,m,c){s[0]=g,m[c]=a[0],m[c+1]=a[1],m[c+2]=a[2],m[c+3]=a[3],m[c+4]=a[4],m[c+5]=a[5],m[c+6]=a[6],m[c+7]=a[7]}function y(g,m,c){s[0]=g,m[c]=a[7],m[c+1]=a[6],m[c+2]=a[5],m[c+3]=a[4],m[c+4]=a[3],m[c+5]=a[2],m[c+6]=a[1],m[c+7]=a[0]}o.writeDoubleLE=u?l:y,o.writeDoubleBE=u?y:l;function h(g,m){return a[0]=g[m],a[1]=g[m+1],a[2]=g[m+2],a[3]=g[m+3],a[4]=g[m+4],a[5]=g[m+5],a[6]=g[m+6],a[7]=g[m+7],s[0]}function f(g,m){return a[7]=g[m],a[6]=g[m+1],a[5]=g[m+2],a[4]=g[m+3],a[3]=g[m+4],a[2]=g[m+5],a[1]=g[m+6],a[0]=g[m+7],s[0]}o.readDoubleLE=u?h:f,o.readDoubleBE=u?f:h})():(function(){function s(u,l,y,h,f,g){var m=h<0?1:0;if(m&&(h=-h),h===0)u(0,f,g+l),u(1/h>0?0:2147483648,f,g+y);else if(isNaN(h))u(0,f,g+l),u(2146959360,f,g+y);else if(h>17976931348623157e292)u(0,f,g+l),u((m<<31|2146435072)>>>0,f,g+y);else{var c;if(h<22250738585072014e-324)c=h/5e-324,u(c>>>0,f,g+l),u((m<<31|c/4294967296)>>>0,f,g+y);else{var d=Math.floor(Math.log(h)/Math.LN2);d===1024&&(d=1023),c=h*Math.pow(2,-d),u(c*4503599627370496>>>0,f,g+l),u((m<<31|d+1023<<20|c*1048576&1048575)>>>0,f,g+y)}}}o.writeDoubleLE=s.bind(null,t,0,4),o.writeDoubleBE=s.bind(null,n,4,0);function a(u,l,y,h,f){var g=u(h,f+l),m=u(h,f+y),c=(m>>31)*2+1,d=m>>>20&2047,p=4294967296*(m&1048575)+g;return d===2047?p?NaN:c*(1/0):d===0?c*5e-324*p:c*Math.pow(2,d-1075)*(p+4503599627370496)}o.readDoubleLE=a.bind(null,r,0,4),o.readDoubleBE=a.bind(null,i,4,0)})(),o}function t(o,s,a){s[a]=o&255,s[a+1]=o>>>8&255,s[a+2]=o>>>16&255,s[a+3]=o>>>24}function n(o,s,a){s[a]=o>>>24,s[a+1]=o>>>16&255,s[a+2]=o>>>8&255,s[a+3]=o&255}function r(o,s){return(o[s]|o[s+1]<<8|o[s+2]<<16|o[s+3]<<24)>>>0}function i(o,s){return(o[s]<<24|o[s+1]<<16|o[s+2]<<8|o[s+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}return inquire_1}var utf8$3={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,(function(e){var t=e;t.length=function(r){for(var i=0,o=0,s=0;s<r.length;++s)o=r.charCodeAt(s),o<128?i+=1:o<2048?i+=2:(o&64512)===55296&&(r.charCodeAt(s+1)&64512)===56320?(++s,i+=4):i+=3;return i},t.read=function(r,i,o){var s=o-i;if(s<1)return"";for(var a=null,u=[],l=0,y;i<o;)y=r[i++],y<128?u[l++]=y:y>191&&y<224?u[l++]=(y&31)<<6|r[i++]&63:y>239&&y<365?(y=((y&7)<<18|(r[i++]&63)<<12|(r[i++]&63)<<6|r[i++]&63)-65536,u[l++]=55296+(y>>10),u[l++]=56320+(y&1023)):u[l++]=(y&15)<<12|(r[i++]&63)<<6|r[i++]&63,l>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,u)),l=0);return a?(l&&a.push(String.fromCharCode.apply(String,u.slice(0,l))),a.join("")):String.fromCharCode.apply(String,u.slice(0,l))},t.write=function(r,i,o){for(var s=o,a,u,l=0;l<r.length;++l)a=r.charCodeAt(l),a<128?i[o++]=a:a<2048?(i[o++]=a>>6|192,i[o++]=a&63|128):(a&64512)===55296&&((u=r.charCodeAt(l+1))&64512)===56320?(a=65536+((a&1023)<<10)+(u&1023),++l,i[o++]=a>>18|240,i[o++]=a>>12&63|128,i[o++]=a>>6&63|128,i[o++]=a&63|128):(i[o++]=a>>12|224,i[o++]=a>>6&63|128,i[o++]=a&63|128);return o-s}})(utf8$3)),utf8$3}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=e;function e(t,n,r){var i=r||8192,o=i>>>1,s=null,a=i;return function(l){if(l<1||l>o)return t(l);a+l>i&&(s=t(i),a=0);var y=n.call(s,a,a+=l);return a&7&&(a=(a|7)+1),y}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var e=requireMinimal$1();function t(o,s){this.lo=o>>>0,this.hi=s>>>0}var n=t.zero=new t(0,0);n.toNumber=function(){return 0},n.zzEncode=n.zzDecode=function(){return this},n.length=function(){return 1};var r=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(s){if(s===0)return n;var a=s<0;a&&(s=-s);var u=s>>>0,l=(s-u)/4294967296>>>0;return a&&(l=~l>>>0,u=~u>>>0,++u>4294967295&&(u=0,++l>4294967295&&(l=0))),new t(u,l)},t.from=function(s){if(typeof s=="number")return t.fromNumber(s);if(e.isString(s))if(e.Long)s=e.Long.fromString(s);else return t.fromNumber(parseInt(s,10));return s.low||s.high?new t(s.low>>>0,s.high>>>0):n},t.prototype.toNumber=function(s){if(!s&&this.hi>>>31){var a=~this.lo+1>>>0,u=~this.hi>>>0;return a||(u=u+1>>>0),-(a+u*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(s){return e.Long?new e.Long(this.lo|0,this.hi|0,!!s):{low:this.lo|0,high:this.hi|0,unsigned:!!s}};var i=String.prototype.charCodeAt;return t.fromHash=function(s){return s===r?n:new t((i.call(s,0)|i.call(s,1)<<8|i.call(s,2)<<16|i.call(s,3)<<24)>>>0,(i.call(s,4)|i.call(s,5)<<8|i.call(s,6)<<16|i.call(s,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var s=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^s)>>>0,this.lo=(this.lo<<1^s)>>>0,this},t.prototype.zzDecode=function(){var s=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^s)>>>0,this.hi=(this.hi>>>1^s)>>>0,this},t.prototype.length=function(){var s=this.lo,a=(this.lo>>>28|this.hi<<4)>>>0,u=this.hi>>>24;return u===0?a===0?s<16384?s<128?1:2:s<2097152?3:4:a<16384?a<128?5:6:a<2097152?7:8:u<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,(function(e){var t=e;t.asPromise=requireAspromise(),t.base64=requireBase64(),t.EventEmitter=requireEventemitter(),t.float=requireFloat(),t.inquire=requireInquire(),t.utf8=requireUtf8(),t.pool=requirePool(),t.LongBits=requireLongbits(),t.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(o){return typeof o=="number"&&isFinite(o)&&Math.floor(o)===o},t.isString=function(o){return typeof o=="string"||o instanceof String},t.isObject=function(o){return o&&typeof o=="object"},t.isset=t.isSet=function(o,s){var a=o[s];return a!=null&&o.hasOwnProperty(s)?typeof a!="object"||(Array.isArray(a)?a.length:Object.keys(a).length)>0:!1},t.Buffer=(function(){try{var i=t.inquire("buffer").Buffer;return i.prototype.utf8Write?i:null}catch{return null}})(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(o){return typeof o=="number"?t.Buffer?t._Buffer_allocUnsafe(o):new t.Array(o):t.Buffer?t._Buffer_from(o):typeof Uint8Array>"u"?o:new Uint8Array(o)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(o){return o?t.LongBits.from(o).toHash():t.LongBits.zeroHash},t.longFromHash=function(o,s){var a=t.LongBits.fromHash(o);return t.Long?t.Long.fromBits(a.lo,a.hi,s):a.toNumber(!!s)};function n(i,o,s){for(var a=Object.keys(o),u=0;u<a.length;++u)(i[a[u]]===void 0||!s)&&(i[a[u]]=o[a[u]]);return i}t.merge=n,t.lcFirst=function(o){return o.charAt(0).toLowerCase()+o.substring(1)};function r(i){function o(s,a){if(!(this instanceof o))return new o(s,a);Object.defineProperty(this,"message",{get:function(){return s}}),Error.captureStackTrace?Error.captureStackTrace(this,o):Object.defineProperty(this,"stack",{value:new Error().stack||""}),a&&n(this,a)}return o.prototype=Object.create(Error.prototype,{constructor:{value:o,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return i},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),o}t.newError=r,t.ProtocolError=r("ProtocolError"),t.oneOfGetter=function(o){for(var s={},a=0;a<o.length;++a)s[o[a]]=1;return function(){for(var u=Object.keys(this),l=u.length-1;l>-1;--l)if(s[u[l]]===1&&this[u[l]]!==void 0&&this[u[l]]!==null)return u[l]}},t.oneOfSetter=function(o){return function(s){for(var a=0;a<o.length;++a)o[a]!==s&&delete this[o[a]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var i=t.Buffer;if(!i){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=i.from!==Uint8Array.from&&i.from||function(s,a){return new i(s,a)},t._Buffer_allocUnsafe=i.allocUnsafe||function(s){return new i(s)}}})(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=u;var e=requireMinimal$1(),t,n=e.LongBits,r=e.base64,i=e.utf8;function o(d,p,k){this.fn=d,this.len=p,this.next=void 0,this.val=k}function s(){}function a(d){this.head=d.head,this.tail=d.tail,this.len=d.len,this.next=d.states}function u(){this.len=0,this.head=new o(s,0,0),this.tail=this.head,this.states=null}var l=function(){return e.Buffer?function(){return(u.create=function(){return new t})()}:function(){return new u}};u.create=l(),u.alloc=function(p){return new e.Array(p)},e.Array!==Array&&(u.alloc=e.pool(u.alloc,e.Array.prototype.subarray)),u.prototype._push=function(p,k,w){return this.tail=this.tail.next=new o(p,k,w),this.len+=k,this};function y(d,p,k){p[k]=d&255}function h(d,p,k){for(;d>127;)p[k++]=d&127|128,d>>>=7;p[k]=d}function f(d,p){this.len=d,this.next=void 0,this.val=p}f.prototype=Object.create(o.prototype),f.prototype.fn=h,u.prototype.uint32=function(p){return this.len+=(this.tail=this.tail.next=new f((p=p>>>0)<128?1:p<16384?2:p<2097152?3:p<268435456?4:5,p)).len,this},u.prototype.int32=function(p){return p<0?this._push(g,10,n.fromNumber(p)):this.uint32(p)},u.prototype.sint32=function(p){return this.uint32((p<<1^p>>31)>>>0)};function g(d,p,k){for(;d.hi;)p[k++]=d.lo&127|128,d.lo=(d.lo>>>7|d.hi<<25)>>>0,d.hi>>>=7;for(;d.lo>127;)p[k++]=d.lo&127|128,d.lo=d.lo>>>7;p[k++]=d.lo}u.prototype.uint64=function(p){var k=n.from(p);return this._push(g,k.length(),k)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(p){var k=n.from(p).zzEncode();return this._push(g,k.length(),k)},u.prototype.bool=function(p){return this._push(y,1,p?1:0)};function m(d,p,k){p[k]=d&255,p[k+1]=d>>>8&255,p[k+2]=d>>>16&255,p[k+3]=d>>>24}u.prototype.fixed32=function(p){return this._push(m,4,p>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(p){var k=n.from(p);return this._push(m,4,k.lo)._push(m,4,k.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(p){return this._push(e.float.writeFloatLE,4,p)},u.prototype.double=function(p){return this._push(e.float.writeDoubleLE,8,p)};var c=e.Array.prototype.set?function(p,k,w){k.set(p,w)}:function(p,k,w){for(var b=0;b<p.length;++b)k[w+b]=p[b]};return u.prototype.bytes=function(p){var k=p.length>>>0;if(!k)return this._push(y,1,0);if(e.isString(p)){var w=u.alloc(k=r.length(p));r.decode(p,w,0),p=w}return this.uint32(k)._push(c,k,p)},u.prototype.string=function(p){var k=i.length(p);return k?this.uint32(k)._push(i.write,k,p):this._push(y,1,0)},u.prototype.fork=function(){return this.states=new a(this),this.head=this.tail=new o(s,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new o(s,0,0),this.len=0),this},u.prototype.ldelim=function(){var p=this.head,k=this.tail,w=this.len;return this.reset().uint32(w),w&&(this.tail.next=p.next,this.tail=k,this.len+=w),this},u.prototype.finish=function(){for(var p=this.head.next,k=this.constructor.alloc(this.len),w=0;p;)p.fn(p.val,k,w),w+=p.len,p=p.next;return k},u._configure=function(d){t=d,u.create=l(),t._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=n;var e=requireWriter();(n.prototype=Object.create(e.prototype)).constructor=n;var t=requireMinimal$1();function n(){e.call(this)}n._configure=function(){n.alloc=t._Buffer_allocUnsafe,n.writeBytesBuffer=t.Buffer&&t.Buffer.prototype instanceof Uint8Array&&t.Buffer.prototype.set.name==="set"?function(o,s,a){s.set(o,a)}:function(o,s,a){if(o.copy)o.copy(s,a,0,o.length);else for(var u=0;u<o.length;)s[a++]=o[u++]}},n.prototype.bytes=function(o){t.isString(o)&&(o=t._Buffer_from(o,"base64"));var s=o.length>>>0;return this.uint32(s),s&&this._push(n.writeBytesBuffer,s,o),this};function r(i,o,s){i.length<40?t.utf8.write(i,o,s):o.utf8Write?o.utf8Write(i,s):o.write(i,s)}return n.prototype.string=function(o){var s=t.Buffer.byteLength(o);return this.uint32(s),s&&this._push(r,s,o),this},n._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=o;var e=requireMinimal$1(),t,n=e.LongBits,r=e.utf8;function i(h,f){return RangeError("index out of range: "+h.pos+" + "+(f||1)+" > "+h.len)}function o(h){this.buf=h,this.pos=0,this.len=h.length}var s=typeof Uint8Array<"u"?function(f){if(f instanceof Uint8Array||Array.isArray(f))return new o(f);throw Error("illegal buffer")}:function(f){if(Array.isArray(f))return new o(f);throw Error("illegal buffer")},a=function(){return e.Buffer?function(g){return(o.create=function(c){return e.Buffer.isBuffer(c)?new t(c):s(c)})(g)}:s};o.create=a(),o.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,o.prototype.uint32=(function(){var f=4294967295;return function(){if(f=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(f=(f|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(f=(f|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return f;if((this.pos+=5)>this.len)throw this.pos=this.len,i(this,10);return f}})(),o.prototype.int32=function(){return this.uint32()|0},o.prototype.sint32=function(){var f=this.uint32();return f>>>1^-(f&1)|0};function u(){var h=new n(0,0),f=0;if(this.len-this.pos>4){for(;f<4;++f)if(h.lo=(h.lo|(this.buf[this.pos]&127)<<f*7)>>>0,this.buf[this.pos++]<128)return h;if(h.lo=(h.lo|(this.buf[this.pos]&127)<<28)>>>0,h.hi=(h.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return h;f=0}else{for(;f<3;++f){if(this.pos>=this.len)throw i(this);if(h.lo=(h.lo|(this.buf[this.pos]&127)<<f*7)>>>0,this.buf[this.pos++]<128)return h}return h.lo=(h.lo|(this.buf[this.pos++]&127)<<f*7)>>>0,h}if(this.len-this.pos>4){for(;f<5;++f)if(h.hi=(h.hi|(this.buf[this.pos]&127)<<f*7+3)>>>0,this.buf[this.pos++]<128)return h}else for(;f<5;++f){if(this.pos>=this.len)throw i(this);if(h.hi=(h.hi|(this.buf[this.pos]&127)<<f*7+3)>>>0,this.buf[this.pos++]<128)return h}throw Error("invalid varint encoding")}o.prototype.bool=function(){return this.uint32()!==0};function l(h,f){return(h[f-4]|h[f-3]<<8|h[f-2]<<16|h[f-1]<<24)>>>0}o.prototype.fixed32=function(){if(this.pos+4>this.len)throw i(this,4);return l(this.buf,this.pos+=4)},o.prototype.sfixed32=function(){if(this.pos+4>this.len)throw i(this,4);return l(this.buf,this.pos+=4)|0};function y(){if(this.pos+8>this.len)throw i(this,8);return new n(l(this.buf,this.pos+=4),l(this.buf,this.pos+=4))}return o.prototype.float=function(){if(this.pos+4>this.len)throw i(this,4);var f=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,f},o.prototype.double=function(){if(this.pos+8>this.len)throw i(this,4);var f=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,f},o.prototype.bytes=function(){var f=this.uint32(),g=this.pos,m=this.pos+f;if(m>this.len)throw i(this,f);if(this.pos+=f,Array.isArray(this.buf))return this.buf.slice(g,m);if(g===m){var c=e.Buffer;return c?c.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,g,m)},o.prototype.string=function(){var f=this.bytes();return r.read(f,0,f.length)},o.prototype.skip=function(f){if(typeof f=="number"){if(this.pos+f>this.len)throw i(this,f);this.pos+=f}else do if(this.pos>=this.len)throw i(this);while(this.buf[this.pos++]&128);return this},o.prototype.skipType=function(h){switch(h){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(h=this.uint32()&7)!==4;)this.skipType(h);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+h+" at offset "+this.pos)}return this},o._configure=function(h){t=h,o.create=a(),t._configure();var f=e.Long?"toLong":"toNumber";e.merge(o.prototype,{int64:function(){return u.call(this)[f](!1)},uint64:function(){return u.call(this)[f](!0)},sint64:function(){return u.call(this).zzDecode()[f](!1)},fixed64:function(){return y.call(this)[f](!0)},sfixed64:function(){return y.call(this)[f](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=n;var e=requireReader();(n.prototype=Object.create(e.prototype)).constructor=n;var t=requireMinimal$1();function n(r){e.call(this,r)}return n._configure=function(){t.Buffer&&(n.prototype._slice=t.Buffer.prototype.slice)},n.prototype.string=function(){var i=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+i,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+i,this.len))},n._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=t;var e=requireMinimal$1();(t.prototype=Object.create(e.EventEmitter.prototype)).constructor=t;function t(n,r,i){if(typeof n!="function")throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=n,this.requestDelimited=!!r,this.responseDelimited=!!i}return t.prototype.rpcCall=function n(r,i,o,s,a){if(!s)throw TypeError("request must be specified");var u=this;if(!a)return e.asPromise(n,u,r,i,o,s);if(!u.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return u.rpcImpl(r,i[u.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(y,h){if(y)return u.emit("error",y,r),a(y);if(h===null){u.end(!0);return}if(!(h instanceof o))try{h=o[u.responseDelimited?"decodeDelimited":"decode"](h)}catch(f){return u.emit("error",f,r),a(f)}return u.emit("data",h,r),a(null,h)})}catch(l){u.emit("error",l,r),setTimeout(function(){a(l)},0);return}},t.prototype.end=function(r){return this.rpcImpl&&(r||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,(function(e){var t=e;t.Service=requireService()})(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,(function(e){var t=e;t.build="minimal",t.Writer=requireWriter(),t.BufferWriter=requireWriter_buffer(),t.Reader=requireReader(),t.BufferReader=requireReader_buffer(),t.util=requireMinimal$1(),t.rpc=requireRpc(),t.roots=requireRoots(),t.configure=n;function n(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}n()})(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var minimalExports=requireMinimal();const $protobuf=getDefaultExportFromCjs(minimalExports),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots.unixfs||($protobuf.roots.unixfs={}),Data=$root.Data=(()=>{function e(t){if(this.blocksizes=[],t)for(var n=Object.keys(t),r=0;r<n.length;++r)t[n[r]]!=null&&(this[n[r]]=t[n[r]])}return e.prototype.Type=0,e.prototype.Data=$util.newBuffer([]),e.prototype.filesize=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=$util.emptyArray,e.prototype.hashType=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.fanout=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(n,r){if(r||(r=$Writer.create()),r.uint32(8).int32(n.Type),n.Data!=null&&Object.hasOwnProperty.call(n,"Data")&&r.uint32(18).bytes(n.Data),n.filesize!=null&&Object.hasOwnProperty.call(n,"filesize")&&r.uint32(24).uint64(n.filesize),n.blocksizes!=null&&n.blocksizes.length)for(var i=0;i<n.blocksizes.length;++i)r.uint32(32).uint64(n.blocksizes[i]);return n.hashType!=null&&Object.hasOwnProperty.call(n,"hashType")&&r.uint32(40).uint64(n.hashType),n.fanout!=null&&Object.hasOwnProperty.call(n,"fanout")&&r.uint32(48).uint64(n.fanout),n.mode!=null&&Object.hasOwnProperty.call(n,"mode")&&r.uint32(56).uint32(n.mode),n.mtime!=null&&Object.hasOwnProperty.call(n,"mtime")&&$root.UnixTime.encode(n.mtime,r.uint32(66).fork()).ldelim(),r},e.decode=function(n,r){n instanceof $Reader||(n=$Reader.create(n));for(var i=r===void 0?n.len:n.pos+r,o=new $root.Data;n.pos<i;){var s=n.uint32();switch(s>>>3){case 1:o.Type=n.int32();break;case 2:o.Data=n.bytes();break;case 3:o.filesize=n.uint64();break;case 4:if(o.blocksizes&&o.blocksizes.length||(o.blocksizes=[]),(s&7)===2)for(var a=n.uint32()+n.pos;n.pos<a;)o.blocksizes.push(n.uint64());else o.blocksizes.push(n.uint64());break;case 5:o.hashType=n.uint64();break;case 6:o.fanout=n.uint64();break;case 7:o.mode=n.uint32();break;case 8:o.mtime=$root.UnixTime.decode(n,n.uint32());break;default:n.skipType(s&7);break}}if(!o.hasOwnProperty("Type"))throw $util.ProtocolError("missing required 'Type'",{instance:o});return o},e.fromObject=function(n){if(n instanceof $root.Data)return n;var r=new $root.Data;switch(n.Type){case"Raw":case 0:r.Type=0;break;case"Directory":case 1:r.Type=1;break;case"File":case 2:r.Type=2;break;case"Metadata":case 3:r.Type=3;break;case"Symlink":case 4:r.Type=4;break;case"HAMTShard":case 5:r.Type=5;break}if(n.Data!=null&&(typeof n.Data=="string"?$util.base64.decode(n.Data,r.Data=$util.newBuffer($util.base64.length(n.Data)),0):n.Data.length&&(r.Data=n.Data)),n.filesize!=null&&($util.Long?(r.filesize=$util.Long.fromValue(n.filesize)).unsigned=!0:typeof n.filesize=="string"?r.filesize=parseInt(n.filesize,10):typeof n.filesize=="number"?r.filesize=n.filesize:typeof n.filesize=="object"&&(r.filesize=new $util.LongBits(n.filesize.low>>>0,n.filesize.high>>>0).toNumber(!0))),n.blocksizes){if(!Array.isArray(n.blocksizes))throw TypeError(".Data.blocksizes: array expected");r.blocksizes=[];for(var i=0;i<n.blocksizes.length;++i)$util.Long?(r.blocksizes[i]=$util.Long.fromValue(n.blocksizes[i])).unsigned=!0:typeof n.blocksizes[i]=="string"?r.blocksizes[i]=parseInt(n.blocksizes[i],10):typeof n.blocksizes[i]=="number"?r.blocksizes[i]=n.blocksizes[i]:typeof n.blocksizes[i]=="object"&&(r.blocksizes[i]=new $util.LongBits(n.blocksizes[i].low>>>0,n.blocksizes[i].high>>>0).toNumber(!0))}if(n.hashType!=null&&($util.Long?(r.hashType=$util.Long.fromValue(n.hashType)).unsigned=!0:typeof n.hashType=="string"?r.hashType=parseInt(n.hashType,10):typeof n.hashType=="number"?r.hashType=n.hashType:typeof n.hashType=="object"&&(r.hashType=new $util.LongBits(n.hashType.low>>>0,n.hashType.high>>>0).toNumber(!0))),n.fanout!=null&&($util.Long?(r.fanout=$util.Long.fromValue(n.fanout)).unsigned=!0:typeof n.fanout=="string"?r.fanout=parseInt(n.fanout,10):typeof n.fanout=="number"?r.fanout=n.fanout:typeof n.fanout=="object"&&(r.fanout=new $util.LongBits(n.fanout.low>>>0,n.fanout.high>>>0).toNumber(!0))),n.mode!=null&&(r.mode=n.mode>>>0),n.mtime!=null){if(typeof n.mtime!="object")throw TypeError(".Data.mtime: object expected");r.mtime=$root.UnixTime.fromObject(n.mtime)}return r},e.toObject=function(n,r){r||(r={});var i={};if((r.arrays||r.defaults)&&(i.blocksizes=[]),r.defaults){if(i.Type=r.enums===String?"Raw":0,r.bytes===String?i.Data="":(i.Data=[],r.bytes!==Array&&(i.Data=$util.newBuffer(i.Data))),$util.Long){var o=new $util.Long(0,0,!0);i.filesize=r.longs===String?o.toString():r.longs===Number?o.toNumber():o}else i.filesize=r.longs===String?"0":0;if($util.Long){var o=new $util.Long(0,0,!0);i.hashType=r.longs===String?o.toString():r.longs===Number?o.toNumber():o}else i.hashType=r.longs===String?"0":0;if($util.Long){var o=new $util.Long(0,0,!0);i.fanout=r.longs===String?o.toString():r.longs===Number?o.toNumber():o}else i.fanout=r.longs===String?"0":0;i.mode=0,i.mtime=null}if(n.Type!=null&&n.hasOwnProperty("Type")&&(i.Type=r.enums===String?$root.Data.DataType[n.Type]:n.Type),n.Data!=null&&n.hasOwnProperty("Data")&&(i.Data=r.bytes===String?$util.base64.encode(n.Data,0,n.Data.length):r.bytes===Array?Array.prototype.slice.call(n.Data):n.Data),n.filesize!=null&&n.hasOwnProperty("filesize")&&(typeof n.filesize=="number"?i.filesize=r.longs===String?String(n.filesize):n.filesize:i.filesize=r.longs===String?$util.Long.prototype.toString.call(n.filesize):r.longs===Number?new $util.LongBits(n.filesize.low>>>0,n.filesize.high>>>0).toNumber(!0):n.filesize),n.blocksizes&&n.blocksizes.length){i.blocksizes=[];for(var s=0;s<n.blocksizes.length;++s)typeof n.blocksizes[s]=="number"?i.blocksizes[s]=r.longs===String?String(n.blocksizes[s]):n.blocksizes[s]:i.blocksizes[s]=r.longs===String?$util.Long.prototype.toString.call(n.blocksizes[s]):r.longs===Number?new $util.LongBits(n.blocksizes[s].low>>>0,n.blocksizes[s].high>>>0).toNumber(!0):n.blocksizes[s]}return n.hashType!=null&&n.hasOwnProperty("hashType")&&(typeof n.hashType=="number"?i.hashType=r.longs===String?String(n.hashType):n.hashType:i.hashType=r.longs===String?$util.Long.prototype.toString.call(n.hashType):r.longs===Number?new $util.LongBits(n.hashType.low>>>0,n.hashType.high>>>0).toNumber(!0):n.hashType),n.fanout!=null&&n.hasOwnProperty("fanout")&&(typeof n.fanout=="number"?i.fanout=r.longs===String?String(n.fanout):n.fanout:i.fanout=r.longs===String?$util.Long.prototype.toString.call(n.fanout):r.longs===Number?new $util.LongBits(n.fanout.low>>>0,n.fanout.high>>>0).toNumber(!0):n.fanout),n.mode!=null&&n.hasOwnProperty("mode")&&(i.mode=n.mode),n.mtime!=null&&n.hasOwnProperty("mtime")&&(i.mtime=$root.UnixTime.toObject(n.mtime,r)),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.DataType=(function(){const t={},n=Object.create(t);return n[t[0]="Raw"]=0,n[t[1]="Directory"]=1,n[t[2]="File"]=2,n[t[3]="Metadata"]=3,n[t[4]="Symlink"]=4,n[t[5]="HAMTShard"]=5,n})(),e})();$root.UnixTime=(()=>{function e(t){if(t)for(var n=Object.keys(t),r=0;r<n.length;++r)t[n[r]]!=null&&(this[n[r]]=t[n[r]])}return e.prototype.Seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(n,r){return r||(r=$Writer.create()),r.uint32(8).int64(n.Seconds),n.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(n,"FractionalNanoseconds")&&r.uint32(21).fixed32(n.FractionalNanoseconds),r},e.decode=function(n,r){n instanceof $Reader||(n=$Reader.create(n));for(var i=r===void 0?n.len:n.pos+r,o=new $root.UnixTime;n.pos<i;){var s=n.uint32();switch(s>>>3){case 1:o.Seconds=n.int64();break;case 2:o.FractionalNanoseconds=n.fixed32();break;default:n.skipType(s&7);break}}if(!o.hasOwnProperty("Seconds"))throw $util.ProtocolError("missing required 'Seconds'",{instance:o});return o},e.fromObject=function(n){if(n instanceof $root.UnixTime)return n;var r=new $root.UnixTime;return n.Seconds!=null&&($util.Long?(r.Seconds=$util.Long.fromValue(n.Seconds)).unsigned=!1:typeof n.Seconds=="string"?r.Seconds=parseInt(n.Seconds,10):typeof n.Seconds=="number"?r.Seconds=n.Seconds:typeof n.Seconds=="object"&&(r.Seconds=new $util.LongBits(n.Seconds.low>>>0,n.Seconds.high>>>0).toNumber())),n.FractionalNanoseconds!=null&&(r.FractionalNanoseconds=n.FractionalNanoseconds>>>0),r},e.toObject=function(n,r){r||(r={});var i={};if(r.defaults){if($util.Long){var o=new $util.Long(0,0,!1);i.Seconds=r.longs===String?o.toString():r.longs===Number?o.toNumber():o}else i.Seconds=r.longs===String?"0":0;i.FractionalNanoseconds=0}return n.Seconds!=null&&n.hasOwnProperty("Seconds")&&(typeof n.Seconds=="number"?i.Seconds=r.longs===String?String(n.Seconds):n.Seconds:i.Seconds=r.longs===String?$util.Long.prototype.toString.call(n.Seconds):r.longs===Number?new $util.LongBits(n.Seconds.low>>>0,n.Seconds.high>>>0).toNumber():n.Seconds),n.FractionalNanoseconds!=null&&n.hasOwnProperty("FractionalNanoseconds")&&(i.FractionalNanoseconds=n.FractionalNanoseconds),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();$root.Metadata=(()=>{function e(t){if(t)for(var n=Object.keys(t),r=0;r<n.length;++r)t[n[r]]!=null&&(this[n[r]]=t[n[r]])}return e.prototype.MimeType="",e.encode=function(n,r){return r||(r=$Writer.create()),n.MimeType!=null&&Object.hasOwnProperty.call(n,"MimeType")&&r.uint32(10).string(n.MimeType),r},e.decode=function(n,r){n instanceof $Reader||(n=$Reader.create(n));for(var i=r===void 0?n.len:n.pos+r,o=new $root.Metadata;n.pos<i;){var s=n.uint32();switch(s>>>3){case 1:o.MimeType=n.string();break;default:n.skipType(s&7);break}}return o},e.fromObject=function(n){if(n instanceof $root.Metadata)return n;var r=new $root.Metadata;return n.MimeType!=null&&(r.MimeType=String(n.MimeType)),r},e.toObject=function(n,r){r||(r={});var i={};return r.defaults&&(i.MimeType=""),n.MimeType!=null&&n.hasOwnProperty("MimeType")&&(i.MimeType=n.MimeType),i},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();const NodeType=Data.DataType,EMPTY$3=Object.freeze([]),EMPTY_BUFFER$1=new Uint8Array(0),BLANK$2=Object.freeze({}),DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8),code=code$1,name$1="UnixFS",encodePB=(e,t)=>(Object(globalThis).debug&&console.log({data:e,links:t}),encode$1(prepare({Data:Data.encode(e).finish(),Links:t}))),createRaw=e=>({type:NodeType.Raw,content:e}),createEmptyFile=e=>createSimpleFile(EMPTY_BUFFER$1,e),createSimpleFile=(e,t)=>({type:NodeType.File,layout:"simple",content:e,metadata:decodeMetadata(t)}),createFileChunk=e=>({type:NodeType.File,layout:"simple",content:e}),createAdvancedFile=(e,t)=>({type:NodeType.File,layout:"advanced",parts:e,metadata:decodeMetadata(t)}),createFileShard=e=>({type:NodeType.File,layout:"advanced",parts:e}),createComplexFile=(e,t,n)=>({type:NodeType.File,layout:"complex",content:e,parts:t,metadata:decodeMetadata(n)}),createFlatDirectory=(e,t)=>({type:NodeType.Directory,metadata:decodeMetadata(t),entries:e}),createShardedDirectory=(e,t,n,r,i=BLANK$2)=>({type:NodeType.HAMTShard,bitfield:t,fanout:readFanout(n),hashType:readInt(r),entries:e,metadata:decodeMetadata(i)}),createDirectoryShard=(e,t,n,r)=>({type:NodeType.HAMTShard,bitfield:t,fanout:readFanout(n),hashType:readInt(r),entries:e}),encodeRaw=e=>encodePB({Type:NodeType.Raw,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:EMPTY$3},[]),encodeFile=(e,t=!1)=>{const n=t?BLANK$2:Object(e).metadata;switch(e.layout){case"simple":return encodeSimpleFile(e.content,n);case"advanced":return encodeAdvancedFile(e.parts,n);case"complex":return encodeComplexFile(e.content,e.parts,n);default:throw new TypeError(`File with unknown layout "${Object(e).layout}" was passed`)}},encodeFileChunk=e=>encodeSimpleFile(e,BLANK$2),encodeFileShard=e=>encodePB({Type:NodeType.File,blocksizes:e.map(contentByteLength),filesize:cumulativeContentByteLength(e)},e.map(encodeLink)),encodeAdvancedFile=(e,t=BLANK$2)=>encodePB({Type:NodeType.File,blocksizes:e.map(contentByteLength),filesize:cumulativeContentByteLength(e),...encodeMetadata(t)},e.map(encodeLink)),encodeLink=e=>({Name:"",Tsize:e.dagByteLength,Hash:e.cid}),encodeSimpleFile=(e,t=BLANK$2)=>encodePB({Type:NodeType.File,Data:e.byteLength>0?e:void 0,filesize:e.byteLength,blocksizes:[],...encodeMetadata(t)},[]),encodeComplexFile=(e,t,n=BLANK$2)=>encodePB({Type:NodeType.File,Data:e,filesize:e.byteLength+cumulativeContentByteLength(t),blocksizes:t.map(contentByteLength)},t.map(encodeLink)),encodeDirectory=e=>encodePB({Type:e.type,...encodeDirectoryMetadata(e.metadata||BLANK$2)},e.entries.map(encodeNamedLink)),encodeHAMTShard=({bitfield:e,fanout:t,hashType:n,entries:r,metadata:i=BLANK$2})=>encodePB({Type:NodeType.HAMTShard,Data:e.byteLength>0?e:void 0,fanout:readFanout(t),hashType:readInt(n),...encodeDirectoryMetadata(i)},r.map(encodeNamedLink)),readFanout=e=>{if(Math.log2(e)%1===0)return e;throw new TypeError(`Expected hamt size to be a power of two instead got ${e}`)},readInt=e=>{if(Number.isInteger(e))return e;throw new TypeError(`Expected an integer value instead got ${e}`)},createSymlink=(e,t=BLANK$2)=>({type:NodeType.Symlink,content:e,metadata:decodeMetadata(t)}),encodeSymlink=(e,t=!1)=>{const n=t?BLANK$2:Object(e).metadata;return encodePB({Type:NodeType.Symlink,Data:e.content,...encodeMetadata(n||BLANK$2)},[])},encode=(e,t=!0)=>{switch(e.type){case NodeType.Raw:return encodeRaw(e.content);case NodeType.File:return encodeFile(e);case NodeType.Directory:return encodeDirectory(e);case NodeType.HAMTShard:return encodeHAMTShard(e);case NodeType.Symlink:return encodeSymlink(e);default:throw new Error(`Unknown node type ${Object(e).type}`)}},decode$1=e=>{const t=decode$2(e),n=Data.decode(t.Data),{Type:r,Data:i,mtime:o,mode:s,blocksizes:a,...u}=Data.toObject(n,{defaults:!1,arrays:!0,longs:Number,objects:!1}),l={...s&&{mode:s},...decodeMtime(o)},y=t.Links;switch(n.Type){case NodeType.Raw:return createRaw(i);case NodeType.File:return y.length===0?new SimpleFileView(i,l):i.byteLength===0?new AdvancedFileView(decodeFileLinks(u.blocksizes,y),l):new ComplexFileView(i,decodeFileLinks(u.blocksizes,y),l);case NodeType.Directory:return createFlatDirectory(decodeDirectoryLinks(y),l);case NodeType.HAMTShard:return createShardedDirectory(decodeDirectoryLinks(y),i||EMPTY_BUFFER$1,u.fanout,u.hashType,l);case NodeType.Symlink:return createSymlink(i,l);default:throw new TypeError(`Unsupported node type ${n.Type}`)}},decodeMtime=e=>e==null?void 0:{mtime:{secs:e.Seconds,nsecs:e.FractionalNanoseconds||0}},decodeFileLinks=(e,t)=>{const n=[],r=e.length;let i=0;for(;i<r;)n.push({cid:t[i].Hash,dagByteLength:t[i].Tsize||0,contentByteLength:e[i]});return n},decodeDirectoryLinks=e=>e.map(t=>({cid:t.Hash,name:t.Name||"",dagByteLength:t.Tsize||0})),cumulativeContentByteLength=e=>e.reduce((t,n)=>t+n.contentByteLength,0),cumulativeDagByteLength=(e,t)=>t.reduce((n,r)=>n+r.dagByteLength,e.byteLength),contentByteLength=e=>e.contentByteLength,encodeNamedLink=({name:e,dagByteLength:t,cid:n})=>({Name:e,Tsize:t,Hash:n}),encodeDirectoryMetadata=e=>encodeMetadata(e,DEFAULT_DIRECTORY_MODE),encodeMetadata=({mode:e,mtime:t},n=DEFAULT_FILE_MODE)=>({mode:e!=null?encodeMode(e,n):void 0,mtime:t!=null?encodeMTime(t):void 0}),decodeMetadata=e=>e==null?BLANK$2:{...e.mode==null?void 0:{mode:decodeMode(e.mode)},...e.mtime==null?void 0:{mtime:e.mtime}},encodeMTime=e=>e==null?void 0:e.nsecs!==0?{Seconds:e.secs,FractionalNanoseconds:e.nsecs}:{Seconds:e.secs},encodeMode=(e,t)=>{const n=e==null?void 0:decodeMode(e);return n===t||n==null?void 0:n},decodeMode=e=>e&4095|e&4294963200,matchFile=({content:e=EMPTY_BUFFER$1,parts:t=EMPTY$3,metadata:n=BLANK$2,...r})=>t.length===0?new SimpleFileView(e,n):e.byteLength===0?new AdvancedFileView(t,n):new ComplexFileView(e,t,n);class SimpleFileView{constructor(t,n){this.content=t,this.metadata=n,this.layout="simple",this.type=NodeType.File}get filesize(){return this.content.byteLength}encode(){return encodeSimpleFile(this.content,this.metadata)}}class AdvancedFileView{constructor(t,n){this.parts=t,this.metadata=n}get layout(){return"advanced"}get type(){return NodeType.File}get fileSize(){return cumulativeContentByteLength(this.parts)}get blockSizes(){return this.parts.map(contentByteLength)}encode(){return encodeAdvancedFile(this.parts,this.metadata)}}class ComplexFileView{constructor(t,n,r){this.content=t,this.parts=n,this.metadata=r}get layout(){return"complex"}get type(){return NodeType.File}get fileSize(){return this.content.byteLength+cumulativeContentByteLength(this.parts)}get blockSizes(){return this.parts.map(contentByteLength)}encode(){return encodeComplexFile(this.content,this.parts,this.metadata)}}const filesize=e=>{switch(e.type){case NodeType.Raw:case NodeType.Symlink:return e.content.byteLength;case NodeType.File:switch(e.layout){case"simple":return e.content.byteLength;case"advanced":return cumulativeContentByteLength(e.parts);case"complex":return e.content.byteLength+cumulativeContentByteLength(e.parts)}default:return 0}},UnixFS=Object.freeze(Object.defineProperty({__proto__:null,DEFAULT_DIRECTORY_MODE,DEFAULT_FILE_MODE,NodeType,code,createAdvancedFile,createComplexFile,createDirectoryShard,createEmptyFile,createFileChunk,createFileShard,createFlatDirectory,createRaw,createShardedDirectory,createSimpleFile,createSymlink,cumulativeContentByteLength,cumulativeDagByteLength,decode:decode$1,decodeMetadata,encode,encodeAdvancedFile,encodeComplexFile,encodeDirectory,encodeDirectoryMetadata,encodeFile,encodeFileChunk,encodeFileShard,encodeHAMTShard,encodeLink,encodeMetadata,encodeMode,encodeRaw,encodeSimpleFile,encodeSymlink,filesize,matchFile,name:name$1},Symbol.toStringTag,{value:"Module"})),effect=function*(e){const t=yield*e;yield*send(t)};function*current(){return yield CURRENT}const suspend=function*(){yield SUSPEND},wait=function*(e){const t=yield*current();if(isAsync(e)){let n=!1,r;if(e.then(i=>{n=!1,r=i,enqueue(t)},i=>{n=!0,r=i,enqueue(t)}),yield*suspend(),n)throw r;return r}else return main(wake(t)),yield*suspend(),e};function*wake(e){enqueue(e)}const isAsync=e=>e!=null&&typeof e.then=="function",send=function*(e){yield e},listen=function*(e){const t=[];for(const n of Object.entries(e)){const[r,i]=n;i!==NONE&&t.push(yield*fork$1(tag(i,r)))}yield*group(t)},effects=e=>e.length>0?batch(e.map(effect)):NONE;function*batch(e){const t=[];for(const n of e)t.push(yield*fork$1(n));yield*group(t)}const tag=(e,t)=>e===NONE?NONE:e instanceof Tagger?new Tagger([...e.tags,t],e.source):new Tagger([t],e);class Tagger{constructor(t,n){this.tags=t,this.source=n,this.controller}[Symbol.iterator](){return this.controller||(this.controller=this.source[Symbol.iterator]()),this}box(t){if(t.done)return t;switch(t.value){case SUSPEND:case CURRENT:return t;default:{const n=t;let{value:r}=n;for(const i of this.tags)r=withTag(i,r);return n.value=r,n}}}next(t){return this.box(this.controller.next(t))}throw(t){return this.box(this.controller.throw(t))}return(t){return this.box(this.controller.return(t))}get[Symbol.toStringTag](){return"TaggedEffect"}}const none=()=>NONE,withTag=(e,t)=>({type:e,[e]:t}),CURRENT=Symbol("current"),SUSPEND=Symbol("suspend");class Group{static of(t){return t.group||MAIN}static enqueue(t,n){t.group=n,n.stack.active.push(t)}constructor(t,n=[],r=new Set,i=new Stack(n,r)){this.driver=t,this.parent=Group.of(t),this.stack=i,this.id=++ID}}class Main{constructor(){this.status=IDLE,this.stack=new Stack,this.id=0}}class Stack{constructor(t=[],n=new Set){this.active=t,this.idle=n}static size({active:t,idle:n}){return t.length+n.size}}const main=e=>enqueue(e[Symbol.iterator]()),enqueue=e=>{let t=Group.of(e);for(t.stack.active.push(e),t.stack.idle.delete(e);t.parent;){const{idle:n,active:r}=t.parent.stack;if(n.has(t.driver))n.delete(t.driver),r.push(t.driver);else break;t=t.parent}if(MAIN.status===IDLE)for(MAIN.status=ACTIVE;;)try{for(const n of step(MAIN));MAIN.status=IDLE;break}catch{MAIN.stack.active.shift()}},resume=e=>enqueue(e),step=function*(e){const{active:t}=e.stack;let n=t[0];for(e.stack.idle.delete(n);n;){let r=INIT;e:for(;!r.done&&n===t[0];){const i=r.value;switch(i){case SUSPEND:e.stack.idle.add(n);break e;case CURRENT:r=n.next(n);break;default:r=n.next(yield i);break}}t.shift(),n=t[0],e.stack.idle.delete(n)}},fork$1=(e,t)=>new Fork(e,t),exit=(e,t)=>conclude(e,{ok:!0,value:t}),abort=(e,t)=>conclude(e,{ok:!1,error:t});function*conclude(e,t){try{const n=e,r=t.ok?n.return(t.value):n.throw(t.error);if(!r.done)if(r.value===SUSPEND){const{idle:i}=Group.of(n).stack;i.add(n)}else enqueue(n)}catch{}}function*group(e){if(e.length===0)return;const t=yield*current(),n=new Group(t);let r=null;for(const i of e){const{result:o}=i;if(o){!o.ok&&!r&&(r=o);continue}move(i,n)}try{if(r)throw r.error;for(;yield*step(n),Stack.size(n.stack)>0;)yield*suspend()}catch(i){for(const o of n.stack.active)yield*abort(o,i);for(const o of n.stack.idle)yield*abort(o,i),enqueue(o);throw i}}const move=(e,t)=>{const n=Group.of(e);if(n!==t){const{active:r,idle:i}=n.stack,o=t.stack;if(e.group=t,i.has(e))i.delete(e),o.idle.add(e);else{const s=r.indexOf(e);s>=0&&(r.splice(s,1),o.active.push(e))}}};function*join(e){e.status===IDLE&&(yield*e),e.result||(yield*group([e]));const t=e.result;if(t.ok)return t.value;throw t.error}class Future{constructor(t){this.handler=t,this.result}get promise(){const{result:t}=this,n=t==null?new Promise((r,i)=>{this.handler.onsuccess=r,this.handler.onfailure=i}):t.ok?Promise.resolve(t.value):Promise.reject(t.error);return Object.defineProperty(this,"promise",{value:n}),n}then(t,n){return this.activate().promise.then(t,n)}catch(t){return this.activate().promise.catch(t)}finally(t){return this.activate().promise.finally(t)}activate(){return this}}class Fork extends Future{constructor(t,n=BLANK$1,r={},i=INIT){super(r),this.id=++ID,this.name=n.name||"",this.task=t,this.state=i,this.status=IDLE,this.result,this.handler=r,this.controller}*resume(){resume(this)}join(){return join(this)}abort(t){return abort(this,t)}exit(t){return exit(this,t)}get[Symbol.toStringTag](){return"Fork"}*[Symbol.iterator](){return this.activate()}activate(){return this.controller=this.task[Symbol.iterator](),this.status=ACTIVE,enqueue(this),this}panic(t){this.result={ok:!1,error:t},this.status=FINISHED;const{handler:n}=this;throw n.onfailure&&n.onfailure(t),t}step(t){if(this.state=t,t.done){this.result={ok:!0,value:t.value},this.status=FINISHED;const{handler:n}=this;n.onsuccess&&n.onsuccess(t.value)}return t}next(t){try{return this.step(this.controller.next(t))}catch(n){return this.panic(n)}}return(t){try{return this.step(this.controller.return(t))}catch(n){return this.panic(n)}}throw(t){try{return this.step(this.controller.throw(t))}catch(n){return this.panic(n)}}}const loop=function*(e,t){const n=yield*current(),r=new Group(n);for(Group.enqueue(e[Symbol.iterator](),r);;){for(const i of step(r))Group.enqueue(t(i)[Symbol.iterator](),r);if(Stack.size(r.stack)>0)yield*suspend();else break}};let ID=0;const IDLE="idle",ACTIVE="active",FINISHED="finished",INIT={done:!1,value:CURRENT},BLANK$1={},NONE=(function*e(){})(),MAIN=new Main;function Indexed(){}Object.defineProperties(Indexed,{prototype:{value:new Proxy(Object.prototype,{get(e,t,n){return typeof t=="symbol"?Reflect.get(e,t,n):n.get(t)}})}});const empty$2=()=>new BufferView,slice=(e,t=0,n=e.byteLength)=>{const r=[],i=t<0?e.byteLength-t:t,o=n<0?e.byteLength-n:n;if(i===0&&o>=e.byteLength)return e;if(i>o||i>e.byteLength||o<=0)return empty$2();let s=0,a=0;for(const u of e.segments){const l=a+u.byteLength;if(s===0){if(o<=l){const y=u.subarray(i-a,o-a);r.push(y),s=y.byteLength;break}else if(i<l){const y=i===a?u:u.subarray(i-a);r.push(y),s=y.byteLength}}else if(o<=l){const y=o===l?u:u.subarray(0,o-a);r.push(y),s+=y.byteLength;break}else r.push(u),s+=u.byteLength;a=l}return new BufferView(r,e.byteOffset+i,s)},push=(e,t)=>t.byteLength>0?(e.segments.push(t),new BufferView(e.segments,e.byteOffset,e.byteLength+t.byteLength)):e,get$4=(e,t)=>{if(t<e.byteLength){let n=0;for(const r of e.segments){if(t<n+r.byteLength)return r[t-n];n+=r.byteLength}}},copyTo=(e,t,n)=>{let r=n;for(const i of e.segments)t.set(i,r),r+=i.byteLength;return t};function*iterate$1(e){for(const t of e.segments)yield*t}class BufferView extends Indexed{constructor(t=[],n=0,r=0){super(),this.segments=t,this.byteLength=r,this.length=r,this.byteOffset=n}[Symbol.iterator](){return iterate$1(this)}slice(t,n){return slice(this,t,n)}subarray(t,n){return slice(this,t,n)}push(t){return push(this,t)}get(t){return get$4(this,t)}copyTo(t,n){return copyTo(this,t,n)}}const panic=e=>{throw new Error(e)},unreachable=(e,t,...n)=>panic(String.raw(e,JSON.stringify(t),...n)),EMPTY_BUFFER=new Uint8Array(0),EMPTY$2=[],open$1=e=>({config:e,buffer:empty$2()}),write$3=(e,t)=>t.byteLength>0?split(e.config,e.buffer.push(t),!1):{...e,chunks:EMPTY$2},close$3=e=>split(e.config,e.buffer,!0),split=(e,t,n)=>{const r=e.chunker,i=[];let o=0;for(const s of r.cut(r.context,t,n))if(s>0){const a=t.subarray(o,o+s);i.push(a),o+=s}return{config:e,chunks:i,buffer:t.subarray(o)}},mutable=()=>({mutable:!0,needs:{},nodes:{},links:{},linked:EMPTY$1}),addNodes=(e,t)=>{let n=patch(t,{});for(const r of e){const{ready:i,has:o,wants:s}=collect(r.children,n.links);s.length===0?n=patch(n,{links:assign(void 0,o),linked:[{id:r.id,links:i}]}):n=patch(n,{needs:assign(r.id,s),nodes:{[r.id]:{children:r.children,count:s.length}}})}return n},addLink=(e,t,n)=>{const r=n.needs[e],i=n.nodes[r];if(i!=null)if(i.count===1){const{ready:o,has:s}=collect(i.children,{...n.links,[e]:t});return patch(n,{needs:{[e]:void 0},links:assign(void 0,s),nodes:{[r]:void 0},linked:[{id:r,links:o}]})}else return patch(n,{needs:{[e]:void 0},links:{[e]:t},nodes:{[r]:{...i,count:i.count-1}}});else return patch(n,{links:{[e]:t}})},patch=(e,{needs:t,nodes:n,links:r,linked:i})=>{const o=e.mutable?e:{...e},s=e.mutable?BLANK:void 0;return t&&(o.needs=patchDict(e.needs,t,s)),n&&(o.nodes=patchDict(e.nodes,n,s)),r&&(o.links=patchDict(e.links,r,s)),o.linked=i?append(e.linked||EMPTY$1,i,EMPTY$1):e.linked||[],o},assign=(e,t)=>{const n={};for(const r of t)n[r]=e;return n},patchDict=(e,t,n=e)=>{const r=e===n?{...e}:e;for(const i of Object.entries(t)){const[o,s]=i;s==null?delete r[o]:r[o]=s}return r},append=(e,t,n=e)=>{if(e===n)return[...e,...t];for(const r of t)e.push(r);return e},collect=(e,t)=>{const n=[],r=[],i=[];for(const o of e){const s=t[o];s?(n.push(o),i.push(s)):r.push(o)}return{has:n,wants:r,ready:i}},EMPTY$1=Object.freeze([]),BLANK=Object.freeze({}),update=(e,t)=>{switch(e.type){case"write":return write$2(t,e.bytes);case"link":return link(t,e.link);case"block":return{state:t,effect:none()};case"close":return close$2(t);case"end":return{state:t,effect:none()};default:return unreachable`File Writer got unknown message ${e}`}},init=(e,t,n)=>({status:"open",metadata:t,config:n,writer:e,chunker:open$1({chunker:n.chunker}),layout:n.fileLayout.open(),nodeQueue:mutable()}),write$2=(e,t)=>{if(e.status==="open"){const{chunks:n,...r}=write$3(e.chunker,t),{nodes:i,leaves:o,layout:s}=e.config.fileLayout.write(e.layout,n),{linked:a,...u}=addNodes(i,e.nodeQueue),l=[...encodeLeaves(o,e.config),...encodeBranches(a,e.config)];return{state:{...e,chunker:r,layout:s,nodeQueue:u},effect:listen({link:effects(l)})}}else return panic("Unable to perform write on closed file")},link=(e,{id:t,link:n,block:r})=>{let{linked:i,...o}=addLink(t,n,e.nodeQueue);const s=encodeBranches(i,e.config),a=e.status==="closed"&&t===e.rootID?{...e,status:"linked",link:n,nodeQueue:o}:{...e,nodeQueue:o},u=e.status==="closed"&&t===e.rootID&&e.end?e.end.resume():none();return{state:a,effect:listen({link:effects(s),block:writeBlock(e.writer,r),end:u})}},close$2=e=>{if(e.status==="open"){const{chunks:t}=close$3(e.chunker),{layout:n,...r}=e.config.fileLayout.write(e.layout,t),{root:i,...o}=e.config.fileLayout.close(n,e.metadata),[s,a]=isLeafNode(i)?[[...r.nodes,...o.nodes],[...r.leaves,...o.leaves,i]]:[[...r.nodes,...o.nodes,i],[...r.leaves,...o.leaves]],{linked:u,...l}=addNodes(s,e.nodeQueue),y=[...encodeLeaves(a,e.config),...encodeBranches(u,e.config)],h=fork$1(suspend());return{state:{...e,chunker:null,layout:null,rootID:i.id,status:"closed",end:h,nodeQueue:l},effect:listen({link:effects(y),end:join(h)})}}else return{state:e,effect:none()}},encodeLeaves=(e,t)=>e.map(n=>encodeLeaf(t,n,t.fileChunkEncoder)),encodeLeaf=function*({hasher:e,linker:t},{id:n,content:r},i){const o=i.encode(r?asUint8Array(r):EMPTY_BUFFER),s=yield*wait(e.digest(o)),a=t.createLink(i.code,s),u={cid:a,bytes:o},l={cid:a,contentByteLength:r?r.byteLength:0,dagByteLength:o.byteLength};return{id:n,block:u,link:l}},encodeBranches=(e,t)=>e.map(n=>encodeBranch(t,n)),encodeBranch=function*(e,{id:t,links:n},r){const i=e.fileEncoder.encode({type:NodeType.File,layout:"advanced",parts:n,metadata:r}),o=yield*wait(Promise.resolve(e.hasher.digest(i))),s=e.linker.createLink(e.fileEncoder.code,o),a={bytes:i,cid:s},u={cid:s,contentByteLength:cumulativeContentByteLength(n),dagByteLength:cumulativeDagByteLength(i,n)};return{id:t,block:a,link:u}},writeBlock=function*(e,t){(e.desiredSize||0)<=0&&(yield*wait(e.ready)),e.write(t)},asUint8Array=e=>e instanceof Uint8Array?e:e.copyTo(new Uint8Array(e.byteLength),0),isLeafNode=e=>e.children==null,name="fixed",context={maxChunkSize:262144},type="Stateless",withMaxChunkSize=e=>({type:"Stateless",context:{maxChunkSize:e},name,cut}),cut=({maxChunkSize:e},{byteLength:t},n)=>{const r=t/e|0,i=new Array(r).fill(e),o=n?t-r*e:0;return o>0&&i.push(o),i},FixedSize=Object.freeze(Object.defineProperty({__proto__:null,context,cut,name,type,withMaxChunkSize},Symbol.toStringTag,{value:"Module"}));class Node{constructor(t,n,r){this.id=t,this.children=n,this.metadata=r}}const withWidth=e=>({open:()=>open({width:e}),write:write$1,close:close$1}),defaults$1={width:174},open=({width:e}=defaults$1)=>({width:e,head:null,leafIndex:[],nodeIndex:[],lastID:0}),write$1=(e,t)=>{if(t.length===0)return{layout:e,nodes:EMPTY,leaves:EMPTY};{let{lastID:n}=e;const[r,i]=e.head?[null,(t.unshift(e.head),t)]:t.length===1&&e.leafIndex.length===0?[t[0],EMPTY]:[null,t];if(i.length===0)return{layout:{...e,head:r},nodes:EMPTY,leaves:EMPTY};{const o=[...e.leafIndex],s=[];for(const a of i){const u={id:++n,content:a};s.push(u),o.push(u.id)}return o.length>e.width?flush({...e,leafIndex:o,head:r,lastID:n},s):{layout:{...e,head:r,leafIndex:o,lastID:n},leaves:s,nodes:EMPTY}}}},flush=(e,t=EMPTY,n=[],r=!1)=>{let{lastID:i}=e;const o=e.nodeIndex.map(l=>[...l]),s=[...e.leafIndex],{width:a}=e;for(;s.length>a||s.length>0&&r;){grow(o,1);const l=new Node(++i,s.splice(0,a));o[0].push(l.id),n.push(l)}let u=0;for(;u<o.length;){const l=o[u];for(u++;l.length>a||l.length>0&&r&&u<o.length;){const y=new Node(++i,l.splice(0,a));grow(o,u+1),o[u].push(y.id),n.push(y)}}return{layout:{...e,lastID:i,leafIndex:s,nodeIndex:o},leaves:t,nodes:n}},close$1=(e,t)=>{const n=e;if(e.head)return{root:{id:1,content:e.head,metadata:t},leaves:EMPTY,nodes:EMPTY};if(e.leafIndex.length===0)return{root:{id:1,metadata:t},leaves:EMPTY,nodes:EMPTY};{const{nodes:r,layout:i}=flush(n,EMPTY,[],!0),{nodeIndex:o}=i,s=o.length-1,a=o[s];if(a.length===1){const u=r[r.length-1];return r.length=r.length-1,{root:u,nodes:r,leaves:EMPTY}}else return{root:new Node(i.lastID+1,a,t),nodes:r,leaves:EMPTY}}},grow=(e,t)=>{for(;e.length<t;)e.push([]);return e},EMPTY=[],defaults=()=>({chunker:FixedSize,fileChunkEncoder:UnixFSLeaf,smallFileEncoder:UnixFSLeaf,fileEncoder:UnixFS,fileLayout:withWidth(174),hasher:sha256,linker:{createLink:CID.createV1}}),configure$4=e=>({...defaults(),...e}),UnixFSLeaf={code,name:name$1,encode:encodeFileChunk},create$1=({writer:e,metadata:t={},settings:n=defaults()})=>new FileWriterView(init(e,t,configure$4(n))),write=async(e,t)=>(await perform(e,send({type:"write",bytes:t})),e),close=async(e,{releaseLock:t=!1,closeWriter:n=!1}={})=>{await perform(e,send({type:"close"}));const{state:r}=e;if(r.status==="linked")return n?await e.state.writer.close():t&&e.state.writer.releaseLock(),r.link;panic(`Expected writer to be in 'linked' state after close, but it is in "${r.status}" instead`)},perform=(e,t)=>fork$1(loop(t,n=>{const{state:r,effect:i}=update(n,e.state);return e.state=r,i}));class FileWriterView{constructor(t){this.state=t}get writer(){return this.state.writer}get settings(){return this.state.config}write(t){return write(this,t)}close(t){return close(this,t)}}const api=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),empty$1=(e=32)=>{if(e!==32)throw new Error(`Uint32 BitField does not support size: ${e}`);return 0},from$3=(e,t)=>{let n=empty$1(t);for(const r of e)n=set$2(n,r);return n},size$1=e=>32,mask=(e,t)=>e>>>t&31,offset=(e,t)=>1<<mask(e,t),popcount$1=(e,t=31)=>bitCount(e&offset(t,0)-1),set$2=(e,t)=>e|1<<t,unset$1=(e,t)=>e&(255^1<<t),get$3=(e,t)=>(e>>t&1)!==0,bitCount=e=>{const t=e-(e>>1&1431655765),n=(t&858993459)+(t>>2&858993459);return(n+(n>>4)&252645135)*16843009>>24},and$1=(e,t)=>e&t,or$1=(e,t)=>e|t,toBytes$1=e=>Uint8Array.of(e>>24&255,e>>16&255,e>>8&255,e&255),fromBytes$1=e=>{if(e.length!==4)throw new Error(`Expected 4 bytes instead got ${e.length}`);return(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3]},Uint32BitField=Object.freeze(Object.defineProperty({__proto__:null,API:api,and:and$1,bitCount,empty:empty$1,from:from$3,fromBytes:fromBytes$1,get:get$3,or:or$1,popcount:popcount$1,set:set$2,size:size$1,toBytes:toBytes$1,unset:unset$1},Symbol.toStringTag,{value:"Module"}));var murmurHash3js={exports:{}},hasRequiredMurmurHash3js;function requireMurmurHash3js(){return hasRequiredMurmurHash3js||(hasRequiredMurmurHash3js=1,(function(e,t){(function(n,r){var i={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function o(c){if(!Array.isArray(c)&&!ArrayBuffer.isView(c))return!1;for(var d=0;d<c.length;d++)if(!Number.isInteger(c[d])||c[d]<0||c[d]>255)return!1;return!0}function s(c,d){return(c&65535)*d+(((c>>>16)*d&65535)<<16)}function a(c,d){return c<<d|c>>>32-d}function u(c){return c^=c>>>16,c=s(c,2246822507),c^=c>>>13,c=s(c,3266489909),c^=c>>>16,c}function l(c,d){c=[c[0]>>>16,c[0]&65535,c[1]>>>16,c[1]&65535],d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535];var p=[0,0,0,0];return p[3]+=c[3]+d[3],p[2]+=p[3]>>>16,p[3]&=65535,p[2]+=c[2]+d[2],p[1]+=p[2]>>>16,p[2]&=65535,p[1]+=c[1]+d[1],p[0]+=p[1]>>>16,p[1]&=65535,p[0]+=c[0]+d[0],p[0]&=65535,[p[0]<<16|p[1],p[2]<<16|p[3]]}function y(c,d){c=[c[0]>>>16,c[0]&65535,c[1]>>>16,c[1]&65535],d=[d[0]>>>16,d[0]&65535,d[1]>>>16,d[1]&65535];var p=[0,0,0,0];return p[3]+=c[3]*d[3],p[2]+=p[3]>>>16,p[3]&=65535,p[2]+=c[2]*d[3],p[1]+=p[2]>>>16,p[2]&=65535,p[2]+=c[3]*d[2],p[1]+=p[2]>>>16,p[2]&=65535,p[1]+=c[1]*d[3],p[0]+=p[1]>>>16,p[1]&=65535,p[1]+=c[2]*d[2],p[0]+=p[1]>>>16,p[1]&=65535,p[1]+=c[3]*d[1],p[0]+=p[1]>>>16,p[1]&=65535,p[0]+=c[0]*d[3]+c[1]*d[2]+c[2]*d[1]+c[3]*d[0],p[0]&=65535,[p[0]<<16|p[1],p[2]<<16|p[3]]}function h(c,d){return d%=64,d===32?[c[1],c[0]]:d<32?[c[0]<<d|c[1]>>>32-d,c[1]<<d|c[0]>>>32-d]:(d-=32,[c[1]<<d|c[0]>>>32-d,c[0]<<d|c[1]>>>32-d])}function f(c,d){return d%=64,d===0?c:d<32?[c[0]<<d|c[1]>>>32-d,c[1]<<d]:[c[1]<<d-32,0]}function g(c,d){return[c[0]^d[0],c[1]^d[1]]}function m(c){return c=g(c,[0,c[0]>>>1]),c=y(c,[4283543511,3981806797]),c=g(c,[0,c[0]>>>1]),c=y(c,[3301882366,444984403]),c=g(c,[0,c[0]>>>1]),c}i.x86.hash32=function(c,d){if(i.inputValidation&&!o(c))return r;d=d||0;for(var p=c.length%4,k=c.length-p,w=d,b=0,S=3432918353,$=461845907,L=0;L<k;L=L+4)b=c[L]|c[L+1]<<8|c[L+2]<<16|c[L+3]<<24,b=s(b,S),b=a(b,15),b=s(b,$),w^=b,w=a(w,13),w=s(w,5)+3864292196;switch(b=0,p){case 3:b^=c[L+2]<<16;case 2:b^=c[L+1]<<8;case 1:b^=c[L],b=s(b,S),b=a(b,15),b=s(b,$),w^=b}return w^=c.length,w=u(w),w>>>0},i.x86.hash128=function(c,d){if(i.inputValidation&&!o(c))return r;d=d||0;for(var p=c.length%16,k=c.length-p,w=d,b=d,S=d,$=d,L=0,T=0,v=0,N=0,_=597399067,B=2869860233,E=951274213,F=2716044179,x=0;x<k;x=x+16)L=c[x]|c[x+1]<<8|c[x+2]<<16|c[x+3]<<24,T=c[x+4]|c[x+5]<<8|c[x+6]<<16|c[x+7]<<24,v=c[x+8]|c[x+9]<<8|c[x+10]<<16|c[x+11]<<24,N=c[x+12]|c[x+13]<<8|c[x+14]<<16|c[x+15]<<24,L=s(L,_),L=a(L,15),L=s(L,B),w^=L,w=a(w,19),w+=b,w=s(w,5)+1444728091,T=s(T,B),T=a(T,16),T=s(T,E),b^=T,b=a(b,17),b+=S,b=s(b,5)+197830471,v=s(v,E),v=a(v,17),v=s(v,F),S^=v,S=a(S,15),S+=$,S=s(S,5)+2530024501,N=s(N,F),N=a(N,18),N=s(N,_),$^=N,$=a($,13),$+=w,$=s($,5)+850148119;switch(L=0,T=0,v=0,N=0,p){case 15:N^=c[x+14]<<16;case 14:N^=c[x+13]<<8;case 13:N^=c[x+12],N=s(N,F),N=a(N,18),N=s(N,_),$^=N;case 12:v^=c[x+11]<<24;case 11:v^=c[x+10]<<16;case 10:v^=c[x+9]<<8;case 9:v^=c[x+8],v=s(v,E),v=a(v,17),v=s(v,F),S^=v;case 8:T^=c[x+7]<<24;case 7:T^=c[x+6]<<16;case 6:T^=c[x+5]<<8;case 5:T^=c[x+4],T=s(T,B),T=a(T,16),T=s(T,E),b^=T;case 4:L^=c[x+3]<<24;case 3:L^=c[x+2]<<16;case 2:L^=c[x+1]<<8;case 1:L^=c[x],L=s(L,_),L=a(L,15),L=s(L,B),w^=L}return w^=c.length,b^=c.length,S^=c.length,$^=c.length,w+=b,w+=S,w+=$,b+=w,S+=w,$+=w,w=u(w),b=u(b),S=u(S),$=u($),w+=b,w+=S,w+=$,b+=w,S+=w,$+=w,("00000000"+(w>>>0).toString(16)).slice(-8)+("00000000"+(b>>>0).toString(16)).slice(-8)+("00000000"+(S>>>0).toString(16)).slice(-8)+("00000000"+($>>>0).toString(16)).slice(-8)},i.x64.hash128=function(c,d){if(i.inputValidation&&!o(c))return r;d=d||0;for(var p=c.length%16,k=c.length-p,w=[0,d],b=[0,d],S=[0,0],$=[0,0],L=[2277735313,289559509],T=[1291169091,658871167],v=0;v<k;v=v+16)S=[c[v+4]|c[v+5]<<8|c[v+6]<<16|c[v+7]<<24,c[v]|c[v+1]<<8|c[v+2]<<16|c[v+3]<<24],$=[c[v+12]|c[v+13]<<8|c[v+14]<<16|c[v+15]<<24,c[v+8]|c[v+9]<<8|c[v+10]<<16|c[v+11]<<24],S=y(S,L),S=h(S,31),S=y(S,T),w=g(w,S),w=h(w,27),w=l(w,b),w=l(y(w,[0,5]),[0,1390208809]),$=y($,T),$=h($,33),$=y($,L),b=g(b,$),b=h(b,31),b=l(b,w),b=l(y(b,[0,5]),[0,944331445]);switch(S=[0,0],$=[0,0],p){case 15:$=g($,f([0,c[v+14]],48));case 14:$=g($,f([0,c[v+13]],40));case 13:$=g($,f([0,c[v+12]],32));case 12:$=g($,f([0,c[v+11]],24));case 11:$=g($,f([0,c[v+10]],16));case 10:$=g($,f([0,c[v+9]],8));case 9:$=g($,[0,c[v+8]]),$=y($,T),$=h($,33),$=y($,L),b=g(b,$);case 8:S=g(S,f([0,c[v+7]],56));case 7:S=g(S,f([0,c[v+6]],48));case 6:S=g(S,f([0,c[v+5]],40));case 5:S=g(S,f([0,c[v+4]],32));case 4:S=g(S,f([0,c[v+3]],24));case 3:S=g(S,f([0,c[v+2]],16));case 2:S=g(S,f([0,c[v+1]],8));case 1:S=g(S,[0,c[v]]),S=y(S,L),S=h(S,31),S=y(S,T),w=g(w,S)}return w=g(w,[0,c.length]),b=g(b,[0,c.length]),w=l(w,b),b=l(b,w),w=m(w),b=m(b),w=l(w,b),b=l(b,w),("00000000"+(w[0]>>>0).toString(16)).slice(-8)+("00000000"+(w[1]>>>0).toString(16)).slice(-8)+("00000000"+(b[0]>>>0).toString(16)).slice(-8)+("00000000"+(b[1]>>>0).toString(16)).slice(-8)},e.exports&&(t=e.exports=i),t.murmurHash3=i})()})(murmurHash3js,murmurHash3js.exports)),murmurHash3js.exports}var murmurhash3jsRevisited,hasRequiredMurmurhash3jsRevisited;function requireMurmurhash3jsRevisited(){return hasRequiredMurmurhash3jsRevisited||(hasRequiredMurmurhash3jsRevisited=1,murmurhash3jsRevisited=requireMurmurHash3js()),murmurhash3jsRevisited}var murmurhash3jsRevisitedExports=requireMurmurhash3jsRevisited();const mur=getDefaultExportFromCjs(murmurhash3jsRevisitedExports),utf8$2=new TextEncoder,hash32=mur.x64.hash126,configure$3=({bitWidth:e=5,hash:t=hash32})=>{if(e>32)throw new RangeError(`Can not use bitWidth ${e} which exceeds the hashSize 4`);const r=4294967295>>>32-e;return{at:(s,a)=>s>>>a*e&r,from:s=>t(utf8$2.encode(s)),size:Math.ceil(32/e)}};class BitmapIndexedNode{constructor(t,n,r,i,o){this.edit=t,this.config=o,this.datamap=n,this.nodemap=r,this.children=i}get nodeArity(){return this.config.BitField.popcount(this.nodemap)}get dataArity(){return this.config.BitField.popcount(this.datamap)}empty(){return create(this.config)}lookup(t,n,r,i){return lookup(this,t,n,r,i)}associate(t,n,r,i,o,s){return associate(this,t,n,r,i,o,s)}dissociate(t,n,r,i,o){return dissociate(this,t,n,r,i,o)}fork(t=null){return fork(this,t)}entries(){return entries(this)}keys(){return keys(this)}values(){return values(this)}}class HashCollisionNode{constructor(t,n,r,i){this.edit=t,this.count=n,this.children=r,this.config=i}get nodeArity(){return 0}get dataArity(){return this.count}lookup(t,n,r,i){return lookupCollision(this,r,i)}associate(t,n,r,i,o,s){return associateCollision(this,t,r,i,o,s)}dissociate(t,n,r,i,o){return dissociateCollision(this,t,r,i,o)}fork(t=null){return forkCollision(this,t)}entries(){return entries(this)}keys(){return keys(this)}values(){return values(this)}}const lookupCollision=(e,t,n)=>{const{children:r,count:i}=e,o=findHashCollisionNodeIndex(r,i,t);return r[o]===t?r[o+1]:n},associateCollision=(e,t,n,r,i,o)=>{const{children:s,count:a}=e,u=findHashCollisionNodeIndex(s,a,r);if(s[u]!==r){const l=e.fork(t);return o.value=!0,l.count+=1,l.children.splice(u,n,i),l}else if(s[u+1]!==i){const l=e.fork(t);return l.children[u+1]=i,l}else return e},dissociateCollision=(e,t,n,r,i)=>{const{children:o,count:s,config:a}=e,u=findHashCollisionNodeIndex(o,s,r);if(o[u]!==r)return e;if(i.value=!0,s===2){const l=u===0?2:0;return associate(create(a),t,0,n,o[l],o[l+1],i)}else{const l=e.fork(t);return l.children.splice(u,2),l.count-=1,l}},forkCollision=(e,t=null)=>canEdit(e.edit,t)?e:new HashCollisionNode(t,e.count,e.children.slice(),e.config),findHashCollisionNodeIndex=(e,t,n)=>{let r=0;for(;r<t&&e[r]>n;)r+=2;return r},create=(e,t=null)=>new BitmapIndexedNode(t,e.BitField.empty(Math.pow(2,e.bitWidth)),e.BitField.empty(Math.pow(2,e.bitWidth)),[],e),get$2=(e,t,n)=>lookup(e,0,e.config.Path.from(t),t,n),lookup=(e,t,n,r,i)=>{const{datamap:o,nodemap:s,config:a}=e,{Path:u,BitField:l}=a,y=u.at(n,t);if(l.get(o,y)){const h=l.popcount(o,y);return keyAt(e,h)===r?valueAt(e,h):i}else return l.get(s,y)?resolveNode(e,y).lookup(t+1,n,r,i):i},set$1=(e,t,n,r,i)=>associate(e,t,0,e.config.Path.from(n),n,r,i),associate=(e,t,n,r,i,o,s)=>{const{datamap:a,nodemap:u,config:l}=e,{Path:y,BitField:h}=l,f=y.at(r,n);if(h.get(a,f)){const g=h.popcount(a,f),m=keyAt(e,g);if(i===m)return valueAt(e,g)===o?e:forkAndSet(e,t,g,o);{const c=mergeTwoLeaves(l,t,n+1,y.from(m),m,valueAt(e,g),r,i,o);return s.value=!0,migrateLeafToBranch(e,t,f,c)}}else if(h.get(u,f)){const g=resolveNode(e,f),m=g.associate(t,n+1,r,i,o,s);return g===m?e:copyAndSetChild(e,t,f,m)}else{const g=h.popcount(a,f);s.value=!0;const m=e.fork(t);return m.datamap=h.set(a,f),m.children.splice(keyPosition(g),0,i,o),m}},remove=(e,t,n,r)=>dissociate(e,t,0,e.config.Path.from(n),n,r),dissociate=(e,t,n,r,i,o)=>{const{datamap:s,nodemap:a,config:u}=e,{BitField:l,Path:y}=u,h=y.at(r,n);if(l.get(s,h)){const f=l.popcount(s,h);if(i===keyAt(e,f)){o.value=!0;const g=fork(e,t);return g.datamap=l.unset(e.datamap,h),g.children.splice(keyPosition(f),2),g}else return e}else if(l.get(a,h)){const f=resolveNode(e,h),g=f.dissociate(t,n+1,r,i,o);return hasSingleLeaf(g)?hasSingleNode(e)?g:inlineChild(e,t,h,g):f===g?e:copyAndSetChild(e,t,h,g)}else return e},entries=function*({children:e}){let t=0;const n=e.length;for(;t<n;){const r=e[t];if(typeof r=="string"){t+=1;const i=e[t];yield[r,i],t+=1}else break}for(;t<n;)yield*e[t].entries(),t+=1},fork=(e,t)=>canEdit(e.edit,t)?e:new BitmapIndexedNode(t,e.datamap,e.nodemap,e.children.slice(),e.config),keys=function*({children:e}){let t=0;const n=e.length;for(;t<n;){const r=e[t];if(typeof r=="string")yield r,t+=2;else break}for(;t<n;)yield*e[t].keys(),t+=1},values=function*({children:e}){let t=0;const n=e.length;for(;t<n&&typeof e[t]=="string";)t+=1,yield e[t],t+=1;for(;t<n;)yield*e[t].values(),t+=1},forkAndSet=(e,t,n,r)=>{const i=e.fork(t);return i.children[valuePosition(n)]=r,i},inlineChild=(e,t,n,r)=>{const{datamap:i,nodemap:o,config:s}=e,{BitField:a}=s,u=fork(e,t);return u.children.splice(nodePosition(e,n),1),u.children.splice(keyPosition(a.popcount(i,n)),0,r.children[0],r.children[1]),u.datamap=a.set(i,n),u.nodemap=a.unset(o,n),u},copyAndSetChild=(e,t,n,r)=>{const i=fork(e,t);return i.children[nodePosition(e,n)]=r,i},migrateLeafToBranch=(e,t,n,r)=>{const{nodemap:i,datamap:o,config:s}=e,{BitField:a}=s,u=a.popcount(o,n),l=keyPosition(u),y=nodePosition(e,n),h=fork(e,t);return h.datamap=a.unset(o,n),h.children.splice(l,2),h.nodemap=a.set(i,n),h.children.splice(y-1,0,r),h},mergeTwoLeaves=(e,t,n,r,i,o,s,a,u)=>{const{BitField:l,Path:y}=e;if(y.size<n)return new HashCollisionNode(t,2,[i,o,a,u],e);{const h=y.at(r,n),f=y.at(s,n);return h===f?new BitmapIndexedNode(t,l.empty(Math.pow(2,e.bitWidth)),l.from([h],Math.pow(2,e.bitWidth)),[mergeTwoLeaves(e,t,n+1,r,i,o,s,a,u)],e):new BitmapIndexedNode(t,l.from([h,f],Math.pow(2,e.bitWidth)),l.empty(Math.pow(2,e.bitWidth)),h<f?[i,o,a,u]:[a,u,i,o],e)}},keyAt=({children:e},t)=>e[keyPosition(t)],keyPosition=e=>e*2,valueAt=({children:e},t)=>e[valuePosition(t)],valuePosition=e=>e*2+1,resolveNode=(e,t)=>e.children[nodePosition(e,t)],nodePosition=({children:e,nodemap:t,config:n},r)=>e.length-1-n.BitField.popcount(t,r),canEdit=(e,t)=>e!=null&&e===t,hasSingleLeaf=e=>e.nodeArity===0&&e.dataArity===1,hasSingleNode=({config:{BitField:e},datamap:t,nodemap:n})=>e.popcount(t)===0&&e.popcount(n)===1,murmur3128=from$4({name:"murmur3-128",code:34,encode:e=>fromHex(mur.x64.hash128(e))}),murmur364=from$4({name:"murmur3-x64-64",code:34,encode:e=>fromHex(mur.x64.hash128(e)).subarray(0,8)}),utf8$1=new TextEncoder,hash64$1=e=>murmur364.encode(e),configure$2=({bitWidth:e=8,hash:t=hash64$1}={})=>{const n=t(new Uint8Array).byteLength;return{from:o=>t(utf8$1.encode(o)),at:(o,s)=>{const a=s*e;if(a>n)throw new RangeError("Out of bounds");return toInt(o,a,e)},size:Math.ceil(n*8/e)}},toInt=(e,t,n)=>{let r=t/8|0,i=t%8,o=n,s=0;for(;o>0&&r<e.byteLength;){const a=e[r],u=8-i,l=u<o?u:o,y=8-i-l,f=(255>>i&a)>>y;s=(s<<l)+f,o-=l,r++,i=0}return s},empty=(e=256)=>{if(e%8!==0)throw new Error("Must be multiple of 8");return new Uint8Array(e/8)},from$2=(e,t)=>{let n=empty(t);for(const r of e){const{byte:i,byteOffset:o,bitOffset:s}=at(n,r);n[o]=i|1<<s}return n},size=e=>e.byteLength*8,at=(e,t)=>{const n=e.byteLength-1-(t/8|0),r=t%8;return{byte:e[n],byteOffset:n,bitOffset:r}},setByte=(e,t,n)=>{if(e[t]!==n){const r=e.slice(0);return r[t]=n,r}return e},set=(e,t)=>{const{byte:n,byteOffset:r,bitOffset:i}=at(e,t);return setByte(e,r,n|1<<i)},unset=(e,t)=>{const{byte:n,byteOffset:r,bitOffset:i}=at(e,t);return setByte(e,r,n&(255^1<<i))},get$1=(e,t)=>{var{byte:n,bitOffset:r}=at(e,t);return(n>>r&1)!==0},toBytes=e=>e,fromBytes=e=>e,popcount=(e,t=e.byteLength*8)=>{const{byteOffset:n,bitOffset:r,byte:i}=at(e,t);let o=popcount$1(i,r),s=e.byteLength-1;for(;s>n;){const a=e[s];o+=bitCount(a),s--}return o},or=(e,t)=>{const n=e.slice();let r=0;for(;r<e.length;)n[r]|=t[r],r++;return n},and=(e,t)=>{const n=e.slice();let r=0;for(;r<e.length;)n[r]&=t[r],r++;return n},Uint8ArrayBitField=Object.freeze(Object.defineProperty({__proto__:null,API:api,and,empty,from:from$2,fromBytes,get:get$1,or,popcount,set,size,toBytes,unset},Symbol.toStringTag,{value:"Module"})),NOT_FOUND=new RangeError("Not Found"),configure$1=({bitWidth:e=5,BitField:t=e===5?Uint32BitField:Uint8ArrayBitField,Path:n=e===5?configure$3({bitWidth:e}):configure$2({bitWidth:e})}={})=>({bitWidth:e,BitField:t,Path:n}),from$1=(e,t)=>{const n=builder$1(t);for(const[r,i]of e)n.set(r,i);return n.build()},has=(e,t)=>get$2(e.root,t,NOT_FOUND)!==NOT_FOUND,get=(e,t,n=void 0)=>get$2(e.root,t,n),builder$1=e=>{const t={},n=configure$1(e);return new HashMapBuilder(t,0,create(n,t),n)};class PersistentHashMap{constructor(t=0,n,r){this.count=t,this.root=n,this.config=r}get size(){return this.count}clone(){return new PersistentHashMap(this.count,this.root,this.config)}empty(){return new PersistentHashMap(0,create(this.config,null),this.config)}has(t){return has(this,t)}get(t){return get$2(this.root,t,void 0)}set(t,n){const r={value:!1},i=set$1(this.root,null,t,n,r);return i===this.root?this:new PersistentHashMap(r.value?this.count+1:this.count,i,this.config)}delete(t){const n=remove(this.root,null,t,{value:!1});return n===this.root?this:new PersistentHashMap(this.count-1,n,this.config)}get bitField(){return this.config.BitField.or(this.root.datamap,this.root.nodemap)}[Symbol.iterator](){return this.entries()}entries(){return this.root.entries()}keys(){return this.root.keys()}values(){return this.root.values()}createBuilder(){return new HashMapBuilder({},this.count,this.root,this.config)}}class HashMapBuilder{constructor(t,n,r,i){this.edit=t,this.count=n,this.root=r,this.config=i}get size(){if(this.edit)return this.count;throw new Error(".size was accessed on the finalized builder")}set(t,n){if(this.edit){const r={value:!1},i=set$1(this.root,this.edit,t,n,r);return this.root!==i&&(this.root=i),r.value&&(this.count+=1),this}else throw new Error(".set was called on the finalized builder")}delete(t){if(this.edit){if(this.count===0)return this;const n={value:!1},r=remove(this.root,this.edit,t,n);return r!==this.root&&(this.root=r),n.value&&(this.count-=1),this}else throw new Error(".delete was called on the finalized builder")}build(){if(this.edit)return this.edit=null,new PersistentHashMap(this.count,this.root,this.config);throw new Error(".build was called on the finalized builder")}}const utf8=new TextEncoder,hash64=e=>murmur364.encode(e),configure=({bitWidth:e=8,hash:t=hash64})=>{const n=t(new Uint8Array).byteLength,r={bitWidth:e,hash:t,hashSize:n};return{at:(s,a)=>read(s,a,r),from:s=>utf8.encode(s),size:1/0}},read=(e,t=0,{bitWidth:n=8,hash:r,hashSize:i})=>{const o=i*8;let s=0,a=n,u=n*t;for(;a>0;){const l=u/o>>0,y=r(l===0?e:appendByte(e,l)),h=o<=u?u%o:u,f=o-h,g=f<a?f:a;s=(s<<g)+toInt(y,h,g),a-=g,u+=g}return s},appendByte=(e,t)=>{const n=new Uint8Array(e.byteLength+1).fill(t,e.byteLength);return n.set(e),n},bitWidth=8,config={bitWidth,Path:configure({bitWidth})},tableSize=e=>Math.pow(2,e.config.bitWidth),builder=(e=config)=>builder$1(e),from=(e,t=config)=>from$1(e,t),bitField=({datamap:e,nodemap:t,config:{BitField:n}})=>withoutLeadingZeros(n.toBytes(n.or(e,t))),withoutLeadingZeros=e=>{let t=0;for(;t<e.byteLength;){if(e[t]!==0)return e.subarray(t);t+=1}return e.subarray(t)},iterate=function*(e){const{config:t,datamap:n,nodemap:r}=e,{BitField:i}=t,o=i.size(n);let s=0,a=0;for(;s<o;){const u=s.toString(16).toUpperCase().padStart(2,"0");if(i.get(n,s)){const l=keyAt(e,a);yield{prefix:u,key:l,value:valueAt(e,a)},a++}else i.get(r,s)&&(yield{prefix:u,node:resolveNode(e,s)});s++}};var encode_1,hasRequiredEncode;function requireEncode(){if(hasRequiredEncode)return encode_1;hasRequiredEncode=1,encode_1=r;var e=128,t=-128,n=Math.pow(2,31);function r(i,o,s){if(Number.MAX_SAFE_INTEGER&&i>Number.MAX_SAFE_INTEGER)throw r.bytes=0,new RangeError("Could not encode varint");o=o||[],s=s||0;for(var a=s;i>=n;)o[s++]=i&255|e,i/=128;for(;i&t;)o[s++]=i&255|e,i>>>=7;return o[s]=i|0,r.bytes=s-a+1,o}return encode_1}var decode,hasRequiredDecode;function requireDecode(){if(hasRequiredDecode)return decode;hasRequiredDecode=1,decode=n;var e=128,t=127;function n(r,s){var o=0,s=s||0,a=0,u=s,l,y=r.length;do{if(u>=y||a>49)throw n.bytes=0,new RangeError("Could not decode varint");l=r[u++],o+=a<28?(l&t)<<a:(l&t)*Math.pow(2,a),a+=7}while(l>=e);return n.bytes=u-s,o}return decode}var length,hasRequiredLength;function requireLength(){if(hasRequiredLength)return length;hasRequiredLength=1;var e=Math.pow(2,7),t=Math.pow(2,14),n=Math.pow(2,21),r=Math.pow(2,28),i=Math.pow(2,35),o=Math.pow(2,42),s=Math.pow(2,49),a=Math.pow(2,56),u=Math.pow(2,63);return length=function(l){return l<e?1:l<t?2:l<n?3:l<r?4:l<i?5:l<o?6:l<s?7:l<a?8:l<u?9:10},length}var varint$1,hasRequiredVarint;function requireVarint(){return hasRequiredVarint||(hasRequiredVarint=1,varint$1={encode:requireEncode(),decode:requireDecode(),encodingLength:requireLength()}),varint$1}var varintExports=requireVarint();const varint=getDefaultExportFromCjs(varintExports);export{withMaxChunkSize as a,createFlatDirectory as b,configure$4 as c,defaults as d,encodeDirectory as e,code as f,cumulativeDagByteLength as g,create$1 as h,builder as i,get as j,has as k,from as l,iterate as m,createDirectoryShard as n,murmur364 as o,bitField as p,encodeHAMTShard as q,murmur3128 as r,tableSize as t,varint as v,withWidth as w};
