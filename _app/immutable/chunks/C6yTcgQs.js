const tn=new Uint8Array(0);function kr(e){const n=e.match(/../g);return n!=null?new Uint8Array(n.map(t=>parseInt(t,16))):tn}function rn(e,n){if(e===n)return!0;if(e.byteLength!==n.byteLength)return!1;for(let t=0;t<e.byteLength;t++)if(e[t]!==n[t])return!1;return!0}function be(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function Br(e){return new TextEncoder().encode(e)}function Tr(e){return new TextDecoder().decode(e)}function on(e,n){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var o=0;o<e.length;o++){var i=e.charAt(o),a=i.charCodeAt(0);if(t[a]!==255)throw new TypeError(i+" is ambiguous");t[a]=o}var f=e.length,p=e.charAt(0),x=Math.log(f)/Math.log(256),y=Math.log(256)/Math.log(f);function pe(h){if(h instanceof Uint8Array||(ArrayBuffer.isView(h)?h=new Uint8Array(h.buffer,h.byteOffset,h.byteLength):Array.isArray(h)&&(h=Uint8Array.from(h))),!(h instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(h.length===0)return"";for(var m=0,D=0,A=0,k=h.length;A!==k&&h[A]===0;)A++,m++;for(var B=(k-A)*y+1>>>0,b=new Uint8Array(B);A!==k;){for(var T=h[A],z=0,_=B-1;(T!==0||z<D)&&_!==-1;_--,z++)T+=256*b[_]>>>0,b[_]=T%f>>>0,T=T/f>>>0;if(T!==0)throw new Error("Non-zero carry");D=z,A++}for(var $=B-D;$!==B&&b[$]===0;)$++;for(var ee=p.repeat(m);$<B;++$)ee+=e.charAt(b[$]);return ee}function Y(h){if(typeof h!="string")throw new TypeError("Expected String");if(h.length===0)return new Uint8Array;var m=0;if(h[m]!==" "){for(var D=0,A=0;h[m]===p;)D++,m++;for(var k=(h.length-m)*x+1>>>0,B=new Uint8Array(k);h[m];){var b=t[h.charCodeAt(m)];if(b===255)return;for(var T=0,z=k-1;(b!==0||T<A)&&z!==-1;z--,T++)b+=f*B[z]>>>0,B[z]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");A=T,m++}if(h[m]!==" "){for(var _=k-A;_!==k&&B[_]===0;)_++;for(var $=new Uint8Array(D+(k-_)),ee=D;_!==k;)$[ee++]=B[_++];return $}}}function nn(h){var m=Y(h);if(m)return m;throw new Error(`Non-${n} character`)}return{encode:pe,decodeUnsafe:Y,decode:nn}}var sn=on,cn=sn;class an{name;prefix;baseEncode;constructor(n,t,r){this.name=n,this.prefix=t,this.baseEncode=r}encode(n){if(n instanceof Uint8Array)return`${this.prefix}${this.baseEncode(n)}`;throw Error("Unknown type, must be binary type")}}class un{name;prefix;baseDecode;prefixCodePoint;constructor(n,t,r){this.name=n,this.prefix=t;const o=t.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=r}decode(n){if(typeof n=="string"){if(n.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(n)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(n.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(n){return Re(this,n)}}class fn{decoders;constructor(n){this.decoders=n}or(n){return Re(this,n)}decode(n){const t=n[0],r=this.decoders[t];if(r!=null)return r.decode(n);throw RangeError(`Unable to decode multibase string ${JSON.stringify(n)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function Re(e,n){return new fn({...e.decoders??{[e.prefix]:e},...n.decoders??{[n.prefix]:n}})}class dn{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(n,t,r,o){this.name=n,this.prefix=t,this.baseEncode=r,this.baseDecode=o,this.encoder=new an(n,t,r),this.decoder=new un(n,t,o)}encode(n){return this.encoder.encode(n)}decode(n){return this.decoder.decode(n)}}function Le({name:e,prefix:n,encode:t,decode:r}){return new dn(e,n,t,r)}function fe({name:e,prefix:n,alphabet:t}){const{encode:r,decode:o}=cn(t,e);return Le({prefix:n,name:e,encode:r,decode:i=>be(o(i))})}function ln(e,n,t,r){let o=e.length;for(;e[o-1]==="=";)--o;const i=new Uint8Array(o*t/8|0);let a=0,f=0,p=0;for(let x=0;x<o;++x){const y=n[e[x]];if(y===void 0)throw new SyntaxError(`Non-${r} character`);f=f<<t|y,a+=t,a>=8&&(a-=8,i[p++]=255&f>>a)}if(a>=t||(255&f<<8-a)!==0)throw new SyntaxError("Unexpected end of data");return i}function hn(e,n,t){const r=n[n.length-1]==="=",o=(1<<t)-1;let i="",a=0,f=0;for(let p=0;p<e.length;++p)for(f=f<<8|e[p],a+=8;a>t;)a-=t,i+=n[o&f>>a];if(a!==0&&(i+=n[o&f<<t-a]),r)for(;(i.length*t&7)!==0;)i+="=";return i}function pn(e){const n={};for(let t=0;t<e.length;++t)n[e[t]]=t;return n}function C({name:e,prefix:n,bitsPerChar:t,alphabet:r}){const o=pn(r);return Le({prefix:n,name:e,encode(i){return hn(i,r,t)},decode(i){return ln(i,o,t,e)}})}const Q=C({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),yn=C({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),wn=C({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),gn=C({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),xn=C({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mn=C({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bn=C({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),En=C({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),vn=C({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),Ur=Object.freeze(Object.defineProperty({__proto__:null,base32:Q,base32hex:xn,base32hexpad:bn,base32hexpadupper:En,base32hexupper:mn,base32pad:wn,base32padupper:gn,base32upper:yn,base32z:vn},Symbol.toStringTag,{value:"Module"})),ne=fe({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),An=fe({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),$r=Object.freeze(Object.defineProperty({__proto__:null,base36:ne,base36upper:An},Symbol.toStringTag,{value:"Module"})),N=fe({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),_n=fe({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),Ir=Object.freeze(Object.defineProperty({__proto__:null,base58btc:N,base58flickr:_n},Symbol.toStringTag,{value:"Module"}));var Sn=Ve,Ne=128,kn=-128,Bn=Math.pow(2,31);function Ve(e,n,t){n=n||[],t=t||0;for(var r=t;e>=Bn;)n[t++]=e&255|Ne,e/=128;for(;e&kn;)n[t++]=e&255|Ne,e>>>=7;return n[t]=e|0,Ve.bytes=t-r+1,n}var Tn=we,Un=128,Ce=127;function we(e,r){var t=0,r=r||0,o=0,i=r,a,f=e.length;do{if(i>=f)throw we.bytes=0,new RangeError("Could not decode varint");a=e[i++],t+=o<28?(a&Ce)<<o:(a&Ce)*Math.pow(2,o),o+=7}while(a>=Un);return we.bytes=i-r,t}var $n=Math.pow(2,7),In=Math.pow(2,14),Nn=Math.pow(2,21),Cn=Math.pow(2,28),zn=Math.pow(2,35),Mn=Math.pow(2,42),On=Math.pow(2,49),Dn=Math.pow(2,56),Fn=Math.pow(2,63),jn=function(e){return e<$n?1:e<In?2:e<Nn?3:e<Cn?4:e<zn?5:e<Mn?6:e<On?7:e<Dn?8:e<Fn?9:10},Rn={encode:Sn,decode:Tn,encodingLength:jn},re=Rn;function ge(e,n=0){return[re.decode(e,n),re.decode.bytes]}function oe(e,n,t=0){return re.encode(e,n,t),n}function ie(e){return re.encodingLength(e)}function Ln(e,n){const t=n.byteLength,r=ie(e),o=r+ie(t),i=new Uint8Array(o+t);return oe(e,i,0),oe(t,i,r),i.set(n,o),new Ee(e,t,n,i)}function Vn(e){const n=be(e),[t,r]=ge(n),[o,i]=ge(n.subarray(r)),a=n.subarray(r+i);if(a.byteLength!==o)throw new Error("Incorrect length");return new Ee(t,o,a,n)}function Pn(e,n){if(e===n)return!0;{const t=n;return e.code===t.code&&e.size===t.size&&t.bytes instanceof Uint8Array&&rn(e.bytes,t.bytes)}}class Ee{code;size;digest;bytes;constructor(n,t,r,o){this.code=n,this.size=t,this.digest=r,this.bytes=o}}function ze(e,n){const{bytes:t,version:r}=e;switch(r){case 0:return Gn(t,xe(e),n??N.encoder);default:return Kn(t,xe(e),n??Q.encoder)}}const Me=new WeakMap;function xe(e){const n=Me.get(e);if(n==null){const t=new Map;return Me.set(e,t),t}return n}class w{code;version;multihash;bytes;"/";constructor(n,t,r,o){this.code=t,this.version=n,this.multihash=r,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:n,multihash:t}=this;if(n!==J)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==Jn)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return w.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:n,digest:t}=this.multihash,r=Ln(n,t);return w.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(n){return w.equals(this,n)}static equals(n,t){const r=t;return r!=null&&n.code===r.code&&n.version===r.version&&Pn(n.multihash,r.multihash)}toString(n){return ze(this,n)}toJSON(){return{"/":ze(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(n){if(n==null)return null;const t=n;if(t instanceof w)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){const{version:r,code:o,multihash:i,bytes:a}=t;return new w(r,o,i,a??Oe(r,o,i.bytes))}else if(t[Qn]===!0){const{version:r,multihash:o,code:i}=t,a=Vn(o);return w.create(r,i,a)}else return null}static create(n,t,r){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(r.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(n){case 0:{if(t!==J)throw new Error(`Version 0 CID must use dag-pb (code: ${J}) block encoding`);return new w(n,t,r,r.bytes)}case 1:{const o=Oe(n,t,r.bytes);return new w(n,t,r,o)}default:throw new Error("Invalid version")}}static createV0(n){return w.create(0,J,n)}static createV1(n,t){return w.create(1,n,t)}static decode(n){const[t,r]=w.decodeFirst(n);if(r.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(n){const t=w.inspectBytes(n),r=t.size-t.multihashSize,o=be(n.subarray(r,r+t.multihashSize));if(o.byteLength!==t.multihashSize)throw new Error("Incorrect length");const i=o.subarray(t.multihashSize-t.digestSize),a=new Ee(t.multihashCode,t.digestSize,i,o);return[t.version===0?w.createV0(a):w.createV1(t.codec,a),n.subarray(t.size)]}static inspectBytes(n){let t=0;const r=()=>{const[pe,Y]=ge(n.subarray(t));return t+=Y,pe};let o=r(),i=J;if(o===18?(o=0,t=0):i=r(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const a=t,f=r(),p=r(),x=t+p,y=x-a;return{version:o,codec:i,multihashCode:f,digestSize:p,multihashSize:y,size:x}}static parse(n,t){const[r,o]=qn(n,t),i=w.decode(o);if(i.version===0&&n[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return xe(i).set(r,n),i}}function qn(e,n){switch(e[0]){case"Q":{const t=n??N;return[N.prefix,t.decode(`${N.prefix}${e}`)]}case N.prefix:{const t=n??N;return[N.prefix,t.decode(e)]}case Q.prefix:{const t=n??Q;return[Q.prefix,t.decode(e)]}case ne.prefix:{const t=n??ne;return[ne.prefix,t.decode(e)]}default:{if(n==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],n.decode(e)]}}}function Gn(e,n,t){const{prefix:r}=t;if(r!==N.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);const o=n.get(r);if(o==null){const i=t.encode(e).slice(1);return n.set(r,i),i}else return o}function Kn(e,n,t){const{prefix:r}=t,o=n.get(r);if(o==null){const i=t.encode(e);return n.set(r,i),i}else return o}const J=112,Jn=18;function Oe(e,n,t){const r=ie(e),o=r+ie(n),i=new Uint8Array(o+t.byteLength);return oe(e,i,0),oe(n,i,r),i.set(t,o),i}const Qn=Symbol.for("@ipld/js-cid/CID"),Wn=["string","number","bigint","symbol"],Xn=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Hn(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const n=typeof e;if(Wn.includes(n))return n;if(n==="function")return"Function";if(Array.isArray(e))return"Array";if(Zn(e))return"Buffer";const t=Yn(e);return t||"Object"}function Zn(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Yn(e){const n=Object.prototype.toString.call(e).slice(8,-1);if(Xn.includes(n))return n}class s{constructor(n,t,r){this.major=n,this.majorEncoded=n<<5,this.name=t,this.terminal=r}toString(){return`Type[${this.major}].${this.name}`}compare(n){return this.major<n.major?-1:this.major>n.major?1:0}}s.uint=new s(0,"uint",!0);s.negint=new s(1,"negint",!0);s.bytes=new s(2,"bytes",!0);s.string=new s(3,"string",!0);s.array=new s(4,"array",!1);s.map=new s(5,"map",!1);s.tag=new s(6,"tag",!1);s.float=new s(7,"float",!0);s.false=new s(7,"false",!0);s.true=new s(7,"true",!0);s.null=new s(7,"null",!0);s.undefined=new s(7,"undefined",!0);s.break=new s(7,"break",!0);class u{constructor(n,t,r){this.type=n,this.value=t,this.encodedLength=r,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const P=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",et=new TextDecoder,nt=new TextEncoder;function se(e){return P&&globalThis.Buffer.isBuffer(e)}function Pe(e){return e instanceof Uint8Array?se(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const tt=P?(e,n,t)=>t-n>64?globalThis.Buffer.from(e.subarray(n,t)).toString("utf8"):Fe(e,n,t):(e,n,t)=>t-n>64?et.decode(e.subarray(n,t)):Fe(e,n,t),rt=P?e=>e.length>64?globalThis.Buffer.from(e):De(e):e=>e.length>64?nt.encode(e):De(e),I=e=>Uint8Array.from(e),ve=P?(e,n,t)=>se(e)?new Uint8Array(e.subarray(n,t)):e.slice(n,t):(e,n,t)=>e.slice(n,t),ot=P?(e,n)=>(e=e.map(t=>t instanceof Uint8Array?t:globalThis.Buffer.from(t)),Pe(globalThis.Buffer.concat(e,n))):(e,n)=>{const t=new Uint8Array(n);let r=0;for(let o of e)r+o.length>t.length&&(o=o.subarray(0,t.length-r)),t.set(o,r),r+=o.length;return t},it=P?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function st(e,n){if(se(e)&&se(n))return e.compare(n);for(let t=0;t<e.length;t++)if(e[t]!==n[t])return e[t]<n[t]?-1:1;return 0}function De(e){const n=[];let t=0;for(let r=0;r<e.length;r++){let o=e.charCodeAt(r);o<128?n[t++]=o:o<2048?(n[t++]=o>>6|192,n[t++]=o&63|128):(o&64512)===55296&&r+1<e.length&&(e.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++r)&1023),n[t++]=o>>18|240,n[t++]=o>>12&63|128,n[t++]=o>>6&63|128,n[t++]=o&63|128):(n[t++]=o>>12|224,n[t++]=o>>6&63|128,n[t++]=o&63|128)}return n}function Fe(e,n,t){const r=[];for(;n<t;){const o=e[n];let i=null,a=o>239?4:o>223?3:o>191?2:1;if(n+a<=t){let f,p,x,y;switch(a){case 1:o<128&&(i=o);break;case 2:f=e[n+1],(f&192)===128&&(y=(o&31)<<6|f&63,y>127&&(i=y));break;case 3:f=e[n+1],p=e[n+2],(f&192)===128&&(p&192)===128&&(y=(o&15)<<12|(f&63)<<6|p&63,y>2047&&(y<55296||y>57343)&&(i=y));break;case 4:f=e[n+1],p=e[n+2],x=e[n+3],(f&192)===128&&(p&192)===128&&(x&192)===128&&(y=(o&15)<<18|(f&63)<<12|(p&63)<<6|x&63,y>65535&&y<1114112&&(i=y))}}i===null?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|i&1023),r.push(i),n+=a}return ct(r)}const je=4096;function ct(e){const n=e.length;if(n<=je)return String.fromCharCode.apply(String,e);let t="",r=0;for(;r<n;)t+=String.fromCharCode.apply(String,e.slice(r,r+=je));return t}const at=256;class qe{constructor(n=at){this.chunkSize=n,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(n){let t=this.chunks[this.chunks.length-1];if(this.cursor+n.length<=this.maxCursor+1){const o=t.length-(this.maxCursor-this.cursor)-1;t.set(n,o)}else{if(t){const o=t.length-(this.maxCursor-this.cursor)-1;o<t.length&&(this.chunks[this.chunks.length-1]=t.subarray(0,o),this.maxCursor=this.cursor-1)}n.length<64&&n.length<this.chunkSize?(t=it(this.chunkSize),this.chunks.push(t),this.maxCursor+=t.length,this._initReuseChunk===null&&(this._initReuseChunk=t),t.set(n,0)):(this.chunks.push(n),this.maxCursor+=n.length)}this.cursor+=n.length}toBytes(n=!1){let t;if(this.chunks.length===1){const r=this.chunks[0];n&&this.cursor>r.length/2?(t=this.cursor===r.length?r:r.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):t=ve(r,0,this.cursor)}else t=ot(this.chunks,this.cursor);return n&&this.reset(),t}}const d="CBOR decode error:",Ge="CBOR encode error:";function q(e,n,t){if(e.length-n<t)throw new Error(`${d} not enough data for type`)}const g=[24,256,65536,4294967296,BigInt("18446744073709551616")];function F(e,n,t){q(e,n,1);const r=e[n];if(t.strict===!0&&r<g[0])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return r}function j(e,n,t){q(e,n,2);const r=e[n]<<8|e[n+1];if(t.strict===!0&&r<g[1])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return r}function R(e,n,t){q(e,n,4);const r=e[n]*16777216+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3];if(t.strict===!0&&r<g[2])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);return r}function L(e,n,t){q(e,n,8);const r=e[n]*16777216+(e[n+1]<<16)+(e[n+2]<<8)+e[n+3],o=e[n+4]*16777216+(e[n+5]<<16)+(e[n+6]<<8)+e[n+7],i=(BigInt(r)<<BigInt(32))+BigInt(o);if(t.strict===!0&&i<g[3])throw new Error(`${d} integer encoded in more bytes than necessary (strict decode)`);if(i<=Number.MAX_SAFE_INTEGER)return Number(i);if(t.allowBigInt===!0)return i;throw new Error(`${d} integers outside of the safe integer range are not supported`)}function ut(e,n,t,r){return new u(s.uint,F(e,n+1,r),2)}function ft(e,n,t,r){return new u(s.uint,j(e,n+1,r),3)}function dt(e,n,t,r){return new u(s.uint,R(e,n+1,r),5)}function lt(e,n,t,r){return new u(s.uint,L(e,n+1,r),9)}function V(e,n){return v(e,0,n.value)}function v(e,n,t){if(t<g[0]){const r=Number(t);e.push([n|r])}else if(t<g[1]){const r=Number(t);e.push([n|24,r])}else if(t<g[2]){const r=Number(t);e.push([n|25,r>>>8,r&255])}else if(t<g[3]){const r=Number(t);e.push([n|26,r>>>24&255,r>>>16&255,r>>>8&255,r&255])}else{const r=BigInt(t);if(r<g[4]){const o=[n|27,0,0,0,0,0,0,0];let i=Number(r&BigInt(4294967295)),a=Number(r>>BigInt(32)&BigInt(4294967295));o[8]=i&255,i=i>>8,o[7]=i&255,i=i>>8,o[6]=i&255,i=i>>8,o[5]=i&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${d} encountered BigInt larger than allowable range`)}}V.encodedSize=function(n){return v.encodedSize(n.value)};v.encodedSize=function(n){return n<g[0]?1:n<g[1]?2:n<g[2]?3:n<g[3]?5:9};V.compareTokens=function(n,t){return n.value<t.value?-1:n.value>t.value?1:0};function ht(e,n,t,r){return new u(s.negint,-1-F(e,n+1,r),2)}function pt(e,n,t,r){return new u(s.negint,-1-j(e,n+1,r),3)}function yt(e,n,t,r){return new u(s.negint,-1-R(e,n+1,r),5)}const Ae=BigInt(-1),Ke=BigInt(1);function wt(e,n,t,r){const o=L(e,n+1,r);if(typeof o!="bigint"){const i=-1-o;if(i>=Number.MIN_SAFE_INTEGER)return new u(s.negint,i,9)}if(r.allowBigInt!==!0)throw new Error(`${d} integers outside of the safe integer range are not supported`);return new u(s.negint,Ae-BigInt(o),9)}function _e(e,n){const t=n.value,r=typeof t=="bigint"?t*Ae-Ke:t*-1-1;v(e,n.type.majorEncoded,r)}_e.encodedSize=function(n){const t=n.value,r=typeof t=="bigint"?t*Ae-Ke:t*-1-1;return r<g[0]?1:r<g[1]?2:r<g[2]?3:r<g[3]?5:9};_e.compareTokens=function(n,t){return n.value<t.value?1:n.value>t.value?-1:0};function H(e,n,t,r){q(e,n,t+r);const o=ve(e,n+t,n+t+r);return new u(s.bytes,o,t+r)}function gt(e,n,t,r){return H(e,n,1,t)}function xt(e,n,t,r){return H(e,n,2,F(e,n+1,r))}function mt(e,n,t,r){return H(e,n,3,j(e,n+1,r))}function bt(e,n,t,r){return H(e,n,5,R(e,n+1,r))}function Et(e,n,t,r){const o=L(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer bytes lengths not supported`);return H(e,n,9,o)}function ce(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===s.string?rt(e.value):e.value),e.encodedBytes}function de(e,n){const t=ce(n);v(e,n.type.majorEncoded,t.length),e.push(t)}de.encodedSize=function(n){const t=ce(n);return v.encodedSize(t.length)+t.length};de.compareTokens=function(n,t){return vt(ce(n),ce(t))};function vt(e,n){return e.length<n.length?-1:e.length>n.length?1:st(e,n)}function Z(e,n,t,r,o){const i=t+r;q(e,n,i);const a=new u(s.string,tt(e,n+t,n+i),i);return o.retainStringBytes===!0&&(a.byteValue=ve(e,n+t,n+i)),a}function At(e,n,t,r){return Z(e,n,1,t,r)}function _t(e,n,t,r){return Z(e,n,2,F(e,n+1,r),r)}function St(e,n,t,r){return Z(e,n,3,j(e,n+1,r),r)}function kt(e,n,t,r){return Z(e,n,5,R(e,n+1,r),r)}function Bt(e,n,t,r){const o=L(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer string lengths not supported`);return Z(e,n,9,o,r)}const Tt=de;function G(e,n,t,r){return new u(s.array,r,t)}function Ut(e,n,t,r){return G(e,n,1,t)}function $t(e,n,t,r){return G(e,n,2,F(e,n+1,r))}function It(e,n,t,r){return G(e,n,3,j(e,n+1,r))}function Nt(e,n,t,r){return G(e,n,5,R(e,n+1,r))}function Ct(e,n,t,r){const o=L(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer array lengths not supported`);return G(e,n,9,o)}function zt(e,n,t,r){if(r.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return G(e,n,1,1/0)}function Se(e,n){v(e,s.array.majorEncoded,n.value)}Se.compareTokens=V.compareTokens;Se.encodedSize=function(n){return v.encodedSize(n.value)};function K(e,n,t,r){return new u(s.map,r,t)}function Mt(e,n,t,r){return K(e,n,1,t)}function Ot(e,n,t,r){return K(e,n,2,F(e,n+1,r))}function Dt(e,n,t,r){return K(e,n,3,j(e,n+1,r))}function Ft(e,n,t,r){return K(e,n,5,R(e,n+1,r))}function jt(e,n,t,r){const o=L(e,n+1,r);if(typeof o=="bigint")throw new Error(`${d} 64-bit integer map lengths not supported`);return K(e,n,9,o)}function Rt(e,n,t,r){if(r.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return K(e,n,1,1/0)}function ke(e,n){v(e,s.map.majorEncoded,n.value)}ke.compareTokens=V.compareTokens;ke.encodedSize=function(n){return v.encodedSize(n.value)};function Lt(e,n,t,r){return new u(s.tag,t,1)}function Vt(e,n,t,r){return new u(s.tag,F(e,n+1,r),2)}function Pt(e,n,t,r){return new u(s.tag,j(e,n+1,r),3)}function qt(e,n,t,r){return new u(s.tag,R(e,n+1,r),5)}function Gt(e,n,t,r){return new u(s.tag,L(e,n+1,r),9)}function Be(e,n){v(e,s.tag.majorEncoded,n.value)}Be.compareTokens=V.compareTokens;Be.encodedSize=function(n){return v.encodedSize(n.value)};const Kt=20,Jt=21,Qt=22,Wt=23;function Xt(e,n,t,r){if(r.allowUndefined===!1)throw new Error(`${d} undefined values are not supported`);return r.coerceUndefinedToNull===!0?new u(s.null,null,1):new u(s.undefined,void 0,1)}function Ht(e,n,t,r){if(r.allowIndefinite===!1)throw new Error(`${d} indefinite length items not allowed`);return new u(s.break,void 0,1)}function Te(e,n,t){if(t){if(t.allowNaN===!1&&Number.isNaN(e))throw new Error(`${d} NaN values are not supported`);if(t.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${d} Infinity values are not supported`)}return new u(s.float,e,n)}function Zt(e,n,t,r){return Te($e(e,n+1),3,r)}function Yt(e,n,t,r){return Te(Ie(e,n+1),5,r)}function er(e,n,t,r){return Te(Xe(e,n+1),9,r)}function Ue(e,n,t){const r=n.value;if(r===!1)e.push([s.float.majorEncoded|Kt]);else if(r===!0)e.push([s.float.majorEncoded|Jt]);else if(r===null)e.push([s.float.majorEncoded|Qt]);else if(r===void 0)e.push([s.float.majorEncoded|Wt]);else{let o,i=!1;(!t||t.float64!==!0)&&(Qe(r),o=$e(S,1),r===o||Number.isNaN(r)?(S[0]=249,e.push(S.slice(0,3)),i=!0):(We(r),o=Ie(S,1),r===o&&(S[0]=250,e.push(S.slice(0,5)),i=!0))),i||(nr(r),o=Xe(S,1),S[0]=251,e.push(S.slice(0,9)))}}Ue.encodedSize=function(n,t){const r=n.value;if(r===!1||r===!0||r===null||r===void 0)return 1;if(!t||t.float64!==!0){Qe(r);let o=$e(S,1);if(r===o||Number.isNaN(r))return 3;if(We(r),o=Ie(S,1),r===o)return 5}return 9};const Je=new ArrayBuffer(9),E=new DataView(Je,1),S=new Uint8Array(Je,0);function Qe(e){if(e===1/0)E.setUint16(0,31744,!1);else if(e===-1/0)E.setUint16(0,64512,!1);else if(Number.isNaN(e))E.setUint16(0,32256,!1);else{E.setFloat32(0,e);const n=E.getUint32(0),t=(n&2139095040)>>23,r=n&8388607;if(t===255)E.setUint16(0,31744,!1);else if(t===0)E.setUint16(0,(e&2147483648)>>16|r>>13,!1);else{const o=t-127;o<-24?E.setUint16(0,0):o<-14?E.setUint16(0,(n&2147483648)>>16|1<<24+o,!1):E.setUint16(0,(n&2147483648)>>16|o+15<<10|r>>13,!1)}}}function $e(e,n){if(e.length-n<2)throw new Error(`${d} not enough data for float16`);const t=(e[n]<<8)+e[n+1];if(t===31744)return 1/0;if(t===64512)return-1/0;if(t===32256)return NaN;const r=t>>10&31,o=t&1023;let i;return r===0?i=o*2**-24:r!==31?i=(o+1024)*2**(r-25):i=o===0?1/0:NaN,t&32768?-i:i}function We(e){E.setFloat32(0,e,!1)}function Ie(e,n){if(e.length-n<4)throw new Error(`${d} not enough data for float32`);const t=(e.byteOffset||0)+n;return new DataView(e.buffer,t,4).getFloat32(0,!1)}function nr(e){E.setFloat64(0,e,!1)}function Xe(e,n){if(e.length-n<8)throw new Error(`${d} not enough data for float64`);const t=(e.byteOffset||0)+n;return new DataView(e.buffer,t,8).getFloat64(0,!1)}Ue.compareTokens=V.compareTokens;function l(e,n,t){throw new Error(`${d} encountered invalid minor (${t}) for major ${e[n]>>>5}`)}function le(e){return()=>{throw new Error(`${d} ${e}`)}}const c=[];for(let e=0;e<=23;e++)c[e]=l;c[24]=ut;c[25]=ft;c[26]=dt;c[27]=lt;c[28]=l;c[29]=l;c[30]=l;c[31]=l;for(let e=32;e<=55;e++)c[e]=l;c[56]=ht;c[57]=pt;c[58]=yt;c[59]=wt;c[60]=l;c[61]=l;c[62]=l;c[63]=l;for(let e=64;e<=87;e++)c[e]=gt;c[88]=xt;c[89]=mt;c[90]=bt;c[91]=Et;c[92]=l;c[93]=l;c[94]=l;c[95]=le("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)c[e]=At;c[120]=_t;c[121]=St;c[122]=kt;c[123]=Bt;c[124]=l;c[125]=l;c[126]=l;c[127]=le("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)c[e]=Ut;c[152]=$t;c[153]=It;c[154]=Nt;c[155]=Ct;c[156]=l;c[157]=l;c[158]=l;c[159]=zt;for(let e=160;e<=183;e++)c[e]=Mt;c[184]=Ot;c[185]=Dt;c[186]=Ft;c[187]=jt;c[188]=l;c[189]=l;c[190]=l;c[191]=Rt;for(let e=192;e<=215;e++)c[e]=Lt;c[216]=Vt;c[217]=Pt;c[218]=qt;c[219]=Gt;c[220]=l;c[221]=l;c[222]=l;c[223]=l;for(let e=224;e<=243;e++)c[e]=le("simple values are not supported");c[244]=l;c[245]=l;c[246]=l;c[247]=Xt;c[248]=le("simple values are not supported");c[249]=Zt;c[250]=Yt;c[251]=er;c[252]=l;c[253]=l;c[254]=l;c[255]=Ht;const U=[];for(let e=0;e<24;e++)U[e]=new u(s.uint,e,1);for(let e=-1;e>=-24;e--)U[31-e]=new u(s.negint,e,1);U[64]=new u(s.bytes,new Uint8Array(0),1);U[96]=new u(s.string,"",1);U[128]=new u(s.array,0,1);U[160]=new u(s.map,0,1);U[244]=new u(s.false,!1,1);U[245]=new u(s.true,!0,1);U[246]=new u(s.null,null,1);function tr(e){switch(e.type){case s.false:return I([244]);case s.true:return I([245]);case s.null:return I([246]);case s.bytes:return e.value.length?void 0:I([64]);case s.string:return e.value===""?I([96]):void 0;case s.array:return e.value===0?I([128]):void 0;case s.map:return e.value===0?I([160]):void 0;case s.uint:return e.value<24?I([Number(e.value)]):void 0;case s.negint:if(e.value>=-24)return I([31-Number(e.value)])}}const rr={float64:!1,mapSorter:sr,quickEncodeToken:tr};function or(){const e=[];return e[s.uint.major]=V,e[s.negint.major]=_e,e[s.bytes.major]=de,e[s.string.major]=Tt,e[s.array.major]=Se,e[s.map.major]=ke,e[s.tag.major]=Be,e[s.float.major]=Ue,e}const He=or(),ye=new qe;class ae{constructor(n,t){this.obj=n,this.parent=t}includes(n){let t=this;do if(t.obj===n)return!0;while(t=t.parent);return!1}static createCheck(n,t){if(n&&n.includes(t))throw new Error(`${Ge} object contains circular references`);return new ae(t,n)}}const M={null:new u(s.null,null),undefined:new u(s.undefined,void 0),true:new u(s.true,!0),false:new u(s.false,!1),emptyArray:new u(s.array,0),emptyMap:new u(s.map,0)},O={number(e,n,t,r){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new u(s.float,e):e>=0?new u(s.uint,e):new u(s.negint,e)},bigint(e,n,t,r){return e>=BigInt(0)?new u(s.uint,e):new u(s.negint,e)},Uint8Array(e,n,t,r){return new u(s.bytes,e)},string(e,n,t,r){return new u(s.string,e)},boolean(e,n,t,r){return e?M.true:M.false},null(e,n,t,r){return M.null},undefined(e,n,t,r){return M.undefined},ArrayBuffer(e,n,t,r){return new u(s.bytes,new Uint8Array(e))},DataView(e,n,t,r){return new u(s.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,n,t,r){if(!e.length)return t.addBreakTokens===!0?[M.emptyArray,new u(s.break)]:M.emptyArray;r=ae.createCheck(r,e);const o=[];let i=0;for(const a of e)o[i++]=te(a,t,r);return t.addBreakTokens?[new u(s.array,e.length),o,new u(s.break)]:[new u(s.array,e.length),o]},Object(e,n,t,r){const o=n!=="Object",i=o?e.keys():Object.keys(e),a=o?e.size:i.length;if(!a)return t.addBreakTokens===!0?[M.emptyMap,new u(s.break)]:M.emptyMap;r=ae.createCheck(r,e);const f=[];let p=0;for(const x of i)f[p++]=[te(x,t,r),te(o?e.get(x):e[x],t,r)];return ir(f,t),t.addBreakTokens?[new u(s.map,a),f,new u(s.break)]:[new u(s.map,a),f]}};O.Map=O.Object;O.Buffer=O.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))O[`${e}Array`]=O.DataView;function te(e,n={},t){const r=Hn(e),o=n&&n.typeEncoders&&n.typeEncoders[r]||O[r];if(typeof o=="function"){const a=o(e,r,n,t);if(a!=null)return a}const i=O[r];if(!i)throw new Error(`${Ge} unsupported type: ${r}`);return i(e,r,n,t)}function ir(e,n){n.mapSorter&&e.sort(n.mapSorter)}function sr(e,n){const t=Array.isArray(e[0])?e[0][0]:e[0],r=Array.isArray(n[0])?n[0][0]:n[0];if(t.type!==r.type)return t.type.compare(r.type);const o=t.type.major,i=He[o].compareTokens(t,r);return i===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),i}function Ze(e,n,t,r){if(Array.isArray(n))for(const o of n)Ze(e,o,t,r);else t[n.type.major](e,n,r)}function cr(e,n,t){const r=te(e,t);if(!Array.isArray(r)&&t.quickEncodeToken){const o=t.quickEncodeToken(r);if(o)return o;const i=n[r.type.major];if(i.encodedSize){const a=i.encodedSize(r,t),f=new qe(a);if(i(f,r,t),f.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${r} was wrong`);return Pe(f.chunks[0])}}return ye.reset(),Ze(ye,r,n,t),ye.toBytes(!0)}function ar(e,n){return n=Object.assign({},rr,n),cr(e,He,n)}const ur={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class fr{constructor(n,t={}){this._pos=0,this.data=n,this.options=t}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const n=this.data[this._pos];let t=U[n];if(t===void 0){const r=c[n];if(!r)throw new Error(`${d} no decoder for major type ${n>>>5} (byte 0x${n.toString(16).padStart(2,"0")})`);const o=n&31;t=r(this.data,this._pos,o,this.options)}return this._pos+=t.encodedLength,t}}const W=Symbol.for("DONE"),he=Symbol.for("BREAK");function dr(e,n,t){const r=[];for(let o=0;o<e.value;o++){const i=X(n,t);if(i===he){if(e.value===1/0)break;throw new Error(`${d} got unexpected break to lengthed array`)}if(i===W)throw new Error(`${d} found array but not enough entries (got ${o}, expected ${e.value})`);r[o]=i}return r}function lr(e,n,t){const r=t.useMaps===!0,o=r?void 0:{},i=r?new Map:void 0;for(let a=0;a<e.value;a++){const f=X(n,t);if(f===he){if(e.value===1/0)break;throw new Error(`${d} got unexpected break to lengthed map`)}if(f===W)throw new Error(`${d} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(r!==!0&&typeof f!="string")throw new Error(`${d} non-string keys not supported (got ${typeof f})`);if(t.rejectDuplicateMapKeys===!0&&(r&&i.has(f)||!r&&f in o))throw new Error(`${d} found repeat map key "${f}"`);const p=X(n,t);if(p===W)throw new Error(`${d} found map but not enough entries (got ${a} [no value], expected ${e.value})`);r?i.set(f,p):o[f]=p}return r?i:o}function X(e,n){if(e.done())return W;const t=e.next();if(t.type===s.break)return he;if(t.type.terminal)return t.value;if(t.type===s.array)return dr(t,e,n);if(t.type===s.map)return lr(t,e,n);if(t.type===s.tag){if(n.tags&&typeof n.tags[t.value]=="function"){const r=X(e,n);return n.tags[t.value](r)}throw new Error(`${d} tag not supported (${t.value})`)}throw new Error("unsupported")}function hr(e,n){if(!(e instanceof Uint8Array))throw new Error(`${d} data to decode must be a Uint8Array`);n=Object.assign({},ur,n);const t=n.tokenizer||new fr(e,n),r=X(t,n);if(r===W)throw new Error(`${d} did not find any content to decode`);if(r===he)throw new Error(`${d} got unexpected break`);return[r,e.subarray(t.pos())]}function pr(e,n){const[t,r]=hr(e,n);if(r.length>0)throw new Error(`${d} too many terminals, data makes no sense`);return t}const Ye=42;function en(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function yr(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const n=w.asCID(e);if(!n)return null;const t=new Uint8Array(n.bytes.byteLength+1);return t.set(n.bytes,1),[new u(s.tag,Ye),new u(s.bytes,t)]}function wr(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function gr(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}function xr(e){for(const n of e.keys())if(typeof n!="string"||n.length===0)throw new Error("Non-string Map keys are not supported by the IPLD Data Model and cannot be encoded");return null}const me={float64:!0,typeEncoders:{Map:xr,Object:yr,undefined:wr,number:gr}},mr={...me,typeEncoders:{...me.typeEncoders}};function br(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return w.decode(e.subarray(1))}const ue={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ue.tags[Ye]=br;const Er={...ue,tags:ue.tags.slice()},vr="dag-cbor",Ar=113,_r=e=>ar(e,me),Sr=e=>pr(en(e),ue),Nr=Object.freeze(Object.defineProperty({__proto__:null,code:Ar,decode:Sr,decodeOptions:Er,encode:_r,encodeOptions:mr,name:vr,toByteView:en},Symbol.toStringTag,{value:"Module"}));export{Ir as A,$r as B,w as C,Ur as D,Ge as E,rt as F,Pe as G,cr as H,d as I,ct as J,u as T,Vn as a,s as b,Nr as c,Sr as d,_r as e,kr as f,N as g,oe as h,ie as i,ge as j,Ar as k,Q as l,or as m,vr as n,rn as o,ar as p,tr as q,ne as r,pr as s,Ln as t,fe as u,C as v,Le as w,Tr as x,Br as y,be as z};
