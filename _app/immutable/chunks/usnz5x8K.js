import{u as l}from"./C_jHh3BX.js";var H={};(function(h){Object.defineProperty(h,"__esModule",{value:!0}),h.hmac=h.HMAC=void 0;const i=l;class r extends i.Hash{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,(0,i.ahash)(t);const a=(0,i.toBytes)(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const c=this.blockLen,e=new Uint8Array(c);e.set(a.length>c?t.create().update(a).digest():a);for(let s=0;s<e.length;s++)e[s]^=54;this.iHash.update(e),this.oHash=t.create();for(let s=0;s<e.length;s++)e[s]^=106;this.oHash.update(e),(0,i.clean)(e)}update(t){return(0,i.aexists)(this),this.iHash.update(t),this}digestInto(t){(0,i.aexists)(this),(0,i.abytes)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:a,finished:c,destroyed:e,blockLen:s,outputLen:u}=this;return t=t,t.finished=c,t.destroyed=e,t.blockLen=s,t.outputLen=u,t.oHash=n._cloneInto(t.oHash),t.iHash=a._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}h.HMAC=r;const d=(o,t,n)=>new r(o,t).update(n).digest();h.hmac=d,h.hmac.create=(o,t)=>new r(o,t)})(H);export{H as h};
