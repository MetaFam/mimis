import"./DsnmJJEf.js";import{p as J,aB as q,g as K,k as r,aw as A,az as k,f as v,b as p,c as L,s as w,d,r as g,a as M,t as O}from"./C0lYg4N8.js";import{d as Q,e as I}from"./DmKVZe3W.js";import{i as E}from"./DJx03HtA.js";import{e as T,i as V}from"./BznPomiX.js";import{r as X,a as D,s as Y}from"./CoB6fEAl.js";import{b as Z}from"./DU8poMv7.js";import{b as x}from"./C1A0XLvw.js";import{p as ee}from"./DQWNuCS8.js";import{s as te}from"./B0SWonas.js";function se(m,b,e,n){b&&console.debug({"Replacing From":[...e]}),e.length>0&&n(e.pop()??[""])}var le=v('<li class="svelte-8j7lzy"><button id="clear" class="svelte-8j7lzy"><span>∅</span></button></li>'),oe=function(m,b,e){if(m.key==="Enter"){m.preventDefault();const n=new Event("submit",{bubbles:!0,cancelable:!0});n.submitter=this,r(b)?.dispatchEvent(n),e&&console.debug({Fired:n})}},ne=v('<button type="button" class="minus svelte-8j7lzy"><span class="svelte-8j7lzy">⨯</span></button>'),ae=v('<li class="svelte-8j7lzy"><button type="button" class="slash svelte-8j7lzy"><span>/</span></button></li>'),re=v('<li><input class="svelte-8j7lzy"/> <!></li> <!>',1),ie=v('<li class="svelte-8j7lzy"><button type="button" class="svelte-8j7lzy"><span>↺</span></button></li>'),ue=v('<form><ol class="svelte-8j7lzy"><!> <li class="svelte-8j7lzy"><button id="before" class="svelte-8j7lzy"><span>+</span></button></li> <!> <li class="svelte-8j7lzy"><button id="more" class="svelte-8j7lzy"><span>+</span></button></li> <!></ol></form>');function ye(m,b){J(b,!0);let e=ee(b,"elements",31,()=>q([""])),n=q([]),h=A(null),{debugging:i}=te,y=A(null),z=A(null);function j(t,{clear:s=!1}={}){const l=s?[]:e().slice(0,t),u=s?[]:e().slice(t),o=[...l,"",...u];n.push([...e()]),i&&console.debug({Replacing:n.at(-1),With:[...o]}),e(o),k(h,t,!0)}K(()=>{r(h)!=null&&(r(y)?.querySelectorAll("input")[r(h)]?.focus(),k(h,null))});var _=ue(),F=d(_),N=d(F);{var B=t=>{var s=le();p(t,s)};E(N,t=>{(e().length>1||e()[0]!=="")&&t(B)})}var P=w(N,4);T(P,17,e,V,(t,s,l)=>{var u=re(),o=M(u);let R;var c=d(o);X(c),D(c,"id",`text-${l}`),c.__keydown=[oe,y,i];var $=w(c,2);{var C=a=>{var f=ne();f.__click=()=>{n.push([...e()]),e().splice(l,1)},D(f,"tabindex",-1),p(a,f)};E($,a=>{e().length>1&&a(C)})}g(o);var G=w(o,2);{var H=a=>{var f=ae(),S=d(f);S.__click=()=>j(l+1),D(S,"tabindex",-1),g(f),p(a,f)};E(G,a=>{l<e().length-1&&a(H)})}O(a=>R=Y(o,1,"svelte-8j7lzy",null,R,a),[()=>({single:e().length<=1})]),I("focus",c,()=>{k(z,e()[l],!0)}),I("blur",c,()=>{r(z)&&r(z)!==e()[l]&&(i&&console.debug({from:r(z),to:e()[l]}),n.push([...e()]))}),Z(c,()=>e()[l],a=>e(e()[l]=a,!0)),p(t,u)});var U=w(P,4);{var W=t=>{var s=ie(),l=d(s);l.__click=[se,i,n,e],g(s),p(t,s)};E(U,t=>{n.length>0&&t(W)})}g(F),g(_),x(_,t=>k(y,t),()=>r(y)),I("submit",_,t=>{t.preventDefault();const s=t.submitter?.id;if(!s)throw new Error("No submitter.");i&&console.debug({submitter:s});const[l,u]=Array.from(s.match(/^text-(\d+)$/)??[]);if(u){const o=Number(u)+1;i&&console.debug({"Inserting At":o}),j(o)}else if(["before","more"].includes(s)){const o=s==="before"?0:e().length;i&&console.debug({idx:o}),j(o)}else if(s==="clear")j(0,{clear:!0});else throw new Error(`Unrecognized Submitter Id: "${s}"`)}),p(m,_),L()}Q(["keydown","click"]);export{ye as P};
