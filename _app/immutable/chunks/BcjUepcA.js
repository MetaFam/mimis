import"./CWj6FrbW.js";import{p as J,ah as U,g as K,k as u,ac as D,af as E,f as _,b as m,c as L,s as A,d as h,r as z,a as M,t as O}from"./CuKwMJ0M.js";import{d as Q,e as F}from"./DRICJ3qh.js";import{i as I}from"./DX5XkaxQ.js";import{e as T,i as V}from"./CpRzmRWM.js";import{r as X,a as N,s as Y}from"./3AH-aWZb.js";import{b as Z}from"./Dr6VHgLh.js";import{b as x}from"./DohLA9KU.js";import{p as ee}from"./9QLm_P5S.js";import{s as te}from"./DLUp0E8X.js";function se(d,v,e,o){v&&console.debug({"Replacing From":[...e]}),e.length>0&&o(e.pop()??[""])}var le=_('<li class="svelte-1fu48zf"><button id="clear" class="svelte-1fu48zf"><span>∅</span></button></li>'),oe=function(d,v,e){var o;if(d.key==="Enter"){d.preventDefault();const r=new Event("submit",{bubbles:!0,cancelable:!0});r.submitter=this,(o=u(v))==null||o.dispatchEvent(r),e&&console.debug({Fired:r})}},ne=_('<button type="button" class="minus svelte-1fu48zf"><span class="svelte-1fu48zf">⨯</span></button>'),ae=_('<li class="svelte-1fu48zf"><button type="button" class="slash svelte-1fu48zf"><span>/</span></button></li>'),re=_('<li><input class="svelte-1fu48zf"/> <!></li> <!>',1),ie=_('<li class="svelte-1fu48zf"><button type="button" class="svelte-1fu48zf"><span>↺</span></button></li>'),ue=_('<form><ol class="svelte-1fu48zf"><!> <li class="svelte-1fu48zf"><button id="before" class="svelte-1fu48zf"><span>+</span></button></li> <!> <li class="svelte-1fu48zf"><button id="more" class="svelte-1fu48zf"><span>+</span></button></li> <!></ol></form>');function ze(d,v){J(v,!0);let e=ee(v,"elements",31,()=>U([""])),o=U([]),r=D(null),{debugging:f}=te,k=D(null),w=D(null);function y(t,{clear:s=!1}={}){const l=s?[]:e().slice(0,t),c=s?[]:e().slice(t),a=[...l,"",...c];o.push([...e()]),f&&console.debug({Replacing:o.at(-1),With:[...a]}),e(a),E(r,t,!0)}K(()=>{var t,s;u(r)!=null&&((s=(t=u(k))==null?void 0:t.querySelectorAll("input")[u(r)])==null||s.focus(),E(r,null))});var g=ue(),P=h(g),R=h(P);{var W=t=>{var s=le();m(t,s)};I(R,t=>{(e().length>1||e()[0]!=="")&&t(W)})}var S=A(R,4);T(S,17,e,V,(t,s,l)=>{var c=re(),a=M(c);let i;var b=h(a);X(b),N(b,"id",`text-${l}`),b.__keydown=[oe,k,f];var B=A(b,2);{var C=n=>{var p=ne();p.__click=()=>{o.push([...e()]),e().splice(l,1)},N(p,"tabindex",-1),m(n,p)};I(B,n=>{e().length>1&&n(C)})}z(a);var G=A(a,2);{var H=n=>{var p=ae(),q=h(p);q.__click=()=>y(l+1),N(q,"tabindex",-1),z(p),m(n,p)};I(G,n=>{l<e().length-1&&n(H)})}O(n=>i=Y(a,1,"svelte-1fu48zf",null,i,n),[()=>({single:e().length<=1})]),F("focus",b,()=>{E(w,e()[l],!0)}),F("blur",b,()=>{u(w)&&u(w)!==e()[l]&&(f&&console.debug({from:u(w),to:e()[l]}),o.push([...e()]))}),Z(b,()=>e()[l],n=>e(e()[l]=n,!0)),m(t,c)});var $=A(S,4);{var j=t=>{var s=ie(),l=h(s);l.__click=[se,f,o,e],z(s),m(t,s)};I($,t=>{o.length>0&&t(j)})}z(P),z(g),x(g,t=>E(k,t),()=>u(k)),F("submit",g,t=>{var a;t.preventDefault();const s=(a=t.submitter)==null?void 0:a.id;if(!s)throw new Error("No submitter.");f&&console.debug({submitter:s});const[l,c]=Array.from(s.match(/^text-(\d+)$/)??[]);if(c){const i=Number(c)+1;f&&console.debug({"Inserting At":i}),y(i)}else if(["before","more"].includes(s)){const i=s==="before"?0:e().length;f&&console.debug({idx:i}),y(i)}else if(s==="clear")y(0,{clear:!0});else throw new Error(`Unrecognized Submitter Id: "${s}"`)}),m(d,g),L()}Q(["keydown","click"]);export{ze as P};
