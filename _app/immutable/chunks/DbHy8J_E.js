const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BJNSLkbZ.js","./DE9oX6xH.js","./CMbgCQxV.js","./CE1G-McA.js","./DgjbO070.js","./PPVm8Dsz.js","./Lj-dUBm2.js","./DSTOT4fw.js","./DyudQPZA.js","./CADC4eU6.js","./D7ShErVm.js","./Ci5bNVgp.js","./DtOm4NEL.js","./DRDJEAPC.js","./BBdtkszK.js","./D7Ct-6yo.js","./DZWKlvqC.js","./Cg-pzjal.js","./BQYk2qmO.js","./H-Ckw-g_.js","./C-EN3jM8.js"])))=>i.map(i=>d[i]);
import{_ as g}from"./PPVm8Dsz.js";import{d6 as _,bn as p,aV as y,d7 as A,b_ as C,b1 as v,d8 as m,ci as P}from"./DgjbO070.js";import{d9 as x}from"./DgjbO070.js";I.type="coinbaseWallet";function I(h={}){return h.version==="3"||h.headlessMode?E(h):U(h)}function U(h){let f,l,u,c;return _(o=>({id:"coinbaseWalletSDK",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",type:I.type,async connect({chainId:t,withCapabilities:r,...e}={}){try{const n=await this.getProvider(),i=(await n.request({method:"eth_requestAccounts",params:"instantOnboarding"in e&&e.instantOnboarding?[{onboarding:"instant"}]:[]})).map(d=>p(d));l||(l=this.onAccountsChanged.bind(this),n.on("accountsChanged",l)),u||(u=this.onChainChanged.bind(this),n.on("chainChanged",u)),c||(c=this.onDisconnect.bind(this),n.on("disconnect",c));let a=await this.getChainId();return t&&a!==t&&(a=(await this.switchChain({chainId:t}).catch(s=>{if(s.code===v.code)throw s;return{id:a}}))?.id??a),{accounts:r?i.map(d=>({address:d,capabilities:{}})):i,chainId:a}}catch(n){throw/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(n.message)?new v(n):n}},async disconnect(){const t=await this.getProvider();l&&(t.removeListener("accountsChanged",l),l=void 0),u&&(t.removeListener("chainChanged",u),u=void 0),c&&(t.removeListener("disconnect",c),c=void 0),t.disconnect(),t.close?.()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(r=>p(r))},async getChainId(){const r=await(await this.getProvider()).request({method:"eth_chainId"});return Number(r)},async getProvider(){if(!f){const t=typeof h.preference=="string"?{options:h.preference}:{...h.preference,options:h.preference?.options??"all"},{createCoinbaseWalletSDK:r}=await g(async()=>{const{createCoinbaseWalletSDK:n}=await import("./BJNSLkbZ.js");return{createCoinbaseWalletSDK:n}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url);f=r({...h,appChainIds:o.chains.map(n=>n.id),preference:t}).getProvider()}return f},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:t,chainId:r}){const e=o.chains.find(i=>i.id===r);if(!e)throw new y(new A);const n=await this.getProvider();try{return await n.request({method:"wallet_switchEthereumChain",params:[{chainId:C(e.id)}]}),e}catch(i){if(i.code===4902)try{let a;t?.blockExplorerUrls?a=t.blockExplorerUrls:a=e.blockExplorers?.default.url?[e.blockExplorers?.default.url]:[];let d;t?.rpcUrls?.length?d=t.rpcUrls:d=[e.rpcUrls.default?.http[0]??""];const s={blockExplorerUrls:a,chainId:C(r),chainName:t?.chainName??e.name,iconUrls:t?.iconUrls,nativeCurrency:t?.nativeCurrency??e.nativeCurrency,rpcUrls:d};return await n.request({method:"wallet_addEthereumChain",params:[s]}),e}catch(a){throw new v(a)}throw new y(i)}},onAccountsChanged(t){t.length===0?this.onDisconnect():o.emitter.emit("change",{accounts:t.map(r=>p(r))})},onChainChanged(t){const r=Number(t);o.emitter.emit("change",{chainId:r})},async onDisconnect(t){o.emitter.emit("disconnect");const r=await this.getProvider();l&&(r.removeListener("accountsChanged",l),l=void 0),u&&(r.removeListener("chainChanged",u),u=void 0),c&&(r.removeListener("disconnect",c),c=void 0)}}))}function E(h){let l,u,c,o,t;return _(r=>({id:"coinbaseWalletSDK",name:"Coinbase Wallet",rdns:"com.coinbase.wallet",type:I.type,async connect({chainId:e,withCapabilities:n}={}){try{const i=await this.getProvider(),a=(await i.request({method:"eth_requestAccounts"})).map(s=>p(s));c||(c=this.onAccountsChanged.bind(this),i.on("accountsChanged",c)),o||(o=this.onChainChanged.bind(this),i.on("chainChanged",o)),t||(t=this.onDisconnect.bind(this),i.on("disconnect",t));let d=await this.getChainId();return e&&d!==e&&(d=(await this.switchChain({chainId:e}).catch(w=>{if(w.code===v.code)throw w;return{id:d}}))?.id??d),{accounts:n?a.map(s=>({address:s,capabilities:{}})):a,chainId:d}}catch(i){throw/(user closed modal|accounts received is empty|user denied account)/i.test(i.message)?new v(i):i}},async disconnect(){const e=await this.getProvider();c&&(e.removeListener("accountsChanged",c),c=void 0),o&&(e.removeListener("chainChanged",o),o=void 0),t&&(e.removeListener("disconnect",t),t=void 0),e.disconnect(),e.close()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(n=>p(n))},async getChainId(){const n=await(await this.getProvider()).request({method:"eth_chainId"});return Number(n)},async getProvider(){if(!u){const e=await(async()=>{const{default:s}=await g(async()=>{const{default:w}=await import("./BBdtkszK.js").then(b=>b.i);return{default:w}},__vite__mapDeps([14,3,15,2,16,1,4,5,6,7,17]),import.meta.url);return typeof s!="function"&&typeof s.default=="function"?s.default:s})();l=new e({...h,reloadOnDisconnect:!1});const n=l.walletExtension?.getChainId(),i=r.chains.find(s=>h.chainId?s.id===h.chainId:s.id===n)||r.chains[0],a=h.chainId||i?.id,d=h.jsonRpcUrl||i?.rpcUrls.default.http[0];u=l.makeWeb3Provider(d,a)}return u},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:e,chainId:n}){const i=r.chains.find(d=>d.id===n);if(!i)throw new y(new A);const a=await this.getProvider();try{return await a.request({method:"wallet_switchEthereumChain",params:[{chainId:C(i.id)}]}),i}catch(d){if(d.code===4902)try{let s;e?.blockExplorerUrls?s=e.blockExplorerUrls:s=i.blockExplorers?.default.url?[i.blockExplorers?.default.url]:[];let w;e?.rpcUrls?.length?w=e.rpcUrls:w=[i.rpcUrls.default?.http[0]??""];const b={blockExplorerUrls:s,chainId:C(n),chainName:e?.chainName??i.name,iconUrls:e?.iconUrls,nativeCurrency:e?.nativeCurrency??i.nativeCurrency,rpcUrls:w};return await a.request({method:"wallet_addEthereumChain",params:[b]}),i}catch(s){throw new v(s)}throw new y(d)}},onAccountsChanged(e){e.length===0?this.onDisconnect():r.emitter.emit("change",{accounts:e.map(n=>p(n))})},onChainChanged(e){const n=Number(e);r.emitter.emit("change",{chainId:n})},async onDisconnect(e){r.emitter.emit("disconnect");const n=await this.getProvider();c&&(n.removeListener("accountsChanged",c),c=void 0),o&&(n.removeListener("chainChanged",o),o=void 0),t&&(n.removeListener("disconnect",t),t=void 0)}}))}D.type="safe";function D(h={}){const{shimDisconnect:f=!1}=h;let l,u;return _(c=>({id:"safe",name:"Safe",type:D.type,async connect({withCapabilities:o}={}){const t=await this.getProvider();if(!t)throw new m;const r=await this.getAccounts(),e=await this.getChainId();return u||(u=this.onDisconnect.bind(this),t.on("disconnect",u)),f&&await c.storage?.removeItem("safe.disconnected"),{accounts:o?r.map(n=>({address:n,capabilities:{}})):r,chainId:e}},async disconnect(){const o=await this.getProvider();if(!o)throw new m;u&&(o.removeListener("disconnect",u),u=void 0),f&&await c.storage?.setItem("safe.disconnected",!0)},async getAccounts(){const o=await this.getProvider();if(!o)throw new m;return(await o.request({method:"eth_accounts"})).map(p)},async getProvider(){if(typeof window<"u"&&window?.parent!==window){if(!l){const{default:t}=await g(async()=>{const{default:i}=await import("./BQYk2qmO.js");return{default:i}},__vite__mapDeps([18,19,4,5,2,3,6,7,12,13]),import.meta.url),r=new t(h),e=await P(()=>r.safe.getInfo(),{timeout:h.unstable_getInfoTimeout??10});if(!e)throw new Error("Could not load Safe information");const n=await(async()=>{const i=await g(()=>import("./C-EN3jM8.js").then(a=>a.i),__vite__mapDeps([20,3,19,4,5,2,6,7]),import.meta.url);return typeof i.SafeAppProvider!="function"&&typeof i.default.SafeAppProvider=="function"?i.default.SafeAppProvider:i.SafeAppProvider})();l=new n(e,r)}return l}},async getChainId(){const o=await this.getProvider();if(!o)throw new m;return Number(o.chainId)},async isAuthorized(){try{return f&&await c.storage?.getItem("safe.disconnected")?!1:!!(await this.getAccounts()).length}catch{return!1}},onAccountsChanged(){},onChainChanged(){},onDisconnect(){c.emitter.emit("disconnect")}}))}export{I as coinbaseWallet,x as injected,D as safe};
