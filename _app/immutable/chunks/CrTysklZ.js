const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./D8cg6_pm.js","./C1TpcBhl.js","./BEBaXJsP.js","./BSA-I0eW.js","./CTLQ71tC.js","./D0rD0oH1.js","./PSPsK788.js","./DMsQp01z.js","./C1FmrZbK.js","./CBlzdlrX.js","./5PFStWLb.js","./_j-ydeXR.js","./CjluQCUE.js","./D5LmHS4N.js","./BK4xExxt.js","./DWrztYXu.js","./DBrWwVS6.js","./DfK8XkxJ.js","./DEabFy53.js","./Xe9s1VLN.js","./_pzurr6a.js","./zKXTYsiU.js","./9Mah59Sy.js","./Dmg8YACJ.js","./Cr-7asal.js","./Bq-mWZJ-.js","./D2sUVRo1.js","./C0V6bA4j.js","./BIQttNBf.js","./BaLsR-YP.js","./DSzT4ROJ.js","./Br007RDI.js","./BmbHSen-.js","./Wt21MFmU.js","./Cp1F6qBJ.js","./8kaIfX-U.js","./Cyy08N5o.js","./-154K8v3.js","./Eft46Qjv.js","./DH9Ogec6.js","./BtCy2t97.js","./gtReR__M.js","./DDlNpnEm.js","./EqxjHsgY.js","./Bt1sM-2S.js","./Dqm41e1f.js","./CTQ6PdE0.js","./Djho846u.js"])))=>i.map(i=>d[i]);
import{_ as Qt}from"./C1FmrZbK.js";import{b as O_}from"./Lj-dUBm2.js";import{l as R_,L as D_,M as $_,N as k_,O as U_,P as L_,s as M_,k as Uw,H as B_,D as $g,Q as F_,R as kg,f as Ug,t as j_,a as Lg,j as H_,g as zu,F as q_,d as Sr}from"./C1TpcBhl.js";const z_=Symbol(),Mg=Object.getPrototypeOf,Hh=new WeakMap,W_=t=>t&&(Hh.has(t)?Hh.get(t):Mg(t)===Object.prototype||Mg(t)===Array.prototype),V_=t=>W_(t)&&t[z_]||null,Bg=(t,e=!0)=>{Hh.set(t,e)},du={},gp=t=>typeof t=="object"&&t!==null,G_=t=>gp(t)&&!Gc.has(t)&&(Array.isArray(t)||!(Symbol.iterator in t))&&!(t instanceof WeakMap)&&!(t instanceof WeakSet)&&!(t instanceof Error)&&!(t instanceof Number)&&!(t instanceof Date)&&!(t instanceof String)&&!(t instanceof RegExp)&&!(t instanceof ArrayBuffer)&&!(t instanceof Promise),Lw=(t,e)=>{const n=qh.get(t);if((n==null?void 0:n[0])===e)return n[1];const r=Array.isArray(t)?[]:Object.create(Object.getPrototypeOf(t));return Bg(r,!0),qh.set(t,[e,r]),Reflect.ownKeys(t).forEach(s=>{if(Object.getOwnPropertyDescriptor(r,s))return;const i=Reflect.get(t,s),{enumerable:o}=Reflect.getOwnPropertyDescriptor(t,s),a={value:i,enumerable:o,configurable:!0};if(Gc.has(i))Bg(i,!1);else if(Gs.has(i)){const[c,l]=Gs.get(i);a.value=Lw(c,l())}Object.defineProperty(r,s,a)}),Object.preventExtensions(r)},K_=(t,e,n,r)=>({deleteProperty(s,i){const o=Reflect.get(s,i);n(i);const a=Reflect.deleteProperty(s,i);return a&&r(["delete",[i],o]),a},set(s,i,o,a){const c=!t()&&Reflect.has(s,i),l=Reflect.get(s,i,a);if(c&&(Fg(l,o)||Xa.has(o)&&Fg(l,Xa.get(o))))return!0;n(i),gp(o)&&(o=V_(o)||o);const u=!Gs.has(o)&&Z_(o)?Xe(o):o;return e(i,u),Reflect.set(s,i,u,a),r(["set",[i],o,l]),!0}}),Gs=new WeakMap,Gc=new WeakSet,qh=new WeakMap,xa=[1,1],Xa=new WeakMap;let Fg=Object.is,Y_=(t,e)=>new Proxy(t,e),Z_=G_,J_=Lw,X_=K_;function Xe(t={}){if(!gp(t))throw new Error("object required");const e=Xa.get(t);if(e)return e;let n=xa[0];const r=new Set,s=(m,v=++xa[0])=>{n!==v&&(n=v,r.forEach(b=>b(m,v)))};let i=xa[1];const o=(m=++xa[1])=>(i!==m&&!r.size&&(i=m,c.forEach(([v])=>{const b=v[1](m);b>n&&(n=b)})),n),a=m=>(v,b)=>{const y=[...v];y[1]=[m,...y[1]],s(y,b)},c=new Map,l=(m,v)=>{const b=!Gc.has(v)&&Gs.get(v);if(b){if((du?"production":void 0)!=="production"&&c.has(m))throw new Error("prop listener already exists");if(r.size){const y=b[2](a(m));c.set(m,[b,y])}else c.set(m,[b])}},u=m=>{var v;const b=c.get(m);b&&(c.delete(m),(v=b[1])==null||v.call(b))},d=m=>(r.add(m),r.size===1&&c.forEach(([b,y],N)=>{if((du?"production":void 0)!=="production"&&y)throw new Error("remove already exists");const _=b[2](a(N));c.set(N,[b,_])}),()=>{r.delete(m),r.size===0&&c.forEach(([b,y],N)=>{y&&(y(),c.set(N,[b]))})});let h=!0;const f=X_(()=>h,l,u,s),p=Y_(t,f);Xa.set(t,p);const g=[t,o,d];return Gs.set(p,g),Reflect.ownKeys(t).forEach(m=>{const v=Object.getOwnPropertyDescriptor(t,m);"value"in v&&v.writable&&(p[m]=t[m])}),h=!1,p}function Bt(t,e,n){const r=Gs.get(t);(du?"production":void 0)!=="production"&&!r&&console.warn("Please use proxy object");let s;const i=[],o=r[2];let a=!1;const l=o(u=>{i.push(u),s||(s=Promise.resolve().then(()=>{s=void 0,a&&e(i.splice(0))}))});return a=!0,()=>{a=!1,l()}}function Qa(t){const e=Gs.get(t);(du?"production":void 0)!=="production"&&!e&&console.warn("Please use proxy object");const[n,r]=e;return J_(n,r())}function xi(t){return Gc.add(t),t}function Q_(){return{proxyStateMap:Gs,refSet:Gc,snapCache:qh,versionHolder:xa,proxyCache:Xa}}function Ft(t,e,n,r){let s=t[e];return Bt(t,()=>{const i=t[e];Object.is(s,i)||n(s=i)})}const{proxyStateMap:eA,snapCache:tA}=Q_(),gl=t=>eA.has(t);function nA(t){const e=[];let n=0;const r=new Map,s=new WeakMap,i=()=>{const l=tA.get(a),u=l==null?void 0:l[1];if(u&&!s.has(u)){const d=new Map(r);s.set(u,d)}},o=l=>s.get(l)||r,a={data:e,index:n,epoch:0,get size(){return gl(this)||i(),o(this).size},get(l){const d=o(this).get(l);if(d===void 0){this.epoch;return}return this.data[d]},has(l){const u=o(this);return this.epoch,u.has(l)},set(l,u){if(!gl(this))throw new Error("Cannot perform mutations on a snapshot");const d=r.get(l);return d===void 0?(r.set(l,this.index),this.data[this.index++]=u):this.data[d]=u,this.epoch++,this},delete(l){if(!gl(this))throw new Error("Cannot perform mutations on a snapshot");const u=r.get(l);return u===void 0?!1:(delete this.data[u],r.delete(l),this.epoch++,!0)},clear(){if(!gl(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(l){this.epoch,o(this).forEach((d,h)=>{l(this.data[d],h,this)})},*entries(){this.epoch;const l=o(this);for(const[u,d]of l)yield[u,this.data[d]]},*keys(){this.epoch;const l=o(this);for(const u of l.keys())yield u},*values(){this.epoch;const l=o(this);for(const u of l.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},c=Xe(a);return Object.defineProperties(c,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(c),c}var jg={};const L={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin",cosmos:"Cosmos"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVER_ERROR:500,TOO_MANY_REQUESTS:429,SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network",SECURE_SITE_SDK_ORIGIN:(typeof process<"u"&&typeof jg<"u"?jg.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",REMOTE_FEATURES_ALERTS:{MULTI_WALLET_NOT_ENABLED:{DEFAULT:{shortMessage:"Multi-Wallet Not Enabled",longMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com."},CONNECTIONS_HOOK:{shortMessage:"Multi-Wallet Not Enabled",longMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnections hook."},CONNECTION_HOOK:{shortMessage:"Multi-Wallet Not Enabled",longMessage:"Multi-wallet support is not enabled. Please enable it in your AppKit configuration at cloud.reown.com to use the useAppKitConnection hook."}}}},ec={caipNetworkIdToNumber(t){return t?Number(t.split(":")[1]):void 0},parseEvmChainId(t){return typeof t=="string"?this.caipNetworkIdToNumber(t):t},getNetworksByNamespace(t,e){return(t==null?void 0:t.filter(n=>n.chainNamespace===e))||[]},getFirstNetworkByNamespace(t,e){return this.getNetworksByNamespace(t,e)[0]},getNetworkNameByCaipNetworkId(t,e){var s;if(!e)return;const n=t.find(i=>i.caipNetworkId===e);if(n)return n.name;const[r]=e.split(":");return((s=L.CHAIN_NAME_MAP)==null?void 0:s[r])||void 0}};var rA=20,sA=1,Ti=1e6,Hg=1e6,iA=-7,oA=21,aA=!1,Kc="[big.js] ",Hi=Kc+"Invalid ",Wu=Hi+"decimal places",cA=Hi+"rounding mode",Mw=Kc+"Division by zero",Ge={},Or=void 0,lA=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function Bw(){function t(e){var n=this;if(!(n instanceof t))return e===Or?Bw():new t(e);if(e instanceof t)n.s=e.s,n.e=e.e,n.c=e.c.slice();else{if(typeof e!="string"){if(t.strict===!0&&typeof e!="bigint")throw TypeError(Hi+"value");e=e===0&&1/e<0?"-0":String(e)}uA(n,e)}n.constructor=t}return t.prototype=Ge,t.DP=rA,t.RM=sA,t.NE=iA,t.PE=oA,t.strict=aA,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}function uA(t,e){var n,r,s;if(!lA.test(e))throw Error(Hi+"number");for(t.s=e.charAt(0)=="-"?(e=e.slice(1),-1):1,(n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),s=e.length,r=0;r<s&&e.charAt(r)=="0";)++r;if(r==s)t.c=[t.e=0];else{for(;s>0&&e.charAt(--s)=="0";);for(t.e=n-r-1,t.c=[],n=0;r<=s;)t.c[n++]=+e.charAt(r++)}return t}function qi(t,e,n,r){var s=t.c;if(n===Or&&(n=t.constructor.RM),n!==0&&n!==1&&n!==2&&n!==3)throw Error(cA);if(e<1)r=n===3&&(r||!!s[0])||e===0&&(n===1&&s[0]>=5||n===2&&(s[0]>5||s[0]===5&&(r||s[1]!==Or))),s.length=1,r?(t.e=t.e-e+1,s[0]=1):s[0]=t.e=0;else if(e<s.length){if(r=n===1&&s[e]>=5||n===2&&(s[e]>5||s[e]===5&&(r||s[e+1]!==Or||s[e-1]&1))||n===3&&(r||!!s[0]),s.length=e,r){for(;++s[--e]>9;)if(s[e]=0,e===0){++t.e,s.unshift(1);break}}for(e=s.length;!s[--e];)s.pop()}return t}function zi(t,e,n){var r=t.e,s=t.c.join(""),i=s.length;if(e)s=s.charAt(0)+(i>1?"."+s.slice(1):"")+(r<0?"e":"e+")+r;else if(r<0){for(;++r;)s="0"+s;s="0."+s}else if(r>0)if(++r>i)for(r-=i;r--;)s+="0";else r<i&&(s=s.slice(0,r)+"."+s.slice(r));else i>1&&(s=s.charAt(0)+"."+s.slice(1));return t.s<0&&n?"-"+s:s}Ge.abs=function(){var t=new this.constructor(this);return t.s=1,t};Ge.cmp=function(t){var e,n=this,r=n.c,s=(t=new n.constructor(t)).c,i=n.s,o=t.s,a=n.e,c=t.e;if(!r[0]||!s[0])return r[0]?i:s[0]?-o:0;if(i!=o)return i;if(e=i<0,a!=c)return a>c^e?1:-1;for(o=(a=r.length)<(c=s.length)?a:c,i=-1;++i<o;)if(r[i]!=s[i])return r[i]>s[i]^e?1:-1;return a==c?0:a>c^e?1:-1};Ge.div=function(t){var e=this,n=e.constructor,r=e.c,s=(t=new n(t)).c,i=e.s==t.s?1:-1,o=n.DP;if(o!==~~o||o<0||o>Ti)throw Error(Wu);if(!s[0])throw Error(Mw);if(!r[0])return t.s=i,t.c=[t.e=0],t;var a,c,l,u,d,h=s.slice(),f=a=s.length,p=r.length,g=r.slice(0,a),m=g.length,v=t,b=v.c=[],y=0,N=o+(v.e=e.e-t.e)+1;for(v.s=i,i=N<0?0:N,h.unshift(0);m++<a;)g.push(0);do{for(l=0;l<10;l++){if(a!=(m=g.length))u=a>m?1:-1;else for(d=-1,u=0;++d<a;)if(s[d]!=g[d]){u=s[d]>g[d]?1:-1;break}if(u<0){for(c=m==a?s:h;m;){if(g[--m]<c[m]){for(d=m;d&&!g[--d];)g[d]=9;--g[d],g[m]+=10}g[m]-=c[m]}for(;!g[0];)g.shift()}else break}b[y++]=u?l:++l,g[0]&&u?g[m]=r[f]||0:g=[r[f]]}while((f++<p||g[0]!==Or)&&i--);return!b[0]&&y!=1&&(b.shift(),v.e--,N--),y>N&&qi(v,N,n.RM,g[0]!==Or),v};Ge.eq=function(t){return this.cmp(t)===0};Ge.gt=function(t){return this.cmp(t)>0};Ge.gte=function(t){return this.cmp(t)>-1};Ge.lt=function(t){return this.cmp(t)<0};Ge.lte=function(t){return this.cmp(t)<1};Ge.minus=Ge.sub=function(t){var e,n,r,s,i=this,o=i.constructor,a=i.s,c=(t=new o(t)).s;if(a!=c)return t.s=-c,i.plus(t);var l=i.c.slice(),u=i.e,d=t.c,h=t.e;if(!l[0]||!d[0])return d[0]?t.s=-c:l[0]?t=new o(i):t.s=1,t;if(a=u-h){for((s=a<0)?(a=-a,r=l):(h=u,r=d),r.reverse(),c=a;c--;)r.push(0);r.reverse()}else for(n=((s=l.length<d.length)?l:d).length,a=c=0;c<n;c++)if(l[c]!=d[c]){s=l[c]<d[c];break}if(s&&(r=l,l=d,d=r,t.s=-t.s),(c=(n=d.length)-(e=l.length))>0)for(;c--;)l[e++]=0;for(c=e;n>a;){if(l[--n]<d[n]){for(e=n;e&&!l[--e];)l[e]=9;--l[e],l[n]+=10}l[n]-=d[n]}for(;l[--c]===0;)l.pop();for(;l[0]===0;)l.shift(),--h;return l[0]||(t.s=1,l=[h=0]),t.c=l,t.e=h,t};Ge.mod=function(t){var e,n=this,r=n.constructor,s=n.s,i=(t=new r(t)).s;if(!t.c[0])throw Error(Mw);return n.s=t.s=1,e=t.cmp(n)==1,n.s=s,t.s=i,e?new r(n):(s=r.DP,i=r.RM,r.DP=r.RM=0,n=n.div(t),r.DP=s,r.RM=i,this.minus(n.times(t)))};Ge.neg=function(){var t=new this.constructor(this);return t.s=-t.s,t};Ge.plus=Ge.add=function(t){var e,n,r,s=this,i=s.constructor;if(t=new i(t),s.s!=t.s)return t.s=-t.s,s.minus(t);var o=s.e,a=s.c,c=t.e,l=t.c;if(!a[0]||!l[0])return l[0]||(a[0]?t=new i(s):t.s=s.s),t;if(a=a.slice(),e=o-c){for(e>0?(c=o,r=l):(e=-e,r=a),r.reverse();e--;)r.push(0);r.reverse()}for(a.length-l.length<0&&(r=l,l=a,a=r),e=l.length,n=0;e;a[e]%=10)n=(a[--e]=a[e]+l[e]+n)/10|0;for(n&&(a.unshift(n),++c),e=a.length;a[--e]===0;)a.pop();return t.c=a,t.e=c,t};Ge.pow=function(t){var e=this,n=new e.constructor("1"),r=n,s=t<0;if(t!==~~t||t<-Hg||t>Hg)throw Error(Hi+"exponent");for(s&&(t=-t);t&1&&(r=r.times(e)),t>>=1,!!t;)e=e.times(e);return s?n.div(r):r};Ge.prec=function(t,e){if(t!==~~t||t<1||t>Ti)throw Error(Hi+"precision");return qi(new this.constructor(this),t,e)};Ge.round=function(t,e){if(t===Or)t=0;else if(t!==~~t||t<-Ti||t>Ti)throw Error(Wu);return qi(new this.constructor(this),t+this.e+1,e)};Ge.sqrt=function(){var t,e,n,r=this,s=r.constructor,i=r.s,o=r.e,a=new s("0.5");if(!r.c[0])return new s(r);if(i<0)throw Error(Kc+"No square root");i=Math.sqrt(+zi(r,!0,!0)),i===0||i===1/0?(e=r.c.join(""),e.length+o&1||(e+="0"),i=Math.sqrt(e),o=((o+1)/2|0)-(o<0||o&1),t=new s((i==1/0?"5e":(i=i.toExponential()).slice(0,i.indexOf("e")+1))+o)):t=new s(i+""),o=t.e+(s.DP+=4);do n=t,t=a.times(n.plus(r.div(n)));while(n.c.slice(0,o).join("")!==t.c.slice(0,o).join(""));return qi(t,(s.DP-=4)+t.e+1,s.RM)};Ge.times=Ge.mul=function(t){var e,n=this,r=n.constructor,s=n.c,i=(t=new r(t)).c,o=s.length,a=i.length,c=n.e,l=t.e;if(t.s=n.s==t.s?1:-1,!s[0]||!i[0])return t.c=[t.e=0],t;for(t.e=c+l,o<a&&(e=s,s=i,i=e,l=o,o=a,a=l),e=new Array(l=o+a);l--;)e[l]=0;for(c=a;c--;){for(a=0,l=o+c;l>c;)a=e[l]+i[c]*s[l-c-1]+a,e[l--]=a%10,a=a/10|0;e[l]=a}for(a?++t.e:e.shift(),c=e.length;!e[--c];)e.pop();return t.c=e,t};Ge.toExponential=function(t,e){var n=this,r=n.c[0];if(t!==Or){if(t!==~~t||t<0||t>Ti)throw Error(Wu);for(n=qi(new n.constructor(n),++t,e);n.c.length<t;)n.c.push(0)}return zi(n,!0,!!r)};Ge.toFixed=function(t,e){var n=this,r=n.c[0];if(t!==Or){if(t!==~~t||t<0||t>Ti)throw Error(Wu);for(n=qi(new n.constructor(n),t+n.e+1,e),t=t+n.e+1;n.c.length<t;)n.c.push(0)}return zi(n,!1,!!r)};Ge[Symbol.for("nodejs.util.inspect.custom")]=Ge.toJSON=Ge.toString=function(){var t=this,e=t.constructor;return zi(t,t.e<=e.NE||t.e>=e.PE,!!t.c[0])};Ge.toNumber=function(){var t=+zi(this,!0,!0);if(this.constructor.strict===!0&&!this.eq(t.toString()))throw Error(Kc+"Imprecise conversion");return t};Ge.toPrecision=function(t,e){var n=this,r=n.constructor,s=n.c[0];if(t!==Or){if(t!==~~t||t<1||t>Ti)throw Error(Hi+"precision");for(n=qi(new r(n),t,e);n.c.length<t;)n.c.push(0)}return zi(n,t<=n.e||n.e<=r.NE||n.e>=r.PE,!!s)};Ge.valueOf=function(){var t=this,e=t.constructor;if(e.strict===!0)throw Error(Kc+"valueOf disallowed");return zi(t,t.e<=e.NE||t.e>=e.PE,!0)};var sa=Bw();const dA={bigNumber(t){return t?new sa(t):new sa(0)},multiply(t,e){if(t===void 0||e===void 0)return new sa(0);const n=new sa(t),r=new sa(e);return n.times(r)},formatNumberToLocalString(t,e=2){return t===void 0?"0.00":typeof t=="number"?t.toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e}):parseFloat(t).toLocaleString("en-US",{maximumFractionDigits:e,minimumFractionDigits:e})},parseLocalStringToNumber(t){return t===void 0?0:parseFloat(t.replace(/,/gu,""))}},hA=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],fA=[{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],pA=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],gA={getERC20Abi:t=>L.USDT_CONTRACT_ADDRESSES.includes(t)?pA:hA,getSwapAbi:()=>fA},On={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},we={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache",PREFERRED_ACCOUNT_TYPES:"@appkit/preferred_account_types",CONNECTIONS:"@appkit/connections",DISCONNECTED_CONNECTOR_IDS:"@appkit/disconnected_connector_ids"};function Dd(t){if(!t)throw new Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${t}:connected_connector_id`}const ge={setItem(t,e){Ta()&&e!==void 0&&localStorage.setItem(t,e)},getItem(t){if(Ta())return localStorage.getItem(t)||void 0},removeItem(t){Ta()&&localStorage.removeItem(t)},clear(){Ta()&&localStorage.clear()}};function Ta(){return typeof window<"u"&&typeof localStorage<"u"}function rs(t,e){return e==="light"?{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":(t==null?void 0:t["--w3m-accent"])||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}var qg={};const $d=(typeof process<"u"&&typeof qg<"u"?qg.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",Fw=[{label:"Meld.io",name:"meld",feeRange:"1-2%",url:"https://meldcrypto.com",supportedChains:["eip155","solana"]}],mA="WXETMuFUQmqqybHuRkSgxv:25B8LJHSfpG6LVjR2ytU5Cwh7Z4Sch2ocoU",qe={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:$d,SECURE_SITE_DASHBOARD:`${$d}/dashboard`,SECURE_SITE_FAVICON:`${$d}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:[L.CHAIN.EVM,L.CHAIN.SOLANA],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:[L.CHAIN.EVM],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:[L.CHAIN.EVM,L.CHAIN.SOLANA],ACTIVITY_ENABLED_CHAIN_NAMESPACES:[L.CHAIN.EVM],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x",cosmos:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in the wallet app",WEB:"Open and continue in the wallet app"},SEND_SUPPORTED_NAMESPACES:[L.CHAIN.EVM,L.CHAIN.SOLANA],DEFAULT_REMOTE_FEATURES:{swaps:["1inch"],onramp:["meld"],email:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],activity:!0,reownBranding:!0,multiWallet:!1},DEFAULT_REMOTE_FEATURES_DISABLED:{email:!1,socials:!1,swaps:!1,onramp:!1,activity:!1,reownBranding:!1},DEFAULT_FEATURES:{receive:!0,send:!0,emailShowWallets:!0,connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0,pay:!1},DEFAULT_SOCIALS:["google","x","farcaster","discord","apple","github","facebook"],DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"},SIWX_DEFAULTS:{signOutOnDisconnect:!0}},V={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired(t,e){return Date.now()-t>e},getActiveNetworkProps(){const t=V.getActiveNamespace(),e=V.getActiveCaipNetworkId(),n=e?e.split(":")[1]:void 0,r=n?isNaN(Number(n))?n:Number(n):void 0;return{namespace:t,caipNetworkId:e,chainId:r}},setWalletConnectDeepLink({name:t,href:e}){try{ge.setItem(we.DEEPLINK_CHOICE,JSON.stringify({href:e,name:t}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{const t=ge.getItem(we.DEEPLINK_CHOICE);if(t)return JSON.parse(t)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{ge.removeItem(we.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(t){try{ge.setItem(we.ACTIVE_NAMESPACE,t)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(t){try{ge.setItem(we.ACTIVE_CAIP_NETWORK_ID,t),V.setActiveNamespace(t.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return ge.getItem(we.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{ge.removeItem(we.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(t){try{const e=Dd(t);ge.removeItem(e)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(t){try{const e=V.getRecentWallets();e.find(r=>r.id===t.id)||(e.unshift(t),e.length>2&&e.pop(),ge.setItem(we.RECENT_WALLETS,JSON.stringify(e)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{const t=ge.getItem(we.RECENT_WALLETS);return t?JSON.parse(t):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(t,e){try{const n=Dd(t);ge.setItem(n,e)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return ge.getItem(we.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(t){if(t)try{const e=Dd(t);return ge.getItem(e)}catch{console.info("Unable to get connected connector id in namespace",t)}},setConnectedSocialProvider(t){try{ge.setItem(we.CONNECTED_SOCIAL,t)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return ge.getItem(we.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{ge.removeItem(we.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return ge.getItem(we.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){var n;const t=ge.getItem(we.ACTIVE_CAIP_NETWORK_ID);return(n=t==null?void 0:t.split(":"))==null?void 0:n[1]},setConnectionStatus(t){try{ge.setItem(we.CONNECTION_STATUS,t)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return ge.getItem(we.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{const t=ge.getItem(we.CONNECTED_NAMESPACES);return t!=null&&t.length?t.split(","):[]}catch{return[]}},setConnectedNamespaces(t){try{const e=Array.from(new Set(t));ge.setItem(we.CONNECTED_NAMESPACES,e.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(t){try{const e=V.getConnectedNamespaces();e.includes(t)||(e.push(t),V.setConnectedNamespaces(e))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(t){try{const e=V.getConnectedNamespaces(),n=e.indexOf(t);n>-1&&(e.splice(n,1),V.setConnectedNamespaces(e))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return ge.getItem(we.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(t){try{ge.setItem(we.TELEGRAM_SOCIAL_PROVIDER,t)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{ge.removeItem(we.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let t={};try{const e=ge.getItem(we.PORTFOLIO_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromBalanceCache(t){try{const e=V.getBalanceCache();ge.setItem(we.PORTFOLIO_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getBalanceCacheForCaipAddress(t){try{const n=V.getBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.portfolio))return n.balance;V.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateBalanceCache(t){try{const e=V.getBalanceCache();e[t.caipAddress]=t,ge.setItem(we.PORTFOLIO_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getNativeBalanceCache(){let t={};try{const e=ge.getItem(we.NATIVE_BALANCE_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get balance cache")}return t},removeAddressFromNativeBalanceCache(t){try{const e=V.getBalanceCache();ge.setItem(we.NATIVE_BALANCE_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove address from balance cache",t)}},getNativeBalanceCacheForCaipAddress(t){try{const n=V.getNativeBalanceCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.nativeBalance))return n;console.info("Discarding cache for address",t),V.removeAddressFromBalanceCache(t)}catch{console.info("Unable to get balance cache for address",t)}},updateNativeBalanceCache(t){try{const e=V.getNativeBalanceCache();e[t.caipAddress]=t,ge.setItem(we.NATIVE_BALANCE_CACHE,JSON.stringify(e))}catch{console.info("Unable to update balance cache",t)}},getEnsCache(){let t={};try{const e=ge.getItem(we.ENS_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get ens name cache")}return t},getEnsFromCacheForAddress(t){try{const n=V.getEnsCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.ens))return n.ens;V.removeEnsFromCache(t)}catch{console.info("Unable to get ens name from cache",t)}},updateEnsCache(t){try{const e=V.getEnsCache();e[t.address]=t,ge.setItem(we.ENS_CACHE,JSON.stringify(e))}catch{console.info("Unable to update ens name cache",t)}},removeEnsFromCache(t){try{const e=V.getEnsCache();ge.setItem(we.ENS_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove ens name from cache",t)}},getIdentityCache(){let t={};try{const e=ge.getItem(we.IDENTITY_CACHE);t=e?JSON.parse(e):{}}catch{console.info("Unable to get identity cache")}return t},getIdentityFromCacheForAddress(t){try{const n=V.getIdentityCache()[t];if(n&&!this.isCacheExpired(n.timestamp,this.cacheExpiry.identity))return n.identity;V.removeIdentityFromCache(t)}catch{console.info("Unable to get identity from cache",t)}},updateIdentityCache(t){try{const e=V.getIdentityCache();e[t.address]={identity:t.identity,timestamp:t.timestamp},ge.setItem(we.IDENTITY_CACHE,JSON.stringify(e))}catch{console.info("Unable to update identity cache",t)}},removeIdentityFromCache(t){try{const e=V.getIdentityCache();ge.setItem(we.IDENTITY_CACHE,JSON.stringify({...e,[t]:void 0}))}catch{console.info("Unable to remove identity from cache",t)}},clearAddressCache(){try{ge.removeItem(we.PORTFOLIO_CACHE),ge.removeItem(we.NATIVE_BALANCE_CACHE),ge.removeItem(we.ENS_CACHE),ge.removeItem(we.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}},setPreferredAccountTypes(t){try{ge.setItem(we.PREFERRED_ACCOUNT_TYPES,JSON.stringify(t))}catch{console.info("Unable to set preferred account types",t)}},getPreferredAccountTypes(){try{const t=ge.getItem(we.PREFERRED_ACCOUNT_TYPES);return t?JSON.parse(t):{}}catch{console.info("Unable to get preferred account types")}return{}},setConnections(t,e){try{const n=V.getConnections(),r=n[e]??[],s=new Map;for(const o of r)s.set(o.connectorId,{...o});for(const o of t){const a=s.get(o.connectorId),c=o.connectorId===L.CONNECTOR_ID.AUTH;if(a&&!c){const l=new Set(a.accounts.map(d=>d.address.toLowerCase())),u=o.accounts.filter(d=>!l.has(d.address.toLowerCase()));a.accounts.push(...u)}else s.set(o.connectorId,{...o})}const i={...n,[e]:Array.from(s.values())};ge.setItem(we.CONNECTIONS,JSON.stringify(i))}catch(n){console.error("Unable to sync connections to storage",n)}},getConnections(){try{const t=ge.getItem(we.CONNECTIONS);return t?JSON.parse(t):{}}catch(t){return console.error("Unable to get connections from storage",t),{}}},deleteAddressFromConnection({connectorId:t,address:e,namespace:n}){try{const r=V.getConnections(),s=r[n]??[],i=new Map(s.map(a=>[a.connectorId,a])),o=i.get(t);o&&(o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase()).length===0?i.delete(t):i.set(t,{...o,accounts:o.accounts.filter(c=>c.address.toLowerCase()!==e.toLowerCase())})),ge.setItem(we.CONNECTIONS,JSON.stringify({...r,[n]:Array.from(i.values())}))}catch{console.error(`Unable to remove address "${e}" from connector "${t}" in namespace "${n}"`)}},getDisconnectedConnectorIds(){try{const t=ge.getItem(we.DISCONNECTED_CONNECTOR_IDS);return t?JSON.parse(t):{}}catch{console.info("Unable to get disconnected connector ids")}return{}},addDisconnectedConnectorId(t,e){try{const n=V.getDisconnectedConnectorIds(),r=n[e]??[];r.push(t),ge.setItem(we.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to set disconnected connector id "${t}" for namespace "${e}"`)}},removeDisconnectedConnectorId(t,e){try{const n=V.getDisconnectedConnectorIds();let r=n[e]??[];r=r.filter(s=>s.toLowerCase()!==t.toLowerCase()),ge.setItem(we.DISCONNECTED_CONNECTOR_IDS,JSON.stringify({...n,[e]:Array.from(new Set(r))}))}catch{console.error(`Unable to remove disconnected connector id "${t}" for namespace "${e}"`)}},isConnectorDisconnected(t,e){try{return(V.getDisconnectedConnectorIds()[e]??[]).some(s=>s.toLowerCase()===t.toLowerCase())}catch{console.info(`Unable to get disconnected connector id "${t}" for namespace "${e}"`)}return!1}},oe={isMobile(){var t;return this.isClient()?!!(window!=null&&window.matchMedia&&typeof window.matchMedia=="function"&&((t=window.matchMedia("(pointer:coarse)"))!=null&&t.matches)||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent)):!1},checkCaipNetwork(t,e=""){return t==null?void 0:t.caipNetworkId.toLocaleLowerCase().includes(e.toLowerCase())},isAndroid(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return oe.isMobile()&&t.includes("android")},isIos(){if(!this.isMobile())return!1;const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("iphone")||t.includes("ipad")},isSafari(){return this.isClient()?(window==null?void 0:window.navigator.userAgent.toLowerCase()).includes("safari"):!1},isClient(){return typeof window<"u"},isPairingExpired(t){return t?t-Date.now()<=qe.TEN_SEC_MS:!0},isAllowedRetry(t,e=qe.ONE_SEC_MS){return Date.now()-t>=e},copyToClopboard(t){navigator.clipboard.writeText(t)},isIframe(){try{return(window==null?void 0:window.self)!==(window==null?void 0:window.top)}catch{return!1}},isSafeApp(){var t,e;if(oe.isClient()&&window.self!==window.top)try{const n=(e=(t=window==null?void 0:window.location)==null?void 0:t.ancestorOrigins)==null?void 0:e[0],r="https://app.safe.global";if(n){const s=new URL(n),i=new URL(r);return s.hostname===i.hostname}}catch{return!1}return!1},getPairingExpiry(){return Date.now()+qe.FOUR_MINUTES_MS},getNetworkId(t){return t==null?void 0:t.split(":")[1]},getPlainAddress(t){return t==null?void 0:t.split(":")[2]},async wait(t){return new Promise(e=>{setTimeout(e,t)})},debounce(t,e=500){let n;return(...r)=>{function s(){t(...r)}n&&clearTimeout(n),n=setTimeout(s,e)}},isHttpUrl(t){return t.startsWith("http://")||t.startsWith("https://")},formatNativeUrl(t,e,n=null){if(oe.isHttpUrl(t))return this.formatUniversalUrl(t,e);let r=t,s=n;r.includes("://")||(r=t.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),s&&!(s!=null&&s.endsWith("/"))&&(s=`${s}/`),this.isTelegram()&&this.isAndroid()&&(e=encodeURIComponent(e));const i=encodeURIComponent(e);return{redirect:`${r}wc?uri=${i}`,redirectUniversalLink:s?`${s}wc?uri=${i}`:void 0,href:r}},formatUniversalUrl(t,e){if(!oe.isHttpUrl(t))return this.formatNativeUrl(t,e);let n=t;n.endsWith("/")||(n=`${n}/`);const r=encodeURIComponent(e);return{redirect:`${n}wc?uri=${r}`,href:n}},getOpenTargetForPlatform(t){return t==="popupWindow"?t:this.isTelegram()?V.getTelegramSocialProvider()?"_top":"_blank":t},openHref(t,e,n){window==null||window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},returnOpenHref(t,e,n){return window==null?void 0:window.open(t,this.getOpenTargetForPlatform(e),n||"noreferrer noopener")},isTelegram(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)},isPWA(){var n,r;if(typeof window>"u")return!1;const t=window!=null&&window.matchMedia&&typeof window.matchMedia=="function"?(n=window.matchMedia("(display-mode: standalone)"))==null?void 0:n.matches:!1,e=(r=window==null?void 0:window.navigator)==null?void 0:r.standalone;return!!(t||e)},async preloadImage(t){const e=new Promise((n,r)=>{const s=new Image;s.onload=n,s.onerror=r,s.crossOrigin="anonymous",s.src=t});return Promise.race([e,oe.wait(2e3)])},formatBalance(t,e){let n="0.000";if(typeof t=="string"){const r=Number(t);if(r){const s=Math.floor(r*1e3)/1e3;s&&(n=s.toString())}}return`${n}${e?` ${e}`:""}`},formatBalance2(t,e){var r;let n;if(t==="0")n="0";else if(typeof t=="string"){const s=Number(t);s&&(n=(r=s.toString().match(/^-?\d+(?:\.\d{0,3})?/u))==null?void 0:r[0])}return{value:n??"0",rest:n==="0"?"000":"",symbol:e}},getApiUrl(){return L.W3M_API_URL},getBlockchainApiUrl(){return L.BLOCKCHAIN_API_RPC_URL},getAnalyticsUrl(){return L.PULSE_API_URL},getUUID(){return crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})},parseError(t){var e,n;return typeof t=="string"?t:typeof((n=(e=t==null?void 0:t.issues)==null?void 0:e[0])==null?void 0:n.message)=="string"?t.issues[0].message:t instanceof Error?t.message:"Unknown error"},sortRequestedNetworks(t,e=[]){const n={};return e&&t&&(t.forEach((r,s)=>{n[r]=s}),e.sort((r,s)=>{const i=n[r.id],o=n[s.id];return i!==void 0&&o!==void 0?i-o:i!==void 0?-1:o!==void 0?1:0})),e},calculateBalance(t){let e=0;for(const n of t)e+=n.value??0;return e},formatTokenBalance(t){const e=t.toFixed(2),[n,r]=e.split(".");return{dollars:n,pennies:r}},isAddress(t,e="eip155"){switch(e){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)){if(/^(?:0x)?[0-9a-f]{40}$/iu.test(t)||/^(?:0x)?[0-9A-F]{40}$/iu.test(t))return!0}else return!1;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(t);default:return!1}},uniqueBy(t,e){const n=new Set;return t.filter(r=>{const s=r[e];return n.has(s)?!1:(n.add(s),!0)})},generateSdkVersion(t,e,n){const s=t.length===0?qe.ADAPTER_TYPES.UNIVERSAL:t.map(i=>i.adapterType).join(",");return`${e}-${s}-${n}`},createAccount(t,e,n,r,s){return{namespace:t,address:e,type:n,publicKey:r,path:s}},isCaipAddress(t){if(typeof t!="string")return!1;const e=t.split(":"),n=e[0];return e.filter(Boolean).length===3&&n in L.CHAIN_NAME_MAP},getAccount(t){return t?typeof t=="string"?{address:t,chainId:void 0}:{address:t.address,chainId:t.chainId}:{address:void 0,chainId:void 0}},isMac(){const t=window==null?void 0:window.navigator.userAgent.toLowerCase();return t.includes("macintosh")&&!t.includes("safari")},formatTelegramSocialLoginUrl(t){const e=`--${encodeURIComponent(window==null?void 0:window.location.href)}`,n="state=";if(new URL(t).host==="auth.magic.link"){const s="provider_authorization_url=",i=t.substring(t.indexOf(s)+s.length),o=this.injectIntoUrl(decodeURIComponent(i),n,e);return t.replace(i,encodeURIComponent(o))}return this.injectIntoUrl(t,n,e)},injectIntoUrl(t,e,n){const r=t.indexOf(e);if(r===-1)throw new Error(`${e} parameter not found in the URL: ${t}`);const s=t.indexOf("&",r),i=e.length,o=s!==-1?s:t.length,a=t.substring(0,r+i),c=t.substring(r+i,o),l=t.substring(s),u=c+n;return a+u+l}};async function ia(...t){const e=await fetch(...t);if(!e.ok)throw new Error(`HTTP status code: ${e.status}`,{cause:e});return e}class Yc{constructor({baseUrl:e,clientId:n}){this.baseUrl=e,this.clientId=n}async get({headers:e,signal:n,cache:r,...s}){const i=this.createUrl(s);return(await ia(i,{method:"GET",headers:e,signal:n,cache:r})).json()}async getBlob({headers:e,signal:n,...r}){const s=this.createUrl(r);return(await ia(s,{method:"GET",headers:e,signal:n})).blob()}async post({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await ia(i,{method:"POST",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await ia(i,{method:"PUT",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:n,signal:r,...s}){const i=this.createUrl(s);return(await ia(i,{method:"DELETE",headers:n,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:n}){const r=new URL(e,this.baseUrl);return n&&Object.entries(n).forEach(([s,i])=>{i&&r.searchParams.append(s,i)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}const yA={getFeatureValue(t,e){const n=e==null?void 0:e[t];return n===void 0?qe.DEFAULT_FEATURES[t]:n},filterSocialsByPlatform(t){if(!t||!t.length)return t;if(oe.isTelegram()){if(oe.isIos())return t.filter(e=>e!=="google");if(oe.isMac())return t.filter(e=>e!=="x");if(oe.isAndroid())return t.filter(e=>!["facebook","x"].includes(e))}return t}},le=Xe({features:qe.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:qe.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0,experimental_preferUniversalLinks:!1,remoteFeatures:{}}),j={state:le,subscribeKey(t,e){return Ft(le,t,e)},setOptions(t){Object.assign(le,t)},setRemoteFeatures(t){var n,r;if(!t)return;const e={...le.remoteFeatures,...t};le.remoteFeatures=e,(n=le.remoteFeatures)!=null&&n.socials&&(le.remoteFeatures.socials=yA.filterSocialsByPlatform(le.remoteFeatures.socials)),(r=le.features)!=null&&r.pay&&(le.remoteFeatures.email=!1,le.remoteFeatures.socials=!1)},setFeatures(t){var n;if(!t)return;le.features||(le.features=qe.DEFAULT_FEATURES);const e={...le.features,...t};le.features=e,(n=le.features)!=null&&n.pay&&le.remoteFeatures&&(le.remoteFeatures.email=!1,le.remoteFeatures.socials=!1)},setProjectId(t){le.projectId=t},setCustomRpcUrls(t){le.customRpcUrls=t},setAllWallets(t){le.allWallets=t},setIncludeWalletIds(t){le.includeWalletIds=t},setExcludeWalletIds(t){le.excludeWalletIds=t},setFeaturedWalletIds(t){le.featuredWalletIds=t},setTokens(t){le.tokens=t},setTermsConditionsUrl(t){le.termsConditionsUrl=t},setPrivacyPolicyUrl(t){le.privacyPolicyUrl=t},setCustomWallets(t){le.customWallets=t},setIsSiweEnabled(t){le.isSiweEnabled=t},setIsUniversalProvider(t){le.isUniversalProvider=t},setSdkVersion(t){le.sdkVersion=t},setMetadata(t){le.metadata=t},setDisableAppend(t){le.disableAppend=t},setEIP6963Enabled(t){le.enableEIP6963=t},setDebug(t){le.debug=t},setEnableWalletConnect(t){le.enableWalletConnect=t},setEnableWalletGuide(t){le.enableWalletGuide=t},setEnableAuthLogger(t){le.enableAuthLogger=t},setEnableWallets(t){le.enableWallets=t},setPreferUniversalLinks(t){le.experimental_preferUniversalLinks=t},setSIWX(t){if(t)for(const[e,n]of Object.entries(qe.SIWX_DEFAULTS))t[e]??(t[e]=n);le.siwx=t},setConnectMethodsOrder(t){le.features={...le.features,connectMethodsOrder:t}},setWalletFeaturesOrder(t){le.features={...le.features,walletFeaturesOrder:t}},setSocialsOrder(t){le.remoteFeatures={...le.remoteFeatures,socials:t}},setCollapseWallets(t){le.features={...le.features,collapseWallets:t}},setEnableEmbedded(t){le.enableEmbedded=t},setAllowUnsupportedChain(t){le.allowUnsupportedChain=t},setManualWCControl(t){le.manualWCControl=t},setEnableNetworkSwitch(t){le.enableNetworkSwitch=t},setEnableReconnect(t){le.enableReconnect=t},setDefaultAccountTypes(t={}){Object.entries(t).forEach(([e,n])=>{n&&(le.defaultAccountTypes[e]=n)})},setUniversalProviderConfigOverride(t){le.universalProviderConfigOverride=t},getUniversalProviderConfigOverride(){return le.universalProviderConfigOverride},getSnapshot(){return Qa(le)}},wA=Object.freeze({enabled:!0,events:[]}),bA=new Yc({baseUrl:oe.getAnalyticsUrl(),clientId:null}),vA=5,EA=60*1e3,fs=Xe({...wA}),CA={state:fs,subscribeKey(t,e){return Ft(fs,t,e)},async sendError(t,e){if(!fs.enabled)return;const n=Date.now();if(fs.events.filter(i=>{const o=new Date(i.properties.timestamp||"").getTime();return n-o<EA}).length>=vA)return;const s={type:"error",event:e,properties:{errorType:t.name,errorMessage:t.message,stackTrace:t.stack,timestamp:new Date().toISOString()}};fs.events.push(s);try{if(typeof window>"u")return;const{projectId:i,sdkType:o,sdkVersion:a}=j.state;await bA.post({path:"/e",params:{projectId:i,st:o,sv:a||"html-wagmi-4.2.2"},body:{eventId:oe.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:new Date().toISOString(),props:{type:"error",event:e,errorType:t.name,errorMessage:t.message,stackTrace:t.stack}}})}catch{}},enable(){fs.enabled=!0},disable(){fs.enabled=!1},clearEvents(){fs.events=[]}};class Ro extends Error{constructor(e,n,r){super(e),this.name="AppKitError",this.category=n,this.originalError=r,Object.setPrototypeOf(this,Ro.prototype);let s=!1;if(r instanceof Error&&typeof r.stack=="string"&&r.stack){const i=r.stack,o=i.indexOf(`
`);if(o>-1){const a=i.substring(o+1);this.stack=`${this.name}: ${this.message}
${a}`,s=!0}}s||(Error.captureStackTrace?Error.captureStackTrace(this,Ro):this.stack||(this.stack=`${this.name}: ${this.message}`))}}function zg(t,e){const n=t instanceof Ro?t:new Ro(t instanceof Error?t.message:String(t),e,t);throw CA.sendError(n,n.category),n}function Un(t,e="INTERNAL_SDK_ERROR"){const n={};return Object.keys(t).forEach(r=>{const s=t[r];if(typeof s=="function"){let i=s;s.constructor.name==="AsyncFunction"?i=async(...o)=>{try{return await s(...o)}catch(a){return zg(a,e)}}:i=(...o)=>{try{return s(...o)}catch(a){return zg(a,e)}},n[r]=i}else n[r]=s}),n}var Do={};const _A="https://secure.walletconnect.org/sdk",AA=(typeof process<"u"&&typeof Do<"u"?Do.NEXT_PUBLIC_SECURE_SITE_SDK_URL:void 0)||_A,IA=(typeof process<"u"&&typeof Do<"u"?Do.NEXT_PUBLIC_DEFAULT_LOG_LEVEL:void 0)||"error",SA=(typeof process<"u"&&typeof Do<"u"?Do.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION:void 0)||"4",ae={APP_EVENT_KEY:"@w3m-app/",FRAME_EVENT_KEY:"@w3m-frame/",RPC_METHOD_KEY:"RPC_",STORAGE_KEY:"@appkit-wallet/",SESSION_TOKEN_KEY:"SESSION_TOKEN_KEY",EMAIL_LOGIN_USED_KEY:"EMAIL_LOGIN_USED_KEY",LAST_USED_CHAIN_KEY:"LAST_USED_CHAIN_KEY",LAST_EMAIL_LOGIN_TIME:"LAST_EMAIL_LOGIN_TIME",EMAIL:"EMAIL",PREFERRED_ACCOUNT_TYPE:"PREFERRED_ACCOUNT_TYPE",SMART_ACCOUNT_ENABLED:"SMART_ACCOUNT_ENABLED",SMART_ACCOUNT_ENABLED_NETWORKS:"SMART_ACCOUNT_ENABLED_NETWORKS",SOCIAL_USERNAME:"SOCIAL_USERNAME",APP_SWITCH_NETWORK:"@w3m-app/SWITCH_NETWORK",APP_CONNECT_EMAIL:"@w3m-app/CONNECT_EMAIL",APP_CONNECT_DEVICE:"@w3m-app/CONNECT_DEVICE",APP_CONNECT_OTP:"@w3m-app/CONNECT_OTP",APP_CONNECT_SOCIAL:"@w3m-app/CONNECT_SOCIAL",APP_GET_SOCIAL_REDIRECT_URI:"@w3m-app/GET_SOCIAL_REDIRECT_URI",APP_GET_USER:"@w3m-app/GET_USER",APP_SIGN_OUT:"@w3m-app/SIGN_OUT",APP_IS_CONNECTED:"@w3m-app/IS_CONNECTED",APP_GET_CHAIN_ID:"@w3m-app/GET_CHAIN_ID",APP_RPC_REQUEST:"@w3m-app/RPC_REQUEST",APP_UPDATE_EMAIL:"@w3m-app/UPDATE_EMAIL",APP_UPDATE_EMAIL_PRIMARY_OTP:"@w3m-app/UPDATE_EMAIL_PRIMARY_OTP",APP_UPDATE_EMAIL_SECONDARY_OTP:"@w3m-app/UPDATE_EMAIL_SECONDARY_OTP",APP_AWAIT_UPDATE_EMAIL:"@w3m-app/AWAIT_UPDATE_EMAIL",APP_SYNC_THEME:"@w3m-app/SYNC_THEME",APP_SYNC_DAPP_DATA:"@w3m-app/SYNC_DAPP_DATA",APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS:"@w3m-app/GET_SMART_ACCOUNT_ENABLED_NETWORKS",APP_INIT_SMART_ACCOUNT:"@w3m-app/INIT_SMART_ACCOUNT",APP_SET_PREFERRED_ACCOUNT:"@w3m-app/SET_PREFERRED_ACCOUNT",APP_CONNECT_FARCASTER:"@w3m-app/CONNECT_FARCASTER",APP_GET_FARCASTER_URI:"@w3m-app/GET_FARCASTER_URI",APP_RELOAD:"@w3m-app/RELOAD",APP_RPC_ABORT:"@w3m-app/RPC_ABORT",FRAME_SWITCH_NETWORK_ERROR:"@w3m-frame/SWITCH_NETWORK_ERROR",FRAME_SWITCH_NETWORK_SUCCESS:"@w3m-frame/SWITCH_NETWORK_SUCCESS",FRAME_CONNECT_EMAIL_ERROR:"@w3m-frame/CONNECT_EMAIL_ERROR",FRAME_CONNECT_EMAIL_SUCCESS:"@w3m-frame/CONNECT_EMAIL_SUCCESS",FRAME_CONNECT_DEVICE_ERROR:"@w3m-frame/CONNECT_DEVICE_ERROR",FRAME_CONNECT_DEVICE_SUCCESS:"@w3m-frame/CONNECT_DEVICE_SUCCESS",FRAME_CONNECT_OTP_SUCCESS:"@w3m-frame/CONNECT_OTP_SUCCESS",FRAME_CONNECT_OTP_ERROR:"@w3m-frame/CONNECT_OTP_ERROR",FRAME_CONNECT_SOCIAL_SUCCESS:"@w3m-frame/CONNECT_SOCIAL_SUCCESS",FRAME_CONNECT_SOCIAL_ERROR:"@w3m-frame/CONNECT_SOCIAL_ERROR",FRAME_CONNECT_FARCASTER_SUCCESS:"@w3m-frame/CONNECT_FARCASTER_SUCCESS",FRAME_CONNECT_FARCASTER_ERROR:"@w3m-frame/CONNECT_FARCASTER_ERROR",FRAME_GET_FARCASTER_URI_SUCCESS:"@w3m-frame/GET_FARCASTER_URI_SUCCESS",FRAME_GET_FARCASTER_URI_ERROR:"@w3m-frame/GET_FARCASTER_URI_ERROR",FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_SUCCESS",FRAME_GET_SOCIAL_REDIRECT_URI_ERROR:"@w3m-frame/GET_SOCIAL_REDIRECT_URI_ERROR",FRAME_GET_USER_SUCCESS:"@w3m-frame/GET_USER_SUCCESS",FRAME_GET_USER_ERROR:"@w3m-frame/GET_USER_ERROR",FRAME_SIGN_OUT_SUCCESS:"@w3m-frame/SIGN_OUT_SUCCESS",FRAME_SIGN_OUT_ERROR:"@w3m-frame/SIGN_OUT_ERROR",FRAME_IS_CONNECTED_SUCCESS:"@w3m-frame/IS_CONNECTED_SUCCESS",FRAME_IS_CONNECTED_ERROR:"@w3m-frame/IS_CONNECTED_ERROR",FRAME_GET_CHAIN_ID_SUCCESS:"@w3m-frame/GET_CHAIN_ID_SUCCESS",FRAME_GET_CHAIN_ID_ERROR:"@w3m-frame/GET_CHAIN_ID_ERROR",FRAME_RPC_REQUEST_SUCCESS:"@w3m-frame/RPC_REQUEST_SUCCESS",FRAME_RPC_REQUEST_ERROR:"@w3m-frame/RPC_REQUEST_ERROR",FRAME_SESSION_UPDATE:"@w3m-frame/SESSION_UPDATE",FRAME_UPDATE_EMAIL_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SUCCESS",FRAME_UPDATE_EMAIL_ERROR:"@w3m-frame/UPDATE_EMAIL_ERROR",FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_PRIMARY_OTP_ERROR",FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_SUCCESS",FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR:"@w3m-frame/UPDATE_EMAIL_SECONDARY_OTP_ERROR",FRAME_SYNC_THEME_SUCCESS:"@w3m-frame/SYNC_THEME_SUCCESS",FRAME_SYNC_THEME_ERROR:"@w3m-frame/SYNC_THEME_ERROR",FRAME_SYNC_DAPP_DATA_SUCCESS:"@w3m-frame/SYNC_DAPP_DATA_SUCCESS",FRAME_SYNC_DAPP_DATA_ERROR:"@w3m-frame/SYNC_DAPP_DATA_ERROR",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS",FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR:"@w3m-frame/GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR",FRAME_INIT_SMART_ACCOUNT_SUCCESS:"@w3m-frame/INIT_SMART_ACCOUNT_SUCCESS",FRAME_INIT_SMART_ACCOUNT_ERROR:"@w3m-frame/INIT_SMART_ACCOUNT_ERROR",FRAME_SET_PREFERRED_ACCOUNT_SUCCESS:"@w3m-frame/SET_PREFERRED_ACCOUNT_SUCCESS",FRAME_SET_PREFERRED_ACCOUNT_ERROR:"@w3m-frame/SET_PREFERRED_ACCOUNT_ERROR",FRAME_READY:"@w3m-frame/READY",FRAME_RELOAD_SUCCESS:"@w3m-frame/RELOAD_SUCCESS",FRAME_RELOAD_ERROR:"@w3m-frame/RELOAD_ERROR",FRAME_RPC_ABORT_SUCCESS:"@w3m-frame/RPC_ABORT_SUCCESS",FRAME_RPC_ABORT_ERROR:"@w3m-frame/RPC_ABORT_ERROR",RPC_RESPONSE_TYPE_ERROR:"RPC_RESPONSE_ERROR",RPC_RESPONSE_TYPE_TX:"RPC_RESPONSE_TRANSACTION_HASH",RPC_RESPONSE_TYPE_OBJECT:"RPC_RESPONSE_OBJECT"},At={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}},Nr={PHANTOM:{id:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",url:"https://phantom.app"},SOLFLARE:{id:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",url:"https://solflare.com"},COINBASE:{id:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",url:"https://go.cb-w.com"}},NA={handleMobileDeeplinkRedirect(t,e){const n=window.location.href,r=encodeURIComponent(n);if(t===Nr.PHANTOM.id&&!("phantom"in window)){const s=n.startsWith("https")?"https":"http",i=n.split("/")[2],o=encodeURIComponent(`${s}://${i}`);window.location.href=`${Nr.PHANTOM.url}/ul/browse/${r}?ref=${o}`}t===Nr.SOLFLARE.id&&!("solflare"in window)&&(window.location.href=`${Nr.SOLFLARE.url}/ul/v1/browse/${r}?ref=${r}`),e===L.CHAIN.SOLANA&&t===Nr.COINBASE.id&&!("coinbaseSolana"in window)&&(window.location.href=`${Nr.COINBASE.url}/dapp?cb_url=${r}`)}},Sn=Xe({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),xA={state:Sn,subscribeNetworkImages(t){return Bt(Sn.networkImages,()=>t(Sn.networkImages))},subscribeKey(t,e){return Ft(Sn,t,e)},subscribe(t){return Bt(Sn,()=>t(Sn))},setWalletImage(t,e){Sn.walletImages[t]=e},setNetworkImage(t,e){Sn.networkImages[t]=e},setChainImage(t,e){Sn.chainImages[t]=e},setConnectorImage(t,e){Sn.connectorImages={...Sn.connectorImages,[t]:e}},setTokenImage(t,e){Sn.tokenImages[t]=e},setCurrencyImage(t,e){Sn.currencyImages[t]=e}},ar=Un(xA),TA={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00",cosmos:""},kd=Xe({networkImagePromises:{}}),jw={async fetchWalletImage(t){if(t)return await de._fetchWalletImage(t),this.getWalletImageById(t)},async fetchNetworkImage(t){if(!t)return;const e=this.getNetworkImageById(t);return e||(kd.networkImagePromises[t]||(kd.networkImagePromises[t]=de._fetchNetworkImage(t)),await kd.networkImagePromises[t],this.getNetworkImageById(t))},getWalletImageById(t){if(t)return ar.state.walletImages[t]},getWalletImage(t){if(t!=null&&t.image_url)return t==null?void 0:t.image_url;if(t!=null&&t.image_id)return ar.state.walletImages[t.image_id]},getNetworkImage(t){var e,n,r;if((e=t==null?void 0:t.assets)!=null&&e.imageUrl)return(n=t==null?void 0:t.assets)==null?void 0:n.imageUrl;if((r=t==null?void 0:t.assets)!=null&&r.imageId)return ar.state.networkImages[t.assets.imageId]},getNetworkImageById(t){if(t)return ar.state.networkImages[t]},getConnectorImage(t){var e;if(t!=null&&t.imageUrl)return t.imageUrl;if((e=t==null?void 0:t.info)!=null&&e.icon)return t.info.icon;if(t!=null&&t.imageId)return ar.state.connectorImages[t.imageId]},getChainImage(t){return ar.state.networkImages[TA[t]]}},ps=Xe({message:"",variant:"info",open:!1}),PA={state:ps,subscribeKey(t,e){return Ft(ps,t,e)},open(t,e){const{debug:n}=j.state,{shortMessage:r,longMessage:s}=t;n&&(ps.message=r,ps.variant=e,ps.open=!0),s&&console.error(typeof s=="function"?s():s)},close(){ps.open=!1,ps.message="",ps.variant="info"}},st=Un(PA),OA=oe.getAnalyticsUrl(),RA=new Yc({baseUrl:OA,clientId:null}),DA=["MODAL_CREATED"],qr=Xe({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),Ve={state:qr,subscribe(t){return Bt(qr,()=>t(qr))},getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=j.state;return{projectId:t,st:e,sv:n||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(t){try{const e=ce.state.address;if(DA.includes(t.data.event)||typeof window>"u")return;await RA.post({path:"/e",params:Ve.getSdkProperties(),body:{eventId:oe.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:t.timestamp,props:{...t.data,address:e}}}),qr.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===L.HTTP_STATUS_CODES.FORBIDDEN&&!qr.reportedErrors.FORBIDDEN&&(st.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${Ta()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),qr.reportedErrors.FORBIDDEN=!0)}},sendEvent(t){var e;qr.timestamp=Date.now(),qr.data=t,((e=j.state.features)!=null&&e.analytics||t.event==="INITIALIZE")&&Ve._sendAnalyticsEvent(qr)}},$A=oe.getApiUrl(),cn=new Yc({baseUrl:$A,clientId:null}),kA=40,Wg=4,UA=20,Ee=Xe({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],filteredWallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),de={state:Ee,subscribeKey(t,e){return Ft(Ee,t,e)},_getSdkProperties(){const{projectId:t,sdkType:e,sdkVersion:n}=j.state;return{projectId:t,st:e||"appkit",sv:n||"html-wagmi-4.2.2"}},_filterOutExtensions(t){return j.state.isUniversalProvider?t.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):t},async _fetchWalletImage(t){const e=`${cn.baseUrl}/getWalletImage/${t}`,n=await cn.getBlob({path:e,params:de._getSdkProperties()});ar.setWalletImage(t,URL.createObjectURL(n))},async _fetchNetworkImage(t){const e=`${cn.baseUrl}/public/getAssetImage/${t}`,n=await cn.getBlob({path:e,params:de._getSdkProperties()});ar.setNetworkImage(t,URL.createObjectURL(n))},async _fetchConnectorImage(t){const e=`${cn.baseUrl}/public/getAssetImage/${t}`,n=await cn.getBlob({path:e,params:de._getSdkProperties()});ar.setConnectorImage(t,URL.createObjectURL(n))},async _fetchCurrencyImage(t){const e=`${cn.baseUrl}/public/getCurrencyImage/${t}`,n=await cn.getBlob({path:e,params:de._getSdkProperties()});ar.setCurrencyImage(t,URL.createObjectURL(n))},async _fetchTokenImage(t){const e=`${cn.baseUrl}/public/getTokenImage/${t}`,n=await cn.getBlob({path:e,params:de._getSdkProperties()});ar.setTokenImage(t,URL.createObjectURL(n))},_filterWalletsByPlatform(t){return oe.isMobile()?t==null?void 0:t.filter(n=>n.mobile_link||n.id===Nr.COINBASE.id?!0:A.state.activeChain==="solana"&&(n.id===Nr.SOLFLARE.id||n.id===Nr.PHANTOM.id)):t},async fetchProjectConfig(){return(await cn.get({path:"/appkit/v1/config",params:de._getSdkProperties()})).features},async fetchAllowedOrigins(){try{const{allowedOrigins:t}=await cn.get({path:"/projects/v1/origins",params:de._getSdkProperties()});return t}catch(t){if(t instanceof Error&&t.cause instanceof Response){const e=t.cause.status;if(e===L.HTTP_STATUS_CODES.TOO_MANY_REQUESTS)throw new Error("RATE_LIMITED",{cause:t});if(e>=L.HTTP_STATUS_CODES.SERVER_ERROR&&e<600)throw new Error("SERVER_ERROR",{cause:t});return[]}return[]}},async fetchNetworkImages(){const t=A.getAllRequestedCaipNetworks(),e=t==null?void 0:t.map(({assets:n})=>n==null?void 0:n.imageId).filter(Boolean).filter(n=>!jw.getNetworkImageById(n));e&&await Promise.allSettled(e.map(n=>de._fetchNetworkImage(n)))},async fetchConnectorImages(){const{connectors:t}=J.state,e=t.map(({imageId:n})=>n).filter(Boolean);await Promise.allSettled(e.map(n=>de._fetchConnectorImage(n)))},async fetchCurrencyImages(t=[]){await Promise.allSettled(t.map(e=>de._fetchCurrencyImage(e)))},async fetchTokenImages(t=[]){await Promise.allSettled(t.map(e=>de._fetchTokenImage(e)))},async fetchWallets(t){var i;const e=t.exclude??[];de._getSdkProperties().sv.startsWith("html-core-")&&e.push(...Object.values(Nr).map(o=>o.id));const r=await cn.get({path:"/getWallets",params:{...de._getSdkProperties(),...t,page:String(t.page),entries:String(t.entries),include:(i=t.include)==null?void 0:i.join(","),exclude:e.join(",")}});return{data:de._filterWalletsByPlatform(r==null?void 0:r.data)||[],count:r==null?void 0:r.count}},async fetchFeaturedWallets(){const{featuredWalletIds:t}=j.state;if(t!=null&&t.length){const e={...de._getSdkProperties(),page:1,entries:(t==null?void 0:t.length)??Wg,include:t},{data:n}=await de.fetchWallets(e),r=[...n].sort((i,o)=>t.indexOf(i.id)-t.indexOf(o.id)),s=r.map(i=>i.image_id).filter(Boolean);await Promise.allSettled(s.map(i=>de._fetchWalletImage(i))),Ee.featured=r,Ee.allFeatured=r}},async fetchRecommendedWallets(){try{Ee.isFetchingRecommendedWallets=!0;const{includeWalletIds:t,excludeWalletIds:e,featuredWalletIds:n}=j.state,r=[...e??[],...n??[]].filter(Boolean),s=A.getRequestedCaipNetworkIds().join(","),i={page:1,entries:Wg,include:t,exclude:r,chains:s},{data:o,count:a}=await de.fetchWallets(i),c=V.getRecentWallets(),l=o.map(d=>d.image_id).filter(Boolean),u=c.map(d=>d.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(d=>de._fetchWalletImage(d))),Ee.recommended=o,Ee.allRecommended=o,Ee.count=a??0}catch{}finally{Ee.isFetchingRecommendedWallets=!1}},async fetchWalletsByPage({page:t}){const{includeWalletIds:e,excludeWalletIds:n,featuredWalletIds:r}=j.state,s=A.getRequestedCaipNetworkIds().join(","),i=[...Ee.recommended.map(({id:u})=>u),...n??[],...r??[]].filter(Boolean),o={page:t,entries:kA,include:e,exclude:i,chains:s},{data:a,count:c}=await de.fetchWallets(o),l=a.slice(0,UA).map(u=>u.image_id).filter(Boolean);await Promise.allSettled(l.map(u=>de._fetchWalletImage(u))),Ee.wallets=oe.uniqueBy([...Ee.wallets,...de._filterOutExtensions(a)],"id").filter(u=>{var d;return(d=u.chains)==null?void 0:d.some(h=>s.includes(h))}),Ee.count=c>Ee.count?c:Ee.count,Ee.page=t},async initializeExcludedWallets({ids:t}){const e={page:1,entries:t.length,include:t},{data:n}=await de.fetchWallets(e);n&&n.forEach(r=>{Ee.excludedWallets.push({rdns:r.rdns,name:r.name})})},async searchWallet({search:t,badge:e}){const{includeWalletIds:n,excludeWalletIds:r}=j.state,s=A.getRequestedCaipNetworkIds().join(",");Ee.search=[];const i={page:1,entries:100,search:t==null?void 0:t.trim(),badge_type:e,include:n,exclude:r,chains:s},{data:o}=await de.fetchWallets(i);Ve.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:e??"",search:t??""}});const a=o.map(c=>c.image_id).filter(Boolean);await Promise.allSettled([...a.map(c=>de._fetchWalletImage(c)),oe.wait(300)]),Ee.search=de._filterOutExtensions(o)},initPromise(t,e){const n=Ee.promises[t];return n||(Ee.promises[t]=e())},prefetch({fetchConnectorImages:t=!0,fetchFeaturedWallets:e=!0,fetchRecommendedWallets:n=!0,fetchNetworkImages:r=!0}={}){const s=[t&&de.initPromise("connectorImages",de.fetchConnectorImages),e&&de.initPromise("featuredWallets",de.fetchFeaturedWallets),n&&de.initPromise("recommendedWallets",de.fetchRecommendedWallets),r&&de.initPromise("networkImages",de.fetchNetworkImages)].filter(Boolean);return Promise.allSettled(s)},prefetchAnalyticsConfig(){var t;(t=j.state.features)!=null&&t.analytics&&de.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{const{isAnalyticsEnabled:t}=await cn.get({path:"/getAnalyticsConfig",params:de._getSdkProperties()});j.setFeatures({analytics:t})}catch{j.setFeatures({analytics:!1})}},filterByNamespaces(t){if(!(t!=null&&t.length)){Ee.featured=Ee.allFeatured,Ee.recommended=Ee.allRecommended;return}const e=A.getRequestedCaipNetworkIds().join(",");Ee.featured=Ee.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.recommended=Ee.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.filteredWallets=Ee.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})},clearFilterByNamespaces(){Ee.filteredWallets=[]},setFilterByNamespace(t){if(!t){Ee.featured=Ee.allFeatured,Ee.recommended=Ee.allRecommended;return}const e=A.getRequestedCaipNetworkIds().join(",");Ee.featured=Ee.allFeatured.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.recommended=Ee.allRecommended.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))}),Ee.filteredWallets=Ee.wallets.filter(n=>{var r;return(r=n.chains)==null?void 0:r.some(s=>e.includes(s))})}},Ke=Xe({view:"Connect",history:["Connect"],transactionStack:[]}),LA={state:Ke,subscribeKey(t,e){return Ft(Ke,t,e)},pushTransactionStack(t){Ke.transactionStack.push(t)},popTransactionStack(t){const e=Ke.transactionStack.pop();if(!e)return;const{onSuccess:n,onError:r,onCancel:s}=e;switch(t){case"success":n==null||n();break;case"error":r==null||r(),me.goBack();break;case"cancel":s==null||s(),me.goBack();break}},push(t,e){t!==Ke.view&&(Ke.view=t,Ke.history.push(t),Ke.data=e)},reset(t,e){Ke.view=t,Ke.history=[t],Ke.data=e},replace(t,e){Ke.history.at(-1)===t||(Ke.view=t,Ke.history[Ke.history.length-1]=t,Ke.data=e)},goBack(){var r;const t=A.state.activeCaipAddress,e=me.state.view==="ConnectingFarcaster",n=!t&&e;if(Ke.history.length>1){Ke.history.pop();const[s]=Ke.history.slice(-1);s&&(t&&s==="Connect"?Ke.view="Account":Ke.view=s)}else Me.close();(r=Ke.data)!=null&&r.wallet&&(Ke.data.wallet=void 0),setTimeout(()=>{var s,i,o;if(n){ce.setFarcasterUrl(void 0,A.state.activeChain);const a=J.getAuthConnector();(s=a==null?void 0:a.provider)==null||s.reload();const c=Qa(j.state);(o=(i=a==null?void 0:a.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:c.metadata,sdkVersion:c.sdkVersion,projectId:c.projectId,sdkType:c.sdkType})}},100)},goBackToIndex(t){if(Ke.history.length>1){Ke.history=Ke.history.slice(0,t+1);const[e]=Ke.history.slice(-1);e&&(Ke.view=e)}},goBackOrCloseModal(){me.state.history.length>1?me.goBack():Me.close()}},me=Un(LA),zr=Xe({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),zh={state:zr,subscribe(t){return Bt(zr,()=>t(zr))},setThemeMode(t){zr.themeMode=t;try{const e=J.getAuthConnector();if(e){const n=zh.getSnapshot().themeVariables;e.provider.syncTheme({themeMode:t,themeVariables:n,w3mThemeVariables:rs(n,t)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(t){zr.themeVariables={...zr.themeVariables,...t};try{const e=J.getAuthConnector();if(e){const n=zh.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:n,w3mThemeVariables:rs(zr.themeVariables,zr.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot(){return Qa(zr)}},yn=Un(zh),Hw={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},$e=Xe({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...Hw},filterByNamespaceMap:{eip155:!0,solana:!0,polkadot:!0,bip122:!0,cosmos:!0}}),MA={state:$e,subscribe(t){return Bt($e,()=>{t($e)})},subscribeKey(t,e){return Ft($e,t,e)},initialize(t){t.forEach(e=>{const n=V.getConnectedConnectorId(e);n&&J.setConnectorId(n,e)})},setActiveConnector(t){t&&($e.activeConnector=xi(t))},setConnectors(t){t.filter(s=>!$e.allConnectors.some(i=>i.id===s.id&&J.getConnectorName(i.name)===J.getConnectorName(s.name)&&i.chain===s.chain)).forEach(s=>{s.type!=="MULTI_CHAIN"&&$e.allConnectors.push(xi(s))});const n=J.getEnabledNamespaces(),r=J.getEnabledConnectors(n);$e.connectors=J.mergeMultiChainConnectors(r)},filterByNamespaces(t){Object.keys($e.filterByNamespaceMap).forEach(e=>{$e.filterByNamespaceMap[e]=!1}),t.forEach(e=>{$e.filterByNamespaceMap[e]=!0}),J.updateConnectorsForEnabledNamespaces()},filterByNamespace(t,e){$e.filterByNamespaceMap[t]=e,J.updateConnectorsForEnabledNamespaces()},updateConnectorsForEnabledNamespaces(){const t=J.getEnabledNamespaces(),e=J.getEnabledConnectors(t),n=J.areAllNamespacesEnabled();$e.connectors=J.mergeMultiChainConnectors(e),n?de.clearFilterByNamespaces():de.filterByNamespaces(t)},getEnabledNamespaces(){return Object.entries($e.filterByNamespaceMap).filter(([t,e])=>e).map(([t])=>t)},getEnabledConnectors(t){return $e.allConnectors.filter(e=>t.includes(e.chain))},areAllNamespacesEnabled(){return Object.values($e.filterByNamespaceMap).every(t=>t)},mergeMultiChainConnectors(t){const e=J.generateConnectorMapByName(t),n=[];return e.forEach(r=>{const s=r[0],i=(s==null?void 0:s.id)===L.CONNECTOR_ID.AUTH;r.length>1&&s?n.push({name:s.name,imageUrl:s.imageUrl,imageId:s.imageId,connectors:[...r],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:(s==null?void 0:s.id)||""}):s&&n.push(s)}),n},generateConnectorMapByName(t){const e=new Map;return t.forEach(n=>{const{name:r}=n,s=J.getConnectorName(r);if(!s)return;const i=e.get(s)||[];i.find(a=>a.chain===n.chain)||i.push(n),e.set(s,i)}),e},getConnectorName(t){return t&&({"Trust Wallet":"Trust"}[t]||t)},getUniqueConnectorsByName(t){const e=[];return t.forEach(n=>{e.find(r=>r.chain===n.chain)||e.push(n)}),e},addConnector(t){var e,n,r;if(t.id===L.CONNECTOR_ID.AUTH){const s=t,i=Qa(j.state),o=yn.getSnapshot().themeMode,a=yn.getSnapshot().themeVariables;(n=(e=s==null?void 0:s.provider)==null?void 0:e.syncDappData)==null||n.call(e,{metadata:i.metadata,sdkVersion:i.sdkVersion,projectId:i.projectId,sdkType:i.sdkType}),(r=s==null?void 0:s.provider)==null||r.syncTheme({themeMode:o,themeVariables:a,w3mThemeVariables:rs(a,o)}),J.setConnectors([t])}else J.setConnectors([t])},getAuthConnector(t){var r;const e=t||A.state.activeChain,n=$e.connectors.find(s=>s.id===L.CONNECTOR_ID.AUTH);if(n)return(r=n==null?void 0:n.connectors)!=null&&r.length?n.connectors.find(i=>i.chain===e):n},getAnnouncedConnectorRdns(){return $e.connectors.filter(t=>t.type==="ANNOUNCED").map(t=>{var e;return(e=t.info)==null?void 0:e.rdns})},getConnectorById(t){return $e.allConnectors.find(e=>e.id===t)},getConnector(t,e){return $e.allConnectors.filter(r=>r.chain===A.state.activeChain).find(r=>{var s;return r.explorerId===t||((s=r.info)==null?void 0:s.rdns)===e})},syncIfAuthConnector(t){var i,o;if(t.id!=="ID_AUTH")return;const e=t,n=Qa(j.state),r=yn.getSnapshot().themeMode,s=yn.getSnapshot().themeVariables;(o=(i=e==null?void 0:e.provider)==null?void 0:i.syncDappData)==null||o.call(i,{metadata:n.metadata,sdkVersion:n.sdkVersion,sdkType:n.sdkType,projectId:n.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:rs(s,r)})},getConnectorsByNamespace(t){const e=$e.allConnectors.filter(n=>n.chain===t);return J.mergeMultiChainConnectors(e)},canSwitchToSmartAccount(t){return A.checkIfSmartAccountEnabled()&&$n(t)===At.ACCOUNT_TYPES.EOA},selectWalletConnector(t){const e=J.getConnector(t.id,t.rdns);NA.handleMobileDeeplinkRedirect((e==null?void 0:e.explorerId)||t.id,A.state.activeChain),e?me.push("ConnectingExternal",{connector:e}):me.push("ConnectingWalletConnect",{wallet:t})},getConnectors(t){return t?J.getConnectorsByNamespace(t):J.mergeMultiChainConnectors($e.allConnectors)},setFilterByNamespace(t){$e.filterByNamespace=t,$e.connectors=J.getConnectors(t),de.setFilterByNamespace(t)},setConnectorId(t,e){t&&($e.activeConnectorIds={...$e.activeConnectorIds,[e]:t},V.setConnectedConnectorId(e,t))},removeConnectorId(t){$e.activeConnectorIds={...$e.activeConnectorIds,[t]:void 0},V.deleteConnectedConnectorId(t)},getConnectorId(t){if(t)return $e.activeConnectorIds[t]},isConnected(t){return t?!!$e.activeConnectorIds[t]:Object.values($e.activeConnectorIds).some(e=>!!e)},resetConnectorIds(){$e.activeConnectorIds={...Hw}}},J=Un(MA),BA=1e3,oa={checkNamespaceConnectorId(t,e){return J.getConnectorId(t)===e},isSocialProvider(t){return qe.DEFAULT_REMOTE_FEATURES.socials.includes(t)},connectWalletConnect({walletConnect:t,connector:e,closeModalOnConnect:n=!0,redirectViewOnModalClose:r="Connect",onOpen:s,onConnect:i}){return new Promise((o,a)=>{if(t&&J.setActiveConnector(e),s==null||s(oe.isMobile()&&t),r){const l=Me.subscribeKey("open",u=>{u||(me.state.view!==r&&me.replace(r),l(),a(new Error("Modal closed")))})}const c=A.subscribeKey("activeCaipAddress",l=>{l&&(i==null||i(),n&&Me.close(),c(),o(On.parseCaipAddress(l)))})})},connectExternal(t){return new Promise((e,n)=>{const r=A.subscribeKey("activeCaipAddress",s=>{s&&(Me.close(),r(),e(On.parseCaipAddress(s)))});X.connectExternal(t,t.chain).catch(()=>{r(),n(new Error("Connection rejected"))})})},connectSocial({social:t,closeModalOnConnect:e=!0,onOpenFarcaster:n,onConnect:r}){let s=ce.state.socialWindow,i=ce.state.socialProvider,o=!1,a=null;const c=A.subscribeKey("activeCaipAddress",l=>{l&&(e&&Me.close(),c())});return new Promise((l,u)=>{async function d(f){var p,g;if((p=f.data)!=null&&p.resultUri)if(f.origin===L.SECURE_SITE_SDK_ORIGIN){window.removeEventListener("message",d,!1);try{const m=J.getAuthConnector();if(m&&!o){s&&(s.close(),ce.setSocialWindow(void 0,A.state.activeChain),s=ce.state.socialWindow),o=!0;const v=f.data.resultUri;if(i&&Ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_REQUEST_USER_DATA",properties:{provider:i}}),i){V.setConnectedSocialProvider(i),await X.connectExternal({id:m.id,type:m.type,socialUri:v},m.chain);const b=A.state.activeCaipAddress;if(!b){u(new Error("Failed to connect"));return}l(On.parseCaipAddress(b)),Ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:i,caipNetworkId:(g=A.getActiveCaipNetwork())==null?void 0:g.caipNetworkId}})}}}catch{i&&Ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:i}}),u(new Error("Failed to connect"))}}else i&&Ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_ERROR",properties:{provider:i}})}async function h(){if(t&&(ce.setSocialProvider(t,A.state.activeChain),i=ce.state.socialProvider,Ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_STARTED",properties:{provider:i}})),i==="farcaster"){n==null||n();const f=Me.subscribeKey("open",g=>{!g&&t==="farcaster"&&(u(new Error("Popup closed")),r==null||r(),f())}),p=J.getAuthConnector();if(p&&!ce.state.farcasterUrl)try{const{url:g}=await p.provider.getFarcasterUri();ce.setFarcasterUrl(g,A.state.activeChain)}catch{u(new Error("Failed to connect to farcaster"))}}else{const f=J.getAuthConnector();a=oe.returnOpenHref(`${L.SECURE_SITE_SDK_ORIGIN}/loading`,"popupWindow","width=600,height=800,scrollbars=yes");try{if(f&&i){const{uri:p}=await f.provider.getSocialRedirectUri({provider:i});if(a&&p){ce.setSocialWindow(a,A.state.activeChain),s=ce.state.socialWindow,a.location.href=p;const g=setInterval(()=>{s!=null&&s.closed&&!o&&(u(new Error("Popup closed")),clearInterval(g))},1e3);window.addEventListener("message",d,!1)}else a==null||a.close(),u(new Error("Failed to initiate social connection"))}}catch{u(new Error("Failed to initiate social connection")),a==null||a.close()}}}h()})},connectEmail({closeModalOnConnect:t=!0,redirectViewOnModalClose:e="Connect",onOpen:n,onConnect:r}){return new Promise((s,i)=>{if(n==null||n(),e){const a=Me.subscribeKey("open",c=>{c||(me.state.view!==e&&me.replace(e),a(),i(new Error("Modal closed")))})}const o=A.subscribeKey("activeCaipAddress",a=>{a&&(r==null||r(),t&&Me.close(),o(),s(On.parseCaipAddress(a)))})})},async updateEmail(){const t=V.getConnectedConnectorId(A.state.activeChain),e=J.getAuthConnector();if(!e)throw new Error("No auth connector found");if(t!==L.CONNECTOR_ID.AUTH)throw new Error("Not connected to email or social");const n=e.provider.getEmail()??"";return me.push("UpdateEmailWallet",{email:n,redirectView:void 0}),new Promise((r,s)=>{const i=setInterval(()=>{const a=e.provider.getEmail()??"";a!==n&&(Me.close(),clearInterval(i),o(),r({email:a}))},BA),o=Me.subscribeKey("open",a=>{a||(me.state.view!=="Connect"&&me.push("Connect"),clearInterval(i),o(),s(new Error("Modal closed")))})})},canSwitchToSmartAccount(t){return A.checkIfSmartAccountEnabled()&&$n(t)===At.ACCOUNT_TYPES.EOA}};function qw(){var r,s;const t=((r=A.state.activeCaipNetwork)==null?void 0:r.chainNamespace)||"eip155",e=((s=A.state.activeCaipNetwork)==null?void 0:s.id)||1,n=qe.NATIVE_TOKEN_ADDRESS[t];return`${t}:${e}:${n}`}function $n(t){var n;return(n=A.getAccountData(t))==null?void 0:n.preferredAccountType}const hu={getConnectionStatus(t,e){const n=J.state.activeConnectorIds[e],r=X.getConnections(e);return!!n&&t.connectorId===n?"connected":r.some(o=>o.connectorId.toLowerCase()===t.connectorId.toLowerCase())?"active":"disconnected"},excludeConnectorAddressFromConnections({connections:t,connectorId:e,addresses:n}){return t.map(r=>{if((e?r.connectorId.toLowerCase()===e.toLowerCase():!1)&&n){const i=r.accounts.filter(o=>!n.some(c=>c.toLowerCase()===o.address.toLowerCase()));return{...r,accounts:i}}return r})},excludeExistingConnections(t,e){const n=new Set(t);return e.filter(r=>!n.has(r.connectorId))},getConnectionsByConnectorId(t,e){return t.filter(n=>n.connectorId.toLowerCase()===e.toLowerCase())},getConnectionsData(t){var a;const e=!!((a=j.state.remoteFeatures)!=null&&a.multiWallet),n=J.state.activeConnectorIds[t],r=X.getConnections(t),i=(X.state.recentConnections.get(t)??[]).filter(c=>J.getConnectorById(c.connectorId)),o=hu.excludeExistingConnections([...r.map(c=>c.connectorId),...n?[n]:[]],i);return e?{connections:r,recentConnections:o}:{connections:r.filter(c=>c.connectorId.toLowerCase()===(n==null?void 0:n.toLowerCase())),recentConnections:[]}}},di=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),wt=Xe({...di}),FA={state:wt,subscribeKey(t,e){return Ft(wt,t,e)},showLoading(t,e={}){this._showMessage({message:t,variant:"loading",...e})},showSuccess(t){this._showMessage({message:t,variant:"success"})},showSvg(t,e){this._showMessage({message:t,svg:e})},showError(t){const e=oe.parseError(t);this._showMessage({message:e,variant:"error"})},hide(){wt.message=di.message,wt.variant=di.variant,wt.svg=di.svg,wt.open=di.open,wt.autoClose=di.autoClose},_showMessage({message:t,svg:e,variant:n="success",autoClose:r=di.autoClose}){wt.open?(wt.open=!1,setTimeout(()=>{wt.message=t,wt.variant=n,wt.svg=e,wt.open=!0,wt.autoClose=r},150)):(wt.message=t,wt.variant=n,wt.svg=e,wt.open=!0,wt.autoClose=r)}},Pr=FA,ot=Xe({transactions:[],transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),jA={state:ot,subscribe(t){return Bt(ot,()=>t(ot))},setLastNetworkInView(t){ot.lastNetworkInView=t},async fetchTransactions(t){var e;if(!t)throw new Error("Transactions can't be fetched without an accountAddress");ot.loading=!0;try{const n=await fe.fetchTransactions({account:t,cursor:ot.next,chainId:(e=A.state.activeCaipNetwork)==null?void 0:e.caipNetworkId}),r=Kl.filterSpamTransactions(n.data),s=Kl.filterByConnectedChain(r),i=[...ot.transactions,...s];ot.loading=!1,ot.transactions=i,ot.transactionsByYear=Kl.groupTransactionsByYearAndMonth(ot.transactionsByYear,s),ot.empty=i.length===0,ot.next=n.next?n.next:void 0}catch{const r=A.state.activeChain;Ve.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:t,projectId:j.state.projectId,cursor:ot.next,isSmartAccount:$n(r)===At.ACCOUNT_TYPES.SMART_ACCOUNT}}),Pr.showError("Failed to fetch transactions"),ot.loading=!1,ot.empty=!0,ot.next=void 0}},groupTransactionsByYearAndMonth(t={},e=[]){const n=t;return e.forEach(r=>{const s=new Date(r.metadata.minedAt).getFullYear(),i=new Date(r.metadata.minedAt).getMonth(),o=n[s]??{},c=(o[i]??[]).filter(l=>l.id!==r.id);n[s]={...o,[i]:[...c,r].sort((l,u)=>new Date(u.metadata.minedAt).getTime()-new Date(l.metadata.minedAt).getTime())}}),n},filterSpamTransactions(t){return t.filter(e=>!e.transfers.every(r=>{var s;return((s=r.nft_info)==null?void 0:s.flags.is_spam)===!0}))},filterByConnectedChain(t){var r;const e=(r=A.state.activeCaipNetwork)==null?void 0:r.caipNetworkId;return t.filter(s=>s.metadata.chain===e)},clearCursor(){ot.next=void 0},resetTransactions(){ot.transactions=[],ot.transactionsByYear={},ot.lastNetworkInView=void 0,ot.loading=!1,ot.empty=!1,ot.next=void 0}},Kl=Un(jA,"API_ERROR"),Oe=Xe({connections:new Map,recentConnections:new Map,isSwitchingConnection:!1,wcError:!1,buffering:!1,status:"disconnected"});let si;const HA={state:Oe,subscribe(t){return Bt(Oe,()=>t(Oe))},subscribeKey(t,e){return Ft(Oe,t,e)},_getClient(){return Oe._client},setClient(t){Oe._client=xi(t)},initialize(t){const e=t.filter(n=>!!n.namespace).map(n=>n.namespace);X.syncStorageConnections(e)},syncStorageConnections(t){const e=V.getConnections(),n=t??Array.from(A.state.chains.keys());for(const r of n){const s=e[r]??[],i=new Map(Oe.recentConnections);i.set(r,s),Oe.recentConnections=i}},getConnections(t){return t?Oe.connections.get(t)??[]:[]},hasAnyConnection(t){const e=X.state.connections;return Array.from(e.values()).flatMap(n=>n).some(({connectorId:n})=>n===t)},async connectWalletConnect(){var t,e,n,r;if(oe.isTelegram()||oe.isSafari()&&oe.isIos()){if(si){await si,si=void 0;return}if(!oe.isPairingExpired(Oe==null?void 0:Oe.wcPairingExpiry)){const s=Oe.wcUri;Oe.wcUri=s;return}si=(e=(t=X._getClient())==null?void 0:t.connectWalletConnect)==null?void 0:e.call(t).catch(()=>{}),X.state.status="connecting",await si,si=void 0,Oe.wcPairingExpiry=void 0,X.state.status="connected"}else await((r=(n=X._getClient())==null?void 0:n.connectWalletConnect)==null?void 0:r.call(n))},async connectExternal(t,e,n=!0){var s,i;const r=await((i=(s=X._getClient())==null?void 0:s.connectExternal)==null?void 0:i.call(s,t));return n&&A.setActiveNamespace(e),r},async reconnectExternal(t){var n,r;await((r=(n=X._getClient())==null?void 0:n.reconnectExternal)==null?void 0:r.call(n,t));const e=t.chain||A.state.activeChain;e&&J.setConnectorId(t.id,e)},async setPreferredAccountType(t,e){var r;if(!e)return;Me.setLoading(!0,A.state.activeChain);const n=J.getAuthConnector();n&&(ce.setPreferredAccountType(t,e),await n.provider.setPreferredAccount(t),V.setPreferredAccountTypes(Object.entries(A.state.chains).reduce((s,[i,o])=>{const a=i,c=$n(a);return c!==void 0&&(s[a]=c),s},{})),await X.reconnectExternal(n),Me.setLoading(!1,A.state.activeChain),Ve.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:t,network:((r=A.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}))},async signMessage(t){var e;return(e=X._getClient())==null?void 0:e.signMessage(t)},parseUnits(t,e){var n;return(n=X._getClient())==null?void 0:n.parseUnits(t,e)},formatUnits(t,e){var n;return(n=X._getClient())==null?void 0:n.formatUnits(t,e)},async sendTransaction(t){var e;return(e=X._getClient())==null?void 0:e.sendTransaction(t)},async getCapabilities(t){var e;return(e=X._getClient())==null?void 0:e.getCapabilities(t)},async grantPermissions(t){var e;return(e=X._getClient())==null?void 0:e.grantPermissions(t)},async walletGetAssets(t){var e;return((e=X._getClient())==null?void 0:e.walletGetAssets(t))??{}},async estimateGas(t){var e;return(e=X._getClient())==null?void 0:e.estimateGas(t)},async writeContract(t){var e;return(e=X._getClient())==null?void 0:e.writeContract(t)},async getEnsAddress(t){var e;return(e=X._getClient())==null?void 0:e.getEnsAddress(t)},async getEnsAvatar(t){var e;return(e=X._getClient())==null?void 0:e.getEnsAvatar(t)},checkInstalled(t){var e,n;return((n=(e=X._getClient())==null?void 0:e.checkInstalled)==null?void 0:n.call(e,t))||!1},resetWcConnection(){Oe.wcUri=void 0,Oe.wcPairingExpiry=void 0,Oe.wcLinking=void 0,Oe.recentWallet=void 0,Oe.status="disconnected",Kl.resetTransactions(),V.deleteWalletConnectDeepLink()},resetUri(){Oe.wcUri=void 0,Oe.wcPairingExpiry=void 0,si=void 0},finalizeWcConnection(){var n,r,s;const{wcLinking:t,recentWallet:e}=X.state;t&&V.setWalletConnectDeepLink(t),e&&V.setAppKitRecent(e),Ve.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:t?"mobile":"qrcode",name:((r=(n=me.state.data)==null?void 0:n.wallet)==null?void 0:r.name)||"Unknown",caipNetworkId:(s=A.getActiveCaipNetwork())==null?void 0:s.caipNetworkId}})},setWcBasic(t){Oe.wcBasic=t},setUri(t){Oe.wcUri=t,Oe.wcPairingExpiry=oe.getPairingExpiry()},setWcLinking(t){Oe.wcLinking=t},setWcError(t){Oe.wcError=t,Oe.buffering=!1},setRecentWallet(t){Oe.recentWallet=t},setBuffering(t){Oe.buffering=t},setStatus(t){Oe.status=t},setIsSwitchingConnection(t){Oe.isSwitchingConnection=t},async disconnect({id:t,namespace:e,initialDisconnect:n}={}){var r;try{await((r=X._getClient())==null?void 0:r.disconnect({id:t,chainNamespace:e,initialDisconnect:n}))}catch(s){throw new Ro("Failed to disconnect","INTERNAL_SDK_ERROR",s)}},setConnections(t,e){const n=new Map(Oe.connections);n.set(e,t),Oe.connections=n},async handleAuthAccountSwitch({address:t,namespace:e}){var s,i;const n=(i=(s=ce.state.user)==null?void 0:s.accounts)==null?void 0:i.find(o=>o.type==="smartAccount"),r=n&&n.address.toLowerCase()===t.toLowerCase()&&oa.canSwitchToSmartAccount(e)?"smartAccount":"eoa";await X.setPreferredAccountType(r,e)},async handleActiveConnection({connection:t,namespace:e,address:n}){const r=J.getConnectorById(t.connectorId),s=t.connectorId===L.CONNECTOR_ID.AUTH;if(!r)throw new Error(`No connector found for connection: ${t.connectorId}`);if(s)s&&n&&await X.handleAuthAccountSwitch({address:n,namespace:e});else{const i=await X.connectExternal({id:r.id,type:r.type,provider:r.provider,address:n,chain:e},e);return i==null?void 0:i.address}return n},async handleDisconnectedConnection({connection:t,namespace:e,address:n,closeModalOnConnect:r}){var l,u;const s=J.getConnectorById(t.connectorId),i=(u=(l=t.auth)==null?void 0:l.name)==null?void 0:u.toLowerCase(),o=t.connectorId===L.CONNECTOR_ID.AUTH,a=t.connectorId===L.CONNECTOR_ID.WALLET_CONNECT;if(!s)throw new Error(`No connector found for connection: ${t.connectorId}`);let c;if(o)if(i&&oa.isSocialProvider(i)){const{address:d}=await oa.connectSocial({social:i,closeModalOnConnect:r,onOpenFarcaster(){Me.open({view:"ConnectingFarcaster"})},onConnect(){me.replace("ProfileWallets")}});c=d}else{const{address:d}=await oa.connectEmail({closeModalOnConnect:r,onOpen(){Me.open({view:"EmailLogin"})},onConnect(){me.replace("ProfileWallets")}});c=d}else if(a){const{address:d}=await oa.connectWalletConnect({walletConnect:!0,connector:s,closeModalOnConnect:r,onOpen(h){Me.open({view:h?"AllWallets":"ConnectingWalletConnect"})},onConnect(){me.replace("ProfileWallets")}});c=d}else{const d=await X.connectExternal({id:s.id,type:s.type,provider:s.provider,chain:e},e);d&&(c=d.address)}return o&&n&&await X.handleAuthAccountSwitch({address:n,namespace:e}),c},async switchConnection({connection:t,address:e,namespace:n,closeModalOnConnect:r,onChange:s}){let i;const o=ce.getCaipAddress(n);if(o){const{address:c}=On.parseCaipAddress(o);i=c}const a=hu.getConnectionStatus(t,n);switch(a){case"connected":case"active":{const c=await X.handleActiveConnection({connection:t,namespace:n,address:e});if(i&&c){const l=c.toLowerCase()!==i.toLowerCase();s==null||s({address:c,namespace:n,hasSwitchedAccount:l,hasSwitchedWallet:a==="active"})}break}case"disconnected":{const c=await X.handleDisconnectedConnection({connection:t,namespace:n,address:e,closeModalOnConnect:r});c&&(s==null||s({address:c,namespace:n,hasSwitchedAccount:!0,hasSwitchedWallet:!0}));break}default:throw new Error(`Invalid connection status: ${a}`)}}},X=Un(HA),Xi=Xe({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),Rr={state:Xi,subscribe(t){return Bt(Xi,()=>t(Xi))},subscribeOpen(t){return Ft(Xi,"open",t)},set(t){Object.assign(Xi,{...Xi,...t})}},qA={async getTokenList(){var r;const t=A.state.activeCaipNetwork,e=await fe.fetchSwapTokens({chainId:t==null?void 0:t.caipNetworkId});return((r=e==null?void 0:e.tokens)==null?void 0:r.map(s=>({...s,eip2612:!1,quantity:{decimals:"0",numeric:"0"},price:0,value:0})))||[]},async fetchGasPrice(){var e;const t=A.state.activeCaipNetwork;if(!t)return null;try{switch(t.chainNamespace){case"solana":const n=(e=await(X==null?void 0:X.estimateGas({chainNamespace:"solana"})))==null?void 0:e.toString();return{standard:n,fast:n,instant:n};case"eip155":default:return await fe.fetchGasPrice({chainId:t.caipNetworkId})}}catch{return null}},async fetchSwapAllowance({tokenAddress:t,userAddress:e,sourceTokenAmount:n,sourceTokenDecimals:r}){const s=await fe.fetchSwapAllowance({tokenAddress:t,userAddress:e});if(s!=null&&s.allowance&&n&&r){const i=X.parseUnits(n,r)||0;return BigInt(s.allowance)>=i}return!1},async getMyTokensWithBalance(t){const e=await Bp.getMyTokensWithBalance(t);return ce.setTokenBalance(e,A.state.activeChain),this.mapBalancesToSwapTokens(e)},mapBalancesToSwapTokens(t){return(t==null?void 0:t.map(e=>({...e,address:e!=null&&e.address?e.address:qw(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1})))||[]}},We=Xe({tokenBalances:[],loading:!1}),zA={state:We,subscribe(t){return Bt(We,()=>t(We))},subscribeKey(t,e){return Ft(We,t,e)},setToken(t){t&&(We.token=xi(t))},setTokenAmount(t){We.sendTokenAmount=t},setReceiverAddress(t){We.receiverAddress=t},setReceiverProfileImageUrl(t){We.receiverProfileImageUrl=t},setReceiverProfileName(t){We.receiverProfileName=t},setNetworkBalanceInUsd(t){We.networkBalanceInUSD=t},setLoading(t){We.loading=t},async sendToken(){var t;try{switch(He.setLoading(!0),(t=A.state.activeCaipNetwork)==null?void 0:t.chainNamespace){case"eip155":await He.sendEvmToken();return;case"solana":await He.sendSolanaToken();return;default:throw new Error("Unsupported chain")}}finally{He.setLoading(!1)}},async sendEvmToken(){var n,r,s;const t=A.state.activeChain;if(!t)throw new Error("SendController:sendEvmToken - activeChainNamespace is required");const e=$n(t);if(!He.state.sendTokenAmount||!He.state.receiverAddress)throw new Error("An amount and receiver address are required");if(!He.state.token)throw new Error("A token is required");(n=He.state.token)!=null&&n.address?(Ve.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===At.ACCOUNT_TYPES.SMART_ACCOUNT,token:He.state.token.address,amount:He.state.sendTokenAmount,network:((r=A.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)||""}}),await He.sendERC20Token({receiverAddress:He.state.receiverAddress,tokenAddress:He.state.token.address,sendTokenAmount:He.state.sendTokenAmount,decimals:He.state.token.quantity.decimals})):(Ve.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:e===At.ACCOUNT_TYPES.SMART_ACCOUNT,token:He.state.token.symbol||"",amount:He.state.sendTokenAmount,network:((s=A.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)||""}}),await He.sendNativeToken({receiverAddress:He.state.receiverAddress,sendTokenAmount:He.state.sendTokenAmount,decimals:He.state.token.quantity.decimals}))},async fetchTokenBalance(t){var i,o;We.loading=!0;const e=(i=A.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,n=(o=A.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=A.state.activeCaipAddress,s=r?oe.getPlainAddress(r):void 0;if(We.lastRetry&&!oe.isAllowedRetry(We.lastRetry,30*qe.ONE_SEC_MS))return We.loading=!1,[];try{if(s&&e&&n){const a=await Bp.getMyTokensWithBalance();return We.tokenBalances=a,We.lastRetry=void 0,a}}catch(a){We.lastRetry=Date.now(),t==null||t(a),Pr.showError("Token Balance Unavailable")}finally{We.loading=!1}return[]},fetchNetworkBalance(){if(We.tokenBalances.length===0)return;const t=qA.mapBalancesToSwapTokens(We.tokenBalances);if(!t)return;const e=t.find(n=>n.address===qw());e&&(We.networkBalanceInUSD=e?dA.multiply(e.quantity.numeric,e.price).toString():"0")},async sendNativeToken(t){var i,o,a;me.pushTransactionStack({});const e=t.receiverAddress,n=ce.state.address,r=X.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));await X.sendTransaction({chainNamespace:L.CHAIN.EVM,to:e,address:n,data:"0x",value:r??BigInt(0)}),Ve.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:$n("eip155")===At.ACCOUNT_TYPES.SMART_ACCOUNT,token:((i=He.state.token)==null?void 0:i.symbol)||"",amount:t.sendTokenAmount,network:((o=A.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)||""}}),(a=X._getClient())==null||a.updateBalance("eip155"),He.resetSend()},async sendERC20Token(t){me.pushTransactionStack({onSuccess(){me.replace("Account")}});const e=X.parseUnits(t.sendTokenAmount.toString(),Number(t.decimals));if(ce.state.address&&t.sendTokenAmount&&t.receiverAddress&&t.tokenAddress){const n=oe.getPlainAddress(t.tokenAddress);if(!n)throw new Error("SendController:sendERC20Token - tokenAddress is required");await X.writeContract({fromAddress:ce.state.address,tokenAddress:n,args:[t.receiverAddress,e??BigInt(0)],method:"transfer",abi:gA.getERC20Abi(n),chainNamespace:L.CHAIN.EVM}),He.resetSend()}},async sendSolanaToken(){var t;if(!He.state.sendTokenAmount||!He.state.receiverAddress)throw new Error("An amount and receiver address are required");me.pushTransactionStack({onSuccess(){me.replace("Account")}}),await X.sendTransaction({chainNamespace:"solana",to:He.state.receiverAddress,value:He.state.sendTokenAmount}),(t=X._getClient())==null||t.updateBalance("solana"),He.resetSend()},resetSend(){We.token=void 0,We.sendTokenAmount=void 0,We.receiverAddress=void 0,We.receiverProfileImageUrl=void 0,We.receiverProfileName=void 0,We.loading=!1,We.tokenBalances=[]}},He=Un(zA),Ud={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,user:void 0,preferredAccountType:void 0},ml={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},Q=Xe({chains:nA(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),WA={state:Q,subscribe(t){return Bt(Q,()=>{t(Q)})},subscribeKey(t,e){return Ft(Q,t,e)},subscribeChainProp(t,e,n){let r;return Bt(Q.chains,()=>{var i;const s=n||Q.activeChain;if(s){const o=(i=Q.chains.get(s))==null?void 0:i[t];r!==o&&(r=o,e(o))}})},initialize(t,e,n){const{chainId:r,namespace:s}=V.getActiveNetworkProps(),i=e==null?void 0:e.find(u=>u.id.toString()===(r==null?void 0:r.toString())),a=t.find(u=>(u==null?void 0:u.namespace)===s)||(t==null?void 0:t[0]),c=t.map(u=>u.namespace).filter(u=>u!==void 0),l=j.state.enableEmbedded?new Set([...c]):new Set([...(e==null?void 0:e.map(u=>u.chainNamespace))??[]]);((t==null?void 0:t.length)===0||!a)&&(Q.noAdapters=!0),Q.noAdapters||(Q.activeChain=a==null?void 0:a.namespace,Q.activeCaipNetwork=i,A.setChainNetworkData(a==null?void 0:a.namespace,{caipNetwork:i}),Q.activeChain&&Rr.set({activeChain:a==null?void 0:a.namespace})),l.forEach(u=>{const d=e==null?void 0:e.filter(p=>p.chainNamespace===u),h=V.getPreferredAccountTypes()||{},f={...j.state.defaultAccountTypes,...h};A.state.chains.set(u,{namespace:u,networkState:Xe({...ml,caipNetwork:d==null?void 0:d[0]}),accountState:Xe({...Ud,preferredAccountType:f[u]}),caipNetworks:d??[],...n}),A.setRequestedCaipNetworks(d??[],u)})},removeAdapter(t){var e,n;if(Q.activeChain===t){const r=Array.from(Q.chains.entries()).find(([s])=>s!==t);if(r){const s=(n=(e=r[1])==null?void 0:e.caipNetworks)==null?void 0:n[0];s&&A.setActiveCaipNetwork(s)}}Q.chains.delete(t)},addAdapter(t,{networkControllerClient:e,connectionControllerClient:n},r){if(!t.namespace)throw new Error("ChainController:addAdapter - adapter must have a namespace");Q.chains.set(t.namespace,{namespace:t.namespace,networkState:{...ml,caipNetwork:r[0]},accountState:Ud,caipNetworks:r,connectionControllerClient:n,networkControllerClient:e}),A.setRequestedCaipNetworks((r==null?void 0:r.filter(s=>s.chainNamespace===t.namespace))??[],t.namespace)},addNetwork(t){var n;const e=Q.chains.get(t.chainNamespace);if(e){const r=[...e.caipNetworks||[]];(n=e.caipNetworks)!=null&&n.find(s=>s.id===t.id)||r.push(t),Q.chains.set(t.chainNamespace,{...e,caipNetworks:r}),A.setRequestedCaipNetworks(r,t.chainNamespace),J.filterByNamespace(t.chainNamespace,!0)}},removeNetwork(t,e){var r,s,i;const n=Q.chains.get(t);if(n){const o=((r=Q.activeCaipNetwork)==null?void 0:r.id)===e,a=[...((s=n.caipNetworks)==null?void 0:s.filter(c=>c.id!==e))||[]];o&&((i=n==null?void 0:n.caipNetworks)!=null&&i[0])&&A.setActiveCaipNetwork(n.caipNetworks[0]),Q.chains.set(t,{...n,caipNetworks:a}),A.setRequestedCaipNetworks(a||[],t),a.length===0&&J.filterByNamespace(t,!1)}},setAdapterNetworkState(t,e){const n=Q.chains.get(t);n&&(n.networkState={...n.networkState||ml,...e},Q.chains.set(t,n))},setChainAccountData(t,e,n=!0){if(!t)throw new Error("Chain is required to update chain account data");const r=Q.chains.get(t);if(r){const s={...r.accountState||Ud,...e};Q.chains.set(t,{...r,accountState:s}),(Q.chains.size===1||Q.activeChain===t)&&(e.caipAddress&&(Q.activeCaipAddress=e.caipAddress),ce.replaceState(s))}},setChainNetworkData(t,e){if(!t)return;const n=Q.chains.get(t);if(n){const r={...n.networkState||ml,...e};Q.chains.set(t,{...n,networkState:r})}},setAccountProp(t,e,n,r=!0){A.setChainAccountData(n,{[t]:e},r)},setActiveNamespace(t){var r,s;Q.activeChain=t;const e=t?Q.chains.get(t):void 0,n=(r=e==null?void 0:e.networkState)==null?void 0:r.caipNetwork;n!=null&&n.id&&t&&(Q.activeCaipAddress=(s=e==null?void 0:e.accountState)==null?void 0:s.caipAddress,Q.activeCaipNetwork=n,A.setChainNetworkData(t,{caipNetwork:n}),V.setActiveCaipNetworkId(n==null?void 0:n.caipNetworkId),Rr.set({activeChain:t,selectedNetworkId:n==null?void 0:n.caipNetworkId}))},setActiveCaipNetwork(t){var r,s,i;if(!t)return;Q.activeChain!==t.chainNamespace&&A.setIsSwitchingNamespace(!0);const e=Q.chains.get(t.chainNamespace);Q.activeChain=t.chainNamespace,Q.activeCaipNetwork=t,A.setChainNetworkData(t.chainNamespace,{caipNetwork:t}),(r=e==null?void 0:e.accountState)!=null&&r.address?Q.activeCaipAddress=`${t.chainNamespace}:${t.id}:${(s=e==null?void 0:e.accountState)==null?void 0:s.address}`:Q.activeCaipAddress=void 0,A.setAccountProp("caipAddress",Q.activeCaipAddress,t.chainNamespace),e&&ce.replaceState(e.accountState),He.resetSend(),Rr.set({activeChain:Q.activeChain,selectedNetworkId:(i=Q.activeCaipNetwork)==null?void 0:i.caipNetworkId}),V.setActiveCaipNetworkId(t.caipNetworkId),!A.checkIfSupportedNetwork(t.chainNamespace)&&j.state.enableNetworkSwitch&&!j.state.allowUnsupportedChain&&!X.state.wcBasic&&A.showUnsupportedChainUI()},addCaipNetwork(t){var n;if(!t)return;const e=Q.chains.get(t.chainNamespace);e&&((n=e==null?void 0:e.caipNetworks)==null||n.push(t))},async switchActiveNamespace(t){var s;if(!t)return;const e=t!==A.state.activeChain,n=(s=A.getNetworkData(t))==null?void 0:s.caipNetwork,r=A.getCaipNetworkByNamespace(t,n==null?void 0:n.id);e&&r&&await A.switchActiveNetwork(r)},async switchActiveNetwork(t){var i;const e=A.state.activeChain;if(!e)throw new Error("ChainController:switchActiveNetwork - namespace is required");const n=A.state.chains.get(e),r=!((i=n==null?void 0:n.caipNetworks)!=null&&i.some(o=>{var a;return o.id===((a=Q.activeCaipNetwork)==null?void 0:a.id)})),s=A.getNetworkControllerClient(t.chainNamespace);if(s){try{await s.switchCaipNetwork(t),r&&Me.close()}catch{me.goBack()}Ve.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:t.caipNetworkId}})}},getNetworkControllerClient(t){const e=t||Q.activeChain;if(!e)throw new Error("ChainController:getNetworkControllerClient - chain is required");const n=Q.chains.get(e);if(!n)throw new Error("Chain adapter not found");if(!n.networkControllerClient)throw new Error("NetworkController client not set");return n.networkControllerClient},getConnectionControllerClient(t){const e=t||Q.activeChain;if(!e)throw new Error("Chain is required to get connection controller client");const n=Q.chains.get(e);if(!(n!=null&&n.connectionControllerClient))throw new Error("ConnectionController client not set");return n.connectionControllerClient},getAccountProp(t,e){var s;let n=Q.activeChain;if(e&&(n=e),!n)return;const r=(s=Q.chains.get(n))==null?void 0:s.accountState;if(r)return r[t]},getNetworkProp(t,e){var r;const n=(r=Q.chains.get(e))==null?void 0:r.networkState;if(n)return n[t]},getRequestedCaipNetworks(t){const e=Q.chains.get(t),{approvedCaipNetworkIds:n=[],requestedCaipNetworks:r=[]}=(e==null?void 0:e.networkState)||{};return oe.sortRequestedNetworks(n,r).filter(o=>o==null?void 0:o.id)},getAllRequestedCaipNetworks(){const t=[];return Q.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllRequestedCaipNetworks - chainAdapter must have a namespace");const n=A.getRequestedCaipNetworks(e.namespace);t.push(...n)}),t},setRequestedCaipNetworks(t,e){A.setAdapterNetworkState(e,{requestedCaipNetworks:t});const r=A.getAllRequestedCaipNetworks().map(i=>i.chainNamespace),s=Array.from(new Set(r));J.filterByNamespaces(s)},getAllApprovedCaipNetworkIds(){const t=[];return Q.chains.forEach(e=>{if(!e.namespace)throw new Error("ChainController:getAllApprovedCaipNetworkIds - chainAdapter must have a namespace");const n=A.getApprovedCaipNetworkIds(e.namespace);t.push(...n)}),t},getActiveCaipNetwork(t){var e,n;return t?(n=(e=Q.chains.get(t))==null?void 0:e.networkState)==null?void 0:n.caipNetwork:Q.activeCaipNetwork},getActiveCaipAddress(){return Q.activeCaipAddress},getApprovedCaipNetworkIds(t){var r;const e=Q.chains.get(t);return((r=e==null?void 0:e.networkState)==null?void 0:r.approvedCaipNetworkIds)||[]},async setApprovedCaipNetworksData(t){const e=A.getNetworkControllerClient(),n=await(e==null?void 0:e.getApprovedCaipNetworksData());A.setAdapterNetworkState(t,{approvedCaipNetworkIds:n==null?void 0:n.approvedCaipNetworkIds,supportsAllNetworks:n==null?void 0:n.supportsAllNetworks})},checkIfSupportedNetwork(t,e){const n=e||Q.activeCaipNetwork,r=A.getRequestedCaipNetworks(t);return r.length?r==null?void 0:r.some(s=>s.id===(n==null?void 0:n.id)):!0},checkIfSupportedChainId(t){if(!Q.activeChain)return!0;const e=A.getRequestedCaipNetworks(Q.activeChain);return e==null?void 0:e.some(n=>n.id===t)},setSmartAccountEnabledNetworks(t,e){A.setAdapterNetworkState(e,{smartAccountEnabledNetworks:t})},checkIfSmartAccountEnabled(){var r;const t=ec.caipNetworkIdToNumber((r=Q.activeCaipNetwork)==null?void 0:r.caipNetworkId),e=Q.activeChain;if(!e||!t)return!1;const n=A.getNetworkProp("smartAccountEnabledNetworks",e);return!!(n!=null&&n.includes(Number(t)))},showUnsupportedChainUI(){Me.open({view:"UnsupportedChain"})},checkIfNamesSupported(){const t=Q.activeCaipNetwork;return!!(t!=null&&t.chainNamespace&&qe.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(t.chainNamespace))},resetNetwork(t){A.setAdapterNetworkState(t,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0})},resetAccount(t){const e=t;if(!e)throw new Error("Chain is required to set account prop");const n=j.state.defaultAccountTypes[e],r=A.getAccountProp("preferredAccountType",e);Q.activeCaipAddress=void 0,A.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:n||r,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,user:void 0,status:"disconnected"}),J.removeConnectorId(e)},setIsSwitchingNamespace(t){Q.isSwitchingNamespace=t},getFirstCaipNetworkSupportsAuthConnector(){var n,r;const t=[];let e;if(Q.chains.forEach(s=>{L.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(i=>i===s.namespace)&&s.namespace&&t.push(s.namespace)}),t.length>0){const s=t[0];return e=s?(r=(n=Q.chains.get(s))==null?void 0:n.caipNetworks)==null?void 0:r[0]:void 0,e}},getAccountData(t){var e;return t?(e=A.state.chains.get(t))==null?void 0:e.accountState:ce.state},getNetworkData(t){var n;const e=t||Q.activeChain;if(e)return(n=A.state.chains.get(e))==null?void 0:n.networkState},getCaipNetworkByNamespace(t,e){var s,i,o;if(!t)return;const n=A.state.chains.get(t),r=(s=n==null?void 0:n.caipNetworks)==null?void 0:s.find(a=>a.id===e);return r||((i=n==null?void 0:n.networkState)==null?void 0:i.caipNetwork)||((o=n==null?void 0:n.caipNetworks)==null?void 0:o[0])},getRequestedCaipNetworkIds(){const t=J.state.filterByNamespace;return(t?[Q.chains.get(t)]:Array.from(Q.chains.values())).flatMap(n=>(n==null?void 0:n.caipNetworks)||[]).map(n=>n.caipNetworkId)},getCaipNetworks(t){return t?A.getRequestedCaipNetworks(t):A.getAllRequestedCaipNetworks()},setLastConnectedSIWECaipNetwork(t){Q.lastConnectedSIWECaipNetwork=t},getLastConnectedSIWECaipNetwork(){return Q.lastConnectedSIWECaipNetwork}},A=Un(WA),VA={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},zw=oe.getBlockchainApiUrl(),ln=Xe({clientId:null,api:new Yc({baseUrl:zw,clientId:null}),supportedChains:{http:[],ws:[]}}),fe={state:ln,async get(t){const{st:e,sv:n}=fe.getSdkProperties(),r=j.state.projectId,s={...t.params||{},st:e,sv:n,projectId:r};return ln.api.get({...t,params:s})},getSdkProperties(){const{sdkType:t,sdkVersion:e}=j.state;return{st:t||"unknown",sv:e||"unknown"}},async isNetworkSupported(t){if(!t)return!1;try{ln.supportedChains.http.length||await fe.getSupportedNetworks()}catch{return!1}return ln.supportedChains.http.includes(t)},async getSupportedNetworks(){try{const t=await fe.get({path:"v1/supported-chains"});return ln.supportedChains=t,t}catch{return ln.supportedChains}},async fetchIdentity({address:t,caipNetworkId:e}){if(!await fe.isNetworkSupported(e))return{avatar:"",name:""};const r=V.getIdentityFromCacheForAddress(t);if(r)return r;const s=await fe.get({path:`/v1/identity/${t}`,params:{sender:A.state.activeCaipAddress?oe.getPlainAddress(A.state.activeCaipAddress):void 0}});return V.updateIdentityCache({address:t,identity:s,timestamp:Date.now()}),s},async fetchTransactions({account:t,cursor:e,signal:n,cache:r,chainId:s}){var o;return await fe.isNetworkSupported((o=A.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?fe.get({path:`/v1/account/${t}/history`,params:{cursor:e,chainId:s},signal:n,cache:r}):{data:[],next:void 0}},async fetchSwapQuote({amount:t,userAddress:e,from:n,to:r,gasPrice:s}){var o;return await fe.isNetworkSupported((o=A.state.activeCaipNetwork)==null?void 0:o.caipNetworkId)?fe.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:t,userAddress:e,from:n,to:r,gasPrice:s}}):{quotes:[]}},async fetchSwapTokens({chainId:t}){var n;return await fe.isNetworkSupported((n=A.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?fe.get({path:"/v1/convert/tokens",params:{chainId:t}}):{tokens:[]}},async fetchTokenPrice({addresses:t}){var n;return await fe.isNetworkSupported((n=A.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?ln.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:t,projectId:j.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]}},async fetchSwapAllowance({tokenAddress:t,userAddress:e}){var r;return await fe.isNetworkSupported((r=A.state.activeCaipNetwork)==null?void 0:r.caipNetworkId)?fe.get({path:"/v1/convert/allowance",params:{tokenAddress:t,userAddress:e},headers:{"Content-Type":"application/json"}}):{allowance:"0"}},async fetchGasPrice({chainId:t}){var s;const{st:e,sv:n}=fe.getSdkProperties();if(!await fe.isNetworkSupported((s=A.state.activeCaipNetwork)==null?void 0:s.caipNetworkId))throw new Error("Network not supported for Gas Price");return fe.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:t,st:e,sv:n}})},async generateSwapCalldata({amount:t,from:e,to:n,userAddress:r,disableEstimate:s}){var o;if(!await fe.isNetworkSupported((o=A.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return ln.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:t,eip155:{slippage:qe.CONVERT_SLIPPAGE_TOLERANCE},projectId:j.state.projectId,from:e,to:n,userAddress:r,disableEstimate:s}})},async generateApproveCalldata({from:t,to:e,userAddress:n}){var o;const{st:r,sv:s}=fe.getSdkProperties();if(!await fe.isNetworkSupported((o=A.state.activeCaipNetwork)==null?void 0:o.caipNetworkId))throw new Error("Network not supported for Swaps");return fe.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:n,from:t,to:e,st:r,sv:s}})},async getBalance(t,e,n){var l;const{st:r,sv:s}=fe.getSdkProperties();if(!await fe.isNetworkSupported((l=A.state.activeCaipNetwork)==null?void 0:l.caipNetworkId))return Pr.showError("Token Balance Unavailable"),{balances:[]};const o=`${e}:${t}`,a=V.getBalanceCacheForCaipAddress(o);if(a)return a;const c=await fe.get({path:`/v1/account/${t}/balance`,params:{currency:"usd",chainId:e,forceUpdate:n,st:r,sv:s}});return V.updateBalanceCache({caipAddress:o,balance:c,timestamp:Date.now()}),c},async lookupEnsName(t){var n;return await fe.isNetworkSupported((n=A.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?fe.get({path:`/v1/profile/account/${t}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]}},async reverseLookupEnsName({address:t}){var n;return await fe.isNetworkSupported((n=A.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?fe.get({path:`/v1/profile/reverse/${t}`,params:{sender:ce.state.address,apiVersion:"2"}}):[]},async getEnsNameSuggestions(t){var n;return await fe.isNetworkSupported((n=A.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?fe.get({path:`/v1/profile/suggestions/${t}`,params:{zone:"reown.id"}}):{suggestions:[]}},async registerEnsName({coinType:t,address:e,message:n,signature:r}){var i;return await fe.isNetworkSupported((i=A.state.activeCaipNetwork)==null?void 0:i.caipNetworkId)?ln.api.post({path:"/v1/profile/account",body:{coin_type:t,address:e,message:n,signature:r},headers:{"Content-Type":"application/json"}}):{success:!1}},async generateOnRampURL({destinationWallets:t,partnerUserId:e,defaultNetwork:n,purchaseAmount:r,paymentAmount:s}){var a;return await fe.isNetworkSupported((a=A.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)?(await ln.api.post({path:"/v1/generators/onrampurl",params:{projectId:j.state.projectId},body:{destinationWallets:t,defaultNetwork:n,partnerUserId:e,defaultExperience:"buy",presetCryptoAmount:r,presetFiatAmount:s}})).url:""},async getOnrampOptions(){var e;if(!await fe.isNetworkSupported((e=A.state.activeCaipNetwork)==null?void 0:e.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await fe.get({path:"/v1/onramp/options"})}catch{return VA}},async getOnrampQuote({purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}){var s;try{return await fe.isNetworkSupported((s=A.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?await ln.api.post({path:"/v1/onramp/quote",params:{projectId:j.state.projectId},body:{purchaseCurrency:t,paymentCurrency:e,amount:n,network:r}}):null}catch{return{networkFee:{amount:n,currency:e.id},paymentSubtotal:{amount:n,currency:e.id},paymentTotal:{amount:n,currency:e.id},purchaseAmount:{amount:n,currency:e.id},quoteId:"mocked-quote-id"}}},async getSmartSessions(t){var n;return await fe.isNetworkSupported((n=A.state.activeCaipNetwork)==null?void 0:n.caipNetworkId)?fe.get({path:`/v1/sessions/${t}`}):[]},async revokeSmartSession(t,e,n){var s;return await fe.isNetworkSupported((s=A.state.activeCaipNetwork)==null?void 0:s.caipNetworkId)?ln.api.post({path:`/v1/sessions/${t}/revoke`,params:{projectId:j.state.projectId},body:{pci:e,signature:n}}):{success:!1}},setClientId(t){ln.clientId=t,ln.api=new Yc({baseUrl:zw,clientId:t})}},GA="1.0.8";let an=class Wh extends Error{constructor(e,n={}){var o;const r=n.cause instanceof Wh?n.cause.details:(o=n.cause)!=null&&o.message?n.cause.message:n.details,s=n.cause instanceof Wh&&n.cause.docsPath||n.docsPath,i=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: https://abitype.dev${s}`]:[],...r?[`Details: ${r}`]:[],`Version: abitype@${GA}`].join(`
`);super(i),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"AbiTypeError"}),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}};function hs(t,e){const n=t.exec(e);return n==null?void 0:n.groups}const Ww=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,Vw=/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/,Gw=/^\(.+?\).*?$/,Vg=/^tuple(?<array>(\[(\d*)\])*)$/;function Vh(t){let e=t.type;if(Vg.test(t.type)&&"components"in t){e="(";const n=t.components.length;for(let s=0;s<n;s++){const i=t.components[s];e+=Vh(i),s<n-1&&(e+=", ")}const r=hs(Vg,t.type);return e+=`)${(r==null?void 0:r.array)??""}`,Vh({...t,type:e})}return"indexed"in t&&t.indexed&&(e=`${e} indexed`),t.name?`${e} ${t.name}`:e}function aa(t){let e="";const n=t.length;for(let r=0;r<n;r++){const s=t[r];e+=Vh(s),r!==n-1&&(e+=", ")}return e}function KA(t){var e;return t.type==="function"?`function ${t.name}(${aa(t.inputs)})${t.stateMutability&&t.stateMutability!=="nonpayable"?` ${t.stateMutability}`:""}${(e=t.outputs)!=null&&e.length?` returns (${aa(t.outputs)})`:""}`:t.type==="event"?`event ${t.name}(${aa(t.inputs)})`:t.type==="error"?`error ${t.name}(${aa(t.inputs)})`:t.type==="constructor"?`constructor(${aa(t.inputs)})${t.stateMutability==="payable"?" payable":""}`:t.type==="fallback"?`fallback() external${t.stateMutability==="payable"?" payable":""}`:"receive() external payable"}const Kw=/^error (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function YA(t){return Kw.test(t)}function ZA(t){return hs(Kw,t)}const Yw=/^event (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)$/;function JA(t){return Yw.test(t)}function XA(t){return hs(Yw,t)}const Zw=/^function (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*)\((?<parameters>.*?)\)(?: (?<scope>external|public{1}))?(?: (?<stateMutability>pure|view|nonpayable|payable{1}))?(?: returns\s?\((?<returns>.*?)\))?$/;function QA(t){return Zw.test(t)}function eI(t){return hs(Zw,t)}const Jw=/^struct (?<name>[a-zA-Z$_][a-zA-Z0-9$_]*) \{(?<properties>.*?)\}$/;function Xw(t){return Jw.test(t)}function tI(t){return hs(Jw,t)}const Qw=/^constructor\((?<parameters>.*?)\)(?:\s(?<stateMutability>payable{1}))?$/;function nI(t){return Qw.test(t)}function rI(t){return hs(Qw,t)}const eb=/^fallback\(\) external(?:\s(?<stateMutability>payable{1}))?$/;function sI(t){return eb.test(t)}function iI(t){return hs(eb,t)}const oI=/^receive\(\) external payable$/;function aI(t){return oI.test(t)}const wq=new Set(["memory","indexed","storage","calldata"]),cI=new Set(["indexed"]),Gh=new Set(["calldata","memory","storage"]);class bq extends an{constructor({signature:e}){super("Failed to parse ABI item.",{details:`parseAbiItem(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiitem-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiItemError"})}}class lI extends an{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type. Perhaps you forgot to include a struct signature?`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownTypeError"})}}class uI extends an{constructor({type:e}){super("Unknown type.",{metaMessages:[`Type "${e}" is not a valid ABI type.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSolidityTypeError"})}}class vq extends an{constructor({param:e}){super("Failed to parse ABI parameter.",{details:`parseAbiParameter(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameter-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParameterError"})}}class Eq extends an{constructor({params:e}){super("Failed to parse ABI parameters.",{details:`parseAbiParameters(${JSON.stringify(e,null,2)})`,docsPath:"/api/human#parseabiparameters-1"}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiParametersError"})}}class dI extends an{constructor({param:e}){super("Invalid ABI parameter.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParameterError"})}}class hI extends an{constructor({param:e,name:n}){super("Invalid ABI parameter.",{details:e,metaMessages:[`"${n}" is a protected Solidity keyword. More info: https://docs.soliditylang.org/en/latest/cheatsheet.html`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SolidityProtectedKeywordError"})}}class fI extends an{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidModifierError"})}}class pI extends an{constructor({param:e,type:n,modifier:r}){super("Invalid ABI parameter.",{details:e,metaMessages:[`Modifier "${r}" not allowed${n?` in "${n}" type`:""}.`,`Data location can only be specified for array, struct, or mapping types, but "${r}" was given.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidFunctionModifierError"})}}class gI extends an{constructor({abiParameter:e}){super("Invalid ABI parameter.",{details:JSON.stringify(e,null,2),metaMessages:["ABI parameter type is invalid."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidAbiTypeParameterError"})}}class Wo extends an{constructor({signature:e,type:n}){super(`Invalid ${n} signature.`,{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidSignatureError"})}}class mI extends an{constructor({signature:e}){super("Unknown signature.",{details:e}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"UnknownSignatureError"})}}class yI extends an{constructor({signature:e}){super("Invalid struct signature.",{details:e,metaMessages:["No properties exist."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidStructSignatureError"})}}class wI extends an{constructor({type:e}){super("Circular reference detected.",{metaMessages:[`Struct "${e}" is a circular reference.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"CircularReferenceError"})}}class bI extends an{constructor({current:e,depth:n}){super("Unbalanced parentheses.",{metaMessages:[`"${e.trim()}" has too many ${n>0?"opening":"closing"} parentheses.`],details:`Depth "${n}"`}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidParenthesisError"})}}function vI(t,e,n){let r="";if(n)for(const s of Object.entries(n)){if(!s)continue;let i="";for(const o of s[1])i+=`[${o.type}${o.name?`:${o.name}`:""}]`;r+=`(${s[0]}{${i}})`}return e?`${e}:${t}${r}`:t}const Ld=new Map([["address",{type:"address"}],["bool",{type:"bool"}],["bytes",{type:"bytes"}],["bytes32",{type:"bytes32"}],["int",{type:"int256"}],["int256",{type:"int256"}],["string",{type:"string"}],["uint",{type:"uint256"}],["uint8",{type:"uint8"}],["uint16",{type:"uint16"}],["uint24",{type:"uint24"}],["uint32",{type:"uint32"}],["uint64",{type:"uint64"}],["uint96",{type:"uint96"}],["uint112",{type:"uint112"}],["uint160",{type:"uint160"}],["uint192",{type:"uint192"}],["uint256",{type:"uint256"}],["address owner",{type:"address",name:"owner"}],["address to",{type:"address",name:"to"}],["bool approved",{type:"bool",name:"approved"}],["bytes _data",{type:"bytes",name:"_data"}],["bytes data",{type:"bytes",name:"data"}],["bytes signature",{type:"bytes",name:"signature"}],["bytes32 hash",{type:"bytes32",name:"hash"}],["bytes32 r",{type:"bytes32",name:"r"}],["bytes32 root",{type:"bytes32",name:"root"}],["bytes32 s",{type:"bytes32",name:"s"}],["string name",{type:"string",name:"name"}],["string symbol",{type:"string",name:"symbol"}],["string tokenURI",{type:"string",name:"tokenURI"}],["uint tokenId",{type:"uint256",name:"tokenId"}],["uint8 v",{type:"uint8",name:"v"}],["uint256 balance",{type:"uint256",name:"balance"}],["uint256 tokenId",{type:"uint256",name:"tokenId"}],["uint256 value",{type:"uint256",name:"value"}],["event:address indexed from",{type:"address",name:"from",indexed:!0}],["event:address indexed to",{type:"address",name:"to",indexed:!0}],["event:uint indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}],["event:uint256 indexed tokenId",{type:"uint256",name:"tokenId",indexed:!0}]]);function EI(t,e={}){if(QA(t))return CI(t,e);if(JA(t))return _I(t,e);if(YA(t))return AI(t,e);if(nI(t))return II(t,e);if(sI(t))return SI(t);if(aI(t))return{type:"receive",stateMutability:"payable"};throw new mI({signature:t})}function CI(t,e={}){const n=eI(t);if(!n)throw new Wo({signature:t,type:"function"});const r=cr(n.parameters),s=[],i=r.length;for(let a=0;a<i;a++)s.push(Pi(r[a],{modifiers:Gh,structs:e,type:"function"}));const o=[];if(n.returns){const a=cr(n.returns),c=a.length;for(let l=0;l<c;l++)o.push(Pi(a[l],{modifiers:Gh,structs:e,type:"function"}))}return{name:n.name,type:"function",stateMutability:n.stateMutability??"nonpayable",inputs:s,outputs:o}}function _I(t,e={}){const n=XA(t);if(!n)throw new Wo({signature:t,type:"event"});const r=cr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(Pi(r[o],{modifiers:cI,structs:e,type:"event"}));return{name:n.name,type:"event",inputs:s}}function AI(t,e={}){const n=ZA(t);if(!n)throw new Wo({signature:t,type:"error"});const r=cr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(Pi(r[o],{structs:e,type:"error"}));return{name:n.name,type:"error",inputs:s}}function II(t,e={}){const n=rI(t);if(!n)throw new Wo({signature:t,type:"constructor"});const r=cr(n.parameters),s=[],i=r.length;for(let o=0;o<i;o++)s.push(Pi(r[o],{structs:e,type:"constructor"}));return{type:"constructor",stateMutability:n.stateMutability??"nonpayable",inputs:s}}function SI(t){const e=iI(t);if(!e)throw new Wo({signature:t,type:"fallback"});return{type:"fallback",stateMutability:e.stateMutability??"nonpayable"}}const NI=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,xI=/^\((?<type>.+?)\)(?<array>(?:\[\d*?\])+?)?(?:\s(?<modifier>calldata|indexed|memory|storage{1}))?(?:\s(?<name>[a-zA-Z$_][a-zA-Z0-9$_]*))?$/,TI=/^u?int$/;function Pi(t,e){var d,h;const n=vI(t,e==null?void 0:e.type,e==null?void 0:e.structs);if(Ld.has(n))return Ld.get(n);const r=Gw.test(t),s=hs(r?xI:NI,t);if(!s)throw new dI({param:t});if(s.name&&OI(s.name))throw new hI({param:t,name:s.name});const i=s.name?{name:s.name}:{},o=s.modifier==="indexed"?{indexed:!0}:{},a=(e==null?void 0:e.structs)??{};let c,l={};if(r){c="tuple";const f=cr(s.type),p=[],g=f.length;for(let m=0;m<g;m++)p.push(Pi(f[m],{structs:a}));l={components:p}}else if(s.type in a)c="tuple",l={components:a[s.type]};else if(TI.test(s.type))c=`${s.type}256`;else if(c=s.type,(e==null?void 0:e.type)!=="struct"&&!tb(c))throw new uI({type:c});if(s.modifier){if(!((h=(d=e==null?void 0:e.modifiers)==null?void 0:d.has)!=null&&h.call(d,s.modifier)))throw new fI({param:t,type:e==null?void 0:e.type,modifier:s.modifier});if(Gh.has(s.modifier)&&!RI(c,!!s.array))throw new pI({param:t,type:e==null?void 0:e.type,modifier:s.modifier})}const u={type:`${c}${s.array??""}`,...i,...o,...l};return Ld.set(n,u),u}function cr(t,e=[],n="",r=0){const s=t.trim().length;for(let i=0;i<s;i++){const o=t[i],a=t.slice(i+1);switch(o){case",":return r===0?cr(a,[...e,n.trim()]):cr(a,e,`${n}${o}`,r);case"(":return cr(a,e,`${n}${o}`,r+1);case")":return cr(a,e,`${n}${o}`,r-1);default:return cr(a,e,`${n}${o}`,r)}}if(n==="")return e;if(r!==0)throw new bI({current:n,depth:r});return e.push(n.trim()),e}function tb(t){return t==="address"||t==="bool"||t==="function"||t==="string"||Ww.test(t)||Vw.test(t)}const PI=/^(?:after|alias|anonymous|apply|auto|byte|calldata|case|catch|constant|copyof|default|defined|error|event|external|false|final|function|immutable|implements|in|indexed|inline|internal|let|mapping|match|memory|mutable|null|of|override|partial|private|promise|public|pure|reference|relocatable|return|returns|sizeof|static|storage|struct|super|supports|switch|this|true|try|typedef|typeof|var|view|virtual)$/;function OI(t){return t==="address"||t==="bool"||t==="function"||t==="string"||t==="tuple"||Ww.test(t)||Vw.test(t)||PI.test(t)}function RI(t,e){return e||t==="bytes"||t==="string"||t==="tuple"}function DI(t){const e={},n=t.length;for(let o=0;o<n;o++){const a=t[o];if(!Xw(a))continue;const c=tI(a);if(!c)throw new Wo({signature:a,type:"struct"});const l=c.properties.split(";"),u=[],d=l.length;for(let h=0;h<d;h++){const p=l[h].trim();if(!p)continue;const g=Pi(p,{type:"struct"});u.push(g)}if(!u.length)throw new yI({signature:a});e[c.name]=u}const r={},s=Object.entries(e),i=s.length;for(let o=0;o<i;o++){const[a,c]=s[o];r[a]=nb(c,e)}return r}const $I=/^(?<type>[a-zA-Z$_][a-zA-Z0-9$_]*)(?<array>(?:\[\d*?\])+?)?$/;function nb(t,e,n=new Set){const r=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];if(Gw.test(o.type))r.push(o);else{const c=hs($I,o.type);if(!(c!=null&&c.type))throw new gI({abiParameter:o});const{array:l,type:u}=c;if(u in e){if(n.has(u))throw new wI({type:u});r.push({...o,type:`tuple${l??""}`,components:nb(e[u]??[],e,new Set([...n,u]))})}else if(tb(u))r.push(o);else throw new lI({type:u})}}return r}function rb(t){const e=DI(t),n=[],r=t.length;for(let s=0;s<r;s++){const i=t[s];Xw(i)||n.push(EI(i,e))}return n}function lt(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}function Ks(t,{includeName:e=!1}={}){if(t.type!=="function"&&t.type!=="event"&&t.type!=="error")throw new VI(t.type);return`${t.name}(${Vu(t.inputs,{includeName:e})})`}function Vu(t,{includeName:e=!1}={}){return t?t.map(n=>kI(n,{includeName:e})).join(e?", ":","):""}function kI(t,{includeName:e}){return t.type.startsWith("tuple")?`(${Vu(t.components,{includeName:e})})${t.type.slice(5)}`:t.type+(e&&t.name?` ${t.name}`:"")}function Ys(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function _t(t){return Ys(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const sb="2.32.0";let ca={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${sb}`},z=class Kh extends Error{constructor(e,n={}){var a;const r=(()=>{var c;return n.cause instanceof Kh?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof Kh&&n.cause.docsPath||n.docsPath,i=(a=ca.getDocsUrl)==null?void 0:a.call(ca,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...ca.version?[`Version: ${ca.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=sb}walk(e){return ib(this,e)}};function ib(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?ib(t.cause,e):e?null:t}class UI extends z{constructor({docsPath:e}){super(["A constructor was not found on the ABI.","Make sure you are using the correct ABI and that the constructor exists on it."].join(`
`),{docsPath:e,name:"AbiConstructorNotFoundError"})}}class Gg extends z{constructor({docsPath:e}){super(["Constructor arguments were provided (`args`), but a constructor parameters (`inputs`) were not found on the ABI.","Make sure you are using the correct ABI, and that the `inputs` attribute on the constructor exists."].join(`
`),{docsPath:e,name:"AbiConstructorParamsNotFoundError"})}}class ob extends z{constructor({data:e,params:n,size:r}){super([`Data size of ${r} bytes is too small for given parameters.`].join(`
`),{metaMessages:[`Params: (${Vu(n,{includeName:!0})})`,`Data:   ${e} (${r} bytes)`],name:"AbiDecodingDataSizeTooSmallError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e,this.params=n,this.size=r}}class Gu extends z{constructor(){super('Cannot decode zero data ("0x") with ABI parameters.',{name:"AbiDecodingZeroDataError"})}}class LI extends z{constructor({expectedLength:e,givenLength:n,type:r}){super([`ABI encoding array length mismatch for type ${r}.`,`Expected length: ${e}`,`Given length: ${n}`].join(`
`),{name:"AbiEncodingArrayLengthMismatchError"})}}class MI extends z{constructor({expectedSize:e,value:n}){super(`Size of bytes "${n}" (bytes${_t(n)}) does not match expected size (bytes${e}).`,{name:"AbiEncodingBytesSizeMismatchError"})}}class BI extends z{constructor({expectedLength:e,givenLength:n}){super(["ABI encoding params/values length mismatch.",`Expected length (params): ${e}`,`Given length (values): ${n}`].join(`
`),{name:"AbiEncodingLengthMismatchError"})}}class Cq extends z{constructor(e,{docsPath:n}){super([`Arguments (\`args\`) were provided to "${e}", but "${e}" on the ABI does not contain any parameters (\`inputs\`).`,"Cannot encode error result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the inputs exist on it."].join(`
`),{docsPath:n,name:"AbiErrorInputsNotFoundError"})}}class _q extends z{constructor(e,{docsPath:n}={}){super([`Error ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it."].join(`
`),{docsPath:n,name:"AbiErrorNotFoundError"})}}class ab extends z{constructor(e,{docsPath:n}){super([`Encoded error signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiErrorSignatureNotFoundError"}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.signature=e}}class FI extends z{constructor({docsPath:e}){super("Cannot extract event signature from empty topics.",{docsPath:e,name:"AbiEventSignatureEmptyTopicsError"})}}class cb extends z{constructor(e,{docsPath:n}){super([`Encoded event signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiEventSignatureNotFoundError"})}}class Aq extends z{constructor(e,{docsPath:n}={}){super([`Event ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the event exists on it."].join(`
`),{docsPath:n,name:"AbiEventNotFoundError"})}}class fu extends z{constructor(e,{docsPath:n}={}){super([`Function ${e?`"${e}" `:""}not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionNotFoundError"})}}class jI extends z{constructor(e,{docsPath:n}){super([`Function "${e}" does not contain any \`outputs\` on ABI.`,"Cannot decode function result without knowing what the parameter types are.","Make sure you are using the correct ABI and that the function exists on it."].join(`
`),{docsPath:n,name:"AbiFunctionOutputsNotFoundError"})}}class Iq extends z{constructor(e,{docsPath:n}){super([`Encoded function signature "${e}" not found on ABI.`,"Make sure you are using the correct ABI and that the function exists on it.",`You can look up the signature here: https://openchain.xyz/signatures?query=${e}.`].join(`
`),{docsPath:n,name:"AbiFunctionSignatureNotFoundError"})}}class HI extends z{constructor(e,n){super("Found ambiguous types in overloaded ABI items.",{metaMessages:[`\`${e.type}\` in \`${Ks(e.abiItem)}\`, and`,`\`${n.type}\` in \`${Ks(n.abiItem)}\``,"","These types encode differently and cannot be distinguished at runtime.","Remove one of the ambiguous items in the ABI."],name:"AbiItemAmbiguityError"})}}class Sq extends z{constructor({expectedSize:e,givenSize:n}){super(`Expected bytes${e}, got bytes${n}.`,{name:"BytesSizeMismatchError"})}}class Yh extends z{constructor({abiItem:e,data:n,params:r,size:s}){super([`Data size of ${s} bytes is too small for non-indexed event parameters.`].join(`
`),{metaMessages:[`Params: (${Vu(r,{includeName:!0})})`,`Data:   ${n} (${s} bytes)`],name:"DecodeLogDataMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"params",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"size",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e,this.data=n,this.params=r,this.size=s}}class lb extends z{constructor({abiItem:e,param:n}){super([`Expected a topic for indexed event parameter${n.name?` "${n.name}"`:""} on event "${Ks(e,{includeName:!0})}".`].join(`
`),{name:"DecodeLogTopicsMismatch"}),Object.defineProperty(this,"abiItem",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abiItem=e}}class qI extends z{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid encoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiEncodingType"})}}class zI extends z{constructor(e,{docsPath:n}){super([`Type "${e}" is not a valid decoding type.`,"Please provide a valid ABI type."].join(`
`),{docsPath:n,name:"InvalidAbiDecodingType"})}}class WI extends z{constructor(e){super([`Value "${e}" is not a valid array.`].join(`
`),{name:"InvalidArrayError"})}}class VI extends z{constructor(e){super([`"${e}" is not a valid definition type.`,'Valid types: "function", "event", "error"'].join(`
`),{name:"InvalidDefinitionTypeError"})}}class Nq extends z{constructor(e){super(`Type "${e}" is not supported for packed encoding.`,{name:"UnsupportedPackedAbiType"})}}class ub extends z{constructor({offset:e,position:n,size:r}){super(`Slice ${n==="start"?"starting":"ending"} at offset "${e}" is out-of-bounds (size: ${r}).`,{name:"SliceOffsetOutOfBoundsError"})}}let db=class extends z{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}};class Kg extends z{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} is expected to be ${n} ${r} long, but is ${e} ${r} long.`,{name:"InvalidBytesLengthError"})}}function Vo(t,{dir:e,size:n=32}={}){return typeof t=="string"?Bs(t,{dir:e,size:n}):GI(t,{dir:e,size:n})}function Bs(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new db({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function GI(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new db({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}let hb=class extends z{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}};class KI extends z{constructor(e){super(`Bytes value "${e}" is not a valid boolean. The bytes array must contain a single byte of either a 0 or 1 value.`,{name:"InvalidBytesBooleanError"})}}class YI extends z{constructor(e){super(`Hex value "${e}" is not a valid boolean. The hex value must be "0x0" (false) or "0x1" (true).`,{name:"InvalidHexBooleanError"})}}let ZI=class extends z{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}};function Fs(t,{dir:e="left"}={}){let n=typeof t=="string"?t.replace("0x",""):t,r=0;for(let s=0;s<n.length-1&&n[e==="left"?s:n.length-s-1].toString()==="0";s++)r++;return n=e==="left"?n.slice(r):n.slice(0,n.length-r),typeof t=="string"?(n.length===1&&e==="right"&&(n=`${n}0`),`0x${n.length%2===1?`0${n}`:n}`):n}function Jn(t,{size:e}){if(_t(t)>e)throw new ZI({givenSize:_t(t),maxSize:e})}function $o(t,e={}){const{signed:n}=e;e.size&&Jn(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function Oq(t,e={}){let n=t;if(e.size&&(Jn(n,{size:e.size}),n=Fs(n)),Fs(n)==="0x00")return!1;if(Fs(n)==="0x01")return!0;throw new YI(n)}function Oi(t,e={}){return Number($o(t,e))}function fb(t,e={}){let n=Ur(t);return e.size&&(Jn(n,{size:e.size}),n=Fs(n,{dir:"right"})),new TextDecoder().decode(n)}const JI=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ko(t,e={}){return typeof t=="number"||typeof t=="bigint"?Ne(t,e):typeof t=="string"?Ku(t,e):typeof t=="boolean"?pb(t,e):_n(t,e)}function pb(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Jn(n,{size:e.size}),Vo(n,{size:e.size})):n}function _n(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=JI[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Jn(r,{size:e.size}),Vo(r,{dir:"right",size:e.size})):r}function Ne(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new hb({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Vo(a,{size:r}):a}const XI=new TextEncoder;function Ku(t,e={}){const n=XI.encode(t);return _n(n,e)}const QI=new TextEncoder;function Yu(t,e={}){return typeof t=="number"||typeof t=="bigint"?t2(t,e):typeof t=="boolean"?e2(t,e):Ys(t)?Ur(t,e):gb(t,e)}function e2(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Jn(n,{size:e.size}),Vo(n,{size:e.size})):n}const Wr={zero:48,nine:57,A:65,F:70,a:97,f:102};function Yg(t){if(t>=Wr.zero&&t<=Wr.nine)return t-Wr.zero;if(t>=Wr.A&&t<=Wr.F)return t-(Wr.A-10);if(t>=Wr.a&&t<=Wr.f)return t-(Wr.a-10)}function Ur(t,e={}){let n=t;e.size&&(Jn(n,{size:e.size}),n=Vo(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=Yg(r.charCodeAt(a++)),l=Yg(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new z(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function t2(t,e){const n=Ne(t,e);return Ur(n)}function gb(t,e={}){const n=QI.encode(t);return typeof e.size=="number"?(Jn(n,{size:e.size}),Vo(n,{dir:"right",size:e.size})):n}var at={},be={};Object.defineProperty(be,"__esModule",{value:!0});be.toBig=be.shrSL=be.shrSH=be.rotrSL=be.rotrSH=be.rotrBL=be.rotrBH=be.rotr32L=be.rotr32H=be.rotlSL=be.rotlSH=be.rotlBL=be.rotlBH=be.add5L=be.add5H=be.add4L=be.add4H=be.add3L=be.add3H=void 0;be.add=Pb;be.fromBig=mp;be.split=mb;const yl=BigInt(2**32-1),Zh=BigInt(32);function mp(t,e=!1){return e?{h:Number(t&yl),l:Number(t>>Zh&yl)}:{h:Number(t>>Zh&yl)|0,l:Number(t&yl)|0}}function mb(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=mp(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const yb=(t,e)=>BigInt(t>>>0)<<Zh|BigInt(e>>>0);be.toBig=yb;const wb=(t,e,n)=>t>>>n;be.shrSH=wb;const bb=(t,e,n)=>t<<32-n|e>>>n;be.shrSL=bb;const vb=(t,e,n)=>t>>>n|e<<32-n;be.rotrSH=vb;const Eb=(t,e,n)=>t<<32-n|e>>>n;be.rotrSL=Eb;const Cb=(t,e,n)=>t<<64-n|e>>>n-32;be.rotrBH=Cb;const _b=(t,e,n)=>t>>>n-32|e<<64-n;be.rotrBL=_b;const Ab=(t,e)=>e;be.rotr32H=Ab;const Ib=(t,e)=>t;be.rotr32L=Ib;const Sb=(t,e,n)=>t<<n|e>>>32-n;be.rotlSH=Sb;const Nb=(t,e,n)=>e<<n|t>>>32-n;be.rotlSL=Nb;const xb=(t,e,n)=>e<<n-32|t>>>64-n;be.rotlBH=xb;const Tb=(t,e,n)=>t<<n-32|e>>>64-n;be.rotlBL=Tb;function Pb(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const Ob=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0);be.add3L=Ob;const Rb=(t,e,n,r)=>e+n+r+(t/2**32|0)|0;be.add3H=Rb;const Db=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0);be.add4L=Db;const $b=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0;be.add4H=$b;const kb=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0);be.add5L=kb;const Ub=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0;be.add5H=Ub;const n2={fromBig:mp,split:mb,toBig:yb,shrSH:wb,shrSL:bb,rotrSH:vb,rotrSL:Eb,rotrBH:Cb,rotrBL:_b,rotr32H:Ab,rotr32L:Ib,rotlSH:Sb,rotlSL:Nb,rotlBH:xb,rotlBL:Tb,add:Pb,add3L:Ob,add3H:Rb,add4L:Db,add4H:$b,add5H:Ub,add5L:kb};be.default=n2;var Zu={},Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.crypto=void 0;Ju.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;(function(t){/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */Object.defineProperty(t,"__esModule",{value:!0}),t.wrapXOFConstructorWithOpts=t.wrapConstructorWithOpts=t.wrapConstructor=t.Hash=t.nextTick=t.swap32IfBE=t.byteSwapIfBE=t.swap8IfBE=t.isLE=void 0,t.isBytes=n,t.anumber=r,t.abytes=s,t.ahash=i,t.aexists=o,t.aoutput=a,t.u8=c,t.u32=l,t.clean=u,t.createView=d,t.rotr=h,t.rotl=f,t.byteSwap=p,t.byteSwap32=g,t.bytesToHex=b,t.hexToBytes=_,t.asyncLoop=x,t.utf8ToBytes=D,t.bytesToUtf8=I,t.toBytes=U,t.kdfInputToBytes=R,t.concatBytes=k,t.checkOpts=M,t.createHasher=E,t.createOptHasher=S,t.createXOFer=O,t.randomBytes=$;const e=Ju;function n(C){return C instanceof Uint8Array||ArrayBuffer.isView(C)&&C.constructor.name==="Uint8Array"}function r(C){if(!Number.isSafeInteger(C)||C<0)throw new Error("positive integer expected, got "+C)}function s(C,...P){if(!n(C))throw new Error("Uint8Array expected");if(P.length>0&&!P.includes(C.length))throw new Error("Uint8Array expected of length "+P+", got length="+C.length)}function i(C){if(typeof C!="function"||typeof C.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");r(C.outputLen),r(C.blockLen)}function o(C,P=!0){if(C.destroyed)throw new Error("Hash instance has been destroyed");if(P&&C.finished)throw new Error("Hash#digest() has already been called")}function a(C,P){s(C);const B=P.outputLen;if(C.length<B)throw new Error("digestInto() expects output buffer of length at least "+B)}function c(C){return new Uint8Array(C.buffer,C.byteOffset,C.byteLength)}function l(C){return new Uint32Array(C.buffer,C.byteOffset,Math.floor(C.byteLength/4))}function u(...C){for(let P=0;P<C.length;P++)C[P].fill(0)}function d(C){return new DataView(C.buffer,C.byteOffset,C.byteLength)}function h(C,P){return C<<32-P|C>>>P}function f(C,P){return C<<P|C>>>32-P>>>0}t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function p(C){return C<<24&4278190080|C<<8&16711680|C>>>8&65280|C>>>24&255}t.swap8IfBE=t.isLE?C=>C:C=>p(C),t.byteSwapIfBE=t.swap8IfBE;function g(C){for(let P=0;P<C.length;P++)C[P]=p(C[P]);return C}t.swap32IfBE=t.isLE?C=>C:g;const m=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",v=Array.from({length:256},(C,P)=>P.toString(16).padStart(2,"0"));function b(C){if(s(C),m)return C.toHex();let P="";for(let B=0;B<C.length;B++)P+=v[C[B]];return P}const y={_0:48,_9:57,A:65,F:70,a:97,f:102};function N(C){if(C>=y._0&&C<=y._9)return C-y._0;if(C>=y.A&&C<=y.F)return C-(y.A-10);if(C>=y.a&&C<=y.f)return C-(y.a-10)}function _(C){if(typeof C!="string")throw new Error("hex string expected, got "+typeof C);if(m)return Uint8Array.fromHex(C);const P=C.length,B=P/2;if(P%2)throw new Error("hex string expected, got unpadded hex of length "+P);const H=new Uint8Array(B);for(let G=0,W=0;G<B;G++,W+=2){const se=N(C.charCodeAt(W)),ue=N(C.charCodeAt(W+1));if(se===void 0||ue===void 0){const De=C[W]+C[W+1];throw new Error('hex string expected, got non-hex character "'+De+'" at index '+W)}H[G]=se*16+ue}return H}const T=async()=>{};t.nextTick=T;async function x(C,P,B){let H=Date.now();for(let G=0;G<C;G++){B(G);const W=Date.now()-H;W>=0&&W<P||(await(0,t.nextTick)(),H+=W)}}function D(C){if(typeof C!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(C))}function I(C){return new TextDecoder().decode(C)}function U(C){return typeof C=="string"&&(C=D(C)),s(C),C}function R(C){return typeof C=="string"&&(C=D(C)),s(C),C}function k(...C){let P=0;for(let H=0;H<C.length;H++){const G=C[H];s(G),P+=G.length}const B=new Uint8Array(P);for(let H=0,G=0;H<C.length;H++){const W=C[H];B.set(W,G),G+=W.length}return B}function M(C,P){if(P!==void 0&&{}.toString.call(P)!=="[object Object]")throw new Error("options should be object or undefined");return Object.assign(C,P)}class F{}t.Hash=F;function E(C){const P=H=>C().update(U(H)).digest(),B=C();return P.outputLen=B.outputLen,P.blockLen=B.blockLen,P.create=()=>C(),P}function S(C){const P=(H,G)=>C(G).update(U(H)).digest(),B=C({});return P.outputLen=B.outputLen,P.blockLen=B.blockLen,P.create=H=>C(H),P}function O(C){const P=(H,G)=>C(G).update(U(H)).digest(),B=C({});return P.outputLen=B.outputLen,P.blockLen=B.blockLen,P.create=H=>C(H),P}t.wrapConstructor=E,t.wrapConstructorWithOpts=S,t.wrapXOFConstructorWithOpts=O;function $(C=32){if(e.crypto&&typeof e.crypto.getRandomValues=="function")return e.crypto.getRandomValues(new Uint8Array(C));if(e.crypto&&typeof e.crypto.randomBytes=="function")return Uint8Array.from(e.crypto.randomBytes(C));throw new Error("crypto.getRandomValues must be defined")}})(Zu);Object.defineProperty(at,"__esModule",{value:!0});at.shake256=at.shake128=at.keccak_512=at.keccak_384=qb=at.keccak_256=at.keccak_224=at.sha3_512=at.sha3_384=at.sha3_256=at.sha3_224=at.Keccak=void 0;at.keccakP=jb;const tc=be,Xt=Zu,r2=BigInt(0),la=BigInt(1),s2=BigInt(2),i2=BigInt(7),o2=BigInt(256),a2=BigInt(113),Lb=[],Mb=[],Bb=[];for(let t=0,e=la,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],Lb.push(2*(5*r+n)),Mb.push((t+1)*(t+2)/2%64);let s=r2;for(let i=0;i<7;i++)e=(e<<la^(e>>i2)*a2)%o2,e&s2&&(s^=la<<(la<<BigInt(i))-la);Bb.push(s)}const Fb=(0,tc.split)(Bb,!0),c2=Fb[0],l2=Fb[1],Zg=(t,e,n)=>n>32?(0,tc.rotlBH)(t,e,n):(0,tc.rotlSH)(t,e,n),Jg=(t,e,n)=>n>32?(0,tc.rotlBL)(t,e,n):(0,tc.rotlSL)(t,e,n);function jb(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=Zg(l,u,1)^n[a],h=Jg(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=Mb[o],c=Zg(s,i,a),l=Jg(s,i,a),u=Lb[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=c2[r],t[1]^=l2[r]}(0,Xt.clean)(n)}let yp=class Hb extends Xt.Hash{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,(0,Xt.anumber)(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,Xt.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,Xt.swap32IfBE)(this.state32),jb(this.state32,this.rounds),(0,Xt.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(e){(0,Xt.aexists)(this),e=(0,Xt.toBytes)(e),(0,Xt.abytes)(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){(0,Xt.aexists)(this,!1),(0,Xt.abytes)(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,Xt.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,Xt.aoutput)(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,Xt.clean)(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Hb(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};at.Keccak=yp;const ei=(t,e,n)=>(0,Xt.createHasher)(()=>new yp(e,t,n));at.sha3_224=ei(6,144,224/8);at.sha3_256=ei(6,136,256/8);at.sha3_384=ei(6,104,384/8);at.sha3_512=ei(6,72,512/8);at.keccak_224=ei(1,144,224/8);var qb=at.keccak_256=ei(1,136,256/8);at.keccak_384=ei(1,104,384/8);at.keccak_512=ei(1,72,512/8);const zb=(t,e,n)=>(0,Xt.createXOFer)((r={})=>new yp(e,t,r.dkLen===void 0?n:r.dkLen,!0));at.shake128=zb(31,168,128/8);at.shake256=zb(31,136,256/8);function Zc(t,e){const n=e||"hex",r=qb(Ys(t,{strict:!1})?Yu(t):t);return n==="bytes"?r:ko(r)}const u2=t=>Zc(Yu(t));function d2(t){return u2(t)}function h2(t){let e=!0,n="",r=0,s="",i=!1;for(let o=0;o<t.length;o++){const a=t[o];if(["(",")",","].includes(a)&&(e=!0),a==="("&&r++,a===")"&&r--,!!e){if(r===0){if(a===" "&&["event","function",""].includes(s))s="";else if(s+=a,a===")"){i=!0;break}continue}if(a===" "){t[o-1]!==","&&n!==","&&n!==",("&&(n="",e=!1);continue}s+=a,n+=a}}if(!i)throw new z("Unable to normalize signature.");return s}const f2=t=>{const e=typeof t=="string"?t:KA(t);return h2(e)};function Wb(t){return d2(f2(t))}const wp=Wb;class Ri extends z{constructor({address:e}){super(`Address "${e}" is invalid.`,{metaMessages:["- Address must be a hex value of 20 bytes (40 hex characters).","- Address must match its checksum counterpart."],name:"InvalidAddressError"})}}let Xu=class extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}};const Md=new Xu(8192);function Qu(t,e){if(Md.has(`${t}.${e}`))return Md.get(`${t}.${e}`);const n=e?`${e}${t.toLowerCase()}`:t.substring(2).toLowerCase(),r=Zc(gb(n),"bytes"),s=(e?n.substring(`${e}0x`.length):n).split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return Md.set(`${t}.${e}`,i),i}function mi(t,e){if(!Lr(t,{strict:!1}))throw new Ri({address:t});return Qu(t,e)}const p2=/^0x[a-fA-F0-9]{40}$/,Bd=new Xu(8192);function Lr(t,e){const{strict:n=!0}=e??{},r=`${t}.${n}`;if(Bd.has(r))return Bd.get(r);const s=p2.test(t)?t.toLowerCase()===t?!0:n?Qu(t)===t:!0:!1;return Bd.set(r,s),s}function Uo(t){return typeof t[0]=="string"?ed(t):g2(t)}function g2(t){let e=0;for(const s of t)e+=s.length;const n=new Uint8Array(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return n}function ed(t){return`0x${t.reduce((e,n)=>e+n.replace("0x",""),"")}`}function pu(t,e,n,{strict:r}={}){return Ys(t,{strict:!1})?m2(t,e,n,{strict:r}):Kb(t,e,n,{strict:r})}function Vb(t,e){if(typeof e=="number"&&e>0&&e>_t(t)-1)throw new ub({offset:e,position:"start",size:_t(t)})}function Gb(t,e,n){if(typeof e=="number"&&typeof n=="number"&&_t(t)!==n-e)throw new ub({offset:n,position:"end",size:_t(t)})}function Kb(t,e,n,{strict:r}={}){Vb(t,e);const s=t.slice(e,n);return r&&Gb(s,e,n),s}function m2(t,e,n,{strict:r}={}){Vb(t,e);const s=`0x${t.replace("0x","").slice((e??0)*2,(n??t.length)*2)}`;return r&&Gb(s,e,n),s}const Dq=/^(.*)\[([0-9]*)\]$/,$q=/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/,y2=/^(u?int)(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/;function Yb(t,e){if(t.length!==e.length)throw new BI({expectedLength:t.length,givenLength:e.length});const n=w2({params:t,values:e}),r=vp(n);return r.length===0?"0x":r}function w2({params:t,values:e}){const n=[];for(let r=0;r<t.length;r++)n.push(bp({param:t[r],value:e[r]}));return n}function bp({param:t,value:e}){const n=Ep(t.type);if(n){const[r,s]=n;return v2(e,{length:r,param:{...t,type:s}})}if(t.type==="tuple")return I2(e,{param:t});if(t.type==="address")return b2(e);if(t.type==="bool")return C2(e);if(t.type.startsWith("uint")||t.type.startsWith("int")){const r=t.type.startsWith("int"),[,,s="256"]=y2.exec(t.type)??[];return _2(e,{signed:r,size:Number(s)})}if(t.type.startsWith("bytes"))return E2(e,{param:t});if(t.type==="string")return A2(e);throw new qI(t.type,{docsPath:"/docs/contract/encodeAbiParameters"})}function vp(t){let e=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?e+=32:e+=_t(a)}const n=[],r=[];let s=0;for(let i=0;i<t.length;i++){const{dynamic:o,encoded:a}=t[i];o?(n.push(Ne(e+s,{size:32})),r.push(a),s+=_t(a)):n.push(a)}return Uo([...n,...r])}function b2(t){if(!Lr(t))throw new Ri({address:t});return{dynamic:!1,encoded:Bs(t.toLowerCase())}}function v2(t,{length:e,param:n}){const r=e===null;if(!Array.isArray(t))throw new WI(t);if(!r&&t.length!==e)throw new LI({expectedLength:e,givenLength:t.length,type:`${n.type}[${e}]`});let s=!1;const i=[];for(let o=0;o<t.length;o++){const a=bp({param:n,value:t[o]});a.dynamic&&(s=!0),i.push(a)}if(r||s){const o=vp(i);if(r){const a=Ne(i.length,{size:32});return{dynamic:!0,encoded:i.length>0?Uo([a,o]):a}}if(s)return{dynamic:!0,encoded:o}}return{dynamic:!1,encoded:Uo(i.map(({encoded:o})=>o))}}function E2(t,{param:e}){const[,n]=e.type.split("bytes"),r=_t(t);if(!n){let s=t;return r%32!==0&&(s=Bs(s,{dir:"right",size:Math.ceil((t.length-2)/2/32)*32})),{dynamic:!0,encoded:Uo([Bs(Ne(r,{size:32})),s])}}if(r!==Number.parseInt(n))throw new MI({expectedSize:Number.parseInt(n),value:t});return{dynamic:!1,encoded:Bs(t,{dir:"right"})}}function C2(t){if(typeof t!="boolean")throw new z(`Invalid boolean value: "${t}" (type: ${typeof t}). Expected: \`true\` or \`false\`.`);return{dynamic:!1,encoded:Bs(pb(t))}}function _2(t,{signed:e,size:n=256}){if(typeof n=="number"){const r=2n**(BigInt(n)-(e?1n:0n))-1n,s=e?-r-1n:0n;if(t>r||t<s)throw new hb({max:r.toString(),min:s.toString(),signed:e,size:n/8,value:t.toString()})}return{dynamic:!1,encoded:Ne(t,{size:32,signed:e})}}function A2(t){const e=Ku(t),n=Math.ceil(_t(e)/32),r=[];for(let s=0;s<n;s++)r.push(Bs(pu(e,s*32,(s+1)*32),{dir:"right"}));return{dynamic:!0,encoded:Uo([Bs(Ne(_t(e),{size:32})),...r])}}function I2(t,{param:e}){let n=!1;const r=[];for(let s=0;s<e.components.length;s++){const i=e.components[s],o=Array.isArray(t)?s:i.name,a=bp({param:i,value:t[o]});r.push(a),a.dynamic&&(n=!0)}return{dynamic:n,encoded:n?vp(r):Uo(r.map(({encoded:s})=>s))}}function Ep(t){const e=t.match(/^(.*)\[(\d+)?\]$/);return e?[e[2]?Number(e[2]):null,e[1]]:void 0}const Cp=t=>pu(Wb(t),0,4);function _p(t){const{abi:e,args:n=[],name:r}=t,s=Ys(r,{strict:!1}),i=e.filter(a=>s?a.type==="function"?Cp(a)===r:a.type==="event"?wp(a)===r:!1:"name"in a&&a.name===r);if(i.length===0)return;if(i.length===1)return i[0];let o;for(const a of i){if(!("inputs"in a))continue;if(!n||n.length===0){if(!a.inputs||a.inputs.length===0)return a;continue}if(!a.inputs||a.inputs.length===0||a.inputs.length!==n.length)continue;if(n.every((l,u)=>{const d="inputs"in a&&a.inputs[u];return d?Jh(l,d):!1})){if(o&&"inputs"in o&&o.inputs){const l=Zb(a.inputs,o.inputs,n);if(l)throw new HI({abiItem:a,type:l[0]},{abiItem:o,type:l[1]})}o=a}}return o||i[0]}function Jh(t,e){const n=typeof t,r=e.type;switch(r){case"address":return Lr(t,{strict:!1});case"bool":return n==="boolean";case"function":return n==="string";case"string":return n==="string";default:return r==="tuple"&&"components"in e?Object.values(e.components).every((s,i)=>Jh(Object.values(t)[i],s)):/^u?int(8|16|24|32|40|48|56|64|72|80|88|96|104|112|120|128|136|144|152|160|168|176|184|192|200|208|216|224|232|240|248|256)?$/.test(r)?n==="number"||n==="bigint":/^bytes([1-9]|1[0-9]|2[0-9]|3[0-2])?$/.test(r)?n==="string"||t instanceof Uint8Array:/[a-z]+[1-9]{0,3}(\[[0-9]{0,}\])+$/.test(r)?Array.isArray(t)&&t.every(s=>Jh(s,{...e,type:r.replace(/(\[[0-9]{0,}\])$/,"")})):!1}}function Zb(t,e,n){for(const r in t){const s=t[r],i=e[r];if(s.type==="tuple"&&i.type==="tuple"&&"components"in s&&"components"in i)return Zb(s.components,i.components,n[r]);const o=[s.type,i.type];if(o.includes("address")&&o.includes("bytes20")?!0:o.includes("address")&&o.includes("string")?Lr(n[r],{strict:!1}):o.includes("address")&&o.includes("bytes")?Lr(n[r],{strict:!1}):!1)return o}}function S2(t,{method:e}){var r,s;const n={};return t.transport.type==="fallback"&&((s=(r=t.transport).onResponse)==null||s.call(r,({method:i,response:o,status:a,transport:c})=>{a==="success"&&e===i&&(n[o]=c.request)})),i=>n[i]||t.request}function Hr(t){return typeof t=="string"?{address:t,type:"json-rpc"}:t}const Xg="/docs/contract/encodeFunctionData";function N2(t){const{abi:e,args:n,functionName:r}=t;let s=e[0];if(r){const i=_p({abi:e,args:n,name:r});if(!i)throw new fu(r,{docsPath:Xg});s=i}if(s.type!=="function")throw new fu(void 0,{docsPath:Xg});return{abi:[s],functionName:Cp(Ks(s))}}function td(t){const{args:e}=t,{abi:n,functionName:r}=(()=>{var a;return t.abi.length===1&&((a=t.functionName)!=null&&a.startsWith("0x"))?t:N2(t)})(),s=n[0],i=r,o="inputs"in s&&s.inputs?Yb(s.inputs,e??[]):void 0;return ed([i,o??"0x"])}const x2={1:"An `assert` condition failed.",17:"Arithmetic operation resulted in underflow or overflow.",18:"Division or modulo by zero (e.g. `5 / 0` or `23 % 0`).",33:"Attempted to convert to an invalid type.",34:"Attempted to access a storage byte array that is incorrectly encoded.",49:"Performed `.pop()` on an empty array",50:"Array index is out of bounds.",65:"Allocated too much memory or created an array which is too large.",81:"Attempted to call a zero-initialized variable of internal function type."},T2={inputs:[{name:"message",type:"string"}],name:"Error",type:"error"},P2={inputs:[{name:"reason",type:"uint256"}],name:"Panic",type:"error"};class Qg extends z{constructor({offset:e}){super(`Offset \`${e}\` cannot be negative.`,{name:"NegativeOffsetError"})}}class Jb extends z{constructor({length:e,position:n}){super(`Position \`${n}\` is out of bounds (\`0 < position < ${e}\`).`,{name:"PositionOutOfBoundsError"})}}class O2 extends z{constructor({count:e,limit:n}){super(`Recursive read limit of \`${n}\` exceeded (recursive read count: \`${e}\`).`,{name:"RecursiveReadLimitExceededError"})}}const R2={bytes:new Uint8Array,dataView:new DataView(new ArrayBuffer(0)),position:0,positionReadCount:new Map,recursiveReadCount:0,recursiveReadLimit:Number.POSITIVE_INFINITY,assertReadLimit(){if(this.recursiveReadCount>=this.recursiveReadLimit)throw new O2({count:this.recursiveReadCount+1,limit:this.recursiveReadLimit})},assertPosition(t){if(t<0||t>this.bytes.length-1)throw new Jb({length:this.bytes.length,position:t})},decrementPosition(t){if(t<0)throw new Qg({offset:t});const e=this.position-t;this.assertPosition(e),this.position=e},getReadCount(t){return this.positionReadCount.get(t||this.position)||0},incrementPosition(t){if(t<0)throw new Qg({offset:t});const e=this.position+t;this.assertPosition(e),this.position=e},inspectByte(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectBytes(t,e){const n=e??this.position;return this.assertPosition(n+t-1),this.bytes.subarray(n,n+t)},inspectUint8(t){const e=t??this.position;return this.assertPosition(e),this.bytes[e]},inspectUint16(t){const e=t??this.position;return this.assertPosition(e+1),this.dataView.getUint16(e)},inspectUint24(t){const e=t??this.position;return this.assertPosition(e+2),(this.dataView.getUint16(e)<<8)+this.dataView.getUint8(e+2)},inspectUint32(t){const e=t??this.position;return this.assertPosition(e+3),this.dataView.getUint32(e)},pushByte(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushBytes(t){this.assertPosition(this.position+t.length-1),this.bytes.set(t,this.position),this.position+=t.length},pushUint8(t){this.assertPosition(this.position),this.bytes[this.position]=t,this.position++},pushUint16(t){this.assertPosition(this.position+1),this.dataView.setUint16(this.position,t),this.position+=2},pushUint24(t){this.assertPosition(this.position+2),this.dataView.setUint16(this.position,t>>8),this.dataView.setUint8(this.position+2,t&255),this.position+=3},pushUint32(t){this.assertPosition(this.position+3),this.dataView.setUint32(this.position,t),this.position+=4},readByte(){this.assertReadLimit(),this._touch();const t=this.inspectByte();return this.position++,t},readBytes(t,e){this.assertReadLimit(),this._touch();const n=this.inspectBytes(t);return this.position+=e??t,n},readUint8(){this.assertReadLimit(),this._touch();const t=this.inspectUint8();return this.position+=1,t},readUint16(){this.assertReadLimit(),this._touch();const t=this.inspectUint16();return this.position+=2,t},readUint24(){this.assertReadLimit(),this._touch();const t=this.inspectUint24();return this.position+=3,t},readUint32(){this.assertReadLimit(),this._touch();const t=this.inspectUint32();return this.position+=4,t},get remaining(){return this.bytes.length-this.position},setPosition(t){const e=this.position;return this.assertPosition(t),this.position=t,()=>this.position=e},_touch(){if(this.recursiveReadLimit===Number.POSITIVE_INFINITY)return;const t=this.getReadCount();this.positionReadCount.set(this.position,t+1),t>0&&this.recursiveReadCount++}};function Ap(t,{recursiveReadLimit:e=8192}={}){const n=Object.create(R2);return n.bytes=t,n.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength),n.positionReadCount=new Map,n.recursiveReadLimit=e,n}function D2(t,e={}){typeof e.size<"u"&&Jn(t,{size:e.size});const n=_n(t,e);return $o(n,e)}function $2(t,e={}){let n=t;if(typeof e.size<"u"&&(Jn(n,{size:e.size}),n=Fs(n)),n.length>1||n[0]>1)throw new KI(n);return!!n[0]}function is(t,e={}){typeof e.size<"u"&&Jn(t,{size:e.size});const n=_n(t,e);return Oi(n,e)}function k2(t,e={}){let n=t;return typeof e.size<"u"&&(Jn(n,{size:e.size}),n=Fs(n,{dir:"right"})),new TextDecoder().decode(n)}function nd(t,e){const n=typeof e=="string"?Ur(e):e,r=Ap(n);if(_t(n)===0&&t.length>0)throw new Gu;if(_t(e)&&_t(e)<32)throw new ob({data:typeof e=="string"?e:_n(e),params:t,size:_t(e)});let s=0;const i=[];for(let o=0;o<t.length;++o){const a=t[o];r.setPosition(s);const[c,l]=So(r,a,{staticPosition:0});s+=l,i.push(c)}return i}function So(t,e,{staticPosition:n}){const r=Ep(e.type);if(r){const[s,i]=r;return L2(t,{...e,type:i},{length:s,staticPosition:n})}if(e.type==="tuple")return j2(t,e,{staticPosition:n});if(e.type==="address")return U2(t);if(e.type==="bool")return M2(t);if(e.type.startsWith("bytes"))return B2(t,e,{staticPosition:n});if(e.type.startsWith("uint")||e.type.startsWith("int"))return F2(t,e);if(e.type==="string")return H2(t,{staticPosition:n});throw new zI(e.type,{docsPath:"/docs/contract/decodeAbiParameters"})}const em=32,Xh=32;function U2(t){const e=t.readBytes(32);return[Qu(_n(Kb(e,-20))),32]}function L2(t,e,{length:n,staticPosition:r}){if(!n){const o=is(t.readBytes(Xh)),a=r+o,c=a+em;t.setPosition(a);const l=is(t.readBytes(em)),u=nc(e);let d=0;const h=[];for(let f=0;f<l;++f){t.setPosition(c+(u?f*32:d));const[p,g]=So(t,e,{staticPosition:c});d+=g,h.push(p)}return t.setPosition(r+32),[h,32]}if(nc(e)){const o=is(t.readBytes(Xh)),a=r+o,c=[];for(let l=0;l<n;++l){t.setPosition(a+l*32);const[u]=So(t,e,{staticPosition:a});c.push(u)}return t.setPosition(r+32),[c,32]}let s=0;const i=[];for(let o=0;o<n;++o){const[a,c]=So(t,e,{staticPosition:r+s});s+=c,i.push(a)}return[i,s]}function M2(t){return[$2(t.readBytes(32),{size:32}),32]}function B2(t,e,{staticPosition:n}){const[r,s]=e.type.split("bytes");if(!s){const o=is(t.readBytes(32));t.setPosition(n+o);const a=is(t.readBytes(32));if(a===0)return t.setPosition(n+32),["0x",32];const c=t.readBytes(a);return t.setPosition(n+32),[_n(c),32]}return[_n(t.readBytes(Number.parseInt(s),32)),32]}function F2(t,e){const n=e.type.startsWith("int"),r=Number.parseInt(e.type.split("int")[1]||"256"),s=t.readBytes(32);return[r>48?D2(s,{signed:n}):is(s,{signed:n}),32]}function j2(t,e,{staticPosition:n}){const r=e.components.length===0||e.components.some(({name:o})=>!o),s=r?[]:{};let i=0;if(nc(e)){const o=is(t.readBytes(Xh)),a=n+o;for(let c=0;c<e.components.length;++c){const l=e.components[c];t.setPosition(a+i);const[u,d]=So(t,l,{staticPosition:a});i+=d,s[r?c:l==null?void 0:l.name]=u}return t.setPosition(n+32),[s,32]}for(let o=0;o<e.components.length;++o){const a=e.components[o],[c,l]=So(t,a,{staticPosition:n});s[r?o:a==null?void 0:a.name]=c,i+=l}return[s,i]}function H2(t,{staticPosition:e}){const n=is(t.readBytes(32)),r=e+n;t.setPosition(r);const s=is(t.readBytes(32));if(s===0)return t.setPosition(e+32),["",32];const i=t.readBytes(s,32),o=k2(Fs(i));return t.setPosition(e+32),[o,32]}function nc(t){var r;const{type:e}=t;if(e==="string"||e==="bytes"||e.endsWith("[]"))return!0;if(e==="tuple")return(r=t.components)==null?void 0:r.some(nc);const n=Ep(t.type);return!!(n&&nc({...t,type:n[1]}))}function q2(t){const{abi:e,data:n}=t,r=pu(n,0,4);if(r==="0x")throw new Gu;const i=[...e||[],T2,P2].find(o=>o.type==="error"&&r===Cp(Ks(o)));if(!i)throw new ab(r,{docsPath:"/docs/contract/decodeErrorResult"});return{abiItem:i,args:"inputs"in i&&i.inputs&&i.inputs.length>0?nd(i.inputs,pu(n,4)):void 0,errorName:i.name}}const Gn=(t,e,n)=>JSON.stringify(t,(r,s)=>typeof s=="bigint"?s.toString():s,n);function Xb({abiItem:t,args:e,includeFunctionName:n=!0,includeName:r=!1}){if("name"in t&&"inputs"in t&&t.inputs)return`${n?t.name:""}(${t.inputs.map((s,i)=>`${r&&s.name?`${s.name}: `:""}${typeof e[i]=="object"?Gn(e[i]):e[i]}`).join(", ")})`}const z2={gwei:9,wei:18},W2={ether:-9,wei:9},V2={ether:-18,gwei:-9};function Go(t,e){let n=t.toString();const r=n.startsWith("-");r&&(n=n.slice(1)),n=n.padStart(e,"0");let[s,i]=[n.slice(0,n.length-e),n.slice(n.length-e)];return i=i.replace(/(0+)$/,""),`${r?"-":""}${s||"0"}${i?`.${i}`:""}`}function Ip(t,e="wei"){return Go(t,z2[e])}function En(t,e="wei"){return Go(t,W2[e])}class G2 extends z{constructor({address:e}){super(`State for account "${e}" is set multiple times.`,{name:"AccountStateConflictError"})}}class K2 extends z{constructor(){super("state and stateDiff are set on the same account.",{name:"StateAssignmentConflictError"})}}function tm(t){return t.reduce((e,{slot:n,value:r})=>`${e}        ${n}: ${r}
`,"")}function Y2(t){return t.reduce((e,{address:n,...r})=>{let s=`${e}    ${n}:
`;return r.nonce&&(s+=`      nonce: ${r.nonce}
`),r.balance&&(s+=`      balance: ${r.balance}
`),r.code&&(s+=`      code: ${r.code}
`),r.state&&(s+=`      state:
`,s+=tm(r.state)),r.stateDiff&&(s+=`      stateDiff:
`,s+=tm(r.stateDiff)),s},`  State Override:
`).slice(0,-1)}function Jc(t){const e=Object.entries(t).map(([r,s])=>s===void 0||s===!1?null:[r,s]).filter(Boolean),n=e.reduce((r,[s])=>Math.max(r,s.length),0);return e.map(([r,s])=>`  ${`${r}:`.padEnd(n+1)}  ${s}`).join(`
`)}class Z2 extends z{constructor(){super(["Cannot specify both a `gasPrice` and a `maxFeePerGas`/`maxPriorityFeePerGas`.","Use `maxFeePerGas`/`maxPriorityFeePerGas` for EIP-1559 compatible networks, and `gasPrice` for others."].join(`
`),{name:"FeeConflictError"})}}class J2 extends z{constructor({transaction:e}){super("Cannot infer a transaction type from provided transaction.",{metaMessages:["Provided Transaction:","{",Jc(e),"}","","To infer the type, either provide:","- a `type` to the Transaction, or","- an EIP-1559 Transaction with `maxFeePerGas`, or","- an EIP-2930 Transaction with `gasPrice` & `accessList`, or","- an EIP-4844 Transaction with `blobs`, `blobVersionedHashes`, `sidecars`, or","- an EIP-7702 Transaction with `authorizationList`, or","- a Legacy Transaction with `gasPrice`"],name:"InvalidSerializableTransactionError"})}}class X2 extends z{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h}){var p;const f=Jc({chain:s&&`${s==null?void 0:s.name} (id: ${s==null?void 0:s.id})`,from:n==null?void 0:n.address,to:d,value:typeof h<"u"&&`${Ip(h)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${En(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${En(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${En(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Request Arguments:",f].filter(Boolean),name:"TransactionExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class Qb extends z{constructor({blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){let o="Transaction";r&&i!==void 0&&(o=`Transaction at block time "${r}" at index "${i}"`),e&&i!==void 0&&(o=`Transaction at block hash "${e}" at index "${i}"`),n&&i!==void 0&&(o=`Transaction at block number "${n}" at index "${i}"`),s&&(o=`Transaction with hash "${s}"`),super(`${o} could not be found.`,{name:"TransactionNotFoundError"})}}class e1 extends z{constructor({hash:e}){super(`Transaction receipt with hash "${e}" could not be found. The Transaction may not be processed on a block yet.`,{name:"TransactionReceiptNotFoundError"})}}class Q2 extends z{constructor({hash:e}){super(`Timed out while waiting for transaction with hash "${e}" to be confirmed.`,{name:"WaitForTransactionReceiptTimeoutError"})}}const eS=t=>t,Sp=t=>t;class tS extends z{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h,stateOverride:f}){var m;const p=n?Hr(n):void 0;let g=Jc({from:p==null?void 0:p.address,to:d,value:typeof h<"u"&&`${Ip(h)} ${((m=s==null?void 0:s.nativeCurrency)==null?void 0:m.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${En(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${En(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${En(l)} gwei`,nonce:u});f&&(g+=`
${Y2(f)}`),super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Raw Call Arguments:",g].filter(Boolean),name:"CallExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class t1 extends z{constructor(e,{abi:n,args:r,contractAddress:s,docsPath:i,functionName:o,sender:a}){const c=_p({abi:n,args:r,name:o}),l=c?Xb({abiItem:c,args:r,includeFunctionName:!1,includeName:!1}):void 0,u=c?Ks(c,{includeName:!0}):void 0,d=Jc({address:s&&eS(s),function:u,args:l&&l!=="()"&&`${[...Array((o==null?void 0:o.length)??0).keys()].map(()=>" ").join("")}${l}`,sender:a});super(e.shortMessage||`An unknown error occurred while executing the contract function "${o}".`,{cause:e,docsPath:i,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],d&&"Contract Call:",d].filter(Boolean),name:"ContractFunctionExecutionError"}),Object.defineProperty(this,"abi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"contractAddress",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"formattedArgs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"functionName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sender",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.abi=n,this.args=r,this.cause=e,this.contractAddress=s,this.functionName=o,this.sender=a}}class nS extends z{constructor({abi:e,data:n,functionName:r,message:s}){let i,o,a,c;if(n&&n!=="0x")try{o=q2({abi:e,data:n});const{abiItem:u,errorName:d,args:h}=o;if(d==="Error")c=h[0];else if(d==="Panic"){const[f]=h;c=x2[f]}else{const f=u?Ks(u,{includeName:!0}):void 0,p=u&&h?Xb({abiItem:u,args:h,includeFunctionName:!1,includeName:!1}):void 0;a=[f?`Error: ${f}`:"",p&&p!=="()"?`       ${[...Array((d==null?void 0:d.length)??0).keys()].map(()=>" ").join("")}${p}`:""]}}catch(u){i=u}else s&&(c=s);let l;i instanceof ab&&(l=i.signature,a=[`Unable to decode signature "${l}" as it was not found on the provided ABI.`,"Make sure you are using the correct ABI and that the error exists on it.",`You can look up the decoded signature here: https://openchain.xyz/signatures?query=${l}.`]),super(c&&c!=="execution reverted"||l?[`The contract function "${r}" reverted with the following ${l?"signature":"reason"}:`,c||l].join(`
`):`The contract function "${r}" reverted.`,{cause:i,metaMessages:a,name:"ContractFunctionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"raw",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reason",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=o,this.raw=n,this.reason=c,this.signature=l}}class rS extends z{constructor({functionName:e}){super(`The contract function "${e}" returned no data ("0x").`,{metaMessages:["This could be due to any of the following:",`  - The contract does not have the function "${e}",`,"  - The parameters passed to the contract function may be invalid, or","  - The address is not a contract."],name:"ContractFunctionZeroDataError"})}}class sS extends z{constructor({factory:e}){super(`Deployment for counterfactual contract call failed${e?` for factory "${e}".`:""}`,{metaMessages:["Please ensure:","- The `factory` is a valid contract deployment factory (ie. Create2 Factory, ERC-4337 Factory, etc).","- The `factoryData` is a valid encoded function call for contract deployment function on the factory."],name:"CounterfactualDeploymentFailedError"})}}class Np extends z{constructor({data:e,message:n}){super(n||"",{name:"RawContractError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=e}}class Ua extends z{constructor({body:e,cause:n,details:r,headers:s,status:i,url:o}){super("HTTP request failed.",{cause:n,details:r,metaMessages:[i&&`Status: ${i}`,`URL: ${Sp(o)}`,e&&`Request body: ${Gn(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=s,this.status=i,this.url=o}}class xp extends z{constructor({body:e,error:n,url:r}){super("RPC Request failed.",{cause:n,details:n.message,metaMessages:[`URL: ${Sp(r)}`,`Request body: ${Gn(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=n.code,this.data=n.data}}class nm extends z{constructor({body:e,url:n}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${Sp(n)}`,`Request body: ${Gn(e)}`],name:"TimeoutError"})}}const iS=-1;class An extends z{constructor(e,{code:n,docsPath:r,metaMessages:s,name:i,shortMessage:o}){super(o,{cause:e,docsPath:r,metaMessages:s||(e==null?void 0:e.metaMessages),name:i||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=i||e.name,this.code=e instanceof xp?e.code:n??iS}}class Ln extends An{constructor(e,n){super(e,n),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=n.data}}class rc extends An{constructor(e){super(e,{code:rc.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(rc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class sc extends An{constructor(e){super(e,{code:sc.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(sc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class ic extends An{constructor(e,{method:n}={}){super(e,{code:ic.code,name:"MethodNotFoundRpcError",shortMessage:`The method${n?` "${n}"`:""} does not exist / is not available.`})}}Object.defineProperty(ic,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class oc extends An{constructor(e){super(e,{code:oc.code,name:"InvalidParamsRpcError",shortMessage:["Invalid parameters were provided to the RPC method.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(oc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Di extends An{constructor(e){super(e,{code:Di.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Di,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class ac extends An{constructor(e){super(e,{code:ac.code,name:"InvalidInputRpcError",shortMessage:["Missing or invalid parameters.","Double check you have provided the correct parameters."].join(`
`)})}}Object.defineProperty(ac,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class cc extends An{constructor(e){super(e,{code:cc.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(cc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class js extends An{constructor(e){super(e,{code:js.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(js,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Lo extends An{constructor(e){super(e,{code:Lo.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Lo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class yi extends An{constructor(e,{method:n}={}){super(e,{code:yi.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${n?` "${n}"`:""} is not supported.`})}}Object.defineProperty(yi,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class Mo extends An{constructor(e){super(e,{code:Mo.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(Mo,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class lc extends An{constructor(e){super(e,{code:lc.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(lc,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class Et extends Ln{constructor(e){super(e,{code:Et.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(Et,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class uc extends Ln{constructor(e){super(e,{code:uc.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(uc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class dc extends Ln{constructor(e,{method:n}={}){super(e,{code:dc.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${n?` " ${n}"`:""}.`})}}Object.defineProperty(dc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class hc extends Ln{constructor(e){super(e,{code:hc.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(hc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class fc extends Ln{constructor(e){super(e,{code:fc.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(fc,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class Mr extends Ln{constructor(e){super(e,{code:Mr.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(Mr,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class pc extends Ln{constructor(e){super(e,{code:pc.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(pc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class gc extends Ln{constructor(e){super(e,{code:gc.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(gc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class mc extends Ln{constructor(e){super(e,{code:mc.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(mc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class yc extends Ln{constructor(e){super(e,{code:yc.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(yc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class wc extends Ln{constructor(e){super(e,{code:wc.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(wc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class bc extends Ln{constructor(e){super(e,{code:bc.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(bc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class vc extends Ln{constructor(e){super(e,{code:vc.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(vc,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class oS extends An{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}const aS=3;function gu(t,{abi:e,address:n,args:r,docsPath:s,functionName:i,sender:o}){const a=t instanceof Np?t:t instanceof z?t.walk(p=>"data"in p)||t.walk():{},{code:c,data:l,details:u,message:d,shortMessage:h}=a,f=t instanceof Gu?new rS({functionName:i}):[aS,Di.code].includes(c)&&(l||u||d||h)?new nS({abi:e,data:typeof l=="object"?l.data:l,functionName:i,message:a instanceof xp?u:h??d}):t;return new t1(f,{abi:e,args:r,contractAddress:n,docsPath:s,functionName:i,sender:o})}function cS(t){const e=Zc(`0x${t.substring(4)}`).substring(26);return Qu(`0x${e}`)}async function lS({hash:t,signature:e}){const n=Ys(t)?t:ko(t),{secp256k1:r}=await Qt(async()=>{const{secp256k1:o}=await import("./D8cg6_pm.js").then(a=>a.s);return{secp256k1:o}},__vite__mapDeps([0,1,2]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),p=rm(f);return new r.Signature($o(l),$o(u)).addRecoveryBit(p)}const o=Ys(e)?e:ko(e);if(_t(o)!==65)throw new Error("invalid signature length");const a=Oi(`0x${o.slice(130)}`),c=rm(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function rm(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function uS({hash:t,signature:e}){return cS(await lS({hash:t,signature:e}))}function dS(t,e="hex"){const n=n1(t),r=Ap(new Uint8Array(n.length));return n.encode(r),e==="hex"?_n(r.bytes):r.bytes}function n1(t){return Array.isArray(t)?hS(t.map(e=>n1(e))):fS(t)}function hS(t){const e=t.reduce((s,i)=>s+i.length,0),n=r1(e);return{length:e<=55?1+e:1+n+e,encode(s){e<=55?s.pushByte(192+e):(s.pushByte(247+n),n===1?s.pushUint8(e):n===2?s.pushUint16(e):n===3?s.pushUint24(e):s.pushUint32(e));for(const{encode:i}of t)i(s)}}}function fS(t){const e=typeof t=="string"?Ur(t):t,n=r1(e.length);return{length:e.length===1&&e[0]<128?1:e.length<=55?1+e.length:1+n+e.length,encode(s){e.length===1&&e[0]<128?s.pushBytes(e):e.length<=55?(s.pushByte(128+e.length),s.pushBytes(e)):(s.pushByte(183+n),n===1?s.pushUint8(e.length):n===2?s.pushUint16(e.length):n===3?s.pushUint24(e.length):s.pushUint32(e.length),s.pushBytes(e))}}}function r1(t){if(t<2**8)return 1;if(t<2**16)return 2;if(t<2**24)return 3;if(t<2**32)return 4;throw new z("Length is too large.")}function pS(t){const{chainId:e,nonce:n,to:r}=t,s=t.contractAddress??t.address,i=Zc(ed(["0x05",dS([e?Ne(e):"0x",s,n?Ne(n):"0x"])]));return r==="bytes"?Ur(i):i}async function s1(t){const{authorization:e,signature:n}=t;return uS({hash:pS(e),signature:n??e})}class gS extends z{constructor(e,{account:n,docsPath:r,chain:s,data:i,gas:o,gasPrice:a,maxFeePerGas:c,maxPriorityFeePerGas:l,nonce:u,to:d,value:h}){var p;const f=Jc({from:n==null?void 0:n.address,to:d,value:typeof h<"u"&&`${Ip(h)} ${((p=s==null?void 0:s.nativeCurrency)==null?void 0:p.symbol)||"ETH"}`,data:i,gas:o,gasPrice:typeof a<"u"&&`${En(a)} gwei`,maxFeePerGas:typeof c<"u"&&`${En(c)} gwei`,maxPriorityFeePerGas:typeof l<"u"&&`${En(l)} gwei`,nonce:u});super(e.shortMessage,{cause:e,docsPath:r,metaMessages:[...e.metaMessages?[...e.metaMessages," "]:[],"Estimate Gas Arguments:",f].filter(Boolean),name:"EstimateGasExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=e}}class wi extends z{constructor({cause:e,message:n}={}){var s;const r=(s=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:s.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(wi,"code",{enumerable:!0,configurable:!0,writable:!0,value:3});Object.defineProperty(wi,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class mu extends z{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${En(n)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(mu,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class Qh extends z{constructor({cause:e,maxFeePerGas:n}={}){super(`The fee cap (\`maxFeePerGas\`${n?` = ${En(n)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(Qh,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class ef extends z{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(ef,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class tf extends z{constructor({cause:e,nonce:n}={}){super([`Nonce provided for the transaction ${n?`(${n}) `:""}is lower than the current nonce of the account.`,"Try increasing the nonce or find the latest nonce with `getTransactionCount`."].join(`
`),{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(tf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class nf extends z{constructor({cause:e,nonce:n}={}){super(`Nonce provided for the transaction ${n?`(${n}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(nf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class rf extends z{constructor({cause:e}={}){super(["The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account."].join(`
`),{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(rf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class sf extends z{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(sf,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class of extends z{constructor({cause:e,gas:n}={}){super(`The amount of gas ${n?`(${n}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(of,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class af extends z{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(af,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class yu extends z{constructor({cause:e,maxPriorityFeePerGas:n,maxFeePerGas:r}={}){super([`The provided tip (\`maxPriorityFeePerGas\`${n?` = ${En(n)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${En(r)} gwei`:""}).`].join(`
`),{cause:e,name:"TipAboveFeeCapError"})}}Object.defineProperty(yu,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});class rd extends z{constructor({cause:e}){super(`An error occurred while executing: ${e==null?void 0:e.shortMessage}`,{cause:e,name:"UnknownNodeError"})}}function Tp(t,e){const n=(t.details||"").toLowerCase(),r=t instanceof z?t.walk(s=>(s==null?void 0:s.code)===wi.code):t;return r instanceof z?new wi({cause:t,message:r.details}):wi.nodeMessage.test(n)?new wi({cause:t,message:t.details}):mu.nodeMessage.test(n)?new mu({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):Qh.nodeMessage.test(n)?new Qh({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas}):ef.nodeMessage.test(n)?new ef({cause:t,nonce:e==null?void 0:e.nonce}):tf.nodeMessage.test(n)?new tf({cause:t,nonce:e==null?void 0:e.nonce}):nf.nodeMessage.test(n)?new nf({cause:t,nonce:e==null?void 0:e.nonce}):rf.nodeMessage.test(n)?new rf({cause:t}):sf.nodeMessage.test(n)?new sf({cause:t,gas:e==null?void 0:e.gas}):of.nodeMessage.test(n)?new of({cause:t,gas:e==null?void 0:e.gas}):af.nodeMessage.test(n)?new af({cause:t}):yu.nodeMessage.test(n)?new yu({cause:t,maxFeePerGas:e==null?void 0:e.maxFeePerGas,maxPriorityFeePerGas:e==null?void 0:e.maxPriorityFeePerGas}):new rd({cause:t})}function mS(t,{docsPath:e,...n}){const r=(()=>{const s=Tp(t,n);return s instanceof rd?t:s})();return new gS(r,{docsPath:e,...n})}function Pp(t,{format:e}){if(!e)return{};const n={};function r(i){const o=Object.keys(i);for(const a of o)a in t&&(n[a]=t[a]),i[a]&&typeof i[a]=="object"&&!Array.isArray(i[a])&&r(i[a])}const s=e(t||{});return r(s),n}const yS={legacy:"0x0",eip2930:"0x1",eip1559:"0x2",eip4844:"0x3",eip7702:"0x4"};function Op(t){const e={};return typeof t.authorizationList<"u"&&(e.authorizationList=wS(t.authorizationList)),typeof t.accessList<"u"&&(e.accessList=t.accessList),typeof t.blobVersionedHashes<"u"&&(e.blobVersionedHashes=t.blobVersionedHashes),typeof t.blobs<"u"&&(typeof t.blobs[0]!="string"?e.blobs=t.blobs.map(n=>_n(n)):e.blobs=t.blobs),typeof t.data<"u"&&(e.data=t.data),typeof t.from<"u"&&(e.from=t.from),typeof t.gas<"u"&&(e.gas=Ne(t.gas)),typeof t.gasPrice<"u"&&(e.gasPrice=Ne(t.gasPrice)),typeof t.maxFeePerBlobGas<"u"&&(e.maxFeePerBlobGas=Ne(t.maxFeePerBlobGas)),typeof t.maxFeePerGas<"u"&&(e.maxFeePerGas=Ne(t.maxFeePerGas)),typeof t.maxPriorityFeePerGas<"u"&&(e.maxPriorityFeePerGas=Ne(t.maxPriorityFeePerGas)),typeof t.nonce<"u"&&(e.nonce=Ne(t.nonce)),typeof t.to<"u"&&(e.to=t.to),typeof t.type<"u"&&(e.type=yS[t.type]),typeof t.value<"u"&&(e.value=Ne(t.value)),e}function wS(t){return t.map(e=>({address:e.address,r:e.r?Ne(BigInt(e.r)):e.r,s:e.s?Ne(BigInt(e.s)):e.s,chainId:Ne(e.chainId),nonce:Ne(e.nonce),...typeof e.yParity<"u"?{yParity:Ne(e.yParity)}:{},...typeof e.v<"u"&&typeof e.yParity>"u"?{v:Ne(e.v)}:{}}))}function sm(t){if(!(!t||t.length===0))return t.reduce((e,{slot:n,value:r})=>{if(n.length!==66)throw new Kg({size:n.length,targetSize:66,type:"hex"});if(r.length!==66)throw new Kg({size:r.length,targetSize:66,type:"hex"});return e[n]=r,e},{})}function bS(t){const{balance:e,nonce:n,state:r,stateDiff:s,code:i}=t,o={};if(i!==void 0&&(o.code=i),e!==void 0&&(o.balance=Ne(e)),n!==void 0&&(o.nonce=Ne(n)),r!==void 0&&(o.state=sm(r)),s!==void 0){if(o.state)throw new K2;o.stateDiff=sm(s)}return o}function i1(t){if(!t)return;const e={};for(const{address:n,...r}of t){if(!Lr(n,{strict:!1}))throw new Ri({address:n});if(e[n])throw new G2({address:n});e[n]=bS(r)}return e}const vS=2n**256n-1n;function sd(t){const{account:e,gasPrice:n,maxFeePerGas:r,maxPriorityFeePerGas:s,to:i}=t,o=e?Hr(e):void 0;if(o&&!Lr(o.address))throw new Ri({address:o.address});if(i&&!Lr(i))throw new Ri({address:i});if(typeof n<"u"&&(typeof r<"u"||typeof s<"u"))throw new Z2;if(r&&r>vS)throw new mu({maxFeePerGas:r});if(s&&r&&s>r)throw new yu({maxFeePerGas:r,maxPriorityFeePerGas:s})}class ES extends z{constructor(){super("`baseFeeMultiplier` must be greater than 1.",{name:"BaseFeeScalarError"})}}class Rp extends z{constructor(){super("Chain does not support EIP-1559 fees.",{name:"Eip1559FeesNotSupportedError"})}}class CS extends z{constructor({maxPriorityFeePerGas:e}){super(`\`maxFeePerGas\` cannot be less than the \`maxPriorityFeePerGas\` (${En(e)} gwei).`,{name:"MaxFeePerGasTooLowError"})}}class o1 extends z{constructor({blockHash:e,blockNumber:n}){let r="Block";e&&(r=`Block at hash "${e}"`),n&&(r=`Block at number "${n}"`),super(`${r} could not be found.`,{name:"BlockNotFoundError"})}}const a1={"0x0":"legacy","0x1":"eip2930","0x2":"eip1559","0x3":"eip4844","0x4":"eip7702"};function c1(t){const e={...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,chainId:t.chainId?Oi(t.chainId):void 0,gas:t.gas?BigInt(t.gas):void 0,gasPrice:t.gasPrice?BigInt(t.gasPrice):void 0,maxFeePerBlobGas:t.maxFeePerBlobGas?BigInt(t.maxFeePerBlobGas):void 0,maxFeePerGas:t.maxFeePerGas?BigInt(t.maxFeePerGas):void 0,maxPriorityFeePerGas:t.maxPriorityFeePerGas?BigInt(t.maxPriorityFeePerGas):void 0,nonce:t.nonce?Oi(t.nonce):void 0,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,type:t.type?a1[t.type]:void 0,typeHex:t.type?t.type:void 0,value:t.value?BigInt(t.value):void 0,v:t.v?BigInt(t.v):void 0};return t.authorizationList&&(e.authorizationList=_S(t.authorizationList)),e.yParity=(()=>{if(t.yParity)return Number(t.yParity);if(typeof e.v=="bigint"){if(e.v===0n||e.v===27n)return 0;if(e.v===1n||e.v===28n)return 1;if(e.v>=35n)return e.v%2n===0n?1:0}})(),e.type==="legacy"&&(delete e.accessList,delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas,delete e.yParity),e.type==="eip2930"&&(delete e.maxFeePerBlobGas,delete e.maxFeePerGas,delete e.maxPriorityFeePerGas),e.type==="eip1559"&&delete e.maxFeePerBlobGas,e}function _S(t){return t.map(e=>({address:e.address,chainId:Number(e.chainId),nonce:Number(e.nonce),r:e.r,s:e.s,yParity:Number(e.yParity)}))}function AS(t){const e=(t.transactions??[]).map(n=>typeof n=="string"?n:c1(n));return{...t,baseFeePerGas:t.baseFeePerGas?BigInt(t.baseFeePerGas):null,blobGasUsed:t.blobGasUsed?BigInt(t.blobGasUsed):void 0,difficulty:t.difficulty?BigInt(t.difficulty):void 0,excessBlobGas:t.excessBlobGas?BigInt(t.excessBlobGas):void 0,gasLimit:t.gasLimit?BigInt(t.gasLimit):void 0,gasUsed:t.gasUsed?BigInt(t.gasUsed):void 0,hash:t.hash?t.hash:null,logsBloom:t.logsBloom?t.logsBloom:null,nonce:t.nonce?t.nonce:null,number:t.number?BigInt(t.number):null,size:t.size?BigInt(t.size):void 0,timestamp:t.timestamp?BigInt(t.timestamp):void 0,transactions:e,totalDifficulty:t.totalDifficulty?BigInt(t.totalDifficulty):null}}async function Ec(t,{blockHash:e,blockNumber:n,blockTag:r,includeTransactions:s}={}){var u,d,h;const i=r??"latest",o=s??!1,a=n!==void 0?Ne(n):void 0;let c=null;if(e?c=await t.request({method:"eth_getBlockByHash",params:[e,o]},{dedupe:!0}):c=await t.request({method:"eth_getBlockByNumber",params:[a||i,o]},{dedupe:!!a}),!c)throw new o1({blockHash:e,blockNumber:n});return(((h=(d=(u=t.chain)==null?void 0:u.formatters)==null?void 0:d.block)==null?void 0:h.format)||AS)(c)}async function l1(t){const e=await t.request({method:"eth_gasPrice"});return BigInt(e)}async function kq(t,e){return u1(t,e)}async function u1(t,e){var i,o;const{block:n,chain:r=t.chain,request:s}=e||{};try{const a=((i=r==null?void 0:r.fees)==null?void 0:i.maxPriorityFeePerGas)??((o=r==null?void 0:r.fees)==null?void 0:o.defaultPriorityFee);if(typeof a=="function"){const l=n||await lt(t,Ec,"getBlock")({}),u=await a({block:l,client:t,request:s});if(u===null)throw new Error;return u}if(typeof a<"u")return a;const c=await t.request({method:"eth_maxPriorityFeePerGas"});return $o(c)}catch{const[a,c]=await Promise.all([n?Promise.resolve(n):lt(t,Ec,"getBlock")({}),lt(t,l1,"getGasPrice")({})]);if(typeof a.baseFeePerGas!="bigint")throw new Rp;const l=c-a.baseFeePerGas;return l<0n?0n:l}}async function Uq(t,e){return cf(t,e)}async function cf(t,e){var h,f;const{block:n,chain:r=t.chain,request:s,type:i="eip1559"}=e||{},o=await(async()=>{var p,g;return typeof((p=r==null?void 0:r.fees)==null?void 0:p.baseFeeMultiplier)=="function"?r.fees.baseFeeMultiplier({block:n,client:t,request:s}):((g=r==null?void 0:r.fees)==null?void 0:g.baseFeeMultiplier)??1.2})();if(o<1)throw new ES;const c=10**(((h=o.toString().split(".")[1])==null?void 0:h.length)??0),l=p=>p*BigInt(Math.ceil(o*c))/BigInt(c),u=n||await lt(t,Ec,"getBlock")({});if(typeof((f=r==null?void 0:r.fees)==null?void 0:f.estimateFeesPerGas)=="function"){const p=await r.fees.estimateFeesPerGas({block:n,client:t,multiply:l,request:s,type:i});if(p!==null)return p}if(i==="eip1559"){if(typeof u.baseFeePerGas!="bigint")throw new Rp;const p=typeof(s==null?void 0:s.maxPriorityFeePerGas)=="bigint"?s.maxPriorityFeePerGas:await u1(t,{block:u,chain:r,request:s}),g=l(u.baseFeePerGas);return{maxFeePerGas:(s==null?void 0:s.maxFeePerGas)??g+p,maxPriorityFeePerGas:p}}return{gasPrice:(s==null?void 0:s.gasPrice)??l(await lt(t,l1,"getGasPrice")({}))}}async function IS(t,{address:e,blockTag:n="latest",blockNumber:r}){const s=await t.request({method:"eth_getTransactionCount",params:[e,typeof r=="bigint"?Ne(r):n]},{dedupe:!!r});return Oi(s)}function d1(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(i=>Ur(i)):t.blobs,s=[];for(const i of r)s.push(Uint8Array.from(e.blobToKzgCommitment(i)));return n==="bytes"?s:s.map(i=>_n(i))}function h1(t){const{kzg:e}=t,n=t.to??(typeof t.blobs[0]=="string"?"hex":"bytes"),r=typeof t.blobs[0]=="string"?t.blobs.map(o=>Ur(o)):t.blobs,s=typeof t.commitments[0]=="string"?t.commitments.map(o=>Ur(o)):t.commitments,i=[];for(let o=0;o<r.length;o++){const a=r[o],c=s[o];i.push(Uint8Array.from(e.computeBlobKzgProof(a,c)))}return n==="bytes"?i:i.map(o=>_n(o))}var ss={},et={},nn={};Object.defineProperty(nn,"__esModule",{value:!0});nn.SHA512_IV=nn.SHA384_IV=nn.SHA224_IV=nn.SHA256_IV=nn.HashMD=void 0;nn.setBigUint64=f1;nn.Chi=SS;nn.Maj=NS;const yr=Zu;function f1(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function SS(t,e,n){return t&e^~t&n}function NS(t,e,n){return t&e^t&n^e&n}class xS extends yr.Hash{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=(0,yr.createView)(this.buffer)}update(e){(0,yr.aexists)(this),e=(0,yr.toBytes)(e),(0,yr.abytes)(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=(0,yr.createView)(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,yr.aexists)(this),(0,yr.aoutput)(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,(0,yr.clean)(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;f1(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=(0,yr.createView)(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}}nn.HashMD=xS;nn.SHA256_IV=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);nn.SHA224_IV=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]);nn.SHA384_IV=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]);nn.SHA512_IV=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);Object.defineProperty(et,"__esModule",{value:!0});et.sha512_224=et.sha512_256=et.sha384=et.sha512=et.sha224=et.sha256=et.SHA512_256=et.SHA512_224=et.SHA384=et.SHA512=et.SHA224=et.SHA256=void 0;const pe=nn,Ae=be,mt=Zu,TS=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),gs=new Uint32Array(64);class Dp extends pe.HashMD{constructor(e=32){super(64,e,8,!1),this.A=pe.SHA256_IV[0]|0,this.B=pe.SHA256_IV[1]|0,this.C=pe.SHA256_IV[2]|0,this.D=pe.SHA256_IV[3]|0,this.E=pe.SHA256_IV[4]|0,this.F=pe.SHA256_IV[5]|0,this.G=pe.SHA256_IV[6]|0,this.H=pe.SHA256_IV[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)gs[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=gs[d-15],f=gs[d-2],p=(0,mt.rotr)(h,7)^(0,mt.rotr)(h,18)^h>>>3,g=(0,mt.rotr)(f,17)^(0,mt.rotr)(f,19)^f>>>10;gs[d]=g+gs[d-7]+p+gs[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=(0,mt.rotr)(a,6)^(0,mt.rotr)(a,11)^(0,mt.rotr)(a,25),f=u+h+(0,pe.Chi)(a,c,l)+TS[d]+gs[d]|0,g=((0,mt.rotr)(r,2)^(0,mt.rotr)(r,13)^(0,mt.rotr)(r,22))+(0,pe.Maj)(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+g|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){(0,mt.clean)(gs)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,mt.clean)(this.buffer)}}et.SHA256=Dp;class p1 extends Dp{constructor(){super(28),this.A=pe.SHA224_IV[0]|0,this.B=pe.SHA224_IV[1]|0,this.C=pe.SHA224_IV[2]|0,this.D=pe.SHA224_IV[3]|0,this.E=pe.SHA224_IV[4]|0,this.F=pe.SHA224_IV[5]|0,this.G=pe.SHA224_IV[6]|0,this.H=pe.SHA224_IV[7]|0}}et.SHA224=p1;const g1=Ae.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),PS=g1[0],OS=g1[1],ms=new Uint32Array(80),ys=new Uint32Array(80);class Xc extends pe.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=pe.SHA512_IV[0]|0,this.Al=pe.SHA512_IV[1]|0,this.Bh=pe.SHA512_IV[2]|0,this.Bl=pe.SHA512_IV[3]|0,this.Ch=pe.SHA512_IV[4]|0,this.Cl=pe.SHA512_IV[5]|0,this.Dh=pe.SHA512_IV[6]|0,this.Dl=pe.SHA512_IV[7]|0,this.Eh=pe.SHA512_IV[8]|0,this.El=pe.SHA512_IV[9]|0,this.Fh=pe.SHA512_IV[10]|0,this.Fl=pe.SHA512_IV[11]|0,this.Gh=pe.SHA512_IV[12]|0,this.Gl=pe.SHA512_IV[13]|0,this.Hh=pe.SHA512_IV[14]|0,this.Hl=pe.SHA512_IV[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let y=0;y<16;y++,n+=4)ms[y]=e.getUint32(n),ys[y]=e.getUint32(n+=4);for(let y=16;y<80;y++){const N=ms[y-15]|0,_=ys[y-15]|0,T=Ae.rotrSH(N,_,1)^Ae.rotrSH(N,_,8)^Ae.shrSH(N,_,7),x=Ae.rotrSL(N,_,1)^Ae.rotrSL(N,_,8)^Ae.shrSL(N,_,7),D=ms[y-2]|0,I=ys[y-2]|0,U=Ae.rotrSH(D,I,19)^Ae.rotrBH(D,I,61)^Ae.shrSH(D,I,6),R=Ae.rotrSL(D,I,19)^Ae.rotrBL(D,I,61)^Ae.shrSL(D,I,6),k=Ae.add4L(x,R,ys[y-7],ys[y-16]),M=Ae.add4H(k,T,U,ms[y-7],ms[y-16]);ms[y]=M|0,ys[y]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:v,Hl:b}=this;for(let y=0;y<80;y++){const N=Ae.rotrSH(d,h,14)^Ae.rotrSH(d,h,18)^Ae.rotrBH(d,h,41),_=Ae.rotrSL(d,h,14)^Ae.rotrSL(d,h,18)^Ae.rotrBL(d,h,41),T=d&f^~d&g,x=h&p^~h&m,D=Ae.add5L(b,_,x,OS[y],ys[y]),I=Ae.add5H(D,v,N,T,PS[y],ms[y]),U=D|0,R=Ae.rotrSH(r,s,28)^Ae.rotrBH(r,s,34)^Ae.rotrBH(r,s,39),k=Ae.rotrSL(r,s,28)^Ae.rotrBL(r,s,34)^Ae.rotrBL(r,s,39),M=r&i^r&a^i&a,F=s&o^s&c^o&c;v=g|0,b=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Ae.add(l|0,u|0,I|0,U|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const E=Ae.add3L(U,k,F);r=Ae.add3H(E,I,R,M),s=E|0}({h:r,l:s}=Ae.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ae.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ae.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ae.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Ae.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Ae.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Ae.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:v,l:b}=Ae.add(this.Hh|0,this.Hl|0,v|0,b|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,v,b)}roundClean(){(0,mt.clean)(ms,ys)}destroy(){(0,mt.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}et.SHA512=Xc;class m1 extends Xc{constructor(){super(48),this.Ah=pe.SHA384_IV[0]|0,this.Al=pe.SHA384_IV[1]|0,this.Bh=pe.SHA384_IV[2]|0,this.Bl=pe.SHA384_IV[3]|0,this.Ch=pe.SHA384_IV[4]|0,this.Cl=pe.SHA384_IV[5]|0,this.Dh=pe.SHA384_IV[6]|0,this.Dl=pe.SHA384_IV[7]|0,this.Eh=pe.SHA384_IV[8]|0,this.El=pe.SHA384_IV[9]|0,this.Fh=pe.SHA384_IV[10]|0,this.Fl=pe.SHA384_IV[11]|0,this.Gh=pe.SHA384_IV[12]|0,this.Gl=pe.SHA384_IV[13]|0,this.Hh=pe.SHA384_IV[14]|0,this.Hl=pe.SHA384_IV[15]|0}}et.SHA384=m1;const zt=Uint32Array.from([2352822216,424955298,1944164710,2312950998,502970286,855612546,1738396948,1479516111,258812777,2077511080,2011393907,79989058,1067287976,1780299464,286451373,2446758561]),Wt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);class y1 extends Xc{constructor(){super(28),this.Ah=zt[0]|0,this.Al=zt[1]|0,this.Bh=zt[2]|0,this.Bl=zt[3]|0,this.Ch=zt[4]|0,this.Cl=zt[5]|0,this.Dh=zt[6]|0,this.Dl=zt[7]|0,this.Eh=zt[8]|0,this.El=zt[9]|0,this.Fh=zt[10]|0,this.Fl=zt[11]|0,this.Gh=zt[12]|0,this.Gl=zt[13]|0,this.Hh=zt[14]|0,this.Hl=zt[15]|0}}et.SHA512_224=y1;class w1 extends Xc{constructor(){super(32),this.Ah=Wt[0]|0,this.Al=Wt[1]|0,this.Bh=Wt[2]|0,this.Bl=Wt[3]|0,this.Ch=Wt[4]|0,this.Cl=Wt[5]|0,this.Dh=Wt[6]|0,this.Dl=Wt[7]|0,this.Eh=Wt[8]|0,this.El=Wt[9]|0,this.Fh=Wt[10]|0,this.Fl=Wt[11]|0,this.Gh=Wt[12]|0,this.Gl=Wt[13]|0,this.Hh=Wt[14]|0,this.Hl=Wt[15]|0}}et.SHA512_256=w1;et.sha256=(0,mt.createHasher)(()=>new Dp);et.sha224=(0,mt.createHasher)(()=>new p1);et.sha512=(0,mt.createHasher)(()=>new Xc);et.sha384=(0,mt.createHasher)(()=>new m1);et.sha512_256=(0,mt.createHasher)(()=>new w1);et.sha512_224=(0,mt.createHasher)(()=>new y1);Object.defineProperty(ss,"__esModule",{value:!0});ss.sha224=ss.SHA224=b1=ss.sha256=ss.SHA256=void 0;const id=et;ss.SHA256=id.SHA256;var b1=ss.sha256=id.sha256;ss.SHA224=id.SHA224;ss.sha224=id.sha224;function RS(t,e){return b1(Ys(t,{strict:!1})?Yu(t):t)}function DS(t){const{commitment:e,version:n=1}=t,r=t.to??(typeof e=="string"?"hex":"bytes"),s=RS(e);return s.set([n],0),r==="bytes"?s:_n(s)}function $S(t){const{commitments:e,version:n}=t,r=t.to,s=[];for(const i of e)s.push(DS({commitment:i,to:r,version:n}));return s}const im=6,v1=32,$p=4096,E1=v1*$p,om=E1*im-1-1*$p*im;class kS extends z{constructor({maxSize:e,size:n}){super("Blob size is too large.",{metaMessages:[`Max: ${e} bytes`,`Given: ${n} bytes`],name:"BlobSizeTooLargeError"})}}class US extends z{constructor(){super("Blob data must not be empty.",{name:"EmptyBlobError"})}}function LS(t){const e=typeof t.data=="string"?Ur(t.data):t.data,n=_t(e);if(!n)throw new US;if(n>om)throw new kS({maxSize:om,size:n});const r=[];let s=!0,i=0;for(;s;){const o=Ap(new Uint8Array(E1));let a=0;for(;a<$p;){const c=e.slice(i,i+(v1-1));if(o.pushByte(0),o.pushBytes(c),c.length<31){o.pushByte(128),s=!1;break}a++,i+=31}r.push(o)}return r.map(o=>_n(o.bytes))}function MS(t){const{data:e,kzg:n,to:r}=t,s=t.blobs??LS({data:e}),i=t.commitments??d1({blobs:s,kzg:n,to:r}),o=t.proofs??h1({blobs:s,commitments:i,kzg:n,to:r}),a=[];for(let c=0;c<s.length;c++)a.push({blob:s[c],commitment:i[c],proof:o[c]});return a}function BS(t){if(t.type)return t.type;if(typeof t.authorizationList<"u")return"eip7702";if(typeof t.blobs<"u"||typeof t.blobVersionedHashes<"u"||typeof t.maxFeePerBlobGas<"u"||typeof t.sidecars<"u")return"eip4844";if(typeof t.maxFeePerGas<"u"||typeof t.maxPriorityFeePerGas<"u")return"eip1559";if(typeof t.gasPrice<"u")return typeof t.accessList<"u"?"eip2930":"legacy";throw new J2({transaction:t})}async function C1(t){const e=await t.request({method:"eth_chainId"},{dedupe:!0});return Oi(e)}const _1=["blobVersionedHashes","chainId","fees","gas","nonce","type"],am=new Map;async function kp(t,e){const{account:n=t.account,blobs:r,chain:s,gas:i,kzg:o,nonce:a,nonceManager:c,parameters:l=_1,type:u}=e,d=n&&Hr(n),h={...e,...d?{from:d==null?void 0:d.address}:{}};let f;async function p(){return f||(f=await lt(t,Ec,"getBlock")({blockTag:"latest"}),f)}let g;async function m(){return g||(s?s.id:typeof e.chainId<"u"?e.chainId:(g=await lt(t,C1,"getChainId")({}),g))}if(l.includes("nonce")&&typeof a>"u"&&d)if(c){const v=await m();h.nonce=await c.consume({address:d.address,chainId:v,client:t})}else h.nonce=await lt(t,IS,"getTransactionCount")({address:d.address,blockTag:"pending"});if((l.includes("blobVersionedHashes")||l.includes("sidecars"))&&r&&o){const v=d1({blobs:r,kzg:o});if(l.includes("blobVersionedHashes")){const b=$S({commitments:v,to:"hex"});h.blobVersionedHashes=b}if(l.includes("sidecars")){const b=h1({blobs:r,commitments:v,kzg:o}),y=MS({blobs:r,commitments:v,proofs:b,to:"hex"});h.sidecars=y}}if(l.includes("chainId")&&(h.chainId=await m()),(l.includes("fees")||l.includes("type"))&&typeof u>"u")try{h.type=BS(h)}catch{let v=am.get(t.uid);if(typeof v>"u"){const b=await p();v=typeof(b==null?void 0:b.baseFeePerGas)=="bigint",am.set(t.uid,v)}h.type=v?"eip1559":"legacy"}if(l.includes("fees"))if(h.type!=="legacy"&&h.type!=="eip2930"){if(typeof h.maxFeePerGas>"u"||typeof h.maxPriorityFeePerGas>"u"){const v=await p(),{maxFeePerGas:b,maxPriorityFeePerGas:y}=await cf(t,{block:v,chain:s,request:h});if(typeof e.maxPriorityFeePerGas>"u"&&e.maxFeePerGas&&e.maxFeePerGas<y)throw new CS({maxPriorityFeePerGas:y});h.maxPriorityFeePerGas=y,h.maxFeePerGas=b}}else{if(typeof e.maxFeePerGas<"u"||typeof e.maxPriorityFeePerGas<"u")throw new Rp;if(typeof e.gasPrice>"u"){const v=await p(),{gasPrice:b}=await cf(t,{block:v,chain:s,request:h,type:"legacy"});h.gasPrice=b}}return l.includes("gas")&&typeof i>"u"&&(h.gas=await lt(t,I1,"estimateGas")({...h,account:d&&{address:d.address,type:"json-rpc"}})),sd(h),delete h.parameters,h}async function A1(t,{address:e,blockNumber:n,blockTag:r="latest"}){const s=typeof n=="bigint"?Ne(n):void 0,i=await t.request({method:"eth_getBalance",params:[e,s||r]});return BigInt(i)}async function I1(t,e){var s,i,o;const{account:n=t.account}=e,r=n?Hr(n):void 0;try{let F=function(S){const{block:O,request:$,rpcStateOverride:C}=S;return t.request({method:"eth_estimateGas",params:C?[$,O??"latest",C]:O?[$,O]:[$]})};const{accessList:a,authorizationList:c,blobs:l,blobVersionedHashes:u,blockNumber:d,blockTag:h,data:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:b,nonce:y,value:N,stateOverride:_,...T}=await kp(t,{...e,parameters:(r==null?void 0:r.type)==="local"?void 0:["blobVersionedHashes"]}),D=(typeof d=="bigint"?Ne(d):void 0)||h,I=i1(_),U=await(async()=>{if(T.to)return T.to;if(c&&c.length>0)return await s1({authorization:c[0]}).catch(()=>{throw new z("`to` is required. Could not infer from `authorizationList`")})})();sd(e);const R=(o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionRequest)==null?void 0:o.format,M=(R||Op)({...Pp(T,{format:R}),from:r==null?void 0:r.address,accessList:a,authorizationList:c,blobs:l,blobVersionedHashes:u,data:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:b,nonce:y,to:U,value:N});let E=BigInt(await F({block:D,request:M,rpcStateOverride:I}));if(c){const S=await A1(t,{address:M.from}),O=await Promise.all(c.map(async $=>{const{address:C}=$,P=await F({block:D,request:{authorizationList:void 0,data:f,from:r==null?void 0:r.address,to:C,value:Ne(S)},rpcStateOverride:I}).catch(()=>100000n);return 2n*BigInt(P)}));E+=O.reduce(($,C)=>$+C,0n)}return E}catch(a){throw mS(a,{...e,account:r,chain:t.chain})}}function FS(t,e){if(!Lr(t,{strict:!1}))throw new Ri({address:t});if(!Lr(e,{strict:!1}))throw new Ri({address:e});return t.toLowerCase()===e.toLowerCase()}const cm="/docs/contract/decodeEventLog";function jS(t){const{abi:e,data:n,strict:r,topics:s}=t,i=r??!0,[o,...a]=s;if(!o)throw new FI({docsPath:cm});const c=e.find(g=>g.type==="event"&&o===wp(Ks(g)));if(!(c&&"name"in c)||c.type!=="event")throw new cb(o,{docsPath:cm});const{name:l,inputs:u}=c,d=u==null?void 0:u.some(g=>!("name"in g&&g.name)),h=d?[]:{},f=u.map((g,m)=>[g,m]).filter(([g])=>"indexed"in g&&g.indexed);for(let g=0;g<f.length;g++){const[m,v]=f[g],b=a[g];if(!b)throw new lb({abiItem:c,param:m});h[d?v:m.name||v]=HS({param:m,value:b})}const p=u.filter(g=>!("indexed"in g&&g.indexed));if(p.length>0){if(n&&n!=="0x")try{const g=nd(p,n);if(g)if(d)for(let m=0;m<u.length;m++)h[m]=h[m]??g.shift();else for(let m=0;m<p.length;m++)h[p[m].name]=g[m]}catch(g){if(i)throw g instanceof ob||g instanceof Jb?new Yh({abiItem:c,data:n,params:p,size:_t(n)}):g}else if(i)throw new Yh({abiItem:c,data:"0x",params:p,size:0})}return{eventName:l,args:Object.values(h).length>0?h:void 0}}function HS({param:t,value:e}){return t.type==="string"||t.type==="bytes"||t.type==="tuple"||t.type.match(/^(.*)\[(\d+)?\]$/)?e:(nd([t],e)||[])[0]}function qS(t){const{abi:e,args:n,logs:r,strict:s=!0}=t,i=(()=>{if(t.eventName)return Array.isArray(t.eventName)?t.eventName:[t.eventName]})();return r.map(o=>{var a;try{const c=e.find(u=>u.type==="event"&&o.topics[0]===wp(u));if(!c)return null;const l=jS({...o,abi:[c],strict:s});return i&&!i.includes(l.eventName)||!zS({args:l.args,inputs:c.inputs,matchArgs:n})?null:{...l,...o}}catch(c){let l,u;if(c instanceof cb)return null;if(c instanceof Yh||c instanceof lb){if(s)return null;l=c.abiItem.name,u=(a=c.abiItem.inputs)==null?void 0:a.some(d=>!("name"in d&&d.name))}return{...o,args:u?[]:{},eventName:l}}}).filter(Boolean)}function zS(t){const{args:e,inputs:n,matchArgs:r}=t;if(!r)return!0;if(!e)return!1;function s(i,o,a){try{return i.type==="address"?FS(o,a):i.type==="string"||i.type==="bytes"?Zc(Yu(o))===a:o===a}catch{return!1}}return Array.isArray(e)&&Array.isArray(r)?r.every((i,o)=>{if(i==null)return!0;const a=n[o];return a?(Array.isArray(i)?i:[i]).some(l=>s(a,l,e[o])):!1}):typeof e=="object"&&!Array.isArray(e)&&typeof r=="object"&&!Array.isArray(r)?Object.entries(r).every(([i,o])=>{if(o==null)return!0;const a=n.find(l=>l.name===i);return a?(Array.isArray(o)?o:[o]).some(l=>s(a,l,e[i])):!1}):!1}function S1(t,{args:e,eventName:n}={}){return{...t,blockHash:t.blockHash?t.blockHash:null,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,logIndex:t.logIndex?Number(t.logIndex):null,transactionHash:t.transactionHash?t.transactionHash:null,transactionIndex:t.transactionIndex?Number(t.transactionIndex):null,...n?{args:e,eventName:n}:{}}}const Fd="/docs/contract/decodeFunctionResult";function Up(t){const{abi:e,args:n,functionName:r,data:s}=t;let i=e[0];if(r){const a=_p({abi:e,args:n,name:r});if(!a)throw new fu(r,{docsPath:Fd});i=a}if(i.type!=="function")throw new fu(void 0,{docsPath:Fd});if(!i.outputs)throw new jI(i.name,{docsPath:Fd});const o=nd(i.outputs,s);if(o&&o.length>1)return o;if(o&&o.length===1)return o[0]}const WS="0.1.1";function VS(){return WS}let N1=class lf extends Error{constructor(e,n={}){const r=(()=>{var c;if(n.cause instanceof lf){if(n.cause.details)return n.cause.details;if(n.cause.shortMessage)return n.cause.shortMessage}return n.cause&&"details"in n.cause&&typeof n.cause.details=="string"?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof lf&&n.cause.docsPath||n.docsPath,o=`https://oxlib.sh${s??""}`,a=[e||"An error occurred.",...n.metaMessages?["",...n.metaMessages]:[],...r||s?["",r?`Details: ${r}`:void 0,s?`See: ${o}`:void 0]:[]].filter(c=>typeof c=="string").join(`
`);super(a,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:`ox@${VS()}`}),this.cause=n.cause,this.details=r,this.docs=o,this.docsPath=s,this.shortMessage=e}walk(e){return x1(this,e)}};function x1(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause?x1(t.cause,e):e?null:t}function GS(t,e={}){const{dir:n,size:r=32}=e;if(r===0)return t;const s=t.replace("0x","");if(s.length>r*2)throw new ZS({size:Math.ceil(s.length/2),targetSize:r,type:"Hex"});return`0x${s[n==="right"?"padEnd":"padStart"](r*2,"0")}`}function ts(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const l=typeof t=="bigint"?"n":"";throw new YS({max:i?`${i}${l}`:void 0,min:`${o}${l}`,signed:n,size:r,value:`${t}${l}`})}const c=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?KS(c,r):c}function KS(t,e){return GS(t,{dir:"left",size:e})}let YS=class extends N1{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number \`${i}\` is not in safe${s?` ${s*8}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${n}\` to \`${e}\`)`:`(above \`${n}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}},ZS=class extends N1{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${n}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}};function JS(t){return{...t,amount:BigInt(t.amount),index:Number(t.index),validatorIndex:Number(t.validatorIndex)}}function XS(t){return{address:t.address,amount:ts(t.amount),index:ts(t.index),validatorIndex:ts(t.validatorIndex)}}function QS(t){return{...t.baseFeePerGas&&{baseFeePerGas:BigInt(t.baseFeePerGas)},...t.blobBaseFee&&{blobBaseFee:BigInt(t.blobBaseFee)},...t.feeRecipient&&{feeRecipient:t.feeRecipient},...t.gasLimit&&{gasLimit:BigInt(t.gasLimit)},...t.number&&{number:BigInt(t.number)},...t.prevRandao&&{prevRandao:BigInt(t.prevRandao)},...t.time&&{time:BigInt(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(JS)}}}function T1(t){return{...typeof t.baseFeePerGas=="bigint"&&{baseFeePerGas:ts(t.baseFeePerGas)},...typeof t.blobBaseFee=="bigint"&&{blobBaseFee:ts(t.blobBaseFee)},...typeof t.feeRecipient=="string"&&{feeRecipient:t.feeRecipient},...typeof t.gasLimit=="bigint"&&{gasLimit:ts(t.gasLimit)},...typeof t.number=="bigint"&&{number:ts(t.number)},...typeof t.prevRandao=="bigint"&&{prevRandao:ts(t.prevRandao)},...typeof t.time=="bigint"&&{time:ts(t.time)},...t.withdrawals&&{withdrawals:t.withdrawals.map(XS)}}}const Bq=Object.freeze(Object.defineProperty({__proto__:null,fromRpc:QS,toRpc:T1},Symbol.toStringTag,{value:"Module"})),uf=[{inputs:[{components:[{name:"target",type:"address"},{name:"allowFailure",type:"bool"},{name:"callData",type:"bytes"}],name:"calls",type:"tuple[]"}],name:"aggregate3",outputs:[{components:[{name:"success",type:"bool"},{name:"returnData",type:"bytes"}],name:"returnData",type:"tuple[]"}],stateMutability:"view",type:"function"}],Fq=[{name:"query",type:"function",stateMutability:"view",inputs:[{type:"tuple[]",name:"queries",components:[{type:"address",name:"sender"},{type:"string[]",name:"urls"},{type:"bytes",name:"data"}]}],outputs:[{type:"bool[]",name:"failures"},{type:"bytes[]",name:"responses"}]},{name:"HttpError",type:"error",inputs:[{type:"uint16",name:"status"},{type:"string",name:"message"}]}],P1=[{inputs:[],name:"ResolverNotFound",type:"error"},{inputs:[],name:"ResolverWildcardNotSupported",type:"error"},{inputs:[],name:"ResolverNotContract",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"ResolverError",type:"error"},{inputs:[{components:[{name:"status",type:"uint16"},{name:"message",type:"string"}],name:"errors",type:"tuple[]"}],name:"HttpError",type:"error"}],jq=[...P1,{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]},{name:"resolve",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes"},{name:"data",type:"bytes"},{name:"gateways",type:"string[]"}],outputs:[{name:"",type:"bytes"},{name:"address",type:"address"}]}],Hq=[...P1,{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]},{name:"reverse",type:"function",stateMutability:"view",inputs:[{type:"bytes",name:"reverseName"},{type:"string[]",name:"gateways"}],outputs:[{type:"string",name:"resolvedName"},{type:"address",name:"resolvedAddress"},{type:"address",name:"reverseResolver"},{type:"address",name:"resolver"}]}],qq=[{name:"text",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"key",type:"string"}],outputs:[{name:"",type:"string"}]}],zq=[{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"}],outputs:[{name:"",type:"address"}]},{name:"addr",type:"function",stateMutability:"view",inputs:[{name:"name",type:"bytes32"},{name:"coinType",type:"uint256"}],outputs:[{name:"",type:"bytes"}]}],Wq=[{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[{name:"_signer",type:"address"},{name:"_hash",type:"bytes32"},{name:"_signature",type:"bytes"}],outputs:[{type:"bool"}],stateMutability:"nonpayable",type:"function",name:"isValidSig"}],Vq=[{type:"event",name:"Approval",inputs:[{indexed:!0,name:"owner",type:"address"},{indexed:!0,name:"spender",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"event",name:"Transfer",inputs:[{indexed:!0,name:"from",type:"address"},{indexed:!0,name:"to",type:"address"},{indexed:!1,name:"value",type:"uint256"}]},{type:"function",name:"allowance",stateMutability:"view",inputs:[{name:"owner",type:"address"},{name:"spender",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"approve",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"name",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:"string"}]},{type:"function",name:"totalSupply",stateMutability:"view",inputs:[],outputs:[{type:"uint256"}]},{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],eN="0x82ad56cb",tN="0x608060405234801561001057600080fd5b5060405161018e38038061018e83398101604081905261002f91610124565b6000808351602085016000f59050803b61004857600080fd5b6000808351602085016000855af16040513d6000823e81610067573d81fd5b3d81f35b634e487b7160e01b600052604160045260246000fd5b600082601f83011261009257600080fd5b81516001600160401b038111156100ab576100ab61006b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156100d9576100d961006b565b6040528181528382016020018510156100f157600080fd5b60005b82811015610110576020818601810151838301820152016100f4565b506000918101602001919091529392505050565b6000806040838503121561013757600080fd5b82516001600160401b0381111561014d57600080fd5b61015985828601610081565b602085015190935090506001600160401b0381111561017757600080fd5b61018385828601610081565b915050925092905056fe",nN="0x608060405234801561001057600080fd5b506040516102c03803806102c083398101604081905261002f916101e6565b836001600160a01b03163b6000036100e457600080836001600160a01b03168360405161005c9190610270565b6000604051808303816000865af19150503d8060008114610099576040519150601f19603f3d011682016040523d82523d6000602084013e61009e565b606091505b50915091508115806100b857506001600160a01b0386163b155b156100e1578060405163101bb98d60e01b81526004016100d8919061028c565b60405180910390fd5b50505b6000808451602086016000885af16040513d6000823e81610103573d81fd5b3d81f35b80516001600160a01b038116811461011e57600080fd5b919050565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561015457818101518382015260200161013c565b50506000910152565b600082601f83011261016e57600080fd5b81516001600160401b0381111561018757610187610123565b604051601f8201601f19908116603f011681016001600160401b03811182821017156101b5576101b5610123565b6040528181528382016020018510156101cd57600080fd5b6101de826020830160208701610139565b949350505050565b600080600080608085870312156101fc57600080fd5b61020585610107565b60208601519094506001600160401b0381111561022157600080fd5b61022d8782880161015d565b93505061023c60408601610107565b60608601519092506001600160401b0381111561025857600080fd5b6102648782880161015d565b91505092959194509250565b60008251610282818460208701610139565b9190910192915050565b60208152600082518060208401526102ab816040850160208701610139565b601f01601f1916919091016040019291505056fe",Gq="0x608060405234801561001057600080fd5b5060405161069438038061069483398101604081905261002f9161051e565b600061003c848484610048565b9050806000526001601ff35b60007f64926492649264926492649264926492649264926492649264926492649264926100748361040c565b036101e7576000606080848060200190518101906100929190610577565b60405192955090935091506000906001600160a01b038516906100b69085906105dd565b6000604051808303816000865af19150503d80600081146100f3576040519150601f19603f3d011682016040523d82523d6000602084013e6100f8565b606091505b50509050876001600160a01b03163b60000361016057806101605760405162461bcd60e51b815260206004820152601e60248201527f5369676e617475726556616c696461746f723a206465706c6f796d656e74000060448201526064015b60405180910390fd5b604051630b135d3f60e11b808252906001600160a01b038a1690631626ba7e90610190908b9087906004016105f9565b602060405180830381865afa1580156101ad573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101d19190610633565b6001600160e01b03191614945050505050610405565b6001600160a01b0384163b1561027a57604051630b135d3f60e11b808252906001600160a01b03861690631626ba7e9061022790879087906004016105f9565b602060405180830381865afa158015610244573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102689190610633565b6001600160e01b031916149050610405565b81516041146102df5760405162461bcd60e51b815260206004820152603a602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e6174757265206c656e6774680000000000006064820152608401610157565b6102e7610425565b5060208201516040808401518451859392600091859190811061030c5761030c61065d565b016020015160f81c9050601b811480159061032b57508060ff16601c14155b1561038c5760405162461bcd60e51b815260206004820152603b602482015260008051602061067483398151915260448201527f3a20696e76616c6964207369676e617475726520762076616c756500000000006064820152608401610157565b60408051600081526020810180835289905260ff83169181019190915260608101849052608081018390526001600160a01b0389169060019060a0016020604051602081039080840390855afa1580156103ea573d6000803e3d6000fd5b505050602060405103516001600160a01b0316149450505050505b9392505050565b600060208251101561041d57600080fd5b508051015190565b60405180606001604052806003906020820280368337509192915050565b6001600160a01b038116811461045857600080fd5b50565b634e487b7160e01b600052604160045260246000fd5b60005b8381101561048c578181015183820152602001610474565b50506000910152565b600082601f8301126104a657600080fd5b81516001600160401b038111156104bf576104bf61045b565b604051601f8201601f19908116603f011681016001600160401b03811182821017156104ed576104ed61045b565b60405281815283820160200185101561050557600080fd5b610516826020830160208701610471565b949350505050565b60008060006060848603121561053357600080fd5b835161053e81610443565b6020850151604086015191945092506001600160401b0381111561056157600080fd5b61056d86828701610495565b9150509250925092565b60008060006060848603121561058c57600080fd5b835161059781610443565b60208501519093506001600160401b038111156105b357600080fd5b6105bf86828701610495565b604086015190935090506001600160401b0381111561056157600080fd5b600082516105ef818460208701610471565b9190910192915050565b828152604060208201526000825180604084015261061e816060850160208701610471565b601f01601f1916919091016060019392505050565b60006020828403121561064557600080fd5b81516001600160e01b03198116811461040557600080fd5b634e487b7160e01b600052603260045260246000fdfe5369676e617475726556616c696461746f72237265636f7665725369676e6572";class df extends z{constructor({blockNumber:e,chain:n,contract:r}){super(`Chain "${n.name}" does not support contract "${r.name}".`,{metaMessages:["This could be due to any of the following:",...e&&r.blockCreated&&r.blockCreated>e?[`- The contract "${r.name}" was not deployed until block ${r.blockCreated} (current block ${e}).`]:[`- The chain does not have the contract "${r.name}" configured.`]],name:"ChainDoesNotSupportContract"})}}class rN extends z{constructor({chain:e,currentChainId:n}){super(`The current chain of the wallet (id: ${n}) does not match the target chain for the transaction (id: ${e.id} – ${e.name}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e.id} – ${e.name}`],name:"ChainMismatchError"})}}class sN extends z{constructor(){super(["No chain was provided to the request.","Please provide a chain with the `chain` argument on the Action, or by supplying a `chain` to WalletClient."].join(`
`),{name:"ChainNotFoundError"})}}class O1 extends z{constructor(){super("No chain was provided to the Client.",{name:"ClientChainNotConfiguredError"})}}const jd="/docs/contract/encodeDeployData";function R1(t){const{abi:e,args:n,bytecode:r}=t;if(!n||n.length===0)return r;const s=e.find(o=>"type"in o&&o.type==="constructor");if(!s)throw new UI({docsPath:jd});if(!("inputs"in s))throw new Gg({docsPath:jd});if(!s.inputs||s.inputs.length===0)throw new Gg({docsPath:jd});const i=Yb(s.inputs,n);return ed([r,i])}function D1({blockNumber:t,chain:e,contract:n}){var s;const r=(s=e==null?void 0:e.contracts)==null?void 0:s[n];if(!r)throw new df({chain:e,contract:{name:n}});if(t&&r.blockCreated&&r.blockCreated>t)throw new df({blockNumber:t,chain:e,contract:{name:n,blockCreated:r.blockCreated}});return r.address}function iN(t,{docsPath:e,...n}){const r=(()=>{const s=Tp(t,n);return s instanceof rd?t:s})();return new tS(r,{docsPath:e,...n})}function $1(){let t=()=>{},e=()=>{};return{promise:new Promise((r,s)=>{t=r,e=s}),resolve:t,reject:e}}const Hd=new Map;function k1({fn:t,id:e,shouldSplitBatch:n,wait:r=0,sort:s}){const i=async()=>{const u=c();o();const d=u.map(({args:h})=>h);d.length!==0&&t(d).then(h=>{s&&Array.isArray(h)&&h.sort(s);for(let f=0;f<u.length;f++){const{resolve:p}=u[f];p==null||p([h[f],h])}}).catch(h=>{for(let f=0;f<u.length;f++){const{reject:p}=u[f];p==null||p(h)}})},o=()=>Hd.delete(e),a=()=>c().map(({args:u})=>u),c=()=>Hd.get(e)||[],l=u=>Hd.set(e,[...c(),u]);return{flush:o,async schedule(u){const{promise:d,resolve:h,reject:f}=$1();return(n==null?void 0:n([...a(),u]))&&i(),c().length>0?(l({args:u,resolve:h,reject:f}),d):(l({args:u,resolve:h,reject:f}),setTimeout(i,r),d)}}}async function U1(t,e){var M,F,E,S;const{account:n=t.account,authorizationList:r,batch:s=!!((M=t.batch)!=null&&M.multicall),blockNumber:i,blockTag:o="latest",accessList:a,blobs:c,blockOverrides:l,code:u,data:d,factory:h,factoryData:f,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:b,nonce:y,to:N,value:_,stateOverride:T,...x}=e,D=n?Hr(n):void 0;if(u&&(h||f))throw new z("Cannot provide both `code` & `factory`/`factoryData` as parameters.");if(u&&N)throw new z("Cannot provide both `code` & `to` as parameters.");const I=u&&d,U=h&&f&&N&&d,R=I||U,k=I?cN({code:u,data:d}):U?lN({data:d,factory:h,factoryData:f,to:N}):d;try{sd(e);const $=(typeof i=="bigint"?Ne(i):void 0)||o,C=l?T1(l):void 0,P=i1(T),B=(S=(E=(F=t.chain)==null?void 0:F.formatters)==null?void 0:E.transactionRequest)==null?void 0:S.format,G=(B||Op)({...Pp(x,{format:B}),from:D==null?void 0:D.address,accessList:a,authorizationList:r,blobs:c,data:k,gas:p,gasPrice:g,maxFeePerBlobGas:m,maxFeePerGas:v,maxPriorityFeePerGas:b,nonce:y,to:R?void 0:N,value:_});if(s&&oN({request:G})&&!P&&!C)try{return await aN(t,{...G,blockNumber:i,blockTag:o})}catch(ue){if(!(ue instanceof O1)&&!(ue instanceof df))throw ue}const W=(()=>{const ue=[G,$];return P&&C?[...ue,P,C]:P?[...ue,P]:C?[...ue,{},C]:ue})(),se=await t.request({method:"eth_call",params:W});return se==="0x"?{data:void 0}:{data:se}}catch(O){const $=uN(O),{offchainLookup:C,offchainLookupSignature:P}=await Qt(async()=>{const{offchainLookup:B,offchainLookupSignature:H}=await import("./BSA-I0eW.js");return{offchainLookup:B,offchainLookupSignature:H}},__vite__mapDeps([3,4]),import.meta.url);if(t.ccipRead!==!1&&($==null?void 0:$.slice(0,10))===P&&N)return{data:await C(t,{data:$,to:N})};throw R&&($==null?void 0:$.slice(0,10))==="0x101bb98d"?new sS({factory:h}):iN(O,{...e,account:D,chain:t.chain})}}function oN({request:t}){const{data:e,to:n,...r}=t;return!(!e||e.startsWith(eN)||!n||Object.values(r).filter(s=>typeof s<"u").length>0)}async function aN(t,e){var g;const{batchSize:n=1024,wait:r=0}=typeof((g=t.batch)==null?void 0:g.multicall)=="object"?t.batch.multicall:{},{blockNumber:s,blockTag:i="latest",data:o,multicallAddress:a,to:c}=e;let l=a;if(!l){if(!t.chain)throw new O1;l=D1({blockNumber:s,chain:t.chain,contract:"multicall3"})}const d=(typeof s=="bigint"?Ne(s):void 0)||i,{schedule:h}=k1({id:`${t.uid}.${d}`,wait:r,shouldSplitBatch(m){return m.reduce((b,{data:y})=>b+(y.length-2),0)>n*2},fn:async m=>{const v=m.map(N=>({allowFailure:!0,callData:N.data,target:N.to})),b=td({abi:uf,args:[v],functionName:"aggregate3"}),y=await t.request({method:"eth_call",params:[{data:b,to:l},d]});return Up({abi:uf,args:[v],functionName:"aggregate3",data:y||"0x"})}}),[{returnData:f,success:p}]=await h({data:o,to:c});if(!p)throw new Np({data:f});return f==="0x"?{data:void 0}:{data:f}}function cN(t){const{code:e,data:n}=t;return R1({abi:rb(["constructor(bytes, bytes)"]),bytecode:tN,args:[e,n]})}function lN(t){const{data:e,factory:n,factoryData:r,to:s}=t;return R1({abi:rb(["constructor(address, bytes, address, bytes)"]),bytecode:nN,args:[s,e,n,r]})}function uN(t){var n;if(!(t instanceof z))return;const e=t.walk();return typeof(e==null?void 0:e.data)=="object"?(n=e.data)==null?void 0:n.data:e.data}async function L1(t,e){const{abi:n,address:r,args:s,functionName:i,...o}=e,a=td({abi:n,args:s,functionName:i});try{const{data:c}=await lt(t,U1,"call")({...o,data:a,to:r});return Up({abi:n,args:s,functionName:i,data:c||"0x"})}catch(c){throw gu(c,{abi:n,address:r,args:s,docsPath:"/docs/contract/readContract",functionName:i})}}const qd=new Map,lm=new Map;let dN=0;function wu(t,e,n){const r=++dN,s=()=>qd.get(t)||[],i=()=>{const u=s();qd.set(t,u.filter(d=>d.id!==r))},o=()=>{const u=s();if(!u.some(h=>h.id===r))return;const d=lm.get(t);if(u.length===1&&d){const h=d();h instanceof Promise&&h.catch(()=>{})}i()},a=s();if(qd.set(t,[...a,{id:r,fns:e}]),a&&a.length>0)return o;const c={};for(const u in e)c[u]=(...d)=>{var f,p;const h=s();if(h.length!==0)for(const g of h)(p=(f=g.fns)[u])==null||p.call(f,...d)};const l=n(c);return typeof l=="function"&&lm.set(t,l),o}async function bu(t){return new Promise(e=>setTimeout(e,t))}function M1(t,{emitOnBegin:e,initialWaitTime:n,interval:r}){let s=!0;const i=()=>s=!1;return(async()=>{let a;e&&(a=await t({unpoll:i}));const c=await(n==null?void 0:n(a))??r;await bu(c);const l=async()=>{s&&(await t({unpoll:i}),await bu(r),l())};l()})(),i}const hN=new Map,fN=new Map;function pN(t){const e=(s,i)=>({clear:()=>i.delete(s),get:()=>i.get(s),set:o=>i.set(s,o)}),n=e(t,hN),r=e(t,fN);return{clear:()=>{n.clear(),r.clear()},promise:n,response:r}}async function gN(t,{cacheKey:e,cacheTime:n=Number.POSITIVE_INFINITY}){const r=pN(e),s=r.response.get();if(s&&n>0&&new Date().getTime()-s.created.getTime()<n)return s.data;let i=r.promise.get();i||(i=t(),r.promise.set(i));try{const o=await i;return r.response.set({created:new Date,data:o}),o}finally{r.promise.clear()}}const mN=t=>`blockNumber.${t}`;async function yN(t,{cacheTime:e=t.cacheTime}={}){const n=await gN(()=>t.request({method:"eth_blockNumber"}),{cacheKey:mN(t.uid),cacheTime:e});return BigInt(n)}async function wN(t,{filter:e}){const n="strict"in e&&e.strict,r=await e.request({method:"eth_getFilterChanges",params:[e.id]});if(typeof r[0]=="string")return r;const s=r.map(i=>S1(i));return!("abi"in e)||!e.abi?s:qS({abi:e.abi,logs:s,strict:n})}async function bN(t,{filter:e}){return e.request({method:"eth_uninstallFilter",params:[e.id]})}class Lp extends z{constructor({docsPath:e}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:e,docsSlug:"account",name:"AccountNotFoundError"})}}class zd extends z{constructor({docsPath:e,metaMessages:n,type:r}){super(`Account type "${r}" is not supported.`,{docsPath:e,metaMessages:n,name:"AccountTypeNotSupportedError"})}}function vN({chain:t,currentChainId:e}){if(!t)throw new sN;if(e!==t.id)throw new rN({chain:t,currentChainId:e})}function EN(t,{docsPath:e,...n}){const r=(()=>{const s=Tp(t,n);return s instanceof rd?t:s})();return new X2(r,{docsPath:e,...n})}async function CN(t,{serializedTransaction:e}){return t.request({method:"eth_sendRawTransaction",params:[e]},{retryCount:0})}const Wd=new Xu(128);async function B1(t,e){var b,y,N,_;const{account:n=t.account,chain:r=t.chain,accessList:s,authorizationList:i,blobs:o,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,type:p,value:g,...m}=e;if(typeof n>"u")throw new Lp({docsPath:"/docs/actions/wallet/sendTransaction"});const v=n?Hr(n):null;try{sd(e);const T=await(async()=>{if(e.to)return e.to;if(e.to!==null&&i&&i.length>0)return await s1({authorization:i[0]}).catch(()=>{throw new z("`to` is required. Could not infer from `authorizationList`.")})})();if((v==null?void 0:v.type)==="json-rpc"||v===null){let x;r!==null&&(x=await lt(t,C1,"getChainId")({}),vN({currentChainId:x,chain:r}));const D=(N=(y=(b=t.chain)==null?void 0:b.formatters)==null?void 0:y.transactionRequest)==null?void 0:N.format,U=(D||Op)({...Pp(m,{format:D}),accessList:s,authorizationList:i,blobs:o,chainId:x,data:a,from:v==null?void 0:v.address,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,to:T,type:p,value:g}),R=Wd.get(t.uid),k=R?"wallet_sendTransaction":"eth_sendTransaction";try{return await t.request({method:k,params:[U]},{retryCount:0})}catch(M){if(R===!1)throw M;const F=M;if(F.name==="InvalidInputRpcError"||F.name==="InvalidParamsRpcError"||F.name==="MethodNotFoundRpcError"||F.name==="MethodNotSupportedRpcError")return await t.request({method:"wallet_sendTransaction",params:[U]},{retryCount:0}).then(E=>(Wd.set(t.uid,!0),E)).catch(E=>{const S=E;throw S.name==="MethodNotFoundRpcError"||S.name==="MethodNotSupportedRpcError"?(Wd.set(t.uid,!1),F):S});throw F}}if((v==null?void 0:v.type)==="local"){const x=await lt(t,kp,"prepareTransactionRequest")({account:v,accessList:s,authorizationList:i,blobs:o,chain:r,data:a,gas:c,gasPrice:l,maxFeePerBlobGas:u,maxFeePerGas:d,maxPriorityFeePerGas:h,nonce:f,nonceManager:v.nonceManager,parameters:[..._1,"sidecars"],type:p,value:g,...m,to:T}),D=(_=r==null?void 0:r.serializers)==null?void 0:_.transaction,I=await v.signTransaction(x,{serializer:D});return await lt(t,CN,"sendRawTransaction")({serializedTransaction:I})}throw(v==null?void 0:v.type)==="smart"?new zd({metaMessages:["Consider using the `sendUserOperation` Action instead."],docsPath:"/docs/actions/bundler/sendUserOperation",type:"smart"}):new zd({docsPath:"/docs/actions/wallet/sendTransaction",type:v==null?void 0:v.type})}catch(T){throw T instanceof zd?T:EN(T,{...e,account:v,chain:e.chain||void 0})}}async function _N(t,e){const{abi:n,account:r=t.account,address:s,args:i,dataSuffix:o,functionName:a,...c}=e;if(typeof r>"u")throw new Lp({docsPath:"/docs/contract/writeContract"});const l=r?Hr(r):null,u=td({abi:n,args:i,functionName:a});try{return await lt(t,B1,"sendTransaction")({data:`${u}${o?o.replace("0x",""):""}`,to:s,account:l,...c})}catch(d){throw gu(d,{abi:n,address:s,args:i,docsPath:"/docs/contract/writeContract",functionName:a,sender:l==null?void 0:l.address})}}const AN={"0x0":"reverted","0x1":"success"};function IN(t){const e={...t,blockNumber:t.blockNumber?BigInt(t.blockNumber):null,contractAddress:t.contractAddress?t.contractAddress:null,cumulativeGasUsed:t.cumulativeGasUsed?BigInt(t.cumulativeGasUsed):null,effectiveGasPrice:t.effectiveGasPrice?BigInt(t.effectiveGasPrice):null,gasUsed:t.gasUsed?BigInt(t.gasUsed):null,logs:t.logs?t.logs.map(n=>S1(n)):null,to:t.to?t.to:null,transactionIndex:t.transactionIndex?Oi(t.transactionIndex):null,status:t.status?AN[t.status]:null,type:t.type?a1[t.type]||t.type:null};return t.blobGasPrice&&(e.blobGasPrice=BigInt(t.blobGasPrice)),t.blobGasUsed&&(e.blobGasUsed=BigInt(t.blobGasUsed)),e}const hf=256;let wl=hf,bl;function F1(t=11){if(!bl||wl+t>hf*2){bl="",wl=0;for(let e=0;e<hf;e++)bl+=(256+Math.random()*256|0).toString(16).substring(1)}return bl.substring(wl,wl+++t)}function j1(t){const{batch:e,chain:n,ccipRead:r,key:s="base",name:i="Base Client",type:o="base"}=t,a=(n==null?void 0:n.blockTime)??12e3,c=Math.min(Math.max(Math.floor(a/2),500),4e3),l=t.pollingInterval??c,u=t.cacheTime??l,d=t.account?Hr(t.account):void 0,{config:h,request:f,value:p}=t.transport({chain:n,pollingInterval:l}),g={...h,...p},m={account:d,batch:e,cacheTime:u,ccipRead:r,chain:n,key:s,name:i,pollingInterval:l,request:f,transport:g,type:o,uid:F1()};function v(b){return y=>{const N=y(b);for(const T in m)delete N[T];const _={...b,...N};return Object.assign(_,{extend:v(_)})}}return Object.assign(m,{extend:v(m)})}const vl=new Xu(8192);function SN(t,{enabled:e=!0,id:n}){if(!e||!n)return t();if(vl.get(n))return vl.get(n);const r=t().finally(()=>vl.delete(n));return vl.set(n,r),r}function vu(t,{delay:e=100,retryCount:n=2,shouldRetry:r=()=>!0}={}){return new Promise((s,i)=>{const o=async({count:a=0}={})=>{const c=async({error:l})=>{const u=typeof e=="function"?e({count:a,error:l}):e;u&&await bu(u),o({count:a+1})};try{const l=await t();s(l)}catch(l){if(a<n&&await r({count:a,error:l}))return c({error:l});i(l)}};o()})}function NN(t,e={}){return async(n,r={})=>{var d;const{dedupe:s=!1,methods:i,retryDelay:o=150,retryCount:a=3,uid:c}={...e,...r},{method:l}=n;if((d=i==null?void 0:i.exclude)!=null&&d.includes(l))throw new yi(new Error("method not supported"),{method:l});if(i!=null&&i.include&&!i.include.includes(l))throw new yi(new Error("method not supported"),{method:l});const u=s?Ku(`${c}.${Gn(n)}`):void 0;return SN(()=>vu(async()=>{try{return await t(n)}catch(h){const f=h;switch(f.code){case rc.code:throw new rc(f);case sc.code:throw new sc(f);case ic.code:throw new ic(f,{method:n.method});case oc.code:throw new oc(f);case Di.code:throw new Di(f);case ac.code:throw new ac(f);case cc.code:throw new cc(f);case js.code:throw new js(f);case Lo.code:throw new Lo(f);case yi.code:throw new yi(f,{method:n.method});case Mo.code:throw new Mo(f);case lc.code:throw new lc(f);case Et.code:throw new Et(f);case uc.code:throw new uc(f);case dc.code:throw new dc(f);case hc.code:throw new hc(f);case fc.code:throw new fc(f);case Mr.code:throw new Mr(f);case pc.code:throw new pc(f);case gc.code:throw new gc(f);case mc.code:throw new mc(f);case yc.code:throw new yc(f);case wc.code:throw new wc(f);case bc.code:throw new bc(f);case vc.code:throw new vc(f);case 5e3:throw new Et(f);default:throw h instanceof z?h:new oS(f)}}},{delay:({count:h,error:f})=>{var p;if(f&&f instanceof Ua){const g=(p=f==null?void 0:f.headers)==null?void 0:p.get("Retry-After");if(g!=null&&g.match(/\d/))return Number.parseInt(g)*1e3}return~~(1<<h)*o},retryCount:a,shouldRetry:({error:h})=>xN(h)}),{enabled:s,id:u})}}function xN(t){return"code"in t&&typeof t.code=="number"?t.code===-1||t.code===Mo.code||t.code===Di.code:t instanceof Ua&&t.status?t.status===403||t.status===408||t.status===413||t.status===429||t.status===500||t.status===502||t.status===503||t.status===504:!0}function Mp({key:t,methods:e,name:n,request:r,retryCount:s=3,retryDelay:i=150,timeout:o,type:a},c){const l=F1();return{config:{key:t,methods:e,name:n,request:r,retryCount:s,retryDelay:i,timeout:o,type:a},request:NN(r,{methods:e,retryCount:s,retryDelay:i,uid:l}),value:c}}function TN(t,e={}){const{key:n="custom",methods:r,name:s="Custom Provider",retryDelay:i}=e;return({retryCount:o})=>Mp({key:n,methods:r,name:s,request:t.request.bind(t),retryCount:e.retryCount??o,retryDelay:i,type:"custom"})}function um(t,e={}){const{key:n="fallback",name:r="Fallback",rank:s=!1,shouldThrow:i=PN,retryCount:o,retryDelay:a}=e;return({chain:c,pollingInterval:l=4e3,timeout:u,...d})=>{let h=t,f=()=>{};const p=Mp({key:n,name:r,async request({method:g,params:m}){let v;const b=async(y=0)=>{const N=h[y]({...d,chain:c,retryCount:0,timeout:u});try{const _=await N.request({method:g,params:m});return f({method:g,params:m,response:_,transport:N,status:"success"}),_}catch(_){if(f({error:_,method:g,params:m,transport:N,status:"error"}),i(_)||y===h.length-1||(v??(v=h.slice(y+1).some(T=>{const{include:x,exclude:D}=T({chain:c}).config.methods||{};return x?x.includes(g):D?!D.includes(g):!0})),!v))throw _;return b(y+1)}};return b()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:g=>f=g,transports:h.map(g=>g({chain:c,retryCount:0}))});if(s){const g=typeof s=="object"?s:{};ON({chain:c,interval:g.interval??l,onTransports:m=>h=m,ping:g.ping,sampleCount:g.sampleCount,timeout:g.timeout,transports:h,weights:g.weights})}return p}}function PN(t){return!!("code"in t&&typeof t.code=="number"&&(t.code===Lo.code||t.code===Et.code||wi.nodeMessage.test(t.message)||t.code===5e3))}function ON({chain:t,interval:e=4e3,onTransports:n,ping:r,sampleCount:s=10,timeout:i=1e3,transports:o,weights:a={}}){const{stability:c=.7,latency:l=.3}=a,u=[],d=async()=>{const h=await Promise.all(o.map(async g=>{const m=g({chain:t,retryCount:0,timeout:i}),v=Date.now();let b,y;try{await(r?r({transport:m}):m.request({method:"net_listening"})),y=1}catch{y=0}finally{b=Date.now()}return{latency:b-v,success:y}}));u.push(h),u.length>s&&u.shift();const f=Math.max(...u.map(g=>Math.max(...g.map(({latency:m})=>m)))),p=o.map((g,m)=>{const v=u.map(T=>T[m].latency),y=1-v.reduce((T,x)=>T+x,0)/v.length/f,N=u.map(T=>T[m].success),_=N.reduce((T,x)=>T+x,0)/N.length;return _===0?[0,m]:[l*y+c*_,m]}).sort((g,m)=>m[0]-g[0]);n(p.map(([,g])=>o[g])),await bu(e),d()};d()}class RN extends z{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}function H1(t,{errorInstance:e=new Error("timed out"),timeout:n,signal:r}){return new Promise((s,i)=>{(async()=>{let o;try{const a=new AbortController;n>0&&(o=setTimeout(()=>{r?a.abort():i(e)},n)),s(await t({signal:(a==null?void 0:a.signal)||null}))}catch(a){(a==null?void 0:a.name)==="AbortError"&&i(e),i(a)}finally{clearTimeout(o)}})()})}function DN(){return{current:0,take(){return this.current++},reset(){this.current=0}}}const dm=DN();function $N(t,e={}){return{async request(n){var d;const{body:r,onRequest:s=e.onRequest,onResponse:i=e.onResponse,timeout:o=e.timeout??1e4}=n,a={...e.fetchOptions??{},...n.fetchOptions??{}},{headers:c,method:l,signal:u}=a;try{const h=await H1(async({signal:p})=>{const g={...a,body:Array.isArray(r)?Gn(r.map(y=>({jsonrpc:"2.0",id:y.id??dm.take(),...y}))):Gn({jsonrpc:"2.0",id:r.id??dm.take(),...r}),headers:{"Content-Type":"application/json",...c},method:l||"POST",signal:u||(o>0?p:null)},m=new Request(t,g),v=await(s==null?void 0:s(m,g))??{...g,url:t};return await fetch(v.url??t,v)},{errorInstance:new nm({body:r,url:t}),timeout:o,signal:!0});i&&await i(h);let f;if((d=h.headers.get("Content-Type"))!=null&&d.startsWith("application/json"))f=await h.json();else{f=await h.text();try{f=JSON.parse(f||"{}")}catch(p){if(h.ok)throw p;f={error:f}}}if(!h.ok)throw new Ua({body:r,details:Gn(f.error)||h.statusText,headers:h.headers,status:h.status,url:t});return f}catch(h){throw h instanceof Ua||h instanceof nm?h:new Ua({body:r,cause:h,url:t})}}}}function El(t,e={}){const{batch:n,fetchOptions:r,key:s="http",methods:i,name:o="HTTP JSON-RPC",onFetchRequest:a,onFetchResponse:c,retryDelay:l,raw:u}=e;return({chain:d,retryCount:h,timeout:f})=>{const{batchSize:p=1e3,wait:g=0}=typeof n=="object"?n:{},m=e.retryCount??h,v=f??e.timeout??1e4,b=t||(d==null?void 0:d.rpcUrls.default.http[0]);if(!b)throw new RN;const y=$N(b,{fetchOptions:r,onRequest:a,onResponse:c,timeout:v});return Mp({key:s,methods:i,name:o,async request({method:N,params:_}){const T={method:N,params:_},{schedule:x}=k1({id:b,wait:g,shouldSplitBatch(R){return R.length>p},fn:R=>y.request({body:R}),sort:(R,k)=>R.id-k.id}),D=async R=>n?x(R):[await y.request({body:R})],[{error:I,result:U}]=await D(T);if(u)return{error:I,result:U};if(I)throw new xp({body:T,error:I,url:b});return U},retryCount:m,retryDelay:l,timeout:v,type:"http"},{fetchOptions:r,url:b})}}async function kN(t){const e=S2(t,{method:"eth_newPendingTransactionFilter"}),n=await t.request({method:"eth_newPendingTransactionFilter"});return{id:n,request:e(n),type:"transaction"}}function UN(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}class LN extends z{constructor({value:e}){super(`Number \`${e}\` is not a valid decimal number.`,{name:"InvalidDecimalNumberError"})}}function MN(t,e){if(!/^(-?)([0-9]*)\.?([0-9]*)$/.test(t))throw new LN({value:t});let[n,r="0"]=t.split(".");const s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),e===0)Math.round(+`.${r}`)===1&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>e){const[i,o,a]=[r.slice(0,e-1),r.slice(e-1,e),r.slice(e)],c=Math.round(+`${o}.${a}`);c>9?r=`${BigInt(i)+BigInt(1)}0`.padStart(i.length+1,"0"):r=`${i}${c}`,r.length>e&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,e)}else r=r.padEnd(e,"0");return BigInt(`${s?"-":""}${n}${r}`)}async function q1(t,{blockHash:e,blockNumber:n,blockTag:r,hash:s,index:i}){var u,d,h;const o=r||"latest",a=n!==void 0?Ne(n):void 0;let c=null;if(s?c=await t.request({method:"eth_getTransactionByHash",params:[s]},{dedupe:!0}):e?c=await t.request({method:"eth_getTransactionByBlockHashAndIndex",params:[e,Ne(i)]},{dedupe:!0}):c=await t.request({method:"eth_getTransactionByBlockNumberAndIndex",params:[a||o,Ne(i)]},{dedupe:!!a}),!c)throw new Qb({blockHash:e,blockNumber:n,blockTag:o,hash:s,index:i});return(((h=(d=(u=t.chain)==null?void 0:u.formatters)==null?void 0:d.transaction)==null?void 0:h.format)||c1)(c)}async function hm(t,{hash:e}){var s,i,o;const n=await t.request({method:"eth_getTransactionReceipt",params:[e]},{dedupe:!0});if(!n)throw new e1({hash:e});return(((o=(i=(s=t.chain)==null?void 0:s.formatters)==null?void 0:i.transactionReceipt)==null?void 0:o.format)||IN)(n)}async function BN(t,e){var v;const{account:n,allowFailure:r=!0,batchSize:s,blockNumber:i,blockTag:o,multicallAddress:a,stateOverride:c}=e,l=e.contracts,u=s??(typeof((v=t.batch)==null?void 0:v.multicall)=="object"&&t.batch.multicall.batchSize||1024);let d=a;if(!d){if(!t.chain)throw new Error("client chain not configured. multicallAddress is required.");d=D1({blockNumber:i,chain:t.chain,contract:"multicall3"})}const h=[[]];let f=0,p=0;for(let b=0;b<l.length;b++){const{abi:y,address:N,args:_,functionName:T}=l[b];try{const x=td({abi:y,args:_,functionName:T});p+=(x.length-2)/2,u>0&&p>u&&h[f].length>0&&(f++,p=(x.length-2)/2,h[f]=[]),h[f]=[...h[f],{allowFailure:!0,callData:x,target:N}]}catch(x){const D=gu(x,{abi:y,address:N,args:_,docsPath:"/docs/contract/multicall",functionName:T,sender:n});if(!r)throw D;h[f]=[...h[f],{allowFailure:!0,callData:"0x",target:N}]}}const g=await Promise.allSettled(h.map(b=>lt(t,L1,"readContract")({abi:uf,account:n,address:d,args:[b],blockNumber:i,blockTag:o,functionName:"aggregate3",stateOverride:c}))),m=[];for(let b=0;b<g.length;b++){const y=g[b];if(y.status==="rejected"){if(!r)throw y.reason;for(let _=0;_<h[b].length;_++)m.push({status:"failure",error:y.reason,result:void 0});continue}const N=y.value;for(let _=0;_<N.length;_++){const{returnData:T,success:x}=N[_],{callData:D}=h[b][_],{abi:I,address:U,functionName:R,args:k}=l[m.length];try{if(D==="0x")throw new Gu;if(!x)throw new Np({data:T});const M=Up({abi:I,args:k,data:T,functionName:R});m.push(r?{result:M,status:"success"}:M)}catch(M){const F=gu(M,{abi:I,address:U,args:k,docsPath:"/docs/contract/multicall",functionName:R});if(!r)throw F;m.push({error:F,result:void 0,status:"failure"})}}}if(m.length!==l.length)throw new z("multicall results mismatch");return m}const FN=BigInt(0),ua=BigInt(1),jN=BigInt(2),HN=BigInt(7),qN=BigInt(256),zN=BigInt(113),z1=[],W1=[],V1=[];for(let t=0,e=ua,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],z1.push(2*(5*r+n)),W1.push((t+1)*(t+2)/2%64);let s=FN;for(let i=0;i<7;i++)e=(e<<ua^(e>>HN)*zN)%qN,e&jN&&(s^=ua<<(ua<<BigInt(i))-ua);V1.push(s)}const G1=M_(V1,!0),WN=G1[0],VN=G1[1],fm=(t,e,n)=>n>32?U_(t,e,n):$_(t,e,n),pm=(t,e,n)=>n>32?L_(t,e,n):k_(t,e,n);function K1(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=fm(l,u,1)^n[a],h=pm(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=W1[o],c=fm(s,i,a),l=pm(s,i,a),u=z1[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=WN[r],t[1]^=VN[r]}Uw(n)}class Qc extends B_{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,$g(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=F_(this.state)}clone(){return this._cloneInto()}keccak(){kg(this.state32),K1(this.state32,this.rounds),kg(this.state32),this.posOut=0,this.pos=0}update(e){Ug(this),e=j_(e),Lg(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Ug(this,!1),Lg(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return $g(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(H_(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Uw(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new Qc(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}}const ti=(t,e,n)=>R_(()=>new Qc(e,t,n)),GN=ti(6,144,224/8),KN=ti(6,136,256/8),YN=ti(6,104,384/8),ZN=ti(6,72,512/8),JN=ti(1,144,224/8),Y1=ti(1,136,256/8),XN=ti(1,104,384/8),QN=ti(1,72,512/8),Z1=(t,e,n)=>D_((r={})=>new Qc(e,t,r.dkLen===void 0?n:r.dkLen,!0)),ex=Z1(31,168,128/8),tx=Z1(31,136,256/8),Kq=Object.freeze(Object.defineProperty({__proto__:null,Keccak:Qc,keccakP:K1,keccak_224:JN,keccak_256:Y1,keccak_384:XN,keccak_512:QN,sha3_224:GN,sha3_256:KN,sha3_384:YN,sha3_512:ZN,shake128:ex,shake256:tx},Symbol.toStringTag,{value:"Module"}));function nx(t,{emitOnBegin:e=!1,emitMissed:n=!1,onBlockNumber:r,onError:s,poll:i,pollingInterval:o=t.pollingInterval}){const a=typeof i<"u"?i:!(t.transport.type==="webSocket"||t.transport.type==="ipc"||t.transport.type==="fallback"&&(t.transport.transports[0].config.type==="webSocket"||t.transport.transports[0].config.type==="ipc"));let c;return a?(()=>{const d=Gn(["watchBlockNumber",t.uid,e,n,o]);return wu(d,{onBlockNumber:r,onError:s},h=>M1(async()=>{var f;try{const p=await lt(t,yN,"getBlockNumber")({cacheTime:0});if(c){if(p===c)return;if(p-c>1&&n)for(let g=c+1n;g<p;g++)h.onBlockNumber(g,c),c=g}(!c||p>c)&&(h.onBlockNumber(p,c),c=p)}catch(p){(f=h.onError)==null||f.call(h,p)}},{emitOnBegin:e,interval:o}))})():(()=>{const d=Gn(["watchBlockNumber",t.uid,e,n]);return wu(d,{onBlockNumber:r,onError:s},h=>{let f=!0,p=()=>f=!1;return(async()=>{try{const g=(()=>{if(t.transport.type==="fallback"){const v=t.transport.transports.find(b=>b.config.type==="webSocket"||b.config.type==="ipc");return v?v.value:t.transport}return t.transport})(),{unsubscribe:m}=await g.subscribe({params:["newHeads"],onData(v){var y;if(!f)return;const b=$o((y=v.result)==null?void 0:y.number);h.onBlockNumber(b,c),c=b},onError(v){var b;(b=h.onError)==null||b.call(h,v)}});p=m,f||p()}catch(g){s==null||s(g)}})(),()=>p()})})()}async function rx(t,{confirmations:e=1,hash:n,onReplaced:r,pollingInterval:s=t.pollingInterval,retryCount:i=6,retryDelay:o=({count:c})=>~~(1<<c)*200,timeout:a=18e4}){const c=Gn(["waitForTransactionReceipt",t.uid,n]);let l,u,d,h=!1,f,p;const{promise:g,resolve:m,reject:v}=$1(),b=a?setTimeout(()=>{p(),f(),v(new Q2({hash:n}))},a):void 0;return f=wu(c,{onReplaced:r,resolve:m,reject:v},y=>{p=lt(t,nx,"watchBlockNumber")({emitMissed:!0,emitOnBegin:!0,poll:!0,pollingInterval:s,async onBlockNumber(N){const _=x=>{clearTimeout(b),p(),x(),f()};let T=N;if(!h)try{if(d){if(e>1&&(!d.blockNumber||T-d.blockNumber+1n<e))return;_(()=>y.resolve(d));return}if(l||(h=!0,await vu(async()=>{l=await lt(t,q1,"getTransaction")({hash:n}),l.blockNumber&&(T=l.blockNumber)},{delay:o,retryCount:i}),h=!1),d=await lt(t,hm,"getTransactionReceipt")({hash:n}),e>1&&(!d.blockNumber||T-d.blockNumber+1n<e))return;_(()=>y.resolve(d))}catch(x){if(x instanceof Qb||x instanceof e1){if(!l){h=!1;return}try{u=l,h=!0;const D=await vu(()=>lt(t,Ec,"getBlock")({blockNumber:T,includeTransactions:!0}),{delay:o,retryCount:i,shouldRetry:({error:R})=>R instanceof o1});h=!1;const I=D.transactions.find(({from:R,nonce:k})=>R===u.from&&k===u.nonce);if(!I||(d=await lt(t,hm,"getTransactionReceipt")({hash:I.hash}),e>1&&(!d.blockNumber||T-d.blockNumber+1n<e)))return;let U="replaced";I.to===u.to&&I.value===u.value&&I.input===u.input?U="repriced":I.from===I.to&&I.value===0n&&(U="cancelled"),_(()=>{var R;(R=y.onReplaced)==null||R.call(y,{reason:U,replacedTransaction:u,transaction:I,transactionReceipt:d}),y.resolve(d)})}catch(D){_(()=>y.reject(D))}}else _(()=>y.reject(x))}}})}),g}function sx(t,{batch:e=!0,onError:n,onTransactions:r,poll:s,pollingInterval:i=t.pollingInterval}){return(typeof s<"u"?s:t.transport.type!=="webSocket"&&t.transport.type!=="ipc")?(()=>{const l=Gn(["watchPendingTransactions",t.uid,e,i]);return wu(l,{onTransactions:r,onError:n},u=>{let d;const h=M1(async()=>{var f;try{if(!d)try{d=await lt(t,kN,"createPendingTransactionFilter")({});return}catch(g){throw h(),g}const p=await lt(t,wN,"getFilterChanges")({filter:d});if(p.length===0)return;if(e)u.onTransactions(p);else for(const g of p)u.onTransactions([g])}catch(p){(f=u.onError)==null||f.call(u,p)}},{emitOnBegin:!0,interval:i});return async()=>{d&&await lt(t,bN,"uninstallFilter")({filter:d}),h()}})})():(()=>{let l=!0,u=()=>l=!1;return(async()=>{try{const{unsubscribe:d}=await t.transport.subscribe({params:["newPendingTransactions"],onData(h){if(!l)return;const f=h.result;r([f])},onError(h){n==null||n(h)}});u=d,l||u()}catch(d){n==null||n(d)}})(),()=>u()})()}async function ix(t,{account:e=t.account,message:n}){if(!e)throw new Lp({docsPath:"/docs/actions/wallet/signMessage"});const r=Hr(e);if(r.signMessage)return r.signMessage({message:n});const s=typeof n=="string"?Ku(n):n.raw instanceof Uint8Array?ko(n.raw):n.raw;return t.request({method:"personal_sign",params:[s,r.address]},{retryCount:0})}const Vd={createBalance(t,e){const n={name:t.metadata.name||"",symbol:t.metadata.symbol||"",decimals:t.metadata.decimals||0,value:t.metadata.value||0,price:t.metadata.price||0,iconUrl:t.metadata.iconUrl||""};return{name:n.name,symbol:n.symbol,chainId:e,address:t.address==="native"?void 0:this.convertAddressToCAIP10Address(t.address,e),value:n.value,price:n.price,quantity:{decimals:n.decimals.toString(),numeric:this.convertHexToBalance({hex:t.balance,decimals:n.decimals})},iconUrl:n.iconUrl}},convertHexToBalance({hex:t,decimals:e}){return Go(BigInt(t),e)},convertAddressToCAIP10Address(t,e){return`${e}:${t}`},createCAIP2ChainId(t,e){return`${e}:${parseInt(t,16)}`},getChainIdHexFromCAIP2ChainId(t){const e=t.split(":");if(e.length<2||!e[1])return"0x0";const n=e[1],r=parseInt(n,10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(t){return typeof t!="object"||t===null?!1:Object.values(t).every(e=>Array.isArray(e)&&e.every(n=>this.isValidAsset(n)))},isValidAsset(t){return typeof t=="object"&&t!==null&&typeof t.address=="string"&&typeof t.balance=="string"&&(t.type==="ERC20"||t.type==="NATIVE")&&typeof t.metadata=="object"&&t.metadata!==null&&typeof t.metadata.name=="string"&&typeof t.metadata.symbol=="string"&&typeof t.metadata.decimals=="number"&&typeof t.metadata.price=="number"&&typeof t.metadata.iconUrl=="string"}},Bp={async getMyTokensWithBalance(t){const e=ce.state.address,n=A.state.activeCaipNetwork,r=J.getConnectorId("eip155")===L.CONNECTOR_ID.AUTH;if(!e||!n)return[];const s=`${n.caipNetworkId}:${e}`,i=V.getBalanceCacheForCaipAddress(s);if(i)return i.balances;if(n.chainNamespace===L.CHAIN.EVM&&r){const a=await this.getEIP155Balances(e,n);if(a)return this.filterLowQualityTokens(a)}const o=await fe.getBalance(e,n.caipNetworkId,t);return this.filterLowQualityTokens(o.balances)},async getEIP155Balances(t,e){var n,r;try{const s=Vd.getChainIdHexFromCAIP2ChainId(e.caipNetworkId),i=await X.getCapabilities(t);if(!((r=(n=i==null?void 0:i[s])==null?void 0:n.assetDiscovery)!=null&&r.supported))return null;const o=await X.walletGetAssets({account:t,chainFilter:[s]});if(!Vd.isWalletGetAssetsResponse(o))return null;const c=(o[s]||[]).map(l=>Vd.createBalance(l,e.caipNetworkId));return V.updateBalanceCache({caipAddress:`${e.caipNetworkId}:${t}`,balance:{balances:c},timestamp:Date.now()}),c}catch{return null}},filterLowQualityTokens(t){return t.filter(e=>e.quantity.decimals!=="0")}},wr=Xe({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map}),ox={state:wr,replaceState(t){t&&Object.assign(wr,xi(t))},subscribe(t){return A.subscribeChainProp("accountState",e=>{if(e)return t(e)})},subscribeKey(t,e,n){let r;return A.subscribeChainProp("accountState",s=>{if(s){const i=s[t];r!==i&&(r=i,e(i))}},n)},setStatus(t,e){A.setAccountProp("status",t,e)},getCaipAddress(t){return A.getAccountProp("caipAddress",t)},setCaipAddress(t,e){const n=t?oe.getPlainAddress(t):void 0;e===A.state.activeChain&&(A.state.activeCaipAddress=t),A.setAccountProp("caipAddress",t,e),A.setAccountProp("address",n,e)},setBalance(t,e,n){A.setAccountProp("balance",t,n),A.setAccountProp("balanceSymbol",e,n)},setProfileName(t,e){A.setAccountProp("profileName",t,e)},setProfileImage(t,e){A.setAccountProp("profileImage",t,e)},setUser(t,e){A.setAccountProp("user",t,e)},setAddressExplorerUrl(t,e){A.setAccountProp("addressExplorerUrl",t,e)},setSmartAccountDeployed(t,e){A.setAccountProp("smartAccountDeployed",t,e)},setCurrentTab(t){A.setAccountProp("currentTab",t,A.state.activeChain)},setTokenBalance(t,e){t&&A.setAccountProp("tokenBalance",t,e)},setShouldUpdateToAddress(t,e){A.setAccountProp("shouldUpdateToAddress",t,e)},addAddressLabel(t,e,n){const r=A.getAccountProp("addressLabels",n)||new Map;r.set(t,e),A.setAccountProp("addressLabels",r,n)},removeAddressLabel(t,e){const n=A.getAccountProp("addressLabels",e)||new Map;n.delete(t),A.setAccountProp("addressLabels",n,e)},setConnectedWalletInfo(t,e){A.setAccountProp("connectedWalletInfo",t,e,!1)},setPreferredAccountType(t,e){A.setAccountProp("preferredAccountType",t,e)},setSocialProvider(t,e){t&&A.setAccountProp("socialProvider",t,e)},setSocialWindow(t,e){A.setAccountProp("socialWindow",t?xi(t):void 0,e)},setFarcasterUrl(t,e){A.setAccountProp("farcasterUrl",t,e)},async fetchTokenBalance(t){var i,o;wr.balanceLoading=!0;const e=(i=A.state.activeCaipNetwork)==null?void 0:i.caipNetworkId,n=(o=A.state.activeCaipNetwork)==null?void 0:o.chainNamespace,r=A.state.activeCaipAddress,s=r?oe.getPlainAddress(r):void 0;if(wr.lastRetry&&!oe.isAllowedRetry(wr.lastRetry,30*qe.ONE_SEC_MS))return wr.balanceLoading=!1,[];try{if(s&&e&&n){const a=await Bp.getMyTokensWithBalance();return ce.setTokenBalance(a,n),wr.lastRetry=void 0,wr.balanceLoading=!1,a}}catch(a){wr.lastRetry=Date.now(),t==null||t(a),Pr.showError("Token Balance Unavailable")}finally{wr.balanceLoading=!1}return[]},resetAccount(t){A.resetAccount(t)}},ce=Un(ox),ax={onSwitchNetwork({network:t,ignoreSwitchConfirmation:e=!1}){const n=A.state.activeCaipNetwork,r=me.state.data;if(t.id===(n==null?void 0:n.id))return;const i=ce.getCaipAddress(A.state.activeChain),o=t.chainNamespace!==A.state.activeChain,a=ce.getCaipAddress(t.chainNamespace),l=J.getConnectorId(A.state.activeChain)===L.CONNECTOR_ID.AUTH,u=L.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(d=>d===t.chainNamespace);e||l&&u?me.push("SwitchNetwork",{...r,network:t}):i&&o&&!a?me.push("SwitchActiveChain",{switchToChain:t.chainNamespace,navigateTo:"Connect",navigateWithReplace:!0,network:t}):me.push("SwitchNetwork",{...r,network:t})}},un=Xe({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),cx={state:un,subscribe(t){return Bt(un,()=>t(un))},subscribeKey(t,e){return Ft(un,t,e)},async open(t){var i,o;const e=t==null?void 0:t.namespace,n=A.state.activeChain,r=e&&e!==n,s=(i=A.getAccountData(t==null?void 0:t.namespace))==null?void 0:i.caipAddress;if(X.state.wcBasic?de.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await de.prefetch(),J.setFilterByNamespace(t==null?void 0:t.namespace),Me.setLoading(!0,e),e&&r){const a=((o=A.getNetworkData(e))==null?void 0:o.caipNetwork)||A.getRequestedCaipNetworks(e)[0];a&&ax.onSwitchNetwork({network:a,ignoreSwitchConfirmation:!0})}else{const a=A.state.noAdapters;j.state.manualWCControl||a&&!s?oe.isMobile()?me.reset("AllWallets"):me.reset("ConnectingWalletConnectBasic"):t!=null&&t.view?me.reset(t.view,t.data):s?me.reset("Account"):me.reset("Connect")}un.open=!0,Rr.set({open:!0}),Ve.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!s}})},close(){const t=j.state.enableEmbedded,e=!!A.state.activeCaipAddress;un.open&&Ve.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:e}}),un.open=!1,me.reset("Connect"),Me.clearLoading(),t?e?me.replace("Account"):me.push("Connect"):Rr.set({open:!1}),X.resetUri()},setLoading(t,e){e&&un.loadingNamespaceMap.set(e,t),un.loading=t,Rr.set({loading:t})},clearLoading(){un.loadingNamespaceMap.clear(),un.loading=!1},shake(){un.shake||(un.shake=!0,setTimeout(()=>{un.shake=!1},500))}},Me=Un(cx),La={id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},ff={id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},lx={providers:Fw,selectedProvider:null,error:null,purchaseCurrency:La,paymentCurrency:ff,purchaseCurrencies:[La],paymentCurrencies:[],quotesLoading:!1},Re=Xe(lx),ux={state:Re,subscribe(t){return Bt(Re,()=>t(Re))},subscribeKey(t,e){return Ft(Re,t,e)},setSelectedProvider(t){if(t&&t.name==="meld"){const e=A.state.activeChain,n=e===L.CHAIN.SOLANA?"SOL":"USDC",r=A.getAccountProp("address",e)??"",s=new URL(t.url);s.searchParams.append("publicKey",mA),s.searchParams.append("destinationCurrencyCode",n),s.searchParams.append("walletAddress",r),s.searchParams.append("externalCustomerId",j.state.projectId),Re.selectedProvider={...t,url:s.toString()}}else Re.selectedProvider=t},setOnrampProviders(t){if(Array.isArray(t)&&t.every(e=>typeof e=="string")){const e=t,n=Fw.filter(r=>e.includes(r.name));Re.providers=n}else Re.providers=[]},setPurchaseCurrency(t){Re.purchaseCurrency=t},setPaymentCurrency(t){Re.paymentCurrency=t},setPurchaseAmount(t){pf.state.purchaseAmount=t},setPaymentAmount(t){pf.state.paymentAmount=t},async getAvailableCurrencies(){const t=await fe.getOnrampOptions();Re.purchaseCurrencies=t.purchaseCurrencies,Re.paymentCurrencies=t.paymentCurrencies,Re.paymentCurrency=t.paymentCurrencies[0]||ff,Re.purchaseCurrency=t.purchaseCurrencies[0]||La,await de.fetchCurrencyImages(t.paymentCurrencies.map(e=>e.id)),await de.fetchTokenImages(t.purchaseCurrencies.map(e=>e.symbol))},async getQuote(){var t,e;Re.quotesLoading=!0;try{const n=await fe.getOnrampQuote({purchaseCurrency:Re.purchaseCurrency,paymentCurrency:Re.paymentCurrency,amount:((t=Re.paymentAmount)==null?void 0:t.toString())||"0",network:(e=Re.purchaseCurrency)==null?void 0:e.symbol});return Re.quotesLoading=!1,Re.purchaseAmount=Number(n==null?void 0:n.purchaseAmount.amount),n}catch(n){return Re.error=n.message,Re.quotesLoading=!1,null}finally{Re.quotesLoading=!1}},resetState(){Re.selectedProvider=null,Re.error=null,Re.purchaseCurrency=La,Re.paymentCurrency=ff,Re.purchaseCurrencies=[La],Re.paymentCurrencies=[],Re.paymentAmount=void 0,Re.purchaseAmount=void 0,Re.quotesLoading=!1}},pf=Un(ux),gm=2147483648,dx={convertEVMChainIdToCoinType(t){if(t>=gm)throw new Error("Invalid chainId");return(gm|t)>>>0}},Mn=Xe({suggestions:[],loading:!1}),hx={state:Mn,subscribe(t){return Bt(Mn,()=>t(Mn))},subscribeKey(t,e){return Ft(Mn,t,e)},async resolveName(t){var e,n;try{return await fe.lookupEnsName(t)}catch(r){const s=r;throw new Error(((n=(e=s==null?void 0:s.reasons)==null?void 0:e[0])==null?void 0:n.description)||"Error resolving name")}},async isNameRegistered(t){try{return await fe.lookupEnsName(t),!0}catch{return!1}},async getSuggestions(t){try{Mn.loading=!0,Mn.suggestions=[];const e=await fe.getEnsNameSuggestions(t);return Mn.suggestions=e.suggestions.map(n=>({...n,name:n.name}))||[],Mn.suggestions}catch(e){const n=Ma.parseEnsApiError(e,"Error fetching name suggestions");throw new Error(n)}finally{Mn.loading=!1}},async getNamesForAddress(t){try{if(!A.state.activeCaipNetwork)return[];const n=V.getEnsFromCacheForAddress(t);if(n)return n;const r=await fe.reverseLookupEnsName({address:t});return V.updateEnsCache({address:t,ens:r,timestamp:Date.now()}),r}catch(e){const n=Ma.parseEnsApiError(e,"Error fetching names for address");throw new Error(n)}},async registerName(t){const e=A.state.activeCaipNetwork,n=ce.state.address,r=J.getAuthConnector();if(!e)throw new Error("Network not found");if(!n||!r)throw new Error("Address or auth connector not found");Mn.loading=!0;try{const s=JSON.stringify({name:t,attributes:{},timestamp:Math.floor(Date.now()/1e3)});me.pushTransactionStack({onCancel(){me.replace("RegisterAccountName")}});const i=await X.signMessage(s);Mn.loading=!1;const o=e.id;if(!o)throw new Error("Network not found");const a=dx.convertEVMChainIdToCoinType(Number(o));await fe.registerEnsName({coinType:a,address:n,signature:i,message:s}),ce.setProfileName(t,e.chainNamespace),me.replace("RegisterAccountNameSuccess")}catch(s){const i=Ma.parseEnsApiError(s,`Error registering name ${t}`);throw me.replace("RegisterAccountName"),new Error(i)}finally{Mn.loading=!1}},validateName(t){return/^[a-zA-Z0-9-]{4,}$/u.test(t)},parseEnsApiError(t,e){var r,s;const n=t;return((s=(r=n==null?void 0:n.reasons)==null?void 0:r[0])==null?void 0:s.description)||e}},Ma=Un(hx);var Fp={exports:{}},No=typeof Reflect=="object"?Reflect:null,mm=No&&typeof No.apply=="function"?No.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Yl;No&&typeof No.ownKeys=="function"?Yl=No.ownKeys:Object.getOwnPropertySymbols?Yl=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Yl=function(e){return Object.getOwnPropertyNames(e)};function fx(t){console&&console.warn&&console.warn(t)}var J1=Number.isNaN||function(e){return e!==e};function Ze(){Ze.init.call(this)}Fp.exports=Ze;Fp.exports.once=yx;Ze.EventEmitter=Ze;Ze.prototype._events=void 0;Ze.prototype._eventsCount=0;Ze.prototype._maxListeners=void 0;var ym=10;function od(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Ze,"defaultMaxListeners",{enumerable:!0,get:function(){return ym},set:function(t){if(typeof t!="number"||t<0||J1(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ym=t}});Ze.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ze.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||J1(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function X1(t){return t._maxListeners===void 0?Ze.defaultMaxListeners:t._maxListeners}Ze.prototype.getMaxListeners=function(){return X1(this)};Ze.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var s=e==="error",i=this._events;if(i!==void 0)s=s&&i.error===void 0;else if(!s)return!1;if(s){var o;if(n.length>0&&(o=n[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=i[e];if(c===void 0)return!1;if(typeof c=="function")mm(c,this,n);else for(var l=c.length,u=rv(c,l),r=0;r<l;++r)mm(u[r],this,n);return!0};function Q1(t,e,n,r){var s,i,o;if(od(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),o=i[e]),o===void 0)o=i[e]=n,++t._eventsCount;else if(typeof o=="function"?o=i[e]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),s=X1(t),s>0&&o.length>s&&!o.warned){o.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=o.length,fx(a)}return t}Ze.prototype.addListener=function(e,n){return Q1(this,e,n,!1)};Ze.prototype.on=Ze.prototype.addListener;Ze.prototype.prependListener=function(e,n){return Q1(this,e,n,!0)};function px(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ev(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},s=px.bind(r);return s.listener=n,r.wrapFn=s,s}Ze.prototype.once=function(e,n){return od(n),this.on(e,ev(this,e,n)),this};Ze.prototype.prependOnceListener=function(e,n){return od(n),this.prependListener(e,ev(this,e,n)),this};Ze.prototype.removeListener=function(e,n){var r,s,i,o,a;if(od(n),s=this._events,s===void 0)return this;if(r=s[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete s[e],s.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===n||r[o].listener===n){a=r[o].listener,i=o;break}if(i<0)return this;i===0?r.shift():gx(r,i),r.length===1&&(s[e]=r[0]),s.removeListener!==void 0&&this.emit("removeListener",e,a||n)}return this};Ze.prototype.off=Ze.prototype.removeListener;Ze.prototype.removeAllListeners=function(e){var n,r,s;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),o;for(s=0;s<i.length;++s)o=i[s],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(s=n.length-1;s>=0;s--)this.removeListener(e,n[s]);return this};function tv(t,e,n){var r=t._events;if(r===void 0)return[];var s=r[e];return s===void 0?[]:typeof s=="function"?n?[s.listener||s]:[s]:n?mx(s):rv(s,s.length)}Ze.prototype.listeners=function(e){return tv(this,e,!0)};Ze.prototype.rawListeners=function(e){return tv(this,e,!1)};Ze.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):nv.call(t,e)};Ze.prototype.listenerCount=nv;function nv(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Ze.prototype.eventNames=function(){return this._eventsCount>0?Yl(this._events):[]};function rv(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function gx(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function mx(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function yx(t,e){return new Promise(function(n,r){function s(o){t.removeListener(e,i),r(o)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",s),n([].slice.call(arguments))}sv(t,e,i,{once:!0}),e!=="error"&&wx(t,s,{once:!0})})}function wx(t,e,n){typeof t.on=="function"&&sv(t,"error",e,n)}function sv(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function s(i){r.once&&t.removeEventListener(e,s),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Xn=Fp.exports;const jp=zu(Xn);var Y={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var gf=function(t,e){return gf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},gf(t,e)};function bx(t,e){gf(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var mf=function(){return mf=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mf.apply(this,arguments)};function vx(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Ex(t,e,n,r){var s=arguments.length,i=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,n):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(i=(s<3?o(i):s>3?o(e,n,i):o(e,n))||i);return s>3&&i&&Object.defineProperty(e,n,i),i}function Cx(t,e){return function(n,r){e(n,r,t)}}function _x(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Ax(t,e,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function a(u){try{l(r.next(u))}catch(d){o(d)}}function c(u){try{l(r.throw(u))}catch(d){o(d)}}function l(u){u.done?i(u.value):s(u.value).then(a,c)}l((r=r.apply(t,e||[])).next())})}function Ix(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return c([l,u])}}function c(l){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(i=l[0]&2?s.return:l[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,l[1])).done)return i;switch(s=0,i&&(l=[l[0]&2,i.value]),l[0]){case 0:case 1:i=l;break;case 4:return n.label++,{value:l[1],done:!1};case 5:n.label++,s=l[1],l=[0];continue;case 7:l=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(l[0]===6||l[0]===2)){n=0;continue}if(l[0]===3&&(!i||l[1]>i[0]&&l[1]<i[3])){n.label=l[1];break}if(l[0]===6&&n.label<i[1]){n.label=i[1],i=l;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(l);break}i[2]&&n.ops.pop(),n.trys.pop();continue}l=e.call(t,n)}catch(u){l=[6,u],s=0}finally{r=i=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}function Sx(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}function Nx(t,e){for(var n in t)n!=="default"&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function yf(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function iv(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r=n.call(t),s,i=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(a){o={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(o)throw o.error}}return i}function xx(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(iv(arguments[e]));return t}function Tx(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),s=0,e=0;e<n;e++)for(var i=arguments[e],o=0,a=i.length;o<a;o++,s++)r[s]=i[o];return r}function Cc(t){return this instanceof Cc?(this.v=t,this):new Cc(t)}function Px(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s={},o("next"),o("throw"),o("return"),s[Symbol.asyncIterator]=function(){return this},s;function o(h){r[h]&&(s[h]=function(f){return new Promise(function(p,g){i.push([h,f,p,g])>1||a(h,f)})})}function a(h,f){try{c(r[h](f))}catch(p){d(i[0][3],p)}}function c(h){h.value instanceof Cc?Promise.resolve(h.value.v).then(l,u):d(i[0][2],h)}function l(h){a("next",h)}function u(h){a("throw",h)}function d(h,f){h(f),i.shift(),i.length&&a(i[0][0],i[0][1])}}function Ox(t){var e,n;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,i){e[s]=t[s]?function(o){return(n=!n)?{value:Cc(t[s](o)),done:s==="return"}:i?i(o):o}:i}}function Rx(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof yf=="function"?yf(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(a,c){o=t[i](o),s(a,c,o.done,o.value)})}}function s(i,o,a,c){Promise.resolve(c).then(function(l){i({value:l,done:a})},o)}}function Dx(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function $x(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function kx(t){return t&&t.__esModule?t:{default:t}}function Ux(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Lx(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}const Mx=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return mf},__asyncDelegator:Ox,__asyncGenerator:Px,__asyncValues:Rx,__await:Cc,__awaiter:Ax,__classPrivateFieldGet:Ux,__classPrivateFieldSet:Lx,__createBinding:Sx,__decorate:Ex,__exportStar:Nx,__extends:bx,__generator:Ix,__importDefault:kx,__importStar:$x,__makeTemplateObject:Dx,__metadata:_x,__param:Cx,__read:iv,__rest:vx,__spread:xx,__spreadArrays:Tx,__values:yf},Symbol.toStringTag,{value:"Module"})),el=q_(Mx);var Gd={},da={},wm;function Bx(){if(wm)return da;wm=1,Object.defineProperty(da,"__esModule",{value:!0}),da.delay=void 0;function t(e){return new Promise(n=>{setTimeout(()=>{n(!0)},e)})}return da.delay=t,da}var ii={},Kd={},oi={},bm;function Fx(){return bm||(bm=1,Object.defineProperty(oi,"__esModule",{value:!0}),oi.ONE_THOUSAND=oi.ONE_HUNDRED=void 0,oi.ONE_HUNDRED=100,oi.ONE_THOUSAND=1e3),oi}var Yd={},vm;function jx(){return vm||(vm=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Yd)),Yd}var Em;function ov(){return Em||(Em=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=el;e.__exportStar(Fx(),t),e.__exportStar(jx(),t)}(Kd)),Kd}var Cm;function Hx(){if(Cm)return ii;Cm=1,Object.defineProperty(ii,"__esModule",{value:!0}),ii.fromMiliseconds=ii.toMiliseconds=void 0;const t=ov();function e(r){return r*t.ONE_THOUSAND}ii.toMiliseconds=e;function n(r){return Math.floor(r/t.ONE_THOUSAND)}return ii.fromMiliseconds=n,ii}var _m;function qx(){return _m||(_m=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=el;e.__exportStar(Bx(),t),e.__exportStar(Hx(),t)}(Gd)),Gd}var Qi={},Am;function zx(){if(Am)return Qi;Am=1,Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(n){if(this.timestamps.has(n))throw new Error(`Watch already started for label: ${n}`);this.timestamps.set(n,{started:Date.now()})}stop(n){const r=this.get(n);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${n}`);const s=Date.now()-r.started;this.timestamps.set(n,{started:r.started,elapsed:s})}get(n){const r=this.timestamps.get(n);if(typeof r>"u")throw new Error(`No timestamp found for label: ${n}`);return r}elapsed(n){const r=this.get(n);return r.elapsed||Date.now()-r.started}}return Qi.Watch=t,Qi.default=t,Qi}var Zd={},ha={},Im;function Wx(){if(Im)return ha;Im=1,Object.defineProperty(ha,"__esModule",{value:!0}),ha.IWatch=void 0;class t{}return ha.IWatch=t,ha}var Sm;function Vx(){return Sm||(Sm=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),el.__exportStar(Wx(),t)}(Zd)),Zd}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=el;e.__exportStar(qx(),t),e.__exportStar(zx(),t),e.__exportStar(Vx(),t),e.__exportStar(ov(),t)})(Y);class Wi{}let Gx=class extends Wi{constructor(e){super()}};const Nm=Y.FIVE_SECONDS,Vi={pulse:"heartbeat_pulse"};let Kx=class av extends Gx{constructor(e){super(e),this.events=new Xn.EventEmitter,this.interval=Nm,this.interval=(e==null?void 0:e.interval)||Nm}static async init(e){const n=new av(e);return await n.init(),n}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),Y.toMiliseconds(this.interval))}pulse(){this.events.emit(Vi.pulse)}};const Yx=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Zx=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,Jx=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Xx(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Qx(t);return}return e}function Qx(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function Cl(t,e={}){if(typeof t!="string")return t;if(t[0]==='"'&&t[t.length-1]==='"'&&t.indexOf("\\")===-1)return t.slice(1,-1);const n=t.trim();if(n.length<=9)switch(n.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!Jx.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Yx.test(t)||Zx.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,Xx)}return JSON.parse(t)}catch(r){if(e.strict)throw r;return t}}function eT(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function Nt(t,...e){try{return eT(t(...e))}catch(n){return Promise.reject(n)}}function tT(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function nT(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Zl(t){if(tT(t))return String(t);if(nT(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Zl(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const wf="base64:";function rT(t){return typeof t=="string"?t:wf+oT(t)}function sT(t){return typeof t!="string"||!t.startsWith(wf)?t:iT(t.slice(wf.length))}function iT(t){return globalThis.Buffer?Buffer.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))}function oT(t){return globalThis.Buffer?Buffer.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))}function gn(t){var e;return t&&((e=t.split("?")[0])==null?void 0:e.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function aT(...t){return gn(t.join(":"))}function _l(t){return t=gn(t),t?t+":":""}function cT(t,e){if(e===void 0)return!0;let n=0,r=t.indexOf(":");for(;r>-1;)n++,r=t.indexOf(":",r+1);return n<=e}function lT(t,e){return e?t.startsWith(e)&&t[t.length-1]!=="$":t[t.length-1]!=="$"}const uT="memory",dT=()=>{const t=new Map;return{name:uT,getInstance:()=>t,hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,n){t.set(e,n)},setItemRaw(e,n){t.set(e,n)},removeItem(e){t.delete(e)},getKeys(){return[...t.keys()]},clear(){t.clear()},dispose(){t.clear()}}};function hT(t={}){const e={mounts:{"":t.driver||dT()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},n=l=>{for(const u of e.mountpoints)if(l.startsWith(u))return{base:u,relativeKey:l.slice(u.length),driver:e.mounts[u]};return{base:"",relativeKey:l,driver:e.mounts[""]}},r=(l,u)=>e.mountpoints.filter(d=>d.startsWith(l)||u&&l.startsWith(d)).map(d=>({relativeBase:l.length>d.length?l.slice(d.length):void 0,mountpoint:d,driver:e.mounts[d]})),s=(l,u)=>{if(e.watching){u=gn(u);for(const d of e.watchListeners)d(l,u)}},i=async()=>{if(!e.watching){e.watching=!0;for(const l in e.mounts)e.unwatch[l]=await xm(e.mounts[l],s,l)}},o=async()=>{if(e.watching){for(const l in e.unwatch)await e.unwatch[l]();e.unwatch={},e.watching=!1}},a=(l,u,d)=>{const h=new Map,f=p=>{let g=h.get(p.base);return g||(g={driver:p.driver,base:p.base,items:[]},h.set(p.base,g)),g};for(const p of l){const g=typeof p=="string",m=gn(g?p:p.key),v=g?void 0:p.value,b=g||!p.options?u:{...u,...p.options},y=n(m);f(y).items.push({key:m,value:v,relativeKey:y.relativeKey,options:b})}return Promise.all([...h.values()].map(p=>d(p))).then(p=>p.flat())},c={hasItem(l,u={}){l=gn(l);const{relativeKey:d,driver:h}=n(l);return Nt(h.hasItem,d,u)},getItem(l,u={}){l=gn(l);const{relativeKey:d,driver:h}=n(l);return Nt(h.getItem,d,u).then(f=>Cl(f))},getItems(l,u={}){return a(l,u,d=>d.driver.getItems?Nt(d.driver.getItems,d.items.map(h=>({key:h.relativeKey,options:h.options})),u).then(h=>h.map(f=>({key:aT(d.base,f.key),value:Cl(f.value)}))):Promise.all(d.items.map(h=>Nt(d.driver.getItem,h.relativeKey,h.options).then(f=>({key:h.key,value:Cl(f)})))))},getItemRaw(l,u={}){l=gn(l);const{relativeKey:d,driver:h}=n(l);return h.getItemRaw?Nt(h.getItemRaw,d,u):Nt(h.getItem,d,u).then(f=>sT(f))},async setItem(l,u,d={}){if(u===void 0)return c.removeItem(l);l=gn(l);const{relativeKey:h,driver:f}=n(l);f.setItem&&(await Nt(f.setItem,h,Zl(u),d),f.watch||s("update",l))},async setItems(l,u){await a(l,u,async d=>{if(d.driver.setItems)return Nt(d.driver.setItems,d.items.map(h=>({key:h.relativeKey,value:Zl(h.value),options:h.options})),u);d.driver.setItem&&await Promise.all(d.items.map(h=>Nt(d.driver.setItem,h.relativeKey,Zl(h.value),h.options)))})},async setItemRaw(l,u,d={}){if(u===void 0)return c.removeItem(l,d);l=gn(l);const{relativeKey:h,driver:f}=n(l);if(f.setItemRaw)await Nt(f.setItemRaw,h,u,d);else if(f.setItem)await Nt(f.setItem,h,rT(u),d);else return;f.watch||s("update",l)},async removeItem(l,u={}){typeof u=="boolean"&&(u={removeMeta:u}),l=gn(l);const{relativeKey:d,driver:h}=n(l);h.removeItem&&(await Nt(h.removeItem,d,u),(u.removeMeta||u.removeMata)&&await Nt(h.removeItem,d+"$",u),h.watch||s("remove",l))},async getMeta(l,u={}){typeof u=="boolean"&&(u={nativeOnly:u}),l=gn(l);const{relativeKey:d,driver:h}=n(l),f=Object.create(null);if(h.getMeta&&Object.assign(f,await Nt(h.getMeta,d,u)),!u.nativeOnly){const p=await Nt(h.getItem,d+"$",u).then(g=>Cl(g));p&&typeof p=="object"&&(typeof p.atime=="string"&&(p.atime=new Date(p.atime)),typeof p.mtime=="string"&&(p.mtime=new Date(p.mtime)),Object.assign(f,p))}return f},setMeta(l,u,d={}){return this.setItem(l+"$",u,d)},removeMeta(l,u={}){return this.removeItem(l+"$",u)},async getKeys(l,u={}){var m;l=_l(l);const d=r(l,!0);let h=[];const f=[];let p=!0;for(const v of d){(m=v.driver.flags)!=null&&m.maxDepth||(p=!1);const b=await Nt(v.driver.getKeys,v.relativeBase,u);for(const y of b){const N=v.mountpoint+gn(y);h.some(_=>N.startsWith(_))||f.push(N)}h=[v.mountpoint,...h.filter(y=>!y.startsWith(v.mountpoint))]}const g=u.maxDepth!==void 0&&!p;return f.filter(v=>(!g||cT(v,u.maxDepth))&&lT(v,l))},async clear(l,u={}){l=_l(l),await Promise.all(r(l,!1).map(async d=>{if(d.driver.clear)return Nt(d.driver.clear,d.relativeBase,u);if(d.driver.removeItem){const h=await d.driver.getKeys(d.relativeBase||"",u);return Promise.all(h.map(f=>d.driver.removeItem(f,u)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(l=>Tm(l)))},async watch(l){return await i(),e.watchListeners.push(l),async()=>{e.watchListeners=e.watchListeners.filter(u=>u!==l),e.watchListeners.length===0&&await o()}},async unwatch(){e.watchListeners=[],await o()},mount(l,u){if(l=_l(l),l&&e.mounts[l])throw new Error(`already mounted at ${l}`);return l&&(e.mountpoints.push(l),e.mountpoints.sort((d,h)=>h.length-d.length)),e.mounts[l]=u,e.watching&&Promise.resolve(xm(u,s,l)).then(d=>{e.unwatch[l]=d}).catch(console.error),c},async unmount(l,u=!0){var d,h;l=_l(l),!(!l||!e.mounts[l])&&(e.watching&&l in e.unwatch&&((h=(d=e.unwatch)[l])==null||h.call(d),delete e.unwatch[l]),u&&await Tm(e.mounts[l]),e.mountpoints=e.mountpoints.filter(f=>f!==l),delete e.mounts[l])},getMount(l=""){l=gn(l)+":";const u=n(l);return{driver:u.driver,base:u.base}},getMounts(l="",u={}){return l=gn(l),r(l,u.parents).map(h=>({driver:h.driver,base:h.mountpoint}))},keys:(l,u={})=>c.getKeys(l,u),get:(l,u={})=>c.getItem(l,u),set:(l,u,d={})=>c.setItem(l,u,d),has:(l,u={})=>c.hasItem(l,u),del:(l,u={})=>c.removeItem(l,u),remove:(l,u={})=>c.removeItem(l,u)};return c}function xm(t,e,n){return t.watch?t.watch((r,s)=>e(r,n+s)):()=>{}}async function Tm(t){typeof t.dispose=="function"&&await Nt(t.dispose)}function Gi(t){return new Promise((e,n)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>n(t.error)})}function cv(t,e){let n;const r=()=>{if(n)return n;const s=indexedDB.open(t);return s.onupgradeneeded=()=>s.result.createObjectStore(e),n=Gi(s),n.then(i=>{i.onclose=()=>n=void 0},()=>{}),n};return(s,i)=>r().then(o=>i(o.transaction(e,s).objectStore(e)))}let Jd;function tl(){return Jd||(Jd=cv("keyval-store","keyval")),Jd}function Pm(t,e=tl()){return e("readonly",n=>Gi(n.get(t)))}function fT(t,e,n=tl()){return n("readwrite",r=>(r.put(e,t),Gi(r.transaction)))}function pT(t,e=tl()){return e("readwrite",n=>(n.delete(t),Gi(n.transaction)))}function gT(t=tl()){return t("readwrite",e=>(e.clear(),Gi(e.transaction)))}function mT(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},Gi(t.transaction)}function yT(t=tl()){return t("readonly",e=>{if(e.getAllKeys)return Gi(e.getAllKeys());const n=[];return mT(e,r=>n.push(r.key)).then(()=>n)})}const wT=t=>JSON.stringify(t,(e,n)=>typeof n=="bigint"?n.toString()+"n":n),bT=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,n=t.replace(e,'$1"$2n"$3');return JSON.parse(n,(r,s)=>typeof s=="string"&&s.match(/^\d+n$/)?BigInt(s.substring(0,s.length-1)):s)};function $i(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return bT(t)}catch{return t}}function ls(t){return typeof t=="string"?t:wT(t)||""}const vT="idb-keyval";var ET=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",n=s=>e+s;let r;return t.dbName&&t.storeName&&(r=cv(t.dbName,t.storeName)),{name:vT,options:t,async hasItem(s){return!(typeof await Pm(n(s),r)>"u")},async getItem(s){return await Pm(n(s),r)??null},setItem(s,i){return fT(n(s),i,r)},removeItem(s){return pT(n(s),r)},getKeys(){return yT(r)},clear(){return gT(r)}}};const CT="WALLET_CONNECT_V2_INDEXED_DB",_T="keyvaluestorage";let AT=class{constructor(){this.indexedDb=hT({driver:ET({dbName:CT,storeName:_T})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const n=await this.indexedDb.getItem(e);if(n!==null)return n}async setItem(e,n){await this.indexedDb.setItem(e,ls(n))}async removeItem(e){await this.indexedDb.removeItem(e)}};var Xd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jl={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(n){return this.hasOwnProperty(n)?String(this[n]):null},t.prototype.setItem=function(n,r){this[n]=String(r)},t.prototype.removeItem=function(n){delete this[n]},t.prototype.clear=function(){const n=this;Object.keys(n).forEach(function(r){n[r]=void 0,delete n[r]})},t.prototype.key=function(n){return n=n||0,Object.keys(this)[n]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Xd<"u"&&Xd.localStorage?Jl.exports=Xd.localStorage:typeof window<"u"&&window.localStorage?Jl.exports=window.localStorage:Jl.exports=new e})();function IT(t){var e;return[t[0],$i((e=t[1])!=null?e:"")]}let ST=class{constructor(){this.localStorage=Jl.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(IT)}async getItem(e){const n=this.localStorage.getItem(e);if(n!==null)return $i(n)}async setItem(e,n){this.localStorage.setItem(e,ls(n))}async removeItem(e){this.localStorage.removeItem(e)}};const NT="wc_storage_version",Om=1,xT=async(t,e,n)=>{const r=NT,s=await e.getItem(r);if(s&&s>=Om){n(e);return}const i=await t.getKeys();if(!i.length){n(e);return}const o=[];for(;i.length;){const a=i.shift();if(!a)continue;const c=a.toLowerCase();if(c.includes("wc@")||c.includes("walletconnect")||c.includes("wc_")||c.includes("wallet_connect")){const l=await t.getItem(a);await e.setItem(a,l),o.push(a)}}await e.setItem(r,Om),n(e),TT(t,o)},TT=async(t,e)=>{e.length&&e.forEach(async n=>{await t.removeItem(n)})};let PT=class{constructor(){this.initialized=!1,this.setInitialized=n=>{this.storage=n,this.initialized=!0};const e=new ST;this.storage=e;try{const n=new AT;xT(e,n,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,n){return await this.initialize(),this.storage.setItem(e,n)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const n=setInterval(()=>{this.initialized&&(clearInterval(n),e())},20)})}};function OT(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var RT=DT;function DT(t,e,n){var r=n&&n.stringify||OT,s=1;if(typeof t=="object"&&t!==null){var i=e.length+s;if(i===1)return t;var o=new Array(i);o[0]=r(t);for(var a=1;a<i;a++)o[a]=r(e[a]);return o.join(" ")}if(typeof t!="string")return t;var c=e.length;if(c===0)return t;for(var l="",u=1-s,d=-1,h=t&&t.length||0,f=0;f<h;){if(t.charCodeAt(f)===37&&f+1<h){switch(d=d>-1?d:0,t.charCodeAt(f+1)){case 100:case 102:if(u>=c||e[u]==null)break;d<f&&(l+=t.slice(d,f)),l+=Number(e[u]),d=f+2,f++;break;case 105:if(u>=c||e[u]==null)break;d<f&&(l+=t.slice(d,f)),l+=Math.floor(Number(e[u])),d=f+2,f++;break;case 79:case 111:case 106:if(u>=c||e[u]===void 0)break;d<f&&(l+=t.slice(d,f));var p=typeof e[u];if(p==="string"){l+="'"+e[u]+"'",d=f+2,f++;break}if(p==="function"){l+=e[u].name||"<anonymous>",d=f+2,f++;break}l+=r(e[u]),d=f+2,f++;break;case 115:if(u>=c)break;d<f&&(l+=t.slice(d,f)),l+=String(e[u]),d=f+2,f++;break;case 37:d<f&&(l+=t.slice(d,f)),l+="%",d=f+2,f++,u--;break}++u}++f}return d===-1?t:(d<h&&(l+=t.slice(d)),l)}const Rm=RT;var vo=Dr;const _c=qT().console||{},$T={mapHttpRequest:Al,mapHttpResponse:Al,wrapRequestSerializer:Qd,wrapResponseSerializer:Qd,wrapErrorSerializer:Qd,req:Al,res:Al,err:BT};function kT(t,e){return Array.isArray(t)?t.filter(function(r){return r!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Dr(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const n=t.browser.write||_c;t.browser.write&&(t.browser.asObject=!0);const r=t.serializers||{},s=kT(t.browser.serialize,r);let i=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(i=!1);const o=["error","fatal","warn","info","debug","trace"];typeof n=="function"&&(n.error=n.fatal=n.warn=n.info=n.debug=n.trace=n),t.enabled===!1&&(t.level="silent");const a=t.level||"info",c=Object.create(n);c.log||(c.log=Ac),Object.defineProperty(c,"levelVal",{get:u}),Object.defineProperty(c,"level",{get:d,set:h});const l={transmit:e,serialize:s,asObject:t.browser.asObject,levels:o,timestamp:FT(t)};c.levels=Dr.levels,c.level=a,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=Ac,c.serializers=r,c._serialize=s,c._stdErrSerialize=i,c.child=f,e&&(c._logEvent=bf());function u(){return this.level==="silent"?1/0:this.levels.values[this.level]}function d(){return this._level}function h(p){if(p!=="silent"&&!this.levels.values[p])throw Error("unknown level "+p);this._level=p,eo(l,c,"error","log"),eo(l,c,"fatal","error"),eo(l,c,"warn","error"),eo(l,c,"info","log"),eo(l,c,"debug","log"),eo(l,c,"trace","log")}function f(p,g){if(!p)throw new Error("missing bindings for child Pino");g=g||{},s&&p.serializers&&(g.serializers=p.serializers);const m=g.serializers;if(s&&m){var v=Object.assign({},r,m),b=t.browser.serialize===!0?Object.keys(v):s;delete p.serializers,ad([p],b,v,this._stdErrSerialize)}function y(N){this._childLevel=(N._childLevel|0)+1,this.error=to(N,p,"error"),this.fatal=to(N,p,"fatal"),this.warn=to(N,p,"warn"),this.info=to(N,p,"info"),this.debug=to(N,p,"debug"),this.trace=to(N,p,"trace"),v&&(this.serializers=v,this._serialize=b),e&&(this._logEvent=bf([].concat(N._logEvent.bindings,p)))}return y.prototype=this,new y(this)}return c}Dr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Dr.stdSerializers=$T;Dr.stdTimeFunctions=Object.assign({},{nullTime:lv,epochTime:uv,unixTime:jT,isoTime:HT});function eo(t,e,n,r){const s=Object.getPrototypeOf(e);e[n]=e.levelVal>e.levels.values[n]?Ac:s[n]?s[n]:_c[n]||_c[r]||Ac,UT(t,e,n)}function UT(t,e,n){!t.transmit&&e[n]===Ac||(e[n]=function(r){return function(){const i=t.timestamp(),o=new Array(arguments.length),a=Object.getPrototypeOf&&Object.getPrototypeOf(this)===_c?_c:this;for(var c=0;c<o.length;c++)o[c]=arguments[c];if(t.serialize&&!t.asObject&&ad(o,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?r.call(a,LT(this,n,o,i)):r.apply(a,o),t.transmit){const l=t.transmit.level||e.level,u=Dr.levels.values[l],d=Dr.levels.values[n];if(d<u)return;MT(this,{ts:i,methodLevel:n,methodValue:d,transmitValue:Dr.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},o)}}}(e[n]))}function LT(t,e,n,r){t._serialize&&ad(n,t._serialize,t.serializers,t._stdErrSerialize);const s=n.slice();let i=s[0];const o={};r&&(o.time=r),o.level=Dr.levels.values[e];let a=(t._childLevel|0)+1;if(a<1&&(a=1),i!==null&&typeof i=="object"){for(;a--&&typeof s[0]=="object";)Object.assign(o,s.shift());i=s.length?Rm(s.shift(),s):void 0}else typeof i=="string"&&(i=Rm(s.shift(),s));return i!==void 0&&(o.msg=i),o}function ad(t,e,n,r){for(const s in t)if(r&&t[s]instanceof Error)t[s]=Dr.stdSerializers.err(t[s]);else if(typeof t[s]=="object"&&!Array.isArray(t[s]))for(const i in t[s])e&&e.indexOf(i)>-1&&i in n&&(t[s][i]=n[i](t[s][i]))}function to(t,e,n){return function(){const r=new Array(1+arguments.length);r[0]=e;for(var s=1;s<r.length;s++)r[s]=arguments[s-1];return t[n].apply(this,r)}}function MT(t,e,n){const r=e.send,s=e.ts,i=e.methodLevel,o=e.methodValue,a=e.val,c=t._logEvent.bindings;ad(n,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=s,t._logEvent.messages=n.filter(function(l){return c.indexOf(l)===-1}),t._logEvent.level.label=i,t._logEvent.level.value=o,r(i,t._logEvent,a),t._logEvent=bf(c)}function bf(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function BT(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const n in t)e[n]===void 0&&(e[n]=t[n]);return e}function FT(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?lv:uv}function Al(){return{}}function Qd(t){return t}function Ac(){}function lv(){return!1}function uv(){return Date.now()}function jT(){return Math.round(Date.now()/1e3)}function HT(){return new Date(Date.now()).toISOString()}function qT(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const nl=zu(vo),zT={level:"info"},rl="custom_context",Hp=1e3*1024;let WT=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Dm=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const n=new WT(e);if(n.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${n.size}`);for(;this.size+n.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=n),this.tail=n):(this.head=n,this.tail=n),this.lengthInNodes++,this.sizeInBytes+=n.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let n=this.head;for(;n!==null;)e.push(n.value),n=n.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const n=e.value;return e=e.next,{done:!1,value:n}}}}},dv=class{constructor(e,n=Hp){this.level=e??"error",this.levelValue=vo.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=n,this.logs=new Dm(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,n){n===vo.levels.values.error?console.error(e):n===vo.levels.values.warn?console.warn(e):n===vo.levels.values.debug?console.debug(e):n===vo.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(ls({timestamp:new Date().toISOString(),log:e}));const n=typeof e=="string"?JSON.parse(e).level:e.level;n>=this.levelValue&&this.forwardToConsole(e,n)}getLogs(){return this.logs}clearLogs(){this.logs=new Dm(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const n=this.getLogArray();return n.push(ls({extraMetadata:e})),new Blob(n,{type:"application/json"})}},VT=class{constructor(e,n=Hp){this.baseChunkLogger=new dv(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const n=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=n,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}},GT=class{constructor(e,n=Hp){this.baseChunkLogger=new dv(e,n)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var KT=Object.defineProperty,YT=Object.defineProperties,ZT=Object.getOwnPropertyDescriptors,$m=Object.getOwnPropertySymbols,JT=Object.prototype.hasOwnProperty,XT=Object.prototype.propertyIsEnumerable,km=(t,e,n)=>e in t?KT(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Eu=(t,e)=>{for(var n in e||(e={}))JT.call(e,n)&&km(t,n,e[n]);if($m)for(var n of $m(e))XT.call(e,n)&&km(t,n,e[n]);return t},Cu=(t,e)=>YT(t,ZT(e));function Ko(t){return Cu(Eu({},t),{level:(t==null?void 0:t.level)||zT.level})}function QT(t,e=rl){return t[e]||""}function eP(t,e,n=rl){return t[n]=e,t}function In(t,e=rl){let n="";return typeof t.bindings>"u"?n=QT(t,e):n=t.bindings().context||"",n}function tP(t,e,n=rl){const r=In(t,n);return r.trim()?`${r}/${e}`:e}function tn(t,e,n=rl){const r=tP(t,e,n),s=t.child({context:r});return eP(s,r,n)}function nP(t){var e,n;const r=new VT((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:nl(Cu(Eu({},t.opts),{level:"trace",browser:Cu(Eu({},(n=t.opts)==null?void 0:n.browser),{write:s=>r.write(s)})})),chunkLoggerController:r}}function rP(t){var e;const n=new GT((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:nl(Cu(Eu({},t.opts),{level:"trace"}),n),chunkLoggerController:n}}function qp(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?nP(t):rP(t)}var sP=Object.defineProperty,iP=(t,e,n)=>e in t?sP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Um=(t,e,n)=>iP(t,typeof e!="symbol"?e+"":e,n);let oP=class extends Wi{constructor(e){super(),this.opts=e,Um(this,"protocol","wc"),Um(this,"version",2)}};var aP=Object.defineProperty,cP=(t,e,n)=>e in t?aP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lP=(t,e,n)=>cP(t,e+"",n);let uP=class extends Wi{constructor(e,n){super(),this.core=e,this.logger=n,lP(this,"records",new Map)}},dP=class{constructor(e,n){this.logger=e,this.core=n}},hP=class extends Wi{constructor(e,n){super(),this.relayer=e,this.logger=n}},fP=class extends Wi{constructor(e){super()}},pP=class{constructor(e,n,r,s){this.core=e,this.logger=n,this.name=r}},gP=class extends Wi{constructor(e,n){super(),this.relayer=e,this.logger=n}},mP=class extends Wi{constructor(e,n){super(),this.core=e,this.logger=n}},yP=class{constructor(e,n,r){this.core=e,this.logger=n,this.store=r}},wP=class{constructor(e,n){this.projectId=e,this.logger=n}},bP=class{constructor(e,n,r){this.core=e,this.logger=n,this.telemetryEnabled=r}};var vP=Object.defineProperty,EP=(t,e,n)=>e in t?vP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lm=(t,e,n)=>EP(t,typeof e!="symbol"?e+"":e,n);let CP=class{constructor(e){this.opts=e,Lm(this,"protocol","wc"),Lm(this,"version",2)}},_P=class{constructor(e){this.client=e}};function AP(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function hv(t,...e){if(!AP(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Mm(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function IP(t,e){hv(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}const no=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const eh=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function SP(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function fv(t){return typeof t=="string"&&(t=SP(t)),hv(t),t}let NP=class{clone(){return this._cloneInto()}};function xP(t){const e=r=>t().update(fv(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function pv(t=32){if(no&&typeof no.getRandomValues=="function")return no.getRandomValues(new Uint8Array(t));if(no&&typeof no.randomBytes=="function")return no.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function TP(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}let PP=class extends NP{constructor(e,n,r,s){super(),this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=eh(this.buffer)}update(e){Mm(this);const{view:n,buffer:r,blockLen:s}=this;e=fv(e);const i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=eh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Mm(this),IP(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;TP(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=eh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.length=s,e.pos=a,e.finished=i,e.destroyed=o,s%n&&e.buffer.set(r),e}};const Il=BigInt(2**32-1),vf=BigInt(32);function gv(t,e=!1){return e?{h:Number(t&Il),l:Number(t>>vf&Il)}:{h:Number(t>>vf&Il)|0,l:Number(t&Il)|0}}function OP(t,e=!1){let n=new Uint32Array(t.length),r=new Uint32Array(t.length);for(let s=0;s<t.length;s++){const{h:i,l:o}=gv(t[s],e);[n[s],r[s]]=[i,o]}return[n,r]}const RP=(t,e)=>BigInt(t>>>0)<<vf|BigInt(e>>>0),DP=(t,e,n)=>t>>>n,$P=(t,e,n)=>t<<32-n|e>>>n,kP=(t,e,n)=>t>>>n|e<<32-n,UP=(t,e,n)=>t<<32-n|e>>>n,LP=(t,e,n)=>t<<64-n|e>>>n-32,MP=(t,e,n)=>t>>>n-32|e<<64-n,BP=(t,e)=>e,FP=(t,e)=>t,jP=(t,e,n)=>t<<n|e>>>32-n,HP=(t,e,n)=>e<<n|t>>>32-n,qP=(t,e,n)=>e<<n-32|t>>>64-n,zP=(t,e,n)=>t<<n-32|e>>>64-n;function WP(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const VP=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),GP=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,KP=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),YP=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,ZP=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),JP=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,Ie={fromBig:gv,split:OP,toBig:RP,shrSH:DP,shrSL:$P,rotrSH:kP,rotrSL:UP,rotrBH:LP,rotrBL:MP,rotr32H:BP,rotr32L:FP,rotlSH:jP,rotlSL:HP,rotlBH:qP,rotlBL:zP,add:WP,add3L:VP,add3H:GP,add4L:KP,add4H:YP,add5H:JP,add5L:ZP},[XP,QP]=Ie.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),ws=new Uint32Array(80),bs=new Uint32Array(80);let e3=class extends PP{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let y=0;y<16;y++,n+=4)ws[y]=e.getUint32(n),bs[y]=e.getUint32(n+=4);for(let y=16;y<80;y++){const N=ws[y-15]|0,_=bs[y-15]|0,T=Ie.rotrSH(N,_,1)^Ie.rotrSH(N,_,8)^Ie.shrSH(N,_,7),x=Ie.rotrSL(N,_,1)^Ie.rotrSL(N,_,8)^Ie.shrSL(N,_,7),D=ws[y-2]|0,I=bs[y-2]|0,U=Ie.rotrSH(D,I,19)^Ie.rotrBH(D,I,61)^Ie.shrSH(D,I,6),R=Ie.rotrSL(D,I,19)^Ie.rotrBL(D,I,61)^Ie.shrSL(D,I,6),k=Ie.add4L(x,R,bs[y-7],bs[y-16]),M=Ie.add4H(k,T,U,ws[y-7],ws[y-16]);ws[y]=M|0,bs[y]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:v,Hl:b}=this;for(let y=0;y<80;y++){const N=Ie.rotrSH(d,h,14)^Ie.rotrSH(d,h,18)^Ie.rotrBH(d,h,41),_=Ie.rotrSL(d,h,14)^Ie.rotrSL(d,h,18)^Ie.rotrBL(d,h,41),T=d&f^~d&g,x=h&p^~h&m,D=Ie.add5L(b,_,x,QP[y],bs[y]),I=Ie.add5H(D,v,N,T,XP[y],ws[y]),U=D|0,R=Ie.rotrSH(r,s,28)^Ie.rotrBH(r,s,34)^Ie.rotrBH(r,s,39),k=Ie.rotrSL(r,s,28)^Ie.rotrBL(r,s,34)^Ie.rotrBL(r,s,39),M=r&i^r&a^i&a,F=s&o^s&c^o&c;v=g|0,b=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=Ie.add(l|0,u|0,I|0,U|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const E=Ie.add3L(U,k,F);r=Ie.add3H(E,I,R,M),s=E|0}({h:r,l:s}=Ie.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=Ie.add(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=Ie.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=Ie.add(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=Ie.add(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=Ie.add(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=Ie.add(this.Gh|0,this.Gl|0,g|0,m|0),{h:v,l:b}=Ie.add(this.Hh|0,this.Hl|0,v|0,b|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,v,b)}roundClean(){ws.fill(0),bs.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const t3=xP(()=>new e3);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zp=BigInt(0),mv=BigInt(1),n3=BigInt(2);function Wp(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Vp(t){if(!Wp(t))throw new Error("Uint8Array expected")}function th(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const r3=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gp(t){Vp(t);let e="";for(let n=0;n<t.length;n++)e+=r3[t[n]];return e}function yv(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?zp:BigInt("0x"+t)}const Vr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Bm(t){if(t>=Vr._0&&t<=Vr._9)return t-Vr._0;if(t>=Vr.A&&t<=Vr.F)return t-(Vr.A-10);if(t>=Vr.a&&t<=Vr.f)return t-(Vr.a-10)}function wv(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=Bm(t.charCodeAt(i)),a=Bm(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function s3(t){return yv(Gp(t))}function Xl(t){return Vp(t),yv(Gp(Uint8Array.from(t).reverse()))}function bv(t,e){return wv(t.toString(16).padStart(e*2,"0"))}function Ef(t,e){return bv(t,e).reverse()}function Gr(t,e,n){let r;if(typeof e=="string")try{r=wv(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(Wp(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}function Fm(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Vp(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}const nh=t=>typeof t=="bigint"&&zp<=t;function i3(t,e,n){return nh(t)&&nh(e)&&nh(n)&&e<=t&&t<n}function fa(t,e,n,r){if(!i3(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function o3(t){let e;for(e=0;t>zp;t>>=mv,e+=1);return e}const a3=t=>(n3<<BigInt(t-1))-mv,c3={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Wp(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Kp(t,e,n={}){const r=(s,i,o)=>{const a=c3[i];if(typeof a!="function")throw new Error("invalid validator function");const c=t[s];if(!(o&&c===void 0)&&!a(c,t))throw new Error("param "+String(s)+" is invalid. Expected "+i+", got "+c)};for(const[s,i]of Object.entries(e))r(s,i,!1);for(const[s,i]of Object.entries(n))r(s,i,!0);return t}function jm(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const Ot=BigInt(0),pt=BigInt(1),fi=BigInt(2),l3=BigInt(3),Cf=BigInt(4),Hm=BigInt(5),qm=BigInt(8);function Ct(t,e){const n=t%e;return n>=Ot?n:e+n}function u3(t,e,n){if(e<Ot)throw new Error("invalid exponent, negatives unsupported");if(n<=Ot)throw new Error("invalid modulus");if(n===pt)return Ot;let r=pt;for(;e>Ot;)e&pt&&(r=r*t%n),t=t*t%n,e>>=pt;return r}function br(t,e,n){let r=t;for(;e-- >Ot;)r*=r,r%=n;return r}function zm(t,e){if(t===Ot)throw new Error("invert: expected non-zero number");if(e<=Ot)throw new Error("invert: expected positive modulus, got "+e);let n=Ct(t,e),r=e,s=Ot,i=pt;for(;n!==Ot;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==pt)throw new Error("invert: does not exist");return Ct(s,e)}function d3(t){const e=(t-pt)/fi;let n,r,s;for(n=t-pt,r=0;n%fi===Ot;n/=fi,r++);for(s=fi;s<t&&u3(s,e,t)!==t-pt;s++)if(s>1e3)throw new Error("Cannot find square root: likely non-prime P");if(r===1){const o=(t+pt)/Cf;return function(a,c){const l=a.pow(c,o);if(!a.eql(a.sqr(l),c))throw new Error("Cannot find square root");return l}}const i=(n+pt)/fi;return function(o,a){if(o.pow(a,e)===o.neg(o.ONE))throw new Error("Cannot find square root");let c=r,l=o.pow(o.mul(o.ONE,s),n),u=o.pow(a,i),d=o.pow(a,n);for(;!o.eql(d,o.ONE);){if(o.eql(d,o.ZERO))return o.ZERO;let h=1;for(let p=o.sqr(d);h<c&&!o.eql(p,o.ONE);h++)p=o.sqr(p);const f=o.pow(l,pt<<BigInt(c-h-1));l=o.sqr(f),u=o.mul(u,f),d=o.mul(d,l),c=h}return u}}function h3(t){if(t%Cf===l3){const e=(t+pt)/Cf;return function(n,r){const s=n.pow(r,e);if(!n.eql(n.sqr(s),r))throw new Error("Cannot find square root");return s}}if(t%qm===Hm){const e=(t-Hm)/qm;return function(n,r){const s=n.mul(r,fi),i=n.pow(s,e),o=n.mul(r,i),a=n.mul(n.mul(o,fi),i),c=n.mul(o,n.sub(a,n.ONE));if(!n.eql(n.sqr(c),r))throw new Error("Cannot find square root");return c}}return d3(t)}const f3=(t,e)=>(Ct(t,e)&pt)===pt,p3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function g3(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},n=p3.reduce((r,s)=>(r[s]="function",r),e);return Kp(t,n)}function m3(t,e,n){if(n<Ot)throw new Error("invalid exponent, negatives unsupported");if(n===Ot)return t.ONE;if(n===pt)return e;let r=t.ONE,s=e;for(;n>Ot;)n&pt&&(r=t.mul(r,s)),s=t.sqr(s),n>>=pt;return r}function y3(t,e){const n=new Array(e.length),r=e.reduce((i,o,a)=>t.is0(o)?i:(n[a]=i,t.mul(i,o)),t.ONE),s=t.inv(r);return e.reduceRight((i,o,a)=>t.is0(o)?i:(n[a]=t.mul(i,n[a]),t.mul(i,o)),s),n}function vv(t,e){const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function Ev(t,e,n=!1,r={}){if(t<=Ot)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:s,nByteLength:i}=vv(t,e);if(i>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let o;const a=Object.freeze({ORDER:t,isLE:n,BITS:s,BYTES:i,MASK:a3(s),ZERO:Ot,ONE:pt,create:c=>Ct(c,t),isValid:c=>{if(typeof c!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof c);return Ot<=c&&c<t},is0:c=>c===Ot,isOdd:c=>(c&pt)===pt,neg:c=>Ct(-c,t),eql:(c,l)=>c===l,sqr:c=>Ct(c*c,t),add:(c,l)=>Ct(c+l,t),sub:(c,l)=>Ct(c-l,t),mul:(c,l)=>Ct(c*l,t),pow:(c,l)=>m3(a,c,l),div:(c,l)=>Ct(c*zm(l,t),t),sqrN:c=>c*c,addN:(c,l)=>c+l,subN:(c,l)=>c-l,mulN:(c,l)=>c*l,inv:c=>zm(c,t),sqrt:r.sqrt||(c=>(o||(o=h3(t)),o(a,c))),invertBatch:c=>y3(a,c),cmov:(c,l,u)=>u?l:c,toBytes:c=>n?Ef(c,i):bv(c,i),fromBytes:c=>{if(c.length!==i)throw new Error("Field.fromBytes: expected "+i+" bytes, got "+c.length);return n?Xl(c):s3(c)}});return Object.freeze(a)}const Wm=BigInt(0),Sl=BigInt(1);function rh(t,e){const n=e.negate();return t?n:e}function Cv(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function sh(t,e){Cv(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1);return{windows:n,windowSize:r}}function w3(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function b3(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const ih=new WeakMap,_v=new WeakMap;function oh(t){return _v.get(t)||1}function v3(t,e){return{constTimeNegate:rh,hasPrecomputes(n){return oh(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>Wm;)r&Sl&&(s=s.add(i)),i=i.double(),r>>=Sl;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=sh(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){const{windows:i,windowSize:o}=sh(n,e);let a=t.ZERO,c=t.BASE;const l=BigInt(2**n-1),u=2**n,d=BigInt(n);for(let h=0;h<i;h++){const f=h*o;let p=Number(s&l);s>>=d,p>o&&(p-=u,s+=Sl);const g=f,m=f+Math.abs(p)-1,v=h%2!==0,b=p<0;p===0?c=c.add(rh(v,r[g])):a=a.add(rh(b,r[m]))}return{p:a,f:c}},wNAFUnsafe(n,r,s,i=t.ZERO){const{windows:o,windowSize:a}=sh(n,e),c=BigInt(2**n-1),l=2**n,u=BigInt(n);for(let d=0;d<o;d++){const h=d*a;if(s===Wm)break;let f=Number(s&c);if(s>>=u,f>a&&(f-=l,s+=Sl),f===0)continue;let p=r[h+Math.abs(f)-1];f<0&&(p=p.negate()),i=i.add(p)}return i},getPrecomputes(n,r,s){let i=ih.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&ih.set(r,s(i))),i},wNAFCached(n,r,s){const i=oh(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=oh(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){Cv(r,e),_v.set(n,r),ih.delete(n)}}}function E3(t,e,n,r){if(w3(n,t),b3(r,e),n.length!==r.length)throw new Error("arrays of points and scalars must have equal length");const s=t.ZERO,i=o3(BigInt(n.length)),o=i>12?i-3:i>4?i-2:i?2:1,a=(1<<o)-1,c=new Array(a+1).fill(s),l=Math.floor((e.BITS-1)/o)*o;let u=s;for(let d=l;d>=0;d-=o){c.fill(s);for(let f=0;f<r.length;f++){const p=r[f],g=Number(p>>BigInt(d)&BigInt(a));c[g]=c[g].add(n[f])}let h=s;for(let f=c.length-1,p=s;f>0;f--)p=p.add(c[f]),h=h.add(p);if(u=u.add(h),d!==0)for(let f=0;f<o;f++)u=u.double()}return u}function C3(t){return g3(t.Fp),Kp(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...vv(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const tr=BigInt(0),dn=BigInt(1),Nl=BigInt(2),_3=BigInt(8),A3={zip215:!0};function I3(t){const e=C3(t);return Kp(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function S3(t){const e=I3(t),{Fp:n,n:r,prehash:s,hash:i,randomBytes:o,nByteLength:a,h:c}=e,l=Nl<<BigInt(a*8)-dn,u=n.create,d=Ev(e.n,e.nBitLength),h=e.uvRatio||((E,S)=>{try{return{isValid:!0,value:n.sqrt(E*n.inv(S))}}catch{return{isValid:!1,value:tr}}}),f=e.adjustScalarBytes||(E=>E),p=e.domain||((E,S,O)=>{if(th("phflag",O),S.length||O)throw new Error("Contexts/pre-hash are not supported");return E});function g(E,S){fa("coordinate "+E,S,tr,l)}function m(E){if(!(E instanceof y))throw new Error("ExtendedPoint expected")}const v=jm((E,S)=>{const{ex:O,ey:$,ez:C}=E,P=E.is0();S==null&&(S=P?_3:n.inv(C));const B=u(O*S),H=u($*S),G=u(C*S);if(P)return{x:tr,y:dn};if(G!==dn)throw new Error("invZ was invalid");return{x:B,y:H}}),b=jm(E=>{const{a:S,d:O}=e;if(E.is0())throw new Error("bad point: ZERO");const{ex:$,ey:C,ez:P,et:B}=E,H=u($*$),G=u(C*C),W=u(P*P),se=u(W*W),ue=u(H*S),De=u(W*u(ue+G)),je=u(se+u(O*u(H*G)));if(De!==je)throw new Error("bad point: equation left != right (1)");const xe=u($*C),ft=u(P*B);if(xe!==ft)throw new Error("bad point: equation left != right (2)");return!0});class y{constructor(S,O,$,C){this.ex=S,this.ey=O,this.ez=$,this.et=C,g("x",S),g("y",O),g("z",$),g("t",C),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(S){if(S instanceof y)throw new Error("extended point not allowed");const{x:O,y:$}=S||{};return g("x",O),g("y",$),new y(O,$,dn,u(O*$))}static normalizeZ(S){const O=n.invertBatch(S.map($=>$.ez));return S.map(($,C)=>$.toAffine(O[C])).map(y.fromAffine)}static msm(S,O){return E3(y,d,S,O)}_setWindowSize(S){T.setWindowSize(this,S)}assertValidity(){b(this)}equals(S){m(S);const{ex:O,ey:$,ez:C}=this,{ex:P,ey:B,ez:H}=S,G=u(O*H),W=u(P*C),se=u($*H),ue=u(B*C);return G===W&&se===ue}is0(){return this.equals(y.ZERO)}negate(){return new y(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){const{a:S}=e,{ex:O,ey:$,ez:C}=this,P=u(O*O),B=u($*$),H=u(Nl*u(C*C)),G=u(S*P),W=O+$,se=u(u(W*W)-P-B),ue=G+B,De=ue-H,je=G-B,xe=u(se*De),ft=u(ue*je),Rt=u(se*je),ri=u(De*ue);return new y(xe,ft,ri,Rt)}add(S){m(S);const{a:O,d:$}=e,{ex:C,ey:P,ez:B,et:H}=this,{ex:G,ey:W,ez:se,et:ue}=S;if(O===BigInt(-1)){const Ng=u((P-C)*(W+G)),xg=u((P+C)*(W-G)),Rd=u(xg-Ng);if(Rd===tr)return this.double();const Tg=u(B*Nl*ue),Pg=u(H*Nl*se),Og=Pg+Tg,Rg=xg+Ng,Dg=Pg-Tg,N_=u(Og*Rd),x_=u(Rg*Dg),T_=u(Og*Dg),P_=u(Rd*Rg);return new y(N_,x_,P_,T_)}const De=u(C*G),je=u(P*W),xe=u(H*$*ue),ft=u(B*se),Rt=u((C+P)*(G+W)-De-je),ri=ft-xe,pl=ft+xe,Ji=u(je-O*De),Od=u(Rt*ri),A_=u(pl*Ji),I_=u(Rt*Ji),S_=u(ri*pl);return new y(Od,A_,S_,I_)}subtract(S){return this.add(S.negate())}wNAF(S){return T.wNAFCached(this,S,y.normalizeZ)}multiply(S){const O=S;fa("scalar",O,dn,r);const{p:$,f:C}=this.wNAF(O);return y.normalizeZ([$,C])[0]}multiplyUnsafe(S,O=y.ZERO){const $=S;return fa("scalar",$,tr,r),$===tr?_:this.is0()||$===dn?this:T.wNAFCachedUnsafe(this,$,y.normalizeZ,O)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return T.unsafeLadder(this,r).is0()}toAffine(S){return v(this,S)}clearCofactor(){const{h:S}=e;return S===dn?this:this.multiplyUnsafe(S)}static fromHex(S,O=!1){const{d:$,a:C}=e,P=n.BYTES;S=Gr("pointHex",S,P),th("zip215",O);const B=S.slice(),H=S[P-1];B[P-1]=H&-129;const G=Xl(B),W=O?l:n.ORDER;fa("pointHex.y",G,tr,W);const se=u(G*G),ue=u(se-dn),De=u($*se-C);let{isValid:je,value:xe}=h(ue,De);if(!je)throw new Error("Point.fromHex: invalid y coordinate");const ft=(xe&dn)===dn,Rt=(H&128)!==0;if(!O&&xe===tr&&Rt)throw new Error("Point.fromHex: x=0 and x_0=1");return Rt!==ft&&(xe=u(-xe)),y.fromAffine({x:xe,y:G})}static fromPrivateKey(S){return I(S).point}toRawBytes(){const{x:S,y:O}=this.toAffine(),$=Ef(O,n.BYTES);return $[$.length-1]|=S&dn?128:0,$}toHex(){return Gp(this.toRawBytes())}}y.BASE=new y(e.Gx,e.Gy,dn,u(e.Gx*e.Gy)),y.ZERO=new y(tr,dn,dn,tr);const{BASE:N,ZERO:_}=y,T=v3(y,a*8);function x(E){return Ct(E,r)}function D(E){return x(Xl(E))}function I(E){const S=n.BYTES;E=Gr("private key",E,S);const O=Gr("hashed private key",i(E),2*S),$=f(O.slice(0,S)),C=O.slice(S,2*S),P=D($),B=N.multiply(P),H=B.toRawBytes();return{head:$,prefix:C,scalar:P,point:B,pointBytes:H}}function U(E){return I(E).pointBytes}function R(E=new Uint8Array,...S){const O=Fm(...S);return D(i(p(O,Gr("context",E),!!s)))}function k(E,S,O={}){E=Gr("message",E),s&&(E=s(E));const{prefix:$,scalar:C,pointBytes:P}=I(S),B=R(O.context,$,E),H=N.multiply(B).toRawBytes(),G=R(O.context,H,P,E),W=x(B+G*C);fa("signature.s",W,tr,r);const se=Fm(H,Ef(W,n.BYTES));return Gr("result",se,n.BYTES*2)}const M=A3;function F(E,S,O,$=M){const{context:C,zip215:P}=$,B=n.BYTES;E=Gr("signature",E,2*B),S=Gr("message",S),O=Gr("publicKey",O,B),P!==void 0&&th("zip215",P),s&&(S=s(S));const H=Xl(E.slice(B,2*B));let G,W,se;try{G=y.fromHex(O,P),W=y.fromHex(E.slice(0,B),P),se=N.multiplyUnsafe(H)}catch{return!1}if(!P&&G.isSmallOrder())return!1;const ue=R(C,W.toRawBytes(),G.toRawBytes(),S);return W.add(G.multiplyUnsafe(ue)).subtract(se).clearCofactor().equals(y.ZERO)}return N._setWindowSize(8),{CURVE:e,getPublicKey:U,sign:k,verify:F,ExtendedPoint:y,utils:{getExtendedPublicKey:I,randomPrivateKey:()=>o(n.BYTES),precompute(E=8,S=y.BASE){return S._setWindowSize(E),S.multiply(BigInt(3)),S}}}}BigInt(0),BigInt(1);const Yp=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Vm=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const N3=BigInt(1),Gm=BigInt(2);BigInt(3);const x3=BigInt(5),T3=BigInt(8);function P3(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=Yp,o=t*t%i*t%i,a=br(o,Gm,i)*o%i,c=br(a,N3,i)*t%i,l=br(c,x3,i)*c%i,u=br(l,e,i)*l%i,d=br(u,n,i)*u%i,h=br(d,r,i)*d%i,f=br(h,s,i)*h%i,p=br(f,s,i)*h%i,g=br(p,e,i)*l%i;return{pow_p_5_8:br(g,Gm,i)*t%i,b2:o}}function O3(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function R3(t,e){const n=Yp,r=Ct(e*e*e,n),s=Ct(r*r*e,n),i=P3(t*s).pow_p_5_8;let o=Ct(t*r*i,n);const a=Ct(e*o*o,n),c=o,l=Ct(o*Vm,n),u=a===t,d=a===Ct(-t,n),h=a===Ct(-t*Vm,n);return u&&(o=c),(d||h)&&(o=l),f3(o,n)&&(o=Ct(-o,n)),{isValid:u||d,value:o}}const D3=Ev(Yp,void 0,!0),$3={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:D3,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:T3,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:t3,randomBytes:pv,adjustScalarBytes:O3,uvRatio:R3},Av=S3($3),k3="EdDSA",U3="JWT",_u=".",cd="base64url",Iv="utf8",Sv="utf8",L3=":",M3="did",B3="key",Km="base58btc",F3="z",j3="K36",H3=32;function Zp(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Nv(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Zp(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function xv(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=Nv(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return Zp(n)}function q3(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,b=p.length;v!==b&&p[v]===0;)v++,g++;for(var y=(b-v)*u+1>>>0,N=new Uint8Array(y);v!==b;){for(var _=p[v],T=0,x=y-1;(_!==0||T<m)&&x!==-1;x--,T++)_+=256*N[x]>>>0,N[x]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");m=T,v++}for(var D=y-m;D!==y&&N[D]===0;)D++;for(var I=c.repeat(g);D<y;++D)I+=t.charAt(N[D]);return I}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===c;)m++,g++;for(var b=(p.length-g)*l+1>>>0,y=new Uint8Array(b);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var _=0,T=b-1;(N!==0||_<v)&&T!==-1;T--,_++)N+=a*y[T]>>>0,y[T]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");v=_,g++}if(p[g]!==" "){for(var x=b-v;x!==b&&y[x]===0;)x++;for(var D=new Uint8Array(m+(b-x)),I=m;x!==b;)D[I++]=y[x++];return D}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var z3=q3,W3=z3;const Tv=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},V3=t=>new TextEncoder().encode(t),G3=t=>new TextDecoder().decode(t);let K3=class{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Y3=class{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Pv(this,e)}},Z3=class{constructor(e){this.decoders=e}or(e){return Pv(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Pv=(t,e)=>new Z3({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let J3=class{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new K3(e,n,r),this.decoder=new Y3(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const ld=({name:t,prefix:e,encode:n,decode:r})=>new J3(t,e,n,r),sl=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=W3(n,e);return ld({prefix:t,name:e,encode:r,decode:i=>Tv(s(i))})},X3=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},Q3=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},jt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>ld({prefix:e,name:t,encode(s){return Q3(s,r,n)},decode(s){return X3(s,r,n,t)}}),eO=ld({prefix:"\0",name:"identity",encode:t=>G3(t),decode:t=>V3(t)});var tO=Object.freeze({__proto__:null,identity:eO});const nO=jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var rO=Object.freeze({__proto__:null,base2:nO});const sO=jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var iO=Object.freeze({__proto__:null,base8:sO});const oO=sl({prefix:"9",name:"base10",alphabet:"0123456789"});var aO=Object.freeze({__proto__:null,base10:oO});const cO=jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),lO=jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var uO=Object.freeze({__proto__:null,base16:cO,base16upper:lO});const dO=jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),hO=jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),fO=jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),pO=jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),gO=jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),mO=jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),yO=jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),wO=jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),bO=jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var vO=Object.freeze({__proto__:null,base32:dO,base32upper:hO,base32pad:fO,base32padupper:pO,base32hex:gO,base32hexupper:mO,base32hexpad:yO,base32hexpadupper:wO,base32z:bO});const EO=sl({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),CO=sl({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var _O=Object.freeze({__proto__:null,base36:EO,base36upper:CO});const AO=sl({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),IO=sl({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var SO=Object.freeze({__proto__:null,base58btc:AO,base58flickr:IO});const NO=jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),xO=jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),TO=jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),PO=jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var OO=Object.freeze({__proto__:null,base64:NO,base64pad:xO,base64url:TO,base64urlpad:PO});const Ov=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),RO=Ov.reduce((t,e,n)=>(t[n]=e,t),[]),DO=Ov.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function $O(t){return t.reduce((e,n)=>(e+=RO[n],e),"")}function kO(t){const e=[];for(const n of t){const r=DO[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const UO=ld({prefix:"🚀",name:"base256emoji",encode:$O,decode:kO});var LO=Object.freeze({__proto__:null,base256emoji:UO}),MO=Rv,Ym=128,BO=-128,FO=Math.pow(2,31);function Rv(t,e,n){e=e||[],n=n||0;for(var r=n;t>=FO;)e[n++]=t&255|Ym,t/=128;for(;t&BO;)e[n++]=t&255|Ym,t>>>=7;return e[n]=t|0,Rv.bytes=n-r+1,e}var jO=_f,HO=128,Zm=127;function _f(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw _f.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&Zm)<<s:(o&Zm)*Math.pow(2,s),s+=7}while(o>=HO);return _f.bytes=i-r,n}var qO=Math.pow(2,7),zO=Math.pow(2,14),WO=Math.pow(2,21),VO=Math.pow(2,28),GO=Math.pow(2,35),KO=Math.pow(2,42),YO=Math.pow(2,49),ZO=Math.pow(2,56),JO=Math.pow(2,63),XO=function(t){return t<qO?1:t<zO?2:t<WO?3:t<VO?4:t<GO?5:t<KO?6:t<YO?7:t<ZO?8:t<JO?9:10},QO={encode:MO,decode:jO,encodingLength:XO},Dv=QO;const Jm=(t,e,n=0)=>(Dv.encode(t,e,n),e),Xm=t=>Dv.encodingLength(t),Af=(t,e)=>{const n=e.byteLength,r=Xm(t),s=r+Xm(n),i=new Uint8Array(s+n);return Jm(t,i,0),Jm(n,i,r),i.set(e,s),new eR(t,n,e,i)};let eR=class{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}};const $v=({name:t,code:e,encode:n})=>new tR(t,e,n);let tR=class{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Af(this.code,n):n.then(r=>Af(this.code,r))}else throw Error("Unknown type, must be binary type")}};const kv=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),nR=$v({name:"sha2-256",code:18,encode:kv("SHA-256")}),rR=$v({name:"sha2-512",code:19,encode:kv("SHA-512")});var sR=Object.freeze({__proto__:null,sha256:nR,sha512:rR});const Uv=0,iR="identity",Lv=Tv,oR=t=>Af(Uv,Lv(t)),aR={code:Uv,name:iR,encode:Lv,digest:oR};var cR=Object.freeze({__proto__:null,identity:aR});new TextEncoder,new TextDecoder;const Qm={...tO,...rO,...iO,...aO,...uO,...vO,..._O,...SO,...OO,...LO};({...sR,...cR});function Mv(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const e0=Mv("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),ah=Mv("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=Nv(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),Bv={utf8:e0,"utf-8":e0,hex:Qm.base16,latin1:ah,ascii:ah,binary:ah,...Qm};function ud(t,e="utf8"){const n=Bv[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}function Yo(t,e="utf8"){const n=Bv[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Zp(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function t0(t){return $i(ud(Yo(t,cd),Iv))}function Au(t){return ud(Yo(ls(t),Iv),cd)}function Fv(t){const e=Yo(j3,Km),n=F3+ud(xv([e,t]),Km);return[M3,B3,n].join(L3)}function lR(t){return ud(t,cd)}function uR(t){return Yo(t,cd)}function dR(t){return Yo([Au(t.header),Au(t.payload)].join(_u),Sv)}function hR(t){return[Au(t.header),Au(t.payload),lR(t.signature)].join(_u)}function If(t){const e=t.split(_u),n=t0(e[0]),r=t0(e[1]),s=uR(e[2]),i=Yo(e.slice(0,2).join(_u),Sv);return{header:n,payload:r,signature:s,data:i}}function n0(t=pv(H3)){const e=Av.getPublicKey(t);return{secretKey:xv([t,e]),publicKey:e}}async function fR(t,e,n,r,s=Y.fromMiliseconds(Date.now())){const i={alg:k3,typ:U3},o=Fv(r.publicKey),a=s+n,c={iss:o,sub:t,aud:e,iat:s,exp:a},l=dR({header:i,payload:c}),u=Av.sign(l,r.secretKey.slice(0,32));return hR({header:i,payload:c,signature:u})}var r0=function(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},pR=function(){function t(e,n,r){this.name=e,this.version=n,this.os=r,this.type="browser"}return t}(),gR=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),mR=function(){function t(e,n,r,s){this.name=e,this.version=n,this.os=r,this.bot=s,this.type="bot-device"}return t}(),yR=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),wR=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),bR=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,vR=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,s0=3,ER=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",bR]],i0=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function CR(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new wR:typeof navigator<"u"?AR(navigator.userAgent):SR()}function _R(t){return t!==""&&ER.reduce(function(e,n){var r=n[0],s=n[1];if(e)return e;var i=s.exec(t);return!!i&&[r,i]},!1)}function AR(t){var e=_R(t);if(!e)return null;var n=e[0],r=e[1];if(n==="searchbot")return new yR;var s=r[1]&&r[1].split(".").join("_").split("_").slice(0,3);s?s.length<s0&&(s=r0(r0([],s,!0),NR(s0-s.length),!0)):s=[];var i=s.join("."),o=IR(t),a=vR.exec(t);return a&&a[1]?new mR(n,i,o,a[1]):new pR(n,i,o)}function IR(t){for(var e=0,n=i0.length;e<n;e++){var r=i0[e],s=r[0],i=r[1],o=i.exec(t);if(o)return s}return null}function SR(){var t=typeof process<"u"&&process.version;return t?new gR(process.version.slice(1)):null}function NR(t){for(var e=[],n=0;n<t;n++)e.push("0");return e}var tt={};Object.defineProperty(tt,"__esModule",{value:!0});tt.getLocalStorage=tt.getLocalStorageOrThrow=tt.getCrypto=tt.getCryptoOrThrow=jv=tt.getLocation=tt.getLocationOrThrow=Jp=tt.getNavigator=tt.getNavigatorOrThrow=ki=tt.getDocument=tt.getDocumentOrThrow=tt.getFromWindowOrThrow=tt.getFromWindow=void 0;function Ki(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}tt.getFromWindow=Ki;function Zo(t){const e=Ki(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}tt.getFromWindowOrThrow=Zo;function xR(){return Zo("document")}tt.getDocumentOrThrow=xR;function TR(){return Ki("document")}var ki=tt.getDocument=TR;function PR(){return Zo("navigator")}tt.getNavigatorOrThrow=PR;function OR(){return Ki("navigator")}var Jp=tt.getNavigator=OR;function RR(){return Zo("location")}tt.getLocationOrThrow=RR;function DR(){return Ki("location")}var jv=tt.getLocation=DR;function $R(){return Zo("crypto")}tt.getCryptoOrThrow=$R;function kR(){return Ki("crypto")}tt.getCrypto=kR;function UR(){return Zo("localStorage")}tt.getLocalStorageOrThrow=UR;function LR(){return Ki("localStorage")}tt.getLocalStorage=LR;var Xp={};Object.defineProperty(Xp,"__esModule",{value:!0});var Hv=Xp.getWindowMetadata=void 0;const o0=tt;function MR(){let t,e;try{t=o0.getDocumentOrThrow(),e=o0.getLocationOrThrow()}catch{return null}function n(){const d=t.getElementsByTagName("link"),h=[];for(let f=0;f<d.length;f++){const p=d[f],g=p.getAttribute("rel");if(g&&g.toLowerCase().indexOf("icon")>-1){const m=p.getAttribute("href");if(m)if(m.toLowerCase().indexOf("https:")===-1&&m.toLowerCase().indexOf("http:")===-1&&m.indexOf("//")!==0){let v=e.protocol+"//"+e.host;if(m.indexOf("/")===0)v+=m;else{const b=e.pathname.split("/");b.pop();const y=b.join("/");v+=y+"/"+m}h.push(v)}else if(m.indexOf("//")===0){const v=e.protocol+m;h.push(v)}else h.push(m)}}return h}function r(...d){const h=t.getElementsByTagName("meta");for(let f=0;f<h.length;f++){const p=h[f],g=["itemprop","property","name"].map(m=>p.getAttribute(m)).filter(m=>m?d.includes(m):!1);if(g.length&&g){const m=p.getAttribute("content");if(m)return m}}return""}function s(){let d=r("name","og:site_name","og:title","twitter:title");return d||(d=t.title),d}function i(){return r("description","og:description","twitter:description","keywords")}const o=s(),a=i(),c=e.origin,l=n();return{description:a,url:c,icons:l,name:o}}Hv=Xp.getWindowMetadata=MR;function Ic(t,{strict:e=!0}={}){return!t||typeof t!="string"?!1:e?/^0x[0-9a-fA-F]*$/.test(t):t.startsWith("0x")}function Sf(t){return Ic(t,{strict:!1})?Math.ceil((t.length-2)/2):t.length}const qv="2.31.0";let pa={getDocsUrl:({docsBaseUrl:t,docsPath:e="",docsSlug:n})=>e?`${t??"https://viem.sh"}${e}${n?`#${n}`:""}`:void 0,version:`viem@${qv}`},dd=class Nf extends Error{constructor(e,n={}){var a;const r=(()=>{var c;return n.cause instanceof Nf?n.cause.details:(c=n.cause)!=null&&c.message?n.cause.message:n.details})(),s=n.cause instanceof Nf&&n.cause.docsPath||n.docsPath,i=(a=pa.getDocsUrl)==null?void 0:a.call(pa,{...n,docsPath:s}),o=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...i?[`Docs: ${i}`]:[],...r?[`Details: ${r}`]:[],...pa.version?[`Version: ${pa.version}`]:[]].join(`
`);super(o,n.cause?{cause:n.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.name=n.name??this.name,this.shortMessage=e,this.version=qv}walk(e){return zv(this,e)}};function zv(t,e){return e!=null&&e(t)?t:t&&typeof t=="object"&&"cause"in t&&t.cause!==void 0?zv(t.cause,e):e?null:t}class Wv extends dd{constructor({size:e,targetSize:n,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${n}).`,{name:"SizeExceedsPaddingSizeError"})}}function Jo(t,{dir:e,size:n=32}={}){return typeof t=="string"?BR(t,{dir:e,size:n}):FR(t,{dir:e,size:n})}function BR(t,{dir:e,size:n=32}={}){if(n===null)return t;const r=t.replace("0x","");if(r.length>n*2)throw new Wv({size:Math.ceil(r.length/2),targetSize:n,type:"hex"});return`0x${r[e==="right"?"padEnd":"padStart"](n*2,"0")}`}function FR(t,{dir:e,size:n=32}={}){if(n===null)return t;if(t.length>n)throw new Wv({size:t.length,targetSize:n,type:"bytes"});const r=new Uint8Array(n);for(let s=0;s<n;s++){const i=e==="right";r[i?s:n-s-1]=t[i?s:t.length-s-1]}return r}class jR extends dd{constructor({max:e,min:n,signed:r,size:s,value:i}){super(`Number "${i}" is not in safe ${s?`${s*8}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${n} to ${e})`:`(above ${n})`}`,{name:"IntegerOutOfRangeError"})}}class HR extends dd{constructor({givenSize:e,maxSize:n}){super(`Size cannot exceed ${n} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function Xo(t,{size:e}){if(Sf(t)>e)throw new HR({givenSize:Sf(t),maxSize:e})}function xf(t,e={}){const{signed:n}=e;e.size&&Xo(t,{size:e.size});const r=BigInt(t);if(!n)return r;const s=(t.length-2)/2,i=(1n<<BigInt(s)*8n-1n)-1n;return r<=i?r:r-BigInt(`0x${"f".padStart(s*2,"f")}`)-1n}function qR(t,e={}){return Number(xf(t,e))}const zR=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Tf(t,e={}){return typeof t=="number"||typeof t=="bigint"?Gv(t,e):typeof t=="string"?GR(t,e):typeof t=="boolean"?WR(t,e):Vv(t,e)}function WR(t,e={}){const n=`0x${Number(t)}`;return typeof e.size=="number"?(Xo(n,{size:e.size}),Jo(n,{size:e.size})):n}function Vv(t,e={}){let n="";for(let s=0;s<t.length;s++)n+=zR[t[s]];const r=`0x${n}`;return typeof e.size=="number"?(Xo(r,{size:e.size}),Jo(r,{dir:"right",size:e.size})):r}function Gv(t,e={}){const{signed:n,size:r}=e,s=BigInt(t);let i;r?n?i=(1n<<BigInt(r)*8n-1n)-1n:i=2n**(BigInt(r)*8n)-1n:typeof t=="number"&&(i=BigInt(Number.MAX_SAFE_INTEGER));const o=typeof i=="bigint"&&n?-i-1n:0;if(i&&s>i||s<o){const c=typeof t=="bigint"?"n":"";throw new jR({max:i?`${i}${c}`:void 0,min:`${o}${c}`,signed:n,size:r,value:`${t}${c}`})}const a=`0x${(n&&s<0?(1n<<BigInt(r*8))+BigInt(s):s).toString(16)}`;return r?Jo(a,{size:r}):a}const VR=new TextEncoder;function GR(t,e={}){const n=VR.encode(t);return Vv(n,e)}const KR=new TextEncoder;function YR(t,e={}){return typeof t=="number"||typeof t=="bigint"?JR(t,e):typeof t=="boolean"?ZR(t,e):Ic(t)?Kv(t,e):Yv(t,e)}function ZR(t,e={}){const n=new Uint8Array(1);return n[0]=Number(t),typeof e.size=="number"?(Xo(n,{size:e.size}),Jo(n,{size:e.size})):n}const Kr={zero:48,nine:57,A:65,F:70,a:97,f:102};function a0(t){if(t>=Kr.zero&&t<=Kr.nine)return t-Kr.zero;if(t>=Kr.A&&t<=Kr.F)return t-(Kr.A-10);if(t>=Kr.a&&t<=Kr.f)return t-(Kr.a-10)}function Kv(t,e={}){let n=t;e.size&&(Xo(n,{size:e.size}),n=Jo(n,{dir:"right",size:e.size}));let r=n.slice(2);r.length%2&&(r=`0${r}`);const s=r.length/2,i=new Uint8Array(s);for(let o=0,a=0;o<s;o++){const c=a0(r.charCodeAt(a++)),l=a0(r.charCodeAt(a++));if(c===void 0||l===void 0)throw new dd(`Invalid byte sequence ("${r[a-2]}${r[a-1]}" in "${r}").`);i[o]=c*16+l}return i}function JR(t,e){const n=Gv(t,e);return Kv(n)}function Yv(t,e={}){const n=KR.encode(t);return typeof e.size=="number"?(Xo(n,{size:e.size}),Jo(n,{dir:"right",size:e.size})):n}function Zv(t,e){const n=e||"hex",r=Y1(Ic(t,{strict:!1})?YR(t):t);return n==="bytes"?r:Tf(r)}class XR extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){const n=super.get(e);return super.has(e)&&n!==void 0&&(this.delete(e),super.set(e,n)),n}set(e,n){if(super.set(e,n),this.maxSize&&this.size>this.maxSize){const r=this.keys().next().value;r&&this.delete(r)}return this}}const ch=new XR(8192);function QR(t,e){if(ch.has(`${t}.${e}`))return ch.get(`${t}.${e}`);const n=t.substring(2).toLowerCase(),r=Zv(Yv(n),"bytes"),s=n.split("");for(let o=0;o<40;o+=2)r[o>>1]>>4>=8&&s[o]&&(s[o]=s[o].toUpperCase()),(r[o>>1]&15)>=8&&s[o+1]&&(s[o+1]=s[o+1].toUpperCase());const i=`0x${s.join("")}`;return ch.set(`${t}.${e}`,i),i}function e5(t){const e=Zv(`0x${t.substring(4)}`).substring(26);return QR(`0x${e}`)}async function t5({hash:t,signature:e}){const n=Ic(t)?t:Tf(t),{secp256k1:r}=await Qt(async()=>{const{secp256k1:o}=await import("./D0rD0oH1.js");return{secp256k1:o}},__vite__mapDeps([5,2,1]),import.meta.url);return`0x${(()=>{if(typeof e=="object"&&"r"in e&&"s"in e){const{r:l,s:u,v:d,yParity:h}=e,f=Number(h??d),p=c0(f);return new r.Signature(xf(l),xf(u)).addRecoveryBit(p)}const o=Ic(e)?e:Tf(e);if(Sf(o)!==65)throw new Error("invalid signature length");const a=qR(`0x${o.slice(130)}`),c=c0(a);return r.Signature.fromCompact(o.substring(2,130)).addRecoveryBit(c)})().recoverPublicKey(n.substring(2)).toHex(!1)}`}function c0(t){if(t===0||t===1)return t;if(t===27)return 0;if(t===28)return 1;throw new Error("Invalid yParityOrV value")}async function n5({hash:t,signature:e}){return e5(await t5({hash:t,signature:e}))}function r5(t){if(t.length>=255)throw new TypeError("Alphabet too long");const e=new Uint8Array(256);for(let l=0;l<e.length;l++)e[l]=255;for(let l=0;l<t.length;l++){const u=t.charAt(l),d=u.charCodeAt(0);if(e[d]!==255)throw new TypeError(u+" is ambiguous");e[d]=l}const n=t.length,r=t.charAt(0),s=Math.log(n)/Math.log(256),i=Math.log(256)/Math.log(n);function o(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";let u=0,d=0,h=0;const f=l.length;for(;h!==f&&l[h]===0;)h++,u++;const p=(f-h)*i+1>>>0,g=new Uint8Array(p);for(;h!==f;){let b=l[h],y=0;for(let N=p-1;(b!==0||y<d)&&N!==-1;N--,y++)b+=256*g[N]>>>0,g[N]=b%n>>>0,b=b/n>>>0;if(b!==0)throw new Error("Non-zero carry");d=y,h++}let m=p-d;for(;m!==p&&g[m]===0;)m++;let v=r.repeat(u);for(;m<p;++m)v+=t.charAt(g[m]);return v}function a(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;let u=0,d=0,h=0;for(;l[u]===r;)d++,u++;const f=(l.length-u)*s+1>>>0,p=new Uint8Array(f);for(;u<l.length;){const b=l.charCodeAt(u);if(b>255)return;let y=e[b];if(y===255)return;let N=0;for(let _=f-1;(y!==0||N<h)&&_!==-1;_--,N++)y+=n*p[_]>>>0,p[_]=y%256>>>0,y=y/256>>>0;if(y!==0)throw new Error("Non-zero carry");h=N,u++}let g=f-h;for(;g!==f&&p[g]===0;)g++;const m=new Uint8Array(d+(f-g));let v=d;for(;g!==f;)m[v++]=p[g++];return m}function c(l){const u=a(l);if(u)return u;throw new Error("Non-base"+n+" character")}return{encode:o,decodeUnsafe:a,decode:c}}var s5="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const Qo=r5(s5);function i5(t){const e=t.length;let n=0,r=0;for(;r<e;){let s=t.charCodeAt(r++);if(s&4294967168)if(!(s&4294965248))n+=2;else{if(s>=55296&&s<=56319&&r<e){const i=t.charCodeAt(r);(i&64512)===56320&&(++r,s=((s&1023)<<10)+(i&1023)+65536)}s&4294901760?n+=4:n+=3}else{n++;continue}}return n}function o5(t,e,n){const r=t.length;let s=n,i=0;for(;i<r;){let o=t.charCodeAt(i++);if(o&4294967168)if(!(o&4294965248))e[s++]=o>>6&31|192;else{if(o>=55296&&o<=56319&&i<r){const a=t.charCodeAt(i);(a&64512)===56320&&(++i,o=((o&1023)<<10)+(a&1023)+65536)}o&4294901760?(e[s++]=o>>18&7|240,e[s++]=o>>12&63|128,e[s++]=o>>6&63|128):(e[s++]=o>>12&15|224,e[s++]=o>>6&63|128)}else{e[s++]=o;continue}e[s++]=o&63|128}}const a5=new TextEncoder,c5=50;function l5(t,e,n){a5.encodeInto(t,e.subarray(n))}function u5(t,e,n){t.length>c5?l5(t,e,n):o5(t,e,n)}const d5=4096;function Jv(t,e,n){let r=e;const s=r+n,i=[];let o="";for(;r<s;){const a=t[r++];if(!(a&128))i.push(a);else if((a&224)===192){const c=t[r++]&63;i.push((a&31)<<6|c)}else if((a&240)===224){const c=t[r++]&63,l=t[r++]&63;i.push((a&31)<<12|c<<6|l)}else if((a&248)===240){const c=t[r++]&63,l=t[r++]&63,u=t[r++]&63;let d=(a&7)<<18|c<<12|l<<6|u;d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|d&1023),i.push(d)}else i.push(a);i.length>=d5&&(o+=String.fromCharCode(...i),i.length=0)}return i.length>0&&(o+=String.fromCharCode(...i)),o}const h5=new TextDecoder,f5=200;function p5(t,e,n){const r=t.subarray(e,e+n);return h5.decode(r)}function g5(t,e,n){return n>f5?p5(t,e,n):Jv(t,e,n)}class xl{constructor(e,n){this.type=e,this.data=n}}class Tn extends Error{constructor(e){super(e);const n=Object.create(Tn.prototype);Object.setPrototypeOf(this,n),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:Tn.name})}}const ga=4294967295;function m5(t,e,n){const r=n/4294967296,s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function Xv(t,e,n){const r=Math.floor(n/4294967296),s=n;t.setUint32(e,r),t.setUint32(e+4,s)}function Qv(t,e){const n=t.getInt32(e),r=t.getUint32(e+4);return n*4294967296+r}function y5(t,e){const n=t.getUint32(e),r=t.getUint32(e+4);return n*4294967296+r}const w5=-1,b5=4294967296-1,v5=17179869184-1;function E5({sec:t,nsec:e}){if(t>=0&&e>=0&&t<=v5)if(e===0&&t<=b5){const n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,t),n}else{const n=t/4294967296,r=t&4294967295,s=new Uint8Array(8),i=new DataView(s.buffer);return i.setUint32(0,e<<2|n&3),i.setUint32(4,r),s}else{const n=new Uint8Array(12),r=new DataView(n.buffer);return r.setUint32(0,e),Xv(r,4,t),n}}function C5(t){const e=t.getTime(),n=Math.floor(e/1e3),r=(e-n*1e3)*1e6,s=Math.floor(r/1e9);return{sec:n+s,nsec:r-s*1e9}}function _5(t){if(t instanceof Date){const e=C5(t);return E5(e)}else return null}function A5(t){const e=new DataView(t.buffer,t.byteOffset,t.byteLength);switch(t.byteLength){case 4:return{sec:e.getUint32(0),nsec:0};case 8:{const n=e.getUint32(0),r=e.getUint32(4),s=(n&3)*4294967296+r,i=n>>>2;return{sec:s,nsec:i}}case 12:{const n=Qv(e,4),r=e.getUint32(0);return{sec:n,nsec:r}}default:throw new Tn(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${t.length}`)}}function I5(t){const e=A5(t);return new Date(e.sec*1e3+e.nsec/1e6)}const S5={type:w5,encode:_5,decode:I5};class Iu{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(S5)}register({type:e,encode:n,decode:r}){if(e>=0)this.encoders[e]=n,this.decoders[e]=r;else{const s=-1-e;this.builtInEncoders[s]=n,this.builtInDecoders[s]=r}}tryToEncode(e,n){for(let r=0;r<this.builtInEncoders.length;r++){const s=this.builtInEncoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=-1-r;return new xl(o,i)}}}for(let r=0;r<this.encoders.length;r++){const s=this.encoders[r];if(s!=null){const i=s(e,n);if(i!=null){const o=r;return new xl(o,i)}}}return e instanceof xl?e:null}decode(e,n,r){const s=n<0?this.builtInDecoders[-1-n]:this.decoders[n];return s?s(e,n,r):new xl(n,e)}}Iu.defaultCodec=new Iu;function N5(t){return t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer}function Pf(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):N5(t)?new Uint8Array(t):Uint8Array.from(t)}const x5=100,T5=2048;let P5=class eE{constructor(e){this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??Iu.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.maxDepth=(e==null?void 0:e.maxDepth)??x5,this.initialBufferSize=(e==null?void 0:e.initialBufferSize)??T5,this.sortKeys=(e==null?void 0:e.sortKeys)??!1,this.forceFloat32=(e==null?void 0:e.forceFloat32)??!1,this.ignoreUndefined=(e==null?void 0:e.ignoreUndefined)??!1,this.forceIntegerToFloat=(e==null?void 0:e.forceIntegerToFloat)??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new eE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,n){if(n>this.maxDepth)throw new Error(`Too deep objects in depth ${n}`);e==null?this.encodeNil():typeof e=="boolean"?this.encodeBoolean(e):typeof e=="number"?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):typeof e=="string"?this.encodeString(e):this.useBigInt64&&typeof e=="bigint"?this.encodeBigInt64(e):this.encodeObject(e,n)}ensureBufferSizeToWrite(e){const n=this.pos+e;this.view.byteLength<n&&this.resizeBuffer(n*2)}resizeBuffer(e){const n=new ArrayBuffer(e),r=new Uint8Array(n),s=new DataView(n);r.set(this.bytes),this.view=s,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){e===!1?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<4294967296?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-2147483648?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<4294967296)this.writeU8(219),this.writeU32(e);else throw new Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){const r=i5(e);this.ensureBufferSizeToWrite(5+r),this.writeStringHeader(r),u5(e,this.bytes,this.pos),this.pos+=r}encodeObject(e,n){const r=this.extensionCodec.tryToEncode(e,this.context);if(r!=null)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,n);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if(typeof e=="object")this.encodeMap(e,n);else throw new Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){const n=e.byteLength;if(n<256)this.writeU8(196),this.writeU8(n);else if(n<65536)this.writeU8(197),this.writeU16(n);else if(n<4294967296)this.writeU8(198),this.writeU32(n);else throw new Error(`Too large binary: ${n}`);const r=Pf(e);this.writeU8a(r)}encodeArray(e,n){const r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<4294967296)this.writeU8(221),this.writeU32(r);else throw new Error(`Too large array: ${r}`);for(const s of e)this.doEncode(s,n+1)}countWithoutUndefined(e,n){let r=0;for(const s of n)e[s]!==void 0&&r++;return r}encodeMap(e,n){const r=Object.keys(e);this.sortKeys&&r.sort();const s=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(s<16)this.writeU8(128+s);else if(s<65536)this.writeU8(222),this.writeU16(s);else if(s<4294967296)this.writeU8(223),this.writeU32(s);else throw new Error(`Too large map object: ${s}`);for(const i of r){const o=e[i];this.ignoreUndefined&&o===void 0||(this.encodeString(i),this.doEncode(o,n+1))}}encodeExtension(e){if(typeof e.data=="function"){const r=e.data(this.pos+6),s=r.length;if(s>=4294967296)throw new Error(`Too large extension object: ${s}`);this.writeU8(201),this.writeU32(s),this.writeI8(e.type),this.writeU8a(r);return}const n=e.data.length;if(n===1)this.writeU8(212);else if(n===2)this.writeU8(213);else if(n===4)this.writeU8(214);else if(n===8)this.writeU8(215);else if(n===16)this.writeU8(216);else if(n<256)this.writeU8(199),this.writeU8(n);else if(n<65536)this.writeU8(200),this.writeU16(n);else if(n<4294967296)this.writeU8(201),this.writeU32(n);else throw new Error(`Too large extension object: ${n}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){const n=e.length;this.ensureBufferSizeToWrite(n),this.bytes.set(e,this.pos),this.pos+=n}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){this.ensureBufferSizeToWrite(8),m5(this.view,this.pos,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),Xv(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}};function O5(t,e){return new P5(e).encodeSharedRef(t)}function lh(t){return`${t<0?"-":""}0x${Math.abs(t).toString(16).padStart(2,"0")}`}const R5=16,D5=16;class $5{constructor(e=R5,n=D5){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=n,this.caches=[];for(let r=0;r<this.maxKeyLength;r++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,n,r){const s=this.caches[r-1];e:for(const i of s){const o=i.bytes;for(let a=0;a<r;a++)if(o[a]!==e[n+a])continue e;return i.str}return null}store(e,n){const r=this.caches[e.length-1],s={bytes:e,str:n};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=s:r.push(s)}decode(e,n,r){const s=this.find(e,n,r);if(s!=null)return this.hit++,s;this.miss++;const i=Jv(e,n,r),o=Uint8Array.prototype.slice.call(e,n,n+r);return this.store(o,i),i}}const Of="array",Ba="map_key",tE="map_value",k5=t=>{if(typeof t=="string"||typeof t=="number")return t;throw new Tn("The type of key must be string or number but "+typeof t)};class U5{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){const n=this.getUninitializedStateFromPool();n.type=Of,n.position=0,n.size=e,n.array=new Array(e)}pushMapState(e){const n=this.getUninitializedStateFromPool();n.type=Ba,n.readCount=0,n.size=e,n.map={}}getUninitializedStateFromPool(){if(this.stackHeadPosition++,this.stackHeadPosition===this.stack.length){const e={type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null};this.stack.push(e)}return this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw new Error("Invalid stack state. Released state is not on top of the stack.");if(e.type===Of){const r=e;r.size=0,r.array=void 0,r.position=0,r.type=void 0}if(e.type===Ba||e.type===tE){const r=e;r.size=0,r.map=void 0,r.readCount=0,r.type=void 0}this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const ma=-1,Qp=new DataView(new ArrayBuffer(0)),L5=new Uint8Array(Qp.buffer);try{Qp.getInt8(0)}catch(t){if(!(t instanceof RangeError))throw new Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const l0=new RangeError("Insufficient data"),M5=new $5;let B5=class nE{constructor(e){this.totalPos=0,this.pos=0,this.view=Qp,this.bytes=L5,this.headByte=ma,this.stack=new U5,this.entered=!1,this.extensionCodec=(e==null?void 0:e.extensionCodec)??Iu.defaultCodec,this.context=e==null?void 0:e.context,this.useBigInt64=(e==null?void 0:e.useBigInt64)??!1,this.rawStrings=(e==null?void 0:e.rawStrings)??!1,this.maxStrLength=(e==null?void 0:e.maxStrLength)??ga,this.maxBinLength=(e==null?void 0:e.maxBinLength)??ga,this.maxArrayLength=(e==null?void 0:e.maxArrayLength)??ga,this.maxMapLength=(e==null?void 0:e.maxMapLength)??ga,this.maxExtLength=(e==null?void 0:e.maxExtLength)??ga,this.keyDecoder=(e==null?void 0:e.keyDecoder)!==void 0?e.keyDecoder:M5,this.mapKeyConverter=(e==null?void 0:e.mapKeyConverter)??k5}clone(){return new nE({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=ma,this.stack.reset()}setBuffer(e){const n=Pf(e);this.bytes=n,this.view=new DataView(n.buffer,n.byteOffset,n.byteLength),this.pos=0}appendBuffer(e){if(this.headByte===ma&&!this.hasRemaining(1))this.setBuffer(e);else{const n=this.bytes.subarray(this.pos),r=Pf(e),s=new Uint8Array(n.length+r.length);s.set(n),s.set(r,n.length),this.setBuffer(s)}}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){const{view:n,pos:r}=this;return new RangeError(`Extra ${n.byteLength-r} of ${n.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);const n=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return n}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){yield*this.clone().decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{this.entered=!0;let n=!1,r;for await(const a of e){if(n)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(a);try{r=this.doDecodeSync(),n=!0}catch(c){if(!(c instanceof RangeError))throw c}this.totalPos+=this.pos}if(n){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return r}const{headByte:s,pos:i,totalPos:o}=this;throw new RangeError(`Insufficient data in parsing ${lh(s)} at ${o} (${i} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async*decodeMultiAsync(e,n){if(this.entered){yield*this.clone().decodeMultiAsync(e,n);return}try{this.entered=!0;let r=n,s=-1;for await(const i of e){if(n&&s===0)throw this.createExtraByteError(this.totalPos);this.appendBuffer(i),r&&(s=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),--s!==0;);}catch(o){if(!(o instanceof RangeError))throw o}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){e:for(;;){const e=this.readHeadByte();let n;if(e>=224)n=e-256;else if(e<192)if(e<128)n=e;else if(e<144){const s=e-128;if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e<160){const s=e-144;if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else{const s=e-160;n=this.decodeString(s,0)}else if(e===192)n=null;else if(e===194)n=!1;else if(e===195)n=!0;else if(e===202)n=this.readF32();else if(e===203)n=this.readF64();else if(e===204)n=this.readU8();else if(e===205)n=this.readU16();else if(e===206)n=this.readU32();else if(e===207)this.useBigInt64?n=this.readU64AsBigInt():n=this.readU64();else if(e===208)n=this.readI8();else if(e===209)n=this.readI16();else if(e===210)n=this.readI32();else if(e===211)this.useBigInt64?n=this.readI64AsBigInt():n=this.readI64();else if(e===217){const s=this.lookU8();n=this.decodeString(s,1)}else if(e===218){const s=this.lookU16();n=this.decodeString(s,2)}else if(e===219){const s=this.lookU32();n=this.decodeString(s,4)}else if(e===220){const s=this.readU16();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===221){const s=this.readU32();if(s!==0){this.pushArrayState(s),this.complete();continue e}else n=[]}else if(e===222){const s=this.readU16();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===223){const s=this.readU32();if(s!==0){this.pushMapState(s),this.complete();continue e}else n={}}else if(e===196){const s=this.lookU8();n=this.decodeBinary(s,1)}else if(e===197){const s=this.lookU16();n=this.decodeBinary(s,2)}else if(e===198){const s=this.lookU32();n=this.decodeBinary(s,4)}else if(e===212)n=this.decodeExtension(1,0);else if(e===213)n=this.decodeExtension(2,0);else if(e===214)n=this.decodeExtension(4,0);else if(e===215)n=this.decodeExtension(8,0);else if(e===216)n=this.decodeExtension(16,0);else if(e===199){const s=this.lookU8();n=this.decodeExtension(s,1)}else if(e===200){const s=this.lookU16();n=this.decodeExtension(s,2)}else if(e===201){const s=this.lookU32();n=this.decodeExtension(s,4)}else throw new Tn(`Unrecognized type byte: ${lh(e)}`);this.complete();const r=this.stack;for(;r.length>0;){const s=r.top();if(s.type===Of)if(s.array[s.position]=n,s.position++,s.position===s.size)n=s.array,r.release(s);else continue e;else if(s.type===Ba){if(n==="__proto__")throw new Tn("The key __proto__ is not allowed");s.key=this.mapKeyConverter(n),s.type=tE;continue e}else if(s.map[s.key]=n,s.readCount++,s.readCount===s.size)n=s.map,r.release(s);else{s.key=null,s.type=Ba;continue e}}return n}}readHeadByte(){return this.headByte===ma&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=ma}readArraySize(){const e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:{if(e<160)return e-144;throw new Tn(`Unrecognized array type byte: ${lh(e)}`)}}}pushMapState(e){if(e>this.maxMapLength)throw new Tn(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new Tn(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,n){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,n):this.decodeBinary(e,n)}decodeUtf8String(e,n){var i;if(e>this.maxStrLength)throw new Tn(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+n+e)throw l0;const r=this.pos+n;let s;return this.stateIsMapKey()&&((i=this.keyDecoder)!=null&&i.canBeCached(e))?s=this.keyDecoder.decode(this.bytes,r,e):s=g5(this.bytes,r,e),this.pos+=n+e,s}stateIsMapKey(){return this.stack.length>0?this.stack.top().type===Ba:!1}decodeBinary(e,n){if(e>this.maxBinLength)throw new Tn(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+n))throw l0;const r=this.pos+n,s=this.bytes.subarray(r,r+e);return this.pos+=n+e,s}decodeExtension(e,n){if(e>this.maxExtLength)throw new Tn(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);const r=this.view.getInt8(this.pos+n),s=this.decodeBinary(e,n+1);return this.extensionCodec.decode(s,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){const e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){const e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){const e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){const e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){const e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){const e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){const e=y5(this.view,this.pos);return this.pos+=8,e}readI64(){const e=Qv(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){const e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){const e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){const e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){const e=this.view.getFloat64(this.pos);return this.pos+=8,e}};function F5(t,e){return new B5(e).decode(t)}function eg(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function rE(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?eg(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Fa(t,e){e||(e=t.reduce((s,i)=>s+i.length,0));const n=rE(e);let r=0;for(const s of t)n.set(s,r),r+=s.length;return eg(n)}function j5(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,b=p.length;v!==b&&p[v]===0;)v++,g++;for(var y=(b-v)*u+1>>>0,N=new Uint8Array(y);v!==b;){for(var _=p[v],T=0,x=y-1;(_!==0||T<m)&&x!==-1;x--,T++)_+=256*N[x]>>>0,N[x]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");m=T,v++}for(var D=y-m;D!==y&&N[D]===0;)D++;for(var I=c.repeat(g);D<y;++D)I+=t.charAt(N[D]);return I}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===c;)m++,g++;for(var b=(p.length-g)*l+1>>>0,y=new Uint8Array(b);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var _=0,T=b-1;(N!==0||_<v)&&T!==-1;T--,_++)N+=a*y[T]>>>0,y[T]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");v=_,g++}if(p[g]!==" "){for(var x=b-v;x!==b&&y[x]===0;)x++;for(var D=new Uint8Array(m+(b-x)),I=m;x!==b;)D[I++]=y[x++];return D}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var H5=j5,q5=H5;const z5=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},W5=t=>new TextEncoder().encode(t),V5=t=>new TextDecoder().decode(t);class G5{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class K5{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return sE(this,e)}}class Y5{constructor(e){this.decoders=e}or(e){return sE(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const sE=(t,e)=>new Y5({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Z5{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new G5(e,n,r),this.decoder=new K5(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const hd=({name:t,prefix:e,encode:n,decode:r})=>new Z5(t,e,n,r),il=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=q5(n,e);return hd({prefix:t,name:e,encode:r,decode:i=>z5(s(i))})},J5=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},X5=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},Ht=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>hd({prefix:e,name:t,encode(s){return X5(s,r,n)},decode(s){return J5(s,r,n,t)}}),Q5=hd({prefix:"\0",name:"identity",encode:t=>V5(t),decode:t=>W5(t)}),e6=Object.freeze(Object.defineProperty({__proto__:null,identity:Q5},Symbol.toStringTag,{value:"Module"})),t6=Ht({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),n6=Object.freeze(Object.defineProperty({__proto__:null,base2:t6},Symbol.toStringTag,{value:"Module"})),r6=Ht({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),s6=Object.freeze(Object.defineProperty({__proto__:null,base8:r6},Symbol.toStringTag,{value:"Module"})),i6=il({prefix:"9",name:"base10",alphabet:"0123456789"}),o6=Object.freeze(Object.defineProperty({__proto__:null,base10:i6},Symbol.toStringTag,{value:"Module"})),a6=Ht({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),c6=Ht({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),l6=Object.freeze(Object.defineProperty({__proto__:null,base16:a6,base16upper:c6},Symbol.toStringTag,{value:"Module"})),u6=Ht({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),d6=Ht({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),h6=Ht({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),f6=Ht({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),p6=Ht({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),g6=Ht({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),m6=Ht({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),y6=Ht({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),w6=Ht({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),b6=Object.freeze(Object.defineProperty({__proto__:null,base32:u6,base32hex:p6,base32hexpad:m6,base32hexpadupper:y6,base32hexupper:g6,base32pad:h6,base32padupper:f6,base32upper:d6,base32z:w6},Symbol.toStringTag,{value:"Module"})),v6=il({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),E6=il({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),C6=Object.freeze(Object.defineProperty({__proto__:null,base36:v6,base36upper:E6},Symbol.toStringTag,{value:"Module"})),_6=il({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),A6=il({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),I6=Object.freeze(Object.defineProperty({__proto__:null,base58btc:_6,base58flickr:A6},Symbol.toStringTag,{value:"Module"})),S6=Ht({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),N6=Ht({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),x6=Ht({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),T6=Ht({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),P6=Object.freeze(Object.defineProperty({__proto__:null,base64:S6,base64pad:N6,base64url:x6,base64urlpad:T6},Symbol.toStringTag,{value:"Module"})),iE=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),O6=iE.reduce((t,e,n)=>(t[n]=e,t),[]),R6=iE.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function D6(t){return t.reduce((e,n)=>(e+=O6[n],e),"")}function $6(t){const e=[];for(const n of t){const r=R6[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const k6=hd({prefix:"🚀",name:"base256emoji",encode:D6,decode:$6}),U6=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:k6},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const u0={...e6,...n6,...s6,...o6,...l6,...b6,...C6,...I6,...P6,...U6};function oE(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const d0=oE("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),uh=oE("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=rE(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),aE={utf8:d0,"utf-8":d0,hex:u0.base16,latin1:uh,ascii:uh,binary:uh,...u0};function Vn(t,e="utf8"){const n=aE[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?eg(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}function Cn(t,e="utf8"){const n=aE[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):n.encoder.encode(t).substring(1)}const L6={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}},M6="Input must be an string, Buffer or Uint8Array";function B6(t){let e;if(t instanceof Uint8Array)e=t;else if(typeof t=="string")e=new TextEncoder().encode(t);else throw new Error(M6);return e}function F6(t){return Array.prototype.map.call(t,function(e){return(e<16?"0":"")+e.toString(16)}).join("")}function Tl(t){return(4294967296+t).toString(16).substring(1)}function j6(t,e,n){let r=`
`+t+" = ";for(let s=0;s<e.length;s+=2){if(n===32)r+=Tl(e[s]).toUpperCase(),r+=" ",r+=Tl(e[s+1]).toUpperCase();else if(n===64)r+=Tl(e[s+1]).toUpperCase(),r+=Tl(e[s]).toUpperCase();else throw new Error("Invalid size "+n);s%6===4?r+=`
`+new Array(t.length+4).join(" "):s<e.length-2&&(r+=" ")}console.log(r)}function H6(t,e,n){let r=new Date().getTime();const s=new Uint8Array(e);for(let o=0;o<e;o++)s[o]=o%256;const i=new Date().getTime();console.log("Generated random input in "+(i-r)+"ms"),r=i;for(let o=0;o<n;o++){const a=t(s),c=new Date().getTime(),l=c-r;r=c,console.log("Hashed in "+l+"ms: "+a.substring(0,20)+"..."),console.log(Math.round(e/(1<<20)/(l/1e3)*100)/100+" MB PER SECOND")}}var cE={normalizeInput:B6,toHex:F6,debugPrint:j6,testSpeed:H6};const Ql=cE;function Pl(t,e,n){const r=t[e]+t[n];let s=t[e+1]+t[n+1];r>=4294967296&&s++,t[e]=r,t[e+1]=s}function h0(t,e,n,r){let s=t[e]+n;n<0&&(s+=4294967296);let i=t[e+1]+r;s>=4294967296&&i++,t[e]=s,t[e+1]=i}function lE(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function vs(t,e,n,r,s,i){const o=Pa[s],a=Pa[s+1],c=Pa[i],l=Pa[i+1];Pl(Ce,t,e),h0(Ce,t,o,a);let u=Ce[r]^Ce[t],d=Ce[r+1]^Ce[t+1];Ce[r]=d,Ce[r+1]=u,Pl(Ce,n,r),u=Ce[e]^Ce[n],d=Ce[e+1]^Ce[n+1],Ce[e]=u>>>24^d<<8,Ce[e+1]=d>>>24^u<<8,Pl(Ce,t,e),h0(Ce,t,c,l),u=Ce[r]^Ce[t],d=Ce[r+1]^Ce[t+1],Ce[r]=u>>>16^d<<16,Ce[r+1]=d>>>16^u<<16,Pl(Ce,n,r),u=Ce[e]^Ce[n],d=Ce[e+1]^Ce[n+1],Ce[e]=d>>>31^u<<1,Ce[e+1]=u>>>31^d<<1}const uE=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),q6=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3],Vt=new Uint8Array(q6.map(function(t){return t*2})),Ce=new Uint32Array(32),Pa=new Uint32Array(32);function dE(t,e){let n=0;for(n=0;n<16;n++)Ce[n]=t.h[n],Ce[n+16]=uE[n];for(Ce[24]=Ce[24]^t.t,Ce[25]=Ce[25]^t.t/4294967296,e&&(Ce[28]=~Ce[28],Ce[29]=~Ce[29]),n=0;n<32;n++)Pa[n]=lE(t.b,4*n);for(n=0;n<12;n++)vs(0,8,16,24,Vt[n*16+0],Vt[n*16+1]),vs(2,10,18,26,Vt[n*16+2],Vt[n*16+3]),vs(4,12,20,28,Vt[n*16+4],Vt[n*16+5]),vs(6,14,22,30,Vt[n*16+6],Vt[n*16+7]),vs(0,10,20,30,Vt[n*16+8],Vt[n*16+9]),vs(2,12,22,24,Vt[n*16+10],Vt[n*16+11]),vs(4,14,16,26,Vt[n*16+12],Vt[n*16+13]),vs(6,8,18,28,Vt[n*16+14],Vt[n*16+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^Ce[n]^Ce[n+16]}const Es=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function hE(t,e,n,r){if(t===0||t>64)throw new Error("Illegal output length, expected 0 < length <= 64");if(e&&e.length>64)throw new Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(n&&n.length!==16)throw new Error("Illegal salt, expected Uint8Array with length is 16");if(r&&r.length!==16)throw new Error("Illegal personal, expected Uint8Array with length is 16");const s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:t};Es.fill(0),Es[0]=t,e&&(Es[1]=e.length),Es[2]=1,Es[3]=1,n&&Es.set(n,32),r&&Es.set(r,48);for(let i=0;i<16;i++)s.h[i]=uE[i]^lE(Es,i*4);return e&&(tg(s,e),s.c=128),s}function tg(t,e){for(let n=0;n<e.length;n++)t.c===128&&(t.t+=t.c,dE(t,!1),t.c=0),t.b[t.c++]=e[n]}function fE(t){for(t.t+=t.c;t.c<128;)t.b[t.c++]=0;dE(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3);return e}function pE(t,e,n,r,s){n=n||64,t=Ql.normalizeInput(t),r&&(r=Ql.normalizeInput(r)),s&&(s=Ql.normalizeInput(s));const i=hE(n,e,r,s);return tg(i,t),fE(i)}function z6(t,e,n,r,s){const i=pE(t,e,n,r,s);return Ql.toHex(i)}var W6={blake2b:pE,blake2bHex:z6,blake2bInit:hE,blake2bUpdate:tg,blake2bFinal:fE};const gE=cE;function V6(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function Cs(t,e,n,r,s,i){Le[t]=Le[t]+Le[e]+s,Le[r]=Ol(Le[r]^Le[t],16),Le[n]=Le[n]+Le[r],Le[e]=Ol(Le[e]^Le[n],12),Le[t]=Le[t]+Le[e]+i,Le[r]=Ol(Le[r]^Le[t],8),Le[n]=Le[n]+Le[r],Le[e]=Ol(Le[e]^Le[n],7)}function Ol(t,e){return t>>>e^t<<32-e}const mE=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Gt=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),Le=new Uint32Array(16),Dt=new Uint32Array(16);function yE(t,e){let n=0;for(n=0;n<8;n++)Le[n]=t.h[n],Le[n+8]=mE[n];for(Le[12]^=t.t,Le[13]^=t.t/4294967296,e&&(Le[14]=~Le[14]),n=0;n<16;n++)Dt[n]=V6(t.b,4*n);for(n=0;n<10;n++)Cs(0,4,8,12,Dt[Gt[n*16+0]],Dt[Gt[n*16+1]]),Cs(1,5,9,13,Dt[Gt[n*16+2]],Dt[Gt[n*16+3]]),Cs(2,6,10,14,Dt[Gt[n*16+4]],Dt[Gt[n*16+5]]),Cs(3,7,11,15,Dt[Gt[n*16+6]],Dt[Gt[n*16+7]]),Cs(0,5,10,15,Dt[Gt[n*16+8]],Dt[Gt[n*16+9]]),Cs(1,6,11,12,Dt[Gt[n*16+10]],Dt[Gt[n*16+11]]),Cs(2,7,8,13,Dt[Gt[n*16+12]],Dt[Gt[n*16+13]]),Cs(3,4,9,14,Dt[Gt[n*16+14]],Dt[Gt[n*16+15]]);for(n=0;n<8;n++)t.h[n]^=Le[n]^Le[n+8]}function wE(t,e){if(!(t>0&&t<=32))throw new Error("Incorrect output length, should be in [1, 32]");const n=e?e.length:0;if(e&&!(n>0&&n<=32))throw new Error("Incorrect key length, should be in [1, 32]");const r={h:new Uint32Array(mE),b:new Uint8Array(64),c:0,t:0,outlen:t};return r.h[0]^=16842752^n<<8^t,n>0&&(ng(r,e),r.c=64),r}function ng(t,e){for(let n=0;n<e.length;n++)t.c===64&&(t.t+=t.c,yE(t,!1),t.c=0),t.b[t.c++]=e[n]}function bE(t){for(t.t+=t.c;t.c<64;)t.b[t.c++]=0;yE(t,!0);const e=new Uint8Array(t.outlen);for(let n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(n&3)&255;return e}function vE(t,e,n){n=n||32,t=gE.normalizeInput(t);const r=wE(n,e);return ng(r,t),bE(r)}function G6(t,e,n){const r=vE(t,e,n);return gE.toHex(r)}var K6={blake2s:vE,blake2sHex:G6,blake2sInit:wE,blake2sUpdate:ng,blake2sFinal:bE};const ya=W6,wa=K6;var Y6={blake2b:ya.blake2b,blake2bHex:ya.blake2bHex,blake2bInit:ya.blake2bInit,blake2bUpdate:ya.blake2bUpdate,blake2bFinal:ya.blake2bFinal,blake2s:wa.blake2s,blake2sHex:wa.blake2sHex,blake2sInit:wa.blake2sInit,blake2sUpdate:wa.blake2sUpdate,blake2sFinal:wa.blake2sFinal},Z6={};const J6=":";function xo(t){const[e,n]=t.split(J6);return{namespace:e,reference:n}}function EE(t,e){return t.includes(":")?[t]:e.chains||[]}var X6=Object.defineProperty,Q6=Object.defineProperties,e8=Object.getOwnPropertyDescriptors,f0=Object.getOwnPropertySymbols,t8=Object.prototype.hasOwnProperty,n8=Object.prototype.propertyIsEnumerable,p0=(t,e,n)=>e in t?X6(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,g0=(t,e)=>{for(var n in e||(e={}))t8.call(e,n)&&p0(t,n,e[n]);if(f0)for(var n of f0(e))n8.call(e,n)&&p0(t,n,e[n]);return t},r8=(t,e)=>Q6(t,e8(e));const s8="ReactNative",Dn={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},i8="js";function Su(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function ni(){return!ki()&&!!Jp()&&navigator.product===s8}function o8(){return ni()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="android"}function a8(){return ni()&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"&&(global==null?void 0:global.Platform.OS)==="ios"}function ea(){return!Su()&&!!Jp()&&!!ki()}function ol(){return ni()?Dn.reactNative:Su()?Dn.node:ea()?Dn.browser:Dn.unknown}function m0(){var t;try{return ni()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(t=global.Application)==null?void 0:t.applicationId:void 0}catch{return}}function c8(t,e){const n=new URLSearchParams(t);for(const r of Object.keys(e).sort())if(e.hasOwnProperty(r)){const s=e[r];s!==void 0&&n.set(r,s)}return n.toString()}function l8(t){var e,n;const r=CE();try{return t!=null&&t.url&&r.url&&new URL(t.url).host!==new URL(r.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${t.url} differs from the actual page url:${r.url}. This is probably unintended and can lead to issues.`),t.url=r.url),(e=t==null?void 0:t.icons)!=null&&e.length&&t.icons.length>0&&(t.icons=t.icons.filter(s=>s!=="")),r8(g0(g0({},r),t),{url:(t==null?void 0:t.url)||r.url,name:(t==null?void 0:t.name)||r.name,description:(t==null?void 0:t.description)||r.description,icons:(n=t==null?void 0:t.icons)!=null&&n.length&&t.icons.length>0?t.icons:r.icons})}catch(s){return console.warn("Error populating app metadata",s),t||r}}function CE(){return Hv()||{name:"",description:"",url:"",icons:[""]}}function u8(){if(ol()===Dn.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:n,Version:r}=global.Platform;return[n,r].join("-")}const t=CR();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function d8(){var t;const e=ol();return e===Dn.browser?[e,((t=jv())==null?void 0:t.host)||"unknown"].join(":"):e}function _E(t,e,n){const r=u8(),s=d8();return[[t,e].join("-"),[i8,n].join("-"),r,s].join("/")}function h8({protocol:t,version:e,relayUrl:n,sdkVersion:r,auth:s,projectId:i,useOnCloseEvent:o,bundleId:a,packageName:c}){const l=n.split("?"),u=_E(t,e,r),d={auth:s,ua:u,projectId:i,useOnCloseEvent:o,packageName:c||void 0,bundleId:a||void 0},h=c8(l[1]||"",d);return l[0]+"?"+h}function bi(t,e){return t.filter(n=>e.includes(n)).length===t.length}function Rf(t){return Object.fromEntries(t.entries())}function Df(t){return new Map(Object.entries(t))}function hi(t=Y.FIVE_MINUTES,e){const n=Y.toMiliseconds(t||Y.FIVE_MINUTES);let r,s,i,o;return{resolve:a=>{i&&r&&(clearTimeout(i),r(a),o=Promise.resolve(a))},reject:a=>{i&&s&&(clearTimeout(i),s(a))},done:()=>new Promise((a,c)=>{if(o)return a(o);i=setTimeout(()=>{const l=new Error(e);o=Promise.reject(l),c(l)},n),r=a,s=c})}}function Ls(t,e,n){return new Promise(async(r,s)=>{const i=setTimeout(()=>s(new Error(n)),e);try{const o=await t;r(o)}catch(o){s(o)}clearTimeout(i)})}function AE(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function f8(t){return AE("topic",t)}function p8(t){return AE("id",t)}function IE(t){const[e,n]=t.split(":"),r={id:void 0,topic:void 0};if(e==="topic"&&typeof n=="string")r.topic=n;else if(e==="id"&&Number.isInteger(Number(n)))r.id=Number(n);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${n}`);return r}function vt(t,e){return Y.fromMiliseconds(Date.now()+Y.toMiliseconds(t))}function Ts(t){return Date.now()>=Y.toMiliseconds(t)}function ze(t,e){return`${t}${e?`:${e}`:""}`}function $r(t=[],e=[]){return[...new Set([...t,...e])]}async function g8({id:t,topic:e,wcDeepLink:n}){var r;try{if(!n)return;const s=typeof n=="string"?JSON.parse(n):n,i=s==null?void 0:s.href;if(typeof i!="string")return;const o=m8(i,t,e),a=ol();if(a===Dn.browser){if(!((r=ki())!=null&&r.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}y8(o)}else a===Dn.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(o)}catch(s){console.error(s)}}function m8(t,e,n){const r=`requestId=${e}&sessionTopic=${n}`;t.endsWith("/")&&(t=t.slice(0,-1));let s=`${t}`;if(t.startsWith("https://t.me")){const i=t.includes("?")?"&startapp=":"?startapp=";s=`${s}${i}${E8(r,!0)}`}else s=`${s}/wc?${r}`;return s}function y8(t){let e="_self";v8()?e="_top":(b8()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function w8(t,e){let n="";try{if(ea()&&(n=localStorage.getItem(e),n))return n;n=await t.getItem(e)}catch(r){console.error(r)}return n}function y0(t,e){if(!t.includes(e))return null;const n=t.split(/([&,?,=])/),r=n.indexOf(e);return n[r+2]}function w0(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function rg(){return typeof process<"u"&&Z6.IS_VITEST==="true"}function b8(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function v8(){try{return window.self!==window.top}catch{return!1}}function E8(t,e=!1){const n=Buffer.from(t).toString("base64");return e?n.replace(/[=]/g,""):n}function SE(t){return Buffer.from(t,"base64").toString("utf-8")}function C8(t){return new Promise(e=>setTimeout(e,t))}const Rl=BigInt(2**32-1),b0=BigInt(32);function NE(t,e=!1){return e?{h:Number(t&Rl),l:Number(t>>b0&Rl)}:{h:Number(t>>b0&Rl)|0,l:Number(t&Rl)|0}}function xE(t,e=!1){const n=t.length;let r=new Uint32Array(n),s=new Uint32Array(n);for(let i=0;i<n;i++){const{h:o,l:a}=NE(t[i],e);[r[i],s[i]]=[o,a]}return[r,s]}const v0=(t,e,n)=>t>>>n,E0=(t,e,n)=>t<<32-n|e>>>n,Ps=(t,e,n)=>t>>>n|e<<32-n,Os=(t,e,n)=>t<<32-n|e>>>n,Oa=(t,e,n)=>t<<64-n|e>>>n-32,Ra=(t,e,n)=>t>>>n-32|e<<64-n,_8=(t,e)=>e,A8=(t,e)=>t,I8=(t,e,n)=>t<<n|e>>>32-n,S8=(t,e,n)=>e<<n|t>>>32-n,N8=(t,e,n)=>e<<n-32|t>>>64-n,x8=(t,e,n)=>t<<n-32|e>>>64-n;function or(t,e,n,r){const s=(e>>>0)+(r>>>0);return{h:t+n+(s/2**32|0)|0,l:s|0}}const sg=(t,e,n)=>(t>>>0)+(e>>>0)+(n>>>0),ig=(t,e,n,r)=>e+n+r+(t/2**32|0)|0,T8=(t,e,n,r)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0),P8=(t,e,n,r,s)=>e+n+r+s+(t/2**32|0)|0,O8=(t,e,n,r,s)=>(t>>>0)+(e>>>0)+(n>>>0)+(r>>>0)+(s>>>0),R8=(t,e,n,r,s,i)=>e+n+r+s+i+(t/2**32|0)|0,ro=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function og(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function us(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function Yn(t,...e){if(!og(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function ag(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.createHasher");us(t.outputLen),us(t.blockLen)}function Zs(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function cg(t,e){Yn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Sc(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Zn(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function dh(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function vr(t,e){return t<<32-e|t>>>e}const TE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function PE(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}const Xr=TE?t=>t:t=>PE(t);function D8(t){for(let e=0;e<t.length;e++)t[e]=PE(t[e]);return t}const Rs=TE?t=>t:D8,OE=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",$8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Nc(t){if(Yn(t),OE)return t.toHex();let e="";for(let n=0;n<t.length;n++)e+=$8[t[n]];return e}const Yr={_0:48,_9:57,A:65,F:70,a:97,f:102};function C0(t){if(t>=Yr._0&&t<=Yr._9)return t-Yr._0;if(t>=Yr.A&&t<=Yr.F)return t-(Yr.A-10);if(t>=Yr.a&&t<=Yr.f)return t-(Yr.a-10)}function lg(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);if(OE)return Uint8Array.fromHex(t);const e=t.length,n=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(n);for(let s=0,i=0;s<n;s++,i+=2){const o=C0(t.charCodeAt(i)),a=C0(t.charCodeAt(i+1));if(o===void 0||a===void 0){const c=t[i]+t[i+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+i)}r[s]=o*16+a}return r}function k8(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function dr(t){return typeof t=="string"&&(t=k8(t)),Yn(t),t}function vi(...t){let e=0;for(let r=0;r<t.length;r++){const s=t[r];Yn(s),e+=s.length}const n=new Uint8Array(e);for(let r=0,s=0;r<t.length;r++){const i=t[r];n.set(i,s),s+=i.length}return n}let fd=class{};function al(t){const e=r=>t().update(dr(r)).digest(),n=t();return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=()=>t(),e}function U8(t){const e=(r,s)=>t(s).update(dr(r)).digest(),n=t({});return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}function ta(t=32){if(ro&&typeof ro.getRandomValues=="function")return ro.getRandomValues(new Uint8Array(t));if(ro&&typeof ro.randomBytes=="function")return Uint8Array.from(ro.randomBytes(t));throw new Error("crypto.getRandomValues must be defined")}const L8=BigInt(0),ba=BigInt(1),M8=BigInt(2),B8=BigInt(7),F8=BigInt(256),j8=BigInt(113),RE=[],DE=[],$E=[];for(let t=0,e=ba,n=1,r=0;t<24;t++){[n,r]=[r,(2*n+3*r)%5],RE.push(2*(5*r+n)),DE.push((t+1)*(t+2)/2%64);let s=L8;for(let i=0;i<7;i++)e=(e<<ba^(e>>B8)*j8)%F8,e&M8&&(s^=ba<<(ba<<BigInt(i))-ba);$E.push(s)}const kE=xE($E,!0),H8=kE[0],q8=kE[1],_0=(t,e,n)=>n>32?N8(t,e,n):I8(t,e,n),A0=(t,e,n)=>n>32?x8(t,e,n):S8(t,e,n);function z8(t,e=24){const n=new Uint32Array(10);for(let r=24-e;r<24;r++){for(let o=0;o<10;o++)n[o]=t[o]^t[o+10]^t[o+20]^t[o+30]^t[o+40];for(let o=0;o<10;o+=2){const a=(o+8)%10,c=(o+2)%10,l=n[c],u=n[c+1],d=_0(l,u,1)^n[a],h=A0(l,u,1)^n[a+1];for(let f=0;f<50;f+=10)t[o+f]^=d,t[o+f+1]^=h}let s=t[2],i=t[3];for(let o=0;o<24;o++){const a=DE[o],c=_0(s,i,a),l=A0(s,i,a),u=RE[o];s=t[u],i=t[u+1],t[u]=c,t[u+1]=l}for(let o=0;o<50;o+=10){for(let a=0;a<10;a++)n[a]=t[o+a];for(let a=0;a<10;a++)t[o+a]^=~n[(a+2)%10]&n[(a+4)%10]}t[0]^=H8[r],t[1]^=q8[r]}Zn(n)}let W8=class UE extends fd{constructor(e,n,r,s=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=n,this.outputLen=r,this.enableXOF=s,this.rounds=i,us(r),!(0<e&&e<200))throw new Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=Sc(this.state)}clone(){return this._cloneInto()}keccak(){Rs(this.state32),z8(this.state32,this.rounds),Rs(this.state32),this.posOut=0,this.pos=0}update(e){Zs(this),e=dr(e),Yn(e);const{blockLen:n,state:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(n-this.pos,s-i);for(let a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===n&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:n,pos:r,blockLen:s}=this;e[r]^=n,n&128&&r===s-1&&this.keccak(),e[s-1]^=128,this.keccak()}writeInto(e){Zs(this,!1),Yn(e),this.finish();const n=this.state,{blockLen:r}=this;for(let s=0,i=e.length;s<i;){this.posOut>=r&&this.keccak();const o=Math.min(r-this.posOut,i-s);e.set(n.subarray(this.posOut,this.posOut+o),s),this.posOut+=o,s+=o}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return us(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(cg(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,Zn(this.state)}_cloneInto(e){const{blockLen:n,suffix:r,outputLen:s,rounds:i,enableXOF:o}=this;return e||(e=new UE(n,r,s,o,i)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=i,e.suffix=r,e.outputLen=s,e.enableXOF=o,e.destroyed=this.destroyed,e}};const V8=(t,e,n)=>al(()=>new W8(e,t,n)),G8=V8(1,136,256/8);function K8(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i),c=r?4:0,l=r?0:4;t.setUint32(e+c,o,r),t.setUint32(e+l,a,r)}function Y8(t,e,n){return t&e^~t&n}function Z8(t,e,n){return t&e^t&n^e&n}let LE=class extends fd{constructor(e,n,r,s){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=n,this.padOffset=r,this.isLE=s,this.buffer=new Uint8Array(e),this.view=dh(this.buffer)}update(e){Zs(this),e=dr(e),Yn(e);const{view:n,buffer:r,blockLen:s}=this,i=e.length;for(let o=0;o<i;){const a=Math.min(s-this.pos,i-o);if(a===s){const c=dh(e);for(;s<=i-o;o+=s)this.process(c,o);continue}r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Zs(this),cg(e,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:i}=this;let{pos:o}=this;n[o++]=128,Zn(this.buffer.subarray(o)),this.padOffset>s-o&&(this.process(r,0),o=0);for(let d=o;d<s;d++)n[d]=0;K8(r,s-8,BigInt(this.length*8),i),this.process(r,0);const a=dh(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let d=0;d<l;d++)a.setUint32(4*d,u[d],i)}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:i,destroyed:o,pos:a}=this;return e.destroyed=o,e.finished=i,e.length=s,e.pos=a,s%n&&e.buffer.set(r),e}clone(){return this._cloneInto()}};const _s=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Kt=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Yt=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),J8=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),As=new Uint32Array(64);let X8=class extends LE{constructor(e=32){super(64,e,8,!1),this.A=_s[0]|0,this.B=_s[1]|0,this.C=_s[2]|0,this.D=_s[3]|0,this.E=_s[4]|0,this.F=_s[5]|0,this.G=_s[6]|0,this.H=_s[7]|0}get(){const{A:e,B:n,C:r,D:s,E:i,F:o,G:a,H:c}=this;return[e,n,r,s,i,o,a,c]}set(e,n,r,s,i,o,a,c){this.A=e|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=i|0,this.F=o|0,this.G=a|0,this.H=c|0}process(e,n){for(let d=0;d<16;d++,n+=4)As[d]=e.getUint32(n,!1);for(let d=16;d<64;d++){const h=As[d-15],f=As[d-2],p=vr(h,7)^vr(h,18)^h>>>3,g=vr(f,17)^vr(f,19)^f>>>10;As[d]=g+As[d-7]+p+As[d-16]|0}let{A:r,B:s,C:i,D:o,E:a,F:c,G:l,H:u}=this;for(let d=0;d<64;d++){const h=vr(a,6)^vr(a,11)^vr(a,25),f=u+h+Y8(a,c,l)+J8[d]+As[d]|0,p=(vr(r,2)^vr(r,13)^vr(r,22))+Z8(r,s,i)|0;u=l,l=c,c=a,a=o+f|0,o=i,i=s,s=r,r=f+p|0}r=r+this.A|0,s=s+this.B|0,i=i+this.C|0,o=o+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(r,s,i,o,a,c,l,u)}roundClean(){Zn(As)}destroy(){this.set(0,0,0,0,0,0,0,0),Zn(this.buffer)}};const ME=xE(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Q8=ME[0],eD=ME[1],Is=new Uint32Array(80),Ss=new Uint32Array(80);let ug=class extends LE{constructor(e=64){super(128,e,16,!1),this.Ah=Yt[0]|0,this.Al=Yt[1]|0,this.Bh=Yt[2]|0,this.Bl=Yt[3]|0,this.Ch=Yt[4]|0,this.Cl=Yt[5]|0,this.Dh=Yt[6]|0,this.Dl=Yt[7]|0,this.Eh=Yt[8]|0,this.El=Yt[9]|0,this.Fh=Yt[10]|0,this.Fl=Yt[11]|0,this.Gh=Yt[12]|0,this.Gl=Yt[13]|0,this.Hh=Yt[14]|0,this.Hl=Yt[15]|0}get(){const{Ah:e,Al:n,Bh:r,Bl:s,Ch:i,Cl:o,Dh:a,Dl:c,Eh:l,El:u,Fh:d,Fl:h,Gh:f,Gl:p,Hh:g,Hl:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.Ah=e|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=i|0,this.Cl=o|0,this.Dh=a|0,this.Dl=c|0,this.Eh=l|0,this.El=u|0,this.Fh=d|0,this.Fl=h|0,this.Gh=f|0,this.Gl=p|0,this.Hh=g|0,this.Hl=m|0}process(e,n){for(let y=0;y<16;y++,n+=4)Is[y]=e.getUint32(n),Ss[y]=e.getUint32(n+=4);for(let y=16;y<80;y++){const N=Is[y-15]|0,_=Ss[y-15]|0,T=Ps(N,_,1)^Ps(N,_,8)^v0(N,_,7),x=Os(N,_,1)^Os(N,_,8)^E0(N,_,7),D=Is[y-2]|0,I=Ss[y-2]|0,U=Ps(D,I,19)^Oa(D,I,61)^v0(D,I,6),R=Os(D,I,19)^Ra(D,I,61)^E0(D,I,6),k=T8(x,R,Ss[y-7],Ss[y-16]),M=P8(k,T,U,Is[y-7],Is[y-16]);Is[y]=M|0,Ss[y]=k|0}let{Ah:r,Al:s,Bh:i,Bl:o,Ch:a,Cl:c,Dh:l,Dl:u,Eh:d,El:h,Fh:f,Fl:p,Gh:g,Gl:m,Hh:v,Hl:b}=this;for(let y=0;y<80;y++){const N=Ps(d,h,14)^Ps(d,h,18)^Oa(d,h,41),_=Os(d,h,14)^Os(d,h,18)^Ra(d,h,41),T=d&f^~d&g,x=h&p^~h&m,D=O8(b,_,x,eD[y],Ss[y]),I=R8(D,v,N,T,Q8[y],Is[y]),U=D|0,R=Ps(r,s,28)^Oa(r,s,34)^Oa(r,s,39),k=Os(r,s,28)^Ra(r,s,34)^Ra(r,s,39),M=r&i^r&a^i&a,F=s&o^s&c^o&c;v=g|0,b=m|0,g=f|0,m=p|0,f=d|0,p=h|0,{h:d,l:h}=or(l|0,u|0,I|0,U|0),l=a|0,u=c|0,a=i|0,c=o|0,i=r|0,o=s|0;const E=sg(U,k,F);r=ig(E,I,R,M),s=E|0}({h:r,l:s}=or(this.Ah|0,this.Al|0,r|0,s|0)),{h:i,l:o}=or(this.Bh|0,this.Bl|0,i|0,o|0),{h:a,l:c}=or(this.Ch|0,this.Cl|0,a|0,c|0),{h:l,l:u}=or(this.Dh|0,this.Dl|0,l|0,u|0),{h:d,l:h}=or(this.Eh|0,this.El|0,d|0,h|0),{h:f,l:p}=or(this.Fh|0,this.Fl|0,f|0,p|0),{h:g,l:m}=or(this.Gh|0,this.Gl|0,g|0,m|0),{h:v,l:b}=or(this.Hh|0,this.Hl|0,v|0,b|0),this.set(r,s,i,o,a,c,l,u,d,h,f,p,g,m,v,b)}roundClean(){Zn(Is,Ss)}destroy(){Zn(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},tD=class extends ug{constructor(){super(48),this.Ah=Kt[0]|0,this.Al=Kt[1]|0,this.Bh=Kt[2]|0,this.Bl=Kt[3]|0,this.Ch=Kt[4]|0,this.Cl=Kt[5]|0,this.Dh=Kt[6]|0,this.Dl=Kt[7]|0,this.Eh=Kt[8]|0,this.El=Kt[9]|0,this.Fh=Kt[10]|0,this.Fl=Kt[11]|0,this.Gh=Kt[12]|0,this.Gl=Kt[13]|0,this.Hh=Kt[14]|0,this.Hl=Kt[15]|0}};const Zt=Uint32Array.from([573645204,4230739756,2673172387,3360449730,596883563,1867755857,2520282905,1497426621,2519219938,2827943907,3193839141,1401305490,721525244,746961066,246885852,2177182882]);let nD=class extends ug{constructor(){super(32),this.Ah=Zt[0]|0,this.Al=Zt[1]|0,this.Bh=Zt[2]|0,this.Bl=Zt[3]|0,this.Ch=Zt[4]|0,this.Cl=Zt[5]|0,this.Dh=Zt[6]|0,this.Dl=Zt[7]|0,this.Eh=Zt[8]|0,this.El=Zt[9]|0,this.Fh=Zt[10]|0,this.Fl=Zt[11]|0,this.Gh=Zt[12]|0,this.Gl=Zt[13]|0,this.Hh=Zt[14]|0,this.Hl=Zt[15]|0}};const pd=al(()=>new X8),rD=al(()=>new ug),sD=al(()=>new tD),iD=al(()=>new nD),oD=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),bt=Uint32Array.from([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ee=new Uint32Array(32);function Ns(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ee[2*t],l=ee[2*t+1],u=ee[2*e],d=ee[2*e+1],h=ee[2*n],f=ee[2*n+1],p=ee[2*r],g=ee[2*r+1],m=sg(c,u,o);l=ig(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:_8(g,p),Dl:A8(g)},{h:f,l:h}=or(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:Ps(d,u,24),Bl:Os(d,u,24)},ee[2*t]=c,ee[2*t+1]=l,ee[2*e]=u,ee[2*e+1]=d,ee[2*n]=h,ee[2*n+1]=f,ee[2*r]=p,ee[2*r+1]=g}function xs(t,e,n,r,s,i){const o=s[i],a=s[i+1];let c=ee[2*t],l=ee[2*t+1],u=ee[2*e],d=ee[2*e+1],h=ee[2*n],f=ee[2*n+1],p=ee[2*r],g=ee[2*r+1],m=sg(c,u,o);l=ig(m,l,d,a),c=m|0,{Dh:g,Dl:p}={Dh:g^l,Dl:p^c},{Dh:g,Dl:p}={Dh:Ps(g,p,16),Dl:Os(g,p,16)},{h:f,l:h}=or(f,h,g,p),{Bh:d,Bl:u}={Bh:d^f,Bl:u^h},{Bh:d,Bl:u}={Bh:Oa(d,u,63),Bl:Ra(d,u,63)},ee[2*t]=c,ee[2*t+1]=l,ee[2*e]=u,ee[2*e+1]=d,ee[2*n]=h,ee[2*n+1]=f,ee[2*r]=p,ee[2*r+1]=g}function aD(t,e={},n,r,s){if(us(n),t<0||t>n)throw new Error("outputLen bigger than keyLen");const{key:i,salt:o,personalization:a}=e;if(i!==void 0&&(i.length<1||i.length>n))throw new Error("key length must be undefined or 1.."+n);if(o!==void 0&&o.length!==r)throw new Error("salt must be undefined or "+r);if(a!==void 0&&a.length!==s)throw new Error("personalization must be undefined or "+s)}class cD extends fd{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,us(e),us(n),this.blockLen=e,this.outputLen=n,this.buffer=new Uint8Array(e),this.buffer32=Sc(this.buffer)}update(e){Zs(this),e=dr(e),Yn(e);const{blockLen:n,buffer:r,buffer32:s}=this,i=e.length,o=e.byteOffset,a=e.buffer;for(let c=0;c<i;){this.pos===n&&(Rs(s),this.compress(s,0,!1),Rs(s),this.pos=0);const l=Math.min(n-this.pos,i-c),u=o+c;if(l===n&&!(u%4)&&c+l<i){const d=new Uint32Array(a,u,Math.floor((i-c)/4));Rs(d);for(let h=0;c+n<i;h+=s.length,c+=n)this.length+=n,this.compress(d,h,!1);Rs(d);continue}r.set(e.subarray(c,c+l),this.pos),this.pos+=l,this.length+=l,c+=l}return this}digestInto(e){Zs(this),cg(e,this);const{pos:n,buffer32:r}=this;this.finished=!0,Zn(this.buffer.subarray(n)),Rs(r),this.compress(r,0,!0),Rs(r);const s=Sc(e);this.get().forEach((i,o)=>s[o]=Xr(i))}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}_cloneInto(e){const{buffer:n,length:r,finished:s,destroyed:i,outputLen:o,pos:a}=this;return e||(e=new this.constructor({dkLen:o})),e.set(...this.get()),e.buffer.set(n),e.destroyed=i,e.finished=s,e.length=r,e.pos=a,e.outputLen=o,e}clone(){return this._cloneInto()}}class lD extends cD{constructor(e={}){const n=e.dkLen===void 0?64:e.dkLen;super(128,n),this.v0l=bt[0]|0,this.v0h=bt[1]|0,this.v1l=bt[2]|0,this.v1h=bt[3]|0,this.v2l=bt[4]|0,this.v2h=bt[5]|0,this.v3l=bt[6]|0,this.v3h=bt[7]|0,this.v4l=bt[8]|0,this.v4h=bt[9]|0,this.v5l=bt[10]|0,this.v5h=bt[11]|0,this.v6l=bt[12]|0,this.v6h=bt[13]|0,this.v7l=bt[14]|0,this.v7h=bt[15]|0,aD(n,e,64,16,16);let{key:r,personalization:s,salt:i}=e,o=0;if(r!==void 0&&(r=dr(r),o=r.length),this.v0l^=this.outputLen|o<<8|65536|1<<24,i!==void 0){i=dr(i);const a=Sc(i);this.v4l^=Xr(a[0]),this.v4h^=Xr(a[1]),this.v5l^=Xr(a[2]),this.v5h^=Xr(a[3])}if(s!==void 0){s=dr(s);const a=Sc(s);this.v6l^=Xr(a[0]),this.v6h^=Xr(a[1]),this.v7l^=Xr(a[2]),this.v7h^=Xr(a[3])}if(r!==void 0){const a=new Uint8Array(this.blockLen);a.set(r),this.update(a)}}get(){let{v0l:e,v0h:n,v1l:r,v1h:s,v2l:i,v2h:o,v3l:a,v3h:c,v4l:l,v4h:u,v5l:d,v5h:h,v6l:f,v6h:p,v7l:g,v7h:m}=this;return[e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m]}set(e,n,r,s,i,o,a,c,l,u,d,h,f,p,g,m){this.v0l=e|0,this.v0h=n|0,this.v1l=r|0,this.v1h=s|0,this.v2l=i|0,this.v2h=o|0,this.v3l=a|0,this.v3h=c|0,this.v4l=l|0,this.v4h=u|0,this.v5l=d|0,this.v5h=h|0,this.v6l=f|0,this.v6h=p|0,this.v7l=g|0,this.v7h=m|0}compress(e,n,r){this.get().forEach((c,l)=>ee[l]=c),ee.set(bt,16);let{h:s,l:i}=NE(BigInt(this.length));ee[24]=bt[8]^i,ee[25]=bt[9]^s,r&&(ee[28]=~ee[28],ee[29]=~ee[29]);let o=0;const a=oD;for(let c=0;c<12;c++)Ns(0,4,8,12,e,n+2*a[o++]),xs(0,4,8,12,e,n+2*a[o++]),Ns(1,5,9,13,e,n+2*a[o++]),xs(1,5,9,13,e,n+2*a[o++]),Ns(2,6,10,14,e,n+2*a[o++]),xs(2,6,10,14,e,n+2*a[o++]),Ns(3,7,11,15,e,n+2*a[o++]),xs(3,7,11,15,e,n+2*a[o++]),Ns(0,5,10,15,e,n+2*a[o++]),xs(0,5,10,15,e,n+2*a[o++]),Ns(1,6,11,12,e,n+2*a[o++]),xs(1,6,11,12,e,n+2*a[o++]),Ns(2,7,8,13,e,n+2*a[o++]),xs(2,7,8,13,e,n+2*a[o++]),Ns(3,4,9,14,e,n+2*a[o++]),xs(3,4,9,14,e,n+2*a[o++]);this.v0l^=ee[0]^ee[16],this.v0h^=ee[1]^ee[17],this.v1l^=ee[2]^ee[18],this.v1h^=ee[3]^ee[19],this.v2l^=ee[4]^ee[20],this.v2h^=ee[5]^ee[21],this.v3l^=ee[6]^ee[22],this.v3h^=ee[7]^ee[23],this.v4l^=ee[8]^ee[24],this.v4h^=ee[9]^ee[25],this.v5l^=ee[10]^ee[26],this.v5h^=ee[11]^ee[27],this.v6l^=ee[12]^ee[28],this.v6h^=ee[13]^ee[29],this.v7l^=ee[14]^ee[30],this.v7h^=ee[15]^ee[31],Zn(ee)}destroy(){this.destroyed=!0,Zn(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const uD=U8(t=>new lD(t)),dD="https://rpc.walletconnect.org/v1";function BE(t){const e=`Ethereum Signed Message:
${t.length}`,n=new TextEncoder().encode(e+t);return"0x"+Buffer.from(G8(n)).toString("hex")}async function hD(t,e,n,r,s,i){switch(n.t){case"eip191":return await fD(t,e,n.s);case"eip1271":return await pD(t,e,n.s,r,s,i);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${n.t}`)}}async function fD(t,e,n){return(await n5({hash:BE(e),signature:n})).toLowerCase()===t.toLowerCase()}async function pD(t,e,n,r,s,i){const o=xo(r);if(!o.namespace||!o.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${r}`);try{const a="0x1626ba7e",c="0000000000000000000000000000000000000000000000000000000000000040",l=n.substring(2),u=(l.length/2).toString(16).padStart(64,"0"),d=(e.startsWith("0x")?e:BE(e)).substring(2),h=a+d+c+u+l,f=await fetch(`${i||dD}/?chainId=${r}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:gD(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:h},"latest"]})}),{result:p}=await f.json();return p?p.slice(0,a.length).toLowerCase()===a.toLowerCase():!1}catch(a){return console.error("isValidEip1271Signature: ",a),!1}}function gD(){return Date.now()+Math.floor(Math.random()*1e3)}function mD(t){const e=atob(t),n=new Uint8Array(e.length);for(let o=0;o<e.length;o++)n[o]=e.charCodeAt(o);const r=n[0];if(r===0)throw new Error("No signatures found");const s=1+r*64;if(n.length<s)throw new Error("Transaction data too short for claimed signature count");if(n.length<100)throw new Error("Transaction too short");const i=Buffer.from(t,"base64").slice(1,65);return Qo.encode(i)}function yD(t){const e=new Uint8Array(Buffer.from(t,"base64")),n=Array.from("TransactionData::").map(i=>i.charCodeAt(0)),r=new Uint8Array(n.length+e.length);r.set(n),r.set(e,n.length);const s=uD(r,{dkLen:32});return Qo.encode(s)}function I0(t){const e=new Uint8Array(pd(wD(t)));return Qo.encode(e)}function wD(t){if(t instanceof Uint8Array)return t;if(Array.isArray(t))return new Uint8Array(t);if(typeof t=="object"&&t!=null&&t.data)return new Uint8Array(Object.values(t.data));if(typeof t=="object"&&t)return new Uint8Array(Object.values(t));throw new Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}function S0(t){const e=Buffer.from(t,"base64"),n=F5(e).txn;if(!n)throw new Error("Invalid signed transaction: missing 'txn' field");const r=O5(n),s=Buffer.from("TX"),i=Buffer.concat([s,Buffer.from(r)]),o=iD(i);return O_.encode(o).replace(/=+$/,"")}function hh(t){const e=[];let n=BigInt(t);for(;n>=BigInt(128);)e.push(Number(n&BigInt(127)|BigInt(128))),n>>=BigInt(7);return e.push(Number(n)),Buffer.from(e)}function bD(t){const e=Buffer.from(t.signed.bodyBytes,"base64"),n=Buffer.from(t.signed.authInfoBytes,"base64"),r=Buffer.from(t.signature.signature,"base64"),s=[];s.push(Buffer.from([10])),s.push(hh(e.length)),s.push(e),s.push(Buffer.from([18])),s.push(hh(n.length)),s.push(n),s.push(Buffer.from([26])),s.push(hh(r.length)),s.push(r);const i=Buffer.concat(s),o=pd(i);return Buffer.from(o).toString("hex").toUpperCase()}var vD=Object.defineProperty,ED=Object.defineProperties,CD=Object.getOwnPropertyDescriptors,N0=Object.getOwnPropertySymbols,_D=Object.prototype.hasOwnProperty,AD=Object.prototype.propertyIsEnumerable,x0=(t,e,n)=>e in t?vD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ID=(t,e)=>{for(var n in e||(e={}))_D.call(e,n)&&x0(t,n,e[n]);if(N0)for(var n of N0(e))AD.call(e,n)&&x0(t,n,e[n]);return t},SD=(t,e)=>ED(t,CD(e));const ND="did:pkh:",dg=t=>t==null?void 0:t.split(":"),xD=t=>{const e=t&&dg(t);if(e)return t.includes(ND)?e[3]:e[1]},$f=t=>{const e=t&&dg(t);if(e)return e[2]+":"+e[3]},Nu=t=>{const e=t&&dg(t);if(e)return e.pop()};async function T0(t){const{cacao:e,projectId:n}=t,{s:r,p:s}=e,i=FE(s,s.iss),o=Nu(s.iss);return await hD(o,i,r,$f(s.iss),n)}const FE=(t,e)=>{const n=`${t.domain} wants you to sign in with your Ethereum account:`,r=Nu(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=t.statement||void 0;const i=`URI: ${t.aud||t.uri}`,o=`Version: ${t.version}`,a=`Chain ID: ${xD(e)}`,c=`Nonce: ${t.nonce}`,l=`Issued At: ${t.iat}`,u=t.exp?`Expiration Time: ${t.exp}`:void 0,d=t.nbf?`Not Before: ${t.nbf}`:void 0,h=t.requestId?`Request ID: ${t.requestId}`:void 0,f=t.resources?`Resources:${t.resources.map(g=>`
- ${g}`).join("")}`:void 0,p=eu(t.resources);if(p){const g=xc(p);s=LD(s,g)}return[n,r,"",s,"",i,o,a,c,l,u,d,h,f].filter(g=>g!=null).join(`
`)};function TD(t){return Buffer.from(JSON.stringify(t)).toString("base64")}function PD(t){return JSON.parse(Buffer.from(t,"base64").toString("utf-8"))}function Ui(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(n=>{const r=t.att[n];if(Array.isArray(r))throw new Error(`Resource must be an object: ${n}`);if(typeof r!="object")throw new Error(`Resource must be an object: ${n}`);if(!Object.keys(r).length)throw new Error(`Resource object is empty: ${n}`);Object.keys(r).forEach(s=>{const i=r[s];if(!Array.isArray(i))throw new Error(`Ability limits ${s} must be an array of objects, found: ${i}`);if(!i.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);i.forEach(o=>{if(typeof o!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${o}`)})})})}function OD(t,e,n,r={}){return n==null||n.sort((s,i)=>s.localeCompare(i)),{att:{[t]:RD(e,n,r)}}}function RD(t,e,n={}){e=e==null?void 0:e.sort((s,i)=>s.localeCompare(i));const r=e.map(s=>({[`${t}/${s}`]:[n]}));return Object.assign({},...r)}function jE(t){return Ui(t),`urn:recap:${TD(t).replace(/=/g,"")}`}function xc(t){const e=PD(t.replace("urn:recap:",""));return Ui(e),e}function DD(t,e,n){const r=OD(t,e,n);return jE(r)}function $D(t){return t&&t.includes("urn:recap:")}function kD(t,e){const n=xc(t),r=xc(e),s=UD(n,r);return jE(s)}function UD(t,e){Ui(t),Ui(e);const n=Object.keys(t.att).concat(Object.keys(e.att)).sort((s,i)=>s.localeCompare(i)),r={att:{}};return n.forEach(s=>{var i,o;Object.keys(((i=t.att)==null?void 0:i[s])||{}).concat(Object.keys(((o=e.att)==null?void 0:o[s])||{})).sort((a,c)=>a.localeCompare(c)).forEach(a=>{var c,l;r.att[s]=SD(ID({},r.att[s]),{[a]:((c=t.att[s])==null?void 0:c[a])||((l=e.att[s])==null?void 0:l[a])})})}),r}function LD(t="",e){Ui(e);const n="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(n))return t;const r=[];let s=0;Object.keys(e.att).forEach(a=>{const c=Object.keys(e.att[a]).map(d=>({ability:d.split("/")[0],action:d.split("/")[1]}));c.sort((d,h)=>d.action.localeCompare(h.action));const l={};c.forEach(d=>{l[d.ability]||(l[d.ability]=[]),l[d.ability].push(d.action)});const u=Object.keys(l).map(d=>(s++,`(${s}) '${d}': '${l[d].join("', '")}' for '${a}'.`));r.push(u.join(", ").replace(".,","."))});const i=r.join(" "),o=`${n}${i}`;return`${t?t+" ":""}${o}`}function P0(t){var e;const n=xc(t);Ui(n);const r=(e=n.att)==null?void 0:e.eip155;return r?Object.keys(r).map(s=>s.split("/")[1]):[]}function O0(t){const e=xc(t);Ui(e);const n=[];return Object.values(e.att).forEach(r=>{Object.values(r).forEach(s=>{var i;(i=s==null?void 0:s[0])!=null&&i.chains&&n.push(s[0].chains)})}),[...new Set(n.flat())]}function eu(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return $D(e)?e:void 0}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */function HE(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function kf(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function fh(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function bn(t,...e){if(!HE(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function R0(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function MD(t,e){bn(t);const n=e.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Hs(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Bo(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function BD(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const FD=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function jD(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function Uf(t){if(typeof t=="string")t=jD(t);else if(HE(t))t=Lf(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function HD(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function qD(t,e){if(t.length!==e.length)return!1;let n=0;for(let r=0;r<t.length;r++)n|=t[r]^e[r];return n===0}const zD=(t,e)=>{function n(r,...s){if(bn(r),!FD)throw new Error("Non little-endian hardware is not yet supported");if(t.nonceLength!==void 0){const l=s[0];if(!l)throw new Error("nonce / iv required");t.varSizeNonce?bn(l):bn(l,t.nonceLength)}const i=t.tagLength;i&&s[1]!==void 0&&bn(s[1]);const o=e(r,...s),a=(l,u)=>{if(u!==void 0){if(l!==2)throw new Error("cipher output not supported");bn(u)}};let c=!1;return{encrypt(l,u){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,bn(l),a(o.encrypt.length,u),o.encrypt(l,u)},decrypt(l,u){if(bn(l),i&&l.length<i)throw new Error("invalid ciphertext length: smaller than tagLength="+i);return a(o.decrypt.length,u),o.decrypt(l,u)}}}return Object.assign(n,t),n};function D0(t,e,n=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(n&&!VD(e))throw new Error("invalid output, must be aligned");return e}function $0(t,e,n,r){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,n,r);const s=BigInt(32),i=BigInt(4294967295),o=Number(n>>s&i),a=Number(n&i);t.setUint32(e+4,o,r),t.setUint32(e+0,a,r)}function WD(t,e,n){kf(n);const r=new Uint8Array(16),s=BD(r);return $0(s,0,BigInt(e),n),$0(s,8,BigInt(t),n),r}function VD(t){return t.byteOffset%4===0}function Lf(t){return Uint8Array.from(t)}const qE=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),GD=qE("expand 16-byte k"),KD=qE("expand 32-byte k"),YD=Hs(GD),ZD=Hs(KD);function ke(t,e){return t<<e|t>>>32-e}function Mf(t){return t.byteOffset%4===0}const Dl=64,JD=16,zE=2**32-1,k0=new Uint32Array;function XD(t,e,n,r,s,i,o,a){const c=s.length,l=new Uint8Array(Dl),u=Hs(l),d=Mf(s)&&Mf(i),h=d?Hs(s):k0,f=d?Hs(i):k0;for(let p=0;p<c;o++){if(t(e,n,r,u,o,a),o>=zE)throw new Error("arx: counter overflow");const g=Math.min(Dl,c-p);if(d&&g===Dl){const m=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let v=0,b;v<JD;v++)b=m+v,f[b]=h[b]^u[v];p+=Dl;continue}for(let m=0,v;m<g;m++)v=p+m,i[v]=s[v]^l[m];p+=g}}function QD(t,e){const{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:i,rounds:o}=HD({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return fh(s),fh(o),kf(i),kf(n),(a,c,l,u,d=0)=>{bn(a),bn(c),bn(l);const h=l.length;if(u===void 0&&(u=new Uint8Array(h)),bn(u),fh(d),d<0||d>=zE)throw new Error("arx: counter overflow");if(u.length<h)throw new Error(`arx: output (${u.length}) is shorter than data (${h})`);const f=[];let p=a.length,g,m;if(p===32)f.push(g=Lf(a)),m=ZD;else if(p===16&&n)g=new Uint8Array(32),g.set(a),g.set(a,16),m=YD,f.push(g);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Mf(c)||f.push(c=Lf(c));const v=Hs(g);if(r){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(m,v,Hs(c.subarray(0,16)),v),c=c.subarray(16)}const b=16-s;if(b!==c.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){const N=new Uint8Array(12);N.set(c,i?0:12-c.length),c=N,f.push(c)}const y=Hs(c);return XD(t,m,v,y,l,u,d,o),Bo(...f),u}}const $t=(t,e)=>t[e++]&255|(t[e++]&255)<<8;class e${constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=Uf(e),bn(e,32);const n=$t(e,0),r=$t(e,2),s=$t(e,4),i=$t(e,6),o=$t(e,8),a=$t(e,10),c=$t(e,12),l=$t(e,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|i<<9)&8191,this.r[4]=(i>>>4|o<<12)&255,this.r[5]=o>>>1&8190,this.r[6]=(o>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=$t(e,16+2*u)}process(e,n,r=!1){const s=r?0:2048,{h:i,r:o}=this,a=o[0],c=o[1],l=o[2],u=o[3],d=o[4],h=o[5],f=o[6],p=o[7],g=o[8],m=o[9],v=$t(e,n+0),b=$t(e,n+2),y=$t(e,n+4),N=$t(e,n+6),_=$t(e,n+8),T=$t(e,n+10),x=$t(e,n+12),D=$t(e,n+14);let I=i[0]+(v&8191),U=i[1]+((v>>>13|b<<3)&8191),R=i[2]+((b>>>10|y<<6)&8191),k=i[3]+((y>>>7|N<<9)&8191),M=i[4]+((N>>>4|_<<12)&8191),F=i[5]+(_>>>1&8191),E=i[6]+((_>>>14|T<<2)&8191),S=i[7]+((T>>>11|x<<5)&8191),O=i[8]+((x>>>8|D<<8)&8191),$=i[9]+(D>>>5|s),C=0,P=C+I*a+U*(5*m)+R*(5*g)+k*(5*p)+M*(5*f);C=P>>>13,P&=8191,P+=F*(5*h)+E*(5*d)+S*(5*u)+O*(5*l)+$*(5*c),C+=P>>>13,P&=8191;let B=C+I*c+U*a+R*(5*m)+k*(5*g)+M*(5*p);C=B>>>13,B&=8191,B+=F*(5*f)+E*(5*h)+S*(5*d)+O*(5*u)+$*(5*l),C+=B>>>13,B&=8191;let H=C+I*l+U*c+R*a+k*(5*m)+M*(5*g);C=H>>>13,H&=8191,H+=F*(5*p)+E*(5*f)+S*(5*h)+O*(5*d)+$*(5*u),C+=H>>>13,H&=8191;let G=C+I*u+U*l+R*c+k*a+M*(5*m);C=G>>>13,G&=8191,G+=F*(5*g)+E*(5*p)+S*(5*f)+O*(5*h)+$*(5*d),C+=G>>>13,G&=8191;let W=C+I*d+U*u+R*l+k*c+M*a;C=W>>>13,W&=8191,W+=F*(5*m)+E*(5*g)+S*(5*p)+O*(5*f)+$*(5*h),C+=W>>>13,W&=8191;let se=C+I*h+U*d+R*u+k*l+M*c;C=se>>>13,se&=8191,se+=F*a+E*(5*m)+S*(5*g)+O*(5*p)+$*(5*f),C+=se>>>13,se&=8191;let ue=C+I*f+U*h+R*d+k*u+M*l;C=ue>>>13,ue&=8191,ue+=F*c+E*a+S*(5*m)+O*(5*g)+$*(5*p),C+=ue>>>13,ue&=8191;let De=C+I*p+U*f+R*h+k*d+M*u;C=De>>>13,De&=8191,De+=F*l+E*c+S*a+O*(5*m)+$*(5*g),C+=De>>>13,De&=8191;let je=C+I*g+U*p+R*f+k*h+M*d;C=je>>>13,je&=8191,je+=F*u+E*l+S*c+O*a+$*(5*m),C+=je>>>13,je&=8191;let xe=C+I*m+U*g+R*p+k*f+M*h;C=xe>>>13,xe&=8191,xe+=F*d+E*u+S*l+O*c+$*a,C+=xe>>>13,xe&=8191,C=(C<<2)+C|0,C=C+P|0,P=C&8191,C=C>>>13,B+=C,i[0]=P,i[1]=B,i[2]=H,i[3]=G,i[4]=W,i[5]=se,i[6]=ue,i[7]=De,i[8]=je,i[9]=xe}finalize(){const{h:e,pad:n}=this,r=new Uint16Array(10);let s=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=s,s=e[a]>>>13,e[a]&=8191;e[0]+=s*5,s=e[0]>>>13,e[0]&=8191,e[1]+=s,s=e[1]>>>13,e[1]&=8191,e[2]+=s,r[0]=e[0]+5,s=r[0]>>>13,r[0]&=8191;for(let a=1;a<10;a++)r[a]=e[a]+s,s=r[a]>>>13,r[a]&=8191;r[9]-=8192;let i=(s^1)-1;for(let a=0;a<10;a++)r[a]&=i;i=~i;for(let a=0;a<10;a++)e[a]=e[a]&i|r[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let o=e[0]+n[0];e[0]=o&65535;for(let a=1;a<8;a++)o=(e[a]+n[a]|0)+(o>>>16)|0,e[a]=o&65535;Bo(r)}update(e){R0(this),e=Uf(e),bn(e);const{buffer:n,blockLen:r}=this,s=e.length;for(let i=0;i<s;){const o=Math.min(r-this.pos,s-i);if(o===r){for(;r<=s-i;i+=r)this.process(e,i);continue}n.set(e.subarray(i,i+o),this.pos),this.pos+=o,i+=o,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){Bo(this.h,this.r,this.buffer,this.pad)}digestInto(e){R0(this),MD(e,this),this.finished=!0;const{buffer:n,h:r}=this;let{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let i=0;for(let o=0;o<8;o++)e[i++]=r[o]>>>0,e[i++]=r[o]>>>8;return e}digest(){const{buffer:e,outputLen:n}=this;this.digestInto(e);const r=e.slice(0,n);return this.destroy(),r}}function t$(t){const e=(r,s)=>t(s).update(Uf(r)).digest(),n=t(new Uint8Array(32));return e.outputLen=n.outputLen,e.blockLen=n.blockLen,e.create=r=>t(r),e}const n$=t$(t=>new e$(t));function r$(t,e,n,r,s,i=20){let o=t[0],a=t[1],c=t[2],l=t[3],u=e[0],d=e[1],h=e[2],f=e[3],p=e[4],g=e[5],m=e[6],v=e[7],b=s,y=n[0],N=n[1],_=n[2],T=o,x=a,D=c,I=l,U=u,R=d,k=h,M=f,F=p,E=g,S=m,O=v,$=b,C=y,P=N,B=_;for(let G=0;G<i;G+=2)T=T+U|0,$=ke($^T,16),F=F+$|0,U=ke(U^F,12),T=T+U|0,$=ke($^T,8),F=F+$|0,U=ke(U^F,7),x=x+R|0,C=ke(C^x,16),E=E+C|0,R=ke(R^E,12),x=x+R|0,C=ke(C^x,8),E=E+C|0,R=ke(R^E,7),D=D+k|0,P=ke(P^D,16),S=S+P|0,k=ke(k^S,12),D=D+k|0,P=ke(P^D,8),S=S+P|0,k=ke(k^S,7),I=I+M|0,B=ke(B^I,16),O=O+B|0,M=ke(M^O,12),I=I+M|0,B=ke(B^I,8),O=O+B|0,M=ke(M^O,7),T=T+R|0,B=ke(B^T,16),S=S+B|0,R=ke(R^S,12),T=T+R|0,B=ke(B^T,8),S=S+B|0,R=ke(R^S,7),x=x+k|0,$=ke($^x,16),O=O+$|0,k=ke(k^O,12),x=x+k|0,$=ke($^x,8),O=O+$|0,k=ke(k^O,7),D=D+M|0,C=ke(C^D,16),F=F+C|0,M=ke(M^F,12),D=D+M|0,C=ke(C^D,8),F=F+C|0,M=ke(M^F,7),I=I+U|0,P=ke(P^I,16),E=E+P|0,U=ke(U^E,12),I=I+U|0,P=ke(P^I,8),E=E+P|0,U=ke(U^E,7);let H=0;r[H++]=o+T|0,r[H++]=a+x|0,r[H++]=c+D|0,r[H++]=l+I|0,r[H++]=u+U|0,r[H++]=d+R|0,r[H++]=h+k|0,r[H++]=f+M|0,r[H++]=p+F|0,r[H++]=g+E|0,r[H++]=m+S|0,r[H++]=v+O|0,r[H++]=b+$|0,r[H++]=y+C|0,r[H++]=N+P|0,r[H++]=_+B|0}const s$=QD(r$,{counterRight:!1,counterLength:4,allowShortKeys:!1}),i$=new Uint8Array(16),U0=(t,e)=>{t.update(e);const n=e.length%16;n&&t.update(i$.subarray(n))},o$=new Uint8Array(32);function L0(t,e,n,r,s){const i=t(e,n,o$),o=n$.create(i);s&&U0(o,s),U0(o,r);const a=WD(r.length,s?s.length:0,!0);o.update(a);const c=o.digest();return Bo(i,a),c}const a$=t=>(e,n,r)=>({encrypt(s,i){const o=s.length;i=D0(o+16,i,!1),i.set(s);const a=i.subarray(0,-16);t(e,n,a,a,1);const c=L0(t,e,n,a,r);return i.set(c,o),Bo(c),i},decrypt(s,i){i=D0(s.length-16,i,!1);const o=s.subarray(0,-16),a=s.subarray(-16),c=L0(t,e,n,o,r);if(!qD(a,c))throw new Error("invalid tag");return i.set(s.subarray(0,-16)),t(e,n,i,i,1),Bo(c),i}}),WE=zD({blockSize:64,nonceLength:12,tagLength:16},a$(s$));let VE=class extends fd{constructor(e,n){super(),this.finished=!1,this.destroyed=!1,ag(e);const r=dr(n);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,i=new Uint8Array(s);i.set(r.length>s?e.create().update(r).digest():r);for(let o=0;o<i.length;o++)i[o]^=54;this.iHash.update(i),this.oHash=e.create();for(let o=0;o<i.length;o++)i[o]^=106;this.oHash.update(i),Zn(i)}update(e){return Zs(this),this.iHash.update(e),this}digestInto(e){Zs(this),Yn(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:i,blockLen:o,outputLen:a}=this;return e=e,e.finished=s,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=n._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const gd=(t,e,n)=>new VE(t,e).update(n).digest();gd.create=(t,e)=>new VE(t,e);function c$(t,e,n){return ag(t),n===void 0&&(n=new Uint8Array(t.outputLen)),gd(t,dr(n),dr(e))}const ph=Uint8Array.from([0]),M0=Uint8Array.of();function l$(t,e,n,r=32){ag(t),us(r);const s=t.outputLen;if(r>255*s)throw new Error("Length should be <= 255*HashLen");const i=Math.ceil(r/s);n===void 0&&(n=M0);const o=new Uint8Array(i*s),a=gd.create(t,e),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<i;u++)ph[0]=u+1,c.update(u===0?M0:l).update(n).update(ph).digestInto(l),o.set(l,s*u),a._cloneInto(c);return a.destroy(),c.destroy(),Zn(l,ph),o.slice(0,r)}const u$=(t,e,n,r,s)=>l$(t,c$(t,e,n),r,s),md=pd,hg=BigInt(0),Bf=BigInt(1);function xu(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}function $l(t){const e=t.toString(16);return e.length&1?"0"+e:e}function GE(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?hg:BigInt("0x"+t)}function yd(t){return GE(Nc(t))}function Tu(t){return Yn(t),GE(Nc(Uint8Array.from(t).reverse()))}function fg(t,e){return lg(t.toString(16).padStart(e*2,"0"))}function pg(t,e){return fg(t,e).reverse()}function wn(t,e,n){let r;if(typeof e=="string")try{r=lg(e)}catch(i){throw new Error(t+" must be hex string or Uint8Array, cause: "+i)}else if(og(e))r=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const s=r.length;if(typeof n=="number"&&s!==n)throw new Error(t+" of length "+n+" expected, got "+s);return r}const gh=t=>typeof t=="bigint"&&hg<=t;function d$(t,e,n){return gh(t)&&gh(e)&&gh(n)&&e<=t&&t<n}function Ff(t,e,n,r){if(!d$(e,n,r))throw new Error("expected valid "+t+": "+n+" <= n < "+r+", got "+e)}function h$(t){let e;for(e=0;t>hg;t>>=Bf,e+=1);return e}const wd=t=>(Bf<<BigInt(t))-Bf;function f$(t,e,n){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof n!="function")throw new Error("hmacFn must be a function");const r=h=>new Uint8Array(h),s=h=>Uint8Array.of(h);let i=r(t),o=r(t),a=0;const c=()=>{i.fill(1),o.fill(0),a=0},l=(...h)=>n(o,i,...h),u=(h=r(0))=>{o=l(s(0),h),i=l(),h.length!==0&&(o=l(s(1),h),i=l())},d=()=>{if(a++>=1e3)throw new Error("drbg: tried 1000 values");let h=0;const f=[];for(;h<e;){i=l();const p=i.slice();f.push(p),h+=i.length}return vi(...f)};return(h,f)=>{c(),u(h);let p;for(;!(p=f(d()));)u();return c(),p}}function bd(t,e,n={}){if(!t||typeof t!="object")throw new Error("expected valid options object");function r(s,i,o){const a=t[s];if(o&&a===void 0)return;const c=typeof a;if(c!==i||a===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${c}`)}Object.entries(e).forEach(([s,i])=>r(s,i,!1)),Object.entries(n).forEach(([s,i])=>r(s,i,!0))}function B0(t){const e=new WeakMap;return(n,...r)=>{const s=e.get(n);if(s!==void 0)return s;const i=t(n,...r);return e.set(n,i),i}}const vn=BigInt(0),rn=BigInt(1),Ei=BigInt(2),p$=BigInt(3),KE=BigInt(4),YE=BigInt(5),ZE=BigInt(8);function zn(t,e){const n=t%e;return n>=vn?n:e+n}function ir(t,e,n){let r=t;for(;e-- >vn;)r*=r,r%=n;return r}function F0(t,e){if(t===vn)throw new Error("invert: expected non-zero number");if(e<=vn)throw new Error("invert: expected positive modulus, got "+e);let n=zn(t,e),r=e,s=vn,i=rn;for(;n!==vn;){const o=r/n,a=r%n,c=s-i*o;r=n,n=a,s=i,i=c}if(r!==rn)throw new Error("invert: does not exist");return zn(s,e)}function JE(t,e){const n=(t.ORDER+rn)/KE,r=t.pow(e,n);if(!t.eql(t.sqr(r),e))throw new Error("Cannot find square root");return r}function g$(t,e){const n=(t.ORDER-YE)/ZE,r=t.mul(e,Ei),s=t.pow(r,n),i=t.mul(e,s),o=t.mul(t.mul(i,Ei),s),a=t.mul(i,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),e))throw new Error("Cannot find square root");return a}function m$(t){if(t<BigInt(3))throw new Error("sqrt is not defined for small field");let e=t-rn,n=0;for(;e%Ei===vn;)e/=Ei,n++;let r=Ei;const s=na(t);for(;j0(s,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return JE;let i=s.pow(r,e);const o=(e+rn)/Ei;return function(a,c){if(a.is0(c))return c;if(j0(a,c)!==1)throw new Error("Cannot find square root");let l=n,u=a.mul(a.ONE,i),d=a.pow(c,e),h=a.pow(c,o);for(;!a.eql(d,a.ONE);){if(a.is0(d))return a.ZERO;let f=1,p=a.sqr(d);for(;!a.eql(p,a.ONE);)if(f++,p=a.sqr(p),f===l)throw new Error("Cannot find square root");const g=rn<<BigInt(l-f-1),m=a.pow(u,g);l=f,u=a.sqr(m),d=a.mul(d,u),h=a.mul(h,m)}return h}}function y$(t){return t%KE===p$?JE:t%ZE===YE?g$:m$(t)}const w$=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function b$(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"},n=w$.reduce((r,s)=>(r[s]="function",r),e);return bd(t,n),t}function v$(t,e,n){if(n<vn)throw new Error("invalid exponent, negatives unsupported");if(n===vn)return t.ONE;if(n===rn)return e;let r=t.ONE,s=e;for(;n>vn;)n&rn&&(r=t.mul(r,s)),s=t.sqr(s),n>>=rn;return r}function XE(t,e,n=!1){const r=new Array(e.length).fill(n?t.ZERO:void 0),s=e.reduce((o,a,c)=>t.is0(a)?o:(r[c]=o,t.mul(o,a)),t.ONE),i=t.inv(s);return e.reduceRight((o,a,c)=>t.is0(a)?o:(r[c]=t.mul(o,r[c]),t.mul(o,a)),i),r}function j0(t,e){const n=(t.ORDER-rn)/Ei,r=t.pow(e,n),s=t.eql(r,t.ONE),i=t.eql(r,t.ZERO),o=t.eql(r,t.neg(t.ONE));if(!s&&!i&&!o)throw new Error("invalid Legendre symbol result");return s?1:i?0:-1}function E$(t,e){e!==void 0&&us(e);const n=e!==void 0?e:t.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}function na(t,e,n=!1,r={}){if(t<=vn)throw new Error("invalid field: expected ORDER > 0, got "+t);let s,i;if(typeof e=="object"&&e!=null){if(r.sqrt||n)throw new Error("cannot specify opts in two arguments");const u=e;u.BITS&&(s=u.BITS),u.sqrt&&(i=u.sqrt),typeof u.isLE=="boolean"&&(n=u.isLE)}else typeof e=="number"&&(s=e),r.sqrt&&(i=r.sqrt);const{nBitLength:o,nByteLength:a}=E$(t,s);if(a>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const l=Object.freeze({ORDER:t,isLE:n,BITS:o,BYTES:a,MASK:wd(o),ZERO:vn,ONE:rn,create:u=>zn(u,t),isValid:u=>{if(typeof u!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof u);return vn<=u&&u<t},is0:u=>u===vn,isValidNot0:u=>!l.is0(u)&&l.isValid(u),isOdd:u=>(u&rn)===rn,neg:u=>zn(-u,t),eql:(u,d)=>u===d,sqr:u=>zn(u*u,t),add:(u,d)=>zn(u+d,t),sub:(u,d)=>zn(u-d,t),mul:(u,d)=>zn(u*d,t),pow:(u,d)=>v$(l,u,d),div:(u,d)=>zn(u*F0(d,t),t),sqrN:u=>u*u,addN:(u,d)=>u+d,subN:(u,d)=>u-d,mulN:(u,d)=>u*d,inv:u=>F0(u,t),sqrt:i||(u=>(c||(c=y$(t)),c(l,u))),toBytes:u=>n?pg(u,a):fg(u,a),fromBytes:u=>{if(u.length!==a)throw new Error("Field.fromBytes: expected "+a+" bytes, got "+u.length);return n?Tu(u):yd(u)},invertBatch:u=>XE(l,u),cmov:(u,d,h)=>h?d:u});return Object.freeze(l)}function QE(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function eC(t){const e=QE(t);return e+Math.ceil(e/2)}function C$(t,e,n=!1){const r=t.length,s=QE(e),i=eC(e);if(r<16||r<i||r>1024)throw new Error("expected "+i+"-1024 bytes of input, got "+r);const o=n?Tu(t):yd(t),a=zn(o,e-rn)+rn;return n?pg(a,s):fg(a,s)}const Fo=BigInt(0),Ci=BigInt(1);function ja(t,e){const n=e.negate();return t?n:e}function _$(t,e,n){const r=i=>i.pz,s=XE(t.Fp,n.map(r));return n.map((i,o)=>i.toAffine(s[o])).map(t.fromAffine)}function tC(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function mh(t,e){tC(t,e);const n=Math.ceil(e/t)+1,r=2**(t-1),s=2**t,i=wd(t),o=BigInt(t);return{windows:n,windowSize:r,mask:i,maxNumber:s,shiftBy:o}}function H0(t,e,n){const{windowSize:r,mask:s,maxNumber:i,shiftBy:o}=n;let a=Number(t&s),c=t>>o;a>r&&(a-=i,c+=Ci);const l=e*r,u=l+Math.abs(a)-1,d=a===0,h=a<0,f=e%2!==0;return{nextN:c,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:l}}function A$(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((n,r)=>{if(!(n instanceof e))throw new Error("invalid point at index "+r)})}function I$(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((n,r)=>{if(!e.isValid(n))throw new Error("invalid scalar at index "+r)})}const yh=new WeakMap,nC=new WeakMap;function wh(t){return nC.get(t)||1}function q0(t){if(t!==Fo)throw new Error("invalid wNAF")}function S$(t,e){return{constTimeNegate:ja,hasPrecomputes(n){return wh(n)!==1},unsafeLadder(n,r,s=t.ZERO){let i=n;for(;r>Fo;)r&Ci&&(s=s.add(i)),i=i.double(),r>>=Ci;return s},precomputeWindow(n,r){const{windows:s,windowSize:i}=mh(r,e),o=[];let a=n,c=a;for(let l=0;l<s;l++){c=a,o.push(c);for(let u=1;u<i;u++)c=c.add(a),o.push(c);a=c.double()}return o},wNAF(n,r,s){let i=t.ZERO,o=t.BASE;const a=mh(n,e);for(let c=0;c<a.windows;c++){const{nextN:l,offset:u,isZero:d,isNeg:h,isNegF:f,offsetF:p}=H0(s,c,a);s=l,d?o=o.add(ja(f,r[p])):i=i.add(ja(h,r[u]))}return q0(s),{p:i,f:o}},wNAFUnsafe(n,r,s,i=t.ZERO){const o=mh(n,e);for(let a=0;a<o.windows&&s!==Fo;a++){const{nextN:c,offset:l,isZero:u,isNeg:d}=H0(s,a,o);if(s=c,!u){const h=r[l];i=i.add(d?h.negate():h)}}return q0(s),i},getPrecomputes(n,r,s){let i=yh.get(r);return i||(i=this.precomputeWindow(r,n),n!==1&&(typeof s=="function"&&(i=s(i)),yh.set(r,i))),i},wNAFCached(n,r,s){const i=wh(n);return this.wNAF(i,this.getPrecomputes(i,n,s),r)},wNAFCachedUnsafe(n,r,s,i){const o=wh(n);return o===1?this.unsafeLadder(n,r,i):this.wNAFUnsafe(o,this.getPrecomputes(o,n,s),r,i)},setWindowSize(n,r){tC(r,e),nC.set(n,r),yh.delete(n)}}}function N$(t,e,n,r){let s=e,i=t.ZERO,o=t.ZERO;for(;n>Fo||r>Fo;)n&Ci&&(i=i.add(s)),r&Ci&&(o=o.add(s)),s=s.double(),n>>=Ci,r>>=Ci;return{p1:i,p2:o}}function x$(t,e,n,r){A$(n,t),I$(r,e);const s=n.length,i=r.length;if(s!==i)throw new Error("arrays of points and scalars must have equal length");const o=t.ZERO,a=h$(BigInt(s));let c=1;a>12?c=a-3:a>4?c=a-2:a>0&&(c=2);const l=wd(c),u=new Array(Number(l)+1).fill(o),d=Math.floor((e.BITS-1)/c)*c;let h=o;for(let f=d;f>=0;f-=c){u.fill(o);for(let g=0;g<i;g++){const m=r[g],v=Number(m>>BigInt(f)&l);u[v]=u[v].add(n[g])}let p=o;for(let g=u.length-1,m=o;g>0;g--)m=m.add(u[g]),p=p.add(m);if(h=h.add(p),f!==0)for(let g=0;g<c;g++)h=h.double()}return h}function z0(t,e){if(e){if(e.ORDER!==t)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return b$(e),e}else return na(t)}function T$(t,e,n={}){if(!e||typeof e!="object")throw new Error(`expected valid ${t} CURVE object`);for(const o of["p","n","h"]){const a=e[o];if(!(typeof a=="bigint"&&a>Fo))throw new Error(`CURVE.${o} must be positive bigint`)}const r=z0(e.p,n.Fp),s=z0(e.n,n.Fn),i=["Gx","Gy","a","b"];for(const o of i)if(!r.isValid(e[o]))throw new Error(`CURVE.${o} must be valid field element of CURVE.Fp`);return{Fp:r,Fn:s}}BigInt(0),BigInt(1),BigInt(2),BigInt(8);const va=BigInt(0),so=BigInt(1),kl=BigInt(2);function P$(t){return bd(t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...t})}function O$(t){const e=P$(t),{P:n,type:r,adjustScalarBytes:s,powPminus2:i,randomBytes:o}=e,a=r==="x25519";if(!a&&r!=="x448")throw new Error("invalid type");const c=o||ta,l=a?255:448,u=a?32:56,d=BigInt(a?9:5),h=BigInt(a?121665:39081),f=a?kl**BigInt(254):kl**BigInt(447),p=a?BigInt(8)*kl**BigInt(251)-so:BigInt(4)*kl**BigInt(445)-so,g=f+p+so,m=I=>zn(I,n),v=b(d);function b(I){return pg(m(I),u)}function y(I){const U=wn("u coordinate",I,u);return a&&(U[31]&=127),m(Tu(U))}function N(I){return Tu(s(wn("scalar",I,u)))}function _(I,U){const R=D(y(U),N(I));if(R===va)throw new Error("invalid private or public key received");return b(R)}function T(I){return _(I,v)}function x(I,U,R){const k=m(I*(U-R));return U=m(U-k),R=m(R+k),{x_2:U,x_3:R}}function D(I,U){Ff("u",I,va,n),Ff("scalar",U,f,g);const R=U,k=I;let M=so,F=va,E=I,S=so,O=va;for(let C=BigInt(l-1);C>=va;C--){const P=R>>C&so;O^=P,{x_2:M,x_3:E}=x(O,M,E),{x_2:F,x_3:S}=x(O,F,S),O=P;const B=M+F,H=m(B*B),G=M-F,W=m(G*G),se=H-W,ue=E+S,De=E-S,je=m(De*B),xe=m(ue*G),ft=je+xe,Rt=je-xe;E=m(ft*ft),S=m(k*m(Rt*Rt)),M=m(H*W),F=m(se*(H+m(h*se)))}({x_2:M,x_3:E}=x(O,M,E)),{x_2:F,x_3:S}=x(O,F,S);const $=i(F);return m(M*$)}return{scalarMult:_,scalarMultBase:T,getSharedSecret:(I,U)=>_(I,U),getPublicKey:I=>T(I),utils:{randomPrivateKey:()=>c(u)},GuBytes:v.slice()}}BigInt(0);const R$=BigInt(1),W0=BigInt(2),D$=BigInt(3),$$=BigInt(5);BigInt(8);const rC={p:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function k$(t){const e=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),i=rC.p,o=t*t%i*t%i,a=ir(o,W0,i)*o%i,c=ir(a,R$,i)*t%i,l=ir(c,$$,i)*c%i,u=ir(l,e,i)*l%i,d=ir(u,n,i)*u%i,h=ir(d,r,i)*d%i,f=ir(h,s,i)*h%i,p=ir(f,s,i)*h%i,g=ir(p,e,i)*l%i;return{pow_p_5_8:ir(g,W0,i)*t%i,b2:o}}function U$(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const jf=(()=>{const t=rC.p;return O$({P:t,type:"x25519",powPminus2:e=>{const{pow_p_5_8:n,b2:r}=k$(e);return zn(ir(n,D$,t)*r,t)},adjustScalarBytes:U$})})();function V0(t){t.lowS!==void 0&&xu("lowS",t.lowS),t.prehash!==void 0&&xu("prehash",t.prehash)}class L$ extends Error{constructor(e=""){super(e)}}const ns={Err:L$,_tlv:{encode:(t,e)=>{const{Err:n}=ns;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length&1)throw new n("tlv.encode: unpadded data");const r=e.length/2,s=$l(r);if(s.length/2&128)throw new n("tlv.encode: long form length too big");const i=r>127?$l(s.length/2|128):"";return $l(t)+i+s+e},decode(t,e){const{Err:n}=ns;let r=0;if(t<0||t>256)throw new n("tlv.encode: wrong tag");if(e.length<2||e[r++]!==t)throw new n("tlv.decode: wrong tlv");const s=e[r++],i=!!(s&128);let o=0;if(!i)o=s;else{const c=s&127;if(!c)throw new n("tlv.decode(long): indefinite length not supported");if(c>4)throw new n("tlv.decode(long): byte length is too big");const l=e.subarray(r,r+c);if(l.length!==c)throw new n("tlv.decode: length bytes not complete");if(l[0]===0)throw new n("tlv.decode(long): zero leftmost byte");for(const u of l)o=o<<8|u;if(r+=c,o<128)throw new n("tlv.decode(long): not minimal encoding")}const a=e.subarray(r,r+o);if(a.length!==o)throw new n("tlv.decode: wrong value length");return{v:a,l:e.subarray(r+o)}}},_int:{encode(t){const{Err:e}=ns;if(t<Ha)throw new e("integer: negative integers are not allowed");let n=$l(t);if(Number.parseInt(n[0],16)&8&&(n="00"+n),n.length&1)throw new e("unexpected DER parsing assertion: unpadded hex");return n},decode(t){const{Err:e}=ns;if(t[0]&128)throw new e("invalid signature integer: negative");if(t[0]===0&&!(t[1]&128))throw new e("invalid signature integer: unnecessary leading zero");return yd(t)}},toSig(t){const{Err:e,_int:n,_tlv:r}=ns,s=wn("signature",t),{v:i,l:o}=r.decode(48,s);if(o.length)throw new e("invalid signature: left bytes after parsing");const{v:a,l:c}=r.decode(2,i),{v:l,l:u}=r.decode(2,c);if(u.length)throw new e("invalid signature: left bytes after parsing");return{r:n.decode(a),s:n.decode(l)}},hexFromSig(t){const{_tlv:e,_int:n}=ns,r=e.encode(2,n.encode(t.r)),s=e.encode(2,n.encode(t.s)),i=r+s;return e.encode(48,i)}},Ha=BigInt(0),qa=BigInt(1),M$=BigInt(2),Ul=BigInt(3),B$=BigInt(4);function F$(t,e,n){function r(s){const i=t.sqr(s),o=t.mul(i,s);return t.add(t.add(o,t.mul(s,e)),n)}return r}function sC(t,e,n){const{BYTES:r}=t;function s(i){let o;if(typeof i=="bigint")o=i;else{let a=wn("private key",i);if(e){if(!e.includes(a.length*2))throw new Error("invalid private key");const c=new Uint8Array(r);c.set(a,c.length-a.length),a=c}try{o=t.fromBytes(a)}catch{throw new Error(`invalid private key: expected ui8a of size ${r}, got ${typeof i}`)}}if(n&&(o=t.create(o)),!t.isValidNot0(o))throw new Error("invalid private key: out of range [1..N-1]");return o}return s}function j$(t,e={}){const{Fp:n,Fn:r}=T$("weierstrass",t,e),{h:s,n:i}=t;bd(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:o}=e;if(o&&(!n.is0(t.a)||typeof o.beta!="bigint"||typeof o.splitScalar!="function"))throw new Error('invalid endo: expected "beta": bigint and "splitScalar": function');function a(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function c(D,I,U){const{x:R,y:k}=I.toAffine(),M=n.toBytes(R);if(xu("isCompressed",U),U){a();const F=!n.isOdd(k);return vi(iC(F),M)}else return vi(Uint8Array.of(4),M,n.toBytes(k))}function l(D){Yn(D);const I=n.BYTES,U=I+1,R=2*I+1,k=D.length,M=D[0],F=D.subarray(1);if(k===U&&(M===2||M===3)){const E=n.fromBytes(F);if(!n.isValid(E))throw new Error("bad point: is not on curve, wrong x");const S=h(E);let O;try{O=n.sqrt(S)}catch(C){const P=C instanceof Error?": "+C.message:"";throw new Error("bad point: is not on curve, sqrt error"+P)}a();const $=n.isOdd(O);return(M&1)===1!==$&&(O=n.neg(O)),{x:E,y:O}}else if(k===R&&M===4){const E=n.fromBytes(F.subarray(I*0,I*1)),S=n.fromBytes(F.subarray(I*1,I*2));if(!f(E,S))throw new Error("bad point: is not on curve");return{x:E,y:S}}else throw new Error(`bad point: got length ${k}, expected compressed=${U} or uncompressed=${R}`)}const u=e.toBytes||c,d=e.fromBytes||l,h=F$(n,t.a,t.b);function f(D,I){const U=n.sqr(I),R=h(D);return n.eql(U,R)}if(!f(t.Gx,t.Gy))throw new Error("bad curve params: generator point");const p=n.mul(n.pow(t.a,Ul),B$),g=n.mul(n.sqr(t.b),BigInt(27));if(n.is0(n.add(p,g)))throw new Error("bad curve params: a or b");function m(D,I,U=!1){if(!n.isValid(I)||U&&n.is0(I))throw new Error(`bad point coordinate ${D}`);return I}function v(D){if(!(D instanceof _))throw new Error("ProjectivePoint expected")}const b=B0((D,I)=>{const{px:U,py:R,pz:k}=D;if(n.eql(k,n.ONE))return{x:U,y:R};const M=D.is0();I==null&&(I=M?n.ONE:n.inv(k));const F=n.mul(U,I),E=n.mul(R,I),S=n.mul(k,I);if(M)return{x:n.ZERO,y:n.ZERO};if(!n.eql(S,n.ONE))throw new Error("invZ was invalid");return{x:F,y:E}}),y=B0(D=>{if(D.is0()){if(e.allowInfinityPoint&&!n.is0(D.py))return;throw new Error("bad point: ZERO")}const{x:I,y:U}=D.toAffine();if(!n.isValid(I)||!n.isValid(U))throw new Error("bad point: x or y not field elements");if(!f(I,U))throw new Error("bad point: equation left != right");if(!D.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function N(D,I,U,R,k){return U=new _(n.mul(U.px,D),U.py,U.pz),I=ja(R,I),U=ja(k,U),I.add(U)}class _{constructor(I,U,R){this.px=m("x",I),this.py=m("y",U,!0),this.pz=m("z",R),Object.freeze(this)}static fromAffine(I){const{x:U,y:R}=I||{};if(!I||!n.isValid(U)||!n.isValid(R))throw new Error("invalid affine point");if(I instanceof _)throw new Error("projective point not allowed");return n.is0(U)&&n.is0(R)?_.ZERO:new _(U,R,n.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(I){return _$(_,"pz",I)}static fromBytes(I){return Yn(I),_.fromHex(I)}static fromHex(I){const U=_.fromAffine(d(wn("pointHex",I)));return U.assertValidity(),U}static fromPrivateKey(I){const U=sC(r,e.allowedPrivateKeyLengths,e.wrapPrivateKey);return _.BASE.multiply(U(I))}static msm(I,U){return x$(_,r,I,U)}precompute(I=8,U=!0){return x.setWindowSize(this,I),U||this.multiply(Ul),this}_setWindowSize(I){this.precompute(I)}assertValidity(){y(this)}hasEvenY(){const{y:I}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(I)}equals(I){v(I);const{px:U,py:R,pz:k}=this,{px:M,py:F,pz:E}=I,S=n.eql(n.mul(U,E),n.mul(M,k)),O=n.eql(n.mul(R,E),n.mul(F,k));return S&&O}negate(){return new _(this.px,n.neg(this.py),this.pz)}double(){const{a:I,b:U}=t,R=n.mul(U,Ul),{px:k,py:M,pz:F}=this;let E=n.ZERO,S=n.ZERO,O=n.ZERO,$=n.mul(k,k),C=n.mul(M,M),P=n.mul(F,F),B=n.mul(k,M);return B=n.add(B,B),O=n.mul(k,F),O=n.add(O,O),E=n.mul(I,O),S=n.mul(R,P),S=n.add(E,S),E=n.sub(C,S),S=n.add(C,S),S=n.mul(E,S),E=n.mul(B,E),O=n.mul(R,O),P=n.mul(I,P),B=n.sub($,P),B=n.mul(I,B),B=n.add(B,O),O=n.add($,$),$=n.add(O,$),$=n.add($,P),$=n.mul($,B),S=n.add(S,$),P=n.mul(M,F),P=n.add(P,P),$=n.mul(P,B),E=n.sub(E,$),O=n.mul(P,C),O=n.add(O,O),O=n.add(O,O),new _(E,S,O)}add(I){v(I);const{px:U,py:R,pz:k}=this,{px:M,py:F,pz:E}=I;let S=n.ZERO,O=n.ZERO,$=n.ZERO;const C=t.a,P=n.mul(t.b,Ul);let B=n.mul(U,M),H=n.mul(R,F),G=n.mul(k,E),W=n.add(U,R),se=n.add(M,F);W=n.mul(W,se),se=n.add(B,H),W=n.sub(W,se),se=n.add(U,k);let ue=n.add(M,E);return se=n.mul(se,ue),ue=n.add(B,G),se=n.sub(se,ue),ue=n.add(R,k),S=n.add(F,E),ue=n.mul(ue,S),S=n.add(H,G),ue=n.sub(ue,S),$=n.mul(C,se),S=n.mul(P,G),$=n.add(S,$),S=n.sub(H,$),$=n.add(H,$),O=n.mul(S,$),H=n.add(B,B),H=n.add(H,B),G=n.mul(C,G),se=n.mul(P,se),H=n.add(H,G),G=n.sub(B,G),G=n.mul(C,G),se=n.add(se,G),B=n.mul(H,se),O=n.add(O,B),B=n.mul(ue,se),S=n.mul(W,S),S=n.sub(S,B),B=n.mul(W,H),$=n.mul(ue,$),$=n.add($,B),new _(S,O,$)}subtract(I){return this.add(I.negate())}is0(){return this.equals(_.ZERO)}multiply(I){const{endo:U}=e;if(!r.isValidNot0(I))throw new Error("invalid scalar: out of range");let R,k;const M=F=>x.wNAFCached(this,F,_.normalizeZ);if(U){const{k1neg:F,k1:E,k2neg:S,k2:O}=U.splitScalar(I),{p:$,f:C}=M(E),{p:P,f:B}=M(O);k=C.add(B),R=N(U.beta,$,P,F,S)}else{const{p:F,f:E}=M(I);R=F,k=E}return _.normalizeZ([R,k])[0]}multiplyUnsafe(I){const{endo:U}=e,R=this;if(!r.isValid(I))throw new Error("invalid scalar: out of range");if(I===Ha||R.is0())return _.ZERO;if(I===qa)return R;if(x.hasPrecomputes(this))return this.multiply(I);if(U){const{k1neg:k,k1:M,k2neg:F,k2:E}=U.splitScalar(I),{p1:S,p2:O}=N$(_,R,M,E);return N(U.beta,S,O,k,F)}else return x.wNAFCachedUnsafe(R,I)}multiplyAndAddUnsafe(I,U,R){const k=this.multiplyUnsafe(U).add(I.multiplyUnsafe(R));return k.is0()?void 0:k}toAffine(I){return b(this,I)}isTorsionFree(){const{isTorsionFree:I}=e;return s===qa?!0:I?I(_,this):x.wNAFCachedUnsafe(this,i).is0()}clearCofactor(){const{clearCofactor:I}=e;return s===qa?this:I?I(_,this):this.multiplyUnsafe(s)}toBytes(I=!0){return xu("isCompressed",I),this.assertValidity(),u(_,this,I)}toRawBytes(I=!0){return this.toBytes(I)}toHex(I=!0){return Nc(this.toBytes(I))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}_.BASE=new _(t.Gx,t.Gy,n.ONE),_.ZERO=new _(n.ZERO,n.ONE,n.ZERO),_.Fp=n,_.Fn=r;const T=r.BITS,x=S$(_,e.endo?Math.ceil(T/2):T);return _}function iC(t){return Uint8Array.of(t?2:3)}function H$(t,e,n={}){bd(e,{hash:"function"},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const r=e.randomBytes||ta,s=e.hmac||((R,...k)=>gd(e.hash,R,vi(...k))),{Fp:i,Fn:o}=t,{ORDER:a,BITS:c}=o;function l(R){const k=a>>qa;return R>k}function u(R){return l(R)?o.neg(R):R}function d(R,k){if(!o.isValidNot0(k))throw new Error(`invalid signature ${R}: out of range 1..CURVE.n`)}class h{constructor(k,M,F){d("r",k),d("s",M),this.r=k,this.s=M,F!=null&&(this.recovery=F),Object.freeze(this)}static fromCompact(k){const M=o.BYTES,F=wn("compactSignature",k,M*2);return new h(o.fromBytes(F.subarray(0,M)),o.fromBytes(F.subarray(M,M*2)))}static fromDER(k){const{r:M,s:F}=ns.toSig(wn("DER",k));return new h(M,F)}assertValidity(){}addRecoveryBit(k){return new h(this.r,this.s,k)}recoverPublicKey(k){const M=i.ORDER,{r:F,s:E,recovery:S}=this;if(S==null||![0,1,2,3].includes(S))throw new Error("recovery id invalid");if(a*M$<M&&S>1)throw new Error("recovery id is ambiguous for h>1 curve");const O=S===2||S===3?F+a:F;if(!i.isValid(O))throw new Error("recovery id 2 or 3 invalid");const $=i.toBytes(O),C=t.fromHex(vi(iC((S&1)===0),$)),P=o.inv(O),B=y(wn("msgHash",k)),H=o.create(-B*P),G=o.create(E*P),W=t.BASE.multiplyUnsafe(H).add(C.multiplyUnsafe(G));if(W.is0())throw new Error("point at infinify");return W.assertValidity(),W}hasHighS(){return l(this.s)}normalizeS(){return this.hasHighS()?new h(this.r,o.neg(this.s),this.recovery):this}toBytes(k){if(k==="compact")return vi(o.toBytes(this.r),o.toBytes(this.s));if(k==="der")return lg(ns.hexFromSig(this));throw new Error("invalid format")}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return Nc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return Nc(this.toBytes("compact"))}}const f=sC(o,n.allowedPrivateKeyLengths,n.wrapPrivateKey),p={isValidPrivateKey(R){try{return f(R),!0}catch{return!1}},normPrivateKeyToScalar:f,randomPrivateKey:()=>{const R=a;return C$(r(eC(R)),R)},precompute(R=8,k=t.BASE){return k.precompute(R,!1)}};function g(R,k=!0){return t.fromPrivateKey(R).toBytes(k)}function m(R){if(typeof R=="bigint")return!1;if(R instanceof t)return!0;const k=wn("key",R).length,M=i.BYTES,F=M+1,E=2*M+1;if(!(n.allowedPrivateKeyLengths||o.BYTES===F))return k===F||k===E}function v(R,k,M=!0){if(m(R)===!0)throw new Error("first arg must be private key");if(m(k)===!1)throw new Error("second arg must be public key");return t.fromHex(k).multiply(f(R)).toBytes(M)}const b=e.bits2int||function(R){if(R.length>8192)throw new Error("input is too large");const k=yd(R),M=R.length*8-c;return M>0?k>>BigInt(M):k},y=e.bits2int_modN||function(R){return o.create(b(R))},N=wd(c);function _(R){return Ff("num < 2^"+c,R,Ha,N),o.toBytes(R)}function T(R,k,M=x){if(["recovered","canonical"].some(W=>W in M))throw new Error("sign() legacy options not supported");const{hash:F}=e;let{lowS:E,prehash:S,extraEntropy:O}=M;E==null&&(E=!0),R=wn("msgHash",R),V0(M),S&&(R=wn("prehashed msgHash",F(R)));const $=y(R),C=f(k),P=[_(C),_($)];if(O!=null&&O!==!1){const W=O===!0?r(i.BYTES):O;P.push(wn("extraEntropy",W))}const B=vi(...P),H=$;function G(W){const se=b(W);if(!o.isValidNot0(se))return;const ue=o.inv(se),De=t.BASE.multiply(se).toAffine(),je=o.create(De.x);if(je===Ha)return;const xe=o.create(ue*o.create(H+je*C));if(xe===Ha)return;let ft=(De.x===je?0:2)|Number(De.y&qa),Rt=xe;return E&&l(xe)&&(Rt=u(xe),ft^=1),new h(je,Rt,ft)}return{seed:B,k2sig:G}}const x={lowS:e.lowS,prehash:!1},D={lowS:e.lowS,prehash:!1};function I(R,k,M=x){const{seed:F,k2sig:E}=T(R,k,M);return f$(e.hash.outputLen,o.BYTES,s)(F,E)}t.BASE.precompute(8);function U(R,k,M,F=D){const E=R;k=wn("msgHash",k),M=wn("publicKey",M),V0(F);const{lowS:S,prehash:O,format:$}=F;if("strict"in F)throw new Error("options.strict was renamed to lowS");if($!==void 0&&!["compact","der","js"].includes($))throw new Error('format must be "compact", "der" or "js"');const C=typeof E=="string"||og(E),P=!C&&!$&&typeof E=="object"&&E!==null&&typeof E.r=="bigint"&&typeof E.s=="bigint";if(!C&&!P)throw new Error("invalid signature, expected Uint8Array, hex string or Signature instance");let B,H;try{if(P)if($===void 0||$==="js")B=new h(E.r,E.s);else throw new Error("invalid format");if(C){try{$!=="compact"&&(B=h.fromDER(E))}catch(ft){if(!(ft instanceof ns.Err))throw ft}!B&&$!=="der"&&(B=h.fromCompact(E))}H=t.fromHex(M)}catch{return!1}if(!B||S&&B.hasHighS())return!1;O&&(k=e.hash(k));const{r:G,s:W}=B,se=y(k),ue=o.inv(W),De=o.create(se*ue),je=o.create(G*ue),xe=t.BASE.multiplyUnsafe(De).add(H.multiplyUnsafe(je));return xe.is0()?!1:o.create(xe.x)===G}return Object.freeze({getPublicKey:g,getSharedSecret:v,sign:I,verify:U,utils:p,Point:t,Signature:h})}function q$(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},n=t.Fp,r=na(e.n,t.nBitLength),s={Fp:n,Fn:r,allowedPrivateKeyLengths:t.allowedPrivateKeyLengths,allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,wrapPrivateKey:t.wrapPrivateKey,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes};return{CURVE:e,curveOpts:s}}function z$(t){const{CURVE:e,curveOpts:n}=q$(t),r={hash:t.hash,hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:n,ecdsaOpts:r}}function W$(t,e){return Object.assign({},e,{ProjectivePoint:e.Point,CURVE:t})}function V$(t){const{CURVE:e,curveOpts:n,ecdsaOpts:r}=z$(t),s=j$(e,n),i=H$(s,r,n);return W$(t,i)}function Hf(t,e){const n=r=>V$({...t,hash:r});return{...n(e),create:n}}const oC={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},aC={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},cC={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},G$=na(oC.p),K$=na(aC.p),Y$=na(cC.p),Z$=Hf({...oC,Fp:G$,lowS:!1},pd);Hf({...aC,Fp:K$,lowS:!1},sD),Hf({...cC,Fp:Y$,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},rD);const J$=Z$,lC="base10",sn="base16",lr="base64pad",$s="base64url",cl="utf8",uC=0,os=1,ll=2,X$=0,G0=1,za=12,gg=32;function Q$(){const t=jf.utils.randomPrivateKey(),e=jf.getPublicKey(t);return{privateKey:Cn(t,sn),publicKey:Cn(e,sn)}}function qf(){const t=ta(gg);return Cn(t,sn)}function ek(t,e){const n=jf.getSharedSecret(Vn(t,sn),Vn(e,sn)),r=u$(md,n,void 0,void 0,gg);return Cn(r,sn)}function tu(t){const e=md(Vn(t,sn));return Cn(e,sn)}function xr(t){const e=md(Vn(t,cl));return Cn(e,sn)}function dC(t){return Vn(`${t}`,lC)}function Li(t){return Number(Cn(t,lC))}function hC(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function fC(t){const e=t.replace(/-/g,"+").replace(/_/g,"/"),n=(4-e.length%4)%4;return e+"=".repeat(n)}function tk(t){const e=dC(typeof t.type<"u"?t.type:uC);if(Li(e)===os&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const n=typeof t.senderPublicKey<"u"?Vn(t.senderPublicKey,sn):void 0,r=typeof t.iv<"u"?Vn(t.iv,sn):ta(za),s=Vn(t.symKey,sn),i=WE(s,r).encrypt(Vn(t.message,cl)),o=pC({type:e,sealed:i,iv:r,senderPublicKey:n});return t.encoding===$s?hC(o):o}function nk(t){const e=Vn(t.symKey,sn),{sealed:n,iv:r}=Tc({encoded:t.encoded,encoding:t.encoding}),s=WE(e,r).decrypt(n);if(s===null)throw new Error("Failed to decrypt");return Cn(s,cl)}function rk(t,e){const n=dC(ll),r=ta(za),s=Vn(t,cl),i=pC({type:n,sealed:s,iv:r});return e===$s?hC(i):i}function sk(t,e){const{sealed:n}=Tc({encoded:t,encoding:e});return Cn(n,cl)}function pC(t){if(Li(t.type)===ll)return Cn(Fa([t.type,t.sealed]),lr);if(Li(t.type)===os){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Cn(Fa([t.type,t.senderPublicKey,t.iv,t.sealed]),lr)}return Cn(Fa([t.type,t.iv,t.sealed]),lr)}function Tc(t){const e=(t.encoding||lr)===$s?fC(t.encoded):t.encoded,n=Vn(e,lr),r=n.slice(X$,G0),s=G0;if(Li(r)===os){const c=s+gg,l=c+za,u=n.slice(s,c),d=n.slice(c,l),h=n.slice(l);return{type:r,sealed:h,iv:d,senderPublicKey:u}}if(Li(r)===ll){const c=n.slice(s),l=ta(za);return{type:r,sealed:c,iv:l}}const i=s+za,o=n.slice(s,i),a=n.slice(i);return{type:r,sealed:a,iv:o}}function ik(t,e){const n=Tc({encoded:t,encoding:e==null?void 0:e.encoding});return gC({type:Li(n.type),senderPublicKey:typeof n.senderPublicKey<"u"?Cn(n.senderPublicKey,sn):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function gC(t){const e=(t==null?void 0:t.type)||uC;if(e===os){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function K0(t){return t.type===os&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Y0(t){return t.type===ll}function ok(t){const e=Buffer.from(t.x,"base64"),n=Buffer.from(t.y,"base64");return Fa([new Uint8Array([4]),e,n])}function ak(t,e){const[n,r,s]=t.split("."),i=Buffer.from(fC(s),"base64");if(i.length!==64)throw new Error("Invalid signature length");const o=i.slice(0,32),a=i.slice(32,64),c=`${n}.${r}`,l=md(c),u=ok(e);if(!J$.verify(Fa([o,a]),l,u))throw new Error("Invalid signature");return If(t).payload}const ck="irn";function Pu(t){return(t==null?void 0:t.relay)||{protocol:ck}}function Da(t){const e=L6[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function lk(t,e="-"){const n={},r="relay"+e;return Object.keys(t).forEach(s=>{if(s.startsWith(r)){const i=s.replace(r,""),o=t[s];n[i]=o}}),n}function Z0(t){if(!t.includes("wc:")){const l=SE(t);l!=null&&l.includes("wc:")&&(t=l)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),n=t.indexOf("?")!==-1?t.indexOf("?"):void 0,r=t.substring(0,e),s=t.substring(e+1,n).split("@"),i=typeof n<"u"?t.substring(n):"",o=new URLSearchParams(i),a={};o.forEach((l,u)=>{a[u]=l});const c=typeof a.methods=="string"?a.methods.split(","):void 0;return{protocol:r,topic:uk(s[0]),version:parseInt(s[1],10),symKey:a.symKey,relay:lk(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function uk(t){return t.startsWith("//")?t.substring(2):t}function dk(t,e="-"){const n="relay",r={};return Object.keys(t).forEach(s=>{const i=s,o=n+e+i;t[i]&&(r[o]=t[i])}),r}function J0(t){const e=new URLSearchParams,n=dk(t.relay);Object.keys(n).sort().forEach(s=>{e.set(s,n[s])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const r=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${r}`}function Ll(t,e,n){return`${t}?wc_ev=${n}&topic=${e}`}var hk=Object.defineProperty,fk=Object.defineProperties,pk=Object.getOwnPropertyDescriptors,X0=Object.getOwnPropertySymbols,gk=Object.prototype.hasOwnProperty,mk=Object.prototype.propertyIsEnumerable,Q0=(t,e,n)=>e in t?hk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yk=(t,e)=>{for(var n in e||(e={}))gk.call(e,n)&&Q0(t,n,e[n]);if(X0)for(var n of X0(e))mk.call(e,n)&&Q0(t,n,e[n]);return t},wk=(t,e)=>fk(t,pk(e));function ra(t){const e=[];return t.forEach(n=>{const[r,s]=n.split(":");e.push(`${r}:${s}`)}),e}function bk(t){const e=[];return Object.values(t).forEach(n=>{e.push(...ra(n.accounts))}),e}function vk(t,e){const n=[];return Object.values(t).forEach(r=>{ra(r.accounts).includes(e)&&n.push(...r.methods)}),n}function Ek(t,e){const n=[];return Object.values(t).forEach(r=>{ra(r.accounts).includes(e)&&n.push(...r.events)}),n}function vd(t){return t.includes(":")}function Ao(t){return vd(t)?t.split(":")[0]:t}function ey(t){var e,n,r;const s={};if(!qs(t))return s;for(const[i,o]of Object.entries(t)){const a=vd(i)?[i]:o.chains,c=o.methods||[],l=o.events||[],u=Ao(i);s[u]=wk(yk({},s[u]),{chains:$r(a,(e=s[u])==null?void 0:e.chains),methods:$r(c,(n=s[u])==null?void 0:n.methods),events:$r(l,(r=s[u])==null?void 0:r.events)})}return s}function Ck(t){const e={};return t==null||t.forEach(n=>{var r;const[s,i]=n.split(":");e[s]||(e[s]={accounts:[],chains:[],events:[],methods:[]}),e[s].accounts.push(n),(r=e[s].chains)==null||r.push(`${s}:${i}`)}),e}function ty(t,e){e=e.map(r=>r.replace("did:pkh:",""));const n=Ck(e);for(const[r,s]of Object.entries(n))s.methods?s.methods=$r(s.methods,t):s.methods=t,s.events=["chainChanged","accountsChanged"];return n}function _k(t,e){var n,r,s,i,o,a;const c=ey(t),l=ey(e),u={},d=Object.keys(c).concat(Object.keys(l));for(const h of d)u[h]={chains:$r((n=c[h])==null?void 0:n.chains,(r=l[h])==null?void 0:r.chains),methods:$r((s=c[h])==null?void 0:s.methods,(i=l[h])==null?void 0:i.methods),events:$r((o=c[h])==null?void 0:o.events,(a=l[h])==null?void 0:a.events)};return u}const Ak={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Ik={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Z(t,e){const{message:n,code:r}=Ik[t];return{message:e?`${n} ${e}`:n,code:r}}function ct(t,e){const{message:n,code:r}=Ak[t];return{message:e?`${n} ${e}`:n,code:r}}function as(t,e){return!!Array.isArray(t)}function qs(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Mt(t){return typeof t>"u"}function yt(t,e){return e&&Mt(t)?!0:typeof t=="string"&&!!t.trim().length}function mg(t,e){return e&&Mt(t)?!0:typeof t=="number"&&!isNaN(t)}function Sk(t,e){const{requiredNamespaces:n}=e,r=Object.keys(t.namespaces),s=Object.keys(n);let i=!0;return bi(s,r)?(r.forEach(o=>{const{accounts:a,methods:c,events:l}=t.namespaces[o],u=ra(a),d=n[o];(!bi(EE(o,d),u)||!bi(d.methods,c)||!bi(d.events,l))&&(i=!1)}),i):!1}function Ou(t){return yt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function Nk(t){if(yt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const n=e[0]+":"+e[1];return!!e[2]&&Ou(n)}}return!1}function xk(t){function e(n){try{return typeof new URL(n)<"u"}catch{return!1}}try{if(yt(t,!1)){if(e(t))return!0;const n=SE(t);return e(n)}}catch{}return!1}function Tk(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function Pk(t){return t==null?void 0:t.topic}function Ok(t,e){let n=null;return yt(t==null?void 0:t.publicKey,!1)||(n=Z("MISSING_OR_INVALID",`${e} controller public key should be a string`)),n}function ny(t){let e=!0;return as(t)?t.length&&(e=t.every(n=>yt(n,!1))):e=!1,e}function Rk(t,e,n){let r=null;return as(e)&&e.length?e.forEach(s=>{r||Ou(s)||(r=ct("UNSUPPORTED_CHAINS",`${n}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Ou(t)||(r=ct("UNSUPPORTED_CHAINS",`${n}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),r}function Dk(t,e,n){let r=null;return Object.entries(t).forEach(([s,i])=>{if(r)return;const o=Rk(s,EE(s,i),`${e} ${n}`);o&&(r=o)}),r}function $k(t,e){let n=null;return as(t)?t.forEach(r=>{n||Nk(r)||(n=ct("UNSUPPORTED_ACCOUNTS",`${e}, account ${r} should be a string and conform to "namespace:chainId:address" format`))}):n=ct("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n}function kk(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=$k(r==null?void 0:r.accounts,`${e} namespace`);s&&(n=s)}),n}function Uk(t,e){let n=null;return ny(t==null?void 0:t.methods)?ny(t==null?void 0:t.events)||(n=ct("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):n=ct("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),n}function mC(t,e){let n=null;return Object.values(t).forEach(r=>{if(n)return;const s=Uk(r,`${e}, namespace`);s&&(n=s)}),n}function Lk(t,e,n){let r=null;if(t&&qs(t)){const s=mC(t,e);s&&(r=s);const i=Dk(t,e,n);i&&(r=i)}else r=Z("MISSING_OR_INVALID",`${e}, ${n} should be an object with data`);return r}function bh(t,e){let n=null;if(t&&qs(t)){const r=mC(t,e);r&&(n=r);const s=kk(t,e);s&&(n=s)}else n=Z("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return n}function yC(t){return yt(t.protocol,!0)}function Mk(t,e){let n=!1;return t?t&&as(t)&&t.length&&t.forEach(r=>{n=yC(r)}):n=!0,n}function Bk(t){return typeof t=="number"}function mn(t){return typeof t<"u"&&typeof t!==null}function Fk(t){return!(!t||typeof t!="object"||!t.code||!mg(t.code,!1)||!t.message||!yt(t.message,!1))}function jk(t){return!(Mt(t)||!yt(t.method,!1))}function Hk(t){return!(Mt(t)||Mt(t.result)&&Mt(t.error)||!mg(t.id,!1)||!yt(t.jsonrpc,!1))}function qk(t){return!(Mt(t)||!yt(t.name,!1))}function ry(t,e){return!(!Ou(e)||!bk(t).includes(e))}function zk(t,e,n){return yt(n,!1)?vk(t,e).includes(n):!1}function Wk(t,e,n){return yt(n,!1)?Ek(t,e).includes(n):!1}function sy(t,e,n){let r=null;const s=Vk(t),i=Gk(e),o=Object.keys(s),a=Object.keys(i),c=iy(Object.keys(t)),l=iy(Object.keys(e)),u=c.filter(d=>!l.includes(d));return u.length&&(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(e).toString()}`)),bi(o,a)||(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(e).forEach(d=>{if(!d.includes(":")||r)return;const h=ra(e[d].accounts);h.includes(d)||(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces accounts don't satisfy namespace accounts for ${d}
        Required: ${d}
        Approved: ${h.toString()}`))}),o.forEach(d=>{r||(bi(s[d].methods,i[d].methods)?bi(s[d].events,i[d].events)||(r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces events don't satisfy namespace events for ${d}`)):r=Z("NON_CONFORMING_NAMESPACES",`${n} namespaces methods don't satisfy namespace methods for ${d}`))}),r}function Vk(t){const e={};return Object.keys(t).forEach(n=>{var r;n.includes(":")?e[n]=t[n]:(r=t[n].chains)==null||r.forEach(s=>{e[s]={methods:t[n].methods,events:t[n].events}})}),e}function iy(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Gk(t){const e={};return Object.keys(t).forEach(n=>{if(n.includes(":"))e[n]=t[n];else{const r=ra(t[n].accounts);r==null||r.forEach(s=>{e[s]={accounts:t[n].accounts.filter(i=>i.includes(`${s}:`)),methods:t[n].methods,events:t[n].events}})}}),e}function Kk(t,e){return mg(t,!1)&&t<=e.max&&t>=e.min}function oy(){const t=ol();return new Promise(e=>{switch(t){case Dn.browser:e(Yk());break;case Dn.reactNative:e(Zk());break;case Dn.node:e(Jk());break;default:e(!0)}})}function Yk(){return ea()&&(navigator==null?void 0:navigator.onLine)}async function Zk(){if(ni()&&typeof global<"u"&&global!=null&&global.NetInfo){const t=await(global==null?void 0:global.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function Jk(){return!0}function Xk(t){switch(ol()){case Dn.browser:Qk(t);break;case Dn.reactNative:e4(t);break}}function Qk(t){!ni()&&ea()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function e4(t){ni()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(e=>t(e==null?void 0:e.isConnected)))}function t4(){var t;return ea()&&ki()?((t=ki())==null?void 0:t.visibilityState)==="visible":!0}const vh={};class Ea{static get(e){return vh[e]}static set(e,n){vh[e]=n}static delete(e){delete vh[e]}}function n4(t){const e=Qo.decode(t);if(e.length<33)throw new Error("Too short to contain a public key");return e.slice(1,33)}function r4({publicKey:t,signature:e,payload:n}){var r;const s=zf(n.method),i=128|parseInt(((r=n.version)==null?void 0:r.toString())||"4"),o=o4(n.address),a=n.era==="00"?new Uint8Array([0]):zf(n.era);if(a.length!==1&&a.length!==2)throw new Error("Invalid era length");const c=parseInt(n.nonce,16),l=new Uint8Array([c&255,c>>8&255]),u=BigInt(`0x${i4(n.tip)}`),d=c4(u),h=new Uint8Array([0,...t,o,...e,...a,...l,...d,...s]),f=a4(h.length+1);return new Uint8Array([...f,i,...h])}function s4(t){const e=zf(t),n=Y6.blake2b(e,void 0,32);return"0x"+Buffer.from(n).toString("hex")}function zf(t){return new Uint8Array(t.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function i4(t){return t.startsWith("0x")?t.slice(2):t}function o4(t){const e=Qo.decode(t)[0];return e===42?0:e===60?2:1}function a4(t){if(t<64)return new Uint8Array([t<<2]);if(t<16384){const e=t<<2|1;return new Uint8Array([e&255,e>>8&255])}else if(t<1<<30){const e=t<<2|2;return new Uint8Array([e&255,e>>8&255,e>>16&255,e>>24&255])}else throw new Error("Compact encoding > 2^30 not supported")}function c4(t){if(t<BigInt(1)<<BigInt(6))return new Uint8Array([Number(t<<BigInt(2))]);if(t<BigInt(1)<<BigInt(14)){const e=t<<BigInt(2)|BigInt(1);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255))])}else if(t<BigInt(1)<<BigInt(30)){const e=t<<BigInt(2)|BigInt(2);return new Uint8Array([Number(e&BigInt(255)),Number(e>>BigInt(8)&BigInt(255)),Number(e>>BigInt(16)&BigInt(255)),Number(e>>BigInt(24)&BigInt(255))])}else throw new Error("BigInt compact encoding not supported > 2^30")}function l4(t){const e=Uint8Array.from(Buffer.from(t.signature,"hex")),n=n4(t.transaction.address),r=r4({publicKey:n,signature:e,payload:t.transaction}),s=Buffer.from(r).toString("hex");return s4(s)}const u4="PARSE_ERROR",d4="INVALID_REQUEST",h4="METHOD_NOT_FOUND",f4="INVALID_PARAMS",wC="INTERNAL_ERROR",yg="SERVER_ERROR",p4=[-32700,-32600,-32601,-32602,-32603],Wa={[u4]:{code:-32700,message:"Parse error"},[d4]:{code:-32600,message:"Invalid Request"},[h4]:{code:-32601,message:"Method not found"},[f4]:{code:-32602,message:"Invalid params"},[wC]:{code:-32603,message:"Internal error"},[yg]:{code:-32e3,message:"Server error"}},bC=yg;function g4(t){return p4.includes(t)}function ay(t){return Object.keys(Wa).includes(t)?Wa[t]:Wa[bC]}function m4(t){const e=Object.values(Wa).find(n=>n.code===t);return e||Wa[bC]}function vC(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}var EC={},Zr={},cy;function y4(){if(cy)return Zr;cy=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.isBrowserCryptoAvailable=Zr.getSubtleCrypto=Zr.getBrowerCrypto=void 0;function t(){return(Sr===null||Sr===void 0?void 0:Sr.crypto)||(Sr===null||Sr===void 0?void 0:Sr.msCrypto)||{}}Zr.getBrowerCrypto=t;function e(){const r=t();return r.subtle||r.webkitSubtle}Zr.getSubtleCrypto=e;function n(){return!!t()&&!!e()}return Zr.isBrowserCryptoAvailable=n,Zr}var Jr={},ly;function w4(){if(ly)return Jr;ly=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.isBrowser=Jr.isNode=Jr.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Jr.isReactNative=t;function e(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Jr.isNode=e;function n(){return!t()&&!e()}return Jr.isBrowser=n,Jr}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=el;e.__exportStar(y4(),t),e.__exportStar(w4(),t)})(EC);function Ar(t=3){const e=Date.now()*Math.pow(10,t),n=Math.floor(Math.random()*Math.pow(10,t));return e+n}function _i(t=6){return BigInt(Ar(t))}function Ms(t,e,n){return{id:n||Ar(),jsonrpc:"2.0",method:t,params:e}}function Ed(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Cd(t,e,n){return{id:t,jsonrpc:"2.0",error:b4(e)}}function b4(t,e){return typeof t>"u"?ay(wC):(typeof t=="string"&&(t=Object.assign(Object.assign({},ay(yg)),{message:t})),g4(t.code)&&(t=m4(t.code)),t)}let v4=class{},E4=class extends v4{constructor(){super()}},C4=class extends E4{constructor(e){super()}};const _4="^https?:",A4="^wss?:";function I4(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function CC(t,e){const n=I4(t);return typeof n>"u"?!1:new RegExp(e).test(n)}function uy(t){return CC(t,_4)}function dy(t){return CC(t,A4)}function S4(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function _C(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function wg(t){return _C(t)&&"method"in t}function _d(t){return _C(t)&&(Ir(t)||qn(t))}function Ir(t){return"result"in t}function qn(t){return"error"in t}let Qn=class extends C4{constructor(e){super(e),this.events=new Xn.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async request(e,n){return this.requestStrict(Ms(e.method,e.params||[],e.id||_i().toString()),n)}async requestStrict(e,n){return new Promise(async(r,s)=>{if(!this.connection.connected)try{await this.open()}catch(i){s(i)}this.events.on(`${e.id}`,i=>{qn(i)?s(i.error):r(i.result)});try{await this.connection.send(e,n)}catch(i){s(i)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),_d(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}};const N4=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),x4=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",hy=t=>t.split("?")[0],fy=10,T4=N4();let P4=class{constructor(e){if(this.url=e,this.events=new Xn.EventEmitter,this.registering=!1,!dy(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,n)=>{if(typeof this.socket>"u"){n(new Error("Connection already closed"));return}this.socket.onclose=r=>{this.onClose(r),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ls(e))}catch(n){this.onError(e.id,n)}}register(e=this.url){if(!dy(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));r(this.socket)})})}return this.url=e,this.registering=!0,new Promise((n,r)=>{const s=EC.isReactNative()?void 0:{rejectUnauthorized:!S4(e)},i=new T4(e,[],s);x4()?i.onerror=o=>{const a=o;r(this.emitError(a.error))}:i.on("error",o=>{r(this.emitError(o))}),i.onopen=()=>{this.onOpen(i),n(i)}})}onOpen(e){e.onmessage=n=>this.onPayload(n),e.onclose=n=>this.onClose(n),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?$i(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Cd(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return vC(e,hy(n),"WS")}resetMaxListeners(){this.events.getMaxListeners()>fy&&this.events.setMaxListeners(fy)}emitError(e){const n=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${hy(this.url)}`));return this.events.emit("register_error",n),n}};var O4={};const AC="wc",IC=2,Wf="core",Br=`${AC}@2:${Wf}:`,R4={logger:"error"},D4={database:":memory:"},$4="crypto",py="client_ed25519_seed",k4=Y.ONE_DAY,U4="keychain",L4="0.3",M4="messages",B4="0.3",gy=Y.SIX_HOURS,F4="publisher",SC="irn",j4="error",NC="wss://relay.walletconnect.org",H4="relayer",xt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},q4="_subscription",Bn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},z4=.1,Vf="2.21.3",rt={link_mode:"link_mode",relay:"relay"},nu={inbound:"inbound",outbound:"outbound"},W4="0.3",V4="WALLETCONNECT_CLIENT_ID",my="WALLETCONNECT_LINK_MODE_APPS",xn={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},G4="subscription",K4="0.3",Y4="pairing",Z4="0.3",Ca={wc_pairingDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Y.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:0},res:{ttl:Y.ONE_DAY,prompt:!1,tag:0}}},pi={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},nr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},J4="history",X4="0.3",Q4="expirer",Hn={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},eU="0.3",tU="verify-api",nU="https://verify.walletconnect.com",xC="https://verify.walletconnect.org",Va=xC,rU=`${Va}/v3`,sU=[nU,xC],iU="echo",oU="https://echo.walletconnect.com",_r={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Qr={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},rr={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},ai={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},ci={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},_a={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},aU=.1,cU="event-client",lU=86400,uU="https://pulse.walletconnect.org/batch";function dU(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var n=new Uint8Array(256),r=0;r<n.length;r++)n[r]=255;for(var s=0;s<t.length;s++){var i=t.charAt(s),o=i.charCodeAt(0);if(n[o]!==255)throw new TypeError(i+" is ambiguous");n[o]=s}var a=t.length,c=t.charAt(0),l=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function d(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,m=0,v=0,b=p.length;v!==b&&p[v]===0;)v++,g++;for(var y=(b-v)*u+1>>>0,N=new Uint8Array(y);v!==b;){for(var _=p[v],T=0,x=y-1;(_!==0||T<m)&&x!==-1;x--,T++)_+=256*N[x]>>>0,N[x]=_%a>>>0,_=_/a>>>0;if(_!==0)throw new Error("Non-zero carry");m=T,v++}for(var D=y-m;D!==y&&N[D]===0;)D++;for(var I=c.repeat(g);D<y;++D)I+=t.charAt(N[D]);return I}function h(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var m=0,v=0;p[g]===c;)m++,g++;for(var b=(p.length-g)*l+1>>>0,y=new Uint8Array(b);p[g];){var N=n[p.charCodeAt(g)];if(N===255)return;for(var _=0,T=b-1;(N!==0||_<v)&&T!==-1;T--,_++)N+=a*y[T]>>>0,y[T]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");v=_,g++}if(p[g]!==" "){for(var x=b-v;x!==b&&y[x]===0;)x++;for(var D=new Uint8Array(m+(b-x)),I=m;x!==b;)D[I++]=y[x++];return D}}}function f(p){var g=h(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:d,decodeUnsafe:h,decode:f}}var hU=dU,fU=hU;const TC=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},pU=t=>new TextEncoder().encode(t),gU=t=>new TextDecoder().decode(t);class mU{constructor(e,n,r){this.name=e,this.prefix=n,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class yU{constructor(e,n,r){if(this.name=e,this.prefix=n,n.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=n.codePointAt(0),this.baseDecode=r}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return PC(this,e)}}class wU{constructor(e){this.decoders=e}or(e){return PC(this,e)}decode(e){const n=e[0],r=this.decoders[n];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const PC=(t,e)=>new wU({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class bU{constructor(e,n,r,s){this.name=e,this.prefix=n,this.baseEncode=r,this.baseDecode=s,this.encoder=new mU(e,n,r),this.decoder=new yU(e,n,s)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Ad=({name:t,prefix:e,encode:n,decode:r})=>new bU(t,e,n,r),ul=({prefix:t,name:e,alphabet:n})=>{const{encode:r,decode:s}=fU(n,e);return Ad({prefix:t,name:e,encode:r,decode:i=>TC(s(i))})},vU=(t,e,n,r)=>{const s={};for(let u=0;u<e.length;++u)s[e[u]]=u;let i=t.length;for(;t[i-1]==="=";)--i;const o=new Uint8Array(i*n/8|0);let a=0,c=0,l=0;for(let u=0;u<i;++u){const d=s[t[u]];if(d===void 0)throw new SyntaxError(`Non-${r} character`);c=c<<n|d,a+=n,a>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=n||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return o},EU=(t,e,n)=>{const r=e[e.length-1]==="=",s=(1<<n)-1;let i="",o=0,a=0;for(let c=0;c<t.length;++c)for(a=a<<8|t[c],o+=8;o>n;)o-=n,i+=e[s&a>>o];if(o&&(i+=e[s&a<<n-o]),r)for(;i.length*n&7;)i+="=";return i},qt=({name:t,prefix:e,bitsPerChar:n,alphabet:r})=>Ad({prefix:e,name:t,encode(s){return EU(s,r,n)},decode(s){return vU(s,r,n,t)}}),CU=Ad({prefix:"\0",name:"identity",encode:t=>gU(t),decode:t=>pU(t)});var _U=Object.freeze({__proto__:null,identity:CU});const AU=qt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var IU=Object.freeze({__proto__:null,base2:AU});const SU=qt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var NU=Object.freeze({__proto__:null,base8:SU});const xU=ul({prefix:"9",name:"base10",alphabet:"0123456789"});var TU=Object.freeze({__proto__:null,base10:xU});const PU=qt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),OU=qt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var RU=Object.freeze({__proto__:null,base16:PU,base16upper:OU});const DU=qt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$U=qt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),kU=qt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),UU=qt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),LU=qt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),MU=qt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),BU=qt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),FU=qt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),jU=qt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var HU=Object.freeze({__proto__:null,base32:DU,base32upper:$U,base32pad:kU,base32padupper:UU,base32hex:LU,base32hexupper:MU,base32hexpad:BU,base32hexpadupper:FU,base32z:jU});const qU=ul({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),zU=ul({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var WU=Object.freeze({__proto__:null,base36:qU,base36upper:zU});const VU=ul({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),GU=ul({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var KU=Object.freeze({__proto__:null,base58btc:VU,base58flickr:GU});const YU=qt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ZU=qt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),JU=qt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),XU=qt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var QU=Object.freeze({__proto__:null,base64:YU,base64pad:ZU,base64url:JU,base64urlpad:XU});const OC=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),eL=OC.reduce((t,e,n)=>(t[n]=e,t),[]),tL=OC.reduce((t,e,n)=>(t[e.codePointAt(0)]=n,t),[]);function nL(t){return t.reduce((e,n)=>(e+=eL[n],e),"")}function rL(t){const e=[];for(const n of t){const r=tL[n.codePointAt(0)];if(r===void 0)throw new Error(`Non-base256emoji character: ${n}`);e.push(r)}return new Uint8Array(e)}const sL=Ad({prefix:"🚀",name:"base256emoji",encode:nL,decode:rL});var iL=Object.freeze({__proto__:null,base256emoji:sL}),oL=RC,yy=128,aL=-128,cL=Math.pow(2,31);function RC(t,e,n){e=e||[],n=n||0;for(var r=n;t>=cL;)e[n++]=t&255|yy,t/=128;for(;t&aL;)e[n++]=t&255|yy,t>>>=7;return e[n]=t|0,RC.bytes=n-r+1,e}var lL=Gf,uL=128,wy=127;function Gf(t,r){var n=0,r=r||0,s=0,i=r,o,a=t.length;do{if(i>=a)throw Gf.bytes=0,new RangeError("Could not decode varint");o=t[i++],n+=s<28?(o&wy)<<s:(o&wy)*Math.pow(2,s),s+=7}while(o>=uL);return Gf.bytes=i-r,n}var dL=Math.pow(2,7),hL=Math.pow(2,14),fL=Math.pow(2,21),pL=Math.pow(2,28),gL=Math.pow(2,35),mL=Math.pow(2,42),yL=Math.pow(2,49),wL=Math.pow(2,56),bL=Math.pow(2,63),vL=function(t){return t<dL?1:t<hL?2:t<fL?3:t<pL?4:t<gL?5:t<mL?6:t<yL?7:t<wL?8:t<bL?9:10},EL={encode:oL,decode:lL,encodingLength:vL},DC=EL;const by=(t,e,n=0)=>(DC.encode(t,e,n),e),vy=t=>DC.encodingLength(t),Kf=(t,e)=>{const n=e.byteLength,r=vy(t),s=r+vy(n),i=new Uint8Array(s+n);return by(t,i,0),by(n,i,r),i.set(e,s),new CL(t,n,e,i)};class CL{constructor(e,n,r,s){this.code=e,this.size=n,this.digest=r,this.bytes=s}}const $C=({name:t,code:e,encode:n})=>new _L(t,e,n);class _L{constructor(e,n,r){this.name=e,this.code=n,this.encode=r}digest(e){if(e instanceof Uint8Array){const n=this.encode(e);return n instanceof Uint8Array?Kf(this.code,n):n.then(r=>Kf(this.code,r))}else throw Error("Unknown type, must be binary type")}}const kC=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),AL=$C({name:"sha2-256",code:18,encode:kC("SHA-256")}),IL=$C({name:"sha2-512",code:19,encode:kC("SHA-512")});var SL=Object.freeze({__proto__:null,sha256:AL,sha512:IL});const UC=0,NL="identity",LC=TC,xL=t=>Kf(UC,LC(t)),TL={code:UC,name:NL,encode:LC,digest:xL};var PL=Object.freeze({__proto__:null,identity:TL});new TextEncoder,new TextDecoder;const Ey={..._U,...IU,...NU,...TU,...RU,...HU,...WU,...KU,...QU,...iL};({...SL,...PL});function MC(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function OL(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?MC(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function BC(t,e,n,r){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:n},decoder:{decode:r}}}const Cy=BC("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Eh=BC("ascii","a",t=>{let e="a";for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},t=>{t=t.substring(1);const e=OL(t.length);for(let n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}),RL={utf8:Cy,"utf-8":Cy,hex:Ey.base16,latin1:Eh,ascii:Eh,binary:Eh,...Ey};function DL(t,e="utf8"){const n=RL[e];if(!n)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?MC(globalThis.Buffer.from(t,"utf-8")):n.decoder.decode(`${n.prefix}${t}`)}var $L=Object.defineProperty,kL=(t,e,n)=>e in t?$L(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Er=(t,e,n)=>kL(t,typeof e!="symbol"?e+"":e,n);class UL{constructor(e,n){this.core=e,this.logger=n,Er(this,"keychain",new Map),Er(this,"name",U4),Er(this,"version",L4),Er(this,"initialized",!1),Er(this,"storagePrefix",Br),Er(this,"init",async()=>{if(!this.initialized){const r=await this.getKeyChain();typeof r<"u"&&(this.keychain=r),this.initialized=!0}}),Er(this,"has",r=>(this.isInitialized(),this.keychain.has(r))),Er(this,"set",async(r,s)=>{this.isInitialized(),this.keychain.set(r,s),await this.persist()}),Er(this,"get",r=>{this.isInitialized();const s=this.keychain.get(r);if(typeof s>"u"){const{message:i}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(i)}return s}),Er(this,"del",async r=>{this.isInitialized(),this.keychain.delete(r),await this.persist()}),this.core=e,this.logger=tn(n,this.name)}get context(){return In(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Rf(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Df(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var LL=Object.defineProperty,ML=(t,e,n)=>e in t?LL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kt=(t,e,n)=>ML(t,typeof e!="symbol"?e+"":e,n);class BL{constructor(e,n,r){this.core=e,this.logger=n,kt(this,"name",$4),kt(this,"keychain"),kt(this,"randomSessionIdentifier",qf()),kt(this,"initialized",!1),kt(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),kt(this,"hasKeys",s=>(this.isInitialized(),this.keychain.has(s))),kt(this,"getClientId",async()=>{this.isInitialized();const s=await this.getClientSeed(),i=n0(s);return Fv(i.publicKey)}),kt(this,"generateKeyPair",()=>{this.isInitialized();const s=Q$();return this.setPrivateKey(s.publicKey,s.privateKey)}),kt(this,"signJWT",async s=>{this.isInitialized();const i=await this.getClientSeed(),o=n0(i),a=this.randomSessionIdentifier;return await fR(a,s,k4,o)}),kt(this,"generateSharedKey",(s,i,o)=>{this.isInitialized();const a=this.getPrivateKey(s),c=ek(a,i);return this.setSymKey(c,o)}),kt(this,"setSymKey",async(s,i)=>{this.isInitialized();const o=i||tu(s);return await this.keychain.set(o,s),o}),kt(this,"deleteKeyPair",async s=>{this.isInitialized(),await this.keychain.del(s)}),kt(this,"deleteSymKey",async s=>{this.isInitialized(),await this.keychain.del(s)}),kt(this,"encode",async(s,i,o)=>{this.isInitialized();const a=gC(o),c=ls(i);if(Y0(a))return rk(c,o==null?void 0:o.encoding);if(K0(a)){const h=a.senderPublicKey,f=a.receiverPublicKey;s=await this.generateSharedKey(h,f)}const l=this.getSymKey(s),{type:u,senderPublicKey:d}=a;return tk({type:u,symKey:l,message:c,senderPublicKey:d,encoding:o==null?void 0:o.encoding})}),kt(this,"decode",async(s,i,o)=>{this.isInitialized();const a=ik(i,o);if(Y0(a)){const c=sk(i,o==null?void 0:o.encoding);return $i(c)}if(K0(a)){const c=a.receiverPublicKey,l=a.senderPublicKey;s=await this.generateSharedKey(c,l)}try{const c=this.getSymKey(s),l=nk({symKey:c,encoded:i,encoding:o==null?void 0:o.encoding});return $i(l)}catch(c){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(c)}}),kt(this,"getPayloadType",(s,i=lr)=>{const o=Tc({encoded:s,encoding:i});return Li(o.type)}),kt(this,"getPayloadSenderPublicKey",(s,i=lr)=>{const o=Tc({encoded:s,encoding:i});return o.senderPublicKey?Cn(o.senderPublicKey,sn):void 0}),this.core=e,this.logger=tn(n,this.name),this.keychain=r||new UL(this.core,this.logger)}get context(){return In(this.logger)}async setPrivateKey(e,n){return await this.keychain.set(e,n),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(py)}catch{e=qf(),await this.keychain.set(py,e)}return DL(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var FL=Object.defineProperty,jL=Object.defineProperties,HL=Object.getOwnPropertyDescriptors,_y=Object.getOwnPropertySymbols,qL=Object.prototype.hasOwnProperty,zL=Object.prototype.propertyIsEnumerable,Yf=(t,e,n)=>e in t?FL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,WL=(t,e)=>{for(var n in e||(e={}))qL.call(e,n)&&Yf(t,n,e[n]);if(_y)for(var n of _y(e))zL.call(e,n)&&Yf(t,n,e[n]);return t},VL=(t,e)=>jL(t,HL(e)),Nn=(t,e,n)=>Yf(t,typeof e!="symbol"?e+"":e,n);class GL extends dP{constructor(e,n){super(e,n),this.logger=e,this.core=n,Nn(this,"messages",new Map),Nn(this,"messagesWithoutClientAck",new Map),Nn(this,"name",M4),Nn(this,"version",B4),Nn(this,"initialized",!1),Nn(this,"storagePrefix",Br),Nn(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const r=await this.getRelayerMessages();typeof r<"u"&&(this.messages=r);const s=await this.getRelayerMessagesWithoutClientAck();typeof s<"u"&&(this.messagesWithoutClientAck=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}finally{this.initialized=!0}}}),Nn(this,"set",async(r,s,i)=>{this.isInitialized();const o=xr(s);let a=this.messages.get(r);if(typeof a>"u"&&(a={}),typeof a[o]<"u")return o;if(a[o]=s,this.messages.set(r,a),i===nu.inbound){const c=this.messagesWithoutClientAck.get(r)||{};this.messagesWithoutClientAck.set(r,VL(WL({},c),{[o]:s}))}return await this.persist(),o}),Nn(this,"get",r=>{this.isInitialized();let s=this.messages.get(r);return typeof s>"u"&&(s={}),s}),Nn(this,"getWithoutAck",r=>{this.isInitialized();const s={};for(const i of r){const o=this.messagesWithoutClientAck.get(i)||{};s[i]=Object.values(o)}return s}),Nn(this,"has",(r,s)=>{this.isInitialized();const i=this.get(r),o=xr(s);return typeof i[o]<"u"}),Nn(this,"ack",async(r,s)=>{this.isInitialized();const i=this.messagesWithoutClientAck.get(r);if(typeof i>"u")return;const o=xr(s);delete i[o],Object.keys(i).length===0?this.messagesWithoutClientAck.delete(r):this.messagesWithoutClientAck.set(r,i),await this.persist()}),Nn(this,"del",async r=>{this.isInitialized(),this.messages.delete(r),this.messagesWithoutClientAck.delete(r),await this.persist()}),this.logger=tn(e,this.name),this.core=n}get context(){return In(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Rf(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,Rf(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Df(e):void 0}async getRelayerMessagesWithoutClientAck(){const e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return typeof e<"u"?Df(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var KL=Object.defineProperty,YL=Object.defineProperties,ZL=Object.getOwnPropertyDescriptors,Ay=Object.getOwnPropertySymbols,JL=Object.prototype.hasOwnProperty,XL=Object.prototype.propertyIsEnumerable,Zf=(t,e,n)=>e in t?KL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ml=(t,e)=>{for(var n in e||(e={}))JL.call(e,n)&&Zf(t,n,e[n]);if(Ay)for(var n of Ay(e))XL.call(e,n)&&Zf(t,n,e[n]);return t},Ch=(t,e)=>YL(t,ZL(e)),sr=(t,e,n)=>Zf(t,typeof e!="symbol"?e+"":e,n);class QL extends hP{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,sr(this,"events",new Xn.EventEmitter),sr(this,"name",F4),sr(this,"queue",new Map),sr(this,"publishTimeout",Y.toMiliseconds(Y.ONE_MINUTE)),sr(this,"initialPublishTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),sr(this,"needsTransportRestart",!1),sr(this,"publish",async(r,s,i)=>{var o;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:r,message:s,opts:i}});const a=(i==null?void 0:i.ttl)||gy,c=Pu(i),l=(i==null?void 0:i.prompt)||!1,u=(i==null?void 0:i.tag)||0,d=(i==null?void 0:i.id)||_i().toString(),h={topic:r,message:s,opts:{ttl:a,relay:c,prompt:l,tag:u,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}},f=`Failed to publish payload, please try again. id:${d} tag:${u}`;try{const p=new Promise(async g=>{const m=({id:b})=>{h.opts.id===b&&(this.removeRequestFromQueue(b),this.relayer.events.removeListener(xt.publish,m),g(h))};this.relayer.events.on(xt.publish,m);const v=Ls(new Promise((b,y)=>{this.rpcPublish({topic:r,message:s,ttl:a,prompt:l,tag:u,id:d,attestation:i==null?void 0:i.attestation,tvf:i==null?void 0:i.tvf}).then(b).catch(N=>{this.logger.warn(N,N==null?void 0:N.message),y(N)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${d} tag:${u}`);try{await v,this.events.removeListener(xt.publish,m)}catch(b){this.queue.set(d,Ch(Ml({},h),{attempt:1})),this.logger.warn(b,b==null?void 0:b.message)}});this.logger.trace({type:"method",method:"publish",params:{id:d,topic:r,message:s,opts:i}}),await Ls(p,this.publishTimeout,f)}catch(p){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(p),(o=i==null?void 0:i.internal)!=null&&o.throwOnFailedPublish)throw p}finally{this.queue.delete(d)}}),sr(this,"on",(r,s)=>{this.events.on(r,s)}),sr(this,"once",(r,s)=>{this.events.once(r,s)}),sr(this,"off",(r,s)=>{this.events.off(r,s)}),sr(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.relayer=e,this.logger=tn(n,this.name),this.registerEventListeners()}get context(){return In(this.logger)}async rpcPublish(e){var n,r,s,i;const{topic:o,message:a,ttl:c=gy,prompt:l,tag:u,id:d,attestation:h,tvf:f}=e,p={method:Da(Pu().protocol).publish,params:Ml({topic:o,message:a,ttl:c,prompt:l,tag:u,attestation:h},f),id:d};Mt((n=p.params)==null?void 0:n.prompt)&&((r=p.params)==null||delete r.prompt),Mt((s=p.params)==null?void 0:s.tag)&&((i=p.params)==null||delete i.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});const g=await this.relayer.request(p);return this.relayer.events.emit(xt.publish,e),this.logger.debug("Successfully Published Payload"),g}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,n)=>{const r=e.attempt+1;this.queue.set(n,Ch(Ml({},e),{attempt:r}));const{topic:s,message:i,opts:o,attestation:a}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(Ch(Ml({},e),{topic:s,message:i,ttl:o.ttl,prompt:o.prompt,tag:o.tag,id:o.id,attestation:a,tvf:o.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(Vi.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(xt.connection_stalled);return}this.checkQueue()}),this.relayer.on(xt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var eM=Object.defineProperty,tM=(t,e,n)=>e in t?eM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,io=(t,e,n)=>tM(t,typeof e!="symbol"?e+"":e,n);class nM{constructor(){io(this,"map",new Map),io(this,"set",(e,n)=>{const r=this.get(e);this.exists(e,n)||this.map.set(e,[...r,n])}),io(this,"get",e=>this.map.get(e)||[]),io(this,"exists",(e,n)=>this.get(e).includes(n)),io(this,"delete",(e,n)=>{if(typeof n>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const r=this.get(e);if(!this.exists(e,n))return;const s=r.filter(i=>i!==n);if(!s.length){this.map.delete(e);return}this.map.set(e,s)}),io(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var rM=Object.defineProperty,sM=Object.defineProperties,iM=Object.getOwnPropertyDescriptors,Iy=Object.getOwnPropertySymbols,oM=Object.prototype.hasOwnProperty,aM=Object.prototype.propertyIsEnumerable,Jf=(t,e,n)=>e in t?rM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Aa=(t,e)=>{for(var n in e||(e={}))oM.call(e,n)&&Jf(t,n,e[n]);if(Iy)for(var n of Iy(e))aM.call(e,n)&&Jf(t,n,e[n]);return t},_h=(t,e)=>sM(t,iM(e)),Je=(t,e,n)=>Jf(t,typeof e!="symbol"?e+"":e,n);class cM extends gP{constructor(e,n){super(e,n),this.relayer=e,this.logger=n,Je(this,"subscriptions",new Map),Je(this,"topicMap",new nM),Je(this,"events",new Xn.EventEmitter),Je(this,"name",G4),Je(this,"version",K4),Je(this,"pending",new Map),Je(this,"cached",[]),Je(this,"initialized",!1),Je(this,"storagePrefix",Br),Je(this,"subscribeTimeout",Y.toMiliseconds(Y.ONE_MINUTE)),Je(this,"initialSubscribeTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),Je(this,"clientId"),Je(this,"batchSubscribeTopicsLimit",500),Je(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),Je(this,"subscribe",async(r,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}});try{const i=Pu(s),o={topic:r,relay:i,transportType:s==null?void 0:s.transportType};this.pending.set(r,o);const a=await this.rpcSubscribe(r,i,s);return typeof a=="string"&&(this.onSubscribe(a,o),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:r,opts:s}})),a}catch(i){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(i),i}}),Je(this,"unsubscribe",async(r,s)=>{this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(r,s.id,s):await this.unsubscribeByTopic(r,s)}),Je(this,"isSubscribed",r=>new Promise(s=>{s(this.topicMap.topics.includes(r))})),Je(this,"isKnownTopic",r=>new Promise(s=>{s(this.topicMap.topics.includes(r)||this.pending.has(r)||this.cached.some(i=>i.topic===r))})),Je(this,"on",(r,s)=>{this.events.on(r,s)}),Je(this,"once",(r,s)=>{this.events.once(r,s)}),Je(this,"off",(r,s)=>{this.events.off(r,s)}),Je(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),Je(this,"start",async()=>{await this.onConnect()}),Je(this,"stop",async()=>{await this.onDisconnect()}),Je(this,"restart",async()=>{await this.restore(),await this.onRestart()}),Je(this,"checkPending",async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const r=[];this.pending.forEach(s=>{r.push(s)}),await this.batchSubscribe(r)}),Je(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(Vi.pulse,async()=>{await this.checkPending()}),this.events.on(xn.created,async r=>{const s=xn.created;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()}),this.events.on(xn.deleted,async r=>{const s=xn.deleted;this.logger.info(`Emitting ${s}`),this.logger.debug({type:"event",event:s,data:r}),await this.persist()})}),this.relayer=e,this.logger=tn(n,this.name),this.clientId=""}get context(){return In(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,n){let r=!1;try{r=this.getSubscription(e).topic===n}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,n){const r=this.topicMap.get(e);await Promise.all(r.map(async s=>await this.unsubscribeById(e,s,n)))}async unsubscribeById(e,n,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}});try{const s=Pu(r);await this.restartToComplete({topic:e,id:n,relay:s}),await this.rpcUnsubscribe(e,n,s);const i=ct("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,n,i),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:n,opts:r}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(e,n,r){var s;(!r||(r==null?void 0:r.transportType)===rt.relay)&&await this.restartToComplete({topic:e,id:e,relay:n});const i={method:Da(n.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});const o=(s=r==null?void 0:r.internal)==null?void 0:s.throwOnFailedPublish;try{const a=await this.getSubscriptionId(e);if((r==null?void 0:r.transportType)===rt.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(i).catch(u=>this.logger.warn(u))},Y.toMiliseconds(Y.ONE_SECOND)),a;const c=new Promise(async u=>{const d=h=>{h.topic===e&&(this.events.removeListener(xn.created,d),u(h.id))};this.events.on(xn.created,d);try{const h=await Ls(new Promise((f,p)=>{this.relayer.request(i).catch(g=>{this.logger.warn(g,g==null?void 0:g.message),p(g)}).then(f)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(xn.created,d),u(h)}catch{}}),l=await Ls(c,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!l&&o)throw new Error(`Subscribing to ${e} failed, please try again`);return l?a:null}catch(a){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(xt.connection_stalled),o)throw a}return null}async rpcBatchSubscribe(e){if(!e.length)return;const n=e[0].relay,r={method:Da(n.protocol).batchSubscribe,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{await await Ls(new Promise(s=>{this.relayer.request(r).catch(i=>this.logger.warn(i)).then(s)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(xt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const n=e[0].relay,r={method:Da(n.protocol).batchFetchMessages,params:{topics:e.map(i=>i.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});let s;try{s=await await Ls(new Promise((i,o)=>{this.relayer.request(r).catch(a=>{this.logger.warn(a),o(a)}).then(i)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(xt.connection_stalled)}return s}rpcUnsubscribe(e,n,r){const s={method:Da(r.protocol).unsubscribe,params:{topic:e,id:n}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(e,n){this.setSubscription(e,_h(Aa({},n),{id:e})),this.pending.delete(n.topic)}onBatchSubscribe(e){e.length&&e.forEach(n=>{this.setSubscription(n.id,Aa({},n)),this.pending.delete(n.topic)})}async onUnsubscribe(e,n,r){this.events.removeAllListeners(n),this.hasSubscription(n,e)&&this.deleteSubscription(n,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,n){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:n}),this.addSubscription(e,n)}addSubscription(e,n){this.subscriptions.set(e,Aa({},n)),this.topicMap.set(n.topic,e),this.events.emit(xn.created,n)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const n=this.subscriptions.get(e);if(!n){const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}deleteSubscription(e,n){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:n});const r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(xn.deleted,_h(Aa({},r),{reason:n}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(xn.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],n=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<n;r++){const s=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(xn.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async n=>_h(Aa({},n),{id:await this.getSubscriptionId(n.topic)})))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const n=await this.rpcBatchFetchMessages(e);n&&n.messages&&(await C8(Y.toMiliseconds(Y.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(n.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(e){!this.relayer.connected&&!this.relayer.connecting&&(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return xr(e+await this.getClientId())}}var lM=Object.defineProperty,Sy=Object.getOwnPropertySymbols,uM=Object.prototype.hasOwnProperty,dM=Object.prototype.propertyIsEnumerable,Xf=(t,e,n)=>e in t?lM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ny=(t,e)=>{for(var n in e||(e={}))uM.call(e,n)&&Xf(t,n,e[n]);if(Sy)for(var n of Sy(e))dM.call(e,n)&&Xf(t,n,e[n]);return t},Ue=(t,e,n)=>Xf(t,typeof e!="symbol"?e+"":e,n);class hM extends fP{constructor(e){super(e),Ue(this,"protocol","wc"),Ue(this,"version",2),Ue(this,"core"),Ue(this,"logger"),Ue(this,"events",new Xn.EventEmitter),Ue(this,"provider"),Ue(this,"messages"),Ue(this,"subscriber"),Ue(this,"publisher"),Ue(this,"name",H4),Ue(this,"transportExplicitlyClosed",!1),Ue(this,"initialized",!1),Ue(this,"connectionAttemptInProgress",!1),Ue(this,"relayUrl"),Ue(this,"projectId"),Ue(this,"packageName"),Ue(this,"bundleId"),Ue(this,"hasExperiencedNetworkDisruption",!1),Ue(this,"pingTimeout"),Ue(this,"heartBeatTimeout",Y.toMiliseconds(Y.THIRTY_SECONDS+Y.FIVE_SECONDS)),Ue(this,"reconnectTimeout"),Ue(this,"connectPromise"),Ue(this,"reconnectInProgress",!1),Ue(this,"requestsInFlight",[]),Ue(this,"connectTimeout",Y.toMiliseconds(Y.ONE_SECOND*15)),Ue(this,"request",async n=>{var r,s;this.logger.debug("Publishing Request Payload");const i=n.id||_i().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:n.method,topic:(r=n.params)==null?void 0:r.topic},"relayer.request - publishing...");const o=`${i}:${((s=n.params)==null?void 0:s.tag)||""}`;this.requestsInFlight.push(o);const a=await this.provider.request(n);return this.requestsInFlight=this.requestsInFlight.filter(c=>c!==o),a}catch(o){throw this.logger.debug(`Failed to Publish Request: ${i}`),o}}),Ue(this,"resetPingTimeout",()=>{Su()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var n,r,s,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(i=(s=(r=(n=this.provider)==null?void 0:n.connection)==null?void 0:r.socket)==null?void 0:s.terminate)==null||i.call(s)}catch(o){this.logger.warn(o,o==null?void 0:o.message)}},this.heartBeatTimeout))}),Ue(this,"onPayloadHandler",n=>{this.onProviderPayload(n),this.resetPingTimeout()}),Ue(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected 🛜"),this.startPingTimeout(),this.events.emit(xt.connect)}),Ue(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected 🛑"),this.requestsInFlight=[],this.onProviderDisconnect()}),Ue(this,"onProviderErrorHandler",n=>{this.logger.fatal(`Fatal socket error: ${n.message}`),this.events.emit(xt.error,n),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),Ue(this,"registerProviderListeners",()=>{this.provider.on(Bn.payload,this.onPayloadHandler),this.provider.on(Bn.connect,this.onConnectHandler),this.provider.on(Bn.disconnect,this.onDisconnectHandler),this.provider.on(Bn.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?tn(e.logger,this.name):nl(Ko({level:e.logger||j4})),this.messages=new GL(this.logger,e.core),this.subscriber=new cM(this,this.logger),this.publisher=new QL(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||NC,this.projectId=e.projectId,o8()?this.packageName=m0():a8()&&(this.bundleId=m0()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e==null?void 0:e.message))}get context(){return In(this.logger)}get connected(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===1||!1}get connecting(){var e,n,r;return((r=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null?void 0:r.readyState)===0||this.connectPromise!==void 0||!1}async publish(e,n,r){this.isInitialized(),await this.publisher.publish(e,n,r),await this.recordMessageEvent({topic:e,message:n,publishedAt:Date.now(),transportType:rt.relay},nu.outbound)}async subscribe(e,n){var r,s,i;this.isInitialized(),(!(n!=null&&n.transportType)||(n==null?void 0:n.transportType)==="relay")&&await this.toEstablishConnection();const o=typeof((r=n==null?void 0:n.internal)==null?void 0:r.throwOnFailedPublish)>"u"?!0:(s=n==null?void 0:n.internal)==null?void 0:s.throwOnFailedPublish;let a=((i=this.subscriber.topicMap.get(e))==null?void 0:i[0])||"",c;const l=u=>{u.topic===e&&(this.subscriber.off(xn.created,l),c())};return await Promise.all([new Promise(u=>{c=u,this.subscriber.on(xn.created,l)}),new Promise(async(u,d)=>{a=await this.subscriber.subscribe(e,Ny({internal:{throwOnFailedPublish:o}},n)).catch(h=>{o&&d(h)})||a,u()})]),a}async unsubscribe(e,n){this.isInitialized(),await this.subscriber.unsubscribe(e,n)}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await Ls(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(n,r)=>{await this.connect(e).then(n).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await oy())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const n=e.sort((r,s)=>r.publishedAt-s.publishedAt);this.logger.debug(`Batch of ${n.length} message events sorted`);for(const r of n)try{await this.onMessageEvent(r)}catch(s){this.logger.warn(s,"Error while processing batch message event: "+(s==null?void 0:s.message))}this.logger.trace(`Batch of ${n.length} message events processed`)}async onLinkMessageEvent(e,n){const{topic:r}=e;if(!n.sessionExists){const s=vt(Y.FIVE_MINUTES),i={topic:r,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(r,i)}this.events.emit(xt.message,e),await this.recordMessageEvent(e,nu.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let n=1;for(;n<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${n}...`),await this.createProvider(),await new Promise(async(r,s)=>{const i=()=>{s(new Error("Connection interrupted while trying to connect"))};this.provider.once(Bn.disconnect,i),await Ls(new Promise((o,a)=>{this.provider.connect().then(o).catch(a)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>{s(o)}).finally(()=>{this.provider.off(Bn.disconnect,i),clearTimeout(this.reconnectTimeout)}),await new Promise(async(o,a)=>{const c=()=>{s(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(Bn.disconnect,c),await this.subscriber.start().then(o).catch(a).finally(()=>{this.provider.off(Bn.disconnect,c)})}),this.hasExperiencedNetworkDisruption=!1,r()})}catch(r){await this.subscriber.stop();const s=r;this.logger.warn({},s.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${n}`);break}await new Promise(r=>setTimeout(r,Y.toMiliseconds(n*1))),n++}}startPingTimeout(){var e,n,r,s,i;if(Su())try{(n=(e=this.provider)==null?void 0:e.connection)!=null&&n.socket&&((i=(s=(r=this.provider)==null?void 0:r.connection)==null?void 0:s.socket)==null||i.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(o){this.logger.warn(o,o==null?void 0:o.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Qn(new P4(h8({sdkVersion:Vf,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,n){const{topic:r,message:s}=e;await this.messages.set(r,s,n)}async shouldIgnoreMessageEvent(e){const{topic:n,message:r}=e;if(!r||r.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(n))return this.logger.warn(`Ignoring message for unknown topic ${n}`),!0;const s=this.messages.has(n,r);return s&&this.logger.warn(`Ignoring duplicate message: ${r}`),s}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),wg(e)){if(!e.method.endsWith(q4))return;const n=e.params,{topic:r,message:s,publishedAt:i,attestation:o}=n.data,a={topic:r,message:s,publishedAt:i,transportType:rt.relay,attestation:o};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ny({type:"event",event:n.id},a)),this.events.emit(n.id,a),await this.acknowledgePayload(e),await this.onMessageEvent(a)}else _d(e)&&this.events.emit(xt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,nu.inbound),this.events.emit(xt.message,e))}async acknowledgePayload(e){const n=Ed(e.id,!0);await this.provider.connection.send(n)}unregisterProviderListeners(){this.provider.off(Bn.payload,this.onPayloadHandler),this.provider.off(Bn.connect,this.onConnectHandler),this.provider.off(Bn.disconnect,this.onDisconnectHandler),this.provider.off(Bn.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await oy();Xk(async n=>{e!==n&&(e=n,n?await this.transportOpen().catch(r=>this.logger.error(r,r==null?void 0:r.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(Vi.pulse,async()=>{if(!this.transportExplicitlyClosed&&!this.connected&&t4())try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(n){this.logger.warn(n,n==null?void 0:n.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(xt.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},Y.toMiliseconds(z4)))))}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise){await this.connectPromise;return}await this.connect()}}}function fM(t,e){return t===e||Number.isNaN(t)&&Number.isNaN(e)}function xy(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function Ty(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const pM="[object RegExp]",gM="[object String]",mM="[object Number]",yM="[object Boolean]",Py="[object Arguments]",wM="[object Symbol]",bM="[object Date]",vM="[object Map]",EM="[object Set]",CM="[object Array]",_M="[object Function]",AM="[object ArrayBuffer]",Ah="[object Object]",IM="[object Error]",SM="[object DataView]",NM="[object Uint8Array]",xM="[object Uint8ClampedArray]",TM="[object Uint16Array]",PM="[object Uint32Array]",OM="[object BigUint64Array]",RM="[object Int8Array]",DM="[object Int16Array]",$M="[object Int32Array]",kM="[object BigInt64Array]",UM="[object Float32Array]",LM="[object Float64Array]";function MM(){}function Oy(t){if(!t||typeof t!="object")return!1;const e=Object.getPrototypeOf(t);return e===null||e===Object.prototype||Object.getPrototypeOf(e)===null?Object.prototype.toString.call(t)==="[object Object]":!1}function BM(t,e,n){return $a(t,e,void 0,void 0,void 0,void 0,n)}function $a(t,e,n,r,s,i,o){const a=o(t,e,n,r,s,i);if(a!==void 0)return a;if(typeof t==typeof e)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return t===e;case"number":return t===e||Object.is(t,e);case"function":return t===e;case"object":return Ga(t,e,i,o)}return Ga(t,e,i,o)}function Ga(t,e,n,r){if(Object.is(t,e))return!0;let s=Ty(t),i=Ty(e);if(s===Py&&(s=Ah),i===Py&&(i=Ah),s!==i)return!1;switch(s){case gM:return t.toString()===e.toString();case mM:{const c=t.valueOf(),l=e.valueOf();return fM(c,l)}case yM:case bM:case wM:return Object.is(t.valueOf(),e.valueOf());case pM:return t.source===e.source&&t.flags===e.flags;case _M:return t===e}n=n??new Map;const o=n.get(t),a=n.get(e);if(o!=null&&a!=null)return o===e;n.set(t,e),n.set(e,t);try{switch(s){case vM:{if(t.size!==e.size)return!1;for(const[c,l]of t.entries())if(!e.has(c)||!$a(l,e.get(c),c,t,e,n,r))return!1;return!0}case EM:{if(t.size!==e.size)return!1;const c=Array.from(t.values()),l=Array.from(e.values());for(let u=0;u<c.length;u++){const d=c[u],h=l.findIndex(f=>$a(d,f,void 0,t,e,n,r));if(h===-1)return!1;l.splice(h,1)}return!0}case CM:case NM:case xM:case TM:case PM:case OM:case RM:case DM:case $M:case kM:case UM:case LM:{if(typeof Buffer<"u"&&Buffer.isBuffer(t)!==Buffer.isBuffer(e)||t.length!==e.length)return!1;for(let c=0;c<t.length;c++)if(!$a(t[c],e[c],c,t,e,n,r))return!1;return!0}case AM:return t.byteLength!==e.byteLength?!1:Ga(new Uint8Array(t),new Uint8Array(e),n,r);case SM:return t.byteLength!==e.byteLength||t.byteOffset!==e.byteOffset?!1:Ga(new Uint8Array(t),new Uint8Array(e),n,r);case IM:return t.name===e.name&&t.message===e.message;case Ah:{if(!(Ga(t.constructor,e.constructor,n,r)||Oy(t)&&Oy(e)))return!1;const c=[...Object.keys(t),...xy(t)],l=[...Object.keys(e),...xy(e)];if(c.length!==l.length)return!1;for(let u=0;u<c.length;u++){const d=c[u],h=t[d];if(!Object.hasOwn(e,d))return!1;const f=e[d];if(!$a(h,f,d,t,e,n,r))return!1}return!0}default:return!1}}finally{n.delete(t),n.delete(e)}}function FM(t,e){return BM(t,e,MM)}var jM=Object.defineProperty,Ry=Object.getOwnPropertySymbols,HM=Object.prototype.hasOwnProperty,qM=Object.prototype.propertyIsEnumerable,Qf=(t,e,n)=>e in t?jM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Dy=(t,e)=>{for(var n in e||(e={}))HM.call(e,n)&&Qf(t,n,e[n]);if(Ry)for(var n of Ry(e))qM.call(e,n)&&Qf(t,n,e[n]);return t},hn=(t,e,n)=>Qf(t,typeof e!="symbol"?e+"":e,n);class Yi extends pP{constructor(e,n,r,s=Br,i=void 0){super(e,n,r,s),this.core=e,this.logger=n,this.name=r,hn(this,"map",new Map),hn(this,"version",W4),hn(this,"cached",[]),hn(this,"initialized",!1),hn(this,"getKey"),hn(this,"storagePrefix",Br),hn(this,"recentlyDeleted",[]),hn(this,"recentlyDeletedLimit",200),hn(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(o=>{this.getKey&&o!==null&&!Mt(o)?this.map.set(this.getKey(o),o):Tk(o)?this.map.set(o.id,o):Pk(o)&&this.map.set(o.topic,o)}),this.cached=[],this.initialized=!0)}),hn(this,"set",async(o,a)=>{this.isInitialized(),this.map.has(o)?await this.update(o,a):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:o,value:a}),this.map.set(o,a),await this.persist())}),hn(this,"get",o=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:o}),this.getData(o))),hn(this,"getAll",o=>(this.isInitialized(),o?this.values.filter(a=>Object.keys(o).every(c=>FM(a[c],o[c]))):this.values)),hn(this,"update",async(o,a)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:o,update:a});const c=Dy(Dy({},this.getData(o)),a);this.map.set(o,c),await this.persist()}),hn(this,"delete",async(o,a)=>{this.isInitialized(),this.map.has(o)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:o,reason:a}),this.map.delete(o),this.addToRecentlyDeleted(o),await this.persist())}),this.logger=tn(n,this.name),this.storagePrefix=s,this.getKey=i}get context(){return In(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const n=this.map.get(e);if(!n){if(this.recentlyDeleted.includes(e)){const{message:s}=Z("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(r),new Error(r)}return n}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var zM=Object.defineProperty,WM=(t,e,n)=>e in t?zM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Te=(t,e,n)=>WM(t,typeof e!="symbol"?e+"":e,n);class VM{constructor(e,n){this.core=e,this.logger=n,Te(this,"name",Y4),Te(this,"version",Z4),Te(this,"events",new jp),Te(this,"pairings"),Te(this,"initialized",!1),Te(this,"storagePrefix",Br),Te(this,"ignoredPayloadTypes",[os]),Te(this,"registeredMethods",[]),Te(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),Te(this,"register",({methods:r})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...r])]}),Te(this,"create",async r=>{this.isInitialized();const s=qf(),i=await this.core.crypto.setSymKey(s),o=vt(Y.FIVE_MINUTES),a={protocol:SC},c={topic:i,expiry:o,relay:a,active:!1,methods:r==null?void 0:r.methods},l=J0({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:s,relay:a,expiryTimestamp:o,methods:r==null?void 0:r.methods});return this.events.emit(pi.create,c),this.core.expirer.set(i,o),await this.pairings.set(i,c),await this.core.relayer.subscribe(i,{transportType:r==null?void 0:r.transportType}),{topic:i,uri:l}}),Te(this,"pair",async r=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:r==null?void 0:r.uri,trace:[_r.pairing_started]}});this.isValidPair(r,s);const{topic:i,symKey:o,relay:a,expiryTimestamp:c,methods:l}=Z0(r.uri);s.props.properties.topic=i,s.addTrace(_r.pairing_uri_validation_success),s.addTrace(_r.pairing_uri_not_expired);let u;if(this.pairings.keys.includes(i)){if(u=this.pairings.get(i),s.addTrace(_r.existing_pairing),u.active)throw s.setError(Qr.active_pairing_already_exists),new Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);s.addTrace(_r.pairing_not_expired)}const d=c||vt(Y.FIVE_MINUTES),h={topic:i,relay:a,expiry:d,active:!1,methods:l};this.core.expirer.set(i,d),await this.pairings.set(i,h),s.addTrace(_r.store_new_pairing),r.activatePairing&&await this.activate({topic:i}),this.events.emit(pi.create,h),s.addTrace(_r.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(o,i),s.addTrace(_r.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Qr.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:a})}catch(f){throw s.setError(Qr.subscribe_pairing_topic_failure),f}return s.addTrace(_r.subscribe_pairing_topic_success),h}),Te(this,"activate",async({topic:r})=>{this.isInitialized();const s=vt(Y.FIVE_MINUTES);this.core.expirer.set(r,s),await this.pairings.update(r,{active:!0,expiry:s})}),Te(this,"ping",async r=>{this.isInitialized(),await this.isValidPing(r),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:s}=r;if(this.pairings.keys.includes(s)){const i=await this.sendRequest(s,"wc_pairingPing",{}),{done:o,resolve:a,reject:c}=hi();this.events.once(ze("pairing_ping",i),({error:l})=>{l?c(l):a()}),await o()}}),Te(this,"updateExpiry",async({topic:r,expiry:s})=>{this.isInitialized(),await this.pairings.update(r,{expiry:s})}),Te(this,"updateMetadata",async({topic:r,metadata:s})=>{this.isInitialized(),await this.pairings.update(r,{peerMetadata:s})}),Te(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),Te(this,"disconnect",async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:s}=r;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",ct("USER_DISCONNECTED")),await this.deletePairing(s))}),Te(this,"formatUriFromPairing",r=>{this.isInitialized();const{topic:s,relay:i,expiry:o,methods:a}=r,c=this.core.crypto.keychain.get(s);return J0({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:c,relay:i,expiryTimestamp:o,methods:a})}),Te(this,"sendRequest",async(r,s,i)=>{const o=Ms(s,i),a=await this.core.crypto.encode(r,o),c=Ca[s].req;return this.core.history.set(r,o),this.core.relayer.publish(r,a,c),o.id}),Te(this,"sendResult",async(r,s,i)=>{const o=Ed(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Ca[c].res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Te(this,"sendError",async(r,s,i)=>{const o=Cd(r,i),a=await this.core.crypto.encode(s,o),c=(await this.core.history.get(s,r)).request.method,l=Ca[c]?Ca[c].res:Ca.unregistered_method.res;await this.core.relayer.publish(s,a,l),await this.core.history.resolve(o)}),Te(this,"deletePairing",async(r,s)=>{await this.core.relayer.unsubscribe(r),await Promise.all([this.pairings.delete(r,ct("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(r),s?Promise.resolve():this.core.expirer.del(r)])}),Te(this,"cleanup",async()=>{const r=this.pairings.getAll().filter(s=>Ts(s.expiry));await Promise.all(r.map(s=>this.deletePairing(s.topic)))}),Te(this,"onRelayEventRequest",async r=>{const{topic:s,payload:i}=r;switch(i.method){case"wc_pairingPing":return await this.onPairingPingRequest(s,i);case"wc_pairingDelete":return await this.onPairingDeleteRequest(s,i);default:return await this.onUnknownRpcMethodRequest(s,i)}}),Te(this,"onRelayEventResponse",async r=>{const{topic:s,payload:i}=r,o=(await this.core.history.get(s,i.id)).request.method;switch(o){case"wc_pairingPing":return this.onPairingPingResponse(s,i);default:return this.onUnknownRpcMethodResponse(o)}}),Te(this,"onPairingPingRequest",async(r,s)=>{const{id:i}=s;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.events.emit(pi.ping,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Te(this,"onPairingPingResponse",(r,s)=>{const{id:i}=s;setTimeout(()=>{Ir(s)?this.events.emit(ze("pairing_ping",i),{}):qn(s)&&this.events.emit(ze("pairing_ping",i),{error:s.error})},500)}),Te(this,"onPairingDeleteRequest",async(r,s)=>{const{id:i}=s;try{this.isValidDisconnect({topic:r}),await this.deletePairing(r),this.events.emit(pi.delete,{id:i,topic:r})}catch(o){await this.sendError(i,r,o),this.logger.error(o)}}),Te(this,"onUnknownRpcMethodRequest",async(r,s)=>{const{id:i,method:o}=s;try{if(this.registeredMethods.includes(o))return;const a=ct("WC_METHOD_UNSUPPORTED",o);await this.sendError(i,r,a),this.logger.error(a)}catch(a){await this.sendError(i,r,a),this.logger.error(a)}}),Te(this,"onUnknownRpcMethodResponse",r=>{this.registeredMethods.includes(r)||this.logger.error(ct("WC_METHOD_UNSUPPORTED",r))}),Te(this,"isValidPair",(r,s)=>{var i;if(!mn(r)){const{message:a}=Z("MISSING_OR_INVALID",`pair() params: ${r}`);throw s.setError(Qr.malformed_pairing_uri),new Error(a)}if(!xk(r.uri)){const{message:a}=Z("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw s.setError(Qr.malformed_pairing_uri),new Error(a)}const o=Z0(r==null?void 0:r.uri);if(!((i=o==null?void 0:o.relay)!=null&&i.protocol)){const{message:a}=Z("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Qr.malformed_pairing_uri),new Error(a)}if(!(o!=null&&o.symKey)){const{message:a}=Z("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Qr.malformed_pairing_uri),new Error(a)}if(o!=null&&o.expiryTimestamp&&Y.toMiliseconds(o==null?void 0:o.expiryTimestamp)<Date.now()){s.setError(Qr.pairing_expired);const{message:a}=Z("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(a)}}),Te(this,"isValidPing",async r=>{if(!mn(r)){const{message:i}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Te(this,"isValidDisconnect",async r=>{if(!mn(r)){const{message:i}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:s}=r;await this.isValidPairingTopic(s)}),Te(this,"isValidPairingTopic",async r=>{if(!yt(r,!1)){const{message:s}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(s)}if(!this.pairings.keys.includes(r)){const{message:s}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(s)}if(Ts(this.pairings.get(r).expiry)){await this.deletePairing(r);const{message:s}=Z("EXPIRED",`pairing topic: ${r}`);throw new Error(s)}}),this.core=e,this.logger=tn(n,this.name),this.pairings=new Yi(this.core,this.logger,this.name,this.storagePrefix)}get context(){return In(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(xt.message,async e=>{const{topic:n,message:r,transportType:s}=e;if(this.pairings.keys.includes(n)&&s!==rt.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{const i=await this.core.crypto.decode(n,r);wg(i)?(this.core.history.set(n,i),await this.onRelayEventRequest({topic:n,payload:i})):_d(i)&&(await this.core.history.resolve(i),await this.onRelayEventResponse({topic:n,payload:i}),this.core.history.delete(n,i.id)),await this.core.relayer.messages.ack(n,r)}catch(i){this.logger.error(i)}})}registerExpirerEvents(){this.core.expirer.on(Hn.expired,async e=>{const{topic:n}=IE(e.target);n&&this.pairings.keys.includes(n)&&(await this.deletePairing(n,!0),this.events.emit(pi.expire,{topic:n}))})}}var GM=Object.defineProperty,KM=(t,e,n)=>e in t?GM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ut=(t,e,n)=>KM(t,typeof e!="symbol"?e+"":e,n);class YM extends uP{constructor(e,n){super(e,n),this.core=e,this.logger=n,Ut(this,"records",new Map),Ut(this,"events",new Xn.EventEmitter),Ut(this,"name",J4),Ut(this,"version",X4),Ut(this,"cached",[]),Ut(this,"initialized",!1),Ut(this,"storagePrefix",Br),Ut(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.records.set(r.id,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ut(this,"set",(r,s,i)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:r,request:s,chainId:i}),this.records.has(s.id))return;const o={id:s.id,topic:r,request:{method:s.method,params:s.params||null},chainId:i,expiry:vt(Y.THIRTY_DAYS)};this.records.set(o.id,o),this.persist(),this.events.emit(nr.created,o)}),Ut(this,"resolve",async r=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:r}),!this.records.has(r.id))return;const s=await this.getRecord(r.id);typeof s.response>"u"&&(s.response=qn(r)?{error:r.error}:{result:r.result},this.records.set(s.id,s),this.persist(),this.events.emit(nr.updated,s))}),Ut(this,"get",async(r,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:r,id:s}),await this.getRecord(s))),Ut(this,"delete",(r,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(i=>{if(i.topic===r){if(typeof s<"u"&&i.id!==s)return;this.records.delete(i.id),this.events.emit(nr.deleted,i)}}),this.persist()}),Ut(this,"exists",async(r,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===r:!1)),Ut(this,"on",(r,s)=>{this.events.on(r,s)}),Ut(this,"once",(r,s)=>{this.events.once(r,s)}),Ut(this,"off",(r,s)=>{this.events.off(r,s)}),Ut(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=tn(n,this.name)}get context(){return In(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(n=>{if(typeof n.response<"u")return;const r={topic:n.topic,request:Ms(n.request.method,n.request.params,n.id),chainId:n.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const n=this.records.get(e);if(!n){const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(r)}return n}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(nr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(nr.created,e=>{const n=nr.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(nr.updated,e=>{const n=nr.updated;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.events.on(nr.deleted,e=>{const n=nr.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,record:e})}),this.core.heartbeat.on(Vi.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(n=>{Y.toMiliseconds(n.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${n.id}`),this.records.delete(n.id),this.events.emit(nr.deleted,n,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var ZM=Object.defineProperty,JM=(t,e,n)=>e in t?ZM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Jt=(t,e,n)=>JM(t,typeof e!="symbol"?e+"":e,n);class XM extends mP{constructor(e,n){super(e,n),this.core=e,this.logger=n,Jt(this,"expirations",new Map),Jt(this,"events",new Xn.EventEmitter),Jt(this,"name",Q4),Jt(this,"version",eU),Jt(this,"cached",[]),Jt(this,"initialized",!1),Jt(this,"storagePrefix",Br),Jt(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(r=>this.expirations.set(r.target,r)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Jt(this,"has",r=>{try{const s=this.formatTarget(r);return typeof this.getExpiration(s)<"u"}catch{return!1}}),Jt(this,"set",(r,s)=>{this.isInitialized();const i=this.formatTarget(r),o={target:i,expiry:s};this.expirations.set(i,o),this.checkExpiry(i,o),this.events.emit(Hn.created,{target:i,expiration:o})}),Jt(this,"get",r=>{this.isInitialized();const s=this.formatTarget(r);return this.getExpiration(s)}),Jt(this,"del",r=>{if(this.isInitialized(),this.has(r)){const s=this.formatTarget(r),i=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Hn.deleted,{target:s,expiration:i})}}),Jt(this,"on",(r,s)=>{this.events.on(r,s)}),Jt(this,"once",(r,s)=>{this.events.once(r,s)}),Jt(this,"off",(r,s)=>{this.events.off(r,s)}),Jt(this,"removeListener",(r,s)=>{this.events.removeListener(r,s)}),this.logger=tn(n,this.name)}get context(){return In(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return f8(e);if(typeof e=="number")return p8(e);const{message:n}=Z("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(n)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Hn.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:n}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(n),new Error(n)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const n=this.expirations.get(e);if(!n){const{message:r}=Z("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(r),new Error(r)}return n}checkExpiry(e,n){const{expiry:r}=n;Y.toMiliseconds(r)-Date.now()<=0&&this.expire(e,n)}expire(e,n){this.expirations.delete(e),this.events.emit(Hn.expired,{target:e,expiration:n})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,n)=>this.checkExpiry(n,e))}registerEventListeners(){this.core.heartbeat.on(Vi.pulse,()=>this.checkExpirations()),this.events.on(Hn.created,e=>{const n=Hn.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Hn.expired,e=>{const n=Hn.expired;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()}),this.events.on(Hn.deleted,e=>{const n=Hn.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}}var QM=Object.defineProperty,eB=(t,e,n)=>e in t?QM(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,gt=(t,e,n)=>eB(t,typeof e!="symbol"?e+"":e,n);class tB extends yP{constructor(e,n,r){super(e,n,r),this.core=e,this.logger=n,this.store=r,gt(this,"name",tU),gt(this,"abortController"),gt(this,"isDevEnv"),gt(this,"verifyUrlV3",rU),gt(this,"storagePrefix",Br),gt(this,"version",IC),gt(this,"publicKey"),gt(this,"fetchPromise"),gt(this,"init",async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&Y.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),gt(this,"register",async s=>{if(!ea()||this.isDevEnv)return;const i=window.location.origin,{id:o,decryptedId:a}=s,c=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${i}&id=${o}&decryptedId=${a}`;try{const l=ki(),u=this.startAbortTimer(Y.ONE_SECOND*5),d=await new Promise((h,f)=>{const p=()=>{window.removeEventListener("message",m),l.body.removeChild(g),f("attestation aborted")};this.abortController.signal.addEventListener("abort",p);const g=l.createElement("iframe");g.src=c,g.style.display="none",g.addEventListener("error",p,{signal:this.abortController.signal});const m=v=>{if(v.data&&typeof v.data=="string")try{const b=JSON.parse(v.data);if(b.type==="verify_attestation"){if(If(b.attestation).payload.id!==o)return;clearInterval(u),l.body.removeChild(g),this.abortController.signal.removeEventListener("abort",p),window.removeEventListener("message",m),h(b.attestation===null?"":b.attestation)}}catch(b){this.logger.warn(b)}};l.body.appendChild(g),window.addEventListener("message",m,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",d),d}catch(l){this.logger.warn(l)}return""}),gt(this,"resolve",async s=>{if(this.isDevEnv)return"";const{attestationId:i,hash:o,encryptedId:a}=s;if(i===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(i){if(If(i).payload.id!==a)return;const l=await this.isValidJwtAttestation(i);if(l){if(!l.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return l}}if(!o)return;const c=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(o,c)}),gt(this,"fetchAttestation",async(s,i)=>{this.logger.debug(`resolving attestation: ${s} from url: ${i}`);const o=this.startAbortTimer(Y.ONE_SECOND*5),a=await fetch(`${i}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(o),a.status===200?await a.json():void 0}),gt(this,"getVerifyUrl",s=>{let i=s||Va;return sU.includes(i)||(this.logger.info(`verify url: ${i}, not included in trusted list, assigning default: ${Va}`),i=Va),i}),gt(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(Y.FIVE_SECONDS),i=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await i.json()}catch(s){this.logger.warn(s)}}),gt(this,"persistPublicKey",async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s}),gt(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),gt(this,"isValidJwtAttestation",async s=>{const i=await this.getPublicKey();try{if(i)return this.validateAttestation(s,i)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}const o=await this.fetchAndPersistPublicKey();try{if(o)return this.validateAttestation(s,o)}catch(a){this.logger.error(a),this.logger.warn("error validating attestation")}}),gt(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),gt(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async i=>{const o=await this.fetchPublicKey();o&&(await this.persistPublicKey(o),i(o))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s}),gt(this,"validateAttestation",(s,i)=>{const o=ak(s,i.publicKey),a={hasExpired:Y.toMiliseconds(o.exp)<Date.now(),payload:o};if(a.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:a.payload.origin,isScam:a.payload.isScam,isVerified:a.payload.isVerified}}),this.logger=tn(n,this.name),this.abortController=new AbortController,this.isDevEnv=rg(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return In(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),Y.toMiliseconds(e))}}var nB=Object.defineProperty,rB=(t,e,n)=>e in t?nB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$y=(t,e,n)=>rB(t,typeof e!="symbol"?e+"":e,n);class sB extends wP{constructor(e,n){super(e,n),this.projectId=e,this.logger=n,$y(this,"context",iU),$y(this,"registerDeviceToken",async r=>{const{clientId:s,token:i,notificationType:o,enableEncrypted:a=!1}=r,c=`${oU}/${this.projectId}/clients`;await fetch(c,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:o,token:i,always_raw:a})})}),this.logger=tn(n,this.context)}}var iB=Object.defineProperty,ky=Object.getOwnPropertySymbols,oB=Object.prototype.hasOwnProperty,aB=Object.prototype.propertyIsEnumerable,ep=(t,e,n)=>e in t?iB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ia=(t,e)=>{for(var n in e||(e={}))oB.call(e,n)&&ep(t,n,e[n]);if(ky)for(var n of ky(e))aB.call(e,n)&&ep(t,n,e[n]);return t},It=(t,e,n)=>ep(t,typeof e!="symbol"?e+"":e,n);class cB extends bP{constructor(e,n,r=!0){super(e,n,r),this.core=e,this.logger=n,It(this,"context",cU),It(this,"storagePrefix",Br),It(this,"storageVersion",aU),It(this,"events",new Map),It(this,"shouldPersist",!1),It(this,"init",async()=>{if(!rg())try{const s={eventId:w0(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:_E(this.core.relayer.protocol,this.core.relayer.version,Vf)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}}),It(this,"createEvent",s=>{const{event:i="ERROR",type:o="",properties:{topic:a,trace:c}}=s,l=w0(),u=this.core.projectId||"",d=Date.now(),h=Ia({eventId:l,timestamp:d,props:{event:i,type:o,properties:{topic:a,trace:c}},bundleId:u,domain:this.getAppDomain()},this.setMethods(l));return this.telemetryEnabled&&(this.events.set(l,h),this.shouldPersist=!0),h}),It(this,"getEvent",s=>{const{eventId:i,topic:o}=s;if(i)return this.events.get(i);const a=Array.from(this.events.values()).find(c=>c.props.properties.topic===o);if(a)return Ia(Ia({},a),this.setMethods(a.eventId))}),It(this,"deleteEvent",s=>{const{eventId:i}=s;this.events.delete(i),this.shouldPersist=!0}),It(this,"setEventListeners",()=>{this.core.heartbeat.on(Vi.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{Y.fromMiliseconds(Date.now())-Y.fromMiliseconds(s.timestamp)>lU&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})}),It(this,"setMethods",s=>({addTrace:i=>this.addTrace(s,i),setError:i=>this.setError(s,i)})),It(this,"addTrace",(s,i)=>{const o=this.events.get(s);o&&(o.props.properties.trace.push(i),this.events.set(s,o),this.shouldPersist=!0)}),It(this,"setError",(s,i)=>{const o=this.events.get(s);o&&(o.props.type=i,o.timestamp=Date.now(),this.events.set(s,o),this.shouldPersist=!0)}),It(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),It(this,"restore",async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(i=>{this.events.set(i.eventId,Ia(Ia({},i),this.setMethods(i.eventId)))})}catch(s){this.logger.warn(s)}}),It(this,"submit",async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[i,o]of this.events)o.props.type&&s.push(o);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const i of s)this.events.delete(i.eventId),this.shouldPersist=!0}catch(i){this.logger.warn(i)}}),It(this,"sendEvent",async s=>{const i=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${uU}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Vf}${i}`,{method:"POST",body:JSON.stringify(s)})}),It(this,"getAppDomain",()=>CE().url),this.logger=tn(n,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var lB=Object.defineProperty,Uy=Object.getOwnPropertySymbols,uB=Object.prototype.hasOwnProperty,dB=Object.prototype.propertyIsEnumerable,tp=(t,e,n)=>e in t?lB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ly=(t,e)=>{for(var n in e||(e={}))uB.call(e,n)&&tp(t,n,e[n]);if(Uy)for(var n of Uy(e))dB.call(e,n)&&tp(t,n,e[n]);return t},Qe=(t,e,n)=>tp(t,typeof e!="symbol"?e+"":e,n);let hB=class FC extends oP{constructor(e){var n;super(e),Qe(this,"protocol",AC),Qe(this,"version",IC),Qe(this,"name",Wf),Qe(this,"relayUrl"),Qe(this,"projectId"),Qe(this,"customStoragePrefix"),Qe(this,"events",new Xn.EventEmitter),Qe(this,"logger"),Qe(this,"heartbeat"),Qe(this,"relayer"),Qe(this,"crypto"),Qe(this,"storage"),Qe(this,"history"),Qe(this,"expirer"),Qe(this,"pairing"),Qe(this,"verify"),Qe(this,"echoClient"),Qe(this,"linkModeSupportedApps"),Qe(this,"eventClient"),Qe(this,"initialized",!1),Qe(this,"logChunkController"),Qe(this,"on",(a,c)=>this.events.on(a,c)),Qe(this,"once",(a,c)=>this.events.once(a,c)),Qe(this,"off",(a,c)=>this.events.off(a,c)),Qe(this,"removeListener",(a,c)=>this.events.removeListener(a,c)),Qe(this,"dispatchEnvelope",({topic:a,message:c,sessionExists:l})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:rt.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:l})});const r=this.getGlobalCore(e==null?void 0:e.customStoragePrefix);if(r)try{return this.customStoragePrefix=r.customStoragePrefix,this.logger=r.logger,this.heartbeat=r.heartbeat,this.crypto=r.crypto,this.history=r.history,this.expirer=r.expirer,this.storage=r.storage,this.relayer=r.relayer,this.pairing=r.pairing,this.verify=r.verify,this.echoClient=r.echoClient,this.linkModeSupportedApps=r.linkModeSupportedApps,this.eventClient=r.eventClient,this.initialized=r.initialized,this.logChunkController=r.logChunkController,r}catch(a){console.warn("Failed to copy global core",a)}this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||NC,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const s=Ko({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:R4.logger,name:Wf}),{logger:i,chunkLoggerController:o}=qp({opts:s,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=o,(n=this.logChunkController)!=null&&n.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=tn(i,this.name),this.heartbeat=new Kx,this.crypto=new BL(this,this.logger,e==null?void 0:e.keychain),this.history=new YM(this,this.logger),this.expirer=new XM(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new PT(Ly(Ly({},D4),e==null?void 0:e.storageOptions)),this.relayer=new hM({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new VM(this,this.logger),this.verify=new tB(this,this.logger,this.storage),this.echoClient=new sB(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new cB(this,this.logger,e==null?void 0:e.telemetryEnabled),this.setGlobalCore(this)}static async init(e){const n=new FC(e);await n.initialize();const r=await n.crypto.getClientId();return await n.storage.setItem(V4,r),n}get context(){return In(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(my,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(my)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;const n=`_walletConnectCore_${e}`,r=`${n}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[n]}catch(n){console.warn("Failed to get global WalletConnect core",n);return}}setGlobalCore(e){var n;try{if(this.isGlobalCoreDisabled())return;const r=`_walletConnectCore_${((n=e.opts)==null?void 0:n.customStoragePrefix)||""}`;globalThis[r]=e}catch(r){console.warn("Failed to set global WalletConnect core",r)}}isGlobalCoreDisabled(){try{return typeof process<"u"&&O4.DISABLE_GLOBAL_CORE==="true"}catch{return!0}}};const fB=hB,jC="wc",HC=2,qC="client",bg=`${jC}@${HC}:${qC}:`,Ih={name:qC,logger:"error"},My="WALLETCONNECT_DEEPLINK_CHOICE",pB="proposal",By="Proposal expired",gB="session",oo=Y.SEVEN_DAYS,mB="engine",St={wc_sessionPropose:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Y.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Y.ONE_DAY,prompt:!1,tag:1114},res:{ttl:Y.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:Y.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:Y.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:Y.FIVE_MINUTES,prompt:!1,tag:1119}}},Sh={min:Y.FIVE_MINUTES,max:Y.SEVEN_DAYS},Cr={idle:"IDLE",active:"ACTIVE"},yB={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},wB="request",bB=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],vB="wc",EB="auth",CB="authKeys",_B="pairingTopics",AB="requests",Id=`${vB}@${1.5}:${EB}:`,ru=`${Id}:PUB_KEY`;var IB=Object.defineProperty,SB=Object.defineProperties,NB=Object.getOwnPropertyDescriptors,Fy=Object.getOwnPropertySymbols,xB=Object.prototype.hasOwnProperty,TB=Object.prototype.propertyIsEnumerable,np=(t,e,n)=>e in t?IB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,nt=(t,e)=>{for(var n in e||(e={}))xB.call(e,n)&&np(t,n,e[n]);if(Fy)for(var n of Fy(e))TB.call(e,n)&&np(t,n,e[n]);return t},fn=(t,e)=>SB(t,NB(e)),q=(t,e,n)=>np(t,typeof e!="symbol"?e+"":e,n);class PB extends _P{constructor(e){super(e),q(this,"name",mB),q(this,"events",new jp),q(this,"initialized",!1),q(this,"requestQueue",{state:Cr.idle,queue:[]}),q(this,"sessionRequestQueue",{state:Cr.idle,queue:[]}),q(this,"requestQueueDelay",Y.ONE_SECOND),q(this,"expectedPairingMethodMap",new Map),q(this,"recentlyDeletedMap",new Map),q(this,"recentlyDeletedLimit",200),q(this,"relayMessageCache",[]),q(this,"pendingSessions",new Map),q(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(St)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},Y.toMiliseconds(this.requestQueueDelay)))}),q(this,"connect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const r=fn(nt({},n),{requiredNamespaces:n.requiredNamespaces||{},optionalNamespaces:n.optionalNamespaces||{}});await this.isValidConnect(r),r.optionalNamespaces=_k(r.requiredNamespaces,r.optionalNamespaces),r.requiredNamespaces={};const{pairingTopic:s,requiredNamespaces:i,optionalNamespaces:o,sessionProperties:a,scopedProperties:c,relays:l}=r;let u=s,d,h=!1;try{if(u){const T=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=T.active}}catch(T){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),T}if(!u||!h){const{topic:T,uri:x}=await this.client.core.pairing.create();u=T,d=x}if(!u){const{message:T}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(T)}const f=await this.client.core.crypto.generateKeyPair(),p=St.wc_sessionPropose.req.ttl||Y.FIVE_MINUTES,g=vt(p),m=fn(nt(nt({requiredNamespaces:i,optionalNamespaces:o,relays:l??[{protocol:SC}],proposer:{publicKey:f,metadata:this.client.metadata},expiryTimestamp:g,pairingTopic:u},a&&{sessionProperties:a}),c&&{scopedProperties:c}),{id:Ar()}),v=ze("session_connect",m.id),{reject:b,resolve:y,done:N}=hi(p,By),_=({id:T})=>{T===m.id&&(this.client.events.off("proposal_expire",_),this.pendingSessions.delete(m.id),this.events.emit(v,{error:{message:By,code:0}}))};return this.client.events.on("proposal_expire",_),this.events.once(v,({error:T,session:x})=>{this.client.events.off("proposal_expire",_),T?b(T):x&&y(x)}),await this.sendRequest({topic:u,method:"wc_sessionPropose",params:m,throwOnFailedPublish:!0,clientRpcId:m.id}),await this.setProposal(m.id,m),{uri:d,approval:N}}),q(this,"pair",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(n)}catch(r){throw this.client.logger.error("pair() failed"),r}}),q(this,"approve",async n=>{var r,s,i;const o=this.client.core.eventClient.createEvent({properties:{topic:(r=n==null?void 0:n.id)==null?void 0:r.toString(),trace:[rr.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(I){throw o.setError(ai.no_internet_connection),I}try{await this.isValidProposalId(n==null?void 0:n.id)}catch(I){throw this.client.logger.error(`approve() -> proposal.get(${n==null?void 0:n.id}) failed`),o.setError(ai.proposal_not_found),I}try{await this.isValidApprove(n)}catch(I){throw this.client.logger.error("approve() -> isValidApprove() failed"),o.setError(ai.session_approve_namespace_validation_failure),I}const{id:a,relayProtocol:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=n,f=this.client.proposal.get(a);this.client.core.eventClient.deleteEvent({eventId:o.eventId});const{pairingTopic:p,proposer:g,requiredNamespaces:m,optionalNamespaces:v}=f;let b=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:p});b||(b=(i=this.client.core.eventClient)==null?void 0:i.createEvent({type:rr.session_approve_started,properties:{topic:p,trace:[rr.session_approve_started,rr.session_namespaces_validation_success]}}));const y=await this.client.core.crypto.generateKeyPair(),N=g.publicKey,_=await this.client.core.crypto.generateSharedKey(y,N),T=nt(nt(nt({relay:{protocol:c??"irn"},namespaces:l,controller:{publicKey:y,metadata:this.client.metadata},expiry:vt(oo)},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),x=rt.relay;b.addTrace(rr.subscribing_session_topic);try{await this.client.core.relayer.subscribe(_,{transportType:x})}catch(I){throw b.setError(ai.subscribe_session_topic_failure),I}b.addTrace(rr.subscribe_session_topic_success);const D=fn(nt({},T),{topic:_,requiredNamespaces:m,optionalNamespaces:v,pairingTopic:p,acknowledged:!1,self:T.controller,peer:{publicKey:g.publicKey,metadata:g.metadata},controller:y,transportType:rt.relay});await this.client.session.set(_,D),b.addTrace(rr.store_session);try{b.addTrace(rr.publishing_session_settle),await this.sendRequest({topic:_,method:"wc_sessionSettle",params:T,throwOnFailedPublish:!0}).catch(I=>{throw b==null||b.setError(ai.session_settle_publish_failure),I}),b.addTrace(rr.session_settle_publish_success),b.addTrace(rr.publishing_session_approve),await this.sendResult({id:a,topic:p,result:{relay:{protocol:c??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch(I=>{throw b==null||b.setError(ai.session_approve_publish_failure),I}),b.addTrace(rr.session_approve_publish_success)}catch(I){throw this.client.logger.error(I),this.client.session.delete(_,ct("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(_),I}return this.client.core.eventClient.deleteEvent({eventId:b.eventId}),await this.client.core.pairing.updateMetadata({topic:p,metadata:g.metadata}),await this.deleteProposal(a),await this.client.core.pairing.activate({topic:p}),await this.setExpiry(_,vt(oo)),{topic:_,acknowledged:()=>Promise.resolve(this.client.session.get(_))}}),q(this,"reject",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(n)}catch(o){throw this.client.logger.error("reject() -> isValidReject() failed"),o}const{id:r,reason:s}=n;let i;try{i=this.client.proposal.get(r).pairingTopic}catch(o){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),o}i&&await this.sendError({id:r,topic:i,error:s,rpcOpts:St.wc_sessionPropose.reject}),await this.deleteProposal(r)}),q(this,"update",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(n)}catch(d){throw this.client.logger.error("update() -> isValidUpdate() failed"),d}const{topic:r,namespaces:s}=n,{done:i,resolve:o,reject:a}=hi(),c=Ar(),l=_i().toString(),u=this.client.session.get(r).namespaces;return this.events.once(ze("session_update",c),({error:d})=>{d?a(d):o()}),await this.client.session.update(r,{namespaces:s}),await this.sendRequest({topic:r,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:c,relayRpcId:l}).catch(d=>{this.client.logger.error(d),this.client.session.update(r,{namespaces:u}),a(d)}),{acknowledged:i}}),q(this,"extend",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(n)}catch(c){throw this.client.logger.error("extend() -> isValidExtend() failed"),c}const{topic:r}=n,s=Ar(),{done:i,resolve:o,reject:a}=hi();return this.events.once(ze("session_extend",s),({error:c})=>{c?a(c):o()}),await this.setExpiry(r,vt(oo)),this.sendRequest({topic:r,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(c=>{a(c)}),{acknowledged:i}}),q(this,"request",async n=>{this.isInitialized();try{await this.isValidRequest(n)}catch(m){throw this.client.logger.error("request() -> isValidRequest() failed"),m}const{chainId:r,request:s,topic:i,expiry:o=St.wc_sessionRequest.req.ttl}=n,a=this.client.session.get(i);(a==null?void 0:a.transportType)===rt.relay&&await this.confirmOnlineStateOrThrow();const c=Ar(),l=_i().toString(),{done:u,resolve:d,reject:h}=hi(o,"Request expired. Please try again.");this.events.once(ze("session_request",c),({error:m,result:v})=>{m?h(m):d(v)});const f="wc_sessionRequest",p=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);if(p)return await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:{request:fn(nt({},s),{expiryTimestamp:vt(o)}),chainId:r},expiry:o,throwOnFailedPublish:!0,appLink:p}).catch(m=>h(m)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),await u();const g={request:fn(nt({},s),{expiryTimestamp:vt(o)}),chainId:r};return await Promise.all([new Promise(async m=>{await this.sendRequest({clientRpcId:c,relayRpcId:l,topic:i,method:f,params:g,expiry:o,throwOnFailedPublish:!0,tvf:this.getTVFParams(c,g)}).catch(v=>h(v)),this.client.events.emit("session_request_sent",{topic:i,request:s,chainId:r,id:c}),m()}),new Promise(async m=>{var v;if(!((v=a.sessionConfig)!=null&&v.disableDeepLink)){const b=await w8(this.client.core.storage,My);await g8({id:c,topic:i,wcDeepLink:b})}m()}),u()]).then(m=>m[2])}),q(this,"respond",async n=>{this.isInitialized(),await this.isValidRespond(n);const{topic:r,response:s}=n,{id:i}=s,o=this.client.session.get(r);o.transportType===rt.relay&&await this.confirmOnlineStateOrThrow();const a=this.getAppLinkIfEnabled(o.peer.metadata,o.transportType);Ir(s)?await this.sendResult({id:i,topic:r,result:s.result,throwOnFailedPublish:!0,appLink:a}):qn(s)&&await this.sendError({id:i,topic:r,error:s.error,appLink:a}),this.cleanupAfterResponse(n)}),q(this,"ping",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(n)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:r}=n;if(this.client.session.keys.includes(r)){const s=Ar(),i=_i().toString(),{done:o,resolve:a,reject:c}=hi();this.events.once(ze("session_ping",s),({error:l})=>{l?c(l):a()}),await Promise.all([this.sendRequest({topic:r,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:i}),o()])}else this.client.core.pairing.pairings.keys.includes(r)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:r}))}),q(this,"emit",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(n);const{topic:r,event:s,chainId:i}=n,o=_i().toString(),a=Ar();await this.sendRequest({topic:r,method:"wc_sessionEvent",params:{event:s,chainId:i},throwOnFailedPublish:!0,relayRpcId:o,clientRpcId:a})}),q(this,"disconnect",async n=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(n);const{topic:r}=n;if(this.client.session.keys.includes(r))await this.sendRequest({topic:r,method:"wc_sessionDelete",params:ct("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:r,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(r))await this.client.core.pairing.disconnect({topic:r});else{const{message:s}=Z("MISMATCHED_TOPIC",`Session or pairing topic not found: ${r}`);throw new Error(s)}}),q(this,"find",n=>(this.isInitialized(),this.client.session.getAll().filter(r=>Sk(r,n)))),q(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),q(this,"authenticate",async(n,r)=>{var s;this.isInitialized(),this.isValidAuthenticate(n);const i=r&&this.client.core.linkModeSupportedApps.includes(r)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),o=i?rt.link_mode:rt.relay;o===rt.relay&&await this.confirmOnlineStateOrThrow();const{chains:a,statement:c="",uri:l,domain:u,nonce:d,type:h,exp:f,nbf:p,methods:g=[],expiry:m}=n,v=[...n.resources||[]],{topic:b,uri:y}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:o});this.client.logger.info({message:"Generated new pairing",pairing:{topic:b,uri:y}});const N=await this.client.core.crypto.generateKeyPair(),_=tu(N);if(await Promise.all([this.client.auth.authKeys.set(ru,{responseTopic:_,publicKey:N}),this.client.auth.pairingTopics.set(_,{topic:_,pairingTopic:b})]),await this.client.core.relayer.subscribe(_,{transportType:o}),this.client.logger.info(`sending request to new pairing topic: ${b}`),g.length>0){const{namespace:C}=xo(a[0]);let P=DD(C,"request",g);eu(v)&&(P=kD(P,v.pop())),v.push(P)}const T=m&&m>St.wc_sessionAuthenticate.req.ttl?m:St.wc_sessionAuthenticate.req.ttl,x={authPayload:{type:h??"caip122",chains:a,statement:c,aud:l,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:p,resources:v},requester:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:vt(T)},D={eip155:{chains:a,methods:[...new Set(["personal_sign",...g])],events:["chainChanged","accountsChanged"]}},I={requiredNamespaces:{},optionalNamespaces:D,relays:[{protocol:"irn"}],pairingTopic:b,proposer:{publicKey:N,metadata:this.client.metadata},expiryTimestamp:vt(St.wc_sessionPropose.req.ttl),id:Ar()},{done:U,resolve:R,reject:k}=hi(T,"Request expired"),M=Ar(),F=ze("session_connect",I.id),E=ze("session_request",M),S=async({error:C,session:P})=>{this.events.off(E,O),C?k(C):P&&R({session:P})},O=async C=>{var P,B,H;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),C.error){const xe=ct("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return C.error.code===xe.code?void 0:(this.events.off(F,S),k(C.error.message))}await this.deleteProposal(I.id),this.events.off(F,S);const{cacaos:G,responder:W}=C.result,se=[],ue=[];for(const xe of G){await T0({cacao:xe,projectId:this.client.core.projectId})||(this.client.logger.error(xe,"Signature verification failed"),k(ct("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:ft}=xe,Rt=eu(ft.resources),ri=[$f(ft.iss)],pl=Nu(ft.iss);if(Rt){const Ji=P0(Rt),Od=O0(Rt);se.push(...Ji),ri.push(...Od)}for(const Ji of ri)ue.push(`${Ji}:${pl}`)}const De=await this.client.core.crypto.generateSharedKey(N,W.publicKey);let je;se.length>0&&(je={topic:De,acknowledged:!0,self:{publicKey:N,metadata:this.client.metadata},peer:W,controller:W.publicKey,expiry:vt(oo),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:b,namespaces:ty([...new Set(se)],[...new Set(ue)]),transportType:o},await this.client.core.relayer.subscribe(De,{transportType:o}),await this.client.session.set(De,je),b&&await this.client.core.pairing.updateMetadata({topic:b,metadata:W.metadata}),je=this.client.session.get(De)),(P=this.client.metadata.redirect)!=null&&P.linkMode&&(B=W.metadata.redirect)!=null&&B.linkMode&&(H=W.metadata.redirect)!=null&&H.universal&&r&&(this.client.core.addLinkModeSupportedApp(W.metadata.redirect.universal),this.client.session.update(De,{transportType:rt.link_mode})),R({auths:G,session:je})};this.events.once(F,S),this.events.once(E,O);let $;try{if(i){const C=Ms("wc_sessionAuthenticate",x,M);this.client.core.history.set(b,C);const P=await this.client.core.crypto.encode("",C,{type:ll,encoding:$s});$=Ll(r,b,P)}else await Promise.all([this.sendRequest({topic:b,method:"wc_sessionAuthenticate",params:x,expiry:n.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:b,method:"wc_sessionPropose",params:I,expiry:St.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:I.id})])}catch(C){throw this.events.off(F,S),this.events.off(E,O),C}return await this.setProposal(I.id,I),await this.setAuthRequest(M,{request:fn(nt({},x),{verifyContext:{}}),pairingTopic:b,transportType:o}),{uri:$??y,response:U}}),q(this,"approveSessionAuthenticate",async n=>{const{id:r,auths:s}=n,i=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[ci.authenticated_session_approve_started]}});try{this.isInitialized()}catch(m){throw i.setError(_a.no_internet_connection),m}const o=this.getPendingAuthRequest(r);if(!o)throw i.setError(_a.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${r}`);const a=o.transportType||rt.relay;a===rt.relay&&await this.confirmOnlineStateOrThrow();const c=o.requester.publicKey,l=await this.client.core.crypto.generateKeyPair(),u=tu(c),d={type:os,receiverPublicKey:c,senderPublicKey:l},h=[],f=[];for(const m of s){if(!await T0({cacao:m,projectId:this.client.core.projectId})){i.setError(_a.invalid_cacao);const _=ct("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:u,error:_,encodeOpts:d}),new Error(_.message)}i.addTrace(ci.cacaos_verified);const{p:v}=m,b=eu(v.resources),y=[$f(v.iss)],N=Nu(v.iss);if(b){const _=P0(b),T=O0(b);h.push(..._),y.push(...T)}for(const _ of y)f.push(`${_}:${N}`)}const p=await this.client.core.crypto.generateSharedKey(l,c);i.addTrace(ci.create_authenticated_session_topic);let g;if((h==null?void 0:h.length)>0){g={topic:p,acknowledged:!0,self:{publicKey:l,metadata:this.client.metadata},peer:{publicKey:c,metadata:o.requester.metadata},controller:c,expiry:vt(oo),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:o.pairingTopic,namespaces:ty([...new Set(h)],[...new Set(f)]),transportType:a},i.addTrace(ci.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:a})}catch(m){throw i.setError(_a.subscribe_authenticated_session_topic_failure),m}i.addTrace(ci.subscribe_authenticated_session_topic_success),await this.client.session.set(p,g),i.addTrace(ci.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:o.pairingTopic,metadata:o.requester.metadata})}i.addTrace(ci.publishing_authenticated_session_approve);try{await this.sendResult({topic:u,id:r,result:{cacaos:s,responder:{publicKey:l,metadata:this.client.metadata}},encodeOpts:d,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(o.requester.metadata,a)})}catch(m){throw i.setError(_a.authenticated_session_approve_publish_failure),m}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:o.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:i.eventId}),{session:g}}),q(this,"rejectSessionAuthenticate",async n=>{this.isInitialized();const{id:r,reason:s}=n,i=this.getPendingAuthRequest(r);if(!i)throw new Error(`Could not find pending auth request with id ${r}`);i.transportType===rt.relay&&await this.confirmOnlineStateOrThrow();const o=i.requester.publicKey,a=await this.client.core.crypto.generateKeyPair(),c=tu(o),l={type:os,receiverPublicKey:o,senderPublicKey:a};await this.sendError({id:r,topic:c,error:s,encodeOpts:l,rpcOpts:St.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(r,{message:"rejected",code:0}),await this.deleteProposal(r)}),q(this,"formatAuthMessage",n=>{this.isInitialized();const{request:r,iss:s}=n;return FE(r,s)}),q(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const n=this.relayMessageCache.shift();n&&await this.onRelayMessage(n)}catch(n){this.client.logger.error(n)}},50)}),q(this,"cleanupDuplicatePairings",async n=>{if(n.pairingTopic)try{const r=this.client.core.pairing.pairings.get(n.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(i=>{var o,a;return((o=i.peerMetadata)==null?void 0:o.url)&&((a=i.peerMetadata)==null?void 0:a.url)===n.peer.metadata.url&&i.topic&&i.topic!==r.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(i=>this.client.core.pairing.disconnect({topic:i.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(r){this.client.logger.error(r)}}),q(this,"deleteSession",async n=>{var r;const{topic:s,expirerHasDeleted:i=!1,emitEvent:o=!0,id:a=0}=n,{self:c}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,ct("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(c.publicKey)&&await this.client.core.crypto.deleteKeyPair(c.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),i||this.client.core.expirer.del(s),this.client.core.storage.removeItem(My).catch(l=>this.client.logger.warn(l)),this.getPendingSessionRequests().forEach(l=>{l.topic===s&&this.deletePendingSessionRequest(l.id,ct("USER_DISCONNECTED"))}),s===((r=this.sessionRequestQueue.queue[0])==null?void 0:r.topic)&&(this.sessionRequestQueue.state=Cr.idle),o&&this.client.events.emit("session_delete",{id:a,topic:s})}),q(this,"deleteProposal",async(n,r)=>{if(r)try{const s=this.client.proposal.get(n),i=this.client.core.eventClient.getEvent({topic:s.pairingTopic});i==null||i.setError(ai.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(n,ct("USER_DISCONNECTED")),r?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"proposal")}),q(this,"deletePendingSessionRequest",async(n,r,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)]),this.addToRecentlyDeleted(n,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(i=>i.id!==n),s&&(this.sessionRequestQueue.state=Cr.idle,this.client.events.emit("session_request_expire",{id:n}))}),q(this,"deletePendingAuthRequest",async(n,r,s=!1)=>{await Promise.all([this.client.auth.requests.delete(n,r),s?Promise.resolve():this.client.core.expirer.del(n)])}),q(this,"setExpiry",async(n,r)=>{this.client.session.keys.includes(n)&&(this.client.core.expirer.set(n,r),await this.client.session.update(n,{expiry:r}))}),q(this,"setProposal",async(n,r)=>{this.client.core.expirer.set(n,vt(St.wc_sessionPropose.req.ttl)),await this.client.proposal.set(n,r)}),q(this,"setAuthRequest",async(n,r)=>{const{request:s,pairingTopic:i,transportType:o=rt.relay}=r;this.client.core.expirer.set(n,s.expiryTimestamp),await this.client.auth.requests.set(n,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:n,pairingTopic:i,verifyContext:s.verifyContext,transportType:o})}),q(this,"setPendingSessionRequest",async n=>{const{id:r,topic:s,params:i,verifyContext:o}=n,a=i.request.expiryTimestamp||vt(St.wc_sessionRequest.req.ttl);this.client.core.expirer.set(r,a),await this.client.pendingRequest.set(r,{id:r,topic:s,params:i,verifyContext:o})}),q(this,"sendRequest",async n=>{const{topic:r,method:s,params:i,expiry:o,relayRpcId:a,clientRpcId:c,throwOnFailedPublish:l,appLink:u,tvf:d}=n,h=Ms(s,i,c);let f;const p=!!u;try{const v=p?$s:lr;f=await this.client.core.crypto.encode(r,h,{encoding:v})}catch(v){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${r} failed`),v}let g;if(bB.includes(s)){const v=xr(JSON.stringify(h)),b=xr(f);g=await this.client.core.verify.register({id:b,decryptedId:v})}const m=St[s].req;if(m.attestation=g,o&&(m.ttl=o),a&&(m.id=a),this.client.core.history.set(r,h),p){const v=Ll(u,r,f);await global.Linking.openURL(v,this.client.name)}else{const v=St[s].req;o&&(v.ttl=o),a&&(v.id=a),v.tvf=fn(nt({},d),{correlationId:h.id}),l?(v.internal=fn(nt({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(r,f,v)):this.client.core.relayer.publish(r,f,v).catch(b=>this.client.logger.error(b))}return h.id}),q(this,"sendResult",async n=>{const{id:r,topic:s,result:i,throwOnFailedPublish:o,encodeOpts:a,appLink:c}=n,l=Ed(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const p=d?$s:lr;u=await this.client.core.crypto.encode(s,l,fn(nt({},a||{}),{encoding:p}))}catch(p){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),p}let h,f;try{h=await this.client.core.history.get(s,r);const p=h.request;try{f=this.getTVFParams(r,p.params,i)}catch(g){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${g==null?void 0:g.message}`)}}catch(p){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${r}) failed`),p}if(d){const p=Ll(c,s,u);await global.Linking.openURL(p,this.client.name)}else{const p=h.request.method,g=St[p].res;g.tvf=fn(nt({},f),{correlationId:r}),o?(g.internal=fn(nt({},g.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,u,g)):this.client.core.relayer.publish(s,u,g).catch(m=>this.client.logger.error(m))}await this.client.core.history.resolve(l)}),q(this,"sendError",async n=>{const{id:r,topic:s,error:i,encodeOpts:o,rpcOpts:a,appLink:c}=n,l=Cd(r,i);let u;const d=c&&typeof(global==null?void 0:global.Linking)<"u";try{const f=d?$s:lr;u=await this.client.core.crypto.encode(s,l,fn(nt({},o||{}),{encoding:f}))}catch(f){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),f}let h;try{h=await this.client.core.history.get(s,r)}catch(f){throw this.client.logger.error(`sendError() -> history.get(${s}, ${r}) failed`),f}if(d){const f=Ll(c,s,u);await global.Linking.openURL(f,this.client.name)}else{const f=h.request.method,p=a||St[f].res;this.client.core.relayer.publish(s,u,p)}await this.client.core.history.resolve(l)}),q(this,"cleanup",async()=>{const n=[],r=[];this.client.session.getAll().forEach(s=>{let i=!1;Ts(s.expiry)&&(i=!0),this.client.core.crypto.keychain.has(s.topic)||(i=!0),i&&n.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Ts(s.expiryTimestamp)&&r.push(s.id)}),await Promise.all([...n.map(s=>this.deleteSession({topic:s})),...r.map(s=>this.deleteProposal(s))])}),q(this,"onProviderMessageEvent",async n=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(n):await this.onRelayMessage(n)}),q(this,"onRelayEventRequest",async n=>{this.requestQueue.queue.push(n),await this.processRequestsQueue()}),q(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===Cr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Cr.active;const n=this.requestQueue.queue.shift();if(n)try{await this.processRequest(n)}catch(r){this.client.logger.warn(r)}}this.requestQueue.state=Cr.idle}),q(this,"processRequest",async n=>{const{topic:r,payload:s,attestation:i,transportType:o,encryptedId:a}=n,c=s.method;if(!this.shouldIgnorePairingRequest({topic:r,requestMethod:c}))switch(c){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:r,payload:s,attestation:i,encryptedId:a});case"wc_sessionSettle":return await this.onSessionSettleRequest(r,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(r,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(r,s);case"wc_sessionPing":return await this.onSessionPingRequest(r,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(r,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});case"wc_sessionEvent":return await this.onSessionEventRequest(r,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:r,payload:s,attestation:i,encryptedId:a,transportType:o});default:return this.client.logger.info(`Unsupported request method ${c}`)}}),q(this,"onRelayEventResponse",async n=>{const{topic:r,payload:s,transportType:i}=n,o=(await this.client.core.history.get(r,s.id)).request.method;switch(o){case"wc_sessionPropose":return this.onSessionProposeResponse(r,s,i);case"wc_sessionSettle":return this.onSessionSettleResponse(r,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(r,s);case"wc_sessionExtend":return this.onSessionExtendResponse(r,s);case"wc_sessionPing":return this.onSessionPingResponse(r,s);case"wc_sessionRequest":return this.onSessionRequestResponse(r,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(r,s);default:return this.client.logger.info(`Unsupported response method ${o}`)}}),q(this,"onRelayEventUnknownPayload",n=>{const{topic:r}=n,{message:s}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${r} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)}),q(this,"shouldIgnorePairingRequest",n=>{const{topic:r,requestMethod:s}=n,i=this.expectedPairingMethodMap.get(r);return!i||i.includes(s)?!1:!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),q(this,"onSessionProposeRequest",async n=>{const{topic:r,payload:s,attestation:i,encryptedId:o}=n,{params:a,id:c}=s;try{const l=this.client.core.eventClient.getEvent({topic:r});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),l==null||l.setError(Qr.proposal_listener_not_found)),this.isValidConnect(nt({},s.params));const u=a.expiryTimestamp||vt(St.wc_sessionPropose.req.ttl),d=nt({id:c,pairingTopic:r,expiryTimestamp:u,attestation:i,encryptedId:o},a);await this.setProposal(c,d);const h=await this.getVerifyContext({attestationId:i,hash:xr(JSON.stringify(s)),encryptedId:o,metadata:d.proposer.metadata});l==null||l.addTrace(_r.emit_session_proposal),this.client.events.emit("session_proposal",{id:c,params:d,verifyContext:h})}catch(l){await this.sendError({id:c,topic:r,error:l,rpcOpts:St.wc_sessionPropose.autoReject}),this.client.logger.error(l)}}),q(this,"onSessionProposeResponse",async(n,r,s)=>{const{id:i}=r;if(Ir(r)){const{result:o}=r;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:o});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=o.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const u=await this.client.core.crypto.generateSharedKey(c,l);this.pendingSessions.set(i,{sessionTopic:u,pairingTopic:n,proposalId:i,publicKey:c});const d=await this.client.core.relayer.subscribe(u,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.client.core.pairing.activate({topic:n})}else if(qn(r)){await this.deleteProposal(i);const o=ze("session_connect",i);if(this.events.listenerCount(o)===0)throw new Error(`emitting ${o} without any listeners, 954`);this.events.emit(o,{error:r.error})}}),q(this,"onSessionSettleRequest",async(n,r)=>{const{id:s,params:i}=r;try{this.isValidSessionSettleRequest(i);const{relay:o,controller:a,expiry:c,namespaces:l,sessionProperties:u,scopedProperties:d,sessionConfig:h}=r.params,f=[...this.pendingSessions.values()].find(m=>m.sessionTopic===n);if(!f)return this.client.logger.error(`Pending session not found for topic ${n}`);const p=this.client.proposal.get(f.proposalId),g=fn(nt(nt(nt({topic:n,relay:o,expiry:c,namespaces:l,acknowledged:!0,pairingTopic:f.pairingTopic,requiredNamespaces:p.requiredNamespaces,optionalNamespaces:p.optionalNamespaces,controller:a.publicKey,self:{publicKey:f.publicKey,metadata:this.client.metadata},peer:{publicKey:a.publicKey,metadata:a.metadata}},u&&{sessionProperties:u}),d&&{scopedProperties:d}),h&&{sessionConfig:h}),{transportType:rt.relay});await this.client.session.set(g.topic,g),await this.setExpiry(g.topic,g.expiry),await this.client.core.pairing.updateMetadata({topic:f.pairingTopic,metadata:g.peer.metadata}),this.client.events.emit("session_connect",{session:g}),this.events.emit(ze("session_connect",f.proposalId),{session:g}),this.pendingSessions.delete(f.proposalId),this.deleteProposal(f.proposalId,!1),this.cleanupDuplicatePairings(g),await this.sendResult({id:r.id,topic:n,result:!0})}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionSettleResponse",async(n,r)=>{const{id:s}=r;Ir(r)?(await this.client.session.update(n,{acknowledged:!0}),this.events.emit(ze("session_approve",s),{})):qn(r)&&(await this.client.session.delete(n,ct("USER_DISCONNECTED")),this.events.emit(ze("session_approve",s),{error:r.error}))}),q(this,"onSessionUpdateRequest",async(n,r)=>{const{params:s,id:i}=r;try{const o=`${n}_session_update`,a=Ea.get(o);if(a&&this.isRequestOutOfSync(a,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:n,error:ct("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(nt({topic:n},s));try{Ea.set(o,i),await this.client.session.update(n,{namespaces:s.namespaces}),await this.sendResult({id:i,topic:n,result:!0})}catch(c){throw Ea.delete(o),c}this.client.events.emit("session_update",{id:i,topic:n,params:s})}catch(o){await this.sendError({id:i,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"isRequestOutOfSync",(n,r)=>r.toString().slice(0,-3)<n.toString().slice(0,-3)),q(this,"onSessionUpdateResponse",(n,r)=>{const{id:s}=r,i=ze("session_update",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ir(r)?this.events.emit(ze("session_update",s),{}):qn(r)&&this.events.emit(ze("session_update",s),{error:r.error})}),q(this,"onSessionExtendRequest",async(n,r)=>{const{id:s}=r;try{this.isValidExtend({topic:n}),await this.setExpiry(n,vt(oo)),await this.sendResult({id:s,topic:n,result:!0}),this.client.events.emit("session_extend",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionExtendResponse",(n,r)=>{const{id:s}=r,i=ze("session_extend",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ir(r)?this.events.emit(ze("session_extend",s),{}):qn(r)&&this.events.emit(ze("session_extend",s),{error:r.error})}),q(this,"onSessionPingRequest",async(n,r)=>{const{id:s}=r;try{this.isValidPing({topic:n}),await this.sendResult({id:s,topic:n,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:n})}catch(i){await this.sendError({id:s,topic:n,error:i}),this.client.logger.error(i)}}),q(this,"onSessionPingResponse",(n,r)=>{const{id:s}=r,i=ze("session_ping",s);setTimeout(()=>{if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners 2176`);Ir(r)?this.events.emit(ze("session_ping",s),{}):qn(r)&&this.events.emit(ze("session_ping",s),{error:r.error})},500)}),q(this,"onSessionDeleteRequest",async(n,r)=>{const{id:s}=r;try{this.isValidDisconnect({topic:n,reason:r.params}),Promise.all([new Promise(i=>{this.client.core.relayer.once(xt.publish,async()=>{i(await this.deleteSession({topic:n,id:s}))})}),this.sendResult({id:s,topic:n,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:n,error:ct("USER_DISCONNECTED")})]).catch(i=>this.client.logger.error(i))}catch(i){this.client.logger.error(i)}}),q(this,"onSessionRequest",async n=>{var r,s,i;const{topic:o,payload:a,attestation:c,encryptedId:l,transportType:u}=n,{id:d,params:h}=a;try{await this.isValidRequest(nt({topic:o},h));const f=this.client.session.get(o),p=await this.getVerifyContext({attestationId:c,hash:xr(JSON.stringify(Ms("wc_sessionRequest",h,d))),encryptedId:l,metadata:f.peer.metadata,transportType:u}),g={id:d,topic:o,params:h,verifyContext:p};await this.setPendingSessionRequest(g),u===rt.link_mode&&(r=f.peer.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp((s=f.peer.metadata.redirect)==null?void 0:s.universal),(i=this.client.signConfig)!=null&&i.disableRequestQueue?this.emitSessionRequest(g):(this.addSessionRequestToSessionRequestQueue(g),this.processSessionRequestQueue())}catch(f){await this.sendError({id:d,topic:o,error:f}),this.client.logger.error(f)}}),q(this,"onSessionRequestResponse",(n,r)=>{const{id:s}=r,i=ze("session_request",s);if(this.events.listenerCount(i)===0)throw new Error(`emitting ${i} without any listeners`);Ir(r)?this.events.emit(ze("session_request",s),{result:r.result}):qn(r)&&this.events.emit(ze("session_request",s),{error:r.error})}),q(this,"onSessionEventRequest",async(n,r)=>{const{id:s,params:i}=r;try{const o=`${n}_session_event_${i.event.name}`,a=Ea.get(o);if(a&&this.isRequestOutOfSync(a,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(nt({topic:n},i)),this.client.events.emit("session_event",{id:s,topic:n,params:i}),Ea.set(o,s)}catch(o){await this.sendError({id:s,topic:n,error:o}),this.client.logger.error(o)}}),q(this,"onSessionAuthenticateResponse",(n,r)=>{const{id:s}=r;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:n,payload:r}),Ir(r)?this.events.emit(ze("session_request",s),{result:r.result}):qn(r)&&this.events.emit(ze("session_request",s),{error:r.error})}),q(this,"onSessionAuthenticateRequest",async n=>{var r;const{topic:s,payload:i,attestation:o,encryptedId:a,transportType:c}=n;try{const{requester:l,authPayload:u,expiryTimestamp:d}=i.params,h=await this.getVerifyContext({attestationId:o,hash:xr(JSON.stringify(i)),encryptedId:a,metadata:l.metadata,transportType:c}),f={requester:l,pairingTopic:s,id:i.id,authPayload:u,verifyContext:h,expiryTimestamp:d};await this.setAuthRequest(i.id,{request:f,pairingTopic:s,transportType:c}),c===rt.link_mode&&(r=l.metadata.redirect)!=null&&r.universal&&this.client.core.addLinkModeSupportedApp(l.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:i.params,id:i.id,verifyContext:h})}catch(l){this.client.logger.error(l);const u=i.params.requester.publicKey,d=await this.client.core.crypto.generateKeyPair(),h=this.getAppLinkIfEnabled(i.params.requester.metadata,c),f={type:os,receiverPublicKey:u,senderPublicKey:d};await this.sendError({id:i.id,topic:s,error:l,encodeOpts:f,rpcOpts:St.wc_sessionAuthenticate.autoReject,appLink:h})}}),q(this,"addSessionRequestToSessionRequestQueue",n=>{this.sessionRequestQueue.queue.push(n)}),q(this,"cleanupAfterResponse",n=>{this.deletePendingSessionRequest(n.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Cr.idle,this.processSessionRequestQueue()},Y.toMiliseconds(this.requestQueueDelay))}),q(this,"cleanupPendingSentRequestsForTopic",({topic:n,error:r})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(i=>i.topic===n&&i.request.method==="wc_sessionRequest").forEach(i=>{const o=i.request.id,a=ze("session_request",o);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);this.events.emit(ze("session_request",i.request.id),{error:r})})}),q(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===Cr.active){this.client.logger.info("session request queue is already active.");return}const n=this.sessionRequestQueue.queue[0];if(!n){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Cr.active,this.emitSessionRequest(n)}catch(r){this.client.logger.error(r)}}),q(this,"emitSessionRequest",n=>{this.client.events.emit("session_request",n)}),q(this,"onPairingCreated",n=>{if(n.methods&&this.expectedPairingMethodMap.set(n.topic,n.methods),n.active)return;const r=this.client.proposal.getAll().find(s=>s.pairingTopic===n.topic);r&&this.onSessionProposeRequest({topic:n.topic,payload:Ms("wc_sessionPropose",fn(nt({},r),{requiredNamespaces:r.requiredNamespaces,optionalNamespaces:r.optionalNamespaces,relays:r.relays,proposer:r.proposer,sessionProperties:r.sessionProperties,scopedProperties:r.scopedProperties}),r.id),attestation:r.attestation,encryptedId:r.encryptedId})}),q(this,"isValidConnect",async n=>{if(!mn(n)){const{message:l}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(n)}`);throw new Error(l)}const{pairingTopic:r,requiredNamespaces:s,optionalNamespaces:i,sessionProperties:o,scopedProperties:a,relays:c}=n;if(Mt(r)||await this.isValidPairingTopic(r),!Mk(c)){const{message:l}=Z("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}if(!Mt(s)&&qs(s)!==0){const l="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(l):this.client.logger.warn(l),this.validateNamespaces(s,"requiredNamespaces")}if(!Mt(i)&&qs(i)!==0&&this.validateNamespaces(i,"optionalNamespaces"),Mt(o)||this.validateSessionProps(o,"sessionProperties"),!Mt(a)){this.validateSessionProps(a,"scopedProperties");const l=Object.keys(s||{}).concat(Object.keys(i||{}));if(!Object.keys(a).every(u=>l.includes(u)))throw new Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(a)}, required/optional namespaces: ${JSON.stringify(l)}`)}}),q(this,"validateNamespaces",(n,r)=>{const s=Lk(n,"connect()",r);if(s)throw new Error(s.message)}),q(this,"isValidApprove",async n=>{if(!mn(n))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${n}`).message);const{id:r,namespaces:s,relayProtocol:i,sessionProperties:o,scopedProperties:a}=n;this.checkRecentlyDeleted(r),await this.isValidProposalId(r);const c=this.client.proposal.get(r),l=bh(s,"approve()");if(l)throw new Error(l.message);const u=sy(c.requiredNamespaces,s,"approve()");if(u)throw new Error(u.message);if(!yt(i,!0)){const{message:d}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw new Error(d)}if(Mt(o)||this.validateSessionProps(o,"sessionProperties"),!Mt(a)){this.validateSessionProps(a,"scopedProperties");const d=new Set(Object.keys(s));if(!Object.keys(a).every(h=>d.has(h)))throw new Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(a)}, approved namespaces: ${Array.from(d).join(", ")}`)}}),q(this,"isValidReject",async n=>{if(!mn(n)){const{message:i}=Z("MISSING_OR_INVALID",`reject() params: ${n}`);throw new Error(i)}const{id:r,reason:s}=n;if(this.checkRecentlyDeleted(r),await this.isValidProposalId(r),!Fk(s)){const{message:i}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(i)}}),q(this,"isValidSessionSettleRequest",n=>{if(!mn(n)){const{message:l}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${n}`);throw new Error(l)}const{relay:r,controller:s,namespaces:i,expiry:o}=n;if(!yC(r)){const{message:l}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(l)}const a=Ok(s,"onSessionSettleRequest()");if(a)throw new Error(a.message);const c=bh(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);if(Ts(o)){const{message:l}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(l)}}),q(this,"isValidUpdate",async n=>{if(!mn(n)){const{message:c}=Z("MISSING_OR_INVALID",`update() params: ${n}`);throw new Error(c)}const{topic:r,namespaces:s}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const i=this.client.session.get(r),o=bh(s,"update()");if(o)throw new Error(o.message);const a=sy(i.requiredNamespaces,s,"update()");if(a)throw new Error(a.message)}),q(this,"isValidExtend",async n=>{if(!mn(n)){const{message:s}=Z("MISSING_OR_INVALID",`extend() params: ${n}`);throw new Error(s)}const{topic:r}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r)}),q(this,"isValidRequest",async n=>{if(!mn(n)){const{message:c}=Z("MISSING_OR_INVALID",`request() params: ${n}`);throw new Error(c)}const{topic:r,request:s,chainId:i,expiry:o}=n;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);const{namespaces:a}=this.client.session.get(r);if(!ry(a,i)){const{message:c}=Z("MISSING_OR_INVALID",`request() chainId: ${i}`);throw new Error(c)}if(!jk(s)){const{message:c}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(c)}if(!zk(a,i,s.method)){const{message:c}=Z("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(c)}if(o&&!Kk(o,Sh)){const{message:c}=Z("MISSING_OR_INVALID",`request() expiry: ${o}. Expiry must be a number (in seconds) between ${Sh.min} and ${Sh.max}`);throw new Error(c)}}),q(this,"isValidRespond",async n=>{var r;if(!mn(n)){const{message:o}=Z("MISSING_OR_INVALID",`respond() params: ${n}`);throw new Error(o)}const{topic:s,response:i}=n;try{await this.isValidSessionTopic(s)}catch(o){throw(r=n==null?void 0:n.response)!=null&&r.id&&this.cleanupAfterResponse(n),o}if(!Hk(i)){const{message:o}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(o)}}),q(this,"isValidPing",async n=>{if(!mn(n)){const{message:s}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidEmit",async n=>{if(!mn(n)){const{message:a}=Z("MISSING_OR_INVALID",`emit() params: ${n}`);throw new Error(a)}const{topic:r,event:s,chainId:i}=n;await this.isValidSessionTopic(r);const{namespaces:o}=this.client.session.get(r);if(!ry(o,i)){const{message:a}=Z("MISSING_OR_INVALID",`emit() chainId: ${i}`);throw new Error(a)}if(!qk(s)){const{message:a}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}if(!Wk(o,i,s.name)){const{message:a}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(a)}}),q(this,"isValidDisconnect",async n=>{if(!mn(n)){const{message:s}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:r}=n;await this.isValidSessionOrPairingTopic(r)}),q(this,"isValidAuthenticate",n=>{const{chains:r,uri:s,domain:i,nonce:o}=n;if(!Array.isArray(r)||r.length===0)throw new Error("chains is required and must be a non-empty array");if(!yt(s,!1))throw new Error("uri is required parameter");if(!yt(i,!1))throw new Error("domain is required parameter");if(!yt(o,!1))throw new Error("nonce is required parameter");if([...new Set(r.map(c=>xo(c).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:a}=xo(r[0]);if(a!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),q(this,"getVerifyContext",async n=>{const{attestationId:r,hash:s,encryptedId:i,metadata:o,transportType:a}=n,c={verified:{verifyUrl:o.verifyUrl||Va,validation:"UNKNOWN",origin:o.url||""}};try{if(a===rt.link_mode){const u=this.getAppLinkIfEnabled(o,a);return c.verified.validation=u&&new URL(u).origin===new URL(o.url).origin?"VALID":"INVALID",c}const l=await this.client.core.verify.resolve({attestationId:r,hash:s,encryptedId:i,verifyUrl:o.verifyUrl});l&&(c.verified.origin=l.origin,c.verified.isScam=l.isScam,c.verified.validation=l.origin===new URL(o.url).origin?"VALID":"INVALID")}catch(l){this.client.logger.warn(l)}return this.client.logger.debug(`Verify context: ${JSON.stringify(c)}`),c}),q(this,"validateSessionProps",(n,r)=>{Object.values(n).forEach((s,i)=>{if(s==null){const{message:o}=Z("MISSING_OR_INVALID",`${r} must contain an existing value for each key. Received: ${s} for key ${Object.keys(n)[i]}`);throw new Error(o)}})}),q(this,"getPendingAuthRequest",n=>{const r=this.client.auth.requests.get(n);return typeof r=="object"?r:void 0}),q(this,"addToRecentlyDeleted",(n,r)=>{if(this.recentlyDeletedMap.set(n,r),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const i=this.recentlyDeletedLimit/2;for(const o of this.recentlyDeletedMap.keys()){if(s++>=i)break;this.recentlyDeletedMap.delete(o)}}}),q(this,"checkRecentlyDeleted",n=>{const r=this.recentlyDeletedMap.get(n);if(r){const{message:s}=Z("MISSING_OR_INVALID",`Record was recently deleted - ${r}: ${n}`);throw new Error(s)}}),q(this,"isLinkModeEnabled",(n,r)=>{var s,i,o,a,c,l,u,d,h;return!n||r!==rt.link_mode?!1:((i=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:i.linkMode)===!0&&((a=(o=this.client.metadata)==null?void 0:o.redirect)==null?void 0:a.universal)!==void 0&&((l=(c=this.client.metadata)==null?void 0:c.redirect)==null?void 0:l.universal)!==""&&((u=n==null?void 0:n.redirect)==null?void 0:u.universal)!==void 0&&((d=n==null?void 0:n.redirect)==null?void 0:d.universal)!==""&&((h=n==null?void 0:n.redirect)==null?void 0:h.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(n.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"}),q(this,"getAppLinkIfEnabled",(n,r)=>{var s;return this.isLinkModeEnabled(n,r)?(s=n==null?void 0:n.redirect)==null?void 0:s.universal:void 0}),q(this,"handleLinkModeMessage",({url:n})=>{if(!n||!n.includes("wc_ev")||!n.includes("topic"))return;const r=y0(n,"topic")||"",s=decodeURIComponent(y0(n,"wc_ev")||""),i=this.client.session.keys.includes(r);i&&this.client.session.update(r,{transportType:rt.link_mode}),this.client.core.dispatchEnvelope({topic:r,message:s,sessionExists:i})}),q(this,"registerLinkModeListeners",async()=>{var n;if(rg()||ni()&&(n=this.client.metadata.redirect)!=null&&n.linkMode){const r=global==null?void 0:global.Linking;if(typeof r<"u"){r.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await r.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}),q(this,"getTVFParams",(n,r,s)=>{var i,o,a;if(!((i=r.request)!=null&&i.method))return{};const c={correlationId:n,rpcMethods:[r.request.method],chainId:r.chainId};try{const l=this.extractTxHashesFromResult(r.request,s);c.txHashes=l,c.contractAddresses=this.isValidContractData(r.request.params)?[(a=(o=r.request.params)==null?void 0:o[0])==null?void 0:a.to]:[]}catch(l){this.client.logger.warn("Error getting TVF params",l)}return c}),q(this,"isValidContractData",n=>{var r;if(!n)return!1;try{const s=(n==null?void 0:n.data)||((r=n==null?void 0:n[0])==null?void 0:r.data);if(!s.startsWith("0x"))return!1;const i=s.slice(2);return/^[0-9a-fA-F]*$/.test(i)?i.length%2===0:!1}catch{}return!1}),q(this,"extractTxHashesFromResult",(n,r)=>{var s;try{if(!r)return[];const i=n.method,o=yB[i];if(i==="sui_signTransaction")return[yD(r.transactionBytes)];if(i==="near_signTransaction")return[I0(r)];if(i==="near_signTransactions")return r.map(c=>I0(c));if(i==="xrpl_signTransactionFor"||i==="xrpl_signTransaction")return[(s=r.tx_json)==null?void 0:s.hash];if(i==="polkadot_signTransaction")return[l4({transaction:n.params.transactionPayload,signature:r.signature})];if(i==="algo_signTxn")return as(r)?r.map(c=>S0(c)):[S0(r)];if(i==="cosmos_signDirect")return[bD(r)];if(typeof r=="string")return[r];const a=r[o.key];if(as(a))return i==="solana_signAllTransactions"?a.map(c=>mD(c)):a;if(typeof a=="string")return[a]}catch(i){this.client.logger.warn("Error extracting tx hashes from result",i)}return[]})}async processPendingMessageEvents(){try{const e=this.client.session.keys,n=this.client.core.relayer.messages.getWithoutAck(e);for(const[r,s]of Object.entries(n))for(const i of s)try{await this.onProviderMessageEvent({topic:r,message:i,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${r}, message: ${i}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){const{message:e}=Z("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(xt.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){const{topic:n,message:r,attestation:s,transportType:i}=e,{publicKey:o}=this.client.auth.authKeys.keys.includes(ru)?this.client.auth.authKeys.get(ru):{publicKey:void 0};try{const a=await this.client.core.crypto.decode(n,r,{receiverPublicKey:o,encoding:i===rt.link_mode?$s:lr});wg(a)?(this.client.core.history.set(n,a),await this.onRelayEventRequest({topic:n,payload:a,attestation:s,transportType:i,encryptedId:xr(r)})):_d(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:n,payload:a,transportType:i}),this.client.core.history.delete(n,a.id)):await this.onRelayEventUnknownPayload({topic:n,payload:a,transportType:i}),await this.client.core.relayer.messages.ack(n,r)}catch(a){this.client.logger.error(a)}}registerExpirerEvents(){this.client.core.expirer.on(Hn.expired,async e=>{const{topic:n,id:r}=IE(e.target);if(r&&this.client.pendingRequest.keys.includes(r))return await this.deletePendingSessionRequest(r,Z("EXPIRED"),!0);if(r&&this.client.auth.requests.keys.includes(r))return await this.deletePendingAuthRequest(r,Z("EXPIRED"),!0);n?this.client.session.keys.includes(n)&&(await this.deleteSession({topic:n,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:n})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r}))})}registerPairingEvents(){this.client.core.pairing.events.on(pi.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(pi.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!yt(e,!1)){const{message:n}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(n)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:n}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(n)}if(Ts(this.client.core.pairing.pairings.get(e).expiry)){const{message:n}=Z("EXPIRED",`pairing topic: ${e}`);throw new Error(n)}}async isValidSessionTopic(e){if(!yt(e,!1)){const{message:n}=Z("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(n)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:n}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(n)}if(Ts(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:n}=Z("EXPIRED",`session topic: ${e}`);throw new Error(n)}if(!this.client.core.crypto.keychain.has(e)){const{message:n}=Z("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(n)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(yt(e,!1)){const{message:n}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(n)}else{const{message:n}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(n)}}async isValidProposalId(e){if(!Bk(e)){const{message:n}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(n)}if(!this.client.proposal.keys.includes(e)){const{message:n}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(n)}if(Ts(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:n}=Z("EXPIRED",`proposal id: ${e}`);throw new Error(n)}}}class OB extends Yi{constructor(e,n){super(e,n,pB,bg),this.core=e,this.logger=n}}let RB=class extends Yi{constructor(e,n){super(e,n,gB,bg),this.core=e,this.logger=n}};class DB extends Yi{constructor(e,n){super(e,n,wB,bg,r=>r.id),this.core=e,this.logger=n}}class $B extends Yi{constructor(e,n){super(e,n,CB,Id,()=>ru),this.core=e,this.logger=n}}class kB extends Yi{constructor(e,n){super(e,n,_B,Id),this.core=e,this.logger=n}}class UB extends Yi{constructor(e,n){super(e,n,AB,Id,r=>r.id),this.core=e,this.logger=n}}var LB=Object.defineProperty,MB=(t,e,n)=>e in t?LB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nh=(t,e,n)=>MB(t,typeof e!="symbol"?e+"":e,n);class BB{constructor(e,n){this.core=e,this.logger=n,Nh(this,"authKeys"),Nh(this,"pairingTopics"),Nh(this,"requests"),this.authKeys=new $B(this.core,this.logger),this.pairingTopics=new kB(this.core,this.logger),this.requests=new UB(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var FB=Object.defineProperty,jB=(t,e,n)=>e in t?FB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pe=(t,e,n)=>jB(t,typeof e!="symbol"?e+"":e,n);let HB=class zC extends CP{constructor(e){super(e),Pe(this,"protocol",jC),Pe(this,"version",HC),Pe(this,"name",Ih.name),Pe(this,"metadata"),Pe(this,"core"),Pe(this,"logger"),Pe(this,"events",new Xn.EventEmitter),Pe(this,"engine"),Pe(this,"session"),Pe(this,"proposal"),Pe(this,"pendingRequest"),Pe(this,"auth"),Pe(this,"signConfig"),Pe(this,"on",(r,s)=>this.events.on(r,s)),Pe(this,"once",(r,s)=>this.events.once(r,s)),Pe(this,"off",(r,s)=>this.events.off(r,s)),Pe(this,"removeListener",(r,s)=>this.events.removeListener(r,s)),Pe(this,"removeAllListeners",r=>this.events.removeAllListeners(r)),Pe(this,"connect",async r=>{try{return await this.engine.connect(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"pair",async r=>{try{return await this.engine.pair(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"approve",async r=>{try{return await this.engine.approve(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"reject",async r=>{try{return await this.engine.reject(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"update",async r=>{try{return await this.engine.update(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"extend",async r=>{try{return await this.engine.extend(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"request",async r=>{try{return await this.engine.request(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"respond",async r=>{try{return await this.engine.respond(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"ping",async r=>{try{return await this.engine.ping(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"emit",async r=>{try{return await this.engine.emit(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"disconnect",async r=>{try{return await this.engine.disconnect(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"find",r=>{try{return this.engine.find(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(r){throw this.logger.error(r.message),r}}),Pe(this,"authenticate",async(r,s)=>{try{return await this.engine.authenticate(r,s)}catch(i){throw this.logger.error(i.message),i}}),Pe(this,"formatAuthMessage",r=>{try{return this.engine.formatAuthMessage(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"approveSessionAuthenticate",async r=>{try{return await this.engine.approveSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),Pe(this,"rejectSessionAuthenticate",async r=>{try{return await this.engine.rejectSessionAuthenticate(r)}catch(s){throw this.logger.error(s.message),s}}),this.name=(e==null?void 0:e.name)||Ih.name,this.metadata=l8(e==null?void 0:e.metadata),this.signConfig=e==null?void 0:e.signConfig;const n=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nl(Ko({level:(e==null?void 0:e.logger)||Ih.logger}));this.core=(e==null?void 0:e.core)||new fB(e),this.logger=tn(n,this.name),this.session=new RB(this.core,this.logger),this.proposal=new OB(this.core,this.logger),this.pendingRequest=new DB(this.core,this.logger),this.engine=new PB(this),this.auth=new BB(this.core,this.logger)}static async init(e){const n=new zC(e);return await n.initialize(),n}get context(){return In(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},Y.toMiliseconds(Y.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var rp={exports:{}};(function(t,e){var n=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Sr<"u"&&Sr,r=function(){function i(){this.fetch=!1,this.DOMException=n.DOMException}return i.prototype=n,new i}();(function(i){(function(o){var a=typeof i<"u"&&i||typeof self<"u"&&self||typeof Sr<"u"&&Sr||{},c={searchParams:"URLSearchParams"in a,iterable:"Symbol"in a&&"iterator"in Symbol,blob:"FileReader"in a&&"Blob"in a&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in a,arrayBuffer:"ArrayBuffer"in a};function l(E){return E&&DataView.prototype.isPrototypeOf(E)}if(c.arrayBuffer)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],d=ArrayBuffer.isView||function(E){return E&&u.indexOf(Object.prototype.toString.call(E))>-1};function h(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(E)||E==="")throw new TypeError('Invalid character in header field name: "'+E+'"');return E.toLowerCase()}function f(E){return typeof E!="string"&&(E=String(E)),E}function p(E){var S={next:function(){var O=E.shift();return{done:O===void 0,value:O}}};return c.iterable&&(S[Symbol.iterator]=function(){return S}),S}function g(E){this.map={},E instanceof g?E.forEach(function(S,O){this.append(O,S)},this):Array.isArray(E)?E.forEach(function(S){if(S.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+S.length);this.append(S[0],S[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(S){this.append(S,E[S])},this)}g.prototype.append=function(E,S){E=h(E),S=f(S);var O=this.map[E];this.map[E]=O?O+", "+S:S},g.prototype.delete=function(E){delete this.map[h(E)]},g.prototype.get=function(E){return E=h(E),this.has(E)?this.map[E]:null},g.prototype.has=function(E){return this.map.hasOwnProperty(h(E))},g.prototype.set=function(E,S){this.map[h(E)]=f(S)},g.prototype.forEach=function(E,S){for(var O in this.map)this.map.hasOwnProperty(O)&&E.call(S,this.map[O],O,this)},g.prototype.keys=function(){var E=[];return this.forEach(function(S,O){E.push(O)}),p(E)},g.prototype.values=function(){var E=[];return this.forEach(function(S){E.push(S)}),p(E)},g.prototype.entries=function(){var E=[];return this.forEach(function(S,O){E.push([O,S])}),p(E)},c.iterable&&(g.prototype[Symbol.iterator]=g.prototype.entries);function m(E){if(!E._noBody){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}}function v(E){return new Promise(function(S,O){E.onload=function(){S(E.result)},E.onerror=function(){O(E.error)}})}function b(E){var S=new FileReader,O=v(S);return S.readAsArrayBuffer(E),O}function y(E){var S=new FileReader,O=v(S),$=/charset=([A-Za-z0-9_-]+)/.exec(E.type),C=$?$[1]:"utf-8";return S.readAsText(E,C),O}function N(E){for(var S=new Uint8Array(E),O=new Array(S.length),$=0;$<S.length;$++)O[$]=String.fromCharCode(S[$]);return O.join("")}function _(E){if(E.slice)return E.slice(0);var S=new Uint8Array(E.byteLength);return S.set(new Uint8Array(E)),S.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(E){this.bodyUsed=this.bodyUsed,this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:c.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:c.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:c.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():c.arrayBuffer&&c.blob&&l(E)?(this._bodyArrayBuffer=_(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):c.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||d(E))?this._bodyArrayBuffer=_(E):this._bodyText=E=Object.prototype.toString.call(E):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):c.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},c.blob&&(this.blob=function(){var E=m(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var E=m(this);return E||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(c.blob)return this.blob().then(b);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var E=m(this);if(E)return E;if(this._bodyBlob)return y(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(N(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},c.formData&&(this.formData=function(){return this.text().then(U)}),this.json=function(){return this.text().then(JSON.parse)},this}var x=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function D(E){var S=E.toUpperCase();return x.indexOf(S)>-1?S:E}function I(E,S){if(!(this instanceof I))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');S=S||{};var O=S.body;if(E instanceof I){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,S.headers||(this.headers=new g(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!O&&E._bodyInit!=null&&(O=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=S.credentials||this.credentials||"same-origin",(S.headers||!this.headers)&&(this.headers=new g(S.headers)),this.method=D(S.method||this.method||"GET"),this.mode=S.mode||this.mode||null,this.signal=S.signal||this.signal||function(){if("AbortController"in a){var P=new AbortController;return P.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&O)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(O),(this.method==="GET"||this.method==="HEAD")&&(S.cache==="no-store"||S.cache==="no-cache")){var $=/([?&])_=[^&]*/;if($.test(this.url))this.url=this.url.replace($,"$1_="+new Date().getTime());else{var C=/\?/;this.url+=(C.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}I.prototype.clone=function(){return new I(this,{body:this._bodyInit})};function U(E){var S=new FormData;return E.trim().split("&").forEach(function(O){if(O){var $=O.split("="),C=$.shift().replace(/\+/g," "),P=$.join("=").replace(/\+/g," ");S.append(decodeURIComponent(C),decodeURIComponent(P))}}),S}function R(E){var S=new g,O=E.replace(/\r?\n[\t ]+/g," ");return O.split("\r").map(function($){return $.indexOf(`
`)===0?$.substr(1,$.length):$}).forEach(function($){var C=$.split(":"),P=C.shift().trim();if(P){var B=C.join(":").trim();try{S.append(P,B)}catch(H){console.warn("Response "+H.message)}}}),S}T.call(I.prototype);function k(E,S){if(!(this instanceof k))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(S||(S={}),this.type="default",this.status=S.status===void 0?200:S.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=S.statusText===void 0?"":""+S.statusText,this.headers=new g(S.headers),this.url=S.url||"",this._initBody(E)}T.call(k.prototype),k.prototype.clone=function(){return new k(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new g(this.headers),url:this.url})},k.error=function(){var E=new k(null,{status:200,statusText:""});return E.ok=!1,E.status=0,E.type="error",E};var M=[301,302,303,307,308];k.redirect=function(E,S){if(M.indexOf(S)===-1)throw new RangeError("Invalid status code");return new k(null,{status:S,headers:{location:E}})},o.DOMException=a.DOMException;try{new o.DOMException}catch{o.DOMException=function(S,O){this.message=S,this.name=O;var $=Error(S);this.stack=$.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function F(E,S){return new Promise(function(O,$){var C=new I(E,S);if(C.signal&&C.signal.aborted)return $(new o.DOMException("Aborted","AbortError"));var P=new XMLHttpRequest;function B(){P.abort()}P.onload=function(){var W={statusText:P.statusText,headers:R(P.getAllResponseHeaders()||"")};C.url.indexOf("file://")===0&&(P.status<200||P.status>599)?W.status=200:W.status=P.status,W.url="responseURL"in P?P.responseURL:W.headers.get("X-Request-URL");var se="response"in P?P.response:P.responseText;setTimeout(function(){O(new k(se,W))},0)},P.onerror=function(){setTimeout(function(){$(new TypeError("Network request failed"))},0)},P.ontimeout=function(){setTimeout(function(){$(new TypeError("Network request timed out"))},0)},P.onabort=function(){setTimeout(function(){$(new o.DOMException("Aborted","AbortError"))},0)};function H(W){try{return W===""&&a.location.href?a.location.href:W}catch{return W}}if(P.open(C.method,H(C.url),!0),C.credentials==="include"?P.withCredentials=!0:C.credentials==="omit"&&(P.withCredentials=!1),"responseType"in P&&(c.blob?P.responseType="blob":c.arrayBuffer&&(P.responseType="arraybuffer")),S&&typeof S.headers=="object"&&!(S.headers instanceof g||a.Headers&&S.headers instanceof a.Headers)){var G=[];Object.getOwnPropertyNames(S.headers).forEach(function(W){G.push(h(W)),P.setRequestHeader(W,f(S.headers[W]))}),C.headers.forEach(function(W,se){G.indexOf(se)===-1&&P.setRequestHeader(se,W)})}else C.headers.forEach(function(W,se){P.setRequestHeader(se,W)});C.signal&&(C.signal.addEventListener("abort",B),P.onreadystatechange=function(){P.readyState===4&&C.signal.removeEventListener("abort",B)}),P.send(typeof C._bodyInit>"u"?null:C._bodyInit)})}return F.polyfill=!0,a.fetch||(a.fetch=F,a.Headers=g,a.Request=I,a.Response=k),o.Headers=g,o.Request=I,o.Response=k,o.fetch=F,Object.defineProperty(o,"__esModule",{value:!0}),o})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=n.fetch?n:r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,t.exports=e})(rp,rp.exports);var qB=rp.exports;const jy=zu(qB);var zB=Object.defineProperty,WB=Object.defineProperties,VB=Object.getOwnPropertyDescriptors,Hy=Object.getOwnPropertySymbols,GB=Object.prototype.hasOwnProperty,KB=Object.prototype.propertyIsEnumerable,qy=(t,e,n)=>e in t?zB(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zy=(t,e)=>{for(var n in e||(e={}))GB.call(e,n)&&qy(t,n,e[n]);if(Hy)for(var n of Hy(e))KB.call(e,n)&&qy(t,n,e[n]);return t},Wy=(t,e)=>WB(t,VB(e));const YB={Accept:"application/json","Content-Type":"application/json"},ZB="POST",Vy={headers:YB,method:ZB},Gy=10;let mr=class{constructor(e,n=!1){if(this.url=e,this.disableProviderPing=n,this.events=new Xn.EventEmitter,this.isAvailable=!1,this.registering=!1,!uy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=n}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}off(e,n){this.events.off(e,n)}removeListener(e,n){this.events.removeListener(e,n)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const n=ls(e),r=await(await jy(this.url,Wy(zy({},Vy),{body:n}))).json();this.onPayload({data:r})}catch(n){this.onError(e.id,n)}}async register(e=this.url){if(!uy(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const n=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=n||this.events.listenerCount("open")>=n)&&this.events.setMaxListeners(n+1),new Promise((r,s)=>{this.events.once("register_error",i=>{this.resetMaxListeners(),s(i)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return s(new Error("HTTP connection is missing or invalid"));r()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const n=ls({id:1,jsonrpc:"2.0",method:"test",params:[]});await jy(e,Wy(zy({},Vy),{body:n}))}this.onOpen()}catch(n){const r=this.parseError(n);throw this.events.emit("register_error",r),this.onClose(),r}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const n=typeof e.data=="string"?$i(e.data):e.data;this.events.emit("payload",n)}onError(e,n){const r=this.parseError(n),s=r.message||r.toString(),i=Cd(e,s);this.events.emit("payload",i)}parseError(e,n=this.url){return vC(e,n,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Gy&&this.events.setMaxListeners(Gy)}};const Ky="error",JB="wss://relay.walletconnect.org",XB="wc",QB="universal_provider",Bl=`${XB}@2:${QB}:`,WC="https://rpc.walletconnect.org/v1/",Eo="generic",e9=`${WC}bundler`,er={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};function vg(t){return t==null||typeof t!="object"&&typeof t!="function"}function VC(t){return Object.getOwnPropertySymbols(t).filter(e=>Object.prototype.propertyIsEnumerable.call(t,e))}function GC(t){return t==null?t===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(t)}const t9="[object RegExp]",KC="[object String]",YC="[object Number]",ZC="[object Boolean]",JC="[object Arguments]",n9="[object Symbol]",r9="[object Date]",s9="[object Map]",i9="[object Set]",o9="[object Array]",a9="[object ArrayBuffer]",c9="[object Object]",l9="[object DataView]",u9="[object Uint8Array]",d9="[object Uint8ClampedArray]",h9="[object Uint16Array]",f9="[object Uint32Array]",p9="[object Int8Array]",g9="[object Int16Array]",m9="[object Int32Array]",y9="[object Float32Array]",w9="[object Float64Array]";function Eg(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function b9(t,e){return Io(t,void 0,t,new Map,e)}function Io(t,e,n,r=new Map,s=void 0){const i=s==null?void 0:s(t,e,n,r);if(i!=null)return i;if(vg(t))return t;if(r.has(t))return r.get(t);if(Array.isArray(t)){const o=new Array(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Io(t[a],a,n,r,s);return Object.hasOwn(t,"index")&&(o.index=t.index),Object.hasOwn(t,"input")&&(o.input=t.input),o}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp){const o=new RegExp(t.source,t.flags);return o.lastIndex=t.lastIndex,o}if(t instanceof Map){const o=new Map;r.set(t,o);for(const[a,c]of t)o.set(a,Io(c,a,n,r,s));return o}if(t instanceof Set){const o=new Set;r.set(t,o);for(const a of t)o.add(Io(a,void 0,n,r,s));return o}if(typeof Buffer<"u"&&Buffer.isBuffer(t))return t.subarray();if(Eg(t)){const o=new(Object.getPrototypeOf(t)).constructor(t.length);r.set(t,o);for(let a=0;a<t.length;a++)o[a]=Io(t[a],a,n,r,s);return o}if(t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);if(t instanceof DataView){const o=new DataView(t.buffer.slice(0),t.byteOffset,t.byteLength);return r.set(t,o),gi(o,t,n,r,s),o}if(typeof File<"u"&&t instanceof File){const o=new File([t],t.name,{type:t.type});return r.set(t,o),gi(o,t,n,r,s),o}if(t instanceof Blob){const o=new Blob([t],{type:t.type});return r.set(t,o),gi(o,t,n,r,s),o}if(t instanceof Error){const o=new t.constructor;return r.set(t,o),o.message=t.message,o.name=t.name,o.stack=t.stack,o.cause=t.cause,gi(o,t,n,r,s),o}if(typeof t=="object"&&v9(t)){const o=Object.create(Object.getPrototypeOf(t));return r.set(t,o),gi(o,t,n,r,s),o}return t}function gi(t,e,n=t,r,s){const i=[...Object.keys(e),...VC(e)];for(let o=0;o<i.length;o++){const a=i[o],c=Object.getOwnPropertyDescriptor(t,a);(c==null||c.writable)&&(t[a]=Io(e[a],a,n,r,s))}}function v9(t){switch(GC(t)){case JC:case o9:case a9:case l9:case ZC:case r9:case y9:case w9:case p9:case g9:case m9:case s9:case YC:case c9:case t9:case i9:case KC:case n9:case u9:case d9:case h9:case f9:return!0;default:return!1}}function E9(t,e){return b9(t,(n,r,s,i)=>{if(typeof t=="object")switch(Object.prototype.toString.call(t)){case YC:case KC:case ZC:{const o=new t.constructor(t==null?void 0:t.valueOf());return gi(o,t),o}case JC:{const o={};return gi(o,t),o.length=t.length,o[Symbol.iterator]=t[Symbol.iterator],o}default:return}})}function Yy(t){return E9(t)}function Zy(t){return t!==null&&typeof t=="object"&&GC(t)==="[object Arguments]"}function Jy(t){return typeof t=="object"&&t!==null}function C9(){}function _9(t){return Eg(t)}function A9(t){var n;if(typeof t!="object"||t==null)return!1;if(Object.getPrototypeOf(t)===null)return!0;if(Object.prototype.toString.call(t)!=="[object Object]"){const r=t[Symbol.toStringTag];return r==null||!((n=Object.getOwnPropertyDescriptor(t,Symbol.toStringTag))!=null&&n.writable)?!1:t.toString()===`[object ${r}]`}let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function I9(t){if(vg(t))return t;if(Array.isArray(t)||Eg(t)||t instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer)return t.slice(0);const e=Object.getPrototypeOf(t),n=e.constructor;if(t instanceof Date||t instanceof Map||t instanceof Set)return new n(t);if(t instanceof RegExp){const r=new n(t);return r.lastIndex=t.lastIndex,r}if(t instanceof DataView)return new n(t.buffer.slice(0));if(t instanceof Error){const r=new n(t.message);return r.stack=t.stack,r.name=t.name,r.cause=t.cause,r}if(typeof File<"u"&&t instanceof File)return new n([t],t.name,{type:t.type,lastModified:t.lastModified});if(typeof t=="object"){const r=Object.create(e);return Object.assign(r,t)}return t}function S9(t,...e){const n=e.slice(0,-1),r=e[e.length-1];let s=t;for(let i=0;i<n.length;i++){const o=n[i];s=sp(s,o,r,new Map)}return s}function sp(t,e,n,r){if(vg(t)&&(t=Object(t)),e==null||typeof e!="object")return t;if(r.has(e))return I9(r.get(e));if(r.set(e,t),Array.isArray(e)){e=e.slice();for(let i=0;i<e.length;i++)e[i]=e[i]??void 0}const s=[...Object.keys(e),...VC(e)];for(let i=0;i<s.length;i++){const o=s[i];let a=e[o],c=t[o];if(Zy(a)&&(a={...a}),Zy(c)&&(c={...c}),typeof Buffer<"u"&&Buffer.isBuffer(a)&&(a=Yy(a)),Array.isArray(a))if(typeof c=="object"&&c!=null){const u=[],d=Reflect.ownKeys(c);for(let h=0;h<d.length;h++){const f=d[h];u[f]=c[f]}c=u}else c=[];const l=n(c,a,o,t,e,r);l!=null?t[o]=l:Array.isArray(a)||Jy(c)&&Jy(a)?t[o]=sp(c,a,n,r):c==null&&A9(a)?t[o]=sp({},a,n,r):c==null&&_9(a)?t[o]=Yy(a):(c===void 0||a!==void 0)&&(t[o]=a)}return t}function N9(t,...e){return S9(t,...e,C9)}var x9=Object.defineProperty,T9=Object.defineProperties,P9=Object.getOwnPropertyDescriptors,Xy=Object.getOwnPropertySymbols,O9=Object.prototype.hasOwnProperty,R9=Object.prototype.propertyIsEnumerable,Qy=(t,e,n)=>e in t?x9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fl=(t,e)=>{for(var n in e||(e={}))O9.call(e,n)&&Qy(t,n,e[n]);if(Xy)for(var n of Xy(e))R9.call(e,n)&&Qy(t,n,e[n]);return t},D9=(t,e)=>T9(t,P9(e));function kn(t,e,n){var r;const s=xo(t);return((r=e.rpcMap)==null?void 0:r[s.reference])||`${WC}?chainId=${s.namespace}:${s.reference}&projectId=${n}`}function Zi(t){return t.includes(":")?t.split(":")[1]:t}function XC(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function $9(t,e){const n=Object.keys(e.namespaces).filter(s=>s.includes(t));if(!n.length)return[];const r=[];return n.forEach(s=>{const i=e.namespaces[s].accounts;r.push(...i)}),r}function jl(t={},e={}){const n=ew(t),r=ew(e);return N9(n,r)}function ew(t){var e,n,r,s,i;const o={};if(!qs(t))return o;for(const[a,c]of Object.entries(t)){const l=vd(a)?[a]:c.chains,u=c.methods||[],d=c.events||[],h=c.rpcMap||{},f=Ao(a);o[f]=D9(Fl(Fl({},o[f]),c),{chains:$r(l,(e=o[f])==null?void 0:e.chains),methods:$r(u,(n=o[f])==null?void 0:n.methods),events:$r(d,(r=o[f])==null?void 0:r.events)}),(qs(h)||qs(((s=o[f])==null?void 0:s.rpcMap)||{}))&&(o[f].rpcMap=Fl(Fl({},h),(i=o[f])==null?void 0:i.rpcMap))}return o}function tw(t){return t.includes(":")?t.split(":")[2]:t}function nw(t){const e={};for(const[n,r]of Object.entries(t)){const s=r.methods||[],i=r.events||[],o=r.accounts||[],a=vd(n)?[n]:r.chains?r.chains:XC(r.accounts);e[n]={chains:a,methods:s,events:i,accounts:o}}return e}function xh(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const QC={},Fe=t=>QC[t],Th=(t,e)=>{QC[t]=e};var k9=Object.defineProperty,U9=(t,e,n)=>e in t?k9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ao=(t,e,n)=>U9(t,typeof e!="symbol"?e+"":e,n);class L9{constructor(e){ao(this,"name","polkadot"),ao(this,"client"),ao(this,"httpProviders"),ao(this,"events"),ao(this,"namespace"),ao(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var M9=Object.defineProperty,B9=Object.defineProperties,F9=Object.getOwnPropertyDescriptors,rw=Object.getOwnPropertySymbols,j9=Object.prototype.hasOwnProperty,H9=Object.prototype.propertyIsEnumerable,ip=(t,e,n)=>e in t?M9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sw=(t,e)=>{for(var n in e||(e={}))j9.call(e,n)&&ip(t,n,e[n]);if(rw)for(var n of rw(e))H9.call(e,n)&&ip(t,n,e[n]);return t},iw=(t,e)=>B9(t,F9(e)),co=(t,e,n)=>ip(t,typeof e!="symbol"?e+"":e,n);class q9{constructor(e){co(this,"name","eip155"),co(this,"client"),co(this,"chainId"),co(this,"namespace"),co(this,"httpProviders"),co(this,"events"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(parseInt(e),n),this.chainId=parseInt(e),this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,n){const r=n||kn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=parseInt(Zi(n));e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}async handleSwitchChain(e){var n,r;let s=e.request.params?(n=e.request.params[0])==null?void 0:n.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const i=parseInt(s,16);if(this.isChainApproved(i))this.setDefaultChain(`${i}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:s}]},chainId:(r=this.namespace.chains)==null?void 0:r[0]}),this.setDefaultChain(`${i}`);else throw new Error(`Failed to switch to chain 'eip155:${i}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var n,r,s,i,o;const a=(r=(n=e.request)==null?void 0:n.params)==null?void 0:r[0],c=((i=(s=e.request)==null?void 0:s.params)==null?void 0:i[1])||[],l=`${a}${c.join(",")}`;if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const u=this.client.session.get(e.topic),d=((o=u==null?void 0:u.sessionProperties)==null?void 0:o.capabilities)||{};if(d!=null&&d[l])return d==null?void 0:d[l];const h=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:iw(sw({},u.sessionProperties||{}),{capabilities:iw(sw({},d||{}),{[l]:h})})})}catch(f){console.warn("Failed to update session with capabilities",f)}return h}async getCallStatus(e){var n,r;const s=this.client.session.get(e.topic),i=(n=s.sessionProperties)==null?void 0:n.bundler_name;if(i){const a=this.getBundlerUrl(e.chainId,i);try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from bundler",c,a)}}const o=(r=s.sessionProperties)==null?void 0:r.bundler_url;if(o)try{return await this.getUserOperationReceipt(o,e)}catch(a){console.warn("Failed to fetch call status from custom bundler",a,o)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,n){var r;const s=new URL(e),i=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ms("eth_getUserOperationReceipt",[(r=n.request.params)==null?void 0:r[0]]))});if(!i.ok)throw new Error(`Failed to fetch user operation receipt - ${i.status}`);return await i.json()}getBundlerUrl(e,n){return`${e9}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${n}`}}var z9=Object.defineProperty,W9=(t,e,n)=>e in t?z9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lo=(t,e,n)=>W9(t,typeof e!="symbol"?e+"":e,n);class V9{constructor(e){lo(this,"name","solana"),lo(this,"client"),lo(this,"httpProviders"),lo(this,"events"),lo(this,"namespace"),lo(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var G9=Object.defineProperty,K9=(t,e,n)=>e in t?G9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,uo=(t,e,n)=>K9(t,typeof e!="symbol"?e+"":e,n);class Y9{constructor(e){uo(this,"name","cosmos"),uo(this,"client"),uo(this,"httpProviders"),uo(this,"events"),uo(this,"namespace"),uo(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var Z9=Object.defineProperty,J9=(t,e,n)=>e in t?Z9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ho=(t,e,n)=>J9(t,typeof e!="symbol"?e+"":e,n);class X9{constructor(e){ho(this,"name","algorand"),ho(this,"client"),ho(this,"httpProviders"),ho(this,"events"),ho(this,"namespace"),ho(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(!this.httpProviders[e]){const r=n||kn(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new Qn(new mr(r,Fe("disableProviderPing")))}}var Q9=Object.defineProperty,eF=(t,e,n)=>e in t?Q9(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,fo=(t,e,n)=>eF(t,typeof e!="symbol"?e+"":e,n);class tF{constructor(e){fo(this,"name","cip34"),fo(this,"client"),fo(this,"httpProviders"),fo(this,"events"),fo(this,"namespace"),fo(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{const r=this.getCardanoRPCUrl(n),s=Zi(n);e[s]=this.createHttpProvider(s,r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}getCardanoRPCUrl(e){const n=this.namespace.rpcMap;if(n)return n[e]}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||this.getCardanoRPCUrl(e);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var nF=Object.defineProperty,rF=(t,e,n)=>e in t?nF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,po=(t,e,n)=>rF(t,typeof e!="symbol"?e+"":e,n);class sF{constructor(e){po(this,"name","elrond"),po(this,"client"),po(this,"httpProviders"),po(this,"events"),po(this,"namespace"),po(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var iF=Object.defineProperty,oF=(t,e,n)=>e in t?iF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,go=(t,e,n)=>oF(t,typeof e!="symbol"?e+"":e,n);class aF{constructor(e){go(this,"name","multiversx"),go(this,"client"),go(this,"httpProviders"),go(this,"events"),go(this,"namespace"),go(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;const s=Zi(n);e[s]=this.createHttpProvider(s,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var cF=Object.defineProperty,lF=(t,e,n)=>e in t?cF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mo=(t,e,n)=>lF(t,typeof e!="symbol"?e+"":e,n);class uF{constructor(e){mo(this,"name","near"),mo(this,"client"),mo(this,"httpProviders"),mo(this,"events"),mo(this,"namespace"),mo(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||kn(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{var r;e[n]=this.createHttpProvider(n,(r=this.namespace.rpcMap)==null?void 0:r[n])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace);return typeof r>"u"?void 0:new Qn(new mr(r,Fe("disableProviderPing")))}}var dF=Object.defineProperty,hF=(t,e,n)=>e in t?dF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,yo=(t,e,n)=>hF(t,typeof e!="symbol"?e+"":e,n);class fF{constructor(e){yo(this,"name","tezos"),yo(this,"client"),yo(this,"httpProviders"),yo(this,"events"),yo(this,"namespace"),yo(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,n){if(this.chainId=e,!this.httpProviders[e]){const r=n||kn(`${this.name}:${e}`,this.namespace);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(n=>{e[n]=this.createHttpProvider(n)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace);return typeof r>"u"?void 0:new Qn(new mr(r))}}var pF=Object.defineProperty,gF=(t,e,n)=>e in t?pF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wo=(t,e,n)=>gF(t,typeof e!="symbol"?e+"":e,n);class mF{constructor(e){wo(this,"name",Eo),wo(this,"client"),wo(this,"httpProviders"),wo(this,"events"),wo(this,"namespace"),wo(this,"chainId"),this.namespace=e.namespace,this.events=Fe("events"),this.client=Fe("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,n){this.httpProviders[e]||this.setHttpProvider(e,n),this.chainId=e,this.events.emit(er.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(n=>n.split(":")[1]===this.chainId.toString()).map(n=>n.split(":")[2]))]:[]}createHttpProviders(){var e,n;const r={};return(n=(e=this.namespace)==null?void 0:e.accounts)==null||n.forEach(s=>{const i=xo(s);r[`${i.namespace}:${i.reference}`]=this.createHttpProvider(s)}),r}getHttpProvider(e){const n=this.httpProviders[e];if(typeof n>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return n}setHttpProvider(e,n){const r=this.createHttpProvider(e,n);r&&(this.httpProviders[e]=r)}createHttpProvider(e,n){const r=n||kn(e,this.namespace,this.client.core.projectId);if(!r)throw new Error(`No RPC url provided for chainId: ${e}`);return new Qn(new mr(r,Fe("disableProviderPing")))}}var yF=Object.defineProperty,wF=Object.defineProperties,bF=Object.getOwnPropertyDescriptors,ow=Object.getOwnPropertySymbols,vF=Object.prototype.hasOwnProperty,EF=Object.prototype.propertyIsEnumerable,op=(t,e,n)=>e in t?yF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hl=(t,e)=>{for(var n in e||(e={}))vF.call(e,n)&&op(t,n,e[n]);if(ow)for(var n of ow(e))EF.call(e,n)&&op(t,n,e[n]);return t},Ph=(t,e)=>wF(t,bF(e)),Fn=(t,e,n)=>op(t,typeof e!="symbol"?e+"":e,n);let CF=class e_{constructor(e){Fn(this,"client"),Fn(this,"namespaces"),Fn(this,"optionalNamespaces"),Fn(this,"sessionProperties"),Fn(this,"scopedProperties"),Fn(this,"events",new jp),Fn(this,"rpcProviders",{}),Fn(this,"session"),Fn(this,"providerOpts"),Fn(this,"logger"),Fn(this,"uri"),Fn(this,"disableProviderPing",!1),this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:nl(Ko({level:(e==null?void 0:e.logger)||Ky})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const n=new e_(e);return await n.initialize(),n}async request(e,n,r){const[s,i]=this.validateChain(n);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Hl({},e),chainId:`${s}:${i}`,topic:this.session.topic,expiry:r})}sendAsync(e,n,r,s){const i=new Date().getTime();this.request(e,r,s).then(o=>n(null,Ed(i,o))).catch(o=>n(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:ct("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,n){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:r,response:s}=await this.client.authenticate(e,n);r&&(this.uri=r,this.events.emit("display_uri",r));const i=await s();if(this.session=i.session,this.session){const o=nw(this.session.namespaces);this.namespaces=jl(this.namespaces,o),await this.persist("namespaces",this.namespaces),this.onConnect()}return i}on(e,n){this.events.on(e,n)}once(e,n){this.events.once(e,n)}removeListener(e,n){this.events.removeListener(e,n)}off(e,n){this.events.off(e,n)}get isWalletConnect(){return!0}async pair(e){const{uri:n,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});n&&(this.uri=n,this.events.emit("display_uri",n));const s=await r();this.session=s;const i=nw(s.namespaces);return this.namespaces=jl(this.namespaces,i),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,n){try{if(!this.session)return;const[r,s]=this.validateChain(e),i=this.getProvider(r);i.name===Eo?i.setDefaultChain(`${r}:${s}`,n):i.setDefaultChain(s,n)}catch(r){if(!/Please call connect/.test(r.message))throw r}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const n=this.client.pairing.getAll();if(as(n)){for(const r of n)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${n.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,n;if(this.client=this.providerOpts.client||await HB.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Ky,relayUrl:this.providerOpts.relayUrl||JB,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),new Error(`The provided session: ${(n=(e=this.providerOpts)==null?void 0:e.session)==null?void 0:n.topic} doesn't exist in the Sign client`)}else{const r=this.client.session.getAll();this.session=r[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(n=>Ao(n)))];Th("client",this.client),Th("events",this.events),Th("disableProviderPing",this.disableProviderPing),e.forEach(n=>{if(!this.session)return;const r=$9(n,this.session),s=XC(r),i=jl(this.namespaces,this.optionalNamespaces),o=Ph(Hl({},i[n]),{accounts:r,chains:s});switch(n){case"eip155":this.rpcProviders[n]=new q9({namespace:o});break;case"algorand":this.rpcProviders[n]=new X9({namespace:o});break;case"solana":this.rpcProviders[n]=new V9({namespace:o});break;case"cosmos":this.rpcProviders[n]=new Y9({namespace:o});break;case"polkadot":this.rpcProviders[n]=new L9({namespace:o});break;case"cip34":this.rpcProviders[n]=new tF({namespace:o});break;case"elrond":this.rpcProviders[n]=new sF({namespace:o});break;case"multiversx":this.rpcProviders[n]=new aF({namespace:o});break;case"near":this.rpcProviders[n]=new uF({namespace:o});break;case"tezos":this.rpcProviders[n]=new fF({namespace:o});break;default:this.rpcProviders[Eo]?this.rpcProviders[Eo].updateNamespace(o):this.rpcProviders[Eo]=new mF({namespace:o})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var n;const{topic:r}=e;r===((n=this.session)==null?void 0:n.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var n;const{params:r,topic:s}=e;if(s!==((n=this.session)==null?void 0:n.topic))return;const{event:i}=r;if(i.name==="accountsChanged"){const o=i.data;o&&as(o)&&this.events.emit("accountsChanged",o.map(tw))}else if(i.name==="chainChanged"){const o=r.chainId,a=r.event.data,c=Ao(o),l=xh(o)!==xh(a)?`${c}:${xh(a)}`:o;this.onChainChanged(l)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:n})=>{var r,s;if(e!==((r=this.session)==null?void 0:r.topic))return;const{namespaces:i}=n,o=(s=this.client)==null?void 0:s.session.get(e);this.session=Ph(Hl({},o),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:n})}),this.client.on("session_delete",async e=>{var n;e.topic===((n=this.session)==null?void 0:n.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Ph(Hl({},ct("USER_DISCONNECTED")),{data:e.topic})))}),this.on(er.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Eo]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var n;this.getProvider(e).updateNamespace((n=this.session)==null?void 0:n.namespaces[e])})}setNamespaces(e){const{namespaces:n={},optionalNamespaces:r={},sessionProperties:s,scopedProperties:i}=e;this.optionalNamespaces=jl(n,r),this.sessionProperties=s,this.scopedProperties=i}validateChain(e){const[n,r]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[n,r];if(n&&!Object.keys(this.namespaces||{}).map(o=>Ao(o)).includes(n))throw new Error(`Namespace '${n}' is not configured. Please call connect() first with namespace config.`);if(n&&r)return[n,r];const s=Ao(Object.keys(this.namespaces)[0]),i=this.rpcProviders[s].getDefaultChain();return[s,i]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,n=!1){if(!this.namespaces)return;const[r,s]=this.validateChain(e);if(!s)return;this.updateNamespaceChain(r,s),this.events.emit("chainChanged",s);const i=this.getProvider(r).getDefaultChain();n||this.getProvider(r).setDefaultChain(s),this.emitAccountsChangedOnChainChange({namespace:r,previousChainId:i,newChainId:e}),await this.persist("namespaces",this.namespaces)}emitAccountsChangedOnChainChange({namespace:e,previousChainId:n,newChainId:r}){var s,i;try{if(n===r)return;const o=(i=(s=this.session)==null?void 0:s.namespaces[e])==null?void 0:i.accounts;if(!o)return;const a=o.filter(c=>c.includes(`${r}:`)).map(tw);if(!as(a))return;this.events.emit("accountsChanged",a)}catch(o){this.logger.warn("Failed to emit accountsChanged on chain change",o)}}updateNamespaceChain(e,n){if(!this.namespaces)return;const r=this.namespaces[e]?e:`${e}:${n}`,s={chains:[],methods:[],events:[],defaultChain:n};this.namespaces[r]?this.namespaces[r]&&(this.namespaces[r].defaultChain=n):this.namespaces[r]=s}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,n){var r;const s=((r=this.session)==null?void 0:r.topic)||"";await this.client.core.storage.setItem(`${Bl}/${e}${s}`,n)}async getFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";return await this.client.core.storage.getItem(`${Bl}/${e}${r}`)}async deleteFromStore(e){var n;const r=((n=this.session)==null?void 0:n.topic)||"";await this.client.core.storage.removeItem(`${Bl}/${e}${r}`)}async cleanupStorage(){var e;try{if(((e=this.client)==null?void 0:e.session.length)>0)return;const n=await this.client.core.storage.getKeys();for(const r of n)r.startsWith(Bl)&&await this.client.core.storage.removeItem(r)}catch(n){this.logger.warn("Failed to cleanup storage",n)}}},li=null;const Wn={getSIWX(){return j.state.siwx},async initializeIfEnabled(){var i;const t=j.state.siwx,e=A.getActiveCaipAddress();if(!(t&&e))return;const[n,r,s]=e.split(":");if(A.checkIfSupportedNetwork(n))try{if(li&&await li,(await t.getSessions(`${n}:${r}`,s)).length)return;await Me.open({view:"SIWXSignMessage"})}catch(o){console.error("SIWXUtil:initializeIfEnabled",o),Ve.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await((i=X._getClient())==null?void 0:i.disconnect().catch(console.error)),me.reset("Connect"),Pr.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){const t=j.state.siwx,e=oe.getPlainAddress(A.getActiveCaipAddress()),n=A.getActiveCaipNetwork(),r=X._getClient();if(!t)throw new Error("SIWX is not enabled");if(!e)throw new Error("No ActiveCaipAddress found");if(!n)throw new Error("No ActiveCaipNetwork or client found");if(!r)throw new Error("No ConnectionController client found");try{const s=await t.createMessage({chainId:n.caipNetworkId,accountAddress:e}),i=s.toString();J.getConnectorId(n.chainNamespace)===L.CONNECTOR_ID.AUTH&&me.pushTransactionStack({});const a=await r.signMessage(i);await t.addSession({data:s,message:i,signature:a}),A.setLastConnectedSIWECaipNetwork(n),Me.close(),Ve.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(s){const i=this.getSIWXEventProperties();(!Me.state.open||me.state.view==="ApproveTransaction")&&await Me.open({view:"SIWXSignMessage"}),Pr.showError("Error signing message"),Ve.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:i}),console.error("SWIXUtil:requestSignMessage",s)}},async cancelSignMessage(){var t;try{const e=this.getSIWX();if((t=e==null?void 0:e.getRequired)==null?void 0:t.call(e)){const r=A.getLastConnectedSIWECaipNetwork();if(r){const s=await(e==null?void 0:e.getSessions(r==null?void 0:r.caipNetworkId,oe.getPlainAddress(A.getActiveCaipAddress())||""));s&&s.length>0?await A.switchActiveNetwork(r):await X.disconnect()}else await X.disconnect()}else Me.close();Me.close(),Ve.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getAllSessions(){const t=this.getSIWX(),e=A.getAllRequestedCaipNetworks(),n=[];return await Promise.all(e.map(async r=>{const s=await(t==null?void 0:t.getSessions(r.caipNetworkId,oe.getPlainAddress(A.getActiveCaipAddress())||""));s&&n.push(...s)})),n},async getSessions(t){const e=j.state.siwx;let n=t==null?void 0:t.address;if(!n){const s=A.getActiveCaipAddress();n=oe.getPlainAddress(s)}let r=t==null?void 0:t.caipNetworkId;if(!r){const s=A.getActiveCaipNetwork();r=s==null?void 0:s.caipNetworkId}return e&&n&&r?e.getSessions(r,n):[]},async isSIWXCloseDisabled(){var e;const t=this.getSIWX();if(t){const n=me.state.view==="ApproveTransaction",r=me.state.view==="SIWXSignMessage";if(n||r)return((e=t.getRequired)==null?void 0:e.call(t))&&(await this.getSessions()).length===0}return!1},async authConnectorAuthenticate({authConnector:t,chainId:e,socialUri:n,preferredAccountType:r,chainNamespace:s}){var l;const i=Wn.getSIWX();if(!i||!s.includes(L.CHAIN.EVM)){const u=await t.connect({chainId:e,socialUri:n,preferredAccountType:r});return{address:u.address,chainId:u.chainId,accounts:u.accounts}}const o=await i.createMessage({chainId:((l=A.getActiveCaipNetwork())==null?void 0:l.caipNetworkId)||"",accountAddress:"<<AccountAddress>>"}),a={accountAddress:o.accountAddress,chainId:o.chainId,domain:o.domain,uri:o.uri,version:o.version,nonce:o.nonce,notBefore:o.notBefore,statement:o.statement,resources:o.resources,requestId:o.requestId,issuedAt:o.issuedAt,expirationTime:o.expirationTime,serializedMessage:o.toString()},c=await t.connect({chainId:e,socialUri:n,siwxMessage:a,preferredAccountType:r});return a.accountAddress=c.address,a.serializedMessage=c.message||"",c.signature&&c.message&&await Wn.addEmbeddedWalletSession(a,c.message,c.signature),{address:c.address,chainId:c.chainId,accounts:c.accounts}},async addEmbeddedWalletSession(t,e,n){if(li)return li;const r=Wn.getSIWX();return r?(li=r.addSession({data:t,message:e,signature:n}).finally(()=>{li=null}),li):Promise.resolve()},async universalProviderAuthenticate({universalProvider:t,chains:e,methods:n}){var a,c,l;const r=Wn.getSIWX(),s=new Set(e.map(u=>u.split(":")[0]));if(!r||s.size!==1||!s.has("eip155"))return!1;const i=await r.createMessage({chainId:((a=A.getActiveCaipNetwork())==null?void 0:a.caipNetworkId)||"",accountAddress:""}),o=await t.authenticate({nonce:i.nonce,domain:i.domain,uri:i.uri,exp:i.expirationTime,iat:i.issuedAt,nbf:i.notBefore,requestId:i.requestId,version:i.version,resources:i.resources,statement:i.statement,chainId:i.chainId,methods:n,chains:[i.chainId,...e.filter(u=>u!==i.chainId)]});if(Pr.showLoading("Authenticating...",{autoClose:!1}),ce.setConnectedWalletInfo({...o.session.peer.metadata,name:o.session.peer.metadata.name,icon:(c=o.session.peer.metadata.icons)==null?void 0:c[0],type:"WALLET_CONNECT"},Array.from(s)[0]),(l=o==null?void 0:o.auths)!=null&&l.length){const u=o.auths.map(d=>{const h=t.client.formatAuthMessage({request:d.p,iss:d.p.iss});return{data:{...d.p,accountAddress:d.p.iss.split(":").slice(-1).join(""),chainId:d.p.iss.split(":").slice(2,4).join(":"),uri:d.p.aud,version:d.p.version||i.version,expirationTime:d.p.exp,issuedAt:d.p.iat,notBefore:d.p.nbf},message:h,signature:d.s.s,cacao:d}});try{await r.setSessions(u),Ve.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:Wn.getSIWXEventProperties()})}catch(d){throw console.error("SIWX:universalProviderAuth - failed to set sessions",d),Ve.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:Wn.getSIWXEventProperties()}),await t.disconnect().catch(console.error),d}finally{Pr.hide()}}return!0},getSIWXEventProperties(){var e;const t=A.state.activeChain;if(!t)throw new Error("SIWXUtil:getSIWXEventProperties - namespace is required");return{network:((e=A.state.activeCaipNetwork)==null?void 0:e.caipNetworkId)||"",isSmartAccount:$n(t)===At.ACCOUNT_TYPES.SMART_ACCOUNT}},async clearSessions(){const t=this.getSIWX();t&&await t.setSessions([])}},it={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:L.CHAIN.EVM,ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"},Pn={ConnectorExplorerIds:{[L.CONNECTOR_ID.COINBASE]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[L.CONNECTOR_ID.COINBASE_SDK]:"fd20dc426fb37566d803205b19bbc1d4096b248ac04548e3cfb6b3a38bd033aa",[L.CONNECTOR_ID.SAFE]:"225affb176778569276e484e1b92637ad061b01e13a048b35a9d280c3b58970f",[L.CONNECTOR_ID.LEDGER]:"19177a98252e07ddfc9af2083ba8e07ef627cb6103467ffebb3f8f4205fd7927",[L.CONNECTOR_ID.OKX]:"971e689d0a5be527bac79629b4ee9b925e82208e5168b733496a09c0faed0709",[it.METMASK_CONNECTOR_NAME]:"c57ca95b47569778a828d19178114f4db188b89b763c899ba0be274e97267d96",[it.TRUST_CONNECTOR_NAME]:"4622a2b2d6af1c9844944291e5e7351a6aa24cd7b23099efac1b2fd875da31a0",[it.SOLFLARE_CONNECTOR_NAME]:"1ca0bdd4747578705b1939af023d120677c64fe6ca76add81fda36e350605e79",[it.PHANTOM_CONNECTOR_NAME]:"a797aa35c0fadbfc1a53e7f675162ed5226968b44a19ee3d24385c64d1d3c393",[it.COIN98_CONNECTOR_NAME]:"2a3c89040ac3b723a1972a33a125b1db11e258a6975d3a61252cd64e6ea5ea01",[it.MAGIC_EDEN_CONNECTOR_NAME]:"8b830a2b724a9c3fbab63af6f55ed29c9dfa8a55e732dc88c80a196a2ba136c6",[it.BACKPACK_CONNECTOR_NAME]:"2bd8c14e035c2d48f184aaa168559e86b0e3433228d3c4075900a221785019b0",[it.BITGET_CONNECTOR_NAME]:"38f5d18bd8522c244bdd70cb4a68e0e718865155811c043f052fb9f1c51de662",[it.FRONTIER_CONNECTOR_NAME]:"85db431492aa2e8672e93f4ea7acf10c88b97b867b0d373107af63dc4880f041",[it.XVERSE_CONNECTOR_NAME]:"2a87d74ae02e10bdd1f51f7ce6c4e1cc53cd5f2c0b6b5ad0d7b3007d2b13de7b",[it.LEATHER_CONNECTOR_NAME]:"483afe1df1df63daf313109971ff3ef8356ddf1cc4e45877d205eee0b7893a13"},NetworkImageIds:{1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900",2741:"fc2427d1-5af9-4a9c-8da5-6f94627cd900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},ConnectorImageIds:{[L.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[L.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[L.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[L.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[L.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[L.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},ConnectorNamesMap:{[L.CONNECTOR_ID.INJECTED]:"Browser Wallet",[L.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[L.CONNECTOR_ID.COINBASE]:"Coinbase",[L.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[L.CONNECTOR_ID.LEDGER]:"Ledger",[L.CONNECTOR_ID.SAFE]:"Safe"},ConnectorTypesMap:{[L.CONNECTOR_ID.INJECTED]:"INJECTED",[L.CONNECTOR_ID.WALLET_CONNECT]:"WALLET_CONNECT",[L.CONNECTOR_ID.EIP6963]:"ANNOUNCED",[L.CONNECTOR_ID.AUTH]:"AUTH",[it.CONNECTOR_TYPE_AUTH]:"AUTH"}},Pt={getCaipTokens(t){if(!t)return;const e={};return Object.entries(t).forEach(([n,r])=>{e[`${it.EIP155}:${n}`]=r}),e},isLowerCaseMatch(t,e){return(t==null?void 0:t.toLowerCase())===(e==null?void 0:e.toLowerCase())},getActiveNamespaceConnectedToAuth(){const t=A.state.activeChain;return L.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>J.getConnectorId(e)===L.CONNECTOR_ID.AUTH&&e===t)},withRetry({conditionFn:t,intervalMs:e,maxRetries:n}){let r=0;return new Promise(s=>{async function i(){return r+=1,await t()?s(!0):r>=n?s(!1):(setTimeout(i,e),null)}i()})}},_F=new AbortController,ut={EmbeddedWalletAbortController:_F,UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"ORIGIN_NOT_ALLOWED"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found. Please make sure it is included in 'networks' array in createAppKit function."},ORIGIN_NOT_ALLOWED:{shortMessage:"Origin Not Allowed",longMessage:()=>`🔧 Origin ${AF()?window.origin:"unknown"} not found on allow list. Please update your project configurations on dashboard.reown.com.`},IFRAME_LOAD_FAILED:{shortMessage:"Network Error - Could not load embedded wallet",longMessage:()=>"There was an issue loading the embedded wallet. Please try again later."},IFRAME_REQUEST_TIMEOUT:{shortMessage:"Embedded Wallet Request Timed Out",longMessage:()=>"There was an issue doing the request to the embedded wallet. Please try again later."},UNVERIFIED_DOMAIN:{shortMessage:"Unverified Domain",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at dashboard.reown.com."},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider. Please check your time settings and connect again."},INVALID_PROJECT_ID:{shortMessage:"Invalid Project ID",longMessage:"The project ID is invalid. Visit dashboard.reown.com to get a new one."},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured. Please update your project configurations on dashboard.reown.com."},SERVER_ERROR_APP_CONFIGURATION:{shortMessage:"Server Error",longMessage:t=>`Failed to get App Configuration ${t||""}`},RATE_LIMITED_APP_CONFIGURATION:{shortMessage:"Rate Limited",longMessage:"Rate limited when trying to get the App Configuration"}}};function AF(){return typeof window<"u"}const IF={createLogger(t,e="error"){const n=Ko({level:e}),{logger:r}=qp({opts:n});return r.error=(...s)=>{for(const i of s)if(i instanceof Error){t(i,...s);return}t(void 0,...s)},r}},SF="rpc.walletconnect.org";function aw(t,e){const n=new URL("https://rpc.walletconnect.org/v1/");return n.searchParams.set("chainId",t),n.searchParams.set("projectId",e),n.toString()}const Oh=["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"],Tr={extendRpcUrlWithProjectId(t,e){let n=!1;try{n=new URL(t).host===SF}catch{n=!1}if(n){const r=new URL(t);return r.searchParams.has("projectId")||r.searchParams.set("projectId",e),r.toString()}return t},isCaipNetwork(t){return"chainNamespace"in t&&"caipNetworkId"in t},getChainNamespace(t){return this.isCaipNetwork(t)?t.chainNamespace:L.CHAIN.EVM},getCaipNetworkId(t){return this.isCaipNetwork(t)?t.caipNetworkId:`${L.CHAIN.EVM}:${t.id}`},getDefaultRpcUrl(t,e,n){var s,i,o;const r=(o=(i=(s=t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null?void 0:o[0];return Oh.includes(e)?aw(e,n):r||""},extendCaipNetwork(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){var h,f,p,g,m,v,b;const s=this.getChainNamespace(t),i=this.getCaipNetworkId(t),o=(p=(f=(h=t.rpcUrls)==null?void 0:h.default)==null?void 0:f.http)==null?void 0:p[0],a=this.getDefaultRpcUrl(t,i,n),c=((v=(m=(g=t==null?void 0:t.rpcUrls)==null?void 0:g.chainDefault)==null?void 0:m.http)==null?void 0:v[0])||o,l=((b=r==null?void 0:r[i])==null?void 0:b.map(y=>y.url))||[],u=[...l,...a?[a]:[]],d=[...l];return c&&!d.includes(c)&&d.push(c),{...t,chainNamespace:s,caipNetworkId:i,assets:{imageId:Pn.NetworkImageIds[t.id],imageUrl:e==null?void 0:e[t.id]},rpcUrls:{...t.rpcUrls,default:{http:u},chainDefault:{http:d}}}},extendCaipNetworks(t,{customNetworkImageUrls:e,projectId:n,customRpcUrls:r}){return t.map(s=>Tr.extendCaipNetwork(s,{customNetworkImageUrls:e,customRpcUrls:r,projectId:n}))},getViemTransport(t,e,n){var s,i,o;const r=[];return n==null||n.forEach(a=>{r.push(El(a.url,a.config))}),Oh.includes(t.caipNetworkId)&&r.push(El(aw(t.caipNetworkId,e),{fetchOptions:{headers:{"Content-Type":"text/plain"}}})),(o=(i=(s=t==null?void 0:t.rpcUrls)==null?void 0:s.default)==null?void 0:i.http)==null||o.forEach(a=>{r.push(El(a))}),um(r)},extendWagmiTransports(t,e,n){if(Oh.includes(t.caipNetworkId)){const r=this.getDefaultRpcUrl(t,t.caipNetworkId,e);return um([n,El(r)])}return n},getUnsupportedNetwork(t){return{id:t.split(":")[1],caipNetworkId:t,name:L.UNSUPPORTED_NETWORK_NAME,chainNamespace:t.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}},getCaipNetworkFromStorage(t){var c;const e=V.getActiveCaipNetworkId(),n=A.getAllRequestedCaipNetworks(),r=Array.from(((c=A.state.chains)==null?void 0:c.keys())||[]),s=e==null?void 0:e.split(":")[0],i=s?r.includes(s):!1,o=n==null?void 0:n.find(l=>l.caipNetworkId===e);return i&&!o&&e?this.getUnsupportedNetwork(e):o||t||(n==null?void 0:n[0])}},Ru={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0,cosmos:void 0},pn=Xe({providers:{...Ru},providerIds:{...Ru}}),Ye={state:pn,subscribeKey(t,e){return Ft(pn,t,e)},subscribe(t){return Bt(pn,()=>{t(pn)})},subscribeProviders(t){return Bt(pn.providers,()=>t(pn.providers))},setProvider(t,e){t&&e&&(pn.providers[t]=xi(e))},getProvider(t){if(t)return pn.providers[t]},setProviderId(t,e){e&&(pn.providerIds[t]=e)},getProviderId(t){if(t)return pn.providerIds[t]},reset(){pn.providers={...Ru},pn.providerIds={...Ru}},resetChain(t){pn.providers[t]=void 0,pn.providerIds[t]=void 0}},t_={BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org"},NF={validateCaipAddress(t){var e;if(((e=t.split(":"))==null?void 0:e.length)!==3)throw new Error("Invalid CAIP Address");return t},parseCaipAddress(t){const e=t.split(":");if(e.length!==3)throw new Error(`Invalid CAIP-10 address: ${t}`);const[n,r,s]=e;if(!n||!r||!s)throw new Error(`Invalid CAIP-10 address: ${t}`);return{chainNamespace:n,chainId:r,address:s}},parseCaipNetworkId(t){const e=t.split(":");if(e.length!==2)throw new Error(`Invalid CAIP-2 network id: ${t}`);const[n,r]=e;if(!n||!r)throw new Error(`Invalid CAIP-2 network id: ${t}`);return{chainNamespace:n,chainId:r}}},cw={transactionHash:/^0x(?:[A-Fa-f0-9]{64})$/u,signedMessage:/^0x(?:[a-fA-F0-9]{62,})$/u},Lt={set(t,e){Rn.isClient&&localStorage.setItem(`${ae.STORAGE_KEY}${t}`,e)},get(t){return Rn.isClient?localStorage.getItem(`${ae.STORAGE_KEY}${t}`):null},delete(t,e){Rn.isClient&&(e?localStorage.removeItem(t):localStorage.removeItem(`${ae.STORAGE_KEY}${t}`))}},ql=30*1e3,Rn={checkIfAllowedToTriggerEmail(){const t=Lt.get(ae.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<ql){const n=Math.ceil((ql-e)/1e3);throw new Error(`Please try again after ${n} seconds`)}}},getTimeToNextEmailLogin(){const t=Lt.get(ae.LAST_EMAIL_LOGIN_TIME);if(t){const e=Date.now()-Number(t);if(e<ql)return Math.ceil((ql-e)/1e3)}return 0},checkIfRequestExists(t){return At.NOT_SAFE_RPC_METHODS.includes(t.method)||At.SAFE_RPC_METHODS.includes(t.method)},getResponseType(t){return typeof t=="string"&&((t==null?void 0:t.match(cw.transactionHash))||(t==null?void 0:t.match(cw.signedMessage)))?ae.RPC_RESPONSE_TYPE_TX:ae.RPC_RESPONSE_TYPE_OBJECT},checkIfRequestIsSafe(t){return At.SAFE_RPC_METHODS.includes(t.method)},isClient:typeof window<"u"};var Be;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Be||(Be={}));var ap;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(ap||(ap={}));const te=Be.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ks=t=>{switch(typeof t){case"undefined":return te.undefined;case"string":return te.string;case"number":return isNaN(t)?te.nan:te.number;case"boolean":return te.boolean;case"function":return te.function;case"bigint":return te.bigint;case"symbol":return te.symbol;case"object":return Array.isArray(t)?te.array:t===null?te.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?te.promise:typeof Map<"u"&&t instanceof Map?te.map:typeof Set<"u"&&t instanceof Set?te.set:typeof Date<"u"&&t instanceof Date?te.date:te.object;default:return te.unknown}},K=Be.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),xF=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class hr extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(n(o));else{let a=r,c=0;for(;c<o.path.length;){const l=o.path[c];c===o.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(o))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,Be.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}hr.create=t=>new hr(t);const Pc=(t,e)=>{let n;switch(t.code){case K.invalid_type:t.received===te.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case K.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Be.jsonStringifyReplacer)}`;break;case K.unrecognized_keys:n=`Unrecognized key(s) in object: ${Be.joinValues(t.keys,", ")}`;break;case K.invalid_union:n="Invalid input";break;case K.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Be.joinValues(t.options)}`;break;case K.invalid_enum_value:n=`Invalid enum value. Expected ${Be.joinValues(t.options)}, received '${t.received}'`;break;case K.invalid_arguments:n="Invalid function arguments";break;case K.invalid_return_type:n="Invalid function return type";break;case K.invalid_date:n="Invalid date";break;case K.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Be.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case K.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case K.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case K.custom:n="Invalid input";break;case K.invalid_intersection_types:n="Intersection results could not be merged";break;case K.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case K.not_finite:n="Number must be finite";break;default:n=e.defaultError,Be.assertNever(t)}return{message:n}};let n_=Pc;function TF(t){n_=t}function Du(){return n_}const $u=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],o={...s,path:i};let a="";const c=r.filter(l=>!!l).slice().reverse();for(const l of c)a=l(o,{data:e,defaultError:a}).message;return{...s,path:i,message:s.message||a}},PF=[];function ie(t,e){const n=$u({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Du(),Pc].filter(r=>!!r)});t.common.issues.push(n)}class en{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return ve;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n)r.push({key:await s.key,value:await s.value});return en.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return ve;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[i.value]=o.value)}return{status:e.value,value:r}}}const ve=Object.freeze({status:"aborted"}),r_=t=>({status:"dirty",value:t}),on=t=>({status:"valid",value:t}),cp=t=>t.status==="aborted",lp=t=>t.status==="dirty",Oc=t=>t.status==="valid",ku=t=>typeof Promise<"u"&&t instanceof Promise;var he;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(he||(he={}));class Fr{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const lw=(t,e)=>{if(Oc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new hr(t.common.issues);return this._error=n,this._error}}};function _e(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>o.code!=="invalid_type"?{message:a.defaultError}:typeof a.data>"u"?{message:r??a.defaultError}:{message:n??a.defaultError},description:s}}class Se{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ks(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:ks(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new en,ctx:{common:e.parent.common,data:e.data,parsedType:ks(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(ku(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ks(e)},i=this._parseSync({data:e,path:s.path,parent:s});return lw(s,i)}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ks(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(ku(s)?s:Promise.resolve(s));return lw(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:K.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new pr({schema:this,typeName:ye.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return cs.create(this,this._def)}nullable(){return Fi.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return fr.create(this,this._def)}promise(){return Ho.create(this,this._def)}or(e){return kc.create([this,e],this._def)}and(e){return Uc.create(this,e,this._def)}transform(e){return new pr({..._e(this._def),schema:this,typeName:ye.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new jc({..._e(this._def),innerType:this,defaultValue:n,typeName:ye.ZodDefault})}brand(){return new i_({typeName:ye.ZodBranded,type:this,..._e(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Bu({..._e(this._def),innerType:this,catchValue:n,typeName:ye.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return dl.create(this,e)}readonly(){return ju.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const OF=/^c[^\s-]{8,}$/i,RF=/^[a-z][a-z0-9]*$/,DF=/^[0-9A-HJKMNP-TV-Z]{26}$/,$F=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,kF=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,UF="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Rh;const LF=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,MF=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,BF=t=>t.precision?t.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${t.precision}}Z$`):t.precision===0?t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):t.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function FF(t,e){return!!((e==="v4"||!e)&&LF.test(t)||(e==="v6"||!e)&&MF.test(t))}class ur extends Se{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==te.string){const i=this._getOrReturnCtx(e);return ie(i,{code:K.invalid_type,expected:te.string,received:i.parsedType}),ve}const r=new en;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:K.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:K.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?ie(s,{code:K.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&ie(s,{code:K.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")kF.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"email",code:K.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Rh||(Rh=new RegExp(UF,"u")),Rh.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"emoji",code:K.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")$F.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"uuid",code:K.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")OF.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"cuid",code:K.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")RF.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"cuid2",code:K.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")DF.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"ulid",code:K.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),ie(s,{validation:"url",code:K.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"regex",code:K.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),ie(s,{code:K.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),ie(s,{code:K.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),ie(s,{code:K.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?BF(i).test(e.data)||(s=this._getOrReturnCtx(e,s),ie(s,{code:K.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?FF(e.data,i.version)||(s=this._getOrReturnCtx(e,s),ie(s,{validation:"ip",code:K.invalid_string,message:i.message}),r.dirty()):Be.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:K.invalid_string,...he.errToObj(r)})}_addCheck(e){return new ur({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...he.errToObj(e)})}url(e){return this._addCheck({kind:"url",...he.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...he.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...he.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...he.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...he.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...he.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...he.errToObj(e)})}datetime(e){var n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,...he.errToObj(e==null?void 0:e.message)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...he.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...he.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...he.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...he.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...he.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...he.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...he.errToObj(n)})}nonempty(e){return this.min(1,he.errToObj(e))}trim(){return new ur({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ur({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ur({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}ur.create=t=>{var e;return new ur({checks:[],typeName:ye.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,..._e(t)})};function jF(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class Js extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==te.number){const i=this._getOrReturnCtx(e);return ie(i,{code:K.invalid_type,expected:te.number,received:i.parsedType}),ve}let r;const s=new en;for(const i of this._def.checks)i.kind==="int"?Be.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:K.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:K.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:K.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?jF(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),ie(r,{code:K.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ie(r,{code:K.not_finite,message:i.message}),s.dirty()):Be.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,he.toString(n))}gt(e,n){return this.setLimit("min",e,!1,he.toString(n))}lte(e,n){return this.setLimit("max",e,!0,he.toString(n))}lt(e,n){return this.setLimit("max",e,!1,he.toString(n))}setLimit(e,n,r,s){return new Js({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:he.toString(s)}]})}_addCheck(e){return new Js({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:he.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:he.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:he.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:he.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:he.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:he.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:he.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:he.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:he.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Be.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Js.create=t=>new Js({checks:[],typeName:ye.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,..._e(t)});class Xs extends Se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==te.bigint){const i=this._getOrReturnCtx(e);return ie(i,{code:K.invalid_type,expected:te.bigint,received:i.parsedType}),ve}let r;const s=new en;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:K.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:K.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ie(r,{code:K.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Be.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,he.toString(n))}gt(e,n){return this.setLimit("min",e,!1,he.toString(n))}lte(e,n){return this.setLimit("max",e,!0,he.toString(n))}lt(e,n){return this.setLimit("max",e,!1,he.toString(n))}setLimit(e,n,r,s){return new Xs({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:he.toString(s)}]})}_addCheck(e){return new Xs({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:he.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:he.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:he.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:he.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:he.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Xs.create=t=>{var e;return new Xs({checks:[],typeName:ye.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,..._e(t)})};class Rc extends Se{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==te.boolean){const r=this._getOrReturnCtx(e);return ie(r,{code:K.invalid_type,expected:te.boolean,received:r.parsedType}),ve}return on(e.data)}}Rc.create=t=>new Rc({typeName:ye.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,..._e(t)});class Mi extends Se{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==te.date){const i=this._getOrReturnCtx(e);return ie(i,{code:K.invalid_type,expected:te.date,received:i.parsedType}),ve}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return ie(i,{code:K.invalid_date}),ve}const r=new en;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:K.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),ie(s,{code:K.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):Be.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Mi({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:he.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:he.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Mi.create=t=>new Mi({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:ye.ZodDate,..._e(t)});class Uu extends Se{_parse(e){if(this._getType(e)!==te.symbol){const r=this._getOrReturnCtx(e);return ie(r,{code:K.invalid_type,expected:te.symbol,received:r.parsedType}),ve}return on(e.data)}}Uu.create=t=>new Uu({typeName:ye.ZodSymbol,..._e(t)});class Dc extends Se{_parse(e){if(this._getType(e)!==te.undefined){const r=this._getOrReturnCtx(e);return ie(r,{code:K.invalid_type,expected:te.undefined,received:r.parsedType}),ve}return on(e.data)}}Dc.create=t=>new Dc({typeName:ye.ZodUndefined,..._e(t)});class $c extends Se{_parse(e){if(this._getType(e)!==te.null){const r=this._getOrReturnCtx(e);return ie(r,{code:K.invalid_type,expected:te.null,received:r.parsedType}),ve}return on(e.data)}}$c.create=t=>new $c({typeName:ye.ZodNull,..._e(t)});class jo extends Se{constructor(){super(...arguments),this._any=!0}_parse(e){return on(e.data)}}jo.create=t=>new jo({typeName:ye.ZodAny,..._e(t)});class Ii extends Se{constructor(){super(...arguments),this._unknown=!0}_parse(e){return on(e.data)}}Ii.create=t=>new Ii({typeName:ye.ZodUnknown,..._e(t)});class ds extends Se{_parse(e){const n=this._getOrReturnCtx(e);return ie(n,{code:K.invalid_type,expected:te.never,received:n.parsedType}),ve}}ds.create=t=>new ds({typeName:ye.ZodNever,..._e(t)});class Lu extends Se{_parse(e){if(this._getType(e)!==te.undefined){const r=this._getOrReturnCtx(e);return ie(r,{code:K.invalid_type,expected:te.void,received:r.parsedType}),ve}return on(e.data)}}Lu.create=t=>new Lu({typeName:ye.ZodVoid,..._e(t)});class fr extends Se{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==te.array)return ie(n,{code:K.invalid_type,expected:te.array,received:n.parsedType}),ve;if(s.exactLength!==null){const o=n.data.length>s.exactLength.value,a=n.data.length<s.exactLength.value;(o||a)&&(ie(n,{code:o?K.too_big:K.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(ie(n,{code:K.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(ie(n,{code:K.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((o,a)=>s.type._parseAsync(new Fr(n,o,n.path,a)))).then(o=>en.mergeArray(r,o));const i=[...n.data].map((o,a)=>s.type._parseSync(new Fr(n,o,n.path,a)));return en.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new fr({...this._def,minLength:{value:e,message:he.toString(n)}})}max(e,n){return new fr({...this._def,maxLength:{value:e,message:he.toString(n)}})}length(e,n){return new fr({...this._def,exactLength:{value:e,message:he.toString(n)}})}nonempty(e){return this.min(1,e)}}fr.create=(t,e)=>new fr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:ye.ZodArray,..._e(e)});function Co(t){if(t instanceof dt){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=cs.create(Co(r))}return new dt({...t._def,shape:()=>e})}else return t instanceof fr?new fr({...t._def,type:Co(t.element)}):t instanceof cs?cs.create(Co(t.unwrap())):t instanceof Fi?Fi.create(Co(t.unwrap())):t instanceof jr?jr.create(t.items.map(e=>Co(e))):t}class dt extends Se{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Be.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==te.object){const l=this._getOrReturnCtx(e);return ie(l,{code:K.invalid_type,expected:te.object,received:l.parsedType}),ve}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof ds&&this._def.unknownKeys==="strip"))for(const l in s.data)o.includes(l)||a.push(l);const c=[];for(const l of o){const u=i[l],d=s.data[l];c.push({key:{status:"valid",value:l},value:u._parse(new Fr(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof ds){const l=this._def.unknownKeys;if(l==="passthrough")for(const u of a)c.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(l==="strict")a.length>0&&(ie(s,{code:K.unrecognized_keys,keys:a}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const u of a){const d=s.data[u];c.push({key:{status:"valid",value:u},value:l._parse(new Fr(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const u of c){const d=await u.key;l.push({key:d,value:await u.value,alwaysSet:u.alwaysSet})}return l}).then(l=>en.mergeObjectSync(r,l)):en.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return he.errToObj,new dt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,o,a;const c=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&o!==void 0?o:r.defaultError;return n.code==="unrecognized_keys"?{message:(a=he.errToObj(e).message)!==null&&a!==void 0?a:c}:{message:c}}}:{}})}strip(){return new dt({...this._def,unknownKeys:"strip"})}passthrough(){return new dt({...this._def,unknownKeys:"passthrough"})}extend(e){return new dt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new dt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:ye.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new dt({...this._def,catchall:e})}pick(e){const n={};return Be.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new dt({...this._def,shape:()=>n})}omit(e){const n={};return Be.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new dt({...this._def,shape:()=>n})}deepPartial(){return Co(this)}partial(e){const n={};return Be.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new dt({...this._def,shape:()=>n})}required(e){const n={};return Be.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof cs;)i=i._def.innerType;n[r]=i}}),new dt({...this._def,shape:()=>n})}keyof(){return s_(Be.objectKeys(this.shape))}}dt.create=(t,e)=>new dt({shape:()=>t,unknownKeys:"strip",catchall:ds.create(),typeName:ye.ZodObject,..._e(e)});dt.strictCreate=(t,e)=>new dt({shape:()=>t,unknownKeys:"strict",catchall:ds.create(),typeName:ye.ZodObject,..._e(e)});dt.lazycreate=(t,e)=>new dt({shape:t,unknownKeys:"strip",catchall:ds.create(),typeName:ye.ZodObject,..._e(e)});class kc extends Se{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return n.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new hr(a.ctx.common.issues));return ie(n,{code:K.invalid_union,unionErrors:o}),ve}if(n.common.async)return Promise.all(r.map(async i=>{const o={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const c of r){const l={...n,common:{...n.common,issues:[]},parent:null},u=c._parseSync({data:n.data,path:n.path,parent:l});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:l}),l.common.issues.length&&o.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(c=>new hr(c));return ie(n,{code:K.invalid_union,unionErrors:a}),ve}}get options(){return this._def.options}}kc.create=(t,e)=>new kc({options:t,typeName:ye.ZodUnion,..._e(e)});const su=t=>t instanceof Mc?su(t.schema):t instanceof pr?su(t.innerType()):t instanceof Bc?[t.value]:t instanceof Qs?t.options:t instanceof Fc?Object.keys(t.enum):t instanceof jc?su(t._def.innerType):t instanceof Dc?[void 0]:t instanceof $c?[null]:null;class Sd extends Se{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==te.object)return ie(n,{code:K.invalid_type,expected:te.object,received:n.parsedType}),ve;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(ie(n,{code:K.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ve)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const o=su(i.shape[e]);if(!o)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Sd({typeName:ye.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,..._e(r)})}}function up(t,e){const n=ks(t),r=ks(e);if(t===e)return{valid:!0,data:t};if(n===te.object&&r===te.object){const s=Be.objectKeys(e),i=Be.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const c=up(t[a],e[a]);if(!c.valid)return{valid:!1};o[a]=c.data}return{valid:!0,data:o}}else if(n===te.array&&r===te.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],c=up(o,a);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return n===te.date&&r===te.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Uc extends Se{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,o)=>{if(cp(i)||cp(o))return ve;const a=up(i.value,o.value);return a.valid?((lp(i)||lp(o))&&n.dirty(),{status:n.value,value:a.data}):(ie(r,{code:K.invalid_intersection_types}),ve)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Uc.create=(t,e,n)=>new Uc({left:t,right:e,typeName:ye.ZodIntersection,..._e(n)});class jr extends Se{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.array)return ie(r,{code:K.invalid_type,expected:te.array,received:r.parsedType}),ve;if(r.data.length<this._def.items.length)return ie(r,{code:K.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ve;!this._def.rest&&r.data.length>this._def.items.length&&(ie(r,{code:K.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((o,a)=>{const c=this._def.items[a]||this._def.rest;return c?c._parse(new Fr(r,o,r.path,a)):null}).filter(o=>!!o);return r.common.async?Promise.all(i).then(o=>en.mergeArray(n,o)):en.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new jr({...this._def,rest:e})}}jr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new jr({items:t,typeName:ye.ZodTuple,rest:null,..._e(e)})};class Lc extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.object)return ie(r,{code:K.invalid_type,expected:te.object,received:r.parsedType}),ve;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in r.data)s.push({key:i._parse(new Fr(r,a,r.path,a)),value:o._parse(new Fr(r,r.data[a],r.path,a))});return r.common.async?en.mergeObjectAsync(n,s):en.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof Se?new Lc({keyType:e,valueType:n,typeName:ye.ZodRecord,..._e(r)}):new Lc({keyType:ur.create(),valueType:e,typeName:ye.ZodRecord,..._e(n)})}}class Mu extends Se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.map)return ie(r,{code:K.invalid_type,expected:te.map,received:r.parsedType}),ve;const s=this._def.keyType,i=this._def.valueType,o=[...r.data.entries()].map(([a,c],l)=>({key:s._parse(new Fr(r,a,r.path,[l,"key"])),value:i._parse(new Fr(r,c,r.path,[l,"value"]))}));if(r.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const c of o){const l=await c.key,u=await c.value;if(l.status==="aborted"||u.status==="aborted")return ve;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}})}else{const a=new Map;for(const c of o){const l=c.key,u=c.value;if(l.status==="aborted"||u.status==="aborted")return ve;(l.status==="dirty"||u.status==="dirty")&&n.dirty(),a.set(l.value,u.value)}return{status:n.value,value:a}}}}Mu.create=(t,e,n)=>new Mu({valueType:e,keyType:t,typeName:ye.ZodMap,..._e(n)});class Bi extends Se{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==te.set)return ie(r,{code:K.invalid_type,expected:te.set,received:r.parsedType}),ve;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(ie(r,{code:K.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(ie(r,{code:K.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function o(c){const l=new Set;for(const u of c){if(u.status==="aborted")return ve;u.status==="dirty"&&n.dirty(),l.add(u.value)}return{status:n.value,value:l}}const a=[...r.data.values()].map((c,l)=>i._parse(new Fr(r,c,r.path,l)));return r.common.async?Promise.all(a).then(c=>o(c)):o(a)}min(e,n){return new Bi({...this._def,minSize:{value:e,message:he.toString(n)}})}max(e,n){return new Bi({...this._def,maxSize:{value:e,message:he.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Bi.create=(t,e)=>new Bi({valueType:t,minSize:null,maxSize:null,typeName:ye.ZodSet,..._e(e)});class To extends Se{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==te.function)return ie(n,{code:K.invalid_type,expected:te.function,received:n.parsedType}),ve;function r(a,c){return $u({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Du(),Pc].filter(l=>!!l),issueData:{code:K.invalid_arguments,argumentsError:c}})}function s(a,c){return $u({data:a,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Du(),Pc].filter(l=>!!l),issueData:{code:K.invalid_return_type,returnTypeError:c}})}const i={errorMap:n.common.contextualErrorMap},o=n.data;if(this._def.returns instanceof Ho){const a=this;return on(async function(...c){const l=new hr([]),u=await a._def.args.parseAsync(c,i).catch(f=>{throw l.addIssue(r(c,f)),l}),d=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(d,i).catch(f=>{throw l.addIssue(s(d,f)),l})})}else{const a=this;return on(function(...c){const l=a._def.args.safeParse(c,i);if(!l.success)throw new hr([r(c,l.error)]);const u=Reflect.apply(o,this,l.data),d=a._def.returns.safeParse(u,i);if(!d.success)throw new hr([s(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new To({...this._def,args:jr.create(e).rest(Ii.create())})}returns(e){return new To({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new To({args:e||jr.create([]).rest(Ii.create()),returns:n||Ii.create(),typeName:ye.ZodFunction,..._e(r)})}}class Mc extends Se{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Mc.create=(t,e)=>new Mc({getter:t,typeName:ye.ZodLazy,..._e(e)});class Bc extends Se{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ie(n,{received:n.data,code:K.invalid_literal,expected:this._def.value}),ve}return{status:"valid",value:e.data}}get value(){return this._def.value}}Bc.create=(t,e)=>new Bc({value:t,typeName:ye.ZodLiteral,..._e(e)});function s_(t,e){return new Qs({values:t,typeName:ye.ZodEnum,..._e(e)})}class Qs extends Se{_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ie(n,{expected:Be.joinValues(r),received:n.parsedType,code:K.invalid_type}),ve}if(this._def.values.indexOf(e.data)===-1){const n=this._getOrReturnCtx(e),r=this._def.values;return ie(n,{received:n.data,code:K.invalid_enum_value,options:r}),ve}return on(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e){return Qs.create(e)}exclude(e){return Qs.create(this.options.filter(n=>!e.includes(n)))}}Qs.create=s_;class Fc extends Se{_parse(e){const n=Be.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==te.string&&r.parsedType!==te.number){const s=Be.objectValues(n);return ie(r,{expected:Be.joinValues(s),received:r.parsedType,code:K.invalid_type}),ve}if(n.indexOf(e.data)===-1){const s=Be.objectValues(n);return ie(r,{received:r.data,code:K.invalid_enum_value,options:s}),ve}return on(e.data)}get enum(){return this._def.values}}Fc.create=(t,e)=>new Fc({values:t,typeName:ye.ZodNativeEnum,..._e(e)});class Ho extends Se{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==te.promise&&n.common.async===!1)return ie(n,{code:K.invalid_type,expected:te.promise,received:n.parsedType}),ve;const r=n.parsedType===te.promise?n.data:Promise.resolve(n.data);return on(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Ho.create=(t,e)=>new Ho({type:t,typeName:ye.ZodPromise,..._e(e)});class pr extends Se{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ye.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{ie(r,o),o.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(r.data,i);return r.common.issues.length?{status:"dirty",value:r.data}:r.common.async?Promise.resolve(o).then(a=>this._def.schema._parseAsync({data:a,path:r.path,parent:r})):this._def.schema._parseSync({data:o,path:r.path,parent:r})}if(s.type==="refinement"){const o=a=>{const c=s.refinement(a,i);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?ve:(a.status==="dirty"&&n.dirty(),o(a.value),{status:n.value,value:a.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>a.status==="aborted"?ve:(a.status==="dirty"&&n.dirty(),o(a.value).then(()=>({status:n.value,value:a.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Oc(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:a}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Oc(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:n.value,value:a})):o);Be.assertNever(s)}}pr.create=(t,e,n)=>new pr({schema:t,typeName:ye.ZodEffects,effect:e,..._e(n)});pr.createWithPreprocess=(t,e,n)=>new pr({schema:e,effect:{type:"preprocess",transform:t},typeName:ye.ZodEffects,..._e(n)});class cs extends Se{_parse(e){return this._getType(e)===te.undefined?on(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}cs.create=(t,e)=>new cs({innerType:t,typeName:ye.ZodOptional,..._e(e)});class Fi extends Se{_parse(e){return this._getType(e)===te.null?on(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fi.create=(t,e)=>new Fi({innerType:t,typeName:ye.ZodNullable,..._e(e)});class jc extends Se{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===te.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}jc.create=(t,e)=>new jc({innerType:t,typeName:ye.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,..._e(e)});class Bu extends Se{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ku(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new hr(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new hr(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Bu.create=(t,e)=>new Bu({innerType:t,typeName:ye.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,..._e(e)});class Fu extends Se{_parse(e){if(this._getType(e)!==te.nan){const r=this._getOrReturnCtx(e);return ie(r,{code:K.invalid_type,expected:te.nan,received:r.parsedType}),ve}return{status:"valid",value:e.data}}}Fu.create=t=>new Fu({typeName:ye.ZodNaN,..._e(t)});const HF=Symbol("zod_brand");class i_ extends Se{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class dl extends Se{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ve:i.status==="dirty"?(n.dirty(),r_(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?ve:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new dl({in:e,out:n,typeName:ye.ZodPipeline})}}class ju extends Se{_parse(e){const n=this._def.innerType._parse(e);return Oc(n)&&(n.value=Object.freeze(n.value)),n}}ju.create=(t,e)=>new ju({innerType:t,typeName:ye.ZodReadonly,..._e(e)});const o_=(t,e={},n)=>t?jo.create().superRefine((r,s)=>{var i,o;if(!t(r)){const a=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(i=a.fatal)!==null&&i!==void 0?i:n)!==null&&o!==void 0?o:!0,l=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...l,fatal:c})}}):jo.create(),qF={object:dt.lazycreate};var ye;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(ye||(ye={}));const zF=(t,e={message:`Input not instance of ${t.name}`})=>o_(n=>n instanceof t,e),a_=ur.create,c_=Js.create,WF=Fu.create,VF=Xs.create,l_=Rc.create,GF=Mi.create,KF=Uu.create,YF=Dc.create,ZF=$c.create,JF=jo.create,XF=Ii.create,QF=ds.create,e7=Lu.create,t7=fr.create,n7=dt.create,r7=dt.strictCreate,s7=kc.create,i7=Sd.create,o7=Uc.create,a7=jr.create,c7=Lc.create,l7=Mu.create,u7=Bi.create,d7=To.create,h7=Mc.create,f7=Bc.create,p7=Qs.create,g7=Fc.create,m7=Ho.create,uw=pr.create,y7=cs.create,w7=Fi.create,b7=pr.createWithPreprocess,v7=dl.create,E7=()=>a_().optional(),C7=()=>c_().optional(),_7=()=>l_().optional(),A7={string:t=>ur.create({...t,coerce:!0}),number:t=>Js.create({...t,coerce:!0}),boolean:t=>Rc.create({...t,coerce:!0}),bigint:t=>Xs.create({...t,coerce:!0}),date:t=>Mi.create({...t,coerce:!0})},I7=ve;var w=Object.freeze({__proto__:null,defaultErrorMap:Pc,setErrorMap:TF,getErrorMap:Du,makeIssue:$u,EMPTY_PATH:PF,addIssueToContext:ie,ParseStatus:en,INVALID:ve,DIRTY:r_,OK:on,isAborted:cp,isDirty:lp,isValid:Oc,isAsync:ku,get util(){return Be},get objectUtil(){return ap},ZodParsedType:te,getParsedType:ks,ZodType:Se,ZodString:ur,ZodNumber:Js,ZodBigInt:Xs,ZodBoolean:Rc,ZodDate:Mi,ZodSymbol:Uu,ZodUndefined:Dc,ZodNull:$c,ZodAny:jo,ZodUnknown:Ii,ZodNever:ds,ZodVoid:Lu,ZodArray:fr,ZodObject:dt,ZodUnion:kc,ZodDiscriminatedUnion:Sd,ZodIntersection:Uc,ZodTuple:jr,ZodRecord:Lc,ZodMap:Mu,ZodSet:Bi,ZodFunction:To,ZodLazy:Mc,ZodLiteral:Bc,ZodEnum:Qs,ZodNativeEnum:Fc,ZodPromise:Ho,ZodEffects:pr,ZodTransformer:pr,ZodOptional:cs,ZodNullable:Fi,ZodDefault:jc,ZodCatch:Bu,ZodNaN:Fu,BRAND:HF,ZodBranded:i_,ZodPipeline:dl,ZodReadonly:ju,custom:o_,Schema:Se,ZodSchema:Se,late:qF,get ZodFirstPartyTypeKind(){return ye},coerce:A7,any:JF,array:t7,bigint:VF,boolean:l_,date:GF,discriminatedUnion:i7,effect:uw,enum:p7,function:d7,instanceof:zF,intersection:o7,lazy:h7,literal:f7,map:l7,nan:WF,nativeEnum:g7,never:QF,null:ZF,nullable:w7,number:c_,object:n7,oboolean:_7,onumber:C7,optional:y7,ostring:E7,pipeline:v7,preprocess:b7,promise:m7,record:c7,set:u7,strictObject:r7,string:a_,symbol:KF,transformer:uw,tuple:a7,undefined:YF,union:s7,unknown:XF,void:e7,NEVER:I7,ZodIssueCode:K,quotelessJson:xF,ZodError:hr});const ht=w.object({message:w.string()});function ne(t){return w.literal(ae[t])}const Nd=w.object({serializedMessage:w.string().optional(),accountAddress:w.string(),chainId:w.string(),notBefore:w.string().optional(),domain:w.string(),uri:w.string(),version:w.string(),nonce:w.string(),statement:w.string().optional(),resources:w.array(w.string()).optional(),requestId:w.string().optional(),issuedAt:w.string().optional(),expirationTime:w.string().optional()});w.object({accessList:w.array(w.string()),blockHash:w.string().nullable(),blockNumber:w.string().nullable(),chainId:w.string().or(w.number()),from:w.string(),gas:w.string(),hash:w.string(),input:w.string().nullable(),maxFeePerGas:w.string(),maxPriorityFeePerGas:w.string(),nonce:w.string(),r:w.string(),s:w.string(),to:w.string(),transactionIndex:w.string().nullable(),type:w.string(),v:w.string(),value:w.string()});const S7=w.object({chainId:w.string().or(w.number()),rpcUrl:w.optional(w.string())}),N7=w.object({email:w.string().email()}),x7=w.object({otp:w.string()}),T7=w.object({uri:w.string(),preferredAccountType:w.optional(w.string()),chainId:w.optional(w.string().or(w.number())),siwxMessage:w.optional(Nd),rpcUrl:w.optional(w.string())}),P7=w.object({chainId:w.optional(w.string().or(w.number())),preferredAccountType:w.optional(w.string()),socialUri:w.optional(w.string()),siwxMessage:w.optional(Nd),rpcUrl:w.optional(w.string())}),O7=w.object({provider:w.enum(["google","github","apple","facebook","x","discord"])}),R7=w.object({email:w.string().email()}),D7=w.object({otp:w.string()}),$7=w.object({otp:w.string()}),k7=w.object({themeMode:w.optional(w.enum(["light","dark"])),themeVariables:w.optional(w.record(w.string(),w.string().or(w.number()))),w3mThemeVariables:w.optional(w.record(w.string(),w.string()))}),U7=w.object({metadata:w.object({name:w.string(),description:w.string(),url:w.string(),icons:w.array(w.string())}).optional(),sdkVersion:w.string().optional(),sdkType:w.string().optional(),projectId:w.string()}),L7=w.object({type:w.string()}),M7=w.object({action:w.enum(["VERIFY_DEVICE","VERIFY_OTP","CONNECT"])}),B7=w.object({url:w.string()}),F7=w.object({userName:w.string()}),j7=w.object({email:w.string().optional().nullable(),address:w.string(),chainId:w.string().or(w.number()),accounts:w.array(w.object({address:w.string(),type:w.enum([At.ACCOUNT_TYPES.EOA,At.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),userName:w.string().optional().nullable(),preferredAccountType:w.optional(w.string()),signature:w.string().optional(),message:w.string().optional(),siwxMessage:w.optional(Nd)}),H7=w.object({action:w.enum(["VERIFY_PRIMARY_OTP","VERIFY_SECONDARY_OTP"])}),q7=w.object({email:w.string().email().optional().nullable(),address:w.string(),chainId:w.string().or(w.number()),smartAccountDeployed:w.optional(w.boolean()),accounts:w.array(w.object({address:w.string(),type:w.enum([At.ACCOUNT_TYPES.EOA,At.ACCOUNT_TYPES.SMART_ACCOUNT])})).optional(),preferredAccountType:w.optional(w.string()),signature:w.string().optional(),message:w.string().optional(),siwxMessage:w.optional(Nd)}),z7=w.object({uri:w.string()}),W7=w.object({isConnected:w.boolean()}),V7=w.object({chainId:w.string().or(w.number())}),G7=w.object({chainId:w.string().or(w.number())}),K7=w.object({newEmail:w.string().email()}),Y7=w.object({smartAccountEnabledNetworks:w.array(w.number())});w.object({address:w.string(),isDeployed:w.boolean()});const Z7=w.object({version:w.string().optional()}),J7=w.object({type:w.string(),address:w.string()}),X7=w.any(),Q7=w.object({method:w.literal("eth_accounts")}),ej=w.object({method:w.literal("eth_blockNumber")}),tj=w.object({method:w.literal("eth_call"),params:w.array(w.any())}),nj=w.object({method:w.literal("eth_chainId")}),rj=w.object({method:w.literal("eth_estimateGas"),params:w.array(w.any())}),sj=w.object({method:w.literal("eth_feeHistory"),params:w.array(w.any())}),ij=w.object({method:w.literal("eth_gasPrice")}),oj=w.object({method:w.literal("eth_getAccount"),params:w.array(w.any())}),aj=w.object({method:w.literal("eth_getBalance"),params:w.array(w.any())}),cj=w.object({method:w.literal("eth_getBlockByHash"),params:w.array(w.any())}),lj=w.object({method:w.literal("eth_getBlockByNumber"),params:w.array(w.any())}),uj=w.object({method:w.literal("eth_getBlockReceipts"),params:w.array(w.any())}),dj=w.object({method:w.literal("eth_getBlockTransactionCountByHash"),params:w.array(w.any())}),hj=w.object({method:w.literal("eth_getBlockTransactionCountByNumber"),params:w.array(w.any())}),fj=w.object({method:w.literal("eth_getCode"),params:w.array(w.any())}),pj=w.object({method:w.literal("eth_getFilterChanges"),params:w.array(w.any())}),gj=w.object({method:w.literal("eth_getFilterLogs"),params:w.array(w.any())}),mj=w.object({method:w.literal("eth_getLogs"),params:w.array(w.any())}),yj=w.object({method:w.literal("eth_getProof"),params:w.array(w.any())}),wj=w.object({method:w.literal("eth_getStorageAt"),params:w.array(w.any())}),bj=w.object({method:w.literal("eth_getTransactionByBlockHashAndIndex"),params:w.array(w.any())}),vj=w.object({method:w.literal("eth_getTransactionByBlockNumberAndIndex"),params:w.array(w.any())}),Ej=w.object({method:w.literal("eth_getTransactionByHash"),params:w.array(w.any())}),Cj=w.object({method:w.literal("eth_getTransactionCount"),params:w.array(w.any())}),_j=w.object({method:w.literal("eth_getTransactionReceipt"),params:w.array(w.any())}),Aj=w.object({method:w.literal("eth_getUncleCountByBlockHash"),params:w.array(w.any())}),Ij=w.object({method:w.literal("eth_getUncleCountByBlockNumber"),params:w.array(w.any())}),Sj=w.object({method:w.literal("eth_maxPriorityFeePerGas")}),Nj=w.object({method:w.literal("eth_newBlockFilter")}),xj=w.object({method:w.literal("eth_newFilter"),params:w.array(w.any())}),Tj=w.object({method:w.literal("eth_newPendingTransactionFilter")}),Pj=w.object({method:w.literal("eth_sendRawTransaction"),params:w.array(w.any())}),Oj=w.object({method:w.literal("eth_syncing"),params:w.array(w.any())}),Rj=w.object({method:w.literal("eth_uninstallFilter"),params:w.array(w.any())}),dw=w.object({method:w.literal("personal_sign"),params:w.array(w.any())}),Dj=w.object({method:w.literal("eth_signTypedData_v4"),params:w.array(w.any())}),$j=w.object({method:w.literal("eth_sendTransaction"),params:w.array(w.any())}),kj=w.object({method:w.literal("solana_signMessage"),params:w.object({message:w.string(),pubkey:w.string()})}),Uj=w.object({method:w.literal("solana_signTransaction"),params:w.object({transaction:w.string()})}),Lj=w.object({method:w.literal("solana_signAllTransactions"),params:w.object({transactions:w.array(w.string())})}),Mj=w.object({method:w.literal("solana_signAndSendTransaction"),params:w.object({transaction:w.string(),options:w.object({skipPreflight:w.boolean().optional(),preflightCommitment:w.enum(["processed","confirmed","finalized","recent","single","singleGossip","root","max"]).optional(),maxRetries:w.number().optional(),minContextSlot:w.number().optional()}).optional()})}),Bj=w.object({method:w.literal("wallet_sendCalls"),params:w.array(w.object({chainId:w.string().or(w.number()).optional(),from:w.string().optional(),version:w.string().optional(),capabilities:w.any().optional(),calls:w.array(w.object({to:w.string().startsWith("0x"),data:w.string().startsWith("0x").optional(),value:w.string().optional()}))}))}),Fj=w.object({method:w.literal("wallet_getCallsStatus"),params:w.array(w.string())}),jj=w.object({method:w.literal("wallet_getCapabilities"),params:w.array(w.string().or(w.number()).optional()).optional()}),Hj=w.object({method:w.literal("wallet_grantPermissions"),params:w.array(w.any())}),qj=w.object({method:w.literal("wallet_revokePermissions"),params:w.any()}),zj=w.object({method:w.literal("wallet_getAssets"),params:w.any()}),hw=w.object({token:w.string()}),re=w.object({id:w.string().optional()}),Dh={appEvent:re.extend({type:ne("APP_SWITCH_NETWORK"),payload:S7}).or(re.extend({type:ne("APP_CONNECT_EMAIL"),payload:N7})).or(re.extend({type:ne("APP_CONNECT_DEVICE")})).or(re.extend({type:ne("APP_CONNECT_OTP"),payload:x7})).or(re.extend({type:ne("APP_CONNECT_SOCIAL"),payload:T7})).or(re.extend({type:ne("APP_GET_FARCASTER_URI")})).or(re.extend({type:ne("APP_CONNECT_FARCASTER")})).or(re.extend({type:ne("APP_GET_USER"),payload:w.optional(P7)})).or(re.extend({type:ne("APP_GET_SOCIAL_REDIRECT_URI"),payload:O7})).or(re.extend({type:ne("APP_SIGN_OUT")})).or(re.extend({type:ne("APP_IS_CONNECTED"),payload:w.optional(hw)})).or(re.extend({type:ne("APP_GET_CHAIN_ID")})).or(re.extend({type:ne("APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS")})).or(re.extend({type:ne("APP_INIT_SMART_ACCOUNT")})).or(re.extend({type:ne("APP_SET_PREFERRED_ACCOUNT"),payload:L7})).or(re.extend({type:ne("APP_RPC_REQUEST"),payload:dw.or(zj).or(Q7).or(ej).or(tj).or(nj).or(rj).or(sj).or(ij).or(oj).or(aj).or(cj).or(lj).or(uj).or(dj).or(hj).or(fj).or(pj).or(gj).or(mj).or(yj).or(wj).or(bj).or(vj).or(Ej).or(Cj).or(_j).or(Aj).or(Ij).or(Sj).or(Nj).or(xj).or(Tj).or(Pj).or(Oj).or(Rj).or(dw).or(Dj).or($j).or(kj).or(Uj).or(Lj).or(Mj).or(Fj).or(Bj).or(jj).or(Hj).or(qj).and(w.object({chainId:w.string().or(w.number()).optional(),chainNamespace:w.enum(["eip155","solana","polkadot","bip122","cosmos"]).optional(),rpcUrl:w.string().optional()}))})).or(re.extend({type:ne("APP_UPDATE_EMAIL"),payload:R7})).or(re.extend({type:ne("APP_UPDATE_EMAIL_PRIMARY_OTP"),payload:D7})).or(re.extend({type:ne("APP_UPDATE_EMAIL_SECONDARY_OTP"),payload:$7})).or(re.extend({type:ne("APP_SYNC_THEME"),payload:k7})).or(re.extend({type:ne("APP_SYNC_DAPP_DATA"),payload:U7})).or(re.extend({type:ne("APP_RELOAD")})).or(re.extend({type:ne("APP_RPC_ABORT")})),frameEvent:re.extend({type:ne("FRAME_SWITCH_NETWORK_ERROR"),payload:ht}).or(re.extend({type:ne("FRAME_SWITCH_NETWORK_SUCCESS"),payload:G7})).or(re.extend({type:ne("FRAME_CONNECT_EMAIL_SUCCESS"),payload:M7})).or(re.extend({type:ne("FRAME_CONNECT_EMAIL_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_GET_FARCASTER_URI_SUCCESS"),payload:B7})).or(re.extend({type:ne("FRAME_GET_FARCASTER_URI_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_CONNECT_FARCASTER_SUCCESS"),payload:F7})).or(re.extend({type:ne("FRAME_CONNECT_FARCASTER_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_CONNECT_OTP_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_CONNECT_OTP_SUCCESS")})).or(re.extend({type:ne("FRAME_CONNECT_DEVICE_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_CONNECT_DEVICE_SUCCESS")})).or(re.extend({type:ne("FRAME_CONNECT_SOCIAL_SUCCESS"),payload:j7})).or(re.extend({type:ne("FRAME_CONNECT_SOCIAL_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_GET_USER_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_GET_USER_SUCCESS"),payload:q7})).or(re.extend({type:ne("FRAME_GET_SOCIAL_REDIRECT_URI_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_GET_SOCIAL_REDIRECT_URI_SUCCESS"),payload:z7})).or(re.extend({type:ne("FRAME_SIGN_OUT_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_SIGN_OUT_SUCCESS")})).or(re.extend({type:ne("FRAME_IS_CONNECTED_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_IS_CONNECTED_SUCCESS"),payload:W7})).or(re.extend({type:ne("FRAME_GET_CHAIN_ID_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_GET_CHAIN_ID_SUCCESS"),payload:V7})).or(re.extend({type:ne("FRAME_RPC_REQUEST_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_RPC_REQUEST_SUCCESS"),payload:X7})).or(re.extend({type:ne("FRAME_SESSION_UPDATE"),payload:hw})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_SUCCESS"),payload:H7})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_PRIMARY_OTP_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_PRIMARY_OTP_SUCCESS")})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_SECONDARY_OTP_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_UPDATE_EMAIL_SECONDARY_OTP_SUCCESS"),payload:K7})).or(re.extend({type:ne("FRAME_SYNC_THEME_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_SYNC_THEME_SUCCESS")})).or(re.extend({type:ne("FRAME_SYNC_DAPP_DATA_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_SYNC_DAPP_DATA_SUCCESS")})).or(re.extend({type:ne("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_SUCCESS"),payload:Y7})).or(re.extend({type:ne("FRAME_GET_SMART_ACCOUNT_ENABLED_NETWORKS_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_INIT_SMART_ACCOUNT_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_SET_PREFERRED_ACCOUNT_SUCCESS"),payload:J7})).or(re.extend({type:ne("FRAME_SET_PREFERRED_ACCOUNT_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_READY"),payload:Z7})).or(re.extend({type:ne("FRAME_RELOAD_ERROR"),payload:ht})).or(re.extend({type:ne("FRAME_RELOAD_SUCCESS")}))};function $h(t,e={}){var n;return typeof(e==null?void 0:e.type)=="string"&&((n=e==null?void 0:e.type)==null?void 0:n.includes(t))}function Wj({projectId:t,chainId:e,version:n,enableLogger:r,rpcUrl:s=t_.BLOCKCHAIN_API_RPC_URL}){const i=new URL(AA);return i.searchParams.set("projectId",t),i.searchParams.set("chainId",String(e)),i.searchParams.set("version",n),i.searchParams.set("enableLogger",String(r)),i.searchParams.set("rpcUrl",s),i.toString()}class Vj{constructor({projectId:e,isAppClient:n=!1,chainId:r="eip155:1",enableLogger:s=!0,rpcUrl:i=t_.BLOCKCHAIN_API_RPC_URL}){if(this.iframe=null,this.iframeIsReady=!1,this.initFrame=()=>{const o=document.getElementById("w3m-iframe");this.iframe&&!o&&document.body.appendChild(this.iframe)},this.events={registerFrameEventHandler:(o,a,c)=>{function l({data:u}){var h;if(!$h(ae.FRAME_EVENT_KEY,u))return;const d=Dh.frameEvent.safeParse(u);if(!d.success){console.warn("W3mFrame: invalid frame event",d.error.message);return}((h=d.data)==null?void 0:h.id)===o&&(a(d.data),window.removeEventListener("message",l))}Rn.isClient&&(window.addEventListener("message",l),c.addEventListener("abort",()=>{window.removeEventListener("message",l)}))},onFrameEvent:o=>{Rn.isClient&&window.addEventListener("message",({data:a})=>{if(!$h(ae.FRAME_EVENT_KEY,a))return;const c=Dh.frameEvent.safeParse(a);c.success?o(c.data):console.warn("W3mFrame: invalid frame event",c.error.message)})},onAppEvent:o=>{Rn.isClient&&window.addEventListener("message",({data:a})=>{if(!$h(ae.APP_EVENT_KEY,a))return;const c=Dh.appEvent.safeParse(a);c.success||console.warn("W3mFrame: invalid app event",c.error.message),o(a)})},postAppEvent:o=>{var a;if(Rn.isClient){if(!((a=this.iframe)!=null&&a.contentWindow))throw new Error("W3mFrame: iframe is not set");this.iframe.contentWindow.postMessage(o,"*")}},postFrameEvent:o=>{if(Rn.isClient){if(!parent)throw new Error("W3mFrame: parent is not set");parent.postMessage(o,"*")}}},this.projectId=e,this.frameLoadPromise=new Promise((o,a)=>{this.frameLoadPromiseResolver={resolve:o,reject:a}}),this.rpcUrl=i,n&&(this.frameLoadPromise=new Promise((o,a)=>{this.frameLoadPromiseResolver={resolve:o,reject:a}}),Rn.isClient)){const o=document.createElement("iframe");o.id="w3m-iframe",o.src=Wj({projectId:e,chainId:r,version:SA,enableLogger:s,rpcUrl:this.rpcUrl}),o.name="w3m-secure-iframe",o.style.position="fixed",o.style.zIndex="999999",o.style.display="none",o.style.border="none",o.style.animationDelay="0s, 50ms",o.style.borderBottomLeftRadius="clamp(0px, var(--wui-border-radius-l), 44px)",o.style.borderBottomRightRadius="clamp(0px, var(--wui-border-radius-l), 44px)",this.iframe=o,this.iframe.onerror=()=>{var a;(a=this.frameLoadPromiseResolver)==null||a.reject("Unable to load email login dependency")},this.events.onFrameEvent(a=>{var c;a.type==="@w3m-frame/READY"&&(this.iframeIsReady=!0,(c=this.frameLoadPromiseResolver)==null||c.resolve(void 0))})}}get networks(){const e=["eip155:1","eip155:5","eip155:11155111","eip155:10","eip155:420","eip155:42161","eip155:421613","eip155:137","eip155:80001","eip155:42220","eip155:1313161554","eip155:1313161555","eip155:56","eip155:97","eip155:43114","eip155:43113","eip155:324","eip155:280","eip155:100","eip155:8453","eip155:84531","eip155:84532","eip155:7777777","eip155:999","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1"].map(n=>({[n]:{rpcUrl:`${this.rpcUrl}/v1/?chainId=${n}&projectId=${this.projectId}`,chainId:n}}));return Object.assign({},...e)}}class Gj{constructor(e){var i;const n=Ko({level:IA}),{logger:r,chunkLoggerController:s}=qp({opts:n});this.logger=tn(r,this.constructor.name),this.chunkLoggerController=s,typeof window<"u"&&((i=this.chunkLoggerController)!=null&&i.downloadLogsBlobInBrowser)&&(window.downloadAppKitLogsBlob||(window.downloadAppKitLogsBlob={}),window.downloadAppKitLogsBlob.sdk=()=>{var o;(o=this.chunkLoggerController)!=null&&o.downloadLogsBlobInBrowser&&this.chunkLoggerController.downloadLogsBlobInBrowser({projectId:e})})}}class Kj{constructor({projectId:e,chainId:n,enableLogger:r=!0,onTimeout:s,abortController:i,getActiveCaipNetwork:o}){this.openRpcRequests=[],this.isInitialized=!1,r&&(this.w3mLogger=new Gj(e)),this.abortController=i,this.getActiveCaipNetwork=o;const a=this.getRpcUrl(n);this.w3mFrame=new Vj({projectId:e,isAppClient:!0,chainId:n,enableLogger:r,rpcUrl:a}),this.onTimeout=s,this.getLoginEmailUsed()&&this.createFrame()}async createFrame(){this.w3mFrame.initFrame(),this.initPromise=new Promise(e=>{this.w3mFrame.events.onFrameEvent(n=>{n.type===ae.FRAME_READY&&setTimeout(()=>{e()},500)})}),await this.initPromise,this.isInitialized=!0,this.initPromise=void 0}async init(){if(!this.isInitialized){if(this.initPromise){await this.initPromise;return}await this.createFrame()}}getLoginEmailUsed(){return!!Lt.get(ae.EMAIL_LOGIN_USED_KEY)}getEmail(){return Lt.get(ae.EMAIL)}getUsername(){return Lt.get(ae.SOCIAL_USERNAME)}async reload(){var e;try{await this.appEvent({type:ae.APP_RELOAD})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error reloading iframe"),n}}async connectEmail(e){var n;try{Rn.checkIfAllowedToTriggerEmail(),await this.init();const r=await this.appEvent({type:ae.APP_CONNECT_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting email"),r}}async connectDevice(){var e;try{return this.appEvent({type:ae.APP_CONNECT_DEVICE})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting device"),n}}async connectOtp(e){var n;try{return this.appEvent({type:ae.APP_CONNECT_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting otp"),r}}async isConnected(){var e;try{if(!this.getLoginEmailUsed())return{isConnected:!1};const n=await this.appEvent({type:ae.APP_IS_CONNECTED});return n!=null&&n.isConnected||this.deleteAuthLoginCache(),n}catch(n){throw this.deleteAuthLoginCache(),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error checking connection"),n}}async getChainId(){var e;try{const n=await this.appEvent({type:ae.APP_GET_CHAIN_ID});return this.setLastUsedChainId(n.chainId),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting chain id"),n}}async getSocialRedirectUri(e){var n;try{return await this.init(),this.appEvent({type:ae.APP_GET_SOCIAL_REDIRECT_URI,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error getting social redirect uri"),r}}async updateEmail(e){var n;try{const r=await this.appEvent({type:ae.APP_UPDATE_EMAIL,payload:e});return this.setNewLastEmailLoginTime(),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email"),r}}async updateEmailPrimaryOtp(e){var n;try{return this.appEvent({type:ae.APP_UPDATE_EMAIL_PRIMARY_OTP,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email primary otp"),r}}async updateEmailSecondaryOtp(e){var n;try{const r=await this.appEvent({type:ae.APP_UPDATE_EMAIL_SECONDARY_OTP,payload:e});return this.setLoginSuccess(r.newEmail),r}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error updating email secondary otp"),r}}async syncTheme(e){var n;try{return this.appEvent({type:ae.APP_SYNC_THEME,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing theme"),r}}async syncDappData(e){var n;try{return this.appEvent({type:ae.APP_SYNC_DAPP_DATA,payload:e})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error syncing dapp data"),r}}async getSmartAccountEnabledNetworks(){var e;try{const n=await this.appEvent({type:ae.APP_GET_SMART_ACCOUNT_ENABLED_NETWORKS});return this.persistSmartAccountEnabledNetworks(n.smartAccountEnabledNetworks),n}catch(n){throw this.persistSmartAccountEnabledNetworks([]),(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting smart account enabled networks"),n}}async setPreferredAccount(e){var n;try{return this.appEvent({type:ae.APP_SET_PREFERRED_ACCOUNT,payload:{type:e}})}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error setting preferred account"),r}}async connect(e){var n,r;if(e!=null&&e.socialUri)try{await this.init();const s=this.getRpcUrl(e.chainId),i=await this.appEvent({type:ae.APP_CONNECT_SOCIAL,payload:{uri:e.socialUri,preferredAccountType:e.preferredAccountType,chainId:e.chainId,siwxMessage:e.siwxMessage,rpcUrl:s}});return i.userName&&this.setSocialLoginSuccess(i.userName),this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(n=this.w3mLogger)==null||n.logger.error({error:s},"Error connecting social"),s}else try{const s=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,i=await this.getUser({chainId:s,preferredAccountType:e==null?void 0:e.preferredAccountType,siwxMessage:e==null?void 0:e.siwxMessage,rpcUrl:this.getRpcUrl(s)});return this.setLoginSuccess(i.email),this.setLastUsedChainId(i.chainId),this.user=i,i}catch(s){throw(r=this.w3mLogger)==null||r.logger.error({error:s},"Error connecting"),s}}async getUser(e){var n;try{await this.init();const r=(e==null?void 0:e.chainId)||this.getLastUsedChainId()||1,s=await this.appEvent({type:ae.APP_GET_USER,payload:{...e,chainId:r}});return this.user=s,s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error connecting"),r}}async connectSocial({uri:e,chainId:n,preferredAccountType:r}){var s;try{await this.init();const i=this.getRpcUrl(n),o=await this.appEvent({type:ae.APP_CONNECT_SOCIAL,payload:{uri:e,chainId:n,rpcUrl:i,preferredAccountType:r}});return o.userName&&this.setSocialLoginSuccess(o.userName),o}catch(i){throw(s=this.w3mLogger)==null||s.logger.error({error:i},"Error connecting social"),i}}async getFarcasterUri(){var e;try{return await this.init(),await this.appEvent({type:ae.APP_GET_FARCASTER_URI})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error getting farcaster uri"),n}}async connectFarcaster(){var e;try{const n=await this.appEvent({type:ae.APP_CONNECT_FARCASTER});return n.userName&&this.setSocialLoginSuccess(n.userName),n}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error connecting farcaster"),n}}async switchNetwork({chainId:e}){var n;try{const r=this.getRpcUrl(e),s=await this.appEvent({type:ae.APP_SWITCH_NETWORK,payload:{chainId:e,rpcUrl:r}});return this.setLastUsedChainId(s.chainId),s}catch(r){throw(n=this.w3mLogger)==null||n.logger.error({error:r},"Error switching network"),r}}async disconnect(){var e;try{return this.deleteAuthLoginCache(),await new Promise(async r=>{const s=setTimeout(()=>{r()},3e3);await this.appEvent({type:ae.APP_SIGN_OUT}),clearTimeout(s),r()})}catch(n){throw(e=this.w3mLogger)==null||e.logger.error({error:n},"Error disconnecting"),n}}async request(e){var r,s,i,o,a;const n=e;try{if(At.GET_CHAIN_ID===e.method)return this.getLastUsedChainId();const c=e.chainNamespace||"eip155",l=(r=this.getActiveCaipNetwork(c))==null?void 0:r.id;n.chainNamespace=c,n.chainId=l,n.rpcUrl=this.getRpcUrl(l),(s=this.rpcRequestHandler)==null||s.call(this,e);const u=await this.appEvent({type:ae.APP_RPC_REQUEST,payload:n});return(i=this.rpcSuccessHandler)==null||i.call(this,u,n),u}catch(c){throw(o=this.rpcErrorHandler)==null||o.call(this,c,n),(a=this.w3mLogger)==null||a.logger.error({error:c},"Error requesting"),c}}onRpcRequest(e){this.rpcRequestHandler=e}onRpcSuccess(e){this.rpcSuccessHandler=e}onRpcError(e){this.rpcErrorHandler=e}onIsConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ae.FRAME_IS_CONNECTED_SUCCESS&&n.payload.isConnected&&e()})}onNotConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ae.FRAME_IS_CONNECTED_ERROR&&e(),n.type===ae.FRAME_IS_CONNECTED_SUCCESS&&!n.payload.isConnected&&e()})}onConnect(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ae.FRAME_GET_USER_SUCCESS&&e(n.payload)})}onSocialConnected(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ae.FRAME_CONNECT_SOCIAL_SUCCESS&&e(n.payload)})}async getCapabilities(){try{return await this.request({method:"wallet_getCapabilities"})||{}}catch{return{}}}onSetPreferredAccount(e){this.w3mFrame.events.onFrameEvent(n=>{n.type===ae.FRAME_SET_PREFERRED_ACCOUNT_SUCCESS?e(n.payload):n.type===ae.FRAME_SET_PREFERRED_ACCOUNT_ERROR&&e({type:At.ACCOUNT_TYPES.EOA})})}getAvailableChainIds(){return Object.keys(this.w3mFrame.networks)}async rejectRpcRequests(){var e;try{await Promise.all(this.openRpcRequests.map(async({abortController:n,method:r})=>{At.SAFE_RPC_METHODS.includes(r)||n.abort(),await this.appEvent({type:ae.APP_RPC_ABORT})})),this.openRpcRequests=[]}catch(n){(e=this.w3mLogger)==null||e.logger.error({error:n},"Error aborting RPC request")}}async appEvent(e){let n,r;function s(c){return c.replace("@w3m-app/","")}const i=[ae.APP_SYNC_DAPP_DATA,ae.APP_SYNC_THEME,ae.APP_SET_PREFERRED_ACCOUNT],o=s(e.type);return!this.w3mFrame.iframeIsReady&&!i.includes(e.type)&&(r=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_load_failed"),this.abortController.abort()},2e4)),await this.w3mFrame.frameLoadPromise,clearTimeout(r),[ae.APP_CONNECT_EMAIL,ae.APP_CONNECT_DEVICE,ae.APP_CONNECT_OTP,ae.APP_CONNECT_SOCIAL,ae.APP_GET_SOCIAL_REDIRECT_URI].map(s).includes(o)&&(n=setTimeout(()=>{var c;(c=this.onTimeout)==null||c.call(this,"iframe_request_timeout"),this.abortController.abort()},12e4)),new Promise((c,l)=>{var f,p,g;const u=Math.random().toString(36).substring(7);(g=(f=this.w3mLogger)==null?void 0:(p=f.logger).info)==null||g.call(p,{event:e,id:u},"Sending app event"),this.w3mFrame.events.postAppEvent({...e,id:u});const d=new AbortController;if(o==="RPC_REQUEST"){const m=e;this.openRpcRequests=[...this.openRpcRequests,{...m.payload,abortController:d}]}d.signal.addEventListener("abort",()=>{o==="RPC_REQUEST"?l(new Error("Request was aborted")):o!=="GET_FARCASTER_URI"&&l(new Error("Something went wrong"))});function h(m,v){var b,y,N;m.id===u&&((y=v==null?void 0:(b=v.logger).info)==null||y.call(b,{framEvent:m,id:u},"Received frame response"),m.type===`@w3m-frame/${o}_SUCCESS`?(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in m&&c(m.payload),c(void 0)):m.type===`@w3m-frame/${o}_ERROR`&&(n&&clearTimeout(n),r&&clearTimeout(r),"payload"in m&&l(new Error(((N=m.payload)==null?void 0:N.message)||"An error occurred")),l(new Error("An error occurred"))))}this.w3mFrame.events.registerFrameEventHandler(u,m=>h(m,this.w3mLogger),this.abortController.signal)})}setNewLastEmailLoginTime(){Lt.set(ae.LAST_EMAIL_LOGIN_TIME,Date.now().toString())}setSocialLoginSuccess(e){Lt.set(ae.SOCIAL_USERNAME,e)}setLoginSuccess(e){e&&Lt.set(ae.EMAIL,e),Lt.set(ae.EMAIL_LOGIN_USED_KEY,"true"),Lt.delete(ae.LAST_EMAIL_LOGIN_TIME)}deleteAuthLoginCache(){Lt.delete(ae.EMAIL_LOGIN_USED_KEY),Lt.delete(ae.EMAIL),Lt.delete(ae.LAST_USED_CHAIN_KEY),Lt.delete(ae.SOCIAL_USERNAME)}setLastUsedChainId(e){e&&Lt.set(ae.LAST_USED_CHAIN_KEY,String(e))}getLastUsedChainId(){const e=Lt.get(ae.LAST_USED_CHAIN_KEY)??void 0,n=Number(e);return isNaN(n)?e:n}persistSmartAccountEnabledNetworks(e){Lt.set(ae.SMART_ACCOUNT_ENABLED_NETWORKS,e.join(","))}getRpcUrl(e){var s,i;let n=e===void 0?void 0:"eip155";typeof e=="string"&&(e.includes(":")?n=(s=NF.parseCaipNetworkId(e))==null?void 0:s.chainNamespace:Number.isInteger(Number(e))?n="eip155":n="solana");const r=this.getActiveCaipNetwork(n);return(i=r==null?void 0:r.rpcUrls.default.http)==null?void 0:i[0]}}class Si{constructor(){}static getInstance({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o}){return Si.instance||(Si.instance=new Kj({projectId:e,chainId:n,enableLogger:r,onTimeout:s,abortController:i,getActiveCaipNetwork:o})),Si.instance}}var fw={};const Yj={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(typeof process<"u"&&typeof fw<"u"?fw.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}},dp={filterOutDuplicatesByRDNS(t){const e=j.state.enableEIP6963?J.state.connectors:[],n=V.getRecentWallets(),r=e.map(a=>{var c;return(c=a.info)==null?void 0:c.rdns}).filter(Boolean),s=n.map(a=>a.rdns).filter(Boolean),i=r.concat(s);if(i.includes("io.metamask.mobile")&&oe.isMobile()){const a=i.indexOf("io.metamask.mobile");i[a]="io.metamask"}return t.filter(a=>!(a!=null&&a.rdns&&i.includes(String(a.rdns))||!(a!=null&&a.rdns)&&e.some(l=>l.name===a.name)))},filterOutDuplicatesByIds(t){const e=J.state.connectors.filter(a=>a.type==="ANNOUNCED"||a.type==="INJECTED"),n=V.getRecentWallets(),r=e.map(a=>a.explorerId),s=n.map(a=>a.id),i=r.concat(s);return t.filter(a=>!i.includes(a==null?void 0:a.id))},filterOutDuplicateWallets(t){const e=this.filterOutDuplicatesByRDNS(t);return this.filterOutDuplicatesByIds(e)},markWalletsAsInstalled(t){const{connectors:e}=J.state,{featuredWalletIds:n}=j.state,r=e.filter(o=>o.type==="ANNOUNCED").reduce((o,a)=>{var c;return(c=a.info)!=null&&c.rdns&&(o[a.info.rdns]=!0),o},{});return t.map(o=>({...o,installed:!!o.rdns&&!!r[o.rdns??""]})).sort((o,a)=>{const c=Number(a.installed)-Number(o.installed);if(c!==0)return c;if(n!=null&&n.length){const l=n.indexOf(o.id),u=n.indexOf(a.id);if(l!==-1&&u!==-1)return l-u;if(l!==-1)return-1;if(u!==-1)return 1}return 0})},getConnectOrderMethod(t,e){var c;const n=(t==null?void 0:t.connectMethodsOrder)||((c=j.state.features)==null?void 0:c.connectMethodsOrder),r=e||J.state.connectors;if(n)return n;const{injected:s,announced:i}=iu.getConnectorsByType(r,de.state.recommended,de.state.featured),o=s.filter(iu.showConnector),a=i.filter(iu.showConnector);return o.length||a.length?["wallet","email","social"]:Yj.DEFAULT_CONNECT_METHOD_ORDER},isExcluded(t){const e=!!t.rdns&&de.state.excludedWallets.some(r=>r.rdns===t.rdns),n=!!t.name&&de.state.excludedWallets.some(r=>Pt.isLowerCaseMatch(r.name,t.name));return e||n}},iu={getConnectorsByType(t,e,n){const{customWallets:r}=j.state,s=V.getRecentWallets(),i=dp.filterOutDuplicateWallets(e),o=dp.filterOutDuplicateWallets(n),a=t.filter(d=>d.type==="MULTI_CHAIN"),c=t.filter(d=>d.type==="ANNOUNCED"),l=t.filter(d=>d.type==="INJECTED"),u=t.filter(d=>d.type==="EXTERNAL");return{custom:r,recent:s,external:u,multiChain:a,announced:c,injected:l,recommended:i,featured:o}},showConnector(t){var s;const e=(s=t.info)==null?void 0:s.rdns,n=!!e&&de.state.excludedWallets.some(i=>!!i.rdns&&i.rdns===e),r=!!t.name&&de.state.excludedWallets.some(i=>Pt.isLowerCaseMatch(i.name,t.name));return!(t.type==="INJECTED"&&(t.name==="Browser Wallet"&&(!oe.isMobile()||oe.isMobile()&&!e&&!X.checkInstalled())||n||r)||(t.type==="ANNOUNCED"||t.type==="EXTERNAL")&&(n||r))},getIsConnectedWithWC(){return Array.from(A.state.chains.values()).some(n=>J.getConnectorId(n.namespace)===L.CONNECTOR_ID.WALLET_CONNECT)},getConnectorTypeOrder({recommended:t,featured:e,custom:n,recent:r,announced:s,injected:i,multiChain:o,external:a,overriddenConnectors:c=(l=>(l=j.state.features)==null?void 0:l.connectorTypeOrder)()??[]}){const h=[{type:"walletConnect",isEnabled:j.state.enableWalletConnect},{type:"recent",isEnabled:r.length>0},{type:"injected",isEnabled:[...i,...s,...o].length>0},{type:"featured",isEnabled:e.length>0},{type:"custom",isEnabled:n&&n.length>0},{type:"external",isEnabled:a.length>0},{type:"recommended",isEnabled:t.length>0}].filter(m=>m.isEnabled),f=new Set(h.map(m=>m.type)),p=c.filter(m=>f.has(m)).map(m=>({type:m,isEnabled:!0})),g=h.filter(({type:m})=>!p.some(({type:b})=>b===m));return Array.from(new Set([...p,...g].map(({type:m})=>m)))},getAuthName({email:t,socialUsername:e,socialProvider:n}){return e?n&&n==="discord"&&e.endsWith("0")?e.slice(0,-1):e:t.length>30?`${t.slice(0,-3)}...`:t},async fetchProviderData(t){var e,n;try{if(t.name==="Browser Wallet"&&!oe.isMobile())return{accounts:[],chainId:void 0};if(t.id===L.CONNECTOR_ID.AUTH)return{accounts:[],chainId:void 0};const[r,s]=await Promise.all([(e=t.provider)==null?void 0:e.request({method:"eth_accounts"}),(n=t.provider)==null?void 0:n.request({method:"eth_chainId"}).then(i=>Number(i))]);return{accounts:r,chainId:s}}catch(r){return console.warn(`Failed to fetch provider data for ${t.name}`,r),{accounts:[],chainId:void 0}}}};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ou=globalThis,Cg=ou.ShadowRoot&&(ou.ShadyCSS===void 0||ou.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,_g=Symbol(),pw=new WeakMap;let u_=class{constructor(e,n,r){if(this._$cssResult$=!0,r!==_g)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=n}get styleSheet(){let e=this.o;const n=this.t;if(Cg&&e===void 0){const r=n!==void 0&&n.length===1;r&&(e=pw.get(n)),e===void 0&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&pw.set(n,e))}return e}toString(){return this.cssText}};const jn=t=>new u_(typeof t=="string"?t:t+"",void 0,_g),Po=(t,...e)=>{const n=t.length===1?t[0]:e.reduce((r,s,i)=>r+(o=>{if(o._$cssResult$===!0)return o.cssText;if(typeof o=="number")return o;throw Error("Value passed to 'css' function must be a 'css' function result: "+o+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[i+1],t[0]);return new u_(n,t,_g)},Zj=(t,e)=>{if(Cg)t.adoptedStyleSheets=e.map(n=>n instanceof CSSStyleSheet?n:n.styleSheet);else for(const n of e){const r=document.createElement("style"),s=ou.litNonce;s!==void 0&&r.setAttribute("nonce",s),r.textContent=n.cssText,t.appendChild(r)}},gw=Cg?t=>t:t=>t instanceof CSSStyleSheet?(e=>{let n="";for(const r of e.cssRules)n+=r.cssText;return jn(n)})(t):t;/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:Jj,defineProperty:Xj,getOwnPropertyDescriptor:Qj,getOwnPropertyNames:eH,getOwnPropertySymbols:tH,getPrototypeOf:nH}=Object,zs=globalThis,mw=zs.trustedTypes,rH=mw?mw.emptyScript:"",kh=zs.reactiveElementPolyfillSupport,Ka=(t,e)=>t,hp={toAttribute(t,e){switch(e){case Boolean:t=t?rH:null;break;case Object:case Array:t=t==null?t:JSON.stringify(t)}return t},fromAttribute(t,e){let n=t;switch(e){case Boolean:n=t!==null;break;case Number:n=t===null?null:Number(t);break;case Object:case Array:try{n=JSON.parse(t)}catch{n=null}}return n}},d_=(t,e)=>!Jj(t,e),yw={attribute:!0,type:String,converter:hp,reflect:!1,useDefault:!1,hasChanged:d_};Symbol.metadata??(Symbol.metadata=Symbol("metadata")),zs.litPropertyMetadata??(zs.litPropertyMetadata=new WeakMap);let _o=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??(this.l=[])).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,n=yw){if(n.state&&(n.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((n=Object.create(n)).wrapped=!0),this.elementProperties.set(e,n),!n.noAccessor){const r=Symbol(),s=this.getPropertyDescriptor(e,r,n);s!==void 0&&Xj(this.prototype,e,s)}}static getPropertyDescriptor(e,n,r){const{get:s,set:i}=Qj(this.prototype,e)??{get(){return this[n]},set(o){this[n]=o}};return{get:s,set(o){const a=s==null?void 0:s.call(this);i==null||i.call(this,o),this.requestUpdate(e,a,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??yw}static _$Ei(){if(this.hasOwnProperty(Ka("elementProperties")))return;const e=nH(this);e.finalize(),e.l!==void 0&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(Ka("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(Ka("properties"))){const n=this.properties,r=[...eH(n),...tH(n)];for(const s of r)this.createProperty(s,n[s])}const e=this[Symbol.metadata];if(e!==null){const n=litPropertyMetadata.get(e);if(n!==void 0)for(const[r,s]of n)this.elementProperties.set(r,s)}this._$Eh=new Map;for(const[n,r]of this.elementProperties){const s=this._$Eu(n,r);s!==void 0&&this._$Eh.set(s,n)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const n=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const s of r)n.unshift(gw(s))}else e!==void 0&&n.push(gw(e));return n}static _$Eu(e,n){const r=n.attribute;return r===!1?void 0:typeof r=="string"?r:typeof e=="string"?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){var e;this._$ES=new Promise(n=>this.enableUpdating=n),this._$AL=new Map,this._$E_(),this.requestUpdate(),(e=this.constructor.l)==null||e.forEach(n=>n(this))}addController(e){var n;(this._$EO??(this._$EO=new Set)).add(e),this.renderRoot!==void 0&&this.isConnected&&((n=e.hostConnected)==null||n.call(e))}removeController(e){var n;(n=this._$EO)==null||n.delete(e)}_$E_(){const e=new Map,n=this.constructor.elementProperties;for(const r of n.keys())this.hasOwnProperty(r)&&(e.set(r,this[r]),delete this[r]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Zj(e,this.constructor.elementStyles),e}connectedCallback(){var e;this.renderRoot??(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostConnected)==null?void 0:r.call(n)})}enableUpdating(e){}disconnectedCallback(){var e;(e=this._$EO)==null||e.forEach(n=>{var r;return(r=n.hostDisconnected)==null?void 0:r.call(n)})}attributeChangedCallback(e,n,r){this._$AK(e,r)}_$ET(e,n){var i;const r=this.constructor.elementProperties.get(e),s=this.constructor._$Eu(e,r);if(s!==void 0&&r.reflect===!0){const o=(((i=r.converter)==null?void 0:i.toAttribute)!==void 0?r.converter:hp).toAttribute(n,r.type);this._$Em=e,o==null?this.removeAttribute(s):this.setAttribute(s,o),this._$Em=null}}_$AK(e,n){var i,o;const r=this.constructor,s=r._$Eh.get(e);if(s!==void 0&&this._$Em!==s){const a=r.getPropertyOptions(s),c=typeof a.converter=="function"?{fromAttribute:a.converter}:((i=a.converter)==null?void 0:i.fromAttribute)!==void 0?a.converter:hp;this._$Em=s;const l=c.fromAttribute(n,a.type);this[s]=l??((o=this._$Ej)==null?void 0:o.get(s))??l,this._$Em=null}}requestUpdate(e,n,r){var s;if(e!==void 0){const i=this.constructor,o=this[e];if(r??(r=i.getPropertyOptions(e)),!((r.hasChanged??d_)(o,n)||r.useDefault&&r.reflect&&o===((s=this._$Ej)==null?void 0:s.get(e))&&!this.hasAttribute(i._$Eu(e,r))))return;this.C(e,n,r)}this.isUpdatePending===!1&&(this._$ES=this._$EP())}C(e,n,{useDefault:r,reflect:s,wrapped:i},o){r&&!(this._$Ej??(this._$Ej=new Map)).has(e)&&(this._$Ej.set(e,o??n??this[e]),i!==!0||o!==void 0)||(this._$AL.has(e)||(this.hasUpdated||r||(n=void 0),this._$AL.set(e,n)),s===!0&&this._$Em!==e&&(this._$Eq??(this._$Eq=new Set)).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(n){Promise.reject(n)}const e=this.scheduleUpdate();return e!=null&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var r;if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??(this.renderRoot=this.createRenderRoot()),this._$Ep){for(const[i,o]of this._$Ep)this[i]=o;this._$Ep=void 0}const s=this.constructor.elementProperties;if(s.size>0)for(const[i,o]of s){const{wrapped:a}=o,c=this[i];a!==!0||this._$AL.has(i)||c===void 0||this.C(i,void 0,o,c)}}let e=!1;const n=this._$AL;try{e=this.shouldUpdate(n),e?(this.willUpdate(n),(r=this._$EO)==null||r.forEach(s=>{var i;return(i=s.hostUpdate)==null?void 0:i.call(s)}),this.update(n)):this._$EM()}catch(s){throw e=!1,this._$EM(),s}e&&this._$AE(n)}willUpdate(e){}_$AE(e){var n;(n=this._$EO)==null||n.forEach(r=>{var s;return(s=r.hostUpdated)==null?void 0:s.call(r)}),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&(this._$Eq=this._$Eq.forEach(n=>this._$ET(n,this[n]))),this._$EM()}updated(e){}firstUpdated(e){}};_o.elementStyles=[],_o.shadowRootOptions={mode:"open"},_o[Ka("elementProperties")]=new Map,_o[Ka("finalized")]=new Map,kh==null||kh({ReactiveElement:_o}),(zs.reactiveElementVersions??(zs.reactiveElementVersions=[])).push("2.1.1");/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ya=globalThis,Hu=Ya.trustedTypes,ww=Hu?Hu.createPolicy("lit-html",{createHTML:t=>t}):void 0,h_="$lit$",Us=`lit$${Math.random().toFixed(9).slice(2)}$`,f_="?"+Us,sH=`<${f_}>`,ji=document,Hc=()=>ji.createComment(""),qc=t=>t===null||typeof t!="object"&&typeof t!="function",Ag=Array.isArray,iH=t=>Ag(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",Uh=`[ 	
\f\r]`,Sa=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,bw=/-->/g,vw=/>/g,ui=RegExp(`>|${Uh}(?:([^\\s"'>=/]+)(${Uh}*=${Uh}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),Ew=/'/g,Cw=/"/g,p_=/^(?:script|style|textarea|title)$/i,g_=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),Hz=g_(1),qz=g_(2),qo=Symbol.for("lit-noChange"),Tt=Symbol.for("lit-nothing"),_w=new WeakMap,Ai=ji.createTreeWalker(ji,129);function m_(t,e){if(!Ag(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return ww!==void 0?ww.createHTML(e):e}const oH=(t,e)=>{const n=t.length-1,r=[];let s,i=e===2?"<svg>":e===3?"<math>":"",o=Sa;for(let a=0;a<n;a++){const c=t[a];let l,u,d=-1,h=0;for(;h<c.length&&(o.lastIndex=h,u=o.exec(c),u!==null);)h=o.lastIndex,o===Sa?u[1]==="!--"?o=bw:u[1]!==void 0?o=vw:u[2]!==void 0?(p_.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=ui):u[3]!==void 0&&(o=ui):o===ui?u[0]===">"?(o=s??Sa,d=-1):u[1]===void 0?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=u[3]===void 0?ui:u[3]==='"'?Cw:Ew):o===Cw||o===Ew?o=ui:o===bw||o===vw?o=Sa:(o=ui,s=void 0);const f=o===ui&&t[a+1].startsWith("/>")?" ":"";i+=o===Sa?c+sH:d>=0?(r.push(l),c.slice(0,d)+h_+c.slice(d)+Us+f):c+Us+(d===-2?a:f)}return[m_(t,i+(t[n]||"<?>")+(e===2?"</svg>":e===3?"</math>":"")),r]};class zc{constructor({strings:e,_$litType$:n},r){let s;this.parts=[];let i=0,o=0;const a=e.length-1,c=this.parts,[l,u]=oH(e,n);if(this.el=zc.createElement(l,r),Ai.currentNode=this.el.content,n===2||n===3){const d=this.el.content.firstChild;d.replaceWith(...d.childNodes)}for(;(s=Ai.nextNode())!==null&&c.length<a;){if(s.nodeType===1){if(s.hasAttributes())for(const d of s.getAttributeNames())if(d.endsWith(h_)){const h=u[o++],f=s.getAttribute(d).split(Us),p=/([.?@])?(.*)/.exec(h);c.push({type:1,index:i,name:p[2],strings:f,ctor:p[1]==="."?cH:p[1]==="?"?lH:p[1]==="@"?uH:xd}),s.removeAttribute(d)}else d.startsWith(Us)&&(c.push({type:6,index:i}),s.removeAttribute(d));if(p_.test(s.tagName)){const d=s.textContent.split(Us),h=d.length-1;if(h>0){s.textContent=Hu?Hu.emptyScript:"";for(let f=0;f<h;f++)s.append(d[f],Hc()),Ai.nextNode(),c.push({type:2,index:++i});s.append(d[h],Hc())}}}else if(s.nodeType===8)if(s.data===f_)c.push({type:2,index:i});else{let d=-1;for(;(d=s.data.indexOf(Us,d+1))!==-1;)c.push({type:7,index:i}),d+=Us.length-1}i++}}static createElement(e,n){const r=ji.createElement("template");return r.innerHTML=e,r}}function zo(t,e,n=t,r){var o,a;if(e===qo)return e;let s=r!==void 0?(o=n._$Co)==null?void 0:o[r]:n._$Cl;const i=qc(e)?void 0:e._$litDirective$;return(s==null?void 0:s.constructor)!==i&&((a=s==null?void 0:s._$AO)==null||a.call(s,!1),i===void 0?s=void 0:(s=new i(t),s._$AT(t,n,r)),r!==void 0?(n._$Co??(n._$Co=[]))[r]=s:n._$Cl=s),s!==void 0&&(e=zo(t,s._$AS(t,e.values),s,r)),e}class aH{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:n},parts:r}=this._$AD,s=((e==null?void 0:e.creationScope)??ji).importNode(n,!0);Ai.currentNode=s;let i=Ai.nextNode(),o=0,a=0,c=r[0];for(;c!==void 0;){if(o===c.index){let l;c.type===2?l=new hl(i,i.nextSibling,this,e):c.type===1?l=new c.ctor(i,c.name,c.strings,this,e):c.type===6&&(l=new dH(i,this,e)),this._$AV.push(l),c=r[++a]}o!==(c==null?void 0:c.index)&&(i=Ai.nextNode(),o++)}return Ai.currentNode=ji,s}p(e){let n=0;for(const r of this._$AV)r!==void 0&&(r.strings!==void 0?(r._$AI(e,r,n),n+=r.strings.length-2):r._$AI(e[n])),n++}}class hl{get _$AU(){var e;return((e=this._$AM)==null?void 0:e._$AU)??this._$Cv}constructor(e,n,r,s){this.type=2,this._$AH=Tt,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=r,this.options=s,this._$Cv=(s==null?void 0:s.isConnected)??!0}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=zo(this,e,n),qc(e)?e===Tt||e==null||e===""?(this._$AH!==Tt&&this._$AR(),this._$AH=Tt):e!==this._$AH&&e!==qo&&this._(e):e._$litType$!==void 0?this.$(e):e.nodeType!==void 0?this.T(e):iH(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Tt&&qc(this._$AH)?this._$AA.nextSibling.data=e:this.T(ji.createTextNode(e)),this._$AH=e}$(e){var i;const{values:n,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=zc.createElement(m_(r.h,r.h[0]),this.options)),r);if(((i=this._$AH)==null?void 0:i._$AD)===s)this._$AH.p(n);else{const o=new aH(s,this),a=o.u(this.options);o.p(n),this.T(a),this._$AH=o}}_$AC(e){let n=_w.get(e.strings);return n===void 0&&_w.set(e.strings,n=new zc(e)),n}k(e){Ag(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,s=0;for(const i of e)s===n.length?n.push(r=new hl(this.O(Hc()),this.O(Hc()),this,this.options)):r=n[s],r._$AI(i),s++;s<n.length&&(this._$AR(r&&r._$AB.nextSibling,s),n.length=s)}_$AR(e=this._$AA.nextSibling,n){var r;for((r=this._$AP)==null?void 0:r.call(this,!1,!0,n);e!==this._$AB;){const s=e.nextSibling;e.remove(),e=s}}setConnected(e){var n;this._$AM===void 0&&(this._$Cv=e,(n=this._$AP)==null||n.call(this,e))}}class xd{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,n,r,s,i){this.type=1,this._$AH=Tt,this._$AN=void 0,this.element=e,this.name=n,this._$AM=s,this.options=i,r.length>2||r[0]!==""||r[1]!==""?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=Tt}_$AI(e,n=this,r,s){const i=this.strings;let o=!1;if(i===void 0)e=zo(this,e,n,0),o=!qc(e)||e!==this._$AH&&e!==qo,o&&(this._$AH=e);else{const a=e;let c,l;for(e=i[0],c=0;c<i.length-1;c++)l=zo(this,a[r+c],n,c),l===qo&&(l=this._$AH[c]),o||(o=!qc(l)||l!==this._$AH[c]),l===Tt?e=Tt:e!==Tt&&(e+=(l??"")+i[c+1]),this._$AH[c]=l}o&&!s&&this.j(e)}j(e){e===Tt?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class cH extends xd{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Tt?void 0:e}}class lH extends xd{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Tt)}}class uH extends xd{constructor(e,n,r,s,i){super(e,n,r,s,i),this.type=5}_$AI(e,n=this){if((e=zo(this,e,n,0)??Tt)===qo)return;const r=this._$AH,s=e===Tt&&r!==Tt||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,i=e!==Tt&&(r===Tt||s);s&&this.element.removeEventListener(this.name,this,r),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n;typeof this._$AH=="function"?this._$AH.call(((n=this.options)==null?void 0:n.host)??this.element,e):this._$AH.handleEvent(e)}}class dH{constructor(e,n,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){zo(this,e)}}const Lh=Ya.litHtmlPolyfillSupport;Lh==null||Lh(zc,hl),(Ya.litHtmlVersions??(Ya.litHtmlVersions=[])).push("3.3.1");const hH=(t,e,n)=>{const r=(n==null?void 0:n.renderBefore)??e;let s=r._$litPart$;if(s===void 0){const i=(n==null?void 0:n.renderBefore)??null;r._$litPart$=s=new hl(e.insertBefore(Hc(),i),i,void 0,n??{})}return s._$AI(t),s};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ni=globalThis;class au extends _o{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var n;const e=super.createRenderRoot();return(n=this.renderOptions).renderBefore??(n.renderBefore=e.firstChild),e}update(e){const n=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=hH(n,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),(e=this._$Do)==null||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),(e=this._$Do)==null||e.setConnected(!1)}render(){return qo}}var kw;au._$litElement$=!0,au.finalized=!0,(kw=Ni.litElementHydrateSupport)==null||kw.call(Ni,{LitElement:au});const Mh=Ni.litElementPolyfillSupport;Mh==null||Mh({LitElement:au});(Ni.litElementVersions??(Ni.litElementVersions=[])).push("4.2.1");let Za,Ws,Vs;function zz(t,e){Za=document.createElement("style"),Ws=document.createElement("style"),Vs=document.createElement("style"),Za.textContent=Oo(t).core.cssText,Ws.textContent=Oo(t).dark.cssText,Vs.textContent=Oo(t).light.cssText,document.head.appendChild(Za),document.head.appendChild(Ws),document.head.appendChild(Vs),y_(e)}function y_(t){Ws&&Vs&&(t==="light"?(Ws.removeAttribute("media"),Vs.media="enabled"):(Vs.removeAttribute("media"),Ws.media="enabled"))}function fH(t){Za&&Ws&&Vs&&(Za.textContent=Oo(t).core.cssText,Ws.textContent=Oo(t).dark.cssText,Vs.textContent=Oo(t).light.cssText)}function Oo(t){return{core:Po`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${jn(t!=null&&t["--w3m-color-mix-strength"]?`${t["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${jn((t==null?void 0:t["--w3m-font-family"])||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${jn((t==null?void 0:t["--w3m-font-size-master"])||"10px")};
        --w3m-border-radius-master: ${jn((t==null?void 0:t["--w3m-border-radius-master"])||"4px")};
        --w3m-z-index: ${jn((t==null?void 0:t["--w3m-z-index"])||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:Po`
      :root {
        --w3m-color-mix: ${jn((t==null?void 0:t["--w3m-color-mix"])||"#fff")};
        --w3m-accent: ${jn(rs(t,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${jn(rs(t,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:Po`
      :root {
        --w3m-color-mix: ${jn((t==null?void 0:t["--w3m-color-mix"])||"#000")};
        --w3m-accent: ${jn(rs(t,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${jn(rs(t,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}const Wz=Po`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,Vz=Po`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,Gz=Po`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`,cu={hexStringToNumber(t){const e=t.startsWith("0x")?t.slice(2):t;return parseInt(e,16)},numberToHexString(t){return`0x${t.toString(16)}`},async getUserInfo(t){const[e,n]=await Promise.all([cu.getAddresses(t),cu.getChainId(t)]);return{chainId:n,addresses:e}},async getChainId(t){const e=await t.request({method:"eth_chainId"});return Number(e)},async getAddress(t){const[e]=await t.request({method:"eth_accounts"});return e},async getAddresses(t){return await t.request({method:"eth_accounts"})},async addEthereumChain(t,e){var r,s;const n=((r=e.rpcUrls.chainDefault)==null?void 0:r.http)||[];await t.request({method:"wallet_addEthereumChain",params:[{chainId:cu.numberToHexString(e.id),rpcUrls:[...n],chainName:e.name,nativeCurrency:{name:e.nativeCurrency.name,decimals:e.nativeCurrency.decimals,symbol:e.nativeCurrency.symbol},blockExplorerUrls:[(s=e.blockExplorers)==null?void 0:s.default.url],iconUrls:[Pn.NetworkImageIds[e.id]]}]})}},bo={ACCOUNT_INDEXES:{PAYMENT:0,ORDINAL:1}},Kz=UN({id:1,name:"Ethereum",nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:{default:{http:["https://eth.merkle.io"]}},blockExplorers:{default:{name:"Etherscan",url:"https://etherscan.io",apiUrl:"https://api.etherscan.io/api"}},contracts:{ensRegistry:{address:"0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e"},ensUniversalResolver:{address:"0xce01f8eee7E479C928F8919abD53E553a36CeF67",blockCreated:19258213},multicall3:{address:"0xca11bde05977b3631167028862be2a173976ca11",blockCreated:14353601}}});function fl(t){return{formatters:void 0,fees:void 0,serializers:void 0,...t}}const Aw=fl({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),Iw=fl({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"});fl({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});fl({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}});fl({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});const pH={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},kr={getMethodsByChainNamespace(t){return pH[t]||[]},createDefaultNamespace(t){return{methods:this.getMethodsByChainNamespace(t),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(t,e){if(!e)return{...t};const n={...t},r=new Set;if(e.methods&&Object.keys(e.methods).forEach(s=>r.add(s)),e.chains&&Object.keys(e.chains).forEach(s=>r.add(s)),e.events&&Object.keys(e.events).forEach(s=>r.add(s)),e.rpcMap&&Object.keys(e.rpcMap).forEach(s=>{const[i]=s.split(":");i&&r.add(i)}),r.forEach(s=>{n[s]||(n[s]=this.createDefaultNamespace(s))}),e.methods&&Object.entries(e.methods).forEach(([s,i])=>{n[s]&&(n[s].methods=i)}),e.chains&&Object.entries(e.chains).forEach(([s,i])=>{n[s]&&(n[s].chains=i)}),e.events&&Object.entries(e.events).forEach(([s,i])=>{n[s]&&(n[s].events=i)}),e.rpcMap){const s=new Set;Object.entries(e.rpcMap).forEach(([i,o])=>{const[a,c]=i.split(":");!a||!c||!n[a]||(n[a].rpcMap||(n[a].rpcMap={}),s.has(a)||(n[a].rpcMap={},s.add(a)),n[a].rpcMap[c]=o)})}return n},createNamespaces(t,e){const n=t.reduce((r,s)=>{const{id:i,chainNamespace:o,rpcUrls:a}=s,c=a.default.http[0];r[o]||(r[o]=this.createDefaultNamespace(o));const l=`${o}:${i}`,u=r[o];switch(u.chains.push(l),l){case Aw.caipNetworkId:u.chains.push(Aw.deprecatedCaipNetworkId);break;case Iw.caipNetworkId:u.chains.push(Iw.deprecatedCaipNetworkId);break}return u!=null&&u.rpcMap&&c&&(u.rpcMap[i]=c),r},{});return this.applyNamespaceOverrides(n,e)},resolveReownName:async t=>{var r;const e=await Ma.resolveName(t);return((r=(Object.values(e==null?void 0:e.addresses)||[])[0])==null?void 0:r.address)||!1},getChainsFromNamespaces(t={}){return Object.values(t).flatMap(e=>{const n=e.chains||[],r=e.accounts.map(s=>{const[i,o]=s.split(":");return`${i}:${o}`});return Array.from(new Set([...n,...r]))})},isSessionEventData(t){return typeof t=="object"&&t!==null&&"id"in t&&"topic"in t&&"params"in t&&typeof t.params=="object"&&t.params!==null&&"chainId"in t.params&&"event"in t.params&&typeof t.params.event=="object"&&t.params.event!==null},isOriginAllowed(t,e,n){for(const r of[...e,...n])if(r.includes("*")){const i=`^${r.replace(/[.*+?^${}()|[\]\\]/gu,"\\$&").replace(/\\\*/gu,".*")}$`;if(new RegExp(i,"u").test(t))return!0}else try{if(new URL(r).origin===t)return!0}catch{if(r===t)return!0}return!1},listenWcProvider({universalProvider:t,namespace:e,onConnect:n,onDisconnect:r,onAccountsChanged:s,onChainChanged:i,onDisplayUri:o}){n&&t.on("connect",()=>{const a=kr.getWalletConnectAccounts(t,e);n(a)}),r&&t.on("disconnect",()=>{r()}),s&&t.on("session_event",a=>{if(kr.isSessionEventData(a)){const{name:c,data:l}=a.params.event;if(c==="accountsChanged"&&Array.isArray(l)){const u=l.filter(d=>oe.isCaipAddress(d)).map(d=>On.parseCaipAddress(d)).filter(d=>d.chainNamespace===e);s(u)}}}),i&&t.on("chainChanged",a=>{i(a)}),o&&t.on("display_uri",a=>{o(a)})},getWalletConnectAccounts(t,e){var s,i,o,a;const n=new Set,r=(a=(o=(i=(s=t==null?void 0:t.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>On.parseCaipAddress(c)).filter(({address:c})=>n.has(c.toLowerCase())?!1:(n.add(c.toLowerCase()),!0));return r&&r.length>0?r:[]}};class gH{constructor(e){this.namespace=e.namespace}async syncConnections(e){switch(this.namespace){case L.CHAIN.EVM:await this.syncEVMConnections(e);break;case L.CHAIN.SOLANA:await this.syncSolanaConnections(e);break;case L.CHAIN.BITCOIN:await this.syncBitcoinConnections(e);break;default:throw new Error(`Unsupported chain namespace: ${this.namespace}`)}}async syncEVMConnections({connectors:e,caipNetworks:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===L.CONNECTOR_ID.WALLET_CONNECT){const c=kr.getWalletConnectAccounts(r,this.namespace),l=n.find(u=>{var d,h;return u.chainNamespace===this.namespace&&u.id.toString()===((h=(d=c[0])==null?void 0:d.chainId)==null?void 0:h.toString())});c.length>0&&i({connectorId:a.id,accounts:c.map(u=>({address:u.address})),caipNetwork:l})}else{const{accounts:c,chainId:l}=await iu.fetchProviderData(a);if(c.length>0&&l){const u=n.find(d=>d.chainNamespace===this.namespace&&d.id.toString()===l.toString());i({connectorId:a.id,accounts:c.map(d=>({address:d})),caipNetwork:u}),a.provider&&a.id!==L.CONNECTOR_ID.AUTH&&a.id!==L.CONNECTOR_ID.WALLET_CONNECT&&o(a.id,a.provider)}}}))}async syncSolanaConnections({connectors:e,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{if(a.id===L.CONNECTOR_ID.WALLET_CONNECT){const c=kr.getWalletConnectAccounts(r,this.namespace);c.length>0&&i({connectorId:a.id,accounts:c.map(l=>({address:l.address})),caipNetwork:n})}else{const c=await a.connect({chainId:n==null?void 0:n.id});c&&(i({connectorId:a.id,accounts:[{address:c}],caipNetwork:n}),o(a.id,a.provider))}}))}async syncBitcoinConnections({connectors:e,caipNetwork:n,universalProvider:r,getConnectionStatusInfo:s,onConnection:i,onListenProvider:o}){await Promise.all(e.filter(a=>{const{hasDisconnected:c,hasConnected:l}=s(a.id);return!c&&l}).map(async a=>{var h,f,p,g,m,v;if(a.id===L.CONNECTOR_ID.WALLET_CONNECT){const b=kr.getWalletConnectAccounts(r,this.namespace);b.length>0&&i({connectorId:a.id,accounts:b.map(y=>({address:y.address})),caipNetwork:n});return}const c=await a.connect(),l=await a.getAccountAddresses();let u=l==null?void 0:l.map(b=>oe.createAccount(L.CHAIN.BITCOIN,b.address,b.purpose||"payment",b.publicKey,b.path));if(u&&u.length>1&&(u=[{namespace:L.CHAIN.BITCOIN,publicKey:((h=u[bo.ACCOUNT_INDEXES.PAYMENT])==null?void 0:h.publicKey)??"",path:((f=u[bo.ACCOUNT_INDEXES.PAYMENT])==null?void 0:f.path)??"",address:((p=u[bo.ACCOUNT_INDEXES.PAYMENT])==null?void 0:p.address)??"",type:"payment"},{namespace:L.CHAIN.BITCOIN,publicKey:((g=u[bo.ACCOUNT_INDEXES.ORDINAL])==null?void 0:g.publicKey)??"",path:((m=u[bo.ACCOUNT_INDEXES.ORDINAL])==null?void 0:m.path)??"",address:((v=u[bo.ACCOUNT_INDEXES.ORDINAL])==null?void 0:v.address)??"",type:"ordinal"}]),!(a.chains.find(b=>b.id===(n==null?void 0:n.id))||a.chains[0]))throw new Error("The connector does not support any of the requested chains");c&&(o(a.id,a.provider),i({connectorId:a.id,accounts:u.map(b=>({address:b.address,type:b.type})),caipNetwork:n}))}))}getConnection({address:e,connectorId:n,connections:r,connectors:s}){if(n){const o=r.find(l=>Pt.isLowerCaseMatch(l.connectorId,n));if(!o)return null;const a=s.find(l=>Pt.isLowerCaseMatch(l.id,o.connectorId)),c=e?o.accounts.find(l=>Pt.isLowerCaseMatch(l.address,e)):o.accounts[0];return{...o,account:c,connector:a}}const i=r.find(o=>o.accounts.length>0&&s.some(a=>Pt.isLowerCaseMatch(a.id,o.connectorId)));if(i){const[o]=i.accounts,a=s.find(c=>Pt.isLowerCaseMatch(c.id,i.connectorId));return{...i,account:o,connector:a}}return null}}const ka={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603,DEFAULT_ALLOWED_ANCESTORS:["http://localhost:*","https://localhost:*","http://127.0.0.1:*","https://127.0.0.1:*","https://*.pages.dev","https://*.vercel.app","https://*.ngrok-free.app","https://secure-mobile.walletconnect.com","https://secure-mobile.walletconnect.org"]};class Ig{constructor({provider:e,namespace:n}){this.id=L.CONNECTOR_ID.WALLET_CONNECT,this.name=Pn.ConnectorNamesMap[L.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Pn.ConnectorImageIds[L.CONNECTOR_ID.WALLET_CONNECT],this.getCaipNetworks=A.getCaipNetworks.bind(A),this.caipNetworks=this.getCaipNetworks(),this.provider=e,this.chain=n}get chains(){return this.getCaipNetworks()}async connectWalletConnect(){if(!await this.authenticate()){const n=this.getCaipNetworks(),r=j.state.universalProviderConfigOverride,s=kr.createNamespaces(n,r);await this.provider.connect({optionalNamespaces:s})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){const e=this.chains.map(n=>n.caipNetworkId);return Wn.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:mH})}}const mH=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],yH=[L.CONNECTOR_ID.AUTH,L.CONNECTOR_ID.WALLET_CONNECT];class w_{constructor(e){this.availableConnectors=[],this.availableConnections=[],this.providerHandlers={},this.eventListeners=new Map,this.getCaipNetworks=n=>A.getCaipNetworks(n),this.getConnectorId=n=>J.getConnectorId(n),e&&this.construct(e),e!=null&&e.namespace&&(this.connectionManager=new gH({namespace:e.namespace}))}construct(e){this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get connections(){return this.availableConnections}get networks(){return this.getCaipNetworks(this.namespace)}onAuthConnected({accounts:e,chainId:n}){const r=this.getCaipNetworks().filter(s=>s.chainNamespace===this.namespace).find(s=>s.id.toString()===(n==null?void 0:n.toString()));e&&r&&this.addConnection({connectorId:L.CONNECTOR_ID.AUTH,accounts:e,caipNetwork:r})}setAuthProvider(e){e.onConnect(this.onAuthConnected.bind(this)),e.onSocialConnected(this.onAuthConnected.bind(this)),this.addConnector({id:L.CONNECTOR_ID.AUTH,type:"AUTH",name:L.CONNECTOR_NAMES.AUTH,provider:e,imageId:Pn.ConnectorImageIds[L.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){const n=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(r=>n.has(r.id)?!1:(n.add(r.id),!0)),this.emit("connectors",this.availableConnectors)}addConnection(...e){const n=new Set;this.availableConnections=[...e,...this.availableConnections].filter(r=>n.has(r.connectorId.toLowerCase())?!1:(n.add(r.connectorId.toLowerCase()),!0)),this.emit("connections",this.availableConnections)}deleteConnection(e){this.availableConnections=this.availableConnections.filter(n=>!Pt.isLowerCaseMatch(n.connectorId,e)),this.emit("connections",this.availableConnections)}clearConnections(e=!1){this.availableConnections=[],e&&this.emit("connections",this.availableConnections)}setStatus(e,n){ce.setStatus(e,n)}on(e,n){var r;this.eventListeners.has(e)||this.eventListeners.set(e,new Set),(r=this.eventListeners.get(e))==null||r.add(n)}off(e,n){const r=this.eventListeners.get(e);r&&r.delete(n)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,n){const r=this.eventListeners.get(e);r&&r.forEach(s=>s(n))}async connectWalletConnect(e){return{clientId:(await this.getWalletConnectConnector().connectWalletConnect()).clientId}}async switchNetwork(e){const{caipNetwork:n,providerType:r}=e;if(!e.provider)return;const s="provider"in e.provider?e.provider.provider:e.provider;if(r==="WALLET_CONNECT"){s.setDefaultChain(n.caipNetworkId);return}if(s&&r==="AUTH"){const i=s,o=$n(n.chainNamespace);await i.switchNetwork({chainId:n.caipNetworkId});const a=await i.getUser({chainId:n.caipNetworkId,preferredAccountType:o});this.emit("switchNetwork",a)}}getWalletConnectConnector(){const e=this.connectors.find(n=>n instanceof Ig);if(!e)throw new Error("WalletConnectConnector not found");return e}onConnect(e,n){if(e.length>0){const{address:r,chainId:s}=oe.getAccount(e[0]),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===(s==null?void 0:s.toString())),o=this.connectors.find(a=>a.id===n);r&&(this.emit("accountChanged",{address:r,chainId:s,connector:o}),this.addConnection({connectorId:n,accounts:e.map(a=>{const{address:c}=oe.getAccount(a);return{address:c}}),caipNetwork:i}))}}onAccountsChanged(e,n,r=!0){var s,i;if(e.length>0){const{address:o}=oe.getAccount(e[0]),a=(s=this.connectionManager)==null?void 0:s.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors});o&&Pt.isLowerCaseMatch(this.getConnectorId(L.CHAIN.EVM),n)&&this.emit("accountChanged",{address:o,chainId:(i=a==null?void 0:a.caipNetwork)==null?void 0:i.id,connector:a==null?void 0:a.connector}),this.addConnection({connectorId:n,accounts:e.map(c=>{const{address:l}=oe.getAccount(c);return{address:l}}),caipNetwork:a==null?void 0:a.caipNetwork})}else r&&this.onDisconnect(n)}onDisconnect(e){this.removeProviderListeners(e),this.deleteConnection(e),Pt.isLowerCaseMatch(this.getConnectorId(L.CHAIN.EVM),e)&&this.emitFirstAvailableConnection(),this.connections.length===0&&this.emit("disconnect")}onChainChanged(e,n){var o;const r=typeof e=="string"&&e.startsWith("0x")?cu.hexStringToNumber(e).toString():e.toString(),s=(o=this.connectionManager)==null?void 0:o.getConnection({connectorId:n,connections:this.connections,connectors:this.connectors}),i=this.getCaipNetworks().filter(a=>a.chainNamespace===this.namespace).find(a=>a.id.toString()===r);s&&this.addConnection({connectorId:n,accounts:s.accounts,caipNetwork:i}),Pt.isLowerCaseMatch(this.getConnectorId(L.CHAIN.EVM),n)&&this.emit("switchNetwork",{chainId:r})}listenProviderEvents(e,n){if(yH.includes(e))return;const r=o=>this.onAccountsChanged(o,e),s=o=>this.onChainChanged(o,e),i=()=>this.onDisconnect(e);this.providerHandlers[e]||(n.on("disconnect",i),n.on("accountsChanged",r),n.on("chainChanged",s),this.providerHandlers[e]={provider:n,disconnect:i,accountsChanged:r,chainChanged:s})}removeProviderListeners(e){if(this.providerHandlers[e]){const{provider:n,disconnect:r,accountsChanged:s,chainChanged:i}=this.providerHandlers[e];n.removeListener("disconnect",r),n.removeListener("accountsChanged",s),n.removeListener("chainChanged",i),this.providerHandlers[e]=null}}emitFirstAvailableConnection(){var n,r;const e=(n=this.connectionManager)==null?void 0:n.getConnection({connections:this.connections,connectors:this.connectors});if(e){const[s]=e.accounts;this.emit("accountChanged",{address:s==null?void 0:s.address,chainId:(r=e.caipNetwork)==null?void 0:r.id,connector:e.connector})}}}class wH extends w_{async setUniversalProvider(e){if(!this.namespace)throw new Error("UniversalAdapter:setUniversalProvider - namespace is required");return this.addConnector(new Ig({provider:e,caipNetworks:this.getCaipNetworks(),namespace:this.namespace})),Promise.resolve()}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{await this.getWalletConnectConnector().disconnect(),this.emit("disconnect")}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}return{connections:[]}}syncConnections(){return Promise.resolve()}async getAccounts({namespace:e}){var s,i,o,a;const n=this.provider,r=((a=(o=(i=(s=n==null?void 0:n.session)==null?void 0:s.namespaces)==null?void 0:i[e])==null?void 0:o.accounts)==null?void 0:a.map(c=>{const[,,l]=c.split(":");return l}).filter((c,l,u)=>u.indexOf(c)===l))||[];return Promise.resolve({accounts:r.map(c=>oe.createAccount(e,c,e==="bip122"?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){var i,o,a,c,l;if(!(e.caipNetwork&&qe.BALANCE_SUPPORTED_CHAINS.includes((i=e.caipNetwork)==null?void 0:i.chainNamespace))||(o=e.caipNetwork)!=null&&o.testnet)return{balance:"0.00",symbol:((a=e.caipNetwork)==null?void 0:a.nativeCurrency.symbol)||""};if(ce.state.balanceLoading&&e.chainId===((c=A.state.activeCaipNetwork)==null?void 0:c.id))return{balance:ce.state.balance||"0.00",symbol:ce.state.balanceSymbol||""};const s=(await ce.fetchTokenBalance()).find(u=>{var d,h;return u.chainId===`${(d=e.caipNetwork)==null?void 0:d.chainNamespace}:${e.chainId}`&&u.symbol===((h=e.caipNetwork)==null?void 0:h.nativeCurrency.symbol)});return{balance:(s==null?void 0:s.quantity.numeric)||"0.00",symbol:(s==null?void 0:s.symbol)||((l=e.caipNetwork)==null?void 0:l.nativeCurrency.symbol)||""}}async signMessage(e){var o,a,c;const{provider:n,message:r,address:s}=e;if(!n)throw new Error("UniversalAdapter:signMessage - provider is undefined");let i="";return((o=A.state.activeCaipNetwork)==null?void 0:o.chainNamespace)===L.CHAIN.SOLANA?i=(await n.request({method:"solana_signMessage",params:{message:Qo.encode(new TextEncoder().encode(r)),pubkey:s}},(a=A.state.activeCaipNetwork)==null?void 0:a.caipNetworkId)).signature:i=await n.request({method:"personal_sign",params:[r,s]},(c=A.state.activeCaipNetwork)==null?void 0:c.caipNetworkId),{signature:i}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}emitFirstAvailableConnection(){}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){var s,i,o,a,c,l;const{caipNetwork:n}=e,r=this.getWalletConnectConnector();if(n.chainNamespace===L.CHAIN.EVM)try{await((s=r.provider)==null?void 0:s.request({method:"wallet_switchEthereumChain",params:[{chainId:ko(n.id)}]}))}catch(u){if(u.code===ka.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||u.code===ka.ERROR_INVALID_CHAIN_ID||u.code===ka.ERROR_CODE_DEFAULT||((o=(i=u==null?void 0:u.data)==null?void 0:i.originalError)==null?void 0:o.code)===ka.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await((l=r.provider)==null?void 0:l.request({method:"wallet_addEthereumChain",params:[{chainId:ko(n.id),rpcUrls:[(a=n==null?void 0:n.rpcUrls.chainDefault)==null?void 0:a.http],chainName:n.name,nativeCurrency:n.nativeCurrency,blockExplorerUrls:[(c=n.blockExplorers)==null?void 0:c.default.url]}]}))}catch{throw new Error("Chain is not supported")}}r.provider.setDefaultChain(n.caipNetworkId)}getWalletConnectProvider(){const e=this.connectors.find(r=>r.type==="WALLET_CONNECT");return e==null?void 0:e.provider}}const bH=["email","socials","swaps","onramp","activity","reownBranding","multiWallet"],zl={email:{apiFeatureName:"social_login",localFeatureName:"email",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return!!t.isEnabled&&e.includes("email")},processFallback:t=>t===void 0?qe.DEFAULT_REMOTE_FEATURES.email:!!t},socials:{apiFeatureName:"social_login",localFeatureName:"socials",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e.filter(n=>n!=="email"):!1},processFallback:t=>t===void 0?qe.DEFAULT_REMOTE_FEATURES.socials:typeof t=="boolean"?t?qe.DEFAULT_REMOTE_FEATURES.socials:!1:t},swaps:{apiFeatureName:"swap",localFeatureName:"swaps",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?qe.DEFAULT_REMOTE_FEATURES.swaps:typeof t=="boolean"?t?qe.DEFAULT_REMOTE_FEATURES.swaps:!1:t},onramp:{apiFeatureName:"onramp",localFeatureName:"onramp",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>{if(!(t!=null&&t.config))return!1;const e=t.config;return t.isEnabled&&e.length>0?e:!1},processFallback:t=>t===void 0?qe.DEFAULT_REMOTE_FEATURES.onramp:typeof t=="boolean"?t?qe.DEFAULT_REMOTE_FEATURES.onramp:!1:t},activity:{apiFeatureName:"activity",localFeatureName:"history",returnType:!1,isLegacy:!0,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?qe.DEFAULT_REMOTE_FEATURES.activity:!!t},reownBranding:{apiFeatureName:"reown_branding",localFeatureName:"reownBranding",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:t=>t===void 0?qe.DEFAULT_REMOTE_FEATURES.reownBranding:!!t},multiWallet:{apiFeatureName:"multi_wallet",localFeatureName:"multiWallet",returnType:!1,isLegacy:!1,isAvailableOnBasic:!1,processApi:t=>!!t.isEnabled,processFallback:()=>qe.DEFAULT_REMOTE_FEATURES.multiWallet}},vH={localSettingsOverridden:new Set,getApiConfig(t,e){return e==null?void 0:e.find(n=>n.id===t)},addWarning(t,e){if(t!==void 0){const n=zl[e],r=n.isLegacy?`"features.${n.localFeatureName}" (now "${e}")`:`"features.${e}"`;this.localSettingsOverridden.add(r)}},processFeature(t,e,n,r,s){const i=zl[t],o=e[i.localFeatureName];if(s&&!i.isAvailableOnBasic)return!1;if(r){const a=this.getApiConfig(i.apiFeatureName,n);return(a==null?void 0:a.config)===null?this.processFallbackFeature(t,o):a!=null&&a.config?(o!==void 0&&this.addWarning(o,t),this.processApiFeature(t,a)):!1}return this.processFallbackFeature(t,o)},processApiFeature(t,e){return zl[t].processApi(e)},processFallbackFeature(t,e){return zl[t].processFallback(e)},async fetchRemoteFeatures(t){const e=t.basic??!1,n=t.features||{};this.localSettingsOverridden.clear();let r=null,s=!1;try{r=await de.fetchProjectConfig(),s=r!=null}catch(o){console.warn("[Reown Config] Failed to fetch remote project configuration. Using local/default values.",o)}const i=s&&!e?qe.DEFAULT_REMOTE_FEATURES:qe.DEFAULT_REMOTE_FEATURES_DISABLED;try{for(const o of bH){const a=this.processFeature(o,n,r,s,e);Object.assign(i,{[o]:a})}}catch(o){return console.warn("[Reown Config] Failed to process the configuration from Cloud. Using default values.",o),qe.DEFAULT_REMOTE_FEATURES}if(s&&this.localSettingsOverridden.size>0){const o=`Your local configuration for ${Array.from(this.localSettingsOverridden).join(", ")} was ignored because a remote configuration was successfully fetched. Please manage these features via your project dashboard on dashboard.reown.com.`;st.open({shortMessage:"Local configuration ignored",longMessage:`[Reown Config Notice] ${o}`},"warning")}return i}};class EH{constructor(e){this.chainNamespaces=[],this.remoteFeatures={},this.reportedAlertErrors={},this.getCaipNetwork=(n,r)=>{var s,i,o;if(n){const a=(s=A.getCaipNetworks(n))==null?void 0:s.find(u=>u.id===r);if(a)return a;const c=(i=A.getNetworkData(n))==null?void 0:i.caipNetwork;return c||((o=A.getRequestedCaipNetworks(n).filter(u=>u.chainNamespace===n))==null?void 0:o[0])}return A.state.activeCaipNetwork||this.defaultCaipNetwork},this.getCaipNetworkId=()=>{const n=this.getCaipNetwork();if(n)return n.id},this.getCaipNetworks=n=>A.getCaipNetworks(n),this.getActiveChainNamespace=()=>A.state.activeChain,this.setRequestedCaipNetworks=(n,r)=>{A.setRequestedCaipNetworks(n,r)},this.getApprovedCaipNetworkIds=()=>A.getAllApprovedCaipNetworkIds(),this.getCaipAddress=n=>A.state.activeChain===n||!n?A.state.activeCaipAddress:A.getAccountProp("caipAddress",n),this.setClientId=n=>{fe.setClientId(n)},this.getProvider=n=>Ye.getProvider(n),this.getProviderType=n=>Ye.getProviderId(n),this.getPreferredAccountType=n=>$n(n),this.setCaipAddress=(n,r)=>{ce.setCaipAddress(n,r)},this.setBalance=(n,r,s)=>{ce.setBalance(n,r,s)},this.setProfileName=(n,r)=>{ce.setProfileName(n,r)},this.setProfileImage=(n,r)=>{ce.setProfileImage(n,r)},this.setUser=(n,r)=>{ce.setUser(n,r)},this.resetAccount=n=>{ce.resetAccount(n)},this.setCaipNetwork=n=>{A.setActiveCaipNetwork(n)},this.setCaipNetworkOfNamespace=(n,r)=>{A.setChainNetworkData(r,{caipNetwork:n})},this.setStatus=(n,r)=>{ce.setStatus(n,r),J.isConnected()?V.setConnectionStatus("connected"):V.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=n=>A.getAccountProp("address",n),this.setConnectors=n=>{const r=[...J.state.allConnectors,...n];J.setConnectors(r)},this.setConnections=(n,r)=>{V.setConnections(n,r),X.setConnections(n,r)},this.fetchIdentity=n=>fe.fetchIdentity(n),this.getReownName=n=>Ma.getNamesForAddress(n),this.getConnectors=()=>J.getConnectors(),this.getConnectorImage=n=>jw.getConnectorImage(n),this.getConnections=n=>this.remoteFeatures.multiWallet?hu.getConnectionsData(n).connections:(st.open(L.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.getRecentConnections=n=>this.remoteFeatures.multiWallet?hu.getConnectionsData(n).recentConnections:(st.open(L.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),[]),this.switchConnection=async n=>{if(!this.remoteFeatures.multiWallet){st.open(L.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}await X.switchConnection(n)},this.deleteConnection=n=>{if(!this.remoteFeatures.multiWallet){st.open(L.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info");return}V.deleteAddressFromConnection(n),X.syncStorageConnections()},this.setConnectedWalletInfo=(n,r)=>{const s=Ye.getProviderId(r),i=n?{...n,type:s}:void 0;ce.setConnectedWalletInfo(i,r)},this.getIsConnectedState=()=>!!A.state.activeCaipAddress,this.addAddressLabel=(n,r,s)=>{ce.addAddressLabel(n,r,s)},this.removeAddressLabel=(n,r)=>{ce.removeAddressLabel(n,r)},this.getAddress=n=>A.state.activeChain===n||!n?ce.state.address:A.getAccountProp("address",n),this.setApprovedCaipNetworksData=n=>A.setApprovedCaipNetworksData(n),this.resetNetwork=n=>{A.resetNetwork(n)},this.addConnector=n=>{J.addConnector(n)},this.resetWcConnection=()=>{X.resetWcConnection()},this.setAddressExplorerUrl=(n,r)=>{ce.setAddressExplorerUrl(n,r)},this.setSmartAccountDeployed=(n,r)=>{ce.setSmartAccountDeployed(n,r)},this.setPreferredAccountType=(n,r)=>{A.setAccountProp("preferredAccountType",n,r)},this.setEIP6963Enabled=n=>{j.setEIP6963Enabled(n)},this.handleUnsafeRPCRequest=()=>{if(this.isOpen()){if(this.isTransactionStackEmpty())return;this.redirect("ApproveTransaction")}else this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=this.getChainNamespacesSet(e.adapters,this.caipNetworks),this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.readyPromise=this.initialize(e)}getChainNamespacesSet(e,n){const r=e==null?void 0:e.map(i=>i.namespace).filter(i=>!!i);if(r!=null&&r.length)return[...new Set(r)];const s=n==null?void 0:n.map(i=>i.chainNamespace);return[...new Set(s)]}async initialize(e){var n,r,s;this.initializeProjectSettings(e),this.initControllers(e),await this.initChainAdapters(),this.sendInitializeEvent(e),j.state.enableReconnect?(await this.syncExistingConnection(),await this.syncAdapterConnections()):await this.unSyncExistingConnection(),this.remoteFeatures=await vH.fetchRemoteFeatures(e),j.setRemoteFeatures(this.remoteFeatures),this.remoteFeatures.onramp&&pf.setOnrampProviders(this.remoteFeatures.onramp),((n=j.state.remoteFeatures)!=null&&n.email||Array.isArray((r=j.state.remoteFeatures)==null?void 0:r.socials)&&((s=j.state.remoteFeatures)==null?void 0:s.socials.length)>0)&&await this.checkAllowedOrigins()}async checkAllowedOrigins(){try{const e=await de.fetchAllowedOrigins();if(!e||!oe.isClient()){st.open(ut.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}const n=window.location.origin;kr.isOriginAllowed(n,e,ka.DEFAULT_ALLOWED_ANCESTORS)||st.open(ut.ALERT_ERRORS.ORIGIN_NOT_ALLOWED,"error")}catch(e){if(!(e instanceof Error)){st.open(ut.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}switch(e.message){case"RATE_LIMITED":st.open(ut.ALERT_ERRORS.RATE_LIMITED_APP_CONFIGURATION,"error");break;case"SERVER_ERROR":{const n=e.cause instanceof Error?e.cause:e;st.open({shortMessage:ut.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.shortMessage,longMessage:ut.ALERT_ERRORS.SERVER_ERROR_APP_CONFIGURATION.longMessage(n.message)},"error");break}default:st.open(ut.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error")}}}sendInitializeEvent(e){var r;const{...n}=e;delete n.adapters,delete n.universalProvider,Ve.sendEvent({type:"track",event:"INITIALIZE",properties:{...n,networks:e.networks.map(s=>s.id),siweConfig:{options:((r=e.siweConfig)==null?void 0:r.options)||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&yn.setThemeMode(e.themeMode),e.themeVariables&&yn.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw new Error("ConnectionControllerClient and NetworkControllerClient must be set");A.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});const n=this.getDefaultNetwork();n&&A.setActiveCaipNetwork(n)}initializeConnectionController(e){X.initialize(e.adapters??[]),X.setWcBasic(e.basic??!1)}initializeConnectorController(){J.initialize(this.chainNamespaces)}initializeProjectSettings(e){j.setProjectId(e.projectId),j.setSdkVersion(e.sdkVersion)}initializeOptionsController(e){var s;j.setDebug(e.debug!==!1),j.setEnableWalletConnect(e.enableWalletConnect!==!1),j.setEnableWalletGuide(e.enableWalletGuide!==!1),j.setEnableWallets(e.enableWallets!==!1),j.setEIP6963Enabled(e.enableEIP6963!==!1),j.setEnableNetworkSwitch(e.enableNetworkSwitch!==!1),j.setEnableReconnect(e.enableReconnect!==!1),j.setEnableAuthLogger(e.enableAuthLogger!==!1),j.setCustomRpcUrls(e.customRpcUrls),j.setEnableEmbedded(e.enableEmbedded),j.setAllWallets(e.allWallets),j.setIncludeWalletIds(e.includeWalletIds),j.setExcludeWalletIds(e.excludeWalletIds),j.setFeaturedWalletIds(e.featuredWalletIds),j.setTokens(e.tokens),j.setTermsConditionsUrl(e.termsConditionsUrl),j.setPrivacyPolicyUrl(e.privacyPolicyUrl),j.setCustomWallets(e.customWallets),j.setFeatures(e.features),j.setAllowUnsupportedChain(e.allowUnsupportedChain),j.setUniversalProviderConfigOverride(e.universalProviderConfigOverride),j.setPreferUniversalLinks(e.experimental_preferUniversalLinks),j.setDefaultAccountTypes(e.defaultAccountTypes);const n=this.getDefaultMetaData();if(!e.metadata&&n&&(e.metadata=n),j.setMetadata(e.metadata),j.setDisableAppend(e.disableAppend),j.setEnableEmbedded(e.enableEmbedded),j.setSIWX(e.siwx),!e.projectId){st.open(ut.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(((s=e.adapters)==null?void 0:s.find(i=>i.namespace===L.CHAIN.EVM))&&e.siweConfig){if(e.siwx)throw new Error("Cannot set both `siweConfig` and `siwx` options");j.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){var e,n,r,s;return oe.isClient()?{name:((n=(e=document.getElementsByTagName("title"))==null?void 0:e[0])==null?void 0:n.textContent)||"",description:((r=document.querySelector('meta[property="og:description"]'))==null?void 0:r.content)||"",url:window.location.origin,icons:[((s=document.querySelector('link[rel~="icon"]'))==null?void 0:s.href)||""]}:null}setUnsupportedNetwork(e){const n=this.getActiveChainNamespace();if(n){const r=Tr.getUnsupportedNetwork(`${n}:${e}`);A.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Tr.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,n){return Tr.extendCaipNetwork(e,{customNetworkImageUrls:n.chainImages,projectId:n.projectId})}extendCaipNetworks(e){return Tr.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){const n=e.networks.find(s=>{var i;return s.id===((i=e.defaultNetwork)==null?void 0:i.id)});return n?Tr.extendCaipNetwork(n,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}async disconnectNamespace(e,n){try{this.setLoading(!0,e);let r={connections:[]};const s=this.getAdapter(e),{caipAddress:i}=A.getAccountData(e)||{};return(i||!j.state.enableReconnect)&&(s!=null&&s.disconnect)&&(r=await s.disconnect({id:n})),this.setLoading(!1,e),r}catch(r){throw this.setLoading(!1,e),new Error(`Failed to disconnect chains: ${r.message}`)}}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{var l;const e=A.state.activeChain,n=this.getAdapter(e),r=(l=this.getCaipNetwork(e))==null?void 0:l.id,s=X.getConnections(e),i=this.remoteFeatures.multiWallet,o=s.length>0;if(!n)throw new Error("Adapter not found");const a=await n.connectWalletConnect(r);(!o||!i)&&this.close(),this.setClientId((a==null?void 0:a.clientId)||null),V.setConnectedNamespaces([...A.state.chains.keys()]),await this.syncWalletConnectAccount(),await Wn.initializeIfEnabled()},connectExternal:async({id:e,address:n,info:r,type:s,provider:i,chain:o,caipNetwork:a,socialUri:c})=>{var p,g,m,v,b,y;const l=A.state.activeChain,u=o||l,d=this.getAdapter(u);if(o&&o!==l&&!a){const N=this.getCaipNetworks().find(_=>_.chainNamespace===o);N&&this.setCaipNetwork(N)}if(!u)throw new Error("connectExternal: namespace not found");if(!d)throw new Error("connectExternal: adapter not found");const h=this.getCaipNetwork(u),f=await d.connect({id:e,address:n,info:r,type:s,provider:i,socialUri:c,chainId:(a==null?void 0:a.id)||(h==null?void 0:h.id),rpcUrl:((m=(g=(p=a==null?void 0:a.rpcUrls)==null?void 0:p.default)==null?void 0:g.http)==null?void 0:m[0])||((y=(b=(v=h==null?void 0:h.rpcUrls)==null?void 0:v.default)==null?void 0:b.http)==null?void 0:y[0])});if(f)return V.addConnectedNamespace(u),this.syncProvider({...f,chainNamespace:u}),this.setStatus("connected",u),this.syncConnectedWalletInfo(u),V.removeDisconnectedConnectorId(e,u),{address:f.address}},reconnectExternal:async({id:e,info:n,type:r,provider:s})=>{var a;const i=A.state.activeChain,o=this.getAdapter(i);if(!i)throw new Error("reconnectExternal: namespace not found");if(!o)throw new Error("reconnectExternal: adapter not found");o!=null&&o.reconnect&&(await(o==null?void 0:o.reconnect({id:e,info:n,type:r,provider:s,chainId:(a=this.getCaipNetwork())==null?void 0:a.id})),V.addConnectedNamespace(i),this.syncConnectedWalletInfo(i))},disconnect:async e=>{var l;const{id:n,chainNamespace:r,initialDisconnect:s}=e||{},i=r||A.state.activeChain,o=J.getConnectorId(i),a=n===L.CONNECTOR_ID.AUTH||o===L.CONNECTOR_ID.AUTH,c=n===L.CONNECTOR_ID.WALLET_CONNECT||o===L.CONNECTOR_ID.WALLET_CONNECT;try{const u=Array.from(A.state.chains.keys());let d=r?[r]:u;(c||a)&&(d=u);const h=d.map(async g=>{const m=J.getConnectorId(g),v=await this.disconnectNamespace(g,n||m);v&&(a&&V.deleteConnectedSocialProvider(),v.connections.forEach(b=>{V.addDisconnectedConnectorId(b.connectorId,g)})),s&&this.onDisconnectNamespace({chainNamespace:g,closeModal:!1})}),f=await Promise.allSettled(h);He.resetSend(),X.resetWcConnection(),(l=Wn.getSIWX())!=null&&l.signOutOnDisconnect&&await Wn.clearSessions(),J.setFilterByNamespace(void 0),X.syncStorageConnections();const p=f.filter(g=>g.status==="rejected");if(p.length>0)throw new Error(p.map(g=>g.reason.message).join(", "));Ve.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:r||"all"}})}catch(u){throw new Error(`Failed to disconnect chains: ${u.message}`)}},checkInstalled:e=>e?e.some(n=>{var r;return!!((r=window.ethereum)!=null&&r[String(n)])}):!!window.ethereum,signMessage:async e=>{const n=A.state.activeChain,r=this.getAdapter(A.state.activeChain);if(!n)throw new Error("signMessage: namespace not found");if(!r)throw new Error("signMessage: adapter not found");const s=await(r==null?void 0:r.signMessage({message:e,address:ce.state.address,provider:Ye.getProvider(n)}));return(s==null?void 0:s.signature)||""},sendTransaction:async e=>{const n=e.chainNamespace;if(!n)throw new Error("sendTransaction: namespace not found");if(qe.SEND_SUPPORTED_NAMESPACES.includes(n)){const r=this.getAdapter(n);if(!r)throw new Error("sendTransaction: adapter not found");const s=Ye.getProvider(n),i=await(r==null?void 0:r.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:s}));return(i==null?void 0:i.hash)||""}return""},estimateGas:async e=>{const n=e.chainNamespace;if(n===L.CHAIN.EVM){const r=this.getAdapter(n);if(!r)throw new Error("estimateGas: adapter is required but got undefined");const s=Ye.getProvider(n),i=this.getCaipNetwork();if(!i)throw new Error("estimateGas: caipNetwork is required but got undefined");const o=await(r==null?void 0:r.estimateGas({...e,provider:s,caipNetwork:i}));return(o==null?void 0:o.gas)||0n}return 0n},getEnsAvatar:async()=>{var n;const e=A.state.activeChain;if(!e)throw new Error("getEnsAvatar: namespace is required but got undefined");return await this.syncIdentity({address:ce.state.address,chainId:Number((n=this.getCaipNetwork())==null?void 0:n.id),chainNamespace:e}),ce.state.profileImage||!1},getEnsAddress:async e=>await kr.resolveReownName(e),writeContract:async e=>{const n=A.state.activeChain,r=this.getAdapter(n);if(!n)throw new Error("writeContract: namespace is required but got undefined");if(!r)throw new Error("writeContract: adapter is required but got undefined");const s=this.getCaipNetwork(),i=this.getCaipAddress(),o=Ye.getProvider(n);if(!s||!i)throw new Error("writeContract: caipNetwork or caipAddress is required but got undefined");const a=await(r==null?void 0:r.writeContract({...e,caipNetwork:s,provider:o,caipAddress:i}));return a==null?void 0:a.hash},parseUnits:(e,n)=>{const r=this.getAdapter(A.state.activeChain);if(!r)throw new Error("parseUnits: adapter is required but got undefined");return(r==null?void 0:r.parseUnits({value:e,decimals:n}))??0n},formatUnits:(e,n)=>{const r=this.getAdapter(A.state.activeChain);if(!r)throw new Error("formatUnits: adapter is required but got undefined");return(r==null?void 0:r.formatUnits({value:e,decimals:n}))??"0"},getCapabilities:async e=>{const n=this.getAdapter(A.state.activeChain);if(!n)throw new Error("getCapabilities: adapter is required but got undefined");return await(n==null?void 0:n.getCapabilities(e))},grantPermissions:async e=>{const n=this.getAdapter(A.state.activeChain);if(!n)throw new Error("grantPermissions: adapter is required but got undefined");return await(n==null?void 0:n.grantPermissions(e))},revokePermissions:async e=>{const n=this.getAdapter(A.state.activeChain);if(!n)throw new Error("revokePermissions: adapter is required but got undefined");return n!=null&&n.revokePermissions?await n.revokePermissions(e):"0x"},walletGetAssets:async e=>{const n=this.getAdapter(A.state.activeChain);if(!n)throw new Error("walletGetAssets: adapter is required but got undefined");return await(n==null?void 0:n.walletGetAssets(e))??{}},updateBalance:e=>{const n=this.getCaipNetwork(e);!n||!ce.state.address||this.updateNativeBalance(ce.state.address,n==null?void 0:n.id,e)}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},X.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){var n,r,s,i,o;if(Ye.getProviderId(A.state.activeChain)===it.CONNECTOR_TYPE_WALLET_CONNECT){const a=(r=(n=this.universalProvider)==null?void 0:n.session)==null?void 0:r.namespaces;return{supportsAllNetworks:((o=(i=(s=this.universalProvider)==null?void 0:s.session)==null?void 0:i.peer)==null?void 0:o.metadata.name)==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(a)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;const n=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){const s=Ye.getProvider(n),i=Ye.getProviderId(n);if(e.chainNamespace===A.state.activeChain){const o=this.getAdapter(n);await(o==null?void 0:o.switchNetwork({caipNetwork:e,provider:s,providerType:i}))}else if(this.setCaipNetwork(e),i===it.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{const o=this.getAddressByChainNamespace(n);o&&this.syncAccount({address:o,chainId:e.id,chainNamespace:n})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(n=>{const r=n.chains||[],s=n.accounts.map(i=>{const{chainId:o,chainNamespace:a}=On.parseCaipAddress(i);return`${a}:${o}`});return Array.from(new Set([...r,...s]))})}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((n,r)=>{var i;const s=e==null?void 0:e.find(o=>o.namespace===r);return s?(s.construct({namespace:r,projectId:(i=this.options)==null?void 0:i.projectId,networks:this.getCaipNetworks()}),n[r]=s):n[r]=new wH({namespace:r,networks:this.getCaipNetworks()}),n},{})}async initChainAdapter(e){var n;this.onConnectors(e),this.listenAdapter(e),await((n=this.chainAdapters)==null?void 0:n[e].syncConnectors(this.options,this)),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){const n=this.getAdapter(e);n==null||n.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){const n=this.getAdapter(e);if(!n)return;const r=V.getConnectionStatus();j.state.enableReconnect===!1?this.setStatus("disconnected",e):r==="connected"?this.setStatus("connecting",e):r==="disconnected"?(V.clearAddressCache(),this.setStatus(r,e)):this.setStatus(r,e),n.on("switchNetwork",({address:s,chainId:i})=>{const o=this.getCaipNetworks().find(l=>l.id.toString()===i.toString()||l.caipNetworkId.toString()===i.toString()),a=A.state.activeChain===e,c=A.getAccountProp("address",e);if(o){const l=a&&s?s:c;l&&this.syncAccount({address:l,chainId:o.id,chainNamespace:e})}else this.setUnsupportedNetwork(i)}),n.on("disconnect",()=>{this.onDisconnectNamespace({chainNamespace:e})}),n.on("connections",s=>{this.setConnections(s,e)}),n.on("pendingTransactions",()=>{const s=ce.state.address,i=A.state.activeCaipNetwork;!s||!(i!=null&&i.id)||this.updateNativeBalance(s,i.id,i.chainNamespace)}),n.on("accountChanged",({address:s,chainId:i,connector:o})=>{var c,l;const a=A.state.activeChain===e;o!=null&&o.provider&&(this.syncProvider({id:o.id,type:o.type,provider:o.provider,chainNamespace:e}),this.syncConnectedWalletInfo(e)),a&&i?this.syncAccount({address:s,chainId:i,chainNamespace:e}):a&&((c=A.state.activeCaipNetwork)!=null&&c.id)?this.syncAccount({address:s,chainId:(l=A.state.activeCaipNetwork)==null?void 0:l.id,chainNamespace:e}):this.syncAccountInfo(s,i,e),V.addConnectedNamespace(e)})}async createUniversalProviderForAdapter(e){var n,r,s;await this.getUniversalProvider(),this.universalProvider&&await((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setUniversalProvider)==null?void 0:s.call(r,this.universalProvider))}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async unSyncExistingConnection(){try{await Promise.allSettled(this.chainNamespaces.map(e=>X.disconnect({namespace:e,initialDisconnect:!0})))}catch(e){console.error("Error disconnecting existing connections:",e)}}async syncNamespaceConnection(e){try{e===L.CHAIN.EVM&&oe.isSafeApp()&&J.setConnectorId(L.CONNECTOR_ID.SAFE,e);const n=J.getConnectorId(e);switch(this.setStatus("connecting",e),n){case L.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case L.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(n){console.warn("AppKit couldn't sync existing connection",n),this.setStatus("disconnected",e)}}onDisconnectNamespace(e){const{chainNamespace:n,closeModal:r}=e||{};A.resetAccount(n),A.resetNetwork(n),V.removeConnectedNamespace(n);const s=Array.from(A.state.chains.keys());(n?[n]:s).forEach(o=>V.addDisconnectedConnectorId(J.getConnectorId(o)||"",o)),J.removeConnectorId(n),Ye.resetChain(n),this.setUser(void 0,n),this.setStatus("disconnected",n),this.setConnectedWalletInfo(void 0,n),r!==!1&&Me.close()}async syncAdapterConnections(){await Promise.allSettled(this.chainNamespaces.map(e=>{var s;const n=this.getCaipAddress(e),r=this.getCaipNetwork(e);return(s=this.chainAdapters)==null?void 0:s[e].syncConnections({connectToFirstConnector:!n,caipNetwork:r,getConnectorStorageInfo(i){const a=V.getConnections()[e]??[];return{hasDisconnected:V.isConnectorDisconnected(i,e),hasConnected:a.some(c=>Pt.isLowerCaseMatch(c.connectorId,i))}}})}))}async syncAdapterConnection(e){var a,c,l;const n=this.getAdapter(e),r=J.getConnectorId(e),s=this.getCaipNetwork(e),o=J.getConnectors(e).find(u=>u.id===r);try{if(!n||!o)throw new Error(`Adapter or connector not found for namespace ${e}`);if(!(s!=null&&s.id))throw new Error("CaipNetwork not found");const u=await(n==null?void 0:n.syncConnection({namespace:e,id:o.id,chainId:s.id,rpcUrl:(l=(c=(a=s==null?void 0:s.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:l[0]}));u?(this.syncProvider({...u,chainNamespace:e}),await this.syncAccount({...u,chainNamespace:e}),this.setStatus("connected",e)):this.setStatus("disconnected",e)}catch{this.onDisconnectNamespace({chainNamespace:e,closeModal:!1})}}async syncWalletConnectAccount(){var r,s;const e=Object.keys(((s=(r=this.universalProvider)==null?void 0:r.session)==null?void 0:s.namespaces)||{}),n=this.chainNamespaces.map(async i=>{var u,d,h,f,p;const o=this.getAdapter(i);if(!o)return;const a=((f=(h=(d=(u=this.universalProvider)==null?void 0:u.session)==null?void 0:d.namespaces)==null?void 0:h[i])==null?void 0:f.accounts)||[],c=(p=A.state.activeCaipNetwork)==null?void 0:p.id,l=a.find(g=>{const{chainId:m}=On.parseCaipAddress(g);return m===(c==null?void 0:c.toString())})||a[0];if(l){const g=On.validateCaipAddress(l),{chainId:m,address:v}=On.parseCaipAddress(g);if(Ye.setProviderId(i,it.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&A.state.activeCaipNetwork&&o.namespace!==L.CHAIN.EVM){const b=o.getWalletConnectProvider({caipNetworks:this.getCaipNetworks(),provider:this.universalProvider,activeCaipNetwork:A.state.activeCaipNetwork});Ye.setProvider(i,b)}else Ye.setProvider(i,this.universalProvider);J.setConnectorId(L.CONNECTOR_ID.WALLET_CONNECT,i),V.addConnectedNamespace(i),await this.syncAccount({address:v,chainId:m,chainNamespace:i})}else e.includes(i)&&this.setStatus("disconnected",i);this.syncConnectedWalletInfo(i),await A.setApprovedCaipNetworksData(i)});await Promise.all(n)}syncProvider({type:e,provider:n,id:r,chainNamespace:s}){Ye.setProviderId(s,e),Ye.setProvider(s,n),J.setConnectorId(r,s)}async syncAccount(e){var d,h;const n=e.chainNamespace===A.state.activeChain,r=A.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:s,chainId:i,chainNamespace:o}=e,{chainId:a}=V.getActiveNetworkProps(),c=i||a,l=((d=A.state.activeCaipNetwork)==null?void 0:d.name)===L.UNSUPPORTED_NETWORK_NAME,u=A.getNetworkProp("supportsAllNetworks",o);if(this.setStatus("connected",o),!(l&&!u)&&c){let f=this.getCaipNetworks().find(m=>m.id.toString()===c.toString()),p=this.getCaipNetworks().find(m=>m.chainNamespace===o);if(!u&&!f&&!p){const m=this.getApprovedCaipNetworkIds()||[],v=m.find(y=>{var N;return((N=On.parseCaipNetworkId(y))==null?void 0:N.chainId)===c.toString()}),b=m.find(y=>{var N;return((N=On.parseCaipNetworkId(y))==null?void 0:N.chainNamespace)===o});f=this.getCaipNetworks().find(y=>y.caipNetworkId===v),p=this.getCaipNetworks().find(y=>y.caipNetworkId===b||"deprecatedCaipNetworkId"in y&&y.deprecatedCaipNetworkId===b)}const g=f||p;(g==null?void 0:g.chainNamespace)===A.state.activeChain?j.state.enableNetworkSwitch&&!j.state.allowUnsupportedChain&&((h=A.state.activeCaipNetwork)==null?void 0:h.name)===L.UNSUPPORTED_NETWORK_NAME?A.showUnsupportedChainUI():this.setCaipNetwork(g):n||r&&this.setCaipNetworkOfNamespace(r,o),this.syncConnectedWalletInfo(o),Pt.isLowerCaseMatch(s,ce.state.address)||this.syncAccountInfo(s,g==null?void 0:g.id,o),n?await this.syncBalance({address:s,chainId:g==null?void 0:g.id,chainNamespace:o}):await this.syncBalance({address:s,chainId:r==null?void 0:r.id,chainNamespace:o})}}async syncAccountInfo(e,n,r){const s=this.getCaipAddress(r),i=n||(s==null?void 0:s.split(":")[1]);if(!i)return;const o=`${r}:${i}:${e}`;this.setCaipAddress(o,r),await this.syncIdentity({address:e,chainId:i,chainNamespace:r})}async syncReownName(e,n){try{const r=await this.getReownName(e);if(r[0]){const s=r[0];this.setProfileName(s.name,n)}else this.setProfileName(null,n)}catch{this.setProfileName(null,n)}}syncConnectedWalletInfo(e){var s;const n=J.getConnectorId(e),r=Ye.getProviderId(e);if(r===it.CONNECTOR_TYPE_ANNOUNCED||r===it.CONNECTOR_TYPE_INJECTED){if(n){const i=this.getConnectors().find(o=>{var u,d;const a=o.id===n,c=((u=o.info)==null?void 0:u.rdns)===n,l=(d=o.connectors)==null?void 0:d.some(h=>{var f;return h.id===n||((f=h.info)==null?void 0:f.rdns)===n});return a||c||!!l});if(i){const{info:o,name:a,imageUrl:c}=i,l=c||this.getConnectorImage(i);this.setConnectedWalletInfo({name:a,icon:l,...o},e)}}}else if(r===it.CONNECTOR_TYPE_WALLET_CONNECT){const i=Ye.getProvider(e);i!=null&&i.session&&this.setConnectedWalletInfo({...i.session.peer.metadata,name:i.session.peer.metadata.name,icon:(s=i.session.peer.metadata.icons)==null?void 0:s[0]},e)}else if(n&&n===L.CONNECTOR_ID.COINBASE){const i=this.getConnectors().find(o=>o.id===L.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(i)},e)}}async syncBalance(e){!ec.getNetworksByNamespace(this.getCaipNetworks(),e.chainNamespace).find(r=>{var s;return r.id.toString()===((s=e.chainId)==null?void 0:s.toString())})||!e.chainId||await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async ready(){await this.readyPromise}async updateNativeBalance(e,n,r){const s=this.getAdapter(r),i=A.getCaipNetworkByNamespace(r,n);if(s){const o=await s.getBalance({address:e,chainId:n,caipNetwork:i,tokens:this.options.tokens});return this.setBalance(o.balance,o.symbol,r),o}}async initializeUniversalAdapter(){var r,s,i,o,a,c,l,u,d,h;const e=IF.createLogger((f,...p)=>{f&&this.handleAlertError(f),console.error(...p)}),n={projectId:(r=this.options)==null?void 0:r.projectId,metadata:{name:(s=this.options)!=null&&s.metadata?(i=this.options)==null?void 0:i.metadata.name:"",description:(o=this.options)!=null&&o.metadata?(a=this.options)==null?void 0:a.metadata.description:"",url:(c=this.options)!=null&&c.metadata?(l=this.options)==null?void 0:l.metadata.url:"",icons:(u=this.options)!=null&&u.metadata?(d=this.options)==null?void 0:d.metadata.icons:[""]},logger:e};j.setManualWCControl(!!((h=this.options)!=null&&h.manualWCControl)),this.universalProvider=this.options.universalProvider??await CF.init(n),j.state.enableReconnect===!1&&this.universalProvider.session&&await this.universalProvider.disconnect(),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&this.chainNamespaces.forEach(e=>{kr.listenWcProvider({universalProvider:this.universalProvider,namespace:e,onDisplayUri:n=>{X.setUri(n)},onConnect:()=>{X.finalizeWcConnection()},onDisconnect:()=>{A.state.noAdapters&&this.resetAccount(e),X.resetWcConnection()},onChainChanged:n=>{const r=A.state.activeChain,s=r&&J.state.activeConnectorIds[r]===L.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(A.state.noAdapters||s)){const i=this.getCaipNetworks().find(a=>a.id.toString()===n.toString()||a.caipNetworkId.toString()===n.toString()),o=this.getCaipNetwork();if(!i){this.setUnsupportedNetwork(n);return}(o==null?void 0:o.id.toString())!==(i==null?void 0:i.id.toString())&&(o==null?void 0:o.chainNamespace)===(i==null?void 0:i.chainNamespace)&&this.setCaipNetwork(i)}},onAccountsChanged:n=>{const r=A.state.activeChain,s=r&&J.state.activeConnectorIds[r]===L.CONNECTOR_ID.WALLET_CONNECT;if(r===e&&(A.state.noAdapters||s)&&n.length>0){const i=n[0];this.syncAccount({address:i.address,chainId:i.chainId,chainNamespace:i.chainNamespace})}}})})}createUniversalProvider(){var e;return!this.universalProviderInitPromise&&oe.isClient()&&((e=this.options)!=null&&e.projectId)&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){Ve.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){const n=Object.entries(ut.UniversalProviderErrors).find(([,{message:a}])=>e.message.includes(a)),[r,s]=n??[],{message:i,alertErrorKey:o}=s??{};if(r&&i&&!this.reportedAlertErrors[r]){const a=ut.ALERT_ERRORS[o];a&&(st.open(a,"error"),this.reportedAlertErrors[r]=!0)}}getAdapter(e){var n;if(e)return(n=this.chainAdapters)==null?void 0:n[e]}createAdapter(e){var s;if(!e)return;const n=e.namespace;if(!n)return;this.createClients();const r=e;r.namespace=n,r.construct({namespace:n,projectId:(s=this.options)==null?void 0:s.projectId,networks:this.getCaipNetworks()}),this.chainNamespaces.includes(n)||this.chainNamespaces.push(n),this.chainAdapters&&(this.chainAdapters[n]=r)}async open(e){if(await this.injectModalUi(),e!=null&&e.uri&&X.setUri(e.uri),e!=null&&e.arguments)switch(e==null?void 0:e.view){case"Swap":return Me.open({...e,data:{swap:e.arguments}})}return Me.open(e)}async close(){await this.injectModalUi(),Me.close()}setLoading(e,n){Me.setLoading(e,n)}async disconnect(e){await X.disconnect({namespace:e})}getSIWX(){return j.state.siwx}getError(){return""}getChainId(){var e;return(e=A.state.activeCaipNetwork)==null?void 0:e.id}async switchNetwork(e){const n=this.getCaipNetworks().find(r=>r.id===e.id);if(!n){st.open(ut.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await A.switchActiveNetwork(n)}getWalletProvider(){return A.state.activeChain?Ye.state.providers[A.state.activeChain]:null}getWalletProviderType(){return Ye.getProviderId(A.state.activeChain)}subscribeProviders(e){return Ye.subscribeProviders(e)}getThemeMode(){return yn.state.themeMode}getThemeVariables(){return yn.state.themeVariables}setThemeMode(e){yn.setThemeMode(e),y_(yn.state.themeMode)}setTermsConditionsUrl(e){j.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){j.setPrivacyPolicyUrl(e)}setThemeVariables(e){yn.setThemeVariables(e),fH(yn.state.themeVariables)}subscribeTheme(e){return yn.subscribe(e)}subscribeConnections(e){return this.remoteFeatures.multiWallet?X.subscribe(e):(st.open(L.REMOTE_FEATURES_ALERTS.MULTI_WALLET_NOT_ENABLED.DEFAULT,"info"),()=>{})}getWalletInfo(e){return e?A.getAccountProp("connectedWalletInfo",e):ce.state.connectedWalletInfo}getAccount(e){const n=e||A.state.activeChain,r=J.getAuthConnector(n),s=A.getAccountData(n),i=V.getConnectedConnectorId(A.state.activeChain),o=X.getConnections(n);if(!n)throw new Error("AppKit:getAccount - namespace is required");const a=o.flatMap(c=>c.accounts.map(({address:l,type:u})=>oe.createAccount(n,l,u||"eoa")));if(s)return{allAccounts:a,caipAddress:s.caipAddress,address:oe.getPlainAddress(s.caipAddress),isConnected:!!s.caipAddress,status:s.status,embeddedWalletInfo:r&&i===L.CONNECTOR_ID.AUTH?{user:s.user?{...s.user,username:V.getConnectedSocialUsername()}:void 0,authProvider:s.socialProvider||"email",accountType:$n(n),isSmartAccountDeployed:!!s.smartAccountDeployed}:void 0}}subscribeAccount(e,n){const r=()=>{const s=this.getAccount(n);s&&e(s)};n?A.subscribeChainProp("accountState",r,n):A.subscribe(r),J.subscribe(r)}subscribeNetwork(e){return A.subscribe(({activeCaipNetwork:n})=>{e({caipNetwork:n,chainId:n==null?void 0:n.id,caipNetworkId:n==null?void 0:n.caipNetworkId})})}subscribeWalletInfo(e,n){return n?ce.subscribeKey("connectedWalletInfo",e,n):ce.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){ce.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){A.subscribeKey("activeCaipNetwork",e)}getState(){return Rr.state}getRemoteFeatures(){return j.state.remoteFeatures}subscribeState(e){return Rr.subscribe(e)}subscribeRemoteFeatures(e){return j.subscribeKey("remoteFeatures",e)}showErrorMessage(e){Pr.showError(e)}showSuccessMessage(e){Pr.showSuccess(e)}getEvent(){return{...Ve.state}}subscribeEvents(e){return Ve.subscribe(e)}replace(e){me.replace(e)}redirect(e){me.push(e)}popTransactionStack(e){me.popTransactionStack(e)}isOpen(){return Me.state.open}isTransactionStackEmpty(){return me.state.transactionStack.length===0}static getInstance(){return this.instance}updateFeatures(e){j.setFeatures(e)}updateRemoteFeatures(e){j.setRemoteFeatures(e)}updateOptions(e){const r={...j.state||{},...e};j.setOptions(r)}setConnectMethodsOrder(e){j.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){j.setWalletFeaturesOrder(e)}setCollapseWallets(e){j.setCollapseWallets(e)}setSocialsOrder(e){j.setSocialsOrder(e)}getConnectMethodsOrder(){return dp.getConnectOrderMethod(j.state.features,J.getConnectors())}addNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);const r=this.extendCaipNetwork(n,this.options);this.getCaipNetworks().find(s=>s.id===r.id)||A.addNetwork(r)}removeNetwork(e,n){if(this.chainAdapters&&!this.chainAdapters[e])throw new Error(`Adapter for namespace ${e} doesn't exist`);this.getCaipNetworks().find(s=>s.id===n)&&A.removeNetwork(e,n)}}let Sw=!1;class CH extends EH{async onAuthProviderConnected(e){e.message&&e.signature&&e.siwxMessage&&await Wn.addEmbeddedWalletSession({chainId:e.siwxMessage.chainId,accountAddress:e.address,notBefore:e.siwxMessage.notBefore,statement:e.siwxMessage.statement,resources:e.siwxMessage.resources,requestId:e.siwxMessage.requestId,issuedAt:e.siwxMessage.issuedAt,domain:e.siwxMessage.domain,uri:e.siwxMessage.uri,version:e.siwxMessage.version,nonce:e.siwxMessage.nonce},e.message,e.signature);const n=A.state.activeChain;if(!n)throw new Error("AppKit:onAuthProviderConnected - namespace is required");const r=n===L.CHAIN.EVM?`eip155:${e.chainId}:${e.address}`:`${e.chainId}:${e.address}`,s=j.state.defaultAccountTypes[n],i=$n(n),o=e.preferredAccountType||i||s;Pt.isLowerCaseMatch(e.address,ce.state.address)||this.syncIdentity({address:e.address,chainId:e.chainId,chainNamespace:n}),this.setCaipAddress(r,n);const{signature:a,siwxMessage:c,message:l,...u}=e;this.setUser({...ce.state.user||{},...u},n),this.setSmartAccountDeployed(!!e.smartAccountDeployed,n),this.setPreferredAccountType(o,n),this.setLoading(!1,n)}setupAuthConnectorListeners(e){e.onRpcRequest(n=>{Rn.checkIfRequestExists(n)?Rn.checkIfRequestIsSafe(n)||this.handleUnsafeRPCRequest():(this.open(),console.error(At.RPC_METHOD_NOT_ALLOWED_MESSAGE,{method:n.method}),setTimeout(()=>{this.showErrorMessage(At.RPC_METHOD_NOT_ALLOWED_UI_MESSAGE)},300),e.rejectRpcRequests())}),e.onRpcError(()=>{this.isOpen()&&(this.isTransactionStackEmpty()?this.close():this.popTransactionStack("error"))}),e.onRpcSuccess((n,r)=>{const s=Rn.checkIfRequestIsSafe(r),i=ce.state.address,o=A.state.activeCaipNetwork;s||(i&&(o!=null&&o.id)&&this.updateNativeBalance(i,o.id,o.chainNamespace),this.isTransactionStackEmpty()?this.close():this.popTransactionStack("success"))}),e.onNotConnected(()=>{const n=A.state.activeChain;if(!n)throw new Error("AppKit:onNotConnected - namespace is required");J.getConnectorId(n)===L.CONNECTOR_ID.AUTH&&(this.setCaipAddress(void 0,n),this.setLoading(!1,n))}),e.onConnect(this.onAuthProviderConnected.bind(this)),e.onSocialConnected(this.onAuthProviderConnected.bind(this)),e.onSetPreferredAccount(({address:n,type:r})=>{const s=A.state.activeChain;if(!s)throw new Error("AppKit:onSetPreferredAccount - namespace is required");n&&this.setPreferredAccountType(r,s)})}async syncAuthConnectorTheme(e){if(!e)return;const n=yn.getSnapshot(),r=j.getSnapshot();await Promise.all([e.syncDappData({metadata:r.metadata,sdkVersion:r.sdkVersion,projectId:r.projectId,sdkType:r.sdkType}),e.syncTheme({themeMode:n.themeMode,themeVariables:n.themeVariables,w3mThemeVariables:rs(n.themeVariables,n.themeMode)})])}async syncAuthConnector(e,n){var l,u,d,h;const r=L.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(n),s=n===A.state.activeChain;if(!r)return;this.setLoading(!0,n);const i=e.getLoginEmailUsed();this.setLoading(i,n),i&&this.setStatus("connecting",n);const o=e.getEmail(),a=e.getUsername();this.setUser({...((l=ce.state)==null?void 0:l.user)||{},username:a,email:o},n),this.setupAuthConnectorListeners(e);const{isConnected:c}=await e.isConnected();if(await this.syncAuthConnectorTheme(e),n&&r&&s){const f=await e.getSmartAccountEnabledNetworks();A.setSmartAccountEnabledNetworks((f==null?void 0:f.smartAccountEnabledNetworks)||[],n),c&&((u=this.connectionControllerClient)!=null&&u.connectExternal)?(await((h=this.connectionControllerClient)==null?void 0:h.connectExternal({id:L.CONNECTOR_ID.AUTH,info:{name:L.CONNECTOR_ID.AUTH},type:it.CONNECTOR_TYPE_AUTH,provider:e,chainId:(d=A.state.activeCaipNetwork)==null?void 0:d.id,chain:n})),this.setStatus("connected",n)):J.getConnectorId(n)===L.CONNECTOR_ID.AUTH&&(this.setStatus("disconnected",n),V.removeConnectedNamespace(n))}this.setLoading(!1,n)}async checkExistingTelegramSocialConnection(e){var n,r;try{if(!oe.isTelegram())return;const s=V.getTelegramSocialProvider();if(!s||!oe.isClient())return;const o=new URL(window.location.href).searchParams.get("result_uri");if(!o)return;ce.setSocialProvider(s,e),await((n=this.authProvider)==null?void 0:n.init());const a=J.getAuthConnector();s&&a&&(this.setLoading(!0,e),await X.connectExternal({id:a.id,type:a.type,socialUri:o},a.chain),V.setConnectedSocialProvider(s),V.removeTelegramSocialProvider(),Ve.sendEvent({type:"track",event:"SOCIAL_LOGIN_SUCCESS",properties:{provider:s,caipNetworkId:(r=A.getActiveCaipNetwork())==null?void 0:r.caipNetworkId}}))}catch(s){this.setLoading(!1,e),console.error("checkExistingSTelegramocialConnection error",s)}try{const s=new URL(window.location.href);s.searchParams.delete("result_uri"),window.history.replaceState({},document.title,s.toString())}catch(s){console.error("tma social login failed",s)}}createAuthProvider(e){var l,u,d,h;if(!L.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(e))return;const r=(l=this.remoteFeatures)==null?void 0:l.email,s=Array.isArray((u=this.remoteFeatures)==null?void 0:u.socials)&&this.remoteFeatures.socials.length>0,i=r||s,a=Pt.getActiveNamespaceConnectedToAuth()||e;!this.authProvider&&((d=this.options)!=null&&d.projectId)&&i&&(this.authProvider=Si.getInstance({projectId:this.options.projectId,enableLogger:this.options.enableAuthLogger,chainId:(h=this.getCaipNetwork(a))==null?void 0:h.caipNetworkId,abortController:ut.EmbeddedWalletAbortController,onTimeout:f=>{f==="iframe_load_failed"?st.open(ut.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):f==="iframe_request_timeout"?st.open(ut.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):f==="unverified_domain"&&st.open(ut.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:f=>A.getActiveCaipNetwork(f)}),Rr.subscribeOpen(f=>{var p;!f&&this.isTransactionStackEmpty()&&((p=this.authProvider)==null||p.rejectRpcRequests())}));const c=e===A.state.activeChain&&j.state.enableReconnect;j.state.enableReconnect===!1?this.syncAuthConnectorTheme(this.authProvider):this.authProvider&&c&&(this.syncAuthConnector(this.authProvider,e),this.checkExistingTelegramSocialConnection(e))}createAuthProviderForAdapter(e){var n,r,s;this.createAuthProvider(e),this.authProvider&&((s=(r=(n=this.chainAdapters)==null?void 0:n[e])==null?void 0:r.setAuthProvider)==null||s.call(r,this.authProvider))}initControllers(e){super.initControllers(e),this.options.excludeWalletIds&&de.initializeExcludedWallets({ids:this.options.excludeWalletIds})}async switchCaipNetwork(e){var o,a;if(!e)return;const n=A.state.activeChain,r=e.chainNamespace,s=this.getAddressByChainNamespace(r);if(r===n&&s){const c=this.getAdapter(r),l=Ye.getProvider(r),u=Ye.getProviderId(r);await(c==null?void 0:c.switchNetwork({caipNetwork:e,provider:l,providerType:u})),this.setCaipNetwork(e)}else{const l=Ye.getProviderId(n)===it.CONNECTOR_TYPE_AUTH,u=Ye.getProviderId(r),d=u===it.CONNECTOR_TYPE_AUTH,h=L.AUTH_CONNECTOR_SUPPORTED_CHAINS.includes(r);if(!r)throw new Error("AppKit:switchCaipNetwork - networkNamespace is required");if((l&&u===void 0||d)&&h)try{if(A.state.activeChain=e.chainNamespace,s){const f=this.getAdapter(r);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else await((a=(o=this.connectionControllerClient)==null?void 0:o.connectExternal)==null?void 0:a.call(o,{id:L.CONNECTOR_ID.AUTH,provider:this.authProvider,chain:r,chainId:e.id,type:it.CONNECTOR_TYPE_AUTH,caipNetwork:e}));this.setCaipNetwork(e)}catch{const p=this.getAdapter(r);await(p==null?void 0:p.switchNetwork({caipNetwork:e,provider:this.authProvider,providerType:u}))}else if(u===it.CONNECTOR_TYPE_WALLET_CONNECT){if(!A.state.noAdapters){const f=this.getAdapter(r),p=Ye.getProvider(r),g=Ye.getProviderId(r);await(f==null?void 0:f.switchNetwork({caipNetwork:e,provider:p,providerType:g}))}this.setCaipNetwork(e),this.syncWalletConnectAccount()}else this.setCaipNetwork(e),s&&this.syncAccount({address:s,chainId:e.id,chainNamespace:r})}}async initialize(e){var n;await super.initialize(e),(n=this.chainNamespaces)==null||n.forEach(r=>{this.createAuthProviderForAdapter(r)}),await this.injectModalUi(),Rr.set({initialized:!0})}async syncIdentity({address:e,chainId:n,chainNamespace:r}){var o;const s=`${r}:${n}`,i=(o=this.caipNetworks)==null?void 0:o.find(a=>a.caipNetworkId===s);if(r!==L.CHAIN.EVM||i!=null&&i.testnet){this.setProfileName(null,r),this.setProfileImage(null,r);return}try{const{name:a,avatar:c}=await this.fetchIdentity({address:e,caipNetworkId:s});this.setProfileName(a,r),this.setProfileImage(c,r)}catch{await this.syncReownName(e,r),n!==1&&this.setProfileImage(null,r)}}syncConnectedWalletInfo(e){const n=Ye.getProviderId(e);if(n===it.CONNECTOR_TYPE_AUTH){const r=this.authProvider;if(r){const s=V.getConnectedSocialProvider()??"email",i=r.getEmail()??r.getUsername();this.setConnectedWalletInfo({name:n,identifier:i,social:s},e)}}else super.syncConnectedWalletInfo(e)}async injectModalUi(){if(oe.isClient()&&!Sw)try{const e={...qe.DEFAULT_FEATURES,...this.options.features},n=this.remoteFeatures;if(await this.loadModalComponents(e,n),oe.isClient()&&!document.querySelector("w3m-modal")){const s=document.createElement("w3m-modal");!j.state.disableAppend&&!j.state.enableEmbedded&&document.body.insertAdjacentElement("beforeend",s)}Sw=!0}catch(e){console.error("Error injecting modal UI:",e)}}async loadModalComponents(e,n){if(!oe.isClient())return;const r=[];(n.email||n.socials&&n.socials.length>0)&&r.push(Qt(()=>import("./PSPsK788.js"),__vite__mapDeps([6,7,8,9,10,11,12,13,14,15,16,17,18]),import.meta.url)),n.email&&r.push(Qt(()=>import("./Xe9s1VLN.js"),__vite__mapDeps([19,7,8,18,12,17,11,16,20,13]),import.meta.url)),n.socials&&r.push(Qt(()=>import("./zKXTYsiU.js"),__vite__mapDeps([21,7,8,22,11,23,24,17,25,16,12,18,26,10,27]),import.meta.url)),n.swaps&&n.swaps.length>0&&r.push(Qt(()=>import("./BIQttNBf.js"),__vite__mapDeps([28,7,8,16,12,29,30,31,10,17,27,13,11]),import.meta.url)),e.send&&r.push(Qt(()=>import("./BmbHSen-.js"),__vite__mapDeps([32,7,8,16,12,17,11,23,18,31,10,13,33,34]),import.meta.url)),e.receive&&r.push(Qt(()=>import("./8kaIfX-U.js"),__vite__mapDeps([35,7,8,36,10,26]),import.meta.url)),n.onramp&&n.onramp.length>0&&r.push(Qt(()=>import("./-154K8v3.js"),__vite__mapDeps([37,7,8,38,10,12,17,22,11,23,39,18,16,25,13]),import.meta.url)),n.activity&&r.push(Qt(()=>import("./BtCy2t97.js"),__vite__mapDeps([40,7,8,41,1,17,18,10,27]),import.meta.url)),e.pay&&r.push(Qt(()=>import("./DDlNpnEm.js"),__vite__mapDeps([42,7,8,16,12,43,10,17,14,38,34,25]),import.meta.url)),await Promise.all([...r,Qt(()=>import("./Bt1sM-2S.js"),__vite__mapDeps([44,7,8,10,12,33,17,45,30,14,38,16,15,43,41,1,18,27,29,34,11,13,20,22,23,24,9,25,36,26,39]),import.meta.url),Qt(()=>import("./CTQ6PdE0.js"),__vite__mapDeps([46,7,8,14,10,17,15,12,30,45]),import.meta.url)])}}const _H="1.7.15";function Yz(t){return new CH({...t,sdkVersion:oe.generateSdkVersion(t.adapters??[],"html",_H)})}function Kn(t,e,n){const r=t[e.name];if(typeof r=="function")return r;const s=t[n];return typeof s=="function"?s:i=>e(t,i)}const lu="2.17.3",AH=()=>`@wagmi/core@${lu}`;var b_=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},qu,v_;class gr extends Error{get docsBaseUrl(){return"https://wagmi.sh/core"}get version(){return AH()}constructor(e,n={}){var i;super(),qu.add(this),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"WagmiCoreError"});const r=n.cause instanceof gr?n.cause.details:(i=n.cause)!=null&&i.message?n.cause.message:n.details,s=n.cause instanceof gr&&n.cause.docsPath||n.docsPath;this.message=[e||"An error occurred.","",...n.metaMessages?[...n.metaMessages,""]:[],...s?[`Docs: ${this.docsBaseUrl}${s}.html${n.docsSlug?`#${n.docsSlug}`:""}`]:[],...r?[`Details: ${r}`]:[],`Version: ${this.version}`].join(`
`),n.cause&&(this.cause=n.cause),this.details=r,this.docsPath=s,this.metaMessages=n.metaMessages,this.shortMessage=e}walk(e){return b_(this,qu,"m",v_).call(this,this,e)}}qu=new WeakSet,v_=function t(e,n){return n!=null&&n(e)?e:e.cause?b_(this,qu,"m",t).call(this,e.cause,n):e};class Wc extends gr{constructor(){super("Chain not configured."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ChainNotConfiguredError"})}}class IH extends gr{constructor(){super("Connector already connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAlreadyConnectedError"})}}class SH extends gr{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class NH extends gr{constructor({address:e,connector:n}){super(`Account "${e}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class xH extends gr{constructor({connectionChainId:e,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${e}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${e}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class TH extends gr{constructor({connector:e}){super(`Connector "${e.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function Bh(t,e){var r;let n;if(typeof e.connector=="function"?n=t._internal.connectors.setup(e.connector):n=e.connector,n.uid===t.state.current)throw new IH;try{t.setState(c=>({...c,status:"connecting"})),n.emitter.emit("message",{type:"connecting"});const{connector:s,...i}=e,o=await n.connect(i),a=o.accounts;return n.emitter.off("connect",t._internal.events.connect),n.emitter.on("change",t._internal.events.change),n.emitter.on("disconnect",t._internal.events.disconnect),await((r=t.storage)==null?void 0:r.setItem("recentConnectorId",n.id)),t.setState(c=>({...c,connections:new Map(c.connections).set(n.uid,{accounts:a,chainId:o.chainId,connector:n}),current:n.uid,status:"connected"})),{accounts:a,chainId:o.chainId}}catch(s){throw t.setState(i=>({...i,status:i.current?"connected":"disconnected"})),s}}async function Td(t,e={}){let n;if(e.connector){const{connector:l}=e;if(t.state.status==="reconnecting"&&!l.getAccounts&&!l.getChainId)throw new TH({connector:l});const[u,d]=await Promise.all([l.getAccounts().catch(h=>{if(e.account===null)return[];throw h}),l.getChainId()]);n={accounts:u,chainId:d,connector:l}}else n=t.state.connections.get(t.state.current);if(!n)throw new SH;const r=e.chainId??n.chainId,s=await n.connector.getChainId();if(s!==n.chainId)throw new xH({connectionChainId:n.chainId,connectorChainId:s});const i=n.connector;if(i.getClient)return i.getClient({chainId:r});const o=Hr(e.account??n.accounts[0]);if(o&&(o.address=mi(o.address)),e.account&&!n.accounts.some(l=>l.toLowerCase()===o.address.toLowerCase()))throw new NH({address:o.address,connector:i});const a=t.chains.find(l=>l.id===r),c=await n.connector.getProvider({chainId:r});return j1({account:o,chain:a,name:"Connector Client",transport:l=>TN(c)({...l,retryCount:0})})}async function Nw(t,e={}){var s,i;let n;if(e.connector)n=e.connector;else{const{connections:o,current:a}=t.state,c=o.get(a);n=c==null?void 0:c.connector}const r=t.state.connections;n&&(await n.disconnect(),n.emitter.off("change",t._internal.events.change),n.emitter.off("disconnect",t._internal.events.disconnect),n.emitter.on("connect",t._internal.events.connect),r.delete(n.uid)),t.setState(o=>{if(r.size===0)return{...o,connections:new Map,current:null,status:"disconnected"};const a=r.values().next().value;return{...o,connections:new Map(r),current:a.connector.uid}});{const o=t.state.current;if(!o)return;const a=(s=t.state.connections.get(o))==null?void 0:s.connector;if(!a)return;await((i=t.storage)==null?void 0:i.setItem("recentConnectorId",a.id))}}async function PH(t,e){const{chainId:n,connector:r,...s}=e;let i;e.account?i=e.account:i=(await Td(t,{account:e.account,chainId:n,connector:r})).account;const o=t.getClient({chainId:n});return Kn(o,I1,"estimateGas")({...s,account:i})}function E_(t){return typeof t=="number"?t:t==="wei"?0:Math.abs(V2[t])}function Ja(t){const e=t.state.current,n=t.state.connections.get(e),r=n==null?void 0:n.accounts,s=r==null?void 0:r[0],i=t.chains.find(a=>a.id===(n==null?void 0:n.chainId)),o=t.state.status;switch(o){case"connected":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!0,isConnecting:!1,isDisconnected:!1,isReconnecting:!1,status:o};case"reconnecting":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!!s,isConnecting:!1,isDisconnected:!1,isReconnecting:!0,status:o};case"connecting":return{address:s,addresses:r,chain:i,chainId:n==null?void 0:n.chainId,connector:n==null?void 0:n.connector,isConnected:!1,isConnecting:!0,isDisconnected:!1,isReconnecting:!1,status:o};case"disconnected":return{address:void 0,addresses:void 0,chain:void 0,chainId:void 0,connector:void 0,isConnected:!1,isConnecting:!1,isDisconnected:!0,isReconnecting:!1,status:o}}}async function OH(t,e){const{allowFailure:n=!0,chainId:r,contracts:s,...i}=e,o=t.getClient({chainId:r});return Kn(o,BN,"multicall")({allowFailure:n,contracts:s,...i})}function RH(t,e){const{chainId:n,...r}=e,s=t.getClient({chainId:n});return Kn(s,L1,"readContract")(r)}async function DH(t,e){var a;const{allowFailure:n=!0,blockNumber:r,blockTag:s,...i}=e,o=e.contracts;try{const c={};for(const[h,f]of o.entries()){const p=f.chainId??t.state.chainId;c[p]||(c[p]=[]),(a=c[p])==null||a.push({contract:f,index:h})}const l=()=>Object.entries(c).map(([h,f])=>OH(t,{...i,allowFailure:n,blockNumber:r,blockTag:s,chainId:Number.parseInt(h),contracts:f.map(({contract:p})=>p)})),u=(await Promise.all(l())).flat(),d=Object.values(c).flatMap(h=>h.map(({index:f})=>f));return u.reduce((h,f,p)=>(h&&(h[d[p]]=f),h),[])}catch(c){if(c instanceof t1)throw c;const l=()=>o.map(u=>RH(t,{...u,blockNumber:r,blockTag:s}));return n?(await Promise.allSettled(l())).map(u=>u.status==="fulfilled"?{result:u.value,status:"success"}:{error:u.reason,result:void 0,status:"failure"}):await Promise.all(l())}}async function $H(t,e){const{address:n,blockNumber:r,blockTag:s,chainId:i,token:o,unit:a="ether"}=e;if(o)try{return await xw(t,{balanceAddress:n,chainId:i,symbolType:"string",tokenAddress:o})}catch(h){if(h.name==="ContractFunctionExecutionError"){const f=await xw(t,{balanceAddress:n,chainId:i,symbolType:"bytes32",tokenAddress:o}),p=fb(Fs(f.symbol,{dir:"right"}));return{...f,symbol:p}}throw h}const c=t.getClient({chainId:i}),u=await Kn(c,A1,"getBalance")(r?{address:n,blockNumber:r}:{address:n,blockTag:s}),d=t.chains.find(h=>h.id===i)??c.chain;return{decimals:d.nativeCurrency.decimals,formatted:Go(u,E_(a)),symbol:d.nativeCurrency.symbol,value:u}}async function xw(t,e){const{balanceAddress:n,chainId:r,symbolType:s,tokenAddress:i,unit:o}=e,a={abi:[{type:"function",name:"balanceOf",stateMutability:"view",inputs:[{type:"address"}],outputs:[{type:"uint256"}]},{type:"function",name:"decimals",stateMutability:"view",inputs:[],outputs:[{type:"uint8"}]},{type:"function",name:"symbol",stateMutability:"view",inputs:[],outputs:[{type:s}]}],address:i},[c,l,u]=await DH(t,{allowFailure:!1,contracts:[{...a,functionName:"balanceOf",args:[n],chainId:r},{...a,functionName:"decimals",chainId:r},{...a,functionName:"symbol",chainId:r}]}),d=Go(c??"0",E_(o??l));return{decimals:l,formatted:d,symbol:u,value:c}}function Vc(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;let n,r;if(Array.isArray(t)&&Array.isArray(e)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Vc(t[r],e[r]))return!1;return!0}if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const s=Object.keys(t);if(n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(i&&!Vc(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}let Wl=[];function es(t){const e=[...t.state.connections.values()];return t.state.status==="reconnecting"||Vc(Wl,e)?Wl:(Wl=e,e)}async function kH(t,e){const{account:n,chainId:r,...s}=e,i=n??Ja(t).address,o=t.getClient({chainId:r});return Kn(o,kp,"prepareTransactionRequest")({...s,...i?{account:i}:{}})}let Fh=!1;async function Tw(t,e={}){var l,u;if(Fh)return[];Fh=!0,t.setState(d=>({...d,status:d.current?"reconnecting":"connecting"}));const n=[];if((l=e.connectors)!=null&&l.length)for(const d of e.connectors){let h;typeof d=="function"?h=t._internal.connectors.setup(d):h=d,n.push(h)}else n.push(...t.connectors);let r;try{r=await((u=t.storage)==null?void 0:u.getItem("recentConnectorId"))}catch{}const s={};for(const[,d]of t.state.connections)s[d.connector.id]=1;r&&(s[r]=0);const i=Object.keys(s).length>0?[...n].sort((d,h)=>(s[d.id]??10)-(s[h.id]??10)):n;let o=!1;const a=[],c=[];for(const d of i){const h=await d.getProvider().catch(()=>{});if(!h||c.some(g=>g===h)||!await d.isAuthorized())continue;const p=await d.connect({isReconnecting:!0}).catch(()=>null);p&&(d.emitter.off("connect",t._internal.events.connect),d.emitter.on("change",t._internal.events.change),d.emitter.on("disconnect",t._internal.events.disconnect),t.setState(g=>{const m=new Map(o?g.connections:new Map).set(d.uid,{accounts:p.accounts,chainId:p.chainId,connector:d});return{...g,current:o?g.current:d.uid,connections:m}}),a.push({accounts:p.accounts,chainId:p.chainId,connector:d}),c.push(h),o=!0)}return(t.state.status==="reconnecting"||t.state.status==="connecting")&&(o?t.setState(d=>({...d,status:"connected"})):t.setState(d=>({...d,connections:new Map,current:null,status:"disconnected"}))),Fh=!1,a}async function UH(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?o=t.getClient({chainId:r}):o=await Td(t,{account:n??void 0,chainId:r,connector:s}),await Kn(o,B1,"sendTransaction")({...i,...n?{account:n}:{},chain:r?{id:r}:null,gas:i.gas??void 0})}async function LH(t,e){const{account:n,connector:r,...s}=e;let i;return typeof n=="object"&&n.type==="local"?i=t.getClient():i=await Td(t,{account:n,connector:r}),Kn(i,ix,"signMessage")({...s,...n?{account:n}:{}})}class Ds extends gr{constructor(){super("Provider not found."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ProviderNotFoundError"})}}class MH extends gr{constructor({connector:e}){super(`"${e.name}" does not support programmatic chain switching.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"SwitchChainNotSupportedError"})}}async function Pw(t,e){var o;const{addEthereumChainParameter:n,chainId:r}=e,s=t.state.connections.get(((o=e.connector)==null?void 0:o.uid)??t.state.current);if(s){const a=s.connector;if(!a.switchChain)throw new MH({connector:a});return await a.switchChain({addEthereumChainParameter:n,chainId:r})}const i=t.chains.find(a=>a.id===r);if(!i)throw new Wc;return t.setState(a=>({...a,chainId:r})),i}function BH(t,e){const{onChange:n}=e;return t.subscribe(()=>Ja(t),n,{equalityFn(r,s){const{connector:i,...o}=r,{connector:a,...c}=s;return Vc(o,c)&&(i==null?void 0:i.id)===(a==null?void 0:a.id)&&(i==null?void 0:i.uid)===(a==null?void 0:a.uid)}})}function FH(t,e){const{onChange:n}=e;return t.subscribe(()=>es(t),n,{equalityFn:Vc})}function jH(t,e){const{onChange:n}=e;return t._internal.connectors.subscribe((r,s)=>{n(Object.values(r),s)})}function HH(t,e){const{syncConnectedChain:n=t._internal.syncConnectedChain,...r}=e;let s;const i=c=>{s&&s();const l=t.getClient({chainId:c});return s=Kn(l,sx,"watchPendingTransactions")(r),s},o=i(e.chainId);let a;return n&&!e.chainId&&(a=t.subscribe(({chainId:c})=>c,async c=>i(c))),()=>{o==null||o(),a==null||a()}}async function qH(t,e){const{chainId:n,timeout:r=0,...s}=e,i=t.getClient({chainId:n}),a=await Kn(i,rx,"waitForTransactionReceipt")({...s,timeout:r});if(a.status==="reverted"){const l=await Kn(i,q1,"getTransaction")({hash:a.transactionHash}),d=await Kn(i,U1,"call")({...l,data:l.input,gasPrice:l.type!=="eip1559"?l.gasPrice:void 0,maxFeePerGas:l.type==="eip1559"?l.maxFeePerGas:void 0,maxPriorityFeePerGas:l.type==="eip1559"?l.maxPriorityFeePerGas:void 0}),h=d!=null&&d.data?fb(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(h)}return{...a,chainId:i.chain.id}}async function zH(t,e){const{account:n,chainId:r,connector:s,...i}=e;let o;return typeof n=="object"&&(n==null?void 0:n.type)==="local"?o=t.getClient({chainId:r}):o=await Td(t,{account:n??void 0,chainId:r,connector:s}),await Kn(o,_N,"writeContract")({...i,...n?{account:n}:{},chain:r?{id:r}:null})}function Zz(t){return t}Pd.type="injected";function Pd(t={}){const{shimDisconnect:e=!0,unstable_shimAsyncInject:n}=t;function r(){const c=t.target;if(typeof c=="function"){const l=c();if(l)return l}return typeof c=="object"?c:typeof c=="string"?{...WH[c]??{id:c,name:`${c[0].toUpperCase()}${c.slice(1)}`,provider:`is${c[0].toUpperCase()}${c.slice(1)}`}}:{id:"injected",name:"Injected",provider(l){return l==null?void 0:l.ethereum}}}let s,i,o,a;return c=>({get icon(){return r().icon},get id(){return r().id},get name(){return r().name},get supportsSimulation(){return!0},type:Pd.type,async setup(){const l=await this.getProvider();l!=null&&l.on&&t.target&&(o||(o=this.onConnect.bind(this),l.on("connect",o)),s||(s=this.onAccountsChanged.bind(this),l.on("accountsChanged",s)))},async connect({chainId:l,isReconnecting:u}={}){var f,p,g,m,v,b;const d=await this.getProvider();if(!d)throw new Ds;let h=[];if(u)h=await this.getAccounts().catch(()=>[]);else if(e)try{h=(m=(g=(p=(f=(await d.request({method:"wallet_requestPermissions",params:[{eth_accounts:{}}]}))[0])==null?void 0:f.caveats)==null?void 0:p[0])==null?void 0:g.value)==null?void 0:m.map(N=>mi(N)),h.length>0&&(h=await this.getAccounts())}catch(y){const N=y;if(N.code===Et.code)throw new Et(N);if(N.code===js.code)throw N}try{!(h!=null&&h.length)&&!u&&(h=(await d.request({method:"eth_requestAccounts"})).map(_=>mi(_))),o&&(d.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),d.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),d.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),d.on("disconnect",a));let y=await this.getChainId();if(l&&y!==l){const N=await this.switchChain({chainId:l}).catch(_=>{if(_.code===Et.code)throw _;return{id:y}});y=(N==null?void 0:N.id)??y}return e&&await((v=c.storage)==null?void 0:v.removeItem(`${this.id}.disconnected`)),t.target||await((b=c.storage)==null?void 0:b.setItem("injected.connected",!0)),{accounts:h,chainId:y}}catch(y){const N=y;throw N.code===Et.code?new Et(N):N.code===js.code?new js(N):N}},async disconnect(){var u,d;const l=await this.getProvider();if(!l)throw new Ds;i&&(l.removeListener("chainChanged",i),i=void 0),a&&(l.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),l.on("connect",o));try{await H1(()=>l.request({method:"wallet_revokePermissions",params:[{eth_accounts:{}}]}),{timeout:100})}catch{}e&&await((u=c.storage)==null?void 0:u.setItem(`${this.id}.disconnected`,!0)),t.target||await((d=c.storage)==null?void 0:d.removeItem("injected.connected"))},async getAccounts(){const l=await this.getProvider();if(!l)throw new Ds;return(await l.request({method:"eth_accounts"})).map(d=>mi(d))},async getChainId(){const l=await this.getProvider();if(!l)throw new Ds;const u=await l.request({method:"eth_chainId"});return Number(u)},async getProvider(){if(typeof window>"u")return;let l;const u=r();return typeof u.provider=="function"?l=u.provider(window):typeof u.provider=="string"?l=uu(window,u.provider):l=u.provider,l&&!l.removeListener&&("off"in l&&typeof l.off=="function"?l.removeListener=l.off:l.removeListener=()=>{}),l},async isAuthorized(){var l,u;try{if(e&&await((l=c.storage)==null?void 0:l.getItem(`${this.id}.disconnected`))||!t.target&&!await((u=c.storage)==null?void 0:u.getItem("injected.connected")))return!1;if(!await this.getProvider()){if(n!==void 0&&n!==!1){const p=async()=>(typeof window<"u"&&window.removeEventListener("ethereum#initialized",p),!!await this.getProvider()),g=typeof n=="number"?n:1e3;if(await Promise.race([...typeof window<"u"?[new Promise(v=>window.addEventListener("ethereum#initialized",()=>v(p()),{once:!0}))]:[],new Promise(v=>setTimeout(()=>v(p()),g))]))return!0}throw new Ds}return!!(await vu(()=>this.getAccounts())).length}catch{return!1}},async switchChain({addEthereumChainParameter:l,chainId:u}){var p,g,m,v;const d=await this.getProvider();if(!d)throw new Ds;const h=c.chains.find(b=>b.id===u);if(!h)throw new Mr(new Wc);const f=new Promise(b=>{const y=N=>{"chainId"in N&&N.chainId===u&&(c.emitter.off("change",y),b())};c.emitter.on("change",y)});try{return await Promise.all([d.request({method:"wallet_switchEthereumChain",params:[{chainId:Ne(u)}]}).then(async()=>{await this.getChainId()===u&&c.emitter.emit("change",{chainId:u})}),f]),h}catch(b){const y=b;if(y.code===4902||((g=(p=y==null?void 0:y.data)==null?void 0:p.originalError)==null?void 0:g.code)===4902)try{const{default:N,..._}=h.blockExplorers??{};let T;l!=null&&l.blockExplorerUrls?T=l.blockExplorerUrls:N&&(T=[N.url,...Object.values(_).map(I=>I.url)]);let x;(m=l==null?void 0:l.rpcUrls)!=null&&m.length?x=l.rpcUrls:x=[((v=h.rpcUrls.default)==null?void 0:v.http[0])??""];const D={blockExplorerUrls:T,chainId:Ne(u),chainName:(l==null?void 0:l.chainName)??h.name,iconUrls:l==null?void 0:l.iconUrls,nativeCurrency:(l==null?void 0:l.nativeCurrency)??h.nativeCurrency,rpcUrls:x};return await Promise.all([d.request({method:"wallet_addEthereumChain",params:[D]}).then(async()=>{if(await this.getChainId()===u)c.emitter.emit("change",{chainId:u});else throw new Et(new Error("User rejected switch after adding network."))}),f]),h}catch(N){throw new Et(N)}throw y.code===Et.code?new Et(y):new Mr(y)}},async onAccountsChanged(l){var u;if(l.length===0)this.onDisconnect();else if(c.emitter.listenerCount("connect")){const d=(await this.getChainId()).toString();this.onConnect({chainId:d}),e&&await((u=c.storage)==null?void 0:u.removeItem(`${this.id}.disconnected`))}else c.emitter.emit("change",{accounts:l.map(d=>mi(d))})},onChainChanged(l){const u=Number(l);c.emitter.emit("change",{chainId:u})},async onConnect(l){const u=await this.getAccounts();if(u.length===0)return;const d=Number(l.chainId);c.emitter.emit("connect",{accounts:u,chainId:d});const h=await this.getProvider();h&&(o&&(h.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),h.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),h.on("chainChanged",i)),a||(a=this.onDisconnect.bind(this),h.on("disconnect",a)))},async onDisconnect(l){const u=await this.getProvider();l&&l.code===1013&&u&&(await this.getAccounts()).length||(c.emitter.emit("disconnect"),u&&(i&&(u.removeListener("chainChanged",i),i=void 0),a&&(u.removeListener("disconnect",a),a=void 0),o||(o=this.onConnect.bind(this),u.on("connect",o))))}})}const WH={coinbaseWallet:{id:"coinbaseWallet",name:"Coinbase Wallet",provider(t){return t!=null&&t.coinbaseWalletExtension?t.coinbaseWalletExtension:uu(t,"isCoinbaseWallet")}},metaMask:{id:"metaMask",name:"MetaMask",provider(t){return uu(t,e=>{if(!e.isMetaMask||e.isBraveWallet&&!e._events&&!e._state)return!1;const n=["isApexWallet","isAvalanche","isBitKeep","isBlockWallet","isKuCoinWallet","isMathWallet","isOkxWallet","isOKExWallet","isOneInchIOSWallet","isOneInchAndroidWallet","isOpera","isPhantom","isPortal","isRabby","isTokenPocket","isTokenary","isUniswapWallet","isZerion"];for(const r of n)if(e[r])return!1;return!0})}},phantom:{id:"phantom",name:"Phantom",provider(t){var e,n;return(e=t==null?void 0:t.phantom)!=null&&e.ethereum?(n=t.phantom)==null?void 0:n.ethereum:uu(t,"isPhantom")}}};function uu(t,e){function n(s){return typeof e=="function"?e(s):typeof e=="string"?s[e]:!0}const r=t.ethereum;if(r!=null&&r.providers)return r.providers.find(s=>n(s));if(r&&n(r))return r}function VH(t){if(typeof window>"u")return;const e=n=>t(n.detail);return window.addEventListener("eip6963:announceProvider",e),window.dispatchEvent(new CustomEvent("eip6963:requestProvider")),()=>window.removeEventListener("eip6963:announceProvider",e)}function GH(){const t=new Set;let e=[];const n=()=>VH(s=>{e.some(({info:i})=>i.uuid===s.info.uuid)||(e=[...e,s],t.forEach(i=>i(e,{added:[s]})))});let r=n();return{_listeners(){return t},clear(){t.forEach(s=>s([],{removed:[...e]})),e=[]},destroy(){this.clear(),t.clear(),r==null||r()},findProvider({rdns:s}){return e.find(i=>i.info.rdns===s)},getProviders(){return e},reset(){this.clear(),r==null||r(),r=n()},subscribe(s,{emitImmediately:i}={}){return t.add(s),i&&s(e,{added:e}),()=>t.delete(s)}}}const KH=t=>(e,n,r)=>{const s=r.subscribe;return r.subscribe=(o,a,c)=>{let l=o;if(a){const u=(c==null?void 0:c.equalityFn)||Object.is;let d=o(r.getState());l=h=>{const f=o(h);if(!u(d,f)){const p=d;a(d=f,p)}},c!=null&&c.fireImmediately&&a(d,d)}return s(l)},t(e,n,r)},YH=KH;function ZH(t,e){let n;try{n=t()}catch{return}return{getItem:s=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(o):o(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const fp=t=>e=>{try{const n=t(e);return n instanceof Promise?n:{then(r){return fp(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return fp(r)(n)}}}},JH=(t,e)=>(n,r,s)=>{let i={storage:ZH(()=>localStorage),partialize:g=>g,version:0,merge:(g,m)=>({...m,...g}),...e},o=!1;const a=new Set,c=new Set;let l=i.storage;if(!l)return t((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...g)},r,s);const u=()=>{const g=i.partialize({...r()});return l.setItem(i.name,{state:g,version:i.version})},d=s.setState;s.setState=(g,m)=>{d(g,m),u()};const h=t((...g)=>{n(...g),u()},r,s);s.getInitialState=()=>h;let f;const p=()=>{var g,m;if(!l)return;o=!1,a.forEach(b=>{var y;return b((y=r())!=null?y:h)});const v=((m=i.onRehydrateStorage)==null?void 0:m.call(i,(g=r())!=null?g:h))||void 0;return fp(l.getItem.bind(l))(i.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate)return[!0,i.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var y;const[N,_]=b;if(f=i.merge(_,(y=r())!=null?y:h),n(f,!0),N)return u()}).then(()=>{v==null||v(f,void 0),f=r(),o=!0,c.forEach(b=>b(f))}).catch(b=>{v==null||v(void 0,b)})};return s.persist={setOptions:g=>{i={...i,...g},g.storage&&(l=g.storage)},clearStorage:()=>{l==null||l.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>o,onHydrate:g=>(a.add(g),()=>{a.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},i.skipHydration||p(),f||h},XH=JH,Ow=t=>{let e;const n=new Set,r=(l,u)=>{const d=typeof l=="function"?l(e):l;if(!Object.is(d,e)){const h=e;e=u??(typeof d!="object"||d===null)?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},s=()=>e,a={setState:r,getState:s,getInitialState:()=>c,subscribe:l=>(n.add(l),()=>n.delete(l))},c=e=t(r,s,a);return a},jh=t=>t?Ow(t):Ow;var C_={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,l,u){this.fn=c,this.context=l,this.once=u||!1}function i(c,l,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,d||c,h),p=n?n+l:l;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],f]:c._events[p].push(f):(c._events[p]=f,c._eventsCount++),c}function o(c,l){--c._eventsCount===0?c._events=new r:delete c._events[l]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var l=[],u,d;if(this._eventsCount===0)return l;for(d in u=this._events)e.call(u,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(u)):l},a.prototype.listeners=function(l){var u=n?n+l:l,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},a.prototype.listenerCount=function(l){var u=n?n+l:l,d=this._events[u];return d?d.fn?1:d.length:0},a.prototype.emit=function(l,u,d,h,f,p){var g=n?n+l:l;if(!this._events[g])return!1;var m=this._events[g],v=arguments.length,b,y;if(m.fn){switch(m.once&&this.removeListener(l,m.fn,void 0,!0),v){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,h),!0;case 5:return m.fn.call(m.context,u,d,h,f),!0;case 6:return m.fn.call(m.context,u,d,h,f,p),!0}for(y=1,b=new Array(v-1);y<v;y++)b[y-1]=arguments[y];m.fn.apply(m.context,b)}else{var N=m.length,_;for(y=0;y<N;y++)switch(m[y].once&&this.removeListener(l,m[y].fn,void 0,!0),v){case 1:m[y].fn.call(m[y].context);break;case 2:m[y].fn.call(m[y].context,u);break;case 3:m[y].fn.call(m[y].context,u,d);break;case 4:m[y].fn.call(m[y].context,u,d,h);break;default:if(!b)for(_=1,b=new Array(v-1);_<v;_++)b[_-1]=arguments[_];m[y].fn.apply(m[y].context,b)}}return!0},a.prototype.on=function(l,u,d){return i(this,l,u,d,!1)},a.prototype.once=function(l,u,d){return i(this,l,u,d,!0)},a.prototype.removeListener=function(l,u,d,h){var f=n?n+l:l;if(!this._events[f])return this;if(!u)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&o(this,f);else{for(var g=0,m=[],v=p.length;g<v;g++)(p[g].fn!==u||h&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(l){var u;return l?(u=n?n+l:l,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(C_);var QH=C_.exports;const eq=zu(QH);class tq{constructor(e){Object.defineProperty(this,"uid",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"_emitter",{enumerable:!0,configurable:!0,writable:!0,value:new eq})}on(e,n){this._emitter.on(e,n)}once(e,n){this._emitter.once(e,n)}off(e,n){this._emitter.off(e,n)}emit(e,...n){const r=n[0];this._emitter.emit(e,{uid:this.uid,...r})}listenerCount(e){return this._emitter.listenerCount(e)}}function nq(t){return new tq(t)}function rq(t,e){return JSON.parse(t,(n,r)=>{let s=r;return(s==null?void 0:s.__type)==="bigint"&&(s=BigInt(s.value)),(s==null?void 0:s.__type)==="Map"&&(s=new Map(s.value)),(e==null?void 0:e(n,s))??s})}function Rw(t,e){return t.slice(0,e).join(".")||"."}function Dw(t,e){const{length:n}=t;for(let r=0;r<n;++r)if(t[r]===e)return r+1;return 0}function sq(t,e){const n=typeof t=="function",r=typeof e=="function",s=[],i=[];return function(a,c){if(typeof c=="object")if(s.length){const l=Dw(s,this);l===0?s[s.length]=this:(s.splice(l),i.splice(l)),i[i.length]=a;const u=Dw(s,c);if(u!==0)return r?e.call(this,a,c,Rw(i,u)):`[ref=${Rw(i,u)}]`}else s[0]=c,i[0]=a;return n?t.call(this,a,c):c}}function iq(t,e,n,r){return JSON.stringify(t,sq((s,i)=>{let o=i;return typeof o=="bigint"&&(o={__type:"bigint",value:i.toString()}),o instanceof Map&&(o={__type:"Map",value:Array.from(i.entries())}),(e==null?void 0:e(s,o))??o},r),n??void 0)}function oq(t){const{deserialize:e=rq,key:n="wagmi",serialize:r=iq,storage:s=__}=t;function i(o){return o instanceof Promise?o.then(a=>a).catch(()=>null):o}return{...s,key:n,async getItem(o,a){const c=s.getItem(`${n}.${o}`),l=await i(c);return l?e(l)??null:a??null},async setItem(o,a){const c=`${n}.${o}`;a===null?await i(s.removeItem(c)):await i(s.setItem(c,r(a)))},async removeItem(o){await i(s.removeItem(`${n}.${o}`))}}}const __={getItem:()=>null,setItem:()=>{},removeItem:()=>{}};function aq(){const t=typeof window<"u"&&window.localStorage?window.localStorage:__;return{getItem(e){return t.getItem(e)},removeItem(e){t.removeItem(e)},setItem(e,n){try{t.setItem(e,n)}catch{}}}}const pp=256;let Vl=pp,Gl;function cq(t=11){if(!Gl||Vl+t>pp*2){Gl="",Vl=0;for(let e=0;e<pp;e++)Gl+=(256+Math.random()*256|0).toString(16).substring(1)}return Gl.substring(Vl,Vl+++t)}function lq(t){const{multiInjectedProviderDiscovery:e=!0,storage:n=oq({storage:aq()}),syncConnectedChain:r=!0,ssr:s=!1,...i}=t,o=typeof window<"u"&&e?GH():void 0,a=jh(()=>i.chains),c=jh(()=>{const _=[],T=new Set;for(const x of i.connectors??[]){const D=l(x);if(_.push(D),!s&&D.rdns){const I=typeof D.rdns=="string"?[D.rdns]:D.rdns;for(const U of I)T.add(U)}}if(!s&&o){const x=o.getProviders();for(const D of x)T.has(D.info.rdns)||_.push(l(u(D)))}return _});function l(_){var D;const T=nq(cq()),x={..._({emitter:T,chains:a.getState(),storage:n,transports:i.transports}),emitter:T,uid:T.uid};return T.on("connect",y),(D=x.setup)==null||D.call(x),x}function u(_){const{info:T}=_,x=_.provider;return Pd({target:{...T,id:T.rdns,provider:x}})}const d=new Map;function h(_={}){const T=_.chainId??m.getState().chainId,x=a.getState().find(I=>I.id===T);if(_.chainId&&!x)throw new Wc;{const I=d.get(m.getState().chainId);if(I&&!x)return I;if(!x)throw new Wc}{const I=d.get(T);if(I)return I}let D;if(i.client)D=i.client({chain:x});else{const I=x.id,U=a.getState().map(M=>M.id),R={},k=Object.entries(i);for(const[M,F]of k)if(!(M==="chains"||M==="client"||M==="connectors"||M==="transports"))if(typeof F=="object")if(I in F)R[M]=F[I];else{if(U.some(S=>S in F))continue;R[M]=F}else R[M]=F;D=j1({...R,chain:x,batch:R.batch??{multicall:!0},transport:M=>i.transports[I]({...M,connectors:c})})}return d.set(T,D),D}function f(){return{chainId:a.getState()[0].id,connections:new Map,current:null,status:"disconnected"}}let p;const g="0.0.0-canary-";lu.startsWith(g)?p=Number.parseInt(lu.replace(g,"")):p=Number.parseInt(lu.split(".")[0]??"0");const m=jh(YH(n?XH(f,{migrate(_,T){if(T===p)return _;const x=f(),D=v(_,x.chainId);return{...x,chainId:D}},name:"store",partialize(_){return{connections:{__type:"Map",value:Array.from(_.connections.entries()).map(([T,x])=>{const{id:D,name:I,type:U,uid:R}=x.connector;return[T,{...x,connector:{id:D,name:I,type:U,uid:R}}]})},chainId:_.chainId,current:_.current}},merge(_,T){typeof _=="object"&&_&&"status"in _&&delete _.status;const x=v(_,T.chainId);return{...T,..._,chainId:x}},skipHydration:s,storage:n,version:p}):f));m.setState(f());function v(_,T){return _&&typeof _=="object"&&"chainId"in _&&typeof _.chainId=="number"&&a.getState().some(x=>x.id===_.chainId)?_.chainId:T}r&&m.subscribe(({connections:_,current:T})=>{var x;return T?(x=_.get(T))==null?void 0:x.chainId:void 0},_=>{if(a.getState().some(x=>x.id===_))return m.setState(x=>({...x,chainId:_??x.chainId}))}),o==null||o.subscribe(_=>{const T=new Set,x=new Set;for(const I of c.getState())if(T.add(I.id),I.rdns){const U=typeof I.rdns=="string"?[I.rdns]:I.rdns;for(const R of U)x.add(R)}const D=[];for(const I of _){if(x.has(I.info.rdns))continue;const U=l(u(I));T.has(U.id)||D.push(U)}n&&!m.persist.hasHydrated()||c.setState(I=>[...I,...D],!0)});function b(_){m.setState(T=>{const x=T.connections.get(_.uid);return x?{...T,connections:new Map(T.connections).set(_.uid,{accounts:_.accounts??x.accounts,chainId:_.chainId??x.chainId,connector:x.connector})}:T})}function y(_){m.getState().status==="connecting"||m.getState().status==="reconnecting"||m.setState(T=>{const x=c.getState().find(D=>D.uid===_.uid);return x?(x.emitter.listenerCount("connect")&&x.emitter.off("connect",b),x.emitter.listenerCount("change")||x.emitter.on("change",b),x.emitter.listenerCount("disconnect")||x.emitter.on("disconnect",N),{...T,connections:new Map(T.connections).set(_.uid,{accounts:_.accounts,chainId:_.chainId,connector:x}),current:_.uid,status:"connected"}):T})}function N(_){m.setState(T=>{const x=T.connections.get(_.uid);if(x){const I=x.connector;I.emitter.listenerCount("change")&&x.connector.emitter.off("change",b),I.emitter.listenerCount("disconnect")&&x.connector.emitter.off("disconnect",N),I.emitter.listenerCount("connect")||x.connector.emitter.on("connect",y)}if(T.connections.delete(_.uid),T.connections.size===0)return{...T,connections:new Map,current:null,status:"disconnected"};const D=T.connections.values().next().value;return{...T,connections:new Map(T.connections),current:D.connector.uid}})}return{get chains(){return a.getState()},get connectors(){return c.getState()},storage:n,getClient:h,get state(){return m.getState()},setState(_){let T;typeof _=="function"?T=_(m.getState()):T=_;const x=f();typeof T!="object"&&(T=x),Object.keys(x).some(I=>!(I in T))&&(T=x),m.setState(T,!0)},subscribe(_,T,x){return m.subscribe(_,T,x?{...x,fireImmediately:x.emitImmediately}:void 0)},_internal:{mipd:o,store:m,ssr:!!s,syncConnectedChain:r,transports:i.transports,chains:{setState(_){const T=typeof _=="function"?_(a.getState()):_;if(T.length!==0)return a.setState(T,!0)},subscribe(_){return a.subscribe(_)}},connectors:{providerDetailToConnector:u,setup:l,setState(_){return c.setState(typeof _=="function"?_(c.getState()):_,!0)},subscribe(_){return c.subscribe(_)}},events:{change:b,connect:y,disconnect:N}}}}function uq(t){let e=[],n,r;function s(a){return ec.parseEvmChainId(a)||1}function i(){var a;return n||(n=Si.getInstance({projectId:t.options.projectId,chainId:(a=A.getActiveCaipNetwork())==null?void 0:a.caipNetworkId,enableLogger:t.options.enableAuthLogger,onTimeout:c=>{c==="iframe_load_failed"?st.open(ut.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):c==="iframe_request_timeout"?st.open(ut.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):c==="unverified_domain"&&st.open(ut.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},abortController:ut.EmbeddedWalletAbortController,getActiveCaipNetwork:c=>A.getActiveCaipNetwork(c)})),n}async function o(a={}){var g;const c=i();let l=a.chainId;if(a.isReconnecting){const m=ec.parseEvmChainId(c.getLastUsedChainId()||""),v=(g=t.chains)==null?void 0:g[0].id;if(l=m||v,!l)throw new Error("ChainId not found in provider")}const u=$n("eip155"),{address:d,chainId:h,accounts:f}=await Wn.authConnectorAuthenticate({authConnector:c,chainId:l,preferredAccountType:u,socialUri:a.socialUri,chainNamespace:L.CHAIN.EVM});e=(f==null?void 0:f.map(m=>m.address))||[d];const p=s(h);return{accounts:e,account:d,chainId:p,chain:{id:p,unsuported:!1}}}return a=>({id:L.CONNECTOR_ID.AUTH,name:L.CONNECTOR_NAMES.AUTH,type:"AUTH",chain:L.CHAIN.EVM,async connect(c={}){if(r)return r;r||(r=new Promise(u=>{u(o(c))}));const l=await r;return r=void 0,l},async disconnect(){await(await this.getProvider()).disconnect()},getAccounts(){return e!=null&&e.length?(a.emitter.emit("change",{accounts:e}),Promise.resolve(e)):Promise.resolve([])},async getProvider(){var c;return this.provider||(this.provider=Si.getInstance({projectId:t.options.projectId,chainId:(c=A.getActiveCaipNetwork())==null?void 0:c.caipNetworkId,enableLogger:t.options.enableAuthLogger,abortController:ut.EmbeddedWalletAbortController,onTimeout:l=>{l==="iframe_load_failed"?st.open(ut.ALERT_ERRORS.IFRAME_LOAD_FAILED,"error"):l==="iframe_request_timeout"?st.open(ut.ALERT_ERRORS.IFRAME_REQUEST_TIMEOUT,"error"):l==="unverified_domain"&&st.open(ut.ALERT_ERRORS.UNVERIFIED_DOMAIN,"error")},getActiveCaipNetwork:l=>A.getActiveCaipNetwork(l)})),Promise.resolve(this.provider)},async getChainId(){const c=await this.getProvider(),{chainId:l}=await c.getChainId();return s(l)},async isAuthorized(){const l=A.state.activeChain===L.CHAIN.EVM;if(L.AUTH_CONNECTOR_SUPPORTED_CHAINS.some(h=>J.getConnectorId(h)===L.CONNECTOR_ID.AUTH)&&!l)return!1;const d=await this.getProvider();return Promise.resolve(d.getLoginEmailUsed())},async switchChain({chainId:c}){var l;try{const u=a.chains.find(p=>p.id===c);if(!u)throw new Mr(new Error("chain not found on connector."));const d=await this.getProvider(),h=$n("eip155"),f=await d.connect({chainId:c,preferredAccountType:h});return e=((l=f==null?void 0:f.accounts)==null?void 0:l.map(p=>p.address))||[f.address],a.emitter.emit("change",{chainId:Number(c),accounts:e}),u}catch(u){throw u instanceof Error?new Mr(u):u}},onAccountsChanged(c){c.length===0?this.onDisconnect():a.emitter.emit("change",{accounts:c.map(mi)})},onChainChanged(c){const l=Number(c);a.emitter.emit("change",{chainId:l})},async onDisconnect(c){await(await this.getProvider()).disconnect()}})}Sg.type="walletConnect";function Sg(t,e){const n=t.isNewChainsStale??!0;let r,s,i,o,a,c,l;return u=>({id:"walletConnect",name:"WalletConnect",type:Sg.type,async setup(){const d=await this.getProvider().catch(()=>null);d&&(o||(o=this.onConnect.bind(this),d.on("connect",o)),c||(c=this.onSessionDelete.bind(this),d.on("session_delete",c)))},async connect({...d}={}){var h,f,p;try{const g=A.getCaipNetworks(),m=await this.getProvider();if(!m)throw new Ds;a||(a=this.onDisplayUri,m.on("display_uri",a));const v=await this.isChainsStale();m.session&&v&&await m.disconnect();const b=j.state.universalProviderConfigOverride;if(!m.session||v){const I=kr.createNamespaces(g,b);await m.connect({optionalNamespaces:I,..."pairingTopic"in d?{pairingTopic:d.pairingTopic}:{}}),this.setRequestedChainsIds(g.map(U=>Number(U.id)))}const y=await this.getAccounts(),N=await this.getChainId(),_=(p=(f=(h=m.session)==null?void 0:h.namespaces)==null?void 0:f.eip155)==null?void 0:p.chains,T=_==null?void 0:_.some(I=>Number(I.split(":")[1])===N);let x=1;T?x=N:_!=null&&_[0]&&(x=Number(_[0].split(":")[1])),a&&(m.removeListener("display_uri",a),a=void 0),o&&(m.removeListener("connect",o),o=void 0),s||(s=this.onAccountsChanged.bind(this),m.on("accountsChanged",s)),i||(i=this.onChainChanged.bind(this),m.on("chainChanged",i)),l||(l=this.onDisconnect.bind(this),m.on("disconnect",l)),c||(c=this.onSessionDelete.bind(this),m.on("session_delete",c));const D=b==null?void 0:b.defaultChain;return m.setDefaultChain(D??`eip155:${x}`),{accounts:y,chainId:x}}catch(g){throw/(user rejected|connection request reset)/i.test(g==null?void 0:g.message)?new Et(g):g}},async disconnect(){const d=await this.getProvider();try{await(d==null?void 0:d.disconnect())}catch(h){if(!/No matching key/i.test(h.message))throw h}finally{i&&(d==null||d.removeListener("chainChanged",i),i=void 0),l&&(d==null||d.removeListener("disconnect",l),l=void 0),o||(o=this.onConnect.bind(this),d==null||d.on("connect",o)),s&&(d==null||d.removeListener("accountsChanged",s),s=void 0),c&&(d==null||d.removeListener("session_delete",c),c=void 0),this.setRequestedChainsIds([])}},async getAccounts(){var m,v,b;const d=await this.getProvider();if(!((m=d==null?void 0:d.session)!=null&&m.namespaces))return[];const h=(b=(v=d==null?void 0:d.session)==null?void 0:v.namespaces[L.CHAIN.EVM])==null?void 0:b.accounts,f=(h==null?void 0:h.map(y=>y.split(":")[2]))??[],p=new Set;return f.filter(y=>{const N=y==null?void 0:y.toLowerCase();return p.has(N)?!1:(p.add(N),!0)})},async getProvider({chainId:d}={}){var p,g;r||(r=await e.getUniversalProvider(),r==null||r.events.setMaxListeners(Number.POSITIVE_INFINITY));const h=V.getActiveNamespace(),f=(p=e.getCaipNetwork())==null?void 0:p.id;if(d&&f!==d&&h){const m=V.getStoredActiveCaipNetworkId(),v=h?e.getCaipNetworks(h):[],b=v==null?void 0:v.find(y=>y.id===m);b&&b.chainNamespace===L.CHAIN.EVM&&await((g=this.switchChain)==null?void 0:g.call(this,{chainId:Number(b.id)}))}return r},async getChainId(){var g,m,v,b;const d=(g=e.getCaipNetwork(L.CHAIN.EVM))==null?void 0:g.id;if(d)return d;const f=(b=(v=(m=(await this.getProvider()).session)==null?void 0:m.namespaces[L.CHAIN.EVM])==null?void 0:v.chains)==null?void 0:b[0],p=A.getCaipNetworks().find(y=>y.id===f);return p==null?void 0:p.id},async isAuthorized(){try{const[d,h]=await Promise.all([this.getAccounts(),this.getProvider()]);return d.length?await this.isChainsStale()&&h.session?(await h.disconnect().catch(()=>{}),!1):!0:!1}catch{return!1}},async switchChain({addEthereumChainParameter:d,chainId:h}){var g,m,v,b;const f=await this.getProvider();if(!f)throw new Ds;const p=A.getCaipNetworks().find(y=>y.id===h);if(!p)throw new Mr(new Wc);try{await f.request({method:"wallet_switchEthereumChain",params:[{chainId:Ne(h)}]}),p!=null&&p.caipNetworkId&&f.setDefaultChain(p==null?void 0:p.caipNetworkId),u.emitter.emit("change",{chainId:Number(h)});const y=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...y,h]),{...p,id:p.id}}catch(y){const N=y;if(/(?:user rejected)/iu.test(N.message))throw new Et(N);try{let _;d!=null&&d.blockExplorerUrls?_=d.blockExplorerUrls:_=(g=p.blockExplorers)!=null&&g.default.url?[(m=p.blockExplorers)==null?void 0:m.default.url]:[];const T=((b=(v=p.rpcUrls)==null?void 0:v.chainDefault)==null?void 0:b.http)||[],x={blockExplorerUrls:_,chainId:Ne(h),chainName:p.name,iconUrls:d==null?void 0:d.iconUrls,nativeCurrency:p.nativeCurrency,rpcUrls:T};await f.request({method:"wallet_addEthereumChain",params:[x]});const D=await this.getRequestedChainsIds();return this.setRequestedChainsIds([...D,h]),{...p,id:p.id}}catch(_){throw new Et(_)}}},onAccountsChanged(d){d.length===0?this.onDisconnect():u.emitter.emit("change",{accounts:d.map(h=>mi(h))})},onChainChanged(d){const h=Number(d);u.emitter.emit("change",{chainId:h})},onConnect(d){this.setRequestedChainsIds(A.getCaipNetworks().map(h=>Number(h.id)))},async onDisconnect(d){this.setRequestedChainsIds([]),u.emitter.emit("disconnect");const h=await this.getProvider();s&&(h.removeListener("accountsChanged",s),s=void 0),i&&(h.removeListener("chainChanged",i),i=void 0),l&&(h.removeListener("disconnect",l),l=void 0),c&&(h.removeListener("session_delete",c),c=void 0),o||(o=this.onConnect.bind(this),h.on("connect",o))},onDisplayUri(d){u.emitter.emit("message",{type:"display_uri",data:d})},onSessionDelete(){this.onDisconnect()},getNamespaceChainsIds(){var f,p,g;if(!((f=r==null?void 0:r.session)!=null&&f.namespaces))return[];const d=(g=(p=r==null?void 0:r.session)==null?void 0:p.namespaces[L.CHAIN.EVM])==null?void 0:g.accounts;return(d==null?void 0:d.map(m=>Number.parseInt(m.split(":")[1]??"")))??[]},async getRequestedChainsIds(){var h;const d=await((h=u.storage)==null?void 0:h.getItem(this.requestedChainsStorageKey))??[];return[...new Set(d)]},async isChainsStale(){if(!n)return!1;const d=u.chains.map(p=>p.id),h=this.getNamespaceChainsIds();if(h.length&&!h.some(p=>d.includes(p)))return!1;const f=await this.getRequestedChainsIds();return!d.every(p=>f.includes(Number(p)))},async setRequestedChainsIds(d){var h;await((h=u.storage)==null?void 0:h.setItem(this.requestedChainsStorageKey,d))},get requestedChainsStorageKey(){return`${this.id}.requestedChains`}})}const Na=Xe({pendingTransactions:0}),$w={state:Na,subscribeKey(t,e){return Ft(Na,t,e)},increase(t){Na[t]+=1},decrease(t){Na[t]-=1},reset(t){Na[t]=0}};function dq(t){try{return JSON.parse(t)}catch{throw new Error("Error parsing wallet capabilities")}}async function hq(t){if(oe.isSafeApp()){const{safe:e}=await Qt(async()=>{const{safe:n}=await import("./Djho846u.js");return{safe:n}},__vite__mapDeps([47,8]),import.meta.url);if(e&&!t.some(n=>n.type==="safe"))return e()}return null}async function fq(t){try{const{coinbaseWallet:e}=await Qt(async()=>{const{coinbaseWallet:n}=await import("./Djho846u.js");return{coinbaseWallet:n}},__vite__mapDeps([47,8]),import.meta.url);if(e&&!t.some(n=>n.id==="coinbaseWalletSDK"))return e()}catch(e){console.error("Failed to import Coinbase Wallet SDK:",e)}return null}const pq={enable:!1,pollingInterval:3e4};class Jz extends w_{constructor(e){const n=Tr.extendCaipNetworks(e.networks,{projectId:e.projectId,customNetworkImageUrls:{},customRpcUrls:e.customRpcUrls});super(),this.balancePromises={},this.namespace=L.CHAIN.EVM,this.adapterType=L.ADAPTER_TYPES.WAGMI,this.projectId=e.projectId,this.pendingTransactionsFilter={...pq,...e.pendingTransactionsFilter??{}},this.createConfig({...e,networks:n}),this.checkChainId()}construct(e){this.checkChainId(),this.setupWatchers()}async getAccounts(e){const n=this.getWagmiConnector(e.id);if(!n)return{accounts:[]};if(n.id===L.CONNECTOR_ID.AUTH){const i=await n.getProvider();if(!(i!=null&&i.user))return{accounts:[]};const{address:o,accounts:a}=i.user;return Promise.resolve({accounts:(a||[{address:o,type:"eoa"}]).map(c=>oe.createAccount("eip155",c.address,c.type))})}const{addresses:r,address:s}=Ja(this.wagmiConfig);return Promise.resolve({accounts:[...new Set(r||[s])].map(i=>oe.createAccount("eip155",i||"","eoa"))})}checkChainId(){const{chainId:e}=Ja(this.wagmiConfig);e&&this.emit("switchNetwork",{chainId:e})}getWagmiConnector(e){return this.wagmiConfig.connectors.find(n=>n.id===e)}createConfig(e){this.wagmiChains=e.networks.filter(s=>s.chainNamespace===L.CHAIN.EVM);const n={},r=[...e.connectors??[]];this.wagmiChains.forEach(s=>{var a,c;const i=(a=e.transports)==null?void 0:a[s.id],o=Tr.getCaipNetworkId(s);i?n[s.id]=Tr.extendWagmiTransports(s,e.projectId,i):n[s.id]=Tr.getViemTransport(s,e.projectId,(c=e.customRpcUrls)==null?void 0:c[o])}),this.wagmiConfig=lq({...e,chains:this.wagmiChains,connectors:r,transports:n})}setupWatchPendingTransactions(){if(!this.pendingTransactionsFilter.enable||this.unwatchPendingTransactions)return;this.unwatchPendingTransactions=HH(this.wagmiConfig,{pollingInterval:this.pendingTransactionsFilter.pollingInterval,onError:()=>{},onTransactions:()=>{this.emit("pendingTransactions"),$w.increase("pendingTransactions")}});const e=$w.subscribeKey("pendingTransactions",n=>{var r;n>=L.LIMITS.PENDING_TRANSACTIONS&&((r=this.unwatchPendingTransactions)==null||r.call(this),e())})}setupWatchers(){BH(this.wagmiConfig,{onChange:(e,n)=>{var r;if(e.status==="disconnected"&&n.address&&this.emit("disconnect"),e!=null&&e.chainId&&(e==null?void 0:e.chainId)!==(n==null?void 0:n.chainId)&&this.emit("switchNetwork",{chainId:e.chainId}),e.status==="connected"){const s=e.address!==(n==null?void 0:n.address),i=e.connector.id!==((r=n.connector)==null?void 0:r.id),o=n.status!=="connected";(s||i||o)&&(this.setupWatchPendingTransactions(),this.handleAccountChanged({address:e.address,chainId:e.chainId,connector:e.connector}))}}}),FH(this.wagmiConfig,{onChange:e=>{this.clearConnections(),this.addConnection(...e.map(n=>{const r=this.getCaipNetworks().find(i=>i.id===n.chainId),s=n.connector.id===L.CONNECTOR_ID.AUTH;return{accounts:n.accounts.map(i=>({address:i})),caipNetwork:r,connectorId:n.connector.id,auth:s?{name:V.getConnectedSocialProvider(),username:V.getConnectedSocialUsername()}:void 0}}))}})}async addThirdPartyConnectors(e){const n=[];if(e.enableCoinbase!==!1){const s=await fq(this.wagmiConfig.connectors);s&&n.push(s)}const r=await hq(this.wagmiConfig.connectors);r&&n.push(r),await Promise.all(n.map(s=>{const i=this.wagmiConfig._internal.connectors.setup(s);return this.wagmiConfig._internal.connectors.setState(o=>[...o,i]),this.addWagmiConnector(i,e)}))}addWagmiConnectors(e,n){var o,a,c,l;const r=[];e.enableWalletConnect!==!1&&r.push(Sg(e,n)),e.enableEIP6963!==!1&&r.push(Pd({shimDisconnect:!0}));const s=((o=n==null?void 0:n.remoteFeatures)==null?void 0:o.email)??!0,i=Array.isArray((a=n==null?void 0:n.remoteFeatures)==null?void 0:a.socials)&&((l=(c=n==null?void 0:n.remoteFeatures)==null?void 0:c.socials)==null?void 0:l.length)>0;(s||i)&&r.push(uq({chains:this.wagmiChains,options:{projectId:e.projectId,enableAuthLogger:e.enableAuthLogger}})),r.forEach(u=>{const d=this.wagmiConfig._internal.connectors.setup(u);this.wagmiConfig._internal.connectors.setState(h=>[...h,d])})}async handleAccountChanged({address:e,chainId:n,connector:r}){if(!this.namespace)throw new Error("WagmiAdapter:handleAccountChanged - namespace is required");const s=await r.getProvider().catch(()=>{});this.emit("accountChanged",{address:e,chainId:n,connector:{id:r.id,name:Pn.ConnectorNamesMap[r.id]??r.name,imageId:Pn.ConnectorImageIds[r.id],type:Pn.ConnectorTypesMap[r.type]??"EXTERNAL",info:r.id===L.CONNECTOR_ID.INJECTED?void 0:{rdns:r.id},provider:s,chain:this.namespace,chains:[]}})}async signMessage(e){try{return{signature:await LH(this.wagmiConfig,{message:e.message,account:e.address})}}catch{throw new Error("WagmiAdapter:signMessage - Sign message failed")}}async sendTransaction(e){const{chainId:n,address:r}=Ja(this.wagmiConfig),s={account:r,to:e.to,value:Number.isNaN(Number(e.value))?BigInt(0):BigInt(e.value),gas:e.gas?BigInt(e.gas):void 0,gasPrice:e.gasPrice?BigInt(e.gasPrice):void 0,data:e.data,chainId:n,type:"legacy",parameters:["nonce"]};await kH(this.wagmiConfig,s);const i=await UH(this.wagmiConfig,s);return await qH(this.wagmiConfig,{hash:i,timeout:25e3}),{hash:i}}async writeContract(e){var o;const{caipNetwork:n,...r}=e,s=Number(ec.caipNetworkIdToNumber(n.caipNetworkId));return{hash:await zH(this.wagmiConfig,{chain:(o=this.wagmiChains)==null?void 0:o[s],chainId:s,address:r.tokenAddress,account:r.fromAddress,abi:r.abi,functionName:r.method,args:r.args,__mode:"prepared"})}}async estimateGas(e){try{return{gas:await PH(this.wagmiConfig,{account:e.address,to:e.to,data:e.data,type:"legacy"})}}catch{throw new Error("WagmiAdapter:estimateGas - error estimating gas")}}parseUnits(e){return MN(e.value,e.decimals)}formatUnits(e){return Go(e.value,e.decimals)}async addWagmiConnector(e,n){var s;if(!this.namespace)throw new Error("WagmiAdapter:addWagmiConnector - namespace is required");if(e.type===L.CONNECTOR_ID.INJECTED&&n.enableEIP6963===!1||e.id===L.CONNECTOR_ID.AUTH||e.id===L.CONNECTOR_ID.WALLET_CONNECT)return;const r=await e.getProvider().catch(()=>{});this.addConnector({id:e.id,explorerId:Pn.ConnectorExplorerIds[e.id],imageUrl:((s=n==null?void 0:n.connectorImages)==null?void 0:s[e.id])??e.icon,name:Pn.ConnectorNamesMap[e.id]??e.name,imageId:Pn.ConnectorImageIds[e.id],type:Pn.ConnectorTypesMap[e.type]??"EXTERNAL",info:e.id===L.CONNECTOR_ID.INJECTED?void 0:{rdns:e.id},provider:r,chain:this.namespace,chains:[]})}async syncConnectors(e,n){jH(this.wagmiConfig,{onChange:r=>{r.forEach(s=>this.addWagmiConnector(s,e))}}),this.addWagmiConnectors(e,n),await Promise.all(this.wagmiConfig.connectors.map(r=>this.addWagmiConnector(r,e))),this.addThirdPartyConnectors(e)}async syncConnections(){return Promise.resolve()}async syncConnection(e){var l,u;const{id:n,chainId:r}=e,i=es(this.wagmiConfig).find(d=>d.connector.id===n),o=this.getWagmiConnector(n),a=await(o==null?void 0:o.getProvider());if(oe.isSafeApp()&&n===L.CONNECTOR_ID.SAFE&&!(i!=null&&i.accounts.length)){const d=this.getWagmiConnector("safe");if(d){const h=await Bh(this.wagmiConfig,{connector:d,chainId:Number(r)}),f=await d.getProvider();return{chainId:Number(r),address:h.accounts[0],provider:f,type:(l=i==null?void 0:i.connector.type)==null?void 0:l.toUpperCase(),id:i==null?void 0:i.connector.id}}}return{chainId:Number(i==null?void 0:i.chainId),address:i==null?void 0:i.accounts[0],provider:a,type:(u=i==null?void 0:i.connector.type)==null?void 0:u.toUpperCase(),id:i==null?void 0:i.connector.id}}async connectWalletConnect(e){const n=this.getWalletConnectConnector();await n.authenticate();const r=this.getWagmiConnector("walletConnect");if(!r)throw new Error("UniversalAdapter:connectWalletConnect - connector not found");const s=await Bh(this.wagmiConfig,{connector:r,chainId:e?Number(e):void 0});return s.chainId!==Number(e)&&await Pw(this.wagmiConfig,{chainId:s.chainId}),{clientId:await n.provider.client.core.crypto.getClientId()}}async connect(e){var h,f,p,g,m;const{id:n,address:r,provider:s,type:i,info:o,chainId:a,socialUri:c}=e,l=this.getWagmiConnector(n);if(!l)throw new Error("connectionControllerClient:connectExternal - connector is undefined");s&&o&&l.id===L.CONNECTOR_ID.EIP6963&&((h=l.setEip6963Wallet)==null||h.call(l,{provider:s,info:o}));const u=(p=(f=this.wagmiConfig.state)==null?void 0:f.connections)==null?void 0:p.get(l.uid);if(u){await((g=this.wagmiConfig.storage)==null?void 0:g.setItem("recentConnectorId",l.id));const v=[...u.accounts].sort((b,y)=>Pt.isLowerCaseMatch(b,r)?-1:Pt.isLowerCaseMatch(y,r)?1:0);return(m=this.wagmiConfig)==null||m.setState(b=>({...b,connections:new Map(b.connections).set(l.uid,{accounts:v,chainId:u.chainId,connector:u.connector}),current:l.uid,status:"connected"})),{address:v[0],chainId:u.chainId,provider:s,type:i,id:n}}const d=await Bh(this.wagmiConfig,{connector:l,chainId:a?Number(a):void 0,socialUri:c});return{address:d.accounts[0],chainId:d.chainId,provider:s,type:i,id:n}}get connections(){return Array.from(this.wagmiConfig.state.connections.values()).map(e=>({accounts:e.accounts.map(n=>({address:n})),connectorId:e.connector.id}))}async reconnect(e){const{id:n}=e,r=this.getWagmiConnector(n);if(!r)throw new Error("connectionControllerClient:connectExternal - connector is undefined");await Tw(this.wagmiConfig,{connectors:[r]})}async getBalance(e){const n=e.address,r=this.getCaipNetworks().find(s=>s.id===e.chainId);if(!n)return Promise.resolve({balance:"0.00",symbol:"ETH"});if(r&&this.wagmiConfig){const s=`${r.caipNetworkId}:${e.address}`,i=this.balancePromises[s];if(i)return i;const o=V.getNativeBalanceCacheForCaipAddress(s);return o?{balance:o.balance,symbol:o.symbol}:(this.balancePromises[s]=new Promise(async a=>{var c,l;try{const u=Number(e.chainId),d=await $H(this.wagmiConfig,{address:e.address,chainId:u,token:(l=(c=e.tokens)==null?void 0:c[r.caipNetworkId])==null?void 0:l.address});V.updateNativeBalanceCache({caipAddress:s,balance:d.formatted,symbol:d.symbol,timestamp:Date.now()}),a({balance:d.formatted,symbol:d.symbol})}catch(u){console.warn("Appkit:WagmiAdapter:getBalance - Error getting balance",u),a({balance:"0.00",symbol:"ETH"})}}).finally(()=>{delete this.balancePromises[s]}),this.balancePromises[s]||{balance:"0.00",symbol:"ETH"})}return{balance:"",symbol:""}}getWalletConnectProvider(){var e;return(e=this.getWagmiConnector("walletConnect"))==null?void 0:e.provider}async disconnect(e){if(e.id){const n=this.getWagmiConnector(e.id),s=es(this.wagmiConfig).find(i=>Pt.isLowerCaseMatch(i.connector.id,e.id));return await Nw(this.wagmiConfig,{connector:n}),j.state.enableReconnect===!1&&this.deleteConnection(e.id),s?{connections:[{accounts:s.accounts.map(i=>({address:i})),connectorId:s.connector.id}]}:{connections:[]}}return this.disconnectAll()}async disconnectAll(){const e=es(this.wagmiConfig),n=await Promise.allSettled(e.map(async r=>{const s=this.getWagmiConnector(r.connector.id);return s&&await Nw(this.wagmiConfig,{connector:s}),r}));return this.wagmiConfig.state.connections.clear(),{connections:n.filter(r=>r.status==="fulfilled").map(({value:r})=>({accounts:r.accounts.map(s=>({address:s})),connectorId:r.connector.id}))}}async switchNetwork(e){var s,i,o,a,c,l,u,d,h,f;const{caipNetwork:n}=e,r=this.wagmiConfig.chains.find(p=>p.id.toString()===n.id.toString());await Pw(this.wagmiConfig,{chainId:n.id,addEthereumChainParameter:{chainName:(r==null?void 0:r.name)??n.name,nativeCurrency:(r==null?void 0:r.nativeCurrency)??n.nativeCurrency,rpcUrls:[((o=(i=(s=n.rpcUrls)==null?void 0:s.chainDefault)==null?void 0:i.http)==null?void 0:o[0])??((l=(c=(a=r==null?void 0:r.rpcUrls)==null?void 0:a.default)==null?void 0:c.http)==null?void 0:l[0])??""],blockExplorerUrls:[((d=(u=r==null?void 0:r.blockExplorers)==null?void 0:u.default)==null?void 0:d.url)??((f=(h=n.blockExplorers)==null?void 0:h.default)==null?void 0:f.url)??""]}}),await super.switchNetwork(e)}async getCapabilities(e){var a,c;if(!this.wagmiConfig)throw new Error("connectionControllerClient:getCapabilities - wagmiConfig is undefined");const r=es(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:getCapabilities - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:getCapabilities - provider is undefined");const o=(c=(a=i.session)==null?void 0:a.sessionProperties)==null?void 0:c.capabilities;if(o){const u=dq(o)[e];if(u)return u}return await i.request({method:"wallet_getCapabilities",params:[e]})}async grantPermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:grantPermissions - wagmiConfig is undefined");const r=es(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:grantPermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:grantPermissions - provider is undefined");return i.request({method:"wallet_grantPermissions",params:e})}async revokePermissions(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:revokePermissions - wagmiConfig is undefined");const r=es(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:revokePermissions - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:revokePermissions - provider is undefined");return i.request({method:"wallet_revokePermissions",params:e})}async walletGetAssets(e){if(!this.wagmiConfig)throw new Error("connectionControllerClient:walletGetAssets - wagmiConfig is undefined");const r=es(this.wagmiConfig)[0],s=r?this.getWagmiConnector(r.connector.id):null;if(!s)throw new Error("connectionControllerClient:walletGetAssets - connector is undefined");const i=await s.getProvider();if(!i)throw new Error("connectionControllerClient:walletGetAssets - provider is undefined");return i.request({method:"wallet_getAssets",params:[e]})}setAuthProvider(e){if(!this.namespace)throw new Error("WagmiAdapter:setAuthProvider - namespace is required");this.addConnector({id:L.CONNECTOR_ID.AUTH,type:"AUTH",name:L.CONNECTOR_NAMES.AUTH,provider:e,imageId:Pn.ConnectorImageIds[L.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}async setUniversalProvider(e){return e.on("connect",()=>{const n=es(this.wagmiConfig),r=this.getWagmiConnector("walletConnect");if(r&&!n.find(s=>s.connector.id===r.id)){if(A.state.activeChain==="eip155")return;Tw(this.wagmiConfig,{connectors:[r]})}}),this.addConnector(new Ig({provider:e,caipNetworks:this.getCaipNetworks(),namespace:"eip155"})),Promise.resolve()}}const Xz="0884ac76a4fd711a06280ccd6ed32db7";export{Bp as $,Xe as A,z as B,Yj as C,Ft as D,Tt as E,Bt as F,Ja as G,Ua as H,Pr as I,X as J,L as K,Ve as L,Me as M,dA as N,$n as O,Xz as P,At as Q,me as R,Mr as S,A as T,Et as U,fe as V,Jz as W,oe as X,qA as Y,ce as Z,st as _,au as a,lI as a$,qe as a0,qw as a1,J as a2,jw as a3,yn as a4,pu as a5,Cp as a6,Ks as a7,Iq as a8,nd as a9,d_ as aA,hp as aB,qo as aC,Kl as aD,Xn as aE,KA as aF,EI as aG,DI as aH,Xw as aI,bq as aJ,Pi as aK,wq as aL,vq as aM,cr as aN,Eq as aO,an as aP,wI as aQ,gI as aR,pI as aS,fI as aT,dI as aU,bI as aV,Wo as aW,yI as aX,hI as aY,mI as aZ,uI as a_,_p as aa,_q as ab,Cq as ac,ed as ad,fu as ae,jI as af,WI as ag,Fq as ah,T2 as ai,V as aj,j as ak,Kj as al,ut as am,rs as an,Ma as ao,On as ap,Ye as aq,gA as ar,Rn as as,it as at,pf as au,ar as av,Wn as aw,de as ax,zz as ay,He as az,qz as b,Dq as b$,Vh as b0,aa as b1,rb as b2,Kq as b3,iu as b4,hu as b5,Pt as b6,dp as b7,Tr as b8,ax as b9,m2 as bA,$1 as bB,nS as bC,x2 as bD,_n as bE,gb as bF,D1 as bG,zq as bH,ko as bI,jq as bJ,L1 as bK,qq as bL,Hq as bM,sd as bN,Op as bO,Pp as bP,iN as bQ,y2 as bR,Lr as bS,Ri as bT,$q as bU,_t as bV,Sq as bW,BI as bX,Vo as bY,Ku as bZ,pb as b_,Aq as ba,wp as bb,Zc as bc,Yu as bd,S2 as be,td as bf,lt as bg,I1 as bh,Hr as bi,gu as bj,S1 as bk,qS as bl,Up as bm,wu as bn,M1 as bo,wN as bp,yN as bq,ac as br,bN as bs,jS as bt,Yh as bu,lb as bv,Oi as bw,AN as bx,$o as by,Fs as bz,Yz as c,Nq as c0,Ur as c1,Xu as c2,q1 as c3,T1 as c4,i1 as c5,AS as c6,Gu as c7,Np as c8,Tp as c9,Jc as cA,En as cB,rS as cC,t1 as cD,IN as cE,UN as cF,El as cG,fb as cH,Vq as cI,QH as cJ,nn as cK,Zu as cL,at as cM,ss as cN,Bq as cO,rd as ca,tN as cb,Wq as cc,R1 as cd,Gq as ce,Oq as cf,uS as cg,tS as ch,Ec as ci,sx as cj,nx as ck,rx as cl,CN as cm,kp as cn,BN as co,hm as cp,IS as cq,kq as cr,l1 as cs,Uq as ct,C1 as cu,A1 as cv,kN as cw,j1 as cx,Lp as cy,eq as cz,Gz as d,Vz as e,Zz as f,mi as g,Wc as h,Po as i,Ds as j,Pd as k,Sp as l,Kz as m,Ne as n,Gn as o,q2 as p,FS as q,Wz as r,LH as s,U1 as t,Uo as u,Yb as v,H1 as w,Hz as x,Ys as y,Un as z};
