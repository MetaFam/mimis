const o="my-app-v1",a=["/","/index.html","/styles/main.css","/scripts/app.js","/images/logo.png","/offline.html"];self.addEventListener("install",t=>{console.log("Service Worker: Installing..."),t.waitUntil(caches.open(o).then(i=>(console.log("Service Worker: Caching static assets"),i.addAll(a))).then(()=>self.skipWaiting()))});self.addEventListener("activate",t=>{console.log("Service Worker: Activating..."),t.waitUntil(caches.keys().then(i=>Promise.all(i.map(e=>{if(e!==o)return console.log("Service Worker: Deleting old cache:",e),caches.delete(e)}))).then(()=>self.clients.claim()))});self.addEventListener("fetch",t=>{t.request.method==="GET"&&t.respondWith(caches.match(t.request).then(i=>i||fetch(t.request).then(e=>{if(!e||e.status!==200||e.type!=="basic")return e;const n=e.clone();return caches.open(o).then(s=>{s.put(t.request,n)}),e}).catch(()=>{if(t.request.destination==="document")return caches.match("/offline.html")})))});self.addEventListener("sync",t=>{t.tag==="background-sync"&&console.log("Service Worker: Background sync triggered")});self.addEventListener("push",t=>{const i=t.data?t.data.json():{},e=i.title||"New Notification",n={body:i.body||"You have a new message",icon:"/images/notification-icon.png",badge:"/images/badge-icon.png",tag:"notification-tag",requireInteraction:!0};t.waitUntil(self.registration.showNotification(e,n))});self.addEventListener("notificationclick",t=>{t.notification.close(),t.waitUntil(clients.openWindow("/"))});
